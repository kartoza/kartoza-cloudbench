var lD=t=>{throw TypeError(t)};var RT=(t,e,r)=>e.has(t)||lD("Cannot "+r);var Pe=(t,e,r)=>(RT(t,e,"read from private field"),r?r.call(t):e.get(t)),kr=(t,e,r)=>e.has(t)?lD("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),rr=(t,e,r,n)=>(RT(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),Jr=(t,e,r)=>(RT(t,e,"access private method"),r);var $_=(t,e,r,n)=>({set _(i){rr(t,e,i,r)},get _(){return Pe(t,e,n)}});function zX(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Jx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function s1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var m$={exports:{}},ik={},g$={exports:{}},on={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o1=Symbol.for("react.element"),MX=Symbol.for("react.portal"),IX=Symbol.for("react.fragment"),RX=Symbol.for("react.strict_mode"),DX=Symbol.for("react.profiler"),LX=Symbol.for("react.provider"),FX=Symbol.for("react.context"),BX=Symbol.for("react.forward_ref"),$X=Symbol.for("react.suspense"),NX=Symbol.for("react.memo"),VX=Symbol.for("react.lazy"),cD=Symbol.iterator;function WX(t){return t===null||typeof t!="object"?null:(t=cD&&t[cD]||t["@@iterator"],typeof t=="function"?t:null)}var y$={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x$=Object.assign,v$={};function g0(t,e,r){this.props=t,this.context=e,this.refs=v$,this.updater=r||y$}g0.prototype.isReactComponent={};g0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};g0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function b$(){}b$.prototype=g0.prototype;function ZE(t,e,r){this.props=t,this.context=e,this.refs=v$,this.updater=r||y$}var YE=ZE.prototype=new b$;YE.constructor=ZE;x$(YE,g0.prototype);YE.isPureReactComponent=!0;var uD=Array.isArray,_$=Object.prototype.hasOwnProperty,JE={current:null},w$={key:!0,ref:!0,__self:!0,__source:!0};function S$(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)_$.call(e,n)&&!w$.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var d=Array(o),m=0;m<o;m++)d[m]=arguments[m+2];i.children=d}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:o1,type:t,key:s,ref:a,props:i,_owner:JE.current}}function UX(t,e){return{$$typeof:o1,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ez(t){return typeof t=="object"&&t!==null&&t.$$typeof===o1}function qX(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var hD=/\/+/g;function DT(t,e){return typeof t=="object"&&t!==null&&t.key!=null?qX(""+t.key):e.toString(36)}function Hw(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case o1:case MX:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+DT(a,0):n,uD(i)?(r="",t!=null&&(r=t.replace(hD,"$&/")+"/"),Hw(i,e,r,"",function(m){return m})):i!=null&&(ez(i)&&(i=UX(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(hD,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",uD(t))for(var o=0;o<t.length;o++){s=t[o];var d=n+DT(s,o);a+=Hw(s,e,r,d,i)}else if(d=WX(t),typeof d=="function")for(t=d.call(t),o=0;!(s=t.next()).done;)s=s.value,d=n+DT(s,o++),a+=Hw(s,e,r,d,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function N_(t,e,r){if(t==null)return t;var n=[],i=0;return Hw(t,n,"","",function(s){return e.call(r,s,i++)}),n}function QX(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Xo={current:null},Gw={transition:null},HX={ReactCurrentDispatcher:Xo,ReactCurrentBatchConfig:Gw,ReactCurrentOwner:JE};function k$(){throw Error("act(...) is not supported in production builds of React.")}on.Children={map:N_,forEach:function(t,e,r){N_(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return N_(t,function(){e++}),e},toArray:function(t){return N_(t,function(e){return e})||[]},only:function(t){if(!ez(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};on.Component=g0;on.Fragment=IX;on.Profiler=DX;on.PureComponent=ZE;on.StrictMode=RX;on.Suspense=$X;on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HX;on.act=k$;on.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=x$({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=JE.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(d in e)_$.call(e,d)&&!w$.hasOwnProperty(d)&&(n[d]=e[d]===void 0&&o!==void 0?o[d]:e[d])}var d=arguments.length-2;if(d===1)n.children=r;else if(1<d){o=Array(d);for(var m=0;m<d;m++)o[m]=arguments[m+2];n.children=o}return{$$typeof:o1,type:t.type,key:i,ref:s,props:n,_owner:a}};on.createContext=function(t){return t={$$typeof:FX,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:LX,_context:t},t.Consumer=t};on.createElement=S$;on.createFactory=function(t){var e=S$.bind(null,t);return e.type=t,e};on.createRef=function(){return{current:null}};on.forwardRef=function(t){return{$$typeof:BX,render:t}};on.isValidElement=ez;on.lazy=function(t){return{$$typeof:VX,_payload:{_status:-1,_result:t},_init:QX}};on.memo=function(t,e){return{$$typeof:NX,type:t,compare:e===void 0?null:e}};on.startTransition=function(t){var e=Gw.transition;Gw.transition={};try{t()}finally{Gw.transition=e}};on.unstable_act=k$;on.useCallback=function(t,e){return Xo.current.useCallback(t,e)};on.useContext=function(t){return Xo.current.useContext(t)};on.useDebugValue=function(){};on.useDeferredValue=function(t){return Xo.current.useDeferredValue(t)};on.useEffect=function(t,e){return Xo.current.useEffect(t,e)};on.useId=function(){return Xo.current.useId()};on.useImperativeHandle=function(t,e,r){return Xo.current.useImperativeHandle(t,e,r)};on.useInsertionEffect=function(t,e){return Xo.current.useInsertionEffect(t,e)};on.useLayoutEffect=function(t,e){return Xo.current.useLayoutEffect(t,e)};on.useMemo=function(t,e){return Xo.current.useMemo(t,e)};on.useReducer=function(t,e,r){return Xo.current.useReducer(t,e,r)};on.useRef=function(t){return Xo.current.useRef(t)};on.useState=function(t){return Xo.current.useState(t)};on.useSyncExternalStore=function(t,e,r){return Xo.current.useSyncExternalStore(t,e,r)};on.useTransition=function(){return Xo.current.useTransition()};on.version="18.3.1";g$.exports=on;var I=g$.exports;const $i=s1(I),dD=zX({__proto__:null,default:$i},[I]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GX=I,XX=Symbol.for("react.element"),KX=Symbol.for("react.fragment"),ZX=Object.prototype.hasOwnProperty,YX=GX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,JX={key:!0,ref:!0,__self:!0,__source:!0};function C$(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)ZX.call(e,n)&&!JX.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:XX,type:t,key:s,ref:a,props:i,_owner:YX.current}}ik.Fragment=KX;ik.jsx=C$;ik.jsxs=C$;m$.exports=ik;var u=m$.exports,Gj={},T$={exports:{}},sl={},O$={exports:{}},j$={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Me,Ge){var De=Me.length;Me.push(Ge);e:for(;0<De;){var Le=De-1>>>1,Oe=Me[Le];if(0<i(Oe,Ge))Me[Le]=Ge,Me[De]=Oe,De=Le;else break e}}function r(Me){return Me.length===0?null:Me[0]}function n(Me){if(Me.length===0)return null;var Ge=Me[0],De=Me.pop();if(De!==Ge){Me[0]=De;e:for(var Le=0,Oe=Me.length,Ie=Oe>>>1;Le<Ie;){var st=2*(Le+1)-1,Re=Me[st],it=st+1,Ke=Me[it];if(0>i(Re,De))it<Oe&&0>i(Ke,Re)?(Me[Le]=Ke,Me[it]=De,Le=it):(Me[Le]=Re,Me[st]=De,Le=st);else if(it<Oe&&0>i(Ke,De))Me[Le]=Ke,Me[it]=De,Le=it;else break e}}return Ge}function i(Me,Ge){var De=Me.sortIndex-Ge.sortIndex;return De!==0?De:Me.id-Ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var d=[],m=[],y=1,v=null,w=3,O=!1,P=!1,E=!1,$=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(Me){for(var Ge=r(m);Ge!==null;){if(Ge.callback===null)n(m);else if(Ge.startTime<=Me)n(m),Ge.sortIndex=Ge.expirationTime,e(d,Ge);else break;Ge=r(m)}}function U(Me){if(E=!1,D(Me),!P)if(r(d)!==null)P=!0,tt(X);else{var Ge=r(m);Ge!==null&&Be(U,Ge.startTime-Me)}}function X(Me,Ge){P=!1,E&&(E=!1,R(Y),Y=-1),O=!0;var De=w;try{for(D(Ge),v=r(d);v!==null&&(!(v.expirationTime>Ge)||Me&&!ce());){var Le=v.callback;if(typeof Le=="function"){v.callback=null,w=v.priorityLevel;var Oe=Le(v.expirationTime<=Ge);Ge=t.unstable_now(),typeof Oe=="function"?v.callback=Oe:v===r(d)&&n(d),D(Ge)}else n(d);v=r(d)}if(v!==null)var Ie=!0;else{var st=r(m);st!==null&&Be(U,st.startTime-Ge),Ie=!1}return Ie}finally{v=null,w=De,O=!1}}var ee=!1,K=null,Y=-1,ne=5,oe=-1;function ce(){return!(t.unstable_now()-oe<ne)}function Xe(){if(K!==null){var Me=t.unstable_now();oe=Me;var Ge=!0;try{Ge=K(!0,Me)}finally{Ge?Ae():(ee=!1,K=null)}}else ee=!1}var Ae;if(typeof F=="function")Ae=function(){F(Xe)};else if(typeof MessageChannel<"u"){var We=new MessageChannel,Ye=We.port2;We.port1.onmessage=Xe,Ae=function(){Ye.postMessage(null)}}else Ae=function(){$(Xe,0)};function tt(Me){K=Me,ee||(ee=!0,Ae())}function Be(Me,Ge){Y=$(function(){Me(t.unstable_now())},Ge)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Me){Me.callback=null},t.unstable_continueExecution=function(){P||O||(P=!0,tt(X))},t.unstable_forceFrameRate=function(Me){0>Me||125<Me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ne=0<Me?Math.floor(1e3/Me):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return r(d)},t.unstable_next=function(Me){switch(w){case 1:case 2:case 3:var Ge=3;break;default:Ge=w}var De=w;w=Ge;try{return Me()}finally{w=De}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Me,Ge){switch(Me){case 1:case 2:case 3:case 4:case 5:break;default:Me=3}var De=w;w=Me;try{return Ge()}finally{w=De}},t.unstable_scheduleCallback=function(Me,Ge,De){var Le=t.unstable_now();switch(typeof De=="object"&&De!==null?(De=De.delay,De=typeof De=="number"&&0<De?Le+De:Le):De=Le,Me){case 1:var Oe=-1;break;case 2:Oe=250;break;case 5:Oe=1073741823;break;case 4:Oe=1e4;break;default:Oe=5e3}return Oe=De+Oe,Me={id:y++,callback:Ge,priorityLevel:Me,startTime:De,expirationTime:Oe,sortIndex:-1},De>Le?(Me.sortIndex=De,e(m,Me),r(d)===null&&Me===r(m)&&(E?(R(Y),Y=-1):E=!0,Be(U,De-Le))):(Me.sortIndex=Oe,e(d,Me),P||O||(P=!0,tt(X))),Me},t.unstable_shouldYield=ce,t.unstable_wrapCallback=function(Me){var Ge=w;return function(){var De=w;w=Ge;try{return Me.apply(this,arguments)}finally{w=De}}}})(j$);O$.exports=j$;var eK=O$.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tK=I,tl=eK;function Pt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var P$=new Set,Zv={};function xm(t,e){Ly(t,e),Ly(t+"Capture",e)}function Ly(t,e){for(Zv[t]=e,t=0;t<e.length;t++)P$.add(e[t])}var yh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xj=Object.prototype.hasOwnProperty,rK=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fD={},pD={};function nK(t){return Xj.call(pD,t)?!0:Xj.call(fD,t)?!1:rK.test(t)?pD[t]=!0:(fD[t]=!0,!1)}function iK(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function sK(t,e,r,n){if(e===null||typeof e>"u"||iK(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ko(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var ao={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ao[t]=new Ko(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ao[e]=new Ko(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ao[t]=new Ko(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ao[t]=new Ko(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ao[t]=new Ko(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ao[t]=new Ko(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ao[t]=new Ko(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ao[t]=new Ko(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ao[t]=new Ko(t,5,!1,t.toLowerCase(),null,!1,!1)});var tz=/[\-:]([a-z])/g;function rz(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(tz,rz);ao[e]=new Ko(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(tz,rz);ao[e]=new Ko(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(tz,rz);ao[e]=new Ko(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ao[t]=new Ko(t,1,!1,t.toLowerCase(),null,!1,!1)});ao.xlinkHref=new Ko("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ao[t]=new Ko(t,1,!1,t.toLowerCase(),null,!0,!0)});function nz(t,e,r,n){var i=ao.hasOwnProperty(e)?ao[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(sK(e,r,i,n)&&(r=null),n||i===null?nK(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Oh=tK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,V_=Symbol.for("react.element"),Og=Symbol.for("react.portal"),jg=Symbol.for("react.fragment"),iz=Symbol.for("react.strict_mode"),Kj=Symbol.for("react.profiler"),A$=Symbol.for("react.provider"),E$=Symbol.for("react.context"),sz=Symbol.for("react.forward_ref"),Zj=Symbol.for("react.suspense"),Yj=Symbol.for("react.suspense_list"),oz=Symbol.for("react.memo"),pd=Symbol.for("react.lazy"),z$=Symbol.for("react.offscreen"),mD=Symbol.iterator;function Ax(t){return t===null||typeof t!="object"?null:(t=mD&&t[mD]||t["@@iterator"],typeof t=="function"?t:null)}var ji=Object.assign,LT;function ev(t){if(LT===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);LT=e&&e[1]||""}return`
`+LT+t}var FT=!1;function BT(t,e){if(!t||FT)return"";FT=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(m){var n=m}Reflect.construct(t,[],e)}else{try{e.call()}catch(m){n=m}t.call(e.prototype)}else{try{throw Error()}catch(m){n=m}t()}}catch(m){if(m&&n&&typeof m.stack=="string"){for(var i=m.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var d=`
`+i[a].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=a&&0<=o);break}}}finally{FT=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ev(t):""}function oK(t){switch(t.tag){case 5:return ev(t.type);case 16:return ev("Lazy");case 13:return ev("Suspense");case 19:return ev("SuspenseList");case 0:case 2:case 15:return t=BT(t.type,!1),t;case 11:return t=BT(t.type.render,!1),t;case 1:return t=BT(t.type,!0),t;default:return""}}function Jj(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case jg:return"Fragment";case Og:return"Portal";case Kj:return"Profiler";case iz:return"StrictMode";case Zj:return"Suspense";case Yj:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case E$:return(t.displayName||"Context")+".Consumer";case A$:return(t._context.displayName||"Context")+".Provider";case sz:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case oz:return e=t.displayName||null,e!==null?e:Jj(t.type)||"Memo";case pd:e=t._payload,t=t._init;try{return Jj(t(e))}catch{}}return null}function aK(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Jj(e);case 8:return e===iz?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Yd(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function M$(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function lK(t){var e=M$(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function W_(t){t._valueTracker||(t._valueTracker=lK(t))}function I$(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=M$(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function $S(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function eP(t,e){var r=e.checked;return ji({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function gD(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Yd(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function R$(t,e){e=e.checked,e!=null&&nz(t,"checked",e,!1)}function tP(t,e){R$(t,e);var r=Yd(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?rP(t,e.type,r):e.hasOwnProperty("defaultValue")&&rP(t,e.type,Yd(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function yD(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function rP(t,e,r){(e!=="number"||$S(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var tv=Array.isArray;function ey(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Yd(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function nP(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Pt(91));return ji({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function xD(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Pt(92));if(tv(r)){if(1<r.length)throw Error(Pt(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Yd(r)}}function D$(t,e){var r=Yd(e.value),n=Yd(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function vD(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function L$(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function iP(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?L$(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var U_,F$=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(U_=U_||document.createElement("div"),U_.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=U_.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Yv(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var bv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cK=["Webkit","ms","Moz","O"];Object.keys(bv).forEach(function(t){cK.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),bv[e]=bv[t]})});function B$(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||bv.hasOwnProperty(t)&&bv[t]?(""+e).trim():e+"px"}function $$(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=B$(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var uK=ji({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sP(t,e){if(e){if(uK[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Pt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Pt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Pt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Pt(62))}}function oP(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var aP=null;function az(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var lP=null,ty=null,ry=null;function bD(t){if(t=c1(t)){if(typeof lP!="function")throw Error(Pt(280));var e=t.stateNode;e&&(e=ck(e),lP(t.stateNode,t.type,e))}}function N$(t){ty?ry?ry.push(t):ry=[t]:ty=t}function V$(){if(ty){var t=ty,e=ry;if(ry=ty=null,bD(t),e)for(t=0;t<e.length;t++)bD(e[t])}}function W$(t,e){return t(e)}function U$(){}var $T=!1;function q$(t,e,r){if($T)return t(e,r);$T=!0;try{return W$(t,e,r)}finally{$T=!1,(ty!==null||ry!==null)&&(U$(),V$())}}function Jv(t,e){var r=t.stateNode;if(r===null)return null;var n=ck(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Pt(231,e,typeof r));return r}var cP=!1;if(yh)try{var Ex={};Object.defineProperty(Ex,"passive",{get:function(){cP=!0}}),window.addEventListener("test",Ex,Ex),window.removeEventListener("test",Ex,Ex)}catch{cP=!1}function hK(t,e,r,n,i,s,a,o,d){var m=Array.prototype.slice.call(arguments,3);try{e.apply(r,m)}catch(y){this.onError(y)}}var _v=!1,NS=null,VS=!1,uP=null,dK={onError:function(t){_v=!0,NS=t}};function fK(t,e,r,n,i,s,a,o,d){_v=!1,NS=null,hK.apply(dK,arguments)}function pK(t,e,r,n,i,s,a,o,d){if(fK.apply(this,arguments),_v){if(_v){var m=NS;_v=!1,NS=null}else throw Error(Pt(198));VS||(VS=!0,uP=m)}}function vm(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Q$(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _D(t){if(vm(t)!==t)throw Error(Pt(188))}function mK(t){var e=t.alternate;if(!e){if(e=vm(t),e===null)throw Error(Pt(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return _D(i),t;if(s===n)return _D(i),e;s=s.sibling}throw Error(Pt(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Pt(189))}}if(r.alternate!==n)throw Error(Pt(190))}if(r.tag!==3)throw Error(Pt(188));return r.stateNode.current===r?t:e}function H$(t){return t=mK(t),t!==null?G$(t):null}function G$(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=G$(t);if(e!==null)return e;t=t.sibling}return null}var X$=tl.unstable_scheduleCallback,wD=tl.unstable_cancelCallback,gK=tl.unstable_shouldYield,yK=tl.unstable_requestPaint,Ni=tl.unstable_now,xK=tl.unstable_getCurrentPriorityLevel,lz=tl.unstable_ImmediatePriority,K$=tl.unstable_UserBlockingPriority,WS=tl.unstable_NormalPriority,vK=tl.unstable_LowPriority,Z$=tl.unstable_IdlePriority,sk=null,fu=null;function bK(t){if(fu&&typeof fu.onCommitFiberRoot=="function")try{fu.onCommitFiberRoot(sk,t,void 0,(t.current.flags&128)===128)}catch{}}var mc=Math.clz32?Math.clz32:SK,_K=Math.log,wK=Math.LN2;function SK(t){return t>>>=0,t===0?32:31-(_K(t)/wK|0)|0}var q_=64,Q_=4194304;function rv(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function US(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=rv(o):(s&=a,s!==0&&(n=rv(s)))}else a=r&~i,a!==0?n=rv(a):s!==0&&(n=rv(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-mc(e),i=1<<r,n|=t[r],e&=~i;return n}function kK(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function CK(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-mc(s),o=1<<a,d=i[a];d===-1?(!(o&r)||o&n)&&(i[a]=kK(o,e)):d<=e&&(t.expiredLanes|=o),s&=~o}}function hP(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Y$(){var t=q_;return q_<<=1,!(q_&4194240)&&(q_=64),t}function NT(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function a1(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-mc(e),t[e]=r}function TK(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-mc(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function cz(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-mc(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Vn=0;function J$(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var eN,uz,tN,rN,nN,dP=!1,H_=[],Fd=null,Bd=null,$d=null,eb=new Map,tb=new Map,bd=[],OK="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function SD(t,e){switch(t){case"focusin":case"focusout":Fd=null;break;case"dragenter":case"dragleave":Bd=null;break;case"mouseover":case"mouseout":$d=null;break;case"pointerover":case"pointerout":eb.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":tb.delete(e.pointerId)}}function zx(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=c1(e),e!==null&&uz(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function jK(t,e,r,n,i){switch(e){case"focusin":return Fd=zx(Fd,t,e,r,n,i),!0;case"dragenter":return Bd=zx(Bd,t,e,r,n,i),!0;case"mouseover":return $d=zx($d,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return eb.set(s,zx(eb.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,tb.set(s,zx(tb.get(s)||null,t,e,r,n,i)),!0}return!1}function iN(t){var e=mp(t.target);if(e!==null){var r=vm(e);if(r!==null){if(e=r.tag,e===13){if(e=Q$(r),e!==null){t.blockedOn=e,nN(t.priority,function(){tN(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Xw(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=fP(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);aP=n,r.target.dispatchEvent(n),aP=null}else return e=c1(r),e!==null&&uz(e),t.blockedOn=r,!1;e.shift()}return!0}function kD(t,e,r){Xw(t)&&r.delete(e)}function PK(){dP=!1,Fd!==null&&Xw(Fd)&&(Fd=null),Bd!==null&&Xw(Bd)&&(Bd=null),$d!==null&&Xw($d)&&($d=null),eb.forEach(kD),tb.forEach(kD)}function Mx(t,e){t.blockedOn===e&&(t.blockedOn=null,dP||(dP=!0,tl.unstable_scheduleCallback(tl.unstable_NormalPriority,PK)))}function rb(t){function e(i){return Mx(i,t)}if(0<H_.length){Mx(H_[0],t);for(var r=1;r<H_.length;r++){var n=H_[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Fd!==null&&Mx(Fd,t),Bd!==null&&Mx(Bd,t),$d!==null&&Mx($d,t),eb.forEach(e),tb.forEach(e),r=0;r<bd.length;r++)n=bd[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<bd.length&&(r=bd[0],r.blockedOn===null);)iN(r),r.blockedOn===null&&bd.shift()}var ny=Oh.ReactCurrentBatchConfig,qS=!0;function AK(t,e,r,n){var i=Vn,s=ny.transition;ny.transition=null;try{Vn=1,hz(t,e,r,n)}finally{Vn=i,ny.transition=s}}function EK(t,e,r,n){var i=Vn,s=ny.transition;ny.transition=null;try{Vn=4,hz(t,e,r,n)}finally{Vn=i,ny.transition=s}}function hz(t,e,r,n){if(qS){var i=fP(t,e,r,n);if(i===null)ZT(t,e,n,QS,r),SD(t,n);else if(jK(i,t,e,r,n))n.stopPropagation();else if(SD(t,n),e&4&&-1<OK.indexOf(t)){for(;i!==null;){var s=c1(i);if(s!==null&&eN(s),s=fP(t,e,r,n),s===null&&ZT(t,e,n,QS,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else ZT(t,e,n,null,r)}}var QS=null;function fP(t,e,r,n){if(QS=null,t=az(n),t=mp(t),t!==null)if(e=vm(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Q$(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return QS=t,null}function sN(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xK()){case lz:return 1;case K$:return 4;case WS:case vK:return 16;case Z$:return 536870912;default:return 16}default:return 16}}var Md=null,dz=null,Kw=null;function oN(){if(Kw)return Kw;var t,e=dz,r=e.length,n,i="value"in Md?Md.value:Md.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return Kw=i.slice(t,1<n?1-n:void 0)}function Zw(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function G_(){return!0}function CD(){return!1}function ol(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?G_:CD,this.isPropagationStopped=CD,this}return ji(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=G_)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=G_)},persist:function(){},isPersistent:G_}),e}var y0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fz=ol(y0),l1=ji({},y0,{view:0,detail:0}),zK=ol(l1),VT,WT,Ix,ok=ji({},l1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pz,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ix&&(Ix&&t.type==="mousemove"?(VT=t.screenX-Ix.screenX,WT=t.screenY-Ix.screenY):WT=VT=0,Ix=t),VT)},movementY:function(t){return"movementY"in t?t.movementY:WT}}),TD=ol(ok),MK=ji({},ok,{dataTransfer:0}),IK=ol(MK),RK=ji({},l1,{relatedTarget:0}),UT=ol(RK),DK=ji({},y0,{animationName:0,elapsedTime:0,pseudoElement:0}),LK=ol(DK),FK=ji({},y0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),BK=ol(FK),$K=ji({},y0,{data:0}),OD=ol($K),NK={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VK={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WK={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UK(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=WK[t])?!!e[t]:!1}function pz(){return UK}var qK=ji({},l1,{key:function(t){if(t.key){var e=NK[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Zw(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?VK[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pz,charCode:function(t){return t.type==="keypress"?Zw(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Zw(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),QK=ol(qK),HK=ji({},ok,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jD=ol(HK),GK=ji({},l1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pz}),XK=ol(GK),KK=ji({},y0,{propertyName:0,elapsedTime:0,pseudoElement:0}),ZK=ol(KK),YK=ji({},ok,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),JK=ol(YK),eZ=[9,13,27,32],mz=yh&&"CompositionEvent"in window,wv=null;yh&&"documentMode"in document&&(wv=document.documentMode);var tZ=yh&&"TextEvent"in window&&!wv,aN=yh&&(!mz||wv&&8<wv&&11>=wv),PD=" ",AD=!1;function lN(t,e){switch(t){case"keyup":return eZ.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cN(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pg=!1;function rZ(t,e){switch(t){case"compositionend":return cN(e);case"keypress":return e.which!==32?null:(AD=!0,PD);case"textInput":return t=e.data,t===PD&&AD?null:t;default:return null}}function nZ(t,e){if(Pg)return t==="compositionend"||!mz&&lN(t,e)?(t=oN(),Kw=dz=Md=null,Pg=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return aN&&e.locale!=="ko"?null:e.data;default:return null}}var iZ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ED(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!iZ[t.type]:e==="textarea"}function uN(t,e,r,n){N$(n),e=HS(e,"onChange"),0<e.length&&(r=new fz("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Sv=null,nb=null;function sZ(t){_N(t,0)}function ak(t){var e=zg(t);if(I$(e))return t}function oZ(t,e){if(t==="change")return e}var hN=!1;if(yh){var qT;if(yh){var QT="oninput"in document;if(!QT){var zD=document.createElement("div");zD.setAttribute("oninput","return;"),QT=typeof zD.oninput=="function"}qT=QT}else qT=!1;hN=qT&&(!document.documentMode||9<document.documentMode)}function MD(){Sv&&(Sv.detachEvent("onpropertychange",dN),nb=Sv=null)}function dN(t){if(t.propertyName==="value"&&ak(nb)){var e=[];uN(e,nb,t,az(t)),q$(sZ,e)}}function aZ(t,e,r){t==="focusin"?(MD(),Sv=e,nb=r,Sv.attachEvent("onpropertychange",dN)):t==="focusout"&&MD()}function lZ(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ak(nb)}function cZ(t,e){if(t==="click")return ak(e)}function uZ(t,e){if(t==="input"||t==="change")return ak(e)}function hZ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var xc=typeof Object.is=="function"?Object.is:hZ;function ib(t,e){if(xc(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Xj.call(e,i)||!xc(t[i],e[i]))return!1}return!0}function ID(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function RD(t,e){var r=ID(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ID(r)}}function fN(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?fN(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function pN(){for(var t=window,e=$S();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=$S(t.document)}return e}function gz(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function dZ(t){var e=pN(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&fN(r.ownerDocument.documentElement,r)){if(n!==null&&gz(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=RD(r,s);var a=RD(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var fZ=yh&&"documentMode"in document&&11>=document.documentMode,Ag=null,pP=null,kv=null,mP=!1;function DD(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;mP||Ag==null||Ag!==$S(n)||(n=Ag,"selectionStart"in n&&gz(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),kv&&ib(kv,n)||(kv=n,n=HS(pP,"onSelect"),0<n.length&&(e=new fz("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Ag)))}function X_(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Eg={animationend:X_("Animation","AnimationEnd"),animationiteration:X_("Animation","AnimationIteration"),animationstart:X_("Animation","AnimationStart"),transitionend:X_("Transition","TransitionEnd")},HT={},mN={};yh&&(mN=document.createElement("div").style,"AnimationEvent"in window||(delete Eg.animationend.animation,delete Eg.animationiteration.animation,delete Eg.animationstart.animation),"TransitionEvent"in window||delete Eg.transitionend.transition);function lk(t){if(HT[t])return HT[t];if(!Eg[t])return t;var e=Eg[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in mN)return HT[t]=e[r];return t}var gN=lk("animationend"),yN=lk("animationiteration"),xN=lk("animationstart"),vN=lk("transitionend"),bN=new Map,LD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xf(t,e){bN.set(t,e),xm(e,[t])}for(var GT=0;GT<LD.length;GT++){var XT=LD[GT],pZ=XT.toLowerCase(),mZ=XT[0].toUpperCase()+XT.slice(1);xf(pZ,"on"+mZ)}xf(gN,"onAnimationEnd");xf(yN,"onAnimationIteration");xf(xN,"onAnimationStart");xf("dblclick","onDoubleClick");xf("focusin","onFocus");xf("focusout","onBlur");xf(vN,"onTransitionEnd");Ly("onMouseEnter",["mouseout","mouseover"]);Ly("onMouseLeave",["mouseout","mouseover"]);Ly("onPointerEnter",["pointerout","pointerover"]);Ly("onPointerLeave",["pointerout","pointerover"]);xm("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xm("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xm("onBeforeInput",["compositionend","keypress","textInput","paste"]);xm("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xm("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xm("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gZ=new Set("cancel close invalid load scroll toggle".split(" ").concat(nv));function FD(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,pK(n,e,void 0,t),t.currentTarget=null}function _N(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],d=o.instance,m=o.currentTarget;if(o=o.listener,d!==s&&i.isPropagationStopped())break e;FD(i,o,m),s=d}else for(a=0;a<n.length;a++){if(o=n[a],d=o.instance,m=o.currentTarget,o=o.listener,d!==s&&i.isPropagationStopped())break e;FD(i,o,m),s=d}}}if(VS)throw t=uP,VS=!1,uP=null,t}function li(t,e){var r=e[bP];r===void 0&&(r=e[bP]=new Set);var n=t+"__bubble";r.has(n)||(wN(e,t,2,!1),r.add(n))}function KT(t,e,r){var n=0;e&&(n|=4),wN(r,t,n,e)}var K_="_reactListening"+Math.random().toString(36).slice(2);function sb(t){if(!t[K_]){t[K_]=!0,P$.forEach(function(r){r!=="selectionchange"&&(gZ.has(r)||KT(r,!1,t),KT(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[K_]||(e[K_]=!0,KT("selectionchange",!1,e))}}function wN(t,e,r,n){switch(sN(e)){case 1:var i=AK;break;case 4:i=EK;break;default:i=hz}r=i.bind(null,e,r,t),i=void 0,!cP||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function ZT(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===i||d.nodeType===8&&d.parentNode===i))return;a=a.return}for(;o!==null;){if(a=mp(o),a===null)return;if(d=a.tag,d===5||d===6){n=s=a;continue e}o=o.parentNode}}n=n.return}q$(function(){var m=s,y=az(r),v=[];e:{var w=bN.get(t);if(w!==void 0){var O=fz,P=t;switch(t){case"keypress":if(Zw(r)===0)break e;case"keydown":case"keyup":O=QK;break;case"focusin":P="focus",O=UT;break;case"focusout":P="blur",O=UT;break;case"beforeblur":case"afterblur":O=UT;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":O=TD;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":O=IK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":O=XK;break;case gN:case yN:case xN:O=LK;break;case vN:O=ZK;break;case"scroll":O=zK;break;case"wheel":O=JK;break;case"copy":case"cut":case"paste":O=BK;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":O=jD}var E=(e&4)!==0,$=!E&&t==="scroll",R=E?w!==null?w+"Capture":null:w;E=[];for(var F=m,D;F!==null;){D=F;var U=D.stateNode;if(D.tag===5&&U!==null&&(D=U,R!==null&&(U=Jv(F,R),U!=null&&E.push(ob(F,U,D)))),$)break;F=F.return}0<E.length&&(w=new O(w,P,null,r,y),v.push({event:w,listeners:E}))}}if(!(e&7)){e:{if(w=t==="mouseover"||t==="pointerover",O=t==="mouseout"||t==="pointerout",w&&r!==aP&&(P=r.relatedTarget||r.fromElement)&&(mp(P)||P[xh]))break e;if((O||w)&&(w=y.window===y?y:(w=y.ownerDocument)?w.defaultView||w.parentWindow:window,O?(P=r.relatedTarget||r.toElement,O=m,P=P?mp(P):null,P!==null&&($=vm(P),P!==$||P.tag!==5&&P.tag!==6)&&(P=null)):(O=null,P=m),O!==P)){if(E=TD,U="onMouseLeave",R="onMouseEnter",F="mouse",(t==="pointerout"||t==="pointerover")&&(E=jD,U="onPointerLeave",R="onPointerEnter",F="pointer"),$=O==null?w:zg(O),D=P==null?w:zg(P),w=new E(U,F+"leave",O,r,y),w.target=$,w.relatedTarget=D,U=null,mp(y)===m&&(E=new E(R,F+"enter",P,r,y),E.target=D,E.relatedTarget=$,U=E),$=U,O&&P)t:{for(E=O,R=P,F=0,D=E;D;D=mg(D))F++;for(D=0,U=R;U;U=mg(U))D++;for(;0<F-D;)E=mg(E),F--;for(;0<D-F;)R=mg(R),D--;for(;F--;){if(E===R||R!==null&&E===R.alternate)break t;E=mg(E),R=mg(R)}E=null}else E=null;O!==null&&BD(v,w,O,E,!1),P!==null&&$!==null&&BD(v,$,P,E,!0)}}e:{if(w=m?zg(m):window,O=w.nodeName&&w.nodeName.toLowerCase(),O==="select"||O==="input"&&w.type==="file")var X=oZ;else if(ED(w))if(hN)X=uZ;else{X=lZ;var ee=aZ}else(O=w.nodeName)&&O.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(X=cZ);if(X&&(X=X(t,m))){uN(v,X,r,y);break e}ee&&ee(t,w,m),t==="focusout"&&(ee=w._wrapperState)&&ee.controlled&&w.type==="number"&&rP(w,"number",w.value)}switch(ee=m?zg(m):window,t){case"focusin":(ED(ee)||ee.contentEditable==="true")&&(Ag=ee,pP=m,kv=null);break;case"focusout":kv=pP=Ag=null;break;case"mousedown":mP=!0;break;case"contextmenu":case"mouseup":case"dragend":mP=!1,DD(v,r,y);break;case"selectionchange":if(fZ)break;case"keydown":case"keyup":DD(v,r,y)}var K;if(mz)e:{switch(t){case"compositionstart":var Y="onCompositionStart";break e;case"compositionend":Y="onCompositionEnd";break e;case"compositionupdate":Y="onCompositionUpdate";break e}Y=void 0}else Pg?lN(t,r)&&(Y="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(Y="onCompositionStart");Y&&(aN&&r.locale!=="ko"&&(Pg||Y!=="onCompositionStart"?Y==="onCompositionEnd"&&Pg&&(K=oN()):(Md=y,dz="value"in Md?Md.value:Md.textContent,Pg=!0)),ee=HS(m,Y),0<ee.length&&(Y=new OD(Y,t,null,r,y),v.push({event:Y,listeners:ee}),K?Y.data=K:(K=cN(r),K!==null&&(Y.data=K)))),(K=tZ?rZ(t,r):nZ(t,r))&&(m=HS(m,"onBeforeInput"),0<m.length&&(y=new OD("onBeforeInput","beforeinput",null,r,y),v.push({event:y,listeners:m}),y.data=K))}_N(v,e)})}function ob(t,e,r){return{instance:t,listener:e,currentTarget:r}}function HS(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Jv(t,r),s!=null&&n.unshift(ob(t,s,i)),s=Jv(t,e),s!=null&&n.push(ob(t,s,i))),t=t.return}return n}function mg(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function BD(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,d=o.alternate,m=o.stateNode;if(d!==null&&d===n)break;o.tag===5&&m!==null&&(o=m,i?(d=Jv(r,s),d!=null&&a.unshift(ob(r,d,o))):i||(d=Jv(r,s),d!=null&&a.push(ob(r,d,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var yZ=/\r\n?/g,xZ=/\u0000|\uFFFD/g;function $D(t){return(typeof t=="string"?t:""+t).replace(yZ,`
`).replace(xZ,"")}function Z_(t,e,r){if(e=$D(e),$D(t)!==e&&r)throw Error(Pt(425))}function GS(){}var gP=null,yP=null;function xP(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var vP=typeof setTimeout=="function"?setTimeout:void 0,vZ=typeof clearTimeout=="function"?clearTimeout:void 0,ND=typeof Promise=="function"?Promise:void 0,bZ=typeof queueMicrotask=="function"?queueMicrotask:typeof ND<"u"?function(t){return ND.resolve(null).then(t).catch(_Z)}:vP;function _Z(t){setTimeout(function(){throw t})}function YT(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),rb(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);rb(e)}function Nd(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function VD(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var x0=Math.random().toString(36).slice(2),ru="__reactFiber$"+x0,ab="__reactProps$"+x0,xh="__reactContainer$"+x0,bP="__reactEvents$"+x0,wZ="__reactListeners$"+x0,SZ="__reactHandles$"+x0;function mp(t){var e=t[ru];if(e)return e;for(var r=t.parentNode;r;){if(e=r[xh]||r[ru]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=VD(t);t!==null;){if(r=t[ru])return r;t=VD(t)}return e}t=r,r=t.parentNode}return null}function c1(t){return t=t[ru]||t[xh],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function zg(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Pt(33))}function ck(t){return t[ab]||null}var _P=[],Mg=-1;function vf(t){return{current:t}}function ui(t){0>Mg||(t.current=_P[Mg],_P[Mg]=null,Mg--)}function ni(t,e){Mg++,_P[Mg]=t.current,t.current=e}var Jd={},Co=vf(Jd),ka=vf(!1),Zp=Jd;function Fy(t,e){var r=t.type.contextTypes;if(!r)return Jd;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ca(t){return t=t.childContextTypes,t!=null}function XS(){ui(ka),ui(Co)}function WD(t,e,r){if(Co.current!==Jd)throw Error(Pt(168));ni(Co,e),ni(ka,r)}function SN(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Pt(108,aK(t)||"Unknown",i));return ji({},r,n)}function KS(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Jd,Zp=Co.current,ni(Co,t),ni(ka,ka.current),!0}function UD(t,e,r){var n=t.stateNode;if(!n)throw Error(Pt(169));r?(t=SN(t,e,Zp),n.__reactInternalMemoizedMergedChildContext=t,ui(ka),ui(Co),ni(Co,t)):ui(ka),ni(ka,r)}var Gu=null,uk=!1,JT=!1;function kN(t){Gu===null?Gu=[t]:Gu.push(t)}function kZ(t){uk=!0,kN(t)}function bf(){if(!JT&&Gu!==null){JT=!0;var t=0,e=Vn;try{var r=Gu;for(Vn=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Gu=null,uk=!1}catch(i){throw Gu!==null&&(Gu=Gu.slice(t+1)),X$(lz,bf),i}finally{Vn=e,JT=!1}}return null}var Ig=[],Rg=0,ZS=null,YS=0,kl=[],Cl=0,Yp=null,sh=1,oh="";function sp(t,e){Ig[Rg++]=YS,Ig[Rg++]=ZS,ZS=t,YS=e}function CN(t,e,r){kl[Cl++]=sh,kl[Cl++]=oh,kl[Cl++]=Yp,Yp=t;var n=sh;t=oh;var i=32-mc(n)-1;n&=~(1<<i),r+=1;var s=32-mc(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,sh=1<<32-mc(e)+i|r<<i|n,oh=s+t}else sh=1<<s|r<<i|n,oh=t}function yz(t){t.return!==null&&(sp(t,1),CN(t,1,0))}function xz(t){for(;t===ZS;)ZS=Ig[--Rg],Ig[Rg]=null,YS=Ig[--Rg],Ig[Rg]=null;for(;t===Yp;)Yp=kl[--Cl],kl[Cl]=null,oh=kl[--Cl],kl[Cl]=null,sh=kl[--Cl],kl[Cl]=null}var Ya=null,Xa=null,xi=!1,uc=null;function TN(t,e){var r=El(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function qD(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ya=t,Xa=Nd(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ya=t,Xa=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Yp!==null?{id:sh,overflow:oh}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=El(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Ya=t,Xa=null,!0):!1;default:return!1}}function wP(t){return(t.mode&1)!==0&&(t.flags&128)===0}function SP(t){if(xi){var e=Xa;if(e){var r=e;if(!qD(t,e)){if(wP(t))throw Error(Pt(418));e=Nd(r.nextSibling);var n=Ya;e&&qD(t,e)?TN(n,r):(t.flags=t.flags&-4097|2,xi=!1,Ya=t)}}else{if(wP(t))throw Error(Pt(418));t.flags=t.flags&-4097|2,xi=!1,Ya=t}}}function QD(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ya=t}function Y_(t){if(t!==Ya)return!1;if(!xi)return QD(t),xi=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!xP(t.type,t.memoizedProps)),e&&(e=Xa)){if(wP(t))throw ON(),Error(Pt(418));for(;e;)TN(t,e),e=Nd(e.nextSibling)}if(QD(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Pt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Xa=Nd(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Xa=null}}else Xa=Ya?Nd(t.stateNode.nextSibling):null;return!0}function ON(){for(var t=Xa;t;)t=Nd(t.nextSibling)}function By(){Xa=Ya=null,xi=!1}function vz(t){uc===null?uc=[t]:uc.push(t)}var CZ=Oh.ReactCurrentBatchConfig;function Rx(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Pt(309));var n=r.stateNode}if(!n)throw Error(Pt(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Pt(284));if(!r._owner)throw Error(Pt(290,t))}return t}function J_(t,e){throw t=Object.prototype.toString.call(e),Error(Pt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function HD(t){var e=t._init;return e(t._payload)}function jN(t){function e(R,F){if(t){var D=R.deletions;D===null?(R.deletions=[F],R.flags|=16):D.push(F)}}function r(R,F){if(!t)return null;for(;F!==null;)e(R,F),F=F.sibling;return null}function n(R,F){for(R=new Map;F!==null;)F.key!==null?R.set(F.key,F):R.set(F.index,F),F=F.sibling;return R}function i(R,F){return R=qd(R,F),R.index=0,R.sibling=null,R}function s(R,F,D){return R.index=D,t?(D=R.alternate,D!==null?(D=D.index,D<F?(R.flags|=2,F):D):(R.flags|=2,F)):(R.flags|=1048576,F)}function a(R){return t&&R.alternate===null&&(R.flags|=2),R}function o(R,F,D,U){return F===null||F.tag!==6?(F=oO(D,R.mode,U),F.return=R,F):(F=i(F,D),F.return=R,F)}function d(R,F,D,U){var X=D.type;return X===jg?y(R,F,D.props.children,U,D.key):F!==null&&(F.elementType===X||typeof X=="object"&&X!==null&&X.$$typeof===pd&&HD(X)===F.type)?(U=i(F,D.props),U.ref=Rx(R,F,D),U.return=R,U):(U=iS(D.type,D.key,D.props,null,R.mode,U),U.ref=Rx(R,F,D),U.return=R,U)}function m(R,F,D,U){return F===null||F.tag!==4||F.stateNode.containerInfo!==D.containerInfo||F.stateNode.implementation!==D.implementation?(F=aO(D,R.mode,U),F.return=R,F):(F=i(F,D.children||[]),F.return=R,F)}function y(R,F,D,U,X){return F===null||F.tag!==7?(F=Ip(D,R.mode,U,X),F.return=R,F):(F=i(F,D),F.return=R,F)}function v(R,F,D){if(typeof F=="string"&&F!==""||typeof F=="number")return F=oO(""+F,R.mode,D),F.return=R,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case V_:return D=iS(F.type,F.key,F.props,null,R.mode,D),D.ref=Rx(R,null,F),D.return=R,D;case Og:return F=aO(F,R.mode,D),F.return=R,F;case pd:var U=F._init;return v(R,U(F._payload),D)}if(tv(F)||Ax(F))return F=Ip(F,R.mode,D,null),F.return=R,F;J_(R,F)}return null}function w(R,F,D,U){var X=F!==null?F.key:null;if(typeof D=="string"&&D!==""||typeof D=="number")return X!==null?null:o(R,F,""+D,U);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case V_:return D.key===X?d(R,F,D,U):null;case Og:return D.key===X?m(R,F,D,U):null;case pd:return X=D._init,w(R,F,X(D._payload),U)}if(tv(D)||Ax(D))return X!==null?null:y(R,F,D,U,null);J_(R,D)}return null}function O(R,F,D,U,X){if(typeof U=="string"&&U!==""||typeof U=="number")return R=R.get(D)||null,o(F,R,""+U,X);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case V_:return R=R.get(U.key===null?D:U.key)||null,d(F,R,U,X);case Og:return R=R.get(U.key===null?D:U.key)||null,m(F,R,U,X);case pd:var ee=U._init;return O(R,F,D,ee(U._payload),X)}if(tv(U)||Ax(U))return R=R.get(D)||null,y(F,R,U,X,null);J_(F,U)}return null}function P(R,F,D,U){for(var X=null,ee=null,K=F,Y=F=0,ne=null;K!==null&&Y<D.length;Y++){K.index>Y?(ne=K,K=null):ne=K.sibling;var oe=w(R,K,D[Y],U);if(oe===null){K===null&&(K=ne);break}t&&K&&oe.alternate===null&&e(R,K),F=s(oe,F,Y),ee===null?X=oe:ee.sibling=oe,ee=oe,K=ne}if(Y===D.length)return r(R,K),xi&&sp(R,Y),X;if(K===null){for(;Y<D.length;Y++)K=v(R,D[Y],U),K!==null&&(F=s(K,F,Y),ee===null?X=K:ee.sibling=K,ee=K);return xi&&sp(R,Y),X}for(K=n(R,K);Y<D.length;Y++)ne=O(K,R,Y,D[Y],U),ne!==null&&(t&&ne.alternate!==null&&K.delete(ne.key===null?Y:ne.key),F=s(ne,F,Y),ee===null?X=ne:ee.sibling=ne,ee=ne);return t&&K.forEach(function(ce){return e(R,ce)}),xi&&sp(R,Y),X}function E(R,F,D,U){var X=Ax(D);if(typeof X!="function")throw Error(Pt(150));if(D=X.call(D),D==null)throw Error(Pt(151));for(var ee=X=null,K=F,Y=F=0,ne=null,oe=D.next();K!==null&&!oe.done;Y++,oe=D.next()){K.index>Y?(ne=K,K=null):ne=K.sibling;var ce=w(R,K,oe.value,U);if(ce===null){K===null&&(K=ne);break}t&&K&&ce.alternate===null&&e(R,K),F=s(ce,F,Y),ee===null?X=ce:ee.sibling=ce,ee=ce,K=ne}if(oe.done)return r(R,K),xi&&sp(R,Y),X;if(K===null){for(;!oe.done;Y++,oe=D.next())oe=v(R,oe.value,U),oe!==null&&(F=s(oe,F,Y),ee===null?X=oe:ee.sibling=oe,ee=oe);return xi&&sp(R,Y),X}for(K=n(R,K);!oe.done;Y++,oe=D.next())oe=O(K,R,Y,oe.value,U),oe!==null&&(t&&oe.alternate!==null&&K.delete(oe.key===null?Y:oe.key),F=s(oe,F,Y),ee===null?X=oe:ee.sibling=oe,ee=oe);return t&&K.forEach(function(Xe){return e(R,Xe)}),xi&&sp(R,Y),X}function $(R,F,D,U){if(typeof D=="object"&&D!==null&&D.type===jg&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case V_:e:{for(var X=D.key,ee=F;ee!==null;){if(ee.key===X){if(X=D.type,X===jg){if(ee.tag===7){r(R,ee.sibling),F=i(ee,D.props.children),F.return=R,R=F;break e}}else if(ee.elementType===X||typeof X=="object"&&X!==null&&X.$$typeof===pd&&HD(X)===ee.type){r(R,ee.sibling),F=i(ee,D.props),F.ref=Rx(R,ee,D),F.return=R,R=F;break e}r(R,ee);break}else e(R,ee);ee=ee.sibling}D.type===jg?(F=Ip(D.props.children,R.mode,U,D.key),F.return=R,R=F):(U=iS(D.type,D.key,D.props,null,R.mode,U),U.ref=Rx(R,F,D),U.return=R,R=U)}return a(R);case Og:e:{for(ee=D.key;F!==null;){if(F.key===ee)if(F.tag===4&&F.stateNode.containerInfo===D.containerInfo&&F.stateNode.implementation===D.implementation){r(R,F.sibling),F=i(F,D.children||[]),F.return=R,R=F;break e}else{r(R,F);break}else e(R,F);F=F.sibling}F=aO(D,R.mode,U),F.return=R,R=F}return a(R);case pd:return ee=D._init,$(R,F,ee(D._payload),U)}if(tv(D))return P(R,F,D,U);if(Ax(D))return E(R,F,D,U);J_(R,D)}return typeof D=="string"&&D!==""||typeof D=="number"?(D=""+D,F!==null&&F.tag===6?(r(R,F.sibling),F=i(F,D),F.return=R,R=F):(r(R,F),F=oO(D,R.mode,U),F.return=R,R=F),a(R)):r(R,F)}return $}var $y=jN(!0),PN=jN(!1),JS=vf(null),e2=null,Dg=null,bz=null;function _z(){bz=Dg=e2=null}function wz(t){var e=JS.current;ui(JS),t._currentValue=e}function kP(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function iy(t,e){e2=t,bz=Dg=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ba=!0),t.firstContext=null)}function $l(t){var e=t._currentValue;if(bz!==t)if(t={context:t,memoizedValue:e,next:null},Dg===null){if(e2===null)throw Error(Pt(308));Dg=t,e2.dependencies={lanes:0,firstContext:t}}else Dg=Dg.next=t;return e}var gp=null;function Sz(t){gp===null?gp=[t]:gp.push(t)}function AN(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Sz(e)):(r.next=i.next,i.next=r),e.interleaved=r,vh(t,n)}function vh(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var md=!1;function kz(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function EN(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function uh(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Vd(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,bn&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,vh(t,r)}return i=n.interleaved,i===null?(e.next=e,Sz(n)):(e.next=i.next,i.next=e),n.interleaved=e,vh(t,r)}function Yw(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,cz(t,r)}}function GD(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function t2(t,e,r,n){var i=t.updateQueue;md=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var d=o,m=d.next;d.next=null,a===null?s=m:a.next=m,a=d;var y=t.alternate;y!==null&&(y=y.updateQueue,o=y.lastBaseUpdate,o!==a&&(o===null?y.firstBaseUpdate=m:o.next=m,y.lastBaseUpdate=d))}if(s!==null){var v=i.baseState;a=0,y=m=d=null,o=s;do{var w=o.lane,O=o.eventTime;if((n&w)===w){y!==null&&(y=y.next={eventTime:O,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var P=t,E=o;switch(w=e,O=r,E.tag){case 1:if(P=E.payload,typeof P=="function"){v=P.call(O,v,w);break e}v=P;break e;case 3:P.flags=P.flags&-65537|128;case 0:if(P=E.payload,w=typeof P=="function"?P.call(O,v,w):P,w==null)break e;v=ji({},v,w);break e;case 2:md=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,w=i.effects,w===null?i.effects=[o]:w.push(o))}else O={eventTime:O,lane:w,tag:o.tag,payload:o.payload,callback:o.callback,next:null},y===null?(m=y=O,d=v):y=y.next=O,a|=w;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;w=o,o=w.next,w.next=null,i.lastBaseUpdate=w,i.shared.pending=null}}while(!0);if(y===null&&(d=v),i.baseState=d,i.firstBaseUpdate=m,i.lastBaseUpdate=y,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);em|=a,t.lanes=a,t.memoizedState=v}}function XD(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Pt(191,i));i.call(n)}}}var u1={},pu=vf(u1),lb=vf(u1),cb=vf(u1);function yp(t){if(t===u1)throw Error(Pt(174));return t}function Cz(t,e){switch(ni(cb,e),ni(lb,t),ni(pu,u1),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:iP(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=iP(e,t)}ui(pu),ni(pu,e)}function Ny(){ui(pu),ui(lb),ui(cb)}function zN(t){yp(cb.current);var e=yp(pu.current),r=iP(e,t.type);e!==r&&(ni(lb,t),ni(pu,r))}function Tz(t){lb.current===t&&(ui(pu),ui(lb))}var ki=vf(0);function r2(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var eO=[];function Oz(){for(var t=0;t<eO.length;t++)eO[t]._workInProgressVersionPrimary=null;eO.length=0}var Jw=Oh.ReactCurrentDispatcher,tO=Oh.ReactCurrentBatchConfig,Jp=0,Oi=null,ps=null,Fs=null,n2=!1,Cv=!1,ub=0,TZ=0;function xo(){throw Error(Pt(321))}function jz(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!xc(t[r],e[r]))return!1;return!0}function Pz(t,e,r,n,i,s){if(Jp=s,Oi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Jw.current=t===null||t.memoizedState===null?AZ:EZ,t=r(n,i),Cv){s=0;do{if(Cv=!1,ub=0,25<=s)throw Error(Pt(301));s+=1,Fs=ps=null,e.updateQueue=null,Jw.current=zZ,t=r(n,i)}while(Cv)}if(Jw.current=i2,e=ps!==null&&ps.next!==null,Jp=0,Fs=ps=Oi=null,n2=!1,e)throw Error(Pt(300));return t}function Az(){var t=ub!==0;return ub=0,t}function Gc(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fs===null?Oi.memoizedState=Fs=t:Fs=Fs.next=t,Fs}function Nl(){if(ps===null){var t=Oi.alternate;t=t!==null?t.memoizedState:null}else t=ps.next;var e=Fs===null?Oi.memoizedState:Fs.next;if(e!==null)Fs=e,ps=t;else{if(t===null)throw Error(Pt(310));ps=t,t={memoizedState:ps.memoizedState,baseState:ps.baseState,baseQueue:ps.baseQueue,queue:ps.queue,next:null},Fs===null?Oi.memoizedState=Fs=t:Fs=Fs.next=t}return Fs}function hb(t,e){return typeof e=="function"?e(t):e}function rO(t){var e=Nl(),r=e.queue;if(r===null)throw Error(Pt(311));r.lastRenderedReducer=t;var n=ps,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,d=null,m=s;do{var y=m.lane;if((Jp&y)===y)d!==null&&(d=d.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),n=m.hasEagerState?m.eagerState:t(n,m.action);else{var v={lane:y,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};d===null?(o=d=v,a=n):d=d.next=v,Oi.lanes|=y,em|=y}m=m.next}while(m!==null&&m!==s);d===null?a=n:d.next=o,xc(n,e.memoizedState)||(ba=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=d,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,Oi.lanes|=s,em|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function nO(t){var e=Nl(),r=e.queue;if(r===null)throw Error(Pt(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);xc(s,e.memoizedState)||(ba=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function MN(){}function IN(t,e){var r=Oi,n=Nl(),i=e(),s=!xc(n.memoizedState,i);if(s&&(n.memoizedState=i,ba=!0),n=n.queue,Ez(LN.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Fs!==null&&Fs.memoizedState.tag&1){if(r.flags|=2048,db(9,DN.bind(null,r,n,i,e),void 0,null),$s===null)throw Error(Pt(349));Jp&30||RN(r,e,i)}return i}function RN(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Oi.updateQueue,e===null?(e={lastEffect:null,stores:null},Oi.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function DN(t,e,r,n){e.value=r,e.getSnapshot=n,FN(e)&&BN(t)}function LN(t,e,r){return r(function(){FN(e)&&BN(t)})}function FN(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!xc(t,r)}catch{return!0}}function BN(t){var e=vh(t,1);e!==null&&gc(e,t,1,-1)}function KD(t){var e=Gc();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hb,lastRenderedState:t},e.queue=t,t=t.dispatch=PZ.bind(null,Oi,t),[e.memoizedState,t]}function db(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Oi.updateQueue,e===null?(e={lastEffect:null,stores:null},Oi.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function $N(){return Nl().memoizedState}function eS(t,e,r,n){var i=Gc();Oi.flags|=t,i.memoizedState=db(1|e,r,void 0,n===void 0?null:n)}function hk(t,e,r,n){var i=Nl();n=n===void 0?null:n;var s=void 0;if(ps!==null){var a=ps.memoizedState;if(s=a.destroy,n!==null&&jz(n,a.deps)){i.memoizedState=db(e,r,s,n);return}}Oi.flags|=t,i.memoizedState=db(1|e,r,s,n)}function ZD(t,e){return eS(8390656,8,t,e)}function Ez(t,e){return hk(2048,8,t,e)}function NN(t,e){return hk(4,2,t,e)}function VN(t,e){return hk(4,4,t,e)}function WN(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function UN(t,e,r){return r=r!=null?r.concat([t]):null,hk(4,4,WN.bind(null,e,t),r)}function zz(){}function qN(t,e){var r=Nl();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&jz(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function QN(t,e){var r=Nl();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&jz(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function HN(t,e,r){return Jp&21?(xc(r,e)||(r=Y$(),Oi.lanes|=r,em|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ba=!0),t.memoizedState=r)}function OZ(t,e){var r=Vn;Vn=r!==0&&4>r?r:4,t(!0);var n=tO.transition;tO.transition={};try{t(!1),e()}finally{Vn=r,tO.transition=n}}function GN(){return Nl().memoizedState}function jZ(t,e,r){var n=Ud(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},XN(t))KN(e,r);else if(r=AN(t,e,r,n),r!==null){var i=Qo();gc(r,t,n,i),ZN(r,e,n)}}function PZ(t,e,r){var n=Ud(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(XN(t))KN(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,xc(o,a)){var d=e.interleaved;d===null?(i.next=i,Sz(e)):(i.next=d.next,d.next=i),e.interleaved=i;return}}catch{}finally{}r=AN(t,e,i,n),r!==null&&(i=Qo(),gc(r,t,n,i),ZN(r,e,n))}}function XN(t){var e=t.alternate;return t===Oi||e!==null&&e===Oi}function KN(t,e){Cv=n2=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function ZN(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,cz(t,r)}}var i2={readContext:$l,useCallback:xo,useContext:xo,useEffect:xo,useImperativeHandle:xo,useInsertionEffect:xo,useLayoutEffect:xo,useMemo:xo,useReducer:xo,useRef:xo,useState:xo,useDebugValue:xo,useDeferredValue:xo,useTransition:xo,useMutableSource:xo,useSyncExternalStore:xo,useId:xo,unstable_isNewReconciler:!1},AZ={readContext:$l,useCallback:function(t,e){return Gc().memoizedState=[t,e===void 0?null:e],t},useContext:$l,useEffect:ZD,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,eS(4194308,4,WN.bind(null,e,t),r)},useLayoutEffect:function(t,e){return eS(4194308,4,t,e)},useInsertionEffect:function(t,e){return eS(4,2,t,e)},useMemo:function(t,e){var r=Gc();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Gc();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=jZ.bind(null,Oi,t),[n.memoizedState,t]},useRef:function(t){var e=Gc();return t={current:t},e.memoizedState=t},useState:KD,useDebugValue:zz,useDeferredValue:function(t){return Gc().memoizedState=t},useTransition:function(){var t=KD(!1),e=t[0];return t=OZ.bind(null,t[1]),Gc().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Oi,i=Gc();if(xi){if(r===void 0)throw Error(Pt(407));r=r()}else{if(r=e(),$s===null)throw Error(Pt(349));Jp&30||RN(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,ZD(LN.bind(null,n,s,t),[t]),n.flags|=2048,db(9,DN.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=Gc(),e=$s.identifierPrefix;if(xi){var r=oh,n=sh;r=(n&~(1<<32-mc(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=ub++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=TZ++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},EZ={readContext:$l,useCallback:qN,useContext:$l,useEffect:Ez,useImperativeHandle:UN,useInsertionEffect:NN,useLayoutEffect:VN,useMemo:QN,useReducer:rO,useRef:$N,useState:function(){return rO(hb)},useDebugValue:zz,useDeferredValue:function(t){var e=Nl();return HN(e,ps.memoizedState,t)},useTransition:function(){var t=rO(hb)[0],e=Nl().memoizedState;return[t,e]},useMutableSource:MN,useSyncExternalStore:IN,useId:GN,unstable_isNewReconciler:!1},zZ={readContext:$l,useCallback:qN,useContext:$l,useEffect:Ez,useImperativeHandle:UN,useInsertionEffect:NN,useLayoutEffect:VN,useMemo:QN,useReducer:nO,useRef:$N,useState:function(){return nO(hb)},useDebugValue:zz,useDeferredValue:function(t){var e=Nl();return ps===null?e.memoizedState=t:HN(e,ps.memoizedState,t)},useTransition:function(){var t=nO(hb)[0],e=Nl().memoizedState;return[t,e]},useMutableSource:MN,useSyncExternalStore:IN,useId:GN,unstable_isNewReconciler:!1};function oc(t,e){if(t&&t.defaultProps){e=ji({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function CP(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:ji({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var dk={isMounted:function(t){return(t=t._reactInternals)?vm(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Qo(),i=Ud(t),s=uh(n,i);s.payload=e,r!=null&&(s.callback=r),e=Vd(t,s,i),e!==null&&(gc(e,t,i,n),Yw(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Qo(),i=Ud(t),s=uh(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Vd(t,s,i),e!==null&&(gc(e,t,i,n),Yw(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Qo(),n=Ud(t),i=uh(r,n);i.tag=2,e!=null&&(i.callback=e),e=Vd(t,i,n),e!==null&&(gc(e,t,n,r),Yw(e,t,n))}};function YD(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!ib(r,n)||!ib(i,s):!0}function YN(t,e,r){var n=!1,i=Jd,s=e.contextType;return typeof s=="object"&&s!==null?s=$l(s):(i=Ca(e)?Zp:Co.current,n=e.contextTypes,s=(n=n!=null)?Fy(t,i):Jd),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=dk,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function JD(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&dk.enqueueReplaceState(e,e.state,null)}function TP(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},kz(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=$l(s):(s=Ca(e)?Zp:Co.current,i.context=Fy(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(CP(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&dk.enqueueReplaceState(i,i.state,null),t2(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Vy(t,e){try{var r="",n=e;do r+=oK(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function iO(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function OP(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var MZ=typeof WeakMap=="function"?WeakMap:Map;function JN(t,e,r){r=uh(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){o2||(o2=!0,LP=n),OP(t,e)},r}function e8(t,e,r){r=uh(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){OP(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){OP(t,e),typeof n!="function"&&(Wd===null?Wd=new Set([this]):Wd.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function e3(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new MZ;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=HZ.bind(null,t,e,r),e.then(t,t))}function t3(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function r3(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=uh(-1,1),e.tag=2,Vd(r,e,1))),r.lanes|=1),t)}var IZ=Oh.ReactCurrentOwner,ba=!1;function Bo(t,e,r,n){e.child=t===null?PN(e,null,r,n):$y(e,t.child,r,n)}function n3(t,e,r,n,i){r=r.render;var s=e.ref;return iy(e,i),n=Pz(t,e,r,n,s,i),r=Az(),t!==null&&!ba?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,bh(t,e,i)):(xi&&r&&yz(e),e.flags|=1,Bo(t,e,n,i),e.child)}function i3(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!$z(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,t8(t,e,s,n,i)):(t=iS(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:ib,r(a,n)&&t.ref===e.ref)return bh(t,e,i)}return e.flags|=1,t=qd(s,n),t.ref=e.ref,t.return=e,e.child=t}function t8(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(ib(s,n)&&t.ref===e.ref)if(ba=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(ba=!0);else return e.lanes=t.lanes,bh(t,e,i)}return jP(t,e,r,n,i)}function r8(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ni(Fg,Qa),Qa|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ni(Fg,Qa),Qa|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,ni(Fg,Qa),Qa|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,ni(Fg,Qa),Qa|=n;return Bo(t,e,i,r),e.child}function n8(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function jP(t,e,r,n,i){var s=Ca(r)?Zp:Co.current;return s=Fy(e,s),iy(e,i),r=Pz(t,e,r,n,s,i),n=Az(),t!==null&&!ba?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,bh(t,e,i)):(xi&&n&&yz(e),e.flags|=1,Bo(t,e,r,i),e.child)}function s3(t,e,r,n,i){if(Ca(r)){var s=!0;KS(e)}else s=!1;if(iy(e,i),e.stateNode===null)tS(t,e),YN(e,r,n),TP(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var d=a.context,m=r.contextType;typeof m=="object"&&m!==null?m=$l(m):(m=Ca(r)?Zp:Co.current,m=Fy(e,m));var y=r.getDerivedStateFromProps,v=typeof y=="function"||typeof a.getSnapshotBeforeUpdate=="function";v||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||d!==m)&&JD(e,a,n,m),md=!1;var w=e.memoizedState;a.state=w,t2(e,n,a,i),d=e.memoizedState,o!==n||w!==d||ka.current||md?(typeof y=="function"&&(CP(e,r,y,n),d=e.memoizedState),(o=md||YD(e,r,o,n,w,d,m))?(v||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=d),a.props=n,a.state=d,a.context=m,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,EN(t,e),o=e.memoizedProps,m=e.type===e.elementType?o:oc(e.type,o),a.props=m,v=e.pendingProps,w=a.context,d=r.contextType,typeof d=="object"&&d!==null?d=$l(d):(d=Ca(r)?Zp:Co.current,d=Fy(e,d));var O=r.getDerivedStateFromProps;(y=typeof O=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==v||w!==d)&&JD(e,a,n,d),md=!1,w=e.memoizedState,a.state=w,t2(e,n,a,i);var P=e.memoizedState;o!==v||w!==P||ka.current||md?(typeof O=="function"&&(CP(e,r,O,n),P=e.memoizedState),(m=md||YD(e,r,m,n,w,P,d)||!1)?(y||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,P,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,P,d)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=P),a.props=n,a.state=P,a.context=d,n=m):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),n=!1)}return PP(t,e,r,n,s,i)}function PP(t,e,r,n,i,s){n8(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&UD(e,r,!1),bh(t,e,s);n=e.stateNode,IZ.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=$y(e,t.child,null,s),e.child=$y(e,null,o,s)):Bo(t,e,o,s),e.memoizedState=n.state,i&&UD(e,r,!0),e.child}function i8(t){var e=t.stateNode;e.pendingContext?WD(t,e.pendingContext,e.pendingContext!==e.context):e.context&&WD(t,e.context,!1),Cz(t,e.containerInfo)}function o3(t,e,r,n,i){return By(),vz(i),e.flags|=256,Bo(t,e,r,n),e.child}var AP={dehydrated:null,treeContext:null,retryLane:0};function EP(t){return{baseLanes:t,cachePool:null,transitions:null}}function s8(t,e,r){var n=e.pendingProps,i=ki.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ni(ki,i&1),t===null)return SP(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=mk(a,n,0,null),t=Ip(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=EP(r),e.memoizedState=AP,t):Mz(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return RZ(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var d={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=d,e.deletions=null):(n=qd(i,d),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=qd(o,s):(s=Ip(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?EP(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=AP,n}return s=t.child,t=s.sibling,n=qd(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Mz(t,e){return e=mk({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ew(t,e,r,n){return n!==null&&vz(n),$y(e,t.child,null,r),t=Mz(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function RZ(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=iO(Error(Pt(422))),ew(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=mk({mode:"visible",children:n.children},i,0,null),s=Ip(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&$y(e,t.child,null,a),e.child.memoizedState=EP(a),e.memoizedState=AP,s);if(!(e.mode&1))return ew(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Pt(419)),n=iO(s,n,void 0),ew(t,e,a,n)}if(o=(a&t.childLanes)!==0,ba||o){if(n=$s,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,vh(t,i),gc(n,t,i,-1))}return Bz(),n=iO(Error(Pt(421))),ew(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=GZ.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Xa=Nd(i.nextSibling),Ya=e,xi=!0,uc=null,t!==null&&(kl[Cl++]=sh,kl[Cl++]=oh,kl[Cl++]=Yp,sh=t.id,oh=t.overflow,Yp=e),e=Mz(e,n.children),e.flags|=4096,e)}function a3(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),kP(t.return,e,r)}function sO(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function o8(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Bo(t,e,n.children,r),n=ki.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&a3(t,r,e);else if(t.tag===19)a3(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ni(ki,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&r2(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),sO(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&r2(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}sO(e,!0,r,null,s);break;case"together":sO(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function tS(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function bh(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),em|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Pt(153));if(e.child!==null){for(t=e.child,r=qd(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=qd(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function DZ(t,e,r){switch(e.tag){case 3:i8(e),By();break;case 5:zN(e);break;case 1:Ca(e.type)&&KS(e);break;case 4:Cz(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;ni(JS,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(ni(ki,ki.current&1),e.flags|=128,null):r&e.child.childLanes?s8(t,e,r):(ni(ki,ki.current&1),t=bh(t,e,r),t!==null?t.sibling:null);ni(ki,ki.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return o8(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ni(ki,ki.current),n)break;return null;case 22:case 23:return e.lanes=0,r8(t,e,r)}return bh(t,e,r)}var a8,zP,l8,c8;a8=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};zP=function(){};l8=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,yp(pu.current);var s=null;switch(r){case"input":i=eP(t,i),n=eP(t,n),s=[];break;case"select":i=ji({},i,{value:void 0}),n=ji({},n,{value:void 0}),s=[];break;case"textarea":i=nP(t,i),n=nP(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=GS)}sP(r,n);var a;r=null;for(m in i)if(!n.hasOwnProperty(m)&&i.hasOwnProperty(m)&&i[m]!=null)if(m==="style"){var o=i[m];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(Zv.hasOwnProperty(m)?s||(s=[]):(s=s||[]).push(m,null));for(m in n){var d=n[m];if(o=i!=null?i[m]:void 0,n.hasOwnProperty(m)&&d!==o&&(d!=null||o!=null))if(m==="style")if(o){for(a in o)!o.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in d)d.hasOwnProperty(a)&&o[a]!==d[a]&&(r||(r={}),r[a]=d[a])}else r||(s||(s=[]),s.push(m,r)),r=d;else m==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,o=o?o.__html:void 0,d!=null&&o!==d&&(s=s||[]).push(m,d)):m==="children"?typeof d!="string"&&typeof d!="number"||(s=s||[]).push(m,""+d):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(Zv.hasOwnProperty(m)?(d!=null&&m==="onScroll"&&li("scroll",t),s||o===d||(s=[])):(s=s||[]).push(m,d))}r&&(s=s||[]).push("style",r);var m=s;(e.updateQueue=m)&&(e.flags|=4)}};c8=function(t,e,r,n){r!==n&&(e.flags|=4)};function Dx(t,e){if(!xi)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function vo(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function LZ(t,e,r){var n=e.pendingProps;switch(xz(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vo(e),null;case 1:return Ca(e.type)&&XS(),vo(e),null;case 3:return n=e.stateNode,Ny(),ui(ka),ui(Co),Oz(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Y_(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,uc!==null&&($P(uc),uc=null))),zP(t,e),vo(e),null;case 5:Tz(e);var i=yp(cb.current);if(r=e.type,t!==null&&e.stateNode!=null)l8(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Pt(166));return vo(e),null}if(t=yp(pu.current),Y_(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[ru]=e,n[ab]=s,t=(e.mode&1)!==0,r){case"dialog":li("cancel",n),li("close",n);break;case"iframe":case"object":case"embed":li("load",n);break;case"video":case"audio":for(i=0;i<nv.length;i++)li(nv[i],n);break;case"source":li("error",n);break;case"img":case"image":case"link":li("error",n),li("load",n);break;case"details":li("toggle",n);break;case"input":gD(n,s),li("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},li("invalid",n);break;case"textarea":xD(n,s),li("invalid",n)}sP(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Z_(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Z_(n.textContent,o,t),i=["children",""+o]):Zv.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&li("scroll",n)}switch(r){case"input":W_(n),yD(n,s,!0);break;case"textarea":W_(n),vD(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=GS)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=L$(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[ru]=e,t[ab]=n,a8(t,e,!1,!1),e.stateNode=t;e:{switch(a=oP(r,n),r){case"dialog":li("cancel",t),li("close",t),i=n;break;case"iframe":case"object":case"embed":li("load",t),i=n;break;case"video":case"audio":for(i=0;i<nv.length;i++)li(nv[i],t);i=n;break;case"source":li("error",t),i=n;break;case"img":case"image":case"link":li("error",t),li("load",t),i=n;break;case"details":li("toggle",t),i=n;break;case"input":gD(t,n),i=eP(t,n),li("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=ji({},n,{value:void 0}),li("invalid",t);break;case"textarea":xD(t,n),i=nP(t,n),li("invalid",t);break;default:i=n}sP(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var d=o[s];s==="style"?$$(t,d):s==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&F$(t,d)):s==="children"?typeof d=="string"?(r!=="textarea"||d!=="")&&Yv(t,d):typeof d=="number"&&Yv(t,""+d):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Zv.hasOwnProperty(s)?d!=null&&s==="onScroll"&&li("scroll",t):d!=null&&nz(t,s,d,a))}switch(r){case"input":W_(t),yD(t,n,!1);break;case"textarea":W_(t),vD(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Yd(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?ey(t,!!n.multiple,s,!1):n.defaultValue!=null&&ey(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=GS)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return vo(e),null;case 6:if(t&&e.stateNode!=null)c8(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Pt(166));if(r=yp(cb.current),yp(pu.current),Y_(e)){if(n=e.stateNode,r=e.memoizedProps,n[ru]=e,(s=n.nodeValue!==r)&&(t=Ya,t!==null))switch(t.tag){case 3:Z_(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Z_(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ru]=e,e.stateNode=n}return vo(e),null;case 13:if(ui(ki),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(xi&&Xa!==null&&e.mode&1&&!(e.flags&128))ON(),By(),e.flags|=98560,s=!1;else if(s=Y_(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Pt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Pt(317));s[ru]=e}else By(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;vo(e),s=!1}else uc!==null&&($P(uc),uc=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||ki.current&1?ys===0&&(ys=3):Bz())),e.updateQueue!==null&&(e.flags|=4),vo(e),null);case 4:return Ny(),zP(t,e),t===null&&sb(e.stateNode.containerInfo),vo(e),null;case 10:return wz(e.type._context),vo(e),null;case 17:return Ca(e.type)&&XS(),vo(e),null;case 19:if(ui(ki),s=e.memoizedState,s===null)return vo(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Dx(s,!1);else{if(ys!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=r2(t),a!==null){for(e.flags|=128,Dx(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ni(ki,ki.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ni()>Wy&&(e.flags|=128,n=!0,Dx(s,!1),e.lanes=4194304)}else{if(!n)if(t=r2(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Dx(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!xi)return vo(e),null}else 2*Ni()-s.renderingStartTime>Wy&&r!==1073741824&&(e.flags|=128,n=!0,Dx(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ni(),e.sibling=null,r=ki.current,ni(ki,n?r&1|2:r&1),e):(vo(e),null);case 22:case 23:return Fz(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Qa&1073741824&&(vo(e),e.subtreeFlags&6&&(e.flags|=8192)):vo(e),null;case 24:return null;case 25:return null}throw Error(Pt(156,e.tag))}function FZ(t,e){switch(xz(e),e.tag){case 1:return Ca(e.type)&&XS(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ny(),ui(ka),ui(Co),Oz(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Tz(e),null;case 13:if(ui(ki),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Pt(340));By()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ui(ki),null;case 4:return Ny(),null;case 10:return wz(e.type._context),null;case 22:case 23:return Fz(),null;case 24:return null;default:return null}}var tw=!1,ko=!1,BZ=typeof WeakSet=="function"?WeakSet:Set,mr=null;function Lg(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ii(t,e,n)}else r.current=null}function MP(t,e,r){try{r()}catch(n){Ii(t,e,n)}}var l3=!1;function $Z(t,e){if(gP=qS,t=pN(),gz(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,d=-1,m=0,y=0,v=t,w=null;t:for(;;){for(var O;v!==r||i!==0&&v.nodeType!==3||(o=a+i),v!==s||n!==0&&v.nodeType!==3||(d=a+n),v.nodeType===3&&(a+=v.nodeValue.length),(O=v.firstChild)!==null;)w=v,v=O;for(;;){if(v===t)break t;if(w===r&&++m===i&&(o=a),w===s&&++y===n&&(d=a),(O=v.nextSibling)!==null)break;v=w,w=v.parentNode}v=O}r=o===-1||d===-1?null:{start:o,end:d}}else r=null}r=r||{start:0,end:0}}else r=null;for(yP={focusedElem:t,selectionRange:r},qS=!1,mr=e;mr!==null;)if(e=mr,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,mr=t;else for(;mr!==null;){e=mr;try{var P=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(P!==null){var E=P.memoizedProps,$=P.memoizedState,R=e.stateNode,F=R.getSnapshotBeforeUpdate(e.elementType===e.type?E:oc(e.type,E),$);R.__reactInternalSnapshotBeforeUpdate=F}break;case 3:var D=e.stateNode.containerInfo;D.nodeType===1?D.textContent="":D.nodeType===9&&D.documentElement&&D.removeChild(D.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Pt(163))}}catch(U){Ii(e,e.return,U)}if(t=e.sibling,t!==null){t.return=e.return,mr=t;break}mr=e.return}return P=l3,l3=!1,P}function Tv(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&MP(e,r,s)}i=i.next}while(i!==n)}}function fk(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function IP(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function u8(t){var e=t.alternate;e!==null&&(t.alternate=null,u8(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ru],delete e[ab],delete e[bP],delete e[wZ],delete e[SZ])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function h8(t){return t.tag===5||t.tag===3||t.tag===4}function c3(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||h8(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function RP(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=GS));else if(n!==4&&(t=t.child,t!==null))for(RP(t,e,r),t=t.sibling;t!==null;)RP(t,e,r),t=t.sibling}function DP(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(DP(t,e,r),t=t.sibling;t!==null;)DP(t,e,r),t=t.sibling}var Xs=null,cc=!1;function ld(t,e,r){for(r=r.child;r!==null;)d8(t,e,r),r=r.sibling}function d8(t,e,r){if(fu&&typeof fu.onCommitFiberUnmount=="function")try{fu.onCommitFiberUnmount(sk,r)}catch{}switch(r.tag){case 5:ko||Lg(r,e);case 6:var n=Xs,i=cc;Xs=null,ld(t,e,r),Xs=n,cc=i,Xs!==null&&(cc?(t=Xs,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Xs.removeChild(r.stateNode));break;case 18:Xs!==null&&(cc?(t=Xs,r=r.stateNode,t.nodeType===8?YT(t.parentNode,r):t.nodeType===1&&YT(t,r),rb(t)):YT(Xs,r.stateNode));break;case 4:n=Xs,i=cc,Xs=r.stateNode.containerInfo,cc=!0,ld(t,e,r),Xs=n,cc=i;break;case 0:case 11:case 14:case 15:if(!ko&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&MP(r,e,a),i=i.next}while(i!==n)}ld(t,e,r);break;case 1:if(!ko&&(Lg(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Ii(r,e,o)}ld(t,e,r);break;case 21:ld(t,e,r);break;case 22:r.mode&1?(ko=(n=ko)||r.memoizedState!==null,ld(t,e,r),ko=n):ld(t,e,r);break;default:ld(t,e,r)}}function u3(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new BZ),e.forEach(function(n){var i=XZ.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function nc(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Xs=o.stateNode,cc=!1;break e;case 3:Xs=o.stateNode.containerInfo,cc=!0;break e;case 4:Xs=o.stateNode.containerInfo,cc=!0;break e}o=o.return}if(Xs===null)throw Error(Pt(160));d8(s,a,i),Xs=null,cc=!1;var d=i.alternate;d!==null&&(d.return=null),i.return=null}catch(m){Ii(i,e,m)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)f8(e,t),e=e.sibling}function f8(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(nc(e,t),$c(t),n&4){try{Tv(3,t,t.return),fk(3,t)}catch(E){Ii(t,t.return,E)}try{Tv(5,t,t.return)}catch(E){Ii(t,t.return,E)}}break;case 1:nc(e,t),$c(t),n&512&&r!==null&&Lg(r,r.return);break;case 5:if(nc(e,t),$c(t),n&512&&r!==null&&Lg(r,r.return),t.flags&32){var i=t.stateNode;try{Yv(i,"")}catch(E){Ii(t,t.return,E)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&R$(i,s),oP(o,a);var m=oP(o,s);for(a=0;a<d.length;a+=2){var y=d[a],v=d[a+1];y==="style"?$$(i,v):y==="dangerouslySetInnerHTML"?F$(i,v):y==="children"?Yv(i,v):nz(i,y,v,m)}switch(o){case"input":tP(i,s);break;case"textarea":D$(i,s);break;case"select":var w=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var O=s.value;O!=null?ey(i,!!s.multiple,O,!1):w!==!!s.multiple&&(s.defaultValue!=null?ey(i,!!s.multiple,s.defaultValue,!0):ey(i,!!s.multiple,s.multiple?[]:"",!1))}i[ab]=s}catch(E){Ii(t,t.return,E)}}break;case 6:if(nc(e,t),$c(t),n&4){if(t.stateNode===null)throw Error(Pt(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(E){Ii(t,t.return,E)}}break;case 3:if(nc(e,t),$c(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{rb(e.containerInfo)}catch(E){Ii(t,t.return,E)}break;case 4:nc(e,t),$c(t);break;case 13:nc(e,t),$c(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Dz=Ni())),n&4&&u3(t);break;case 22:if(y=r!==null&&r.memoizedState!==null,t.mode&1?(ko=(m=ko)||y,nc(e,t),ko=m):nc(e,t),$c(t),n&8192){if(m=t.memoizedState!==null,(t.stateNode.isHidden=m)&&!y&&t.mode&1)for(mr=t,y=t.child;y!==null;){for(v=mr=y;mr!==null;){switch(w=mr,O=w.child,w.tag){case 0:case 11:case 14:case 15:Tv(4,w,w.return);break;case 1:Lg(w,w.return);var P=w.stateNode;if(typeof P.componentWillUnmount=="function"){n=w,r=w.return;try{e=n,P.props=e.memoizedProps,P.state=e.memoizedState,P.componentWillUnmount()}catch(E){Ii(n,r,E)}}break;case 5:Lg(w,w.return);break;case 22:if(w.memoizedState!==null){d3(v);continue}}O!==null?(O.return=w,mr=O):d3(v)}y=y.sibling}e:for(y=null,v=t;;){if(v.tag===5){if(y===null){y=v;try{i=v.stateNode,m?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=v.stateNode,d=v.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,o.style.display=B$("display",a))}catch(E){Ii(t,t.return,E)}}}else if(v.tag===6){if(y===null)try{v.stateNode.nodeValue=m?"":v.memoizedProps}catch(E){Ii(t,t.return,E)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===t)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;y===v&&(y=null),v=v.return}y===v&&(y=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:nc(e,t),$c(t),n&4&&u3(t);break;case 21:break;default:nc(e,t),$c(t)}}function $c(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(h8(r)){var n=r;break e}r=r.return}throw Error(Pt(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Yv(i,""),n.flags&=-33);var s=c3(t);DP(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=c3(t);RP(t,o,a);break;default:throw Error(Pt(161))}}catch(d){Ii(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function NZ(t,e,r){mr=t,p8(t)}function p8(t,e,r){for(var n=(t.mode&1)!==0;mr!==null;){var i=mr,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||tw;if(!a){var o=i.alternate,d=o!==null&&o.memoizedState!==null||ko;o=tw;var m=ko;if(tw=a,(ko=d)&&!m)for(mr=i;mr!==null;)a=mr,d=a.child,a.tag===22&&a.memoizedState!==null?f3(i):d!==null?(d.return=a,mr=d):f3(i);for(;s!==null;)mr=s,p8(s),s=s.sibling;mr=i,tw=o,ko=m}h3(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,mr=s):h3(t)}}function h3(t){for(;mr!==null;){var e=mr;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ko||fk(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!ko)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:oc(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&XD(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}XD(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&r.focus();break;case"img":d.src&&(r.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var m=e.alternate;if(m!==null){var y=m.memoizedState;if(y!==null){var v=y.dehydrated;v!==null&&rb(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Pt(163))}ko||e.flags&512&&IP(e)}catch(w){Ii(e,e.return,w)}}if(e===t){mr=null;break}if(r=e.sibling,r!==null){r.return=e.return,mr=r;break}mr=e.return}}function d3(t){for(;mr!==null;){var e=mr;if(e===t){mr=null;break}var r=e.sibling;if(r!==null){r.return=e.return,mr=r;break}mr=e.return}}function f3(t){for(;mr!==null;){var e=mr;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{fk(4,e)}catch(d){Ii(e,r,d)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(d){Ii(e,i,d)}}var s=e.return;try{IP(e)}catch(d){Ii(e,s,d)}break;case 5:var a=e.return;try{IP(e)}catch(d){Ii(e,a,d)}}}catch(d){Ii(e,e.return,d)}if(e===t){mr=null;break}var o=e.sibling;if(o!==null){o.return=e.return,mr=o;break}mr=e.return}}var VZ=Math.ceil,s2=Oh.ReactCurrentDispatcher,Iz=Oh.ReactCurrentOwner,Ll=Oh.ReactCurrentBatchConfig,bn=0,$s=null,es=null,ro=0,Qa=0,Fg=vf(0),ys=0,fb=null,em=0,pk=0,Rz=0,Ov=null,pa=null,Dz=0,Wy=1/0,Hu=null,o2=!1,LP=null,Wd=null,rw=!1,Id=null,a2=0,jv=0,FP=null,rS=-1,nS=0;function Qo(){return bn&6?Ni():rS!==-1?rS:rS=Ni()}function Ud(t){return t.mode&1?bn&2&&ro!==0?ro&-ro:CZ.transition!==null?(nS===0&&(nS=Y$()),nS):(t=Vn,t!==0||(t=window.event,t=t===void 0?16:sN(t.type)),t):1}function gc(t,e,r,n){if(50<jv)throw jv=0,FP=null,Error(Pt(185));a1(t,r,n),(!(bn&2)||t!==$s)&&(t===$s&&(!(bn&2)&&(pk|=r),ys===4&&_d(t,ro)),Ta(t,n),r===1&&bn===0&&!(e.mode&1)&&(Wy=Ni()+500,uk&&bf()))}function Ta(t,e){var r=t.callbackNode;CK(t,e);var n=US(t,t===$s?ro:0);if(n===0)r!==null&&wD(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&wD(r),e===1)t.tag===0?kZ(p3.bind(null,t)):kN(p3.bind(null,t)),bZ(function(){!(bn&6)&&bf()}),r=null;else{switch(J$(n)){case 1:r=lz;break;case 4:r=K$;break;case 16:r=WS;break;case 536870912:r=Z$;break;default:r=WS}r=w8(r,m8.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function m8(t,e){if(rS=-1,nS=0,bn&6)throw Error(Pt(327));var r=t.callbackNode;if(sy()&&t.callbackNode!==r)return null;var n=US(t,t===$s?ro:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=l2(t,n);else{e=n;var i=bn;bn|=2;var s=y8();($s!==t||ro!==e)&&(Hu=null,Wy=Ni()+500,Mp(t,e));do try{qZ();break}catch(o){g8(t,o)}while(!0);_z(),s2.current=s,bn=i,es!==null?e=0:($s=null,ro=0,e=ys)}if(e!==0){if(e===2&&(i=hP(t),i!==0&&(n=i,e=BP(t,i))),e===1)throw r=fb,Mp(t,0),_d(t,n),Ta(t,Ni()),r;if(e===6)_d(t,n);else{if(i=t.current.alternate,!(n&30)&&!WZ(i)&&(e=l2(t,n),e===2&&(s=hP(t),s!==0&&(n=s,e=BP(t,s))),e===1))throw r=fb,Mp(t,0),_d(t,n),Ta(t,Ni()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Pt(345));case 2:op(t,pa,Hu);break;case 3:if(_d(t,n),(n&130023424)===n&&(e=Dz+500-Ni(),10<e)){if(US(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Qo(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=vP(op.bind(null,t,pa,Hu),e);break}op(t,pa,Hu);break;case 4:if(_d(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-mc(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Ni()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*VZ(n/1960))-n,10<n){t.timeoutHandle=vP(op.bind(null,t,pa,Hu),n);break}op(t,pa,Hu);break;case 5:op(t,pa,Hu);break;default:throw Error(Pt(329))}}}return Ta(t,Ni()),t.callbackNode===r?m8.bind(null,t):null}function BP(t,e){var r=Ov;return t.current.memoizedState.isDehydrated&&(Mp(t,e).flags|=256),t=l2(t,e),t!==2&&(e=pa,pa=r,e!==null&&$P(e)),t}function $P(t){pa===null?pa=t:pa.push.apply(pa,t)}function WZ(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!xc(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function _d(t,e){for(e&=~Rz,e&=~pk,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-mc(e),n=1<<r;t[r]=-1,e&=~n}}function p3(t){if(bn&6)throw Error(Pt(327));sy();var e=US(t,0);if(!(e&1))return Ta(t,Ni()),null;var r=l2(t,e);if(t.tag!==0&&r===2){var n=hP(t);n!==0&&(e=n,r=BP(t,n))}if(r===1)throw r=fb,Mp(t,0),_d(t,e),Ta(t,Ni()),r;if(r===6)throw Error(Pt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,op(t,pa,Hu),Ta(t,Ni()),null}function Lz(t,e){var r=bn;bn|=1;try{return t(e)}finally{bn=r,bn===0&&(Wy=Ni()+500,uk&&bf())}}function tm(t){Id!==null&&Id.tag===0&&!(bn&6)&&sy();var e=bn;bn|=1;var r=Ll.transition,n=Vn;try{if(Ll.transition=null,Vn=1,t)return t()}finally{Vn=n,Ll.transition=r,bn=e,!(bn&6)&&bf()}}function Fz(){Qa=Fg.current,ui(Fg)}function Mp(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,vZ(r)),es!==null)for(r=es.return;r!==null;){var n=r;switch(xz(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&XS();break;case 3:Ny(),ui(ka),ui(Co),Oz();break;case 5:Tz(n);break;case 4:Ny();break;case 13:ui(ki);break;case 19:ui(ki);break;case 10:wz(n.type._context);break;case 22:case 23:Fz()}r=r.return}if($s=t,es=t=qd(t.current,null),ro=Qa=e,ys=0,fb=null,Rz=pk=em=0,pa=Ov=null,gp!==null){for(e=0;e<gp.length;e++)if(r=gp[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}gp=null}return t}function g8(t,e){do{var r=es;try{if(_z(),Jw.current=i2,n2){for(var n=Oi.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}n2=!1}if(Jp=0,Fs=ps=Oi=null,Cv=!1,ub=0,Iz.current=null,r===null||r.return===null){ys=1,fb=e,es=null;break}e:{var s=t,a=r.return,o=r,d=e;if(e=ro,o.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var m=d,y=o,v=y.tag;if(!(y.mode&1)&&(v===0||v===11||v===15)){var w=y.alternate;w?(y.updateQueue=w.updateQueue,y.memoizedState=w.memoizedState,y.lanes=w.lanes):(y.updateQueue=null,y.memoizedState=null)}var O=t3(a);if(O!==null){O.flags&=-257,r3(O,a,o,s,e),O.mode&1&&e3(s,m,e),e=O,d=m;var P=e.updateQueue;if(P===null){var E=new Set;E.add(d),e.updateQueue=E}else P.add(d);break e}else{if(!(e&1)){e3(s,m,e),Bz();break e}d=Error(Pt(426))}}else if(xi&&o.mode&1){var $=t3(a);if($!==null){!($.flags&65536)&&($.flags|=256),r3($,a,o,s,e),vz(Vy(d,o));break e}}s=d=Vy(d,o),ys!==4&&(ys=2),Ov===null?Ov=[s]:Ov.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var R=JN(s,d,e);GD(s,R);break e;case 1:o=d;var F=s.type,D=s.stateNode;if(!(s.flags&128)&&(typeof F.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(Wd===null||!Wd.has(D)))){s.flags|=65536,e&=-e,s.lanes|=e;var U=e8(s,o,e);GD(s,U);break e}}s=s.return}while(s!==null)}v8(r)}catch(X){e=X,es===r&&r!==null&&(es=r=r.return);continue}break}while(!0)}function y8(){var t=s2.current;return s2.current=i2,t===null?i2:t}function Bz(){(ys===0||ys===3||ys===2)&&(ys=4),$s===null||!(em&268435455)&&!(pk&268435455)||_d($s,ro)}function l2(t,e){var r=bn;bn|=2;var n=y8();($s!==t||ro!==e)&&(Hu=null,Mp(t,e));do try{UZ();break}catch(i){g8(t,i)}while(!0);if(_z(),bn=r,s2.current=n,es!==null)throw Error(Pt(261));return $s=null,ro=0,ys}function UZ(){for(;es!==null;)x8(es)}function qZ(){for(;es!==null&&!gK();)x8(es)}function x8(t){var e=_8(t.alternate,t,Qa);t.memoizedProps=t.pendingProps,e===null?v8(t):es=e,Iz.current=null}function v8(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=FZ(r,e),r!==null){r.flags&=32767,es=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ys=6,es=null;return}}else if(r=LZ(r,e,Qa),r!==null){es=r;return}if(e=e.sibling,e!==null){es=e;return}es=e=t}while(e!==null);ys===0&&(ys=5)}function op(t,e,r){var n=Vn,i=Ll.transition;try{Ll.transition=null,Vn=1,QZ(t,e,r,n)}finally{Ll.transition=i,Vn=n}return null}function QZ(t,e,r,n){do sy();while(Id!==null);if(bn&6)throw Error(Pt(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Pt(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(TK(t,s),t===$s&&(es=$s=null,ro=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||rw||(rw=!0,w8(WS,function(){return sy(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Ll.transition,Ll.transition=null;var a=Vn;Vn=1;var o=bn;bn|=4,Iz.current=null,$Z(t,r),f8(r,t),dZ(yP),qS=!!gP,yP=gP=null,t.current=r,NZ(r),yK(),bn=o,Vn=a,Ll.transition=s}else t.current=r;if(rw&&(rw=!1,Id=t,a2=i),s=t.pendingLanes,s===0&&(Wd=null),bK(r.stateNode),Ta(t,Ni()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(o2)throw o2=!1,t=LP,LP=null,t;return a2&1&&t.tag!==0&&sy(),s=t.pendingLanes,s&1?t===FP?jv++:(jv=0,FP=t):jv=0,bf(),null}function sy(){if(Id!==null){var t=J$(a2),e=Ll.transition,r=Vn;try{if(Ll.transition=null,Vn=16>t?16:t,Id===null)var n=!1;else{if(t=Id,Id=null,a2=0,bn&6)throw Error(Pt(331));var i=bn;for(bn|=4,mr=t.current;mr!==null;){var s=mr,a=s.child;if(mr.flags&16){var o=s.deletions;if(o!==null){for(var d=0;d<o.length;d++){var m=o[d];for(mr=m;mr!==null;){var y=mr;switch(y.tag){case 0:case 11:case 15:Tv(8,y,s)}var v=y.child;if(v!==null)v.return=y,mr=v;else for(;mr!==null;){y=mr;var w=y.sibling,O=y.return;if(u8(y),y===m){mr=null;break}if(w!==null){w.return=O,mr=w;break}mr=O}}}var P=s.alternate;if(P!==null){var E=P.child;if(E!==null){P.child=null;do{var $=E.sibling;E.sibling=null,E=$}while(E!==null)}}mr=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,mr=a;else e:for(;mr!==null;){if(s=mr,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Tv(9,s,s.return)}var R=s.sibling;if(R!==null){R.return=s.return,mr=R;break e}mr=s.return}}var F=t.current;for(mr=F;mr!==null;){a=mr;var D=a.child;if(a.subtreeFlags&2064&&D!==null)D.return=a,mr=D;else e:for(a=F;mr!==null;){if(o=mr,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:fk(9,o)}}catch(X){Ii(o,o.return,X)}if(o===a){mr=null;break e}var U=o.sibling;if(U!==null){U.return=o.return,mr=U;break e}mr=o.return}}if(bn=i,bf(),fu&&typeof fu.onPostCommitFiberRoot=="function")try{fu.onPostCommitFiberRoot(sk,t)}catch{}n=!0}return n}finally{Vn=r,Ll.transition=e}}return!1}function m3(t,e,r){e=Vy(r,e),e=JN(t,e,1),t=Vd(t,e,1),e=Qo(),t!==null&&(a1(t,1,e),Ta(t,e))}function Ii(t,e,r){if(t.tag===3)m3(t,t,r);else for(;e!==null;){if(e.tag===3){m3(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Wd===null||!Wd.has(n))){t=Vy(r,t),t=e8(e,t,1),e=Vd(e,t,1),t=Qo(),e!==null&&(a1(e,1,t),Ta(e,t));break}}e=e.return}}function HZ(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Qo(),t.pingedLanes|=t.suspendedLanes&r,$s===t&&(ro&r)===r&&(ys===4||ys===3&&(ro&130023424)===ro&&500>Ni()-Dz?Mp(t,0):Rz|=r),Ta(t,e)}function b8(t,e){e===0&&(t.mode&1?(e=Q_,Q_<<=1,!(Q_&130023424)&&(Q_=4194304)):e=1);var r=Qo();t=vh(t,e),t!==null&&(a1(t,e,r),Ta(t,r))}function GZ(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),b8(t,r)}function XZ(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Pt(314))}n!==null&&n.delete(e),b8(t,r)}var _8;_8=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||ka.current)ba=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return ba=!1,DZ(t,e,r);ba=!!(t.flags&131072)}else ba=!1,xi&&e.flags&1048576&&CN(e,YS,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;tS(t,e),t=e.pendingProps;var i=Fy(e,Co.current);iy(e,r),i=Pz(null,e,n,t,i,r);var s=Az();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ca(n)?(s=!0,KS(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,kz(e),i.updater=dk,e.stateNode=i,i._reactInternals=e,TP(e,n,t,r),e=PP(null,e,n,!0,s,r)):(e.tag=0,xi&&s&&yz(e),Bo(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(tS(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=ZZ(n),t=oc(n,t),i){case 0:e=jP(null,e,n,t,r);break e;case 1:e=s3(null,e,n,t,r);break e;case 11:e=n3(null,e,n,t,r);break e;case 14:e=i3(null,e,n,oc(n.type,t),r);break e}throw Error(Pt(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:oc(n,i),jP(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:oc(n,i),s3(t,e,n,i,r);case 3:e:{if(i8(e),t===null)throw Error(Pt(387));n=e.pendingProps,s=e.memoizedState,i=s.element,EN(t,e),t2(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Vy(Error(Pt(423)),e),e=o3(t,e,n,r,i);break e}else if(n!==i){i=Vy(Error(Pt(424)),e),e=o3(t,e,n,r,i);break e}else for(Xa=Nd(e.stateNode.containerInfo.firstChild),Ya=e,xi=!0,uc=null,r=PN(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(By(),n===i){e=bh(t,e,r);break e}Bo(t,e,n,r)}e=e.child}return e;case 5:return zN(e),t===null&&SP(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,xP(n,i)?a=null:s!==null&&xP(n,s)&&(e.flags|=32),n8(t,e),Bo(t,e,a,r),e.child;case 6:return t===null&&SP(e),null;case 13:return s8(t,e,r);case 4:return Cz(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=$y(e,null,n,r):Bo(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:oc(n,i),n3(t,e,n,i,r);case 7:return Bo(t,e,e.pendingProps,r),e.child;case 8:return Bo(t,e,e.pendingProps.children,r),e.child;case 12:return Bo(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,ni(JS,n._currentValue),n._currentValue=a,s!==null)if(xc(s.value,a)){if(s.children===i.children&&!ka.current){e=bh(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var d=o.firstContext;d!==null;){if(d.context===n){if(s.tag===1){d=uh(-1,r&-r),d.tag=2;var m=s.updateQueue;if(m!==null){m=m.shared;var y=m.pending;y===null?d.next=d:(d.next=y.next,y.next=d),m.pending=d}}s.lanes|=r,d=s.alternate,d!==null&&(d.lanes|=r),kP(s.return,r,e),o.lanes|=r;break}d=d.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Pt(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),kP(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Bo(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,iy(e,r),i=$l(i),n=n(i),e.flags|=1,Bo(t,e,n,r),e.child;case 14:return n=e.type,i=oc(n,e.pendingProps),i=oc(n.type,i),i3(t,e,n,i,r);case 15:return t8(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:oc(n,i),tS(t,e),e.tag=1,Ca(n)?(t=!0,KS(e)):t=!1,iy(e,r),YN(e,n,i),TP(e,n,i,r),PP(null,e,n,!0,t,r);case 19:return o8(t,e,r);case 22:return r8(t,e,r)}throw Error(Pt(156,e.tag))};function w8(t,e){return X$(t,e)}function KZ(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function El(t,e,r,n){return new KZ(t,e,r,n)}function $z(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ZZ(t){if(typeof t=="function")return $z(t)?1:0;if(t!=null){if(t=t.$$typeof,t===sz)return 11;if(t===oz)return 14}return 2}function qd(t,e){var r=t.alternate;return r===null?(r=El(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function iS(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")$z(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case jg:return Ip(r.children,i,s,e);case iz:a=8,i|=8;break;case Kj:return t=El(12,r,e,i|2),t.elementType=Kj,t.lanes=s,t;case Zj:return t=El(13,r,e,i),t.elementType=Zj,t.lanes=s,t;case Yj:return t=El(19,r,e,i),t.elementType=Yj,t.lanes=s,t;case z$:return mk(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case A$:a=10;break e;case E$:a=9;break e;case sz:a=11;break e;case oz:a=14;break e;case pd:a=16,n=null;break e}throw Error(Pt(130,t==null?t:typeof t,""))}return e=El(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Ip(t,e,r,n){return t=El(7,t,n,e),t.lanes=r,t}function mk(t,e,r,n){return t=El(22,t,n,e),t.elementType=z$,t.lanes=r,t.stateNode={isHidden:!1},t}function oO(t,e,r){return t=El(6,t,null,e),t.lanes=r,t}function aO(t,e,r){return e=El(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function YZ(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=NT(0),this.expirationTimes=NT(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=NT(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Nz(t,e,r,n,i,s,a,o,d){return t=new YZ(t,e,r,o,d),e===1?(e=1,s===!0&&(e|=8)):e=0,s=El(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},kz(s),t}function JZ(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Og,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function S8(t){if(!t)return Jd;t=t._reactInternals;e:{if(vm(t)!==t||t.tag!==1)throw Error(Pt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ca(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Pt(171))}if(t.tag===1){var r=t.type;if(Ca(r))return SN(t,r,e)}return e}function k8(t,e,r,n,i,s,a,o,d){return t=Nz(r,n,!0,t,i,s,a,o,d),t.context=S8(null),r=t.current,n=Qo(),i=Ud(r),s=uh(n,i),s.callback=e??null,Vd(r,s,i),t.current.lanes=i,a1(t,i,n),Ta(t,n),t}function gk(t,e,r,n){var i=e.current,s=Qo(),a=Ud(i);return r=S8(r),e.context===null?e.context=r:e.pendingContext=r,e=uh(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Vd(i,e,a),t!==null&&(gc(t,i,a,s),Yw(t,i,a)),a}function c2(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function g3(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Vz(t,e){g3(t,e),(t=t.alternate)&&g3(t,e)}function eY(){return null}var C8=typeof reportError=="function"?reportError:function(t){console.error(t)};function Wz(t){this._internalRoot=t}yk.prototype.render=Wz.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Pt(409));gk(t,e,null,null)};yk.prototype.unmount=Wz.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;tm(function(){gk(null,t,null,null)}),e[xh]=null}};function yk(t){this._internalRoot=t}yk.prototype.unstable_scheduleHydration=function(t){if(t){var e=rN();t={blockedOn:null,target:t,priority:e};for(var r=0;r<bd.length&&e!==0&&e<bd[r].priority;r++);bd.splice(r,0,t),r===0&&iN(t)}};function Uz(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function xk(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function y3(){}function tY(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var m=c2(a);s.call(m)}}var a=k8(e,n,t,0,null,!1,!1,"",y3);return t._reactRootContainer=a,t[xh]=a.current,sb(t.nodeType===8?t.parentNode:t),tm(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var m=c2(d);o.call(m)}}var d=Nz(t,0,!1,null,null,!1,!1,"",y3);return t._reactRootContainer=d,t[xh]=d.current,sb(t.nodeType===8?t.parentNode:t),tm(function(){gk(e,d,r,n)}),d}function vk(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var d=c2(a);o.call(d)}}gk(e,a,t,i)}else a=tY(r,e,t,i,n);return c2(a)}eN=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=rv(e.pendingLanes);r!==0&&(cz(e,r|1),Ta(e,Ni()),!(bn&6)&&(Wy=Ni()+500,bf()))}break;case 13:tm(function(){var n=vh(t,1);if(n!==null){var i=Qo();gc(n,t,1,i)}}),Vz(t,1)}};uz=function(t){if(t.tag===13){var e=vh(t,134217728);if(e!==null){var r=Qo();gc(e,t,134217728,r)}Vz(t,134217728)}};tN=function(t){if(t.tag===13){var e=Ud(t),r=vh(t,e);if(r!==null){var n=Qo();gc(r,t,e,n)}Vz(t,e)}};rN=function(){return Vn};nN=function(t,e){var r=Vn;try{return Vn=t,e()}finally{Vn=r}};lP=function(t,e,r){switch(e){case"input":if(tP(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=ck(n);if(!i)throw Error(Pt(90));I$(n),tP(n,i)}}}break;case"textarea":D$(t,r);break;case"select":e=r.value,e!=null&&ey(t,!!r.multiple,e,!1)}};W$=Lz;U$=tm;var rY={usingClientEntryPoint:!1,Events:[c1,zg,ck,N$,V$,Lz]},Lx={findFiberByHostInstance:mp,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nY={bundleType:Lx.bundleType,version:Lx.version,rendererPackageName:Lx.rendererPackageName,rendererConfig:Lx.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Oh.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=H$(t),t===null?null:t.stateNode},findFiberByHostInstance:Lx.findFiberByHostInstance||eY,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nw.isDisabled&&nw.supportsFiber)try{sk=nw.inject(nY),fu=nw}catch{}}sl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rY;sl.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Uz(e))throw Error(Pt(200));return JZ(t,e,null,r)};sl.createRoot=function(t,e){if(!Uz(t))throw Error(Pt(299));var r=!1,n="",i=C8;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Nz(t,1,!1,null,null,r,!1,n,i),t[xh]=e.current,sb(t.nodeType===8?t.parentNode:t),new Wz(e)};sl.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Pt(188)):(t=Object.keys(t).join(","),Error(Pt(268,t)));return t=H$(e),t=t===null?null:t.stateNode,t};sl.flushSync=function(t){return tm(t)};sl.hydrate=function(t,e,r){if(!xk(e))throw Error(Pt(200));return vk(null,t,e,!0,r)};sl.hydrateRoot=function(t,e,r){if(!Uz(t))throw Error(Pt(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=C8;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=k8(e,null,t,1,r??null,i,!1,s,a),t[xh]=e.current,sb(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new yk(e)};sl.render=function(t,e,r){if(!xk(e))throw Error(Pt(200));return vk(null,t,e,!1,r)};sl.unmountComponentAtNode=function(t){if(!xk(t))throw Error(Pt(40));return t._reactRootContainer?(tm(function(){vk(null,null,t,!1,function(){t._reactRootContainer=null,t[xh]=null})}),!0):!1};sl.unstable_batchedUpdates=Lz;sl.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!xk(r))throw Error(Pt(200));if(t==null||t._reactInternals===void 0)throw Error(Pt(38));return vk(t,e,r,!1,n)};sl.version="18.3.1-next-f1338f8080-20240426";function T8(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(T8)}catch(t){console.error(t)}}T8(),T$.exports=sl;var qz=T$.exports,x3=qz;Gj.createRoot=x3.createRoot,Gj.hydrateRoot=x3.hydrateRoot;function iY(t,e,r,n){return t.addEventListener(e,r,n),()=>{t.removeEventListener(e,r,n)}}function bk(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}function sY(){return!!(globalThis!=null&&globalThis.document)}function O8(t){return t.parentElement&&O8(t.parentElement)?!0:t.hidden}function oY(t){const e=t.getAttribute("contenteditable");return e!=="false"&&e!=null}function aY(t){return!!t.getAttribute("disabled")||!!t.getAttribute("aria-disabled")}function lY(t){var e;return((e=j8(t))==null?void 0:e.defaultView)??window}function j8(t){return bk(t)?t.ownerDocument:document}function cY(t){return t.view??window}function uY(t){return j8(t).activeElement}function hY(t){const e=cY(t);return typeof e.PointerEvent<"u"&&t instanceof e.PointerEvent?t.pointerType==="mouse":t instanceof e.MouseEvent}function P8(t){return!!t.touches}function dY(t){return P8(t)&&t.touches.length>1}function fY(t,e="page"){const r=t.touches[0]||t.changedTouches[0];return{x:r[`${e}X`],y:r[`${e}Y`]}}function pY(t,e="page"){return{x:t[`${e}X`],y:t[`${e}Y`]}}function A8(t,e="page"){return P8(t)?fY(t,e):pY(t,e)}function mY(t){return e=>{const r=hY(e);(!r||r&&e.button===0)&&t(e)}}function gY(t,e=!1){function r(i){t(i,{point:A8(i)})}return e?mY(r):r}function sS(t,e,r,n){return iY(t,e,gY(r,e==="pointerdown"),n)}function yY(t,...e){if(t==null)throw new TypeError("Cannot convert undefined or null to object");const r={...t};for(const n of e)if(n!=null)for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(i in r&&delete r[i],r[i]=n[i]);return r}const Sr=t=>t?"":void 0,Fl=t=>t?!0:void 0;function NP(t){return Array.isArray(t)}function no(t){const e=typeof t;return t!=null&&(e==="object"||e==="function")&&!NP(t)}function xY(t){const e=t==null?0:t.length;return e?t[e-1]:void 0}function vY(t){const e=parseFloat(t.toString()),r=t.toString().replace(String(e),"");return{unitless:!r,value:e,unit:r}}function VP(t){if(t==null)return t;const{unitless:e}=vY(t);return e||typeof t=="number"?`${t}px`:t}const E8=(t,e)=>parseInt(t[1],10)>parseInt(e[1],10)?1:-1,Qz=t=>Object.fromEntries(Object.entries(t).sort(E8));function v3(t){const e=Qz(t);return Object.assign(Object.values(e),e)}function bY(t){const e=Object.keys(Qz(t));return new Set(e)}function b3(t){if(!t)return t;t=VP(t)??t;const e=-.02;return typeof t=="number"?`${t+e}`:t.replace(/(\d+\.?\d*)/u,r=>`${parseFloat(r)+e}`)}function iv(t,e){const r=["@media screen"];return t&&r.push("and",`(min-width: ${VP(t)})`),e&&r.push("and",`(max-width: ${VP(e)})`),r.join(" ")}function _Y(t){if(!t)return null;t.base=t.base??"0px";const e=v3(t),r=Object.entries(t).sort(E8).map(([s,a],o,d)=>{let[,m]=d[o+1]??[];return m=parseFloat(m)>0?b3(m):void 0,{_minW:b3(a),breakpoint:s,minW:a,maxW:m,maxWQuery:iv(null,m),minWQuery:iv(a),minMaxQuery:iv(a,m)}}),n=bY(t),i=Array.from(n.values());return{keys:n,normalized:e,isResponsive(s){const a=Object.keys(s);return a.length>0&&a.every(o=>n.has(o))},asObject:Qz(t),asArray:v3(t),details:r,get(s){return r.find(a=>a.breakpoint===s)},media:[null,...e.map(s=>iv(s)).slice(1)],toArrayValue(s){if(!no(s))throw new Error("toArrayValue: value must be an object");const a=i.map(o=>s[o]??null);for(;xY(a)===null;)a.pop();return a},toObjectValue(s){if(!Array.isArray(s))throw new Error("toObjectValue: value must be an array");return s.reduce((a,o,d)=>{const m=i[d];return m!=null&&o!=null&&(a[m]=o),a},{})}}}function Hz(...t){return function(...r){t.forEach(n=>n==null?void 0:n(...r))}}function Cr(...t){return function(r){t.some(n=>(n==null||n(r),r==null?void 0:r.defaultPrevented))}}function _k(t){return I.Children.toArray(t).filter(e=>I.isValidElement(e))}function wk(t){const e=Object.assign({},t);for(let r in e)e[r]===void 0&&delete e[r];return e}function wY(t,e){return`${t} returned \`undefined\`. Seems you forgot to wrap component within ${e}`}function _n(t={}){const{name:e,strict:r=!0,hookName:n="useContext",providerName:i="Provider",errorMessage:s,defaultValue:a}=t,o=I.createContext(a);o.displayName=e;function d(){var y;const m=I.useContext(o);if(!m&&r){const v=new Error(s??wY(n,i));throw v.name="ContextError",(y=Error.captureStackTrace)==null||y.call(Error,v,d),v}return m}return[o.Provider,d,o]}const lr=(...t)=>t.filter(Boolean).join(" "),z8=t=>t.hasAttribute("tabindex"),SY=t=>z8(t)&&t.tabIndex===-1;function M8(t){if(!bk(t)||O8(t)||aY(t))return!1;const{localName:e}=t;if(["input","select","textarea","button"].indexOf(e)>=0)return!0;const n={a:()=>t.hasAttribute("href"),audio:()=>t.hasAttribute("controls"),video:()=>t.hasAttribute("controls")};return e in n?n[e]():oY(t)?!0:z8(t)}function kY(t){return t?bk(t)&&M8(t)&&!SY(t):!1}const CY=["input:not(:disabled):not([disabled])","select:not(:disabled):not([disabled])","textarea:not(:disabled):not([disabled])","embed","iframe","object","a[href]","area[href]","button:not(:disabled):not([disabled])","[tabindex]","audio[controls]","video[controls]","*[tabindex]:not([aria-disabled])","*[contenteditable]"],TY=CY.join(),OY=t=>t.offsetWidth>0&&t.offsetHeight>0;function jY(t){const e=Array.from(t.querySelectorAll(TY));return e.unshift(t),e.filter(r=>M8(r)&&OY(r))}function PY(t,e,r,n){const i=typeof e=="string"?e.split("."):[e];for(n=0;n<i.length&&t;n+=1)t=t[i[n]];return t===void 0?r:t}const AY=t=>{const e=new WeakMap;return(n,i,s,a)=>{if(typeof n>"u")return t(n,i,s);e.has(n)||e.set(n,new Map);const o=e.get(n);if(o.has(i))return o.get(i);const d=t(n,i,s,a);return o.set(i,d),d}},I8=AY(PY),EY=t=>t.default||t;function R8(t){const{wasSelected:e,enabled:r,isSelected:n,mode:i="unmount"}=t;return!!(!r||n||i==="keepMounted"&&e)}function zY(t){const e=parseFloat(t);return typeof e!="number"||Number.isNaN(e)?0:e}function Gz(t,e){let r=zY(t);const n=10**(e??10);return r=Math.round(r*n)/n,e?r.toFixed(e):r.toString()}function WP(t){if(!Number.isFinite(t))return 0;let e=1,r=0;for(;Math.round(t*e)/e!==t;)e*=10,r+=1;return r}function _3(t,e,r){return(t-e)*100/(r-e)}function MY(t,e,r){return(r-e)*t+e}function w3(t,e,r){const n=Math.round((t-e)/r)*r+e,i=WP(r);return Gz(n,i)}function oS(t,e,r){return t==null?t:(r<e&&console.warn("clamp: max cannot be less than min"),Math.min(Math.max(t,e),r))}function Sk(t,e=[]){const r=Object.assign({},t);for(const n of e)n in r&&delete r[n];return r}function D8(t,e){const r={};for(const n of e)n in t&&(r[n]=t[n]);return r}function Xz(t,e){return Array.isArray(t)?t.map(r=>r===null?null:e(r)):no(t)?Object.keys(t).reduce((r,n)=>(r[n]=e(t[n]),r),{}):t!=null?e(t):null}const IY=t=>typeof t=="function";function Ka(t,...e){return IY(t)?t(...e):t}function RY(t){const e=t.ownerDocument.defaultView||window,{overflow:r,overflowX:n,overflowY:i}=e.getComputedStyle(t);return/auto|scroll|overlay|hidden/.test(r+i+n)}function DY(t){return t.localName==="html"?t:t.assignedSlot||t.parentElement||t.ownerDocument.documentElement}function L8(t){return["html","body","#document"].includes(t.localName)?t.ownerDocument.body:bk(t)&&RY(t)?t:L8(DY(t))}function F8(t,e){const r={},n={};for(const[i,s]of Object.entries(t))e.includes(i)?r[i]=s:n[i]=s;return[r,n]}function LY(t,...e){const r=Object.getOwnPropertyDescriptors(t),n=Object.keys(r),i=a=>{const o={};for(let d=0;d<a.length;d++){const m=a[d];r[m]&&(Object.defineProperty(o,m,r[m]),delete r[m])}return o},s=a=>i(Array.isArray(a)?a:n.filter(a));return e.map(s).concat(i(n))}function S3(t,e,r={}){const{stop:n,getKey:i}=r;function s(a,o=[]){if(no(a)||Array.isArray(a)){const d={};for(const[m,y]of Object.entries(a)){const v=(i==null?void 0:i(m))??m,w=[...o,v];if(n!=null&&n(a,w))return e(a,o);d[v]=s(y,w)}return d}return e(a,o)}return s(t)}const h1=t=>{const{condition:e,message:r}=t};var u2={exports:{}};u2.exports;(function(t,e){var r=200,n="__lodash_hash_undefined__",i=800,s=16,a=9007199254740991,o="[object Arguments]",d="[object Array]",m="[object AsyncFunction]",y="[object Boolean]",v="[object Date]",w="[object Error]",O="[object Function]",P="[object GeneratorFunction]",E="[object Map]",$="[object Number]",R="[object Null]",F="[object Object]",D="[object Proxy]",U="[object RegExp]",X="[object Set]",ee="[object String]",K="[object Undefined]",Y="[object WeakMap]",ne="[object ArrayBuffer]",oe="[object DataView]",ce="[object Float32Array]",Xe="[object Float64Array]",Ae="[object Int8Array]",We="[object Int16Array]",Ye="[object Int32Array]",tt="[object Uint8Array]",Be="[object Uint8ClampedArray]",Me="[object Uint16Array]",Ge="[object Uint32Array]",De=/[\\^$.*+?()[\]{}|]/g,Le=/^\[object .+?Constructor\]$/,Oe=/^(?:0|[1-9]\d*)$/,Ie={};Ie[ce]=Ie[Xe]=Ie[Ae]=Ie[We]=Ie[Ye]=Ie[tt]=Ie[Be]=Ie[Me]=Ie[Ge]=!0,Ie[o]=Ie[d]=Ie[ne]=Ie[y]=Ie[oe]=Ie[v]=Ie[w]=Ie[O]=Ie[E]=Ie[$]=Ie[F]=Ie[U]=Ie[X]=Ie[ee]=Ie[Y]=!1;var st=typeof Jx=="object"&&Jx&&Jx.Object===Object&&Jx,Re=typeof self=="object"&&self&&self.Object===Object&&self,it=st||Re||Function("return this")(),Ke=e&&!e.nodeType&&e,St=Ke&&!0&&t&&!t.nodeType&&t,Mt=St&&St.exports===Ke,Et=Mt&&st.process,xt=function(){try{var ye=St&&St.require&&St.require("util").types;return ye||Et&&Et.binding&&Et.binding("util")}catch{}}(),et=xt&&xt.isTypedArray;function Yt(ye,Ne,at){switch(at.length){case 0:return ye.call(Ne);case 1:return ye.call(Ne,at[0]);case 2:return ye.call(Ne,at[0],at[1]);case 3:return ye.call(Ne,at[0],at[1],at[2])}return ye.apply(Ne,at)}function _t(ye,Ne){for(var at=-1,Jt=Array(ye);++at<ye;)Jt[at]=Ne(at);return Jt}function rt(ye){return function(Ne){return ye(Ne)}}function Te(ye,Ne){return ye==null?void 0:ye[Ne]}function ct(ye,Ne){return function(at){return ye(Ne(at))}}var Vt=Array.prototype,wt=Function.prototype,Ft=Object.prototype,Kr=it["__core-js_shared__"],yn=wt.toString,an=Ft.hasOwnProperty,Cn=function(){var ye=/[^.]+$/.exec(Kr&&Kr.keys&&Kr.keys.IE_PROTO||"");return ye?"Symbol(src)_1."+ye:""}(),xn=Ft.toString,di=yn.call(Object),Pi=RegExp("^"+yn.call(an).replace(De,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),He=Mt?it.Buffer:void 0,Vr=it.Symbol,Ct=it.Uint8Array;He&&He.allocUnsafe;var Ut=ct(Object.getPrototypeOf,Object),wn=Object.create,vt=Ft.propertyIsEnumerable,vr=Vt.splice,tr=Vr?Vr.toStringTag:void 0,Zn=function(){try{var ye=Ac(Object,"defineProperty");return ye({},"",{}),ye}catch{}}(),_i=He?He.isBuffer:void 0,pr=Math.max,Di=Date.now,ks=Ac(it,"Map"),Li=Ac(Object,"create"),cs=function(){function ye(){}return function(Ne){if(!hl(Ne))return{};if(wn)return wn(Ne);ye.prototype=Ne;var at=new ye;return ye.prototype=void 0,at}}();function ge(ye){var Ne=-1,at=ye==null?0:ye.length;for(this.clear();++Ne<at;){var Jt=ye[Ne];this.set(Jt[0],Jt[1])}}function W(){this.__data__=Li?Li(null):{},this.size=0}function Q(ye){var Ne=this.has(ye)&&delete this.__data__[ye];return this.size-=Ne?1:0,Ne}function te(ye){var Ne=this.__data__;if(Li){var at=Ne[ye];return at===n?void 0:at}return an.call(Ne,ye)?Ne[ye]:void 0}function de(ye){var Ne=this.__data__;return Li?Ne[ye]!==void 0:an.call(Ne,ye)}function be(ye,Ne){var at=this.__data__;return this.size+=this.has(ye)?0:1,at[ye]=Li&&Ne===void 0?n:Ne,this}ge.prototype.clear=W,ge.prototype.delete=Q,ge.prototype.get=te,ge.prototype.has=de,ge.prototype.set=be;function ke(ye){var Ne=-1,at=ye==null?0:ye.length;for(this.clear();++Ne<at;){var Jt=ye[Ne];this.set(Jt[0],Jt[1])}}function $e(){this.__data__=[],this.size=0}function _e(ye){var Ne=this.__data__,at=Ma(Ne,ye);if(at<0)return!1;var Jt=Ne.length-1;return at==Jt?Ne.pop():vr.call(Ne,at,1),--this.size,!0}function nt(ye){var Ne=this.__data__,at=Ma(Ne,ye);return at<0?void 0:Ne[at][1]}function dt(ye){return Ma(this.__data__,ye)>-1}function ve(ye,Ne){var at=this.__data__,Jt=Ma(at,ye);return Jt<0?(++this.size,at.push([ye,Ne])):at[Jt][1]=Ne,this}ke.prototype.clear=$e,ke.prototype.delete=_e,ke.prototype.get=nt,ke.prototype.has=dt,ke.prototype.set=ve;function ut(ye){var Ne=-1,at=ye==null?0:ye.length;for(this.clear();++Ne<at;){var Jt=ye[Ne];this.set(Jt[0],Jt[1])}}function Dt(){this.size=0,this.__data__={hash:new ge,map:new(ks||ke),string:new ge}}function nr(ye){var Ne=Ph(this,ye).delete(ye);return this.size-=Ne?1:0,Ne}function Ur(ye){return Ph(this,ye).get(ye)}function Ir(ye){return Ph(this,ye).has(ye)}function en(ye,Ne){var at=Ph(this,ye),Jt=at.size;return at.set(ye,Ne),this.size+=at.size==Jt?0:1,this}ut.prototype.clear=Dt,ut.prototype.delete=nr,ut.prototype.get=Ur,ut.prototype.has=Ir,ut.prototype.set=en;function Fr(ye){var Ne=this.__data__=new ke(ye);this.size=Ne.size}function fi(){this.__data__=new ke,this.size=0}function Yn(ye){var Ne=this.__data__,at=Ne.delete(ye);return this.size=Ne.size,at}function Br(ye){return this.__data__.get(ye)}function mn(ye){return this.__data__.has(ye)}function Bn(ye,Ne){var at=this.__data__;if(at instanceof ke){var Jt=at.__data__;if(!ks||Jt.length<r-1)return Jt.push([ye,Ne]),this.size=++at.size,this;at=this.__data__=new ut(Jt)}return at.set(ye,Ne),this.size=at.size,this}Fr.prototype.clear=fi,Fr.prototype.delete=Yn,Fr.prototype.get=Br,Fr.prototype.has=mn,Fr.prototype.set=Bn;function Ai(ye,Ne){var at=Zl(ye),Jt=!at&&Ia(ye),rn=!at&&!Jt&&Pu(ye),vn=!at&&!Jt&&!rn&&Af(ye),gn=at||Jt||rn||vn,Hr=gn?_t(ye.length,String):[],br=Hr.length;for(var js in ye)gn&&(js=="length"||rn&&(js=="offset"||js=="parent")||vn&&(js=="buffer"||js=="byteLength"||js=="byteOffset")||tn(js,br))||Hr.push(js);return Hr}function wi(ye,Ne,at){(at!==void 0&&!Mh(ye[Ne],at)||at===void 0&&!(Ne in ye))&&ln(ye,Ne,at)}function us(ye,Ne,at){var Jt=ye[Ne];(!(an.call(ye,Ne)&&Mh(Jt,at))||at===void 0&&!(Ne in ye))&&ln(ye,Ne,at)}function Ma(ye,Ne){for(var at=ye.length;at--;)if(Mh(ye[at][0],Ne))return at;return-1}function ln(ye,Ne,at){Ne=="__proto__"&&Zn?Zn(ye,Ne,{configurable:!0,enumerable:!0,value:at,writable:!0}):ye[Ne]=at}var Tf=Ao();function jc(ye){return ye==null?ye===void 0?K:R:tr&&tr in Object(ye)?Kl(ye):ju(ye)}function Cs(ye){return ea(ye)&&jc(ye)==o}function Ws(ye){if(!hl(ye)||Ec(ye))return!1;var Ne=zc(ye)?Pi:Le;return Ne.test(Cm(ye))}function j0(ye){return ea(ye)&&Au(ye.length)&&!!Ie[jc(ye)]}function uo(ye){if(!hl(ye))return Eh(ye);var Ne=Ah(ye),at=[];for(var Jt in ye)Jt=="constructor"&&(Ne||!an.call(ye,Jt))||at.push(Jt);return at}function Ts(ye,Ne,at,Jt,rn){ye!==Ne&&Tf(Ne,function(vn,gn){if(rn||(rn=new Fr),hl(vn))Pc(ye,Ne,gn,at,Ts,Jt,rn);else{var Hr=Jt?Jt(ul(ye,gn),vn,gn+"",ye,Ne,rn):void 0;Hr===void 0&&(Hr=vn),wi(ye,gn,Hr)}},Om)}function Pc(ye,Ne,at,Jt,rn,vn,gn){var Hr=ul(ye,at),br=ul(Ne,at),js=gn.get(br);if(js){wi(ye,at,js);return}var Us=vn?vn(Hr,br,at+"",ye,Ne,gn):void 0,ta=Us===void 0;if(ta){var zf=Zl(br),Ih=!zf&&Pu(br),Pm=!zf&&!Ih&&Af(br);Us=br,zf||Ih||Pm?Zl(Hr)?Us=Hr:Os(Hr)?Us=jh(Hr):Ih?(ta=!1,Us=Ou(br)):Pm?(ta=!1,Us=oi(br)):Us=[]:A0(br)||Ia(br)?(Us=Hr,Ia(Hr)?Us=Tm(Hr):(!hl(Hr)||zc(Hr))&&(Us=cl(br))):ta=!1}ta&&(gn.set(br,Us),rn(Us,br,Jt,vn,gn),gn.delete(br)),wi(ye,at,Us)}function Xl(ye,Ne){return km(zh(ye,Ne,Mc),ye+"")}var pi=Zn?function(ye,Ne){return Zn(ye,"toString",{configurable:!0,enumerable:!1,value:jm(Ne),writable:!0})}:Mc;function Ou(ye,Ne){return ye.slice()}function jo(ye){var Ne=new ye.constructor(ye.byteLength);return new Ct(Ne).set(new Ct(ye)),Ne}function oi(ye,Ne){var at=jo(ye.buffer);return new ye.constructor(at,ye.byteOffset,ye.length)}function jh(ye,Ne){var at=-1,Jt=ye.length;for(Ne||(Ne=Array(Jt));++at<Jt;)Ne[at]=ye[at];return Ne}function Po(ye,Ne,at,Jt){var rn=!at;at||(at={});for(var vn=-1,gn=Ne.length;++vn<gn;){var Hr=Ne[vn],br=void 0;br===void 0&&(br=ye[Hr]),rn?ln(at,Hr,br):us(at,Hr,br)}return at}function Of(ye){return Xl(function(Ne,at){var Jt=-1,rn=at.length,vn=rn>1?at[rn-1]:void 0,gn=rn>2?at[2]:void 0;for(vn=ye.length>3&&typeof vn=="function"?(rn--,vn):void 0,gn&&jf(at[0],at[1],gn)&&(vn=rn<3?void 0:vn,rn=1),Ne=Object(Ne);++Jt<rn;){var Hr=at[Jt];Hr&&ye(Ne,Hr,Jt,vn)}return Ne})}function Ao(ye){return function(Ne,at,Jt){for(var rn=-1,vn=Object(Ne),gn=Jt(Ne),Hr=gn.length;Hr--;){var br=gn[++rn];if(at(vn[br],br,vn)===!1)break}return Ne}}function Ph(ye,Ne){var at=ye.__data__;return Pf(Ne)?at[typeof Ne=="string"?"string":"hash"]:at.map}function Ac(ye,Ne){var at=Te(ye,Ne);return Ws(at)?at:void 0}function Kl(ye){var Ne=an.call(ye,tr),at=ye[tr];try{ye[tr]=void 0;var Jt=!0}catch{}var rn=xn.call(ye);return Jt&&(Ne?ye[tr]=at:delete ye[tr]),rn}function cl(ye){return typeof ye.constructor=="function"&&!Ah(ye)?cs(Ut(ye)):{}}function tn(ye,Ne){var at=typeof ye;return Ne=Ne??a,!!Ne&&(at=="number"||at!="symbol"&&Oe.test(ye))&&ye>-1&&ye%1==0&&ye<Ne}function jf(ye,Ne,at){if(!hl(at))return!1;var Jt=typeof Ne;return(Jt=="number"?Gi(at)&&tn(Ne,at.length):Jt=="string"&&Ne in at)?Mh(at[Ne],ye):!1}function Pf(ye){var Ne=typeof ye;return Ne=="string"||Ne=="number"||Ne=="symbol"||Ne=="boolean"?ye!=="__proto__":ye===null}function Ec(ye){return!!Cn&&Cn in ye}function Ah(ye){var Ne=ye&&ye.constructor,at=typeof Ne=="function"&&Ne.prototype||Ft;return ye===at}function Eh(ye){var Ne=[];if(ye!=null)for(var at in Object(ye))Ne.push(at);return Ne}function ju(ye){return xn.call(ye)}function zh(ye,Ne,at){return Ne=pr(Ne===void 0?ye.length-1:Ne,0),function(){for(var Jt=arguments,rn=-1,vn=pr(Jt.length-Ne,0),gn=Array(vn);++rn<vn;)gn[rn]=Jt[Ne+rn];rn=-1;for(var Hr=Array(Ne+1);++rn<Ne;)Hr[rn]=Jt[rn];return Hr[Ne]=at(gn),Yt(ye,this,Hr)}}function ul(ye,Ne){if(!(Ne==="constructor"&&typeof ye[Ne]=="function")&&Ne!="__proto__")return ye[Ne]}var km=P0(pi);function P0(ye){var Ne=0,at=0;return function(){var Jt=Di(),rn=s-(Jt-at);if(at=Jt,rn>0){if(++Ne>=i)return arguments[0]}else Ne=0;return ye.apply(void 0,arguments)}}function Cm(ye){if(ye!=null){try{return yn.call(ye)}catch{}try{return ye+""}catch{}}return""}function Mh(ye,Ne){return ye===Ne||ye!==ye&&Ne!==Ne}var Ia=Cs(function(){return arguments}())?Cs:function(ye){return ea(ye)&&an.call(ye,"callee")&&!vt.call(ye,"callee")},Zl=Array.isArray;function Gi(ye){return ye!=null&&Au(ye.length)&&!zc(ye)}function Os(ye){return ea(ye)&&Gi(ye)}var Pu=_i||Ef;function zc(ye){if(!hl(ye))return!1;var Ne=jc(ye);return Ne==O||Ne==P||Ne==m||Ne==D}function Au(ye){return typeof ye=="number"&&ye>-1&&ye%1==0&&ye<=a}function hl(ye){var Ne=typeof ye;return ye!=null&&(Ne=="object"||Ne=="function")}function ea(ye){return ye!=null&&typeof ye=="object"}function A0(ye){if(!ea(ye)||jc(ye)!=F)return!1;var Ne=Ut(ye);if(Ne===null)return!0;var at=an.call(Ne,"constructor")&&Ne.constructor;return typeof at=="function"&&at instanceof at&&yn.call(at)==di}var Af=et?rt(et):j0;function Tm(ye){return Po(ye,Om(ye))}function Om(ye){return Gi(ye)?Ai(ye):uo(ye)}var E0=Of(function(ye,Ne,at,Jt){Ts(ye,Ne,at,Jt)});function jm(ye){return function(){return ye}}function Mc(ye){return ye}function Ef(){return!1}t.exports=E0})(u2,u2.exports);var FY=u2.exports;const zl=s1(FY);function Vi(t,e=[]){const r=I.useRef(t);return I.useEffect(()=>{r.current=t}),I.useCallback((...n)=>{var i;return(i=r.current)==null?void 0:i.call(r,...n)},e)}function Pv(t,e,r,n){const i=Vi(r);return I.useEffect(()=>{const s=typeof t=="function"?t():t??document;if(!(!r||!s))return s.addEventListener(e,i,n),()=>{s.removeEventListener(e,i,n)}},[e,t,n,i,r]),()=>{const s=typeof t=="function"?t():t??document;s==null||s.removeEventListener(e,i,n)}}function BY(t){const{isOpen:e,ref:r}=t,[n,i]=I.useState(e),[s,a]=I.useState(!1);return I.useEffect(()=>{s||(i(e),a(!0))},[e,s,n]),Pv(()=>r.current,"animationend",()=>{i(e)}),{present:!(e?!1:!n),onComplete(){var y;const d=lY(r.current),m=new d.CustomEvent("animationend",{bubbles:!0});(y=r.current)==null||y.dispatchEvent(m)}}}function Kz(t){const{value:e,defaultValue:r,onChange:n,shouldUpdate:i=(w,O)=>w!==O}=t,s=Vi(n),a=Vi(i),[o,d]=I.useState(r),m=e!==void 0,y=m?e:o,v=Vi(w=>{const P=typeof w=="function"?w(y):w;a(y,P)&&(m||d(P),s(P))},[m,s,y,a]);return[y,v]}function $Y(t={}){const{onChange:e,precision:r,defaultValue:n,value:i,step:s=1,min:a=Number.MIN_SAFE_INTEGER,max:o=Number.MAX_SAFE_INTEGER,keepWithinRange:d=!0}=t,m=Vi(e),[y,v]=I.useState(()=>n==null?"":lO(n,s,r)??""),w=typeof i<"u",O=w?i:y,P=B8(hd(O),s),E=r??P,$=I.useCallback(oe=>{oe!==O&&(w||v(oe.toString()),m==null||m(oe.toString(),hd(oe)))},[m,w,O]),R=I.useCallback(oe=>{let ce=oe;return d&&(ce=oS(ce,a,o)),Gz(ce,E)},[E,d,o,a]),F=I.useCallback((oe=s)=>{let ce;O===""?ce=hd(oe):ce=hd(O)+oe,ce=R(ce),$(ce)},[R,s,$,O]),D=I.useCallback((oe=s)=>{let ce;O===""?ce=hd(-oe):ce=hd(O)-oe,ce=R(ce),$(ce)},[R,s,$,O]),U=I.useCallback(()=>{let oe;n==null?oe="":oe=lO(n,s,r)??a,$(oe)},[n,r,s,$,a]),X=I.useCallback(oe=>{const ce=lO(oe,s,E)??a;$(ce)},[E,s,$,a]),ee=hd(O);return{isOutOfRange:ee>o||ee<a,isAtMax:ee===o,isAtMin:ee===a,precision:E,value:O,valueAsNumber:ee,update:$,reset:U,increment:F,decrement:D,clamp:R,cast:X,setValue:v}}function hd(t){return parseFloat(t.toString().replace(/[^\w.-]+/g,""))}function B8(t,e){return Math.max(WP(e),WP(t))}function lO(t,e,r){const n=hd(t);if(Number.isNaN(n))return;const i=B8(n,e);return Gz(n,r??i)}function rm(t={}){const{onClose:e,onOpen:r,isOpen:n,id:i}=t,s=Vi(r),a=Vi(e),[o,d]=I.useState(t.defaultIsOpen||!1),m=n!==void 0?n:o,y=n!==void 0,v=I.useId(),w=i??`disclosure-${v}`,O=I.useCallback(()=>{y||d(!1),a==null||a()},[y,a]),P=I.useCallback(()=>{y||d(!0),s==null||s()},[y,s]),E=I.useCallback(()=>{m?O():P()},[m,P,O]);function $(F={}){return{...F,"aria-expanded":m,"aria-controls":w,onClick(D){var U;(U=F.onClick)==null||U.call(F,D),E()}}}function R(F={}){return{...F,hidden:!m,id:w}}return{isOpen:m,onOpen:P,onClose:O,onToggle:E,isControlled:y,getButtonProps:$,getDisclosureProps:R}}const Rp=globalThis!=null&&globalThis.document?I.useLayoutEffect:I.useEffect,ef=(t,e)=>{const r=I.useRef(!1),n=I.useRef(!1);I.useEffect(()=>{if(r.current&&n.current)return t();n.current=!0},e),I.useEffect(()=>(r.current=!0,()=>{r.current=!1}),[])};function NY(t){const e=t.current;if(!e)return!1;const r=uY(e);return!r||e.contains(r)?!1:!!kY(r)}function VY(t,e){const{visible:r,focusRef:n}=e,i=!r;ef(()=>{if(!i||NY(t))return;const s=(n==null?void 0:n.current)||t.current;let a;if(s)return a=requestAnimationFrame(()=>{s.focus({preventScroll:!0})}),()=>{cancelAnimationFrame(a)}},[i,t,n])}function WY(t,e){const r=I.useId();return I.useMemo(()=>t||[e,r].filter(Boolean).join("-"),[t,e,r])}function UY(t,...e){const r=WY(t);return I.useMemo(()=>e.map(n=>`${n}-${r}`),[r,e])}function qY(t,e){const r=Vi(t);I.useEffect(()=>{let n=null;const i=()=>r();return e!==null&&(n=window.setInterval(i,e)),()=>{n&&window.clearInterval(n)}},[e,r])}function $8(t){const e=I.useRef(null);return e.current=t,e}function QY(t,e){if(t!=null){if(typeof t=="function"){t(e);return}try{t.current=e}catch{throw new Error(`Cannot assign value '${e}' to ref '${t}'`)}}}function bi(...t){return e=>{t.forEach(r=>{QY(r,e)})}}function HY(...t){return I.useMemo(()=>bi(...t),t)}function GY(t){const{ref:e,handler:r,enabled:n=!0}=t,i=Vi(r),a=I.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;I.useEffect(()=>{if(!n)return;const o=v=>{cO(v,e)&&(a.isPointerDown=!0)},d=v=>{if(a.ignoreEmulatedMouseEvents){a.ignoreEmulatedMouseEvents=!1;return}a.isPointerDown&&r&&cO(v,e)&&(a.isPointerDown=!1,i(v))},m=v=>{a.ignoreEmulatedMouseEvents=!0,r&&a.isPointerDown&&cO(v,e)&&(a.isPointerDown=!1,i(v))},y=N8(e.current);return y.addEventListener("mousedown",o,!0),y.addEventListener("mouseup",d,!0),y.addEventListener("touchstart",o,!0),y.addEventListener("touchend",m,!0),()=>{y.removeEventListener("mousedown",o,!0),y.removeEventListener("mouseup",d,!0),y.removeEventListener("touchstart",o,!0),y.removeEventListener("touchend",m,!0)}},[r,e,i,a,n])}function cO(t,e){var n,i;const r=((n=t.composedPath)==null?void 0:n.call(t)[0])??t.target;return r&&!N8(r).contains(r)?!1:!((i=e.current)!=null&&i.contains(r))}function N8(t){return(t==null?void 0:t.ownerDocument)??document}function XY(t,e){const r=Vi(t);I.useEffect(()=>{if(e==null)return;let n=null;return n=window.setTimeout(()=>{r()},e),()=>{n&&window.clearTimeout(n)}},[e,r])}const V8=1/60*1e3,KY=typeof performance<"u"?()=>performance.now():()=>Date.now(),W8=typeof window<"u"?t=>window.requestAnimationFrame(t):t=>setTimeout(()=>t(KY()),V8);function ZY(t){let e=[],r=[],n=0,i=!1,s=!1;const a=new WeakSet,o={schedule:(d,m=!1,y=!1)=>{const v=y&&i,w=v?e:r;return m&&a.add(d),w.indexOf(d)===-1&&(w.push(d),v&&i&&(n=e.length)),d},cancel:d=>{const m=r.indexOf(d);m!==-1&&r.splice(m,1),a.delete(d)},process:d=>{if(i){s=!0;return}if(i=!0,[e,r]=[r,e],r.length=0,n=e.length,n)for(let m=0;m<n;m++){const y=e[m];y(d),a.has(y)&&(o.schedule(y),t())}i=!1,s&&(s=!1,o.process(d))}};return o}const YY=40;let UP=!0,pb=!1,qP=!1;const oy={delta:0,timestamp:0},d1=["read","update","preRender","render","postRender"],kk=d1.reduce((t,e)=>(t[e]=ZY(()=>pb=!0),t),{}),JY=d1.reduce((t,e)=>{const r=kk[e];return t[e]=(n,i=!1,s=!1)=>(pb||rJ(),r.schedule(n,i,s)),t},{}),eJ=d1.reduce((t,e)=>(t[e]=kk[e].cancel,t),{});d1.reduce((t,e)=>(t[e]=()=>kk[e].process(oy),t),{});const tJ=t=>kk[t].process(oy),U8=t=>{pb=!1,oy.delta=UP?V8:Math.max(Math.min(t-oy.timestamp,YY),1),oy.timestamp=t,qP=!0,d1.forEach(tJ),qP=!1,pb&&(UP=!1,W8(U8))},rJ=()=>{pb=!0,UP=!0,qP||W8(U8)},k3=()=>oy;var nJ=Object.defineProperty,iJ=(t,e,r)=>e in t?nJ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ic=(t,e,r)=>(iJ(t,typeof e!="symbol"?e+"":e,r),r);class sJ{constructor(e,r,n){if(ic(this,"history",[]),ic(this,"startEvent",null),ic(this,"lastEvent",null),ic(this,"lastEventInfo",null),ic(this,"handlers",{}),ic(this,"removeListeners",()=>{}),ic(this,"threshold",3),ic(this,"win"),ic(this,"updatePoint",()=>{if(!(this.lastEvent&&this.lastEventInfo))return;const o=uO(this.lastEventInfo,this.history),d=this.startEvent!==null,m=cJ(o.offset,{x:0,y:0})>=this.threshold;if(!d&&!m)return;const{timestamp:y}=k3();this.history.push({...o.point,timestamp:y});const{onStart:v,onMove:w}=this.handlers;d||(v==null||v(this.lastEvent,o),this.startEvent=this.lastEvent),w==null||w(this.lastEvent,o)}),ic(this,"onPointerMove",(o,d)=>{this.lastEvent=o,this.lastEventInfo=d,JY.update(this.updatePoint,!0)}),ic(this,"onPointerUp",(o,d)=>{const m=uO(d,this.history),{onEnd:y,onSessionEnd:v}=this.handlers;v==null||v(o,m),this.end(),!(!y||!this.startEvent)&&(y==null||y(o,m))}),this.win=e.view??window,dY(e))return;this.handlers=r,n&&(this.threshold=n),e.stopPropagation(),e.preventDefault();const i={point:A8(e)},{timestamp:s}=k3();this.history=[{...i.point,timestamp:s}];const{onSessionStart:a}=r;a==null||a(e,uO(i,this.history)),this.removeListeners=lJ(sS(this.win,"pointermove",this.onPointerMove),sS(this.win,"pointerup",this.onPointerUp),sS(this.win,"pointercancel",this.onPointerUp))}updateHandlers(e){this.handlers=e}end(){var e;(e=this.removeListeners)==null||e.call(this),eJ.update(this.updatePoint)}}function C3(t,e){return{x:t.x-e.x,y:t.y-e.y}}function uO(t,e){return{point:t.point,delta:C3(t.point,e[e.length-1]),offset:C3(t.point,e[0]),velocity:aJ(e,.1)}}const oJ=t=>t*1e3;function aJ(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const i=t[t.length-1];for(;r>=0&&(n=t[r],!(i.timestamp-n.timestamp>oJ(e)));)r--;if(!n)return{x:0,y:0};const s=(i.timestamp-n.timestamp)/1e3;if(s===0)return{x:0,y:0};const a={x:(i.x-n.x)/s,y:(i.y-n.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function lJ(...t){return e=>t.reduce((r,n)=>n(r),e)}function hO(t,e){return Math.abs(t-e)}function T3(t){return"x"in t&&"y"in t}function cJ(t,e){if(typeof t=="number"&&typeof e=="number")return hO(t,e);if(T3(t)&&T3(e)){const r=hO(t.x,e.x),n=hO(t.y,e.y);return Math.sqrt(r**2+n**2)}return 0}function uJ(t,e){const{onPan:r,onPanStart:n,onPanEnd:i,onPanSessionStart:s,onPanSessionEnd:a,threshold:o}=e,d=!!(r||n||i||s||a),m=I.useRef(null),y=$8({onSessionStart:s,onSessionEnd:a,onStart:n,onMove:r,onEnd(v,w){m.current=null,i==null||i(v,w)}});I.useEffect(()=>{var v;(v=m.current)==null||v.updateHandlers(y.current)}),I.useEffect(()=>{const v=t.current;if(!v||!d)return;function w(O){m.current=new sJ(O,y.current,o)}return sS(v,"pointerdown",w)},[t,d,y,o]),I.useEffect(()=>()=>{var v;(v=m.current)==null||v.end(),m.current=null},[])}const fs={open:(t,e)=>`${t}[data-open], ${t}[open], ${t}[data-state=open] ${e}`,closed:(t,e)=>`${t}[data-closed], ${t}[data-state=closed] ${e}`,hover:(t,e)=>`${t}:hover ${e}, ${t}[data-hover] ${e}`,focus:(t,e)=>`${t}:focus ${e}, ${t}[data-focus] ${e}`,focusVisible:(t,e)=>`${t}:focus-visible ${e}`,focusWithin:(t,e)=>`${t}:focus-within ${e}`,active:(t,e)=>`${t}:active ${e}, ${t}[data-active] ${e}`,disabled:(t,e)=>`${t}:disabled ${e}, ${t}[data-disabled] ${e}`,invalid:(t,e)=>`${t}:invalid ${e}, ${t}[data-invalid] ${e}`,checked:(t,e)=>`${t}:checked ${e}, ${t}[data-checked] ${e}`,placeholderShown:(t,e)=>`${t}:placeholder-shown ${e}`},Nc=t=>q8(e=>t(e,"&"),"[role=group]","[data-group]",".group"),Uu=t=>q8(e=>t(e,"~ &"),"[data-peer]",".peer"),q8=(t,...e)=>e.map(t).join(", "),ay={_hover:"&:hover, &[data-hover]",_active:"&:active, &[data-active]",_focus:"&:focus, &[data-focus]",_highlighted:"&[data-highlighted]",_focusWithin:"&:focus-within, &[data-focus-within]",_focusVisible:"&:focus-visible, &[data-focus-visible]",_disabled:"&:disabled, &[disabled], &[aria-disabled=true], &[data-disabled]",_readOnly:"&[aria-readonly=true], &[readonly], &[data-readonly]",_before:"&::before",_after:"&::after",_empty:"&:empty, &[data-empty]",_expanded:"&[aria-expanded=true], &[data-expanded], &[data-state=expanded]",_checked:"&[aria-checked=true], &[data-checked], &[data-state=checked]",_grabbed:"&[aria-grabbed=true], &[data-grabbed]",_pressed:"&[aria-pressed=true], &[data-pressed]",_invalid:"&[aria-invalid=true], &[data-invalid]",_valid:"&[data-valid], &[data-state=valid]",_loading:"&[data-loading], &[aria-busy=true]",_selected:"&[aria-selected=true], &[data-selected]",_hidden:"&[hidden], &[data-hidden]",_autofill:"&:-webkit-autofill",_even:"&:nth-of-type(even)",_odd:"&:nth-of-type(odd)",_first:"&:first-of-type",_firstLetter:"&::first-letter",_last:"&:last-of-type",_notFirst:"&:not(:first-of-type)",_notLast:"&:not(:last-of-type)",_visited:"&:visited",_activeLink:"&[aria-current=page]",_activeStep:"&[aria-current=step]",_indeterminate:"&:indeterminate, &[aria-checked=mixed], &[data-indeterminate], &[data-state=indeterminate]",_groupOpen:Nc(fs.open),_groupClosed:Nc(fs.closed),_groupHover:Nc(fs.hover),_peerHover:Uu(fs.hover),_groupFocus:Nc(fs.focus),_peerFocus:Uu(fs.focus),_groupFocusVisible:Nc(fs.focusVisible),_peerFocusVisible:Uu(fs.focusVisible),_groupActive:Nc(fs.active),_peerActive:Uu(fs.active),_groupDisabled:Nc(fs.disabled),_peerDisabled:Uu(fs.disabled),_groupInvalid:Nc(fs.invalid),_peerInvalid:Uu(fs.invalid),_groupChecked:Nc(fs.checked),_peerChecked:Uu(fs.checked),_groupFocusWithin:Nc(fs.focusWithin),_peerFocusWithin:Uu(fs.focusWithin),_peerPlaceholderShown:Uu(fs.placeholderShown),_placeholder:"&::placeholder, &[data-placeholder]",_placeholderShown:"&:placeholder-shown, &[data-placeholder-shown]",_fullScreen:"&:fullscreen, &[data-fullscreen]",_selection:"&::selection",_rtl:"[dir=rtl] &, &[dir=rtl]",_ltr:"[dir=ltr] &, &[dir=ltr]",_mediaDark:"@media (prefers-color-scheme: dark)",_mediaReduceMotion:"@media (prefers-reduced-motion: reduce)",_dark:".chakra-ui-dark &:not([data-theme]),[data-theme=dark] &:not([data-theme]),&[data-theme=dark]",_light:".chakra-ui-light &:not([data-theme]),[data-theme=light] &:not([data-theme]),&[data-theme=light]",_horizontal:"&[data-orientation=horizontal]",_vertical:"&[data-orientation=vertical]",_open:"&[data-open], &[open], &[data-state=open]",_closed:"&[data-closed], &[data-state=closed]",_complete:"&[data-complete]",_incomplete:"&[data-incomplete]",_current:"&[data-current]"},Q8=Object.keys(ay),hJ=t=>/!(important)?$/.test(t),O3=t=>typeof t=="string"?t.replace(/!(important)?$/,"").trim():t,dJ=(t,e)=>r=>{const n=String(e),i=hJ(n),s=O3(n),a=t?`${t}.${s}`:s;let o=no(r.__cssMap)&&a in r.__cssMap?r.__cssMap[a].varRef:e;return o=O3(o),i?`${o} !important`:o};function Zz(t){const{scale:e,transform:r,compose:n}=t;return(s,a)=>{const o=dJ(e,s)(a);let d=(r==null?void 0:r(o,a))??o;return n&&(d=n(d,a)),d}}const iw=(...t)=>e=>t.reduce((r,n)=>n(r),e);function yl(t,e){return r=>{const n={property:r,scale:t};return n.transform=Zz({scale:t,transform:e}),n}}const fJ=({rtl:t,ltr:e})=>r=>r.direction==="rtl"?t:e;function pJ(t){const{property:e,scale:r,transform:n}=t;return{scale:r,property:fJ(e),transform:r?Zz({scale:r,compose:n}):n}}const H8=["rotate(var(--chakra-rotate, 0))","scaleX(var(--chakra-scale-x, 1))","scaleY(var(--chakra-scale-y, 1))","skewX(var(--chakra-skew-x, 0))","skewY(var(--chakra-skew-y, 0))"];function mJ(){return["translateX(var(--chakra-translate-x, 0))","translateY(var(--chakra-translate-y, 0))",...H8].join(" ")}function gJ(){return["translate3d(var(--chakra-translate-x, 0), var(--chakra-translate-y, 0), 0)",...H8].join(" ")}const yJ={"--chakra-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-sepia":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-drop-shadow":"var(--chakra-empty,/*!*/ /*!*/)",filter:["var(--chakra-blur)","var(--chakra-brightness)","var(--chakra-contrast)","var(--chakra-grayscale)","var(--chakra-hue-rotate)","var(--chakra-invert)","var(--chakra-saturate)","var(--chakra-sepia)","var(--chakra-drop-shadow)"].join(" ")},xJ={backdropFilter:["var(--chakra-backdrop-blur)","var(--chakra-backdrop-brightness)","var(--chakra-backdrop-contrast)","var(--chakra-backdrop-grayscale)","var(--chakra-backdrop-hue-rotate)","var(--chakra-backdrop-invert)","var(--chakra-backdrop-opacity)","var(--chakra-backdrop-saturate)","var(--chakra-backdrop-sepia)"].join(" "),"--chakra-backdrop-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-opacity":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-sepia":"var(--chakra-empty,/*!*/ /*!*/)"};function vJ(t){return{"--chakra-ring-offset-shadow":"var(--chakra-ring-inset) 0 0 0 var(--chakra-ring-offset-width) var(--chakra-ring-offset-color)","--chakra-ring-shadow":"var(--chakra-ring-inset) 0 0 0 calc(var(--chakra-ring-width) + var(--chakra-ring-offset-width)) var(--chakra-ring-color)","--chakra-ring-width":t,boxShadow:["var(--chakra-ring-offset-shadow)","var(--chakra-ring-shadow)","var(--chakra-shadow, 0 0 #0000)"].join(", ")}}const bJ={"row-reverse":{space:"--chakra-space-x-reverse",divide:"--chakra-divide-x-reverse"},"column-reverse":{space:"--chakra-space-y-reverse",divide:"--chakra-divide-y-reverse"}},QP={"to-t":"to top","to-tr":"to top right","to-r":"to right","to-br":"to bottom right","to-b":"to bottom","to-bl":"to bottom left","to-l":"to left","to-tl":"to top left"},_J=new Set(Object.values(QP)),HP=new Set(["none","-moz-initial","inherit","initial","revert","unset"]),wJ=t=>t.trim();function SJ(t,e){if(t==null||HP.has(t))return t;if(!(GP(t)||HP.has(t)))return`url('${t}')`;const i=/(^[a-z-A-Z]+)\((.*)\)/g.exec(t),s=i==null?void 0:i[1],a=i==null?void 0:i[2];if(!s||!a)return t;const o=s.includes("-gradient")?s:`${s}-gradient`,[d,...m]=a.split(",").map(wJ).filter(Boolean);if((m==null?void 0:m.length)===0)return t;const y=d in QP?QP[d]:d;m.unshift(y);const v=m.map(w=>{if(_J.has(w))return w;const O=w.indexOf(" "),[P,E]=O!==-1?[w.substr(0,O),w.substr(O+1)]:[w],$=GP(E)?E:E&&E.split(" "),R=`colors.${P}`,F=R in e.__cssMap?e.__cssMap[R].varRef:P;return $?[F,...Array.isArray($)?$:[$]].join(" "):F});return`${o}(${v.join(", ")})`}const GP=t=>typeof t=="string"&&t.includes("(")&&t.includes(")"),kJ=(t,e)=>SJ(t,e??{});function CJ(t){return/^var\(--.+\)$/.test(t)}const TJ=t=>{const e=parseFloat(t.toString()),r=t.toString().replace(String(e),"");return{unitless:!r,value:e,unit:r}},Vc=t=>e=>`${t}(${e})`,dn={filter(t){return t!=="auto"?t:yJ},backdropFilter(t){return t!=="auto"?t:xJ},ring(t){return vJ(dn.px(t))},bgClip(t){return t==="text"?{color:"transparent",backgroundClip:"text"}:{backgroundClip:t}},transform(t){return t==="auto"?mJ():t==="auto-gpu"?gJ():t},vh(t){return t==="$100vh"?"var(--chakra-vh)":t},px(t){if(t==null)return t;const{unitless:e}=TJ(t);return e||typeof t=="number"?`${t}px`:t},fraction(t){return typeof t!="number"||t>1?t:`${t*100}%`},float(t,e){const r={left:"right",right:"left"};return e.direction==="rtl"?r[t]:t},degree(t){if(CJ(t)||t==null)return t;const e=typeof t=="string"&&!t.endsWith("deg");return typeof t=="number"||e?`${t}deg`:t},gradient:kJ,blur:Vc("blur"),opacity:Vc("opacity"),brightness:Vc("brightness"),contrast:Vc("contrast"),dropShadow:Vc("drop-shadow"),grayscale:Vc("grayscale"),hueRotate:t=>Vc("hue-rotate")(dn.degree(t)),invert:Vc("invert"),saturate:Vc("saturate"),sepia:Vc("sepia"),bgImage(t){return t==null||GP(t)||HP.has(t)?t:`url(${t})`},outline(t){const e=String(t)==="0"||String(t)==="none";return t!==null&&e?{outline:"2px solid transparent",outlineOffset:"2px"}:{outline:t}},flexDirection(t){const{space:e,divide:r}=bJ[t]??{},n={flexDirection:t};return e&&(n[e]=1),r&&(n[r]=1),n}},qe={borderWidths:yl("borderWidths"),borderStyles:yl("borderStyles"),colors:yl("colors"),borders:yl("borders"),gradients:yl("gradients",dn.gradient),radii:yl("radii",dn.px),space:yl("space",iw(dn.vh,dn.px)),spaceT:yl("space",iw(dn.vh,dn.px)),degreeT(t){return{property:t,transform:dn.degree}},prop(t,e,r){return{property:t,scale:e,...e&&{transform:Zz({scale:e,transform:r})}}},propT(t,e){return{property:t,transform:e}},sizes:yl("sizes",iw(dn.vh,dn.px)),sizesT:yl("sizes",iw(dn.vh,dn.fraction)),shadows:yl("shadows"),logical:pJ,blur:yl("blur",dn.blur)},aS={background:qe.colors("background"),backgroundColor:qe.colors("backgroundColor"),backgroundImage:qe.gradients("backgroundImage"),backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundAttachment:!0,backgroundClip:{transform:dn.bgClip},bgSize:qe.prop("backgroundSize"),bgPosition:qe.prop("backgroundPosition"),bg:qe.colors("background"),bgColor:qe.colors("backgroundColor"),bgPos:qe.prop("backgroundPosition"),bgRepeat:qe.prop("backgroundRepeat"),bgAttachment:qe.prop("backgroundAttachment"),bgGradient:qe.gradients("backgroundImage"),bgClip:{transform:dn.bgClip}};Object.assign(aS,{bgImage:aS.backgroundImage,bgImg:aS.backgroundImage});const Pn={border:qe.borders("border"),borderWidth:qe.borderWidths("borderWidth"),borderStyle:qe.borderStyles("borderStyle"),borderColor:qe.colors("borderColor"),borderRadius:qe.radii("borderRadius"),borderTop:qe.borders("borderTop"),borderBlockStart:qe.borders("borderBlockStart"),borderTopLeftRadius:qe.radii("borderTopLeftRadius"),borderStartStartRadius:qe.logical({scale:"radii",property:{ltr:"borderTopLeftRadius",rtl:"borderTopRightRadius"}}),borderEndStartRadius:qe.logical({scale:"radii",property:{ltr:"borderBottomLeftRadius",rtl:"borderBottomRightRadius"}}),borderTopRightRadius:qe.radii("borderTopRightRadius"),borderStartEndRadius:qe.logical({scale:"radii",property:{ltr:"borderTopRightRadius",rtl:"borderTopLeftRadius"}}),borderEndEndRadius:qe.logical({scale:"radii",property:{ltr:"borderBottomRightRadius",rtl:"borderBottomLeftRadius"}}),borderRight:qe.borders("borderRight"),borderInlineEnd:qe.borders("borderInlineEnd"),borderBottom:qe.borders("borderBottom"),borderBlockEnd:qe.borders("borderBlockEnd"),borderBottomLeftRadius:qe.radii("borderBottomLeftRadius"),borderBottomRightRadius:qe.radii("borderBottomRightRadius"),borderLeft:qe.borders("borderLeft"),borderInlineStart:{property:"borderInlineStart",scale:"borders"},borderInlineStartRadius:qe.logical({scale:"radii",property:{ltr:["borderTopLeftRadius","borderBottomLeftRadius"],rtl:["borderTopRightRadius","borderBottomRightRadius"]}}),borderInlineEndRadius:qe.logical({scale:"radii",property:{ltr:["borderTopRightRadius","borderBottomRightRadius"],rtl:["borderTopLeftRadius","borderBottomLeftRadius"]}}),borderX:qe.borders(["borderLeft","borderRight"]),borderInline:qe.borders("borderInline"),borderY:qe.borders(["borderTop","borderBottom"]),borderBlock:qe.borders("borderBlock"),borderTopWidth:qe.borderWidths("borderTopWidth"),borderBlockStartWidth:qe.borderWidths("borderBlockStartWidth"),borderTopColor:qe.colors("borderTopColor"),borderBlockStartColor:qe.colors("borderBlockStartColor"),borderTopStyle:qe.borderStyles("borderTopStyle"),borderBlockStartStyle:qe.borderStyles("borderBlockStartStyle"),borderBottomWidth:qe.borderWidths("borderBottomWidth"),borderBlockEndWidth:qe.borderWidths("borderBlockEndWidth"),borderBottomColor:qe.colors("borderBottomColor"),borderBlockEndColor:qe.colors("borderBlockEndColor"),borderBottomStyle:qe.borderStyles("borderBottomStyle"),borderBlockEndStyle:qe.borderStyles("borderBlockEndStyle"),borderLeftWidth:qe.borderWidths("borderLeftWidth"),borderInlineStartWidth:qe.borderWidths("borderInlineStartWidth"),borderLeftColor:qe.colors("borderLeftColor"),borderInlineStartColor:qe.colors("borderInlineStartColor"),borderLeftStyle:qe.borderStyles("borderLeftStyle"),borderInlineStartStyle:qe.borderStyles("borderInlineStartStyle"),borderRightWidth:qe.borderWidths("borderRightWidth"),borderInlineEndWidth:qe.borderWidths("borderInlineEndWidth"),borderRightColor:qe.colors("borderRightColor"),borderInlineEndColor:qe.colors("borderInlineEndColor"),borderRightStyle:qe.borderStyles("borderRightStyle"),borderInlineEndStyle:qe.borderStyles("borderInlineEndStyle"),borderTopRadius:qe.radii(["borderTopLeftRadius","borderTopRightRadius"]),borderBottomRadius:qe.radii(["borderBottomLeftRadius","borderBottomRightRadius"]),borderLeftRadius:qe.radii(["borderTopLeftRadius","borderBottomLeftRadius"]),borderRightRadius:qe.radii(["borderTopRightRadius","borderBottomRightRadius"])};Object.assign(Pn,{rounded:Pn.borderRadius,roundedTop:Pn.borderTopRadius,roundedTopLeft:Pn.borderTopLeftRadius,roundedTopRight:Pn.borderTopRightRadius,roundedTopStart:Pn.borderStartStartRadius,roundedTopEnd:Pn.borderStartEndRadius,roundedBottom:Pn.borderBottomRadius,roundedBottomLeft:Pn.borderBottomLeftRadius,roundedBottomRight:Pn.borderBottomRightRadius,roundedBottomStart:Pn.borderEndStartRadius,roundedBottomEnd:Pn.borderEndEndRadius,roundedLeft:Pn.borderLeftRadius,roundedRight:Pn.borderRightRadius,roundedStart:Pn.borderInlineStartRadius,roundedEnd:Pn.borderInlineEndRadius,borderStart:Pn.borderInlineStart,borderEnd:Pn.borderInlineEnd,borderTopStartRadius:Pn.borderStartStartRadius,borderTopEndRadius:Pn.borderStartEndRadius,borderBottomStartRadius:Pn.borderEndStartRadius,borderBottomEndRadius:Pn.borderEndEndRadius,borderStartRadius:Pn.borderInlineStartRadius,borderEndRadius:Pn.borderInlineEndRadius,borderStartWidth:Pn.borderInlineStartWidth,borderEndWidth:Pn.borderInlineEndWidth,borderStartColor:Pn.borderInlineStartColor,borderEndColor:Pn.borderInlineEndColor,borderStartStyle:Pn.borderInlineStartStyle,borderEndStyle:Pn.borderInlineEndStyle});const OJ={color:qe.colors("color"),textColor:qe.colors("color"),fill:qe.colors("fill"),stroke:qe.colors("stroke"),accentColor:qe.colors("accentColor"),textFillColor:qe.colors("textFillColor")},h2={alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:{transform:dn.flexDirection},flex:!0,flexFlow:!0,flexGrow:!0,flexShrink:!0,flexBasis:qe.sizes("flexBasis"),justifySelf:!0,alignSelf:!0,order:!0,placeItems:!0,placeContent:!0,placeSelf:!0,gap:qe.space("gap"),rowGap:qe.space("rowGap"),columnGap:qe.space("columnGap")};Object.assign(h2,{flexDir:h2.flexDirection});const vl={width:qe.sizesT("width"),inlineSize:qe.sizesT("inlineSize"),height:qe.sizes("height"),blockSize:qe.sizes("blockSize"),boxSize:qe.sizes(["width","height"]),minWidth:qe.sizes("minWidth"),minInlineSize:qe.sizes("minInlineSize"),minHeight:qe.sizes("minHeight"),minBlockSize:qe.sizes("minBlockSize"),maxWidth:qe.sizes("maxWidth"),maxInlineSize:qe.sizes("maxInlineSize"),maxHeight:qe.sizes("maxHeight"),maxBlockSize:qe.sizes("maxBlockSize"),overflow:!0,overflowX:!0,overflowY:!0,overscrollBehavior:!0,overscrollBehaviorX:!0,overscrollBehaviorY:!0,display:!0,aspectRatio:!0,hideFrom:{scale:"breakpoints",transform:(t,e)=>{var i,s;return{[`@media screen and (min-width: ${((s=(i=e.__breakpoints)==null?void 0:i.get(t))==null?void 0:s.minW)??t})`]:{display:"none"}}}},hideBelow:{scale:"breakpoints",transform:(t,e)=>{var i,s;return{[`@media screen and (max-width: ${((s=(i=e.__breakpoints)==null?void 0:i.get(t))==null?void 0:s._minW)??t})`]:{display:"none"}}}},verticalAlign:!0,boxSizing:!0,boxDecorationBreak:!0,float:qe.propT("float",dn.float),objectFit:!0,objectPosition:!0,visibility:!0,isolation:!0};Object.assign(vl,{w:vl.width,h:vl.height,minW:vl.minWidth,maxW:vl.maxWidth,minH:vl.minHeight,maxH:vl.maxHeight,overscroll:vl.overscrollBehavior,overscrollX:vl.overscrollBehaviorX,overscrollY:vl.overscrollBehaviorY});const jJ={filter:{transform:dn.filter},blur:qe.blur("--chakra-blur"),brightness:qe.propT("--chakra-brightness",dn.brightness),contrast:qe.propT("--chakra-contrast",dn.contrast),hueRotate:qe.propT("--chakra-hue-rotate",dn.hueRotate),invert:qe.propT("--chakra-invert",dn.invert),saturate:qe.propT("--chakra-saturate",dn.saturate),dropShadow:qe.propT("--chakra-drop-shadow",dn.dropShadow),backdropFilter:{transform:dn.backdropFilter},backdropBlur:qe.blur("--chakra-backdrop-blur"),backdropBrightness:qe.propT("--chakra-backdrop-brightness",dn.brightness),backdropContrast:qe.propT("--chakra-backdrop-contrast",dn.contrast),backdropHueRotate:qe.propT("--chakra-backdrop-hue-rotate",dn.hueRotate),backdropInvert:qe.propT("--chakra-backdrop-invert",dn.invert),backdropSaturate:qe.propT("--chakra-backdrop-saturate",dn.saturate)},PJ={ring:{transform:dn.ring},ringColor:qe.colors("--chakra-ring-color"),ringOffset:qe.prop("--chakra-ring-offset-width"),ringOffsetColor:qe.colors("--chakra-ring-offset-color"),ringInset:qe.prop("--chakra-ring-inset")},AJ={appearance:!0,cursor:!0,resize:!0,userSelect:!0,pointerEvents:!0,outline:{transform:dn.outline},outlineOffset:!0,outlineColor:qe.colors("outlineColor")},G8={gridGap:qe.space("gridGap"),gridColumnGap:qe.space("gridColumnGap"),gridRowGap:qe.space("gridRowGap"),gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridColumnStart:!0,gridColumnEnd:!0,gridRowStart:!0,gridRowEnd:!0,gridAutoRows:!0,gridTemplate:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0};function EJ(t,e,r,n){const i=typeof e=="string"?e.split("."):[e];for(n=0;n<i.length&&t;n+=1)t=t[i[n]];return t===void 0?r:t}const zJ=t=>{const e=new WeakMap;return(n,i,s,a)=>{if(typeof n>"u")return t(n,i,s);e.has(n)||e.set(n,new Map);const o=e.get(n);if(o.has(i))return o.get(i);const d=t(n,i,s,a);return o.set(i,d),d}},MJ=zJ(EJ),IJ={border:"0px",clip:"rect(0, 0, 0, 0)",width:"1px",height:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},RJ={position:"static",width:"auto",height:"auto",clip:"auto",padding:"0",margin:"0",overflow:"visible",whiteSpace:"normal"},dO=(t,e,r)=>{const n={},i=MJ(t,e,{});for(const s in i)s in r&&r[s]!=null||(n[s]=i[s]);return n},DJ={srOnly:{transform(t){return t===!0?IJ:t==="focusable"?RJ:{}}},layerStyle:{processResult:!0,transform:(t,e,r)=>dO(e,`layerStyles.${t}`,r)},textStyle:{processResult:!0,transform:(t,e,r)=>dO(e,`textStyles.${t}`,r)},apply:{processResult:!0,transform:(t,e,r)=>dO(e,t,r)}},Av={position:!0,pos:qe.prop("position"),zIndex:qe.prop("zIndex","zIndices"),inset:qe.spaceT("inset"),insetX:qe.spaceT(["left","right"]),insetInline:qe.spaceT("insetInline"),insetY:qe.spaceT(["top","bottom"]),insetBlock:qe.spaceT("insetBlock"),top:qe.spaceT("top"),insetBlockStart:qe.spaceT("insetBlockStart"),bottom:qe.spaceT("bottom"),insetBlockEnd:qe.spaceT("insetBlockEnd"),left:qe.spaceT("left"),insetInlineStart:qe.logical({scale:"space",property:{ltr:"left",rtl:"right"}}),right:qe.spaceT("right"),insetInlineEnd:qe.logical({scale:"space",property:{ltr:"right",rtl:"left"}})};Object.assign(Av,{insetStart:Av.insetInlineStart,insetEnd:Av.insetInlineEnd});const XP={boxShadow:qe.shadows("boxShadow"),mixBlendMode:!0,blendMode:qe.prop("mixBlendMode"),backgroundBlendMode:!0,bgBlendMode:qe.prop("backgroundBlendMode"),opacity:!0};Object.assign(XP,{shadow:XP.boxShadow});const ci={margin:qe.spaceT("margin"),marginTop:qe.spaceT("marginTop"),marginBlockStart:qe.spaceT("marginBlockStart"),marginRight:qe.spaceT("marginRight"),marginInlineEnd:qe.spaceT("marginInlineEnd"),marginBottom:qe.spaceT("marginBottom"),marginBlockEnd:qe.spaceT("marginBlockEnd"),marginLeft:qe.spaceT("marginLeft"),marginInlineStart:qe.spaceT("marginInlineStart"),marginX:qe.spaceT(["marginInlineStart","marginInlineEnd"]),marginInline:qe.spaceT("marginInline"),marginY:qe.spaceT(["marginTop","marginBottom"]),marginBlock:qe.spaceT("marginBlock"),padding:qe.space("padding"),paddingTop:qe.space("paddingTop"),paddingBlockStart:qe.space("paddingBlockStart"),paddingRight:qe.space("paddingRight"),paddingBottom:qe.space("paddingBottom"),paddingBlockEnd:qe.space("paddingBlockEnd"),paddingLeft:qe.space("paddingLeft"),paddingInlineStart:qe.space("paddingInlineStart"),paddingInlineEnd:qe.space("paddingInlineEnd"),paddingX:qe.space(["paddingInlineStart","paddingInlineEnd"]),paddingInline:qe.space("paddingInline"),paddingY:qe.space(["paddingTop","paddingBottom"]),paddingBlock:qe.space("paddingBlock")};Object.assign(ci,{m:ci.margin,mt:ci.marginTop,mr:ci.marginRight,me:ci.marginInlineEnd,marginEnd:ci.marginInlineEnd,mb:ci.marginBottom,ml:ci.marginLeft,ms:ci.marginInlineStart,marginStart:ci.marginInlineStart,mx:ci.marginX,my:ci.marginY,p:ci.padding,pt:ci.paddingTop,py:ci.paddingY,px:ci.paddingX,pb:ci.paddingBottom,pl:ci.paddingLeft,ps:ci.paddingInlineStart,paddingStart:ci.paddingInlineStart,pr:ci.paddingRight,pe:ci.paddingInlineEnd,paddingEnd:ci.paddingInlineEnd});const LJ={scrollBehavior:!0,scrollSnapAlign:!0,scrollSnapStop:!0,scrollSnapType:!0,scrollMargin:qe.spaceT("scrollMargin"),scrollMarginTop:qe.spaceT("scrollMarginTop"),scrollMarginBottom:qe.spaceT("scrollMarginBottom"),scrollMarginLeft:qe.spaceT("scrollMarginLeft"),scrollMarginRight:qe.spaceT("scrollMarginRight"),scrollMarginX:qe.spaceT(["scrollMarginLeft","scrollMarginRight"]),scrollMarginY:qe.spaceT(["scrollMarginTop","scrollMarginBottom"]),scrollPadding:qe.spaceT("scrollPadding"),scrollPaddingTop:qe.spaceT("scrollPaddingTop"),scrollPaddingBottom:qe.spaceT("scrollPaddingBottom"),scrollPaddingLeft:qe.spaceT("scrollPaddingLeft"),scrollPaddingRight:qe.spaceT("scrollPaddingRight"),scrollPaddingX:qe.spaceT(["scrollPaddingLeft","scrollPaddingRight"]),scrollPaddingY:qe.spaceT(["scrollPaddingTop","scrollPaddingBottom"])},FJ={fontFamily:qe.prop("fontFamily","fonts"),fontSize:qe.prop("fontSize","fontSizes",dn.px),fontWeight:qe.prop("fontWeight","fontWeights"),lineHeight:qe.prop("lineHeight","lineHeights"),letterSpacing:qe.prop("letterSpacing","letterSpacings"),textAlign:!0,fontStyle:!0,textIndent:!0,wordBreak:!0,overflowWrap:!0,textOverflow:!0,textTransform:!0,whiteSpace:!0,isTruncated:{transform(t){if(t===!0)return{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}},noOfLines:{static:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:"var(--chakra-line-clamp)"},property:"--chakra-line-clamp"}},BJ={textDecorationColor:qe.colors("textDecorationColor"),textDecoration:!0,textDecor:{property:"textDecoration"},textDecorationLine:!0,textDecorationStyle:!0,textDecorationThickness:!0,textUnderlineOffset:!0,textShadow:qe.shadows("textShadow")},$J={clipPath:!0,transform:qe.propT("transform",dn.transform),transformOrigin:!0,translateX:qe.spaceT("--chakra-translate-x"),translateY:qe.spaceT("--chakra-translate-y"),skewX:qe.degreeT("--chakra-skew-x"),skewY:qe.degreeT("--chakra-skew-y"),scaleX:qe.prop("--chakra-scale-x"),scaleY:qe.prop("--chakra-scale-y"),scale:qe.prop(["--chakra-scale-x","--chakra-scale-y"]),rotate:qe.degreeT("--chakra-rotate")},NJ={listStyleType:!0,listStylePosition:!0,listStylePos:qe.prop("listStylePosition"),listStyleImage:!0,listStyleImg:qe.prop("listStyleImage")},VJ={transition:!0,transitionDelay:!0,animation:!0,willChange:!0,transitionDuration:qe.prop("transitionDuration","transition.duration"),transitionProperty:qe.prop("transitionProperty","transition.property"),transitionTimingFunction:qe.prop("transitionTimingFunction","transition.easing")},Yz=zl({},aS,Pn,OJ,h2,vl,jJ,PJ,AJ,G8,DJ,Av,XP,ci,LJ,FJ,BJ,$J,NJ,VJ),WJ=Object.assign({},ci,vl,h2,G8,Av),X8=Object.keys(WJ),UJ=[...Object.keys(Yz),...Q8],qJ={...Yz,...ay},QJ=t=>t in qJ,HJ=t=>e=>{if(!e.__breakpoints)return t;const{isResponsive:r,toArrayValue:n,media:i}=e.__breakpoints,s={};for(const a in t){let o=Ka(t[a],e);if(o==null)continue;if(o=no(o)&&r(o)?n(o):o,!Array.isArray(o)){s[a]=o;continue}const d=o.slice(0,i.length).length;for(let m=0;m<d;m+=1){const y=i==null?void 0:i[m];if(!y){s[a]=o[m];continue}s[y]=s[y]||{},o[m]!=null&&(s[y][a]=o[m])}}return s};function GJ(t){const e=[];let r="",n=!1;for(let i=0;i<t.length;i++){const s=t[i];s==="("?(n=!0,r+=s):s===")"?(n=!1,r+=s):s===","&&!n?(e.push(r),r=""):r+=s}return r=r.trim(),r&&e.push(r),e}function XJ(t){return/^var\(--.+\)$/.test(t)}const KJ=(t,e)=>t.startsWith("--")&&typeof e=="string"&&!XJ(e),ZJ=(t,e)=>{if(e==null)return e;const r=a=>{var o,d;return(d=(o=t.__cssMap)==null?void 0:o[a])==null?void 0:d.varRef},n=a=>r(a)??a,[i,s]=GJ(e);return e=r(i)??n(s)??n(e),e};function YJ(t){const{configs:e={},pseudos:r={},theme:n}=t,i=(s,a=!1)=>{var y;const o=Ka(s,n),d=HJ(o)(n);let m={};for(let v in d){const w=d[v];let O=Ka(w,n);v in r&&(v=r[v]),KJ(v,O)&&(O=ZJ(n,O));let P=e[v];if(P===!0&&(P={property:v}),no(O)){m[v]=m[v]??{},m[v]=zl({},m[v],i(O,!0));continue}let E=((y=P==null?void 0:P.transform)==null?void 0:y.call(P,O,n,o))??O;E=P!=null&&P.processResult?i(E,!0):E;const $=Ka(P==null?void 0:P.property,n);if(!a&&(P!=null&&P.static)){const R=Ka(P.static,n);m=zl({},m,R)}if($&&Array.isArray($)){for(const R of $)m[R]=E;continue}if($){$==="&"&&no(E)?m=zl({},m,E):m[$]=E;continue}if(no(E)){m=zl({},m,E);continue}m[v]=E}return m};return i}const K8=t=>e=>YJ({theme:e,pseudos:ay,configs:Yz})(t);function si(t){return{definePartsStyle(e){return e},defineMultiStyleConfig(e){return{parts:t,...e}}}}function JJ(t,e,r){var n,i;return((i=(n=t.__cssMap)==null?void 0:n[`${e}.${r}`])==null?void 0:i.varRef)??r}function eee(t,e){if(Array.isArray(t))return t;if(no(t))return e(t);if(t!=null)return[t]}function tee(t,e){for(let r=e+1;r<t.length;r++)if(t[r]!=null)return r;return-1}function ree(t){const e=t.__breakpoints;return function(n,i,s,a){var w,O;if(!e)return;const o={},d=eee(s,e.toArrayValue);if(!d)return o;const m=d.length,y=m===1,v=!!n.parts;for(let P=0;P<m;P++){const E=e.details[P],$=e.details[tee(d,P)],R=iv(E.minW,$==null?void 0:$._minW),F=Ka((w=n[i])==null?void 0:w[d[P]],a);if(F){if(v){(O=n.parts)==null||O.forEach(D=>{zl(o,{[D]:y?F[D]:{[R]:F[D]}})});continue}if(!v){y?zl(o,F):o[R]=F;continue}o[R]=F}}return o}}function nee(t){return e=>{const{variant:r,size:n,theme:i}=e,s=ree(i);return zl({},Ka(t.baseStyle??{},e),s(t,"sizes",n,e),s(t,"variants",r,e))}}function Rn(t){return Sk(t,["styleConfig","size","variant","colorScheme"])}function Z8(t){return no(t)&&t.reference?t.reference:String(t)}const Ck=(t,...e)=>e.map(Z8).join(` ${t} `).replace(/calc/g,""),j3=(...t)=>`calc(${Ck("+",...t)})`,P3=(...t)=>`calc(${Ck("-",...t)})`,KP=(...t)=>`calc(${Ck("*",...t)})`,A3=(...t)=>`calc(${Ck("/",...t)})`,E3=t=>{const e=Z8(t);return e!=null&&!Number.isNaN(parseFloat(e))?String(e).startsWith("-")?String(e).slice(1):`-${e}`:KP(e,-1)},eh=Object.assign(t=>({add:(...e)=>eh(j3(t,...e)),subtract:(...e)=>eh(P3(t,...e)),multiply:(...e)=>eh(KP(t,...e)),divide:(...e)=>eh(A3(t,...e)),negate:()=>eh(E3(t)),toString:()=>t.toString()}),{add:j3,subtract:P3,multiply:KP,divide:A3,negate:E3});function iee(t,e="-"){return t.replace(/\s+/g,e)}function see(t){const e=iee(t.toString());return aee(oee(e))}function oee(t){return t.includes("\\.")?t:!Number.isInteger(parseFloat(t.toString()))?t.replace(".","\\."):t}function aee(t){return t.replace(/[!-,/:-@[-^`{-~]/g,"\\$&")}function lee(t,e=""){return[e,t].filter(Boolean).join("-")}function cee(t,e){return`var(${t}${e?`, ${e}`:""})`}function uee(t,e=""){return see(`--${lee(t,e)}`)}function Mr(t,e,r){const n=uee(t,r);return{variable:n,reference:cee(n,e)}}function hee(t,e){const r={};for(const n of e){if(Array.isArray(n)){const[i,s]=n;r[i]=Mr(`${t}-${i}`,s);continue}r[n]=Mr(`${t}-${n}`)}return r}const dee=["colors","borders","borderWidths","borderStyles","fonts","fontSizes","fontWeights","gradients","letterSpacings","lineHeights","radii","space","shadows","sizes","zIndices","transition","blur","breakpoints"];function fee(t){return D8(t,dee)}function pee(t){return t.semanticTokens}function mee(t){const{__cssMap:e,__cssVars:r,__breakpoints:n,...i}=t;return i}function gee(t){const e=fee(t),r=pee(t),n=s=>Q8.includes(s)||s==="default",i={};return S3(e,(s,a)=>{s!=null&&(i[a.join(".")]={isSemantic:!1,value:s})}),S3(r,(s,a)=>{s!=null&&(i[a.join(".")]={isSemantic:!0,value:s})},{stop:s=>Object.keys(s).every(n)}),i}function z3(t,e){return Mr(String(t).replace(/\./g,"-"),void 0,e)}function yee(t){var a;const e=gee(t),r=(a=t.config)==null?void 0:a.cssVarPrefix;let n={};const i={};function s(o,d){const y=[String(o).split(".")[0],d].join(".");if(!e[y])return d;const{reference:w}=z3(y,r);return w}for(const[o,d]of Object.entries(e)){const{isSemantic:m,value:y}=d,{variable:v,reference:w}=z3(o,r);if(!m){if(o.startsWith("space")){const P=o.split("."),[E,...$]=P,R=`${E}.-${$.join(".")}`,F=eh.negate(y),D=eh.negate(w);i[R]={value:F,var:v,varRef:D}}n[v]=y,i[o]={value:y,var:v,varRef:w};continue}const O=no(y)?y:{default:y};n=zl(n,Object.entries(O).reduce((P,[E,$])=>{if(!$)return P;const R=s(o,`${$}`);if(E==="default")return P[v]=R,P;const F=(ay==null?void 0:ay[E])??E;return P[F]={[v]:R},P},{})),i[o]={value:w,var:v,varRef:w}}return{cssVars:n,cssMap:i}}function xee(t){const e=mee(t),{cssMap:r,cssVars:n}=yee(e);return Object.assign(e,{__cssVars:{...{"--chakra-ring-inset":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-ring-offset-width":"0px","--chakra-ring-offset-color":"#fff","--chakra-ring-color":"rgba(66, 153, 225, 0.6)","--chakra-ring-offset-shadow":"0 0 #0000","--chakra-ring-shadow":"0 0 #0000","--chakra-space-x-reverse":"0","--chakra-space-y-reverse":"0"},...n},__cssMap:r,__breakpoints:_Y(e.breakpoints)}),e}function In(t,e={}){let r=!1;function n(){if(!r){r=!0;return}throw new Error("[anatomy] .part(...) should only be called once. Did you mean to use .extend(...) ?")}function i(...y){n();for(const v of y)e[v]=d(v);return In(t,e)}function s(...y){for(const v of y)v in e||(e[v]=d(v));return In(t,e)}function a(){return Object.fromEntries(Object.entries(e).map(([v,w])=>[v,w.selector]))}function o(){return Object.fromEntries(Object.entries(e).map(([v,w])=>[v,w.className]))}function d(y){const O=`chakra-${(["container","root"].includes(y??"")?[t]:[t,y]).filter(Boolean).join("__")}`;return{className:O,selector:`.${O}`,toString:()=>y}}return{parts:i,toPart:d,extend:s,selectors:a,classnames:o,get keys(){return Object.keys(e)},__type:{}}}const vee=In("accordion").parts("root","container","button","panel","icon"),bee=In("alert").parts("title","description","container","icon","spinner"),_ee=In("avatar").parts("label","badge","container","excessLabel","group"),wee=In("breadcrumb").parts("link","item","container","separator");In("button").parts();const See=In("checkbox").parts("control","icon","container","label");In("progress").parts("track","filledTrack","label");const kee=In("drawer").parts("overlay","dialogContainer","dialog","header","closeButton","body","footer"),Cee=In("editable").parts("preview","input","textarea"),Tee=In("form").parts("container","requiredIndicator","helperText"),Oee=In("formError").parts("text","icon"),jee=In("input").parts("addon","field","element","group"),Pee=In("list").parts("container","item","icon"),Aee=In("menu").parts("button","list","item","groupTitle","icon","command","divider"),Eee=In("modal").parts("overlay","dialogContainer","dialog","header","closeButton","body","footer"),zee=In("numberinput").parts("root","field","stepperGroup","stepper");In("pininput").parts("field");const Mee=In("popover").parts("content","header","body","footer","popper","arrow","closeButton"),Iee=In("progress").parts("label","filledTrack","track"),Ree=In("radio").parts("container","control","label"),Dee=In("select").parts("field","icon"),Lee=In("slider").parts("container","track","thumb","filledTrack","mark"),Fee=In("stat").parts("container","label","helpText","number","icon"),Bee=In("switch").parts("container","track","thumb","label"),$ee=In("table").parts("table","thead","tbody","tr","th","td","tfoot","caption"),Nee=In("tabs").parts("root","tab","tablist","tabpanel","tabpanels","indicator"),Vee=In("tag").parts("container","label","closeButton"),Wee=In("card").parts("container","header","body","footer");In("stepper").parts("stepper","step","title","description","indicator","separator","icon","number");const{definePartsStyle:Uee,defineMultiStyleConfig:qee}=si(vee.keys),Qee={borderTopWidth:"1px",borderColor:"inherit",_last:{borderBottomWidth:"1px"}},Hee={transitionProperty:"common",transitionDuration:"normal",fontSize:"md",_focusVisible:{boxShadow:"outline"},_hover:{bg:"blackAlpha.50"},_disabled:{opacity:.4,cursor:"not-allowed"},px:"4",py:"2"},Gee={pt:"2",px:"4",pb:"5"},Xee={fontSize:"1.25em"},Kee=Uee({container:Qee,button:Hee,panel:Gee,icon:Xee}),Zee=qee({baseStyle:Kee});function xp(t,e,r){return Math.min(Math.max(t,r),e)}class Yee extends Error{constructor(e){super(`Failed to parse color: "${e}"`)}}var sv=Yee;function Jz(t){if(typeof t!="string")throw new sv(t);if(t.trim().toLowerCase()==="transparent")return[0,0,0,0];let e=t.trim();e=ote.test(t)?tte(t):t;const r=rte.exec(e);if(r){const a=Array.from(r).slice(1);return[...a.slice(0,3).map(o=>parseInt(mb(o,2),16)),parseInt(mb(a[3]||"f",2),16)/255]}const n=nte.exec(e);if(n){const a=Array.from(n).slice(1);return[...a.slice(0,3).map(o=>parseInt(o,16)),parseInt(a[3]||"ff",16)/255]}const i=ite.exec(e);if(i){const a=Array.from(i).slice(1);return[...a.slice(0,3).map(o=>parseInt(o,10)),parseFloat(a[3]||"1")]}const s=ste.exec(e);if(s){const[a,o,d,m]=Array.from(s).slice(1).map(parseFloat);if(xp(0,100,o)!==o)throw new sv(t);if(xp(0,100,d)!==d)throw new sv(t);return[...ate(a,o,d),Number.isNaN(m)?1:m]}throw new sv(t)}function Jee(t){let e=5381,r=t.length;for(;r;)e=e*33^t.charCodeAt(--r);return(e>>>0)%2341}const M3=t=>parseInt(t.replace(/_/g,""),36),ete="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((t,e)=>{const r=M3(e.substring(0,3)),n=M3(e.substring(3)).toString(16);let i="";for(let s=0;s<6-n.length;s++)i+="0";return t[r]=`${i}${n}`,t},{});function tte(t){const e=t.toLowerCase().trim(),r=ete[Jee(e)];if(!r)throw new sv(t);return`#${r}`}const mb=(t,e)=>Array.from(Array(e)).map(()=>t).join(""),rte=new RegExp(`^#${mb("([a-f0-9])",3)}([a-f0-9])?$`,"i"),nte=new RegExp(`^#${mb("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),ite=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${mb(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),ste=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,ote=/^[a-z]+$/i,I3=t=>Math.round(t*255),ate=(t,e,r)=>{let n=r/100;if(e===0)return[n,n,n].map(I3);const i=(t%360+360)%360/60,s=(1-Math.abs(2*n-1))*(e/100),a=s*(1-Math.abs(i%2-1));let o=0,d=0,m=0;i>=0&&i<1?(o=s,d=a):i>=1&&i<2?(o=a,d=s):i>=2&&i<3?(d=s,m=a):i>=3&&i<4?(d=a,m=s):i>=4&&i<5?(o=a,m=s):i>=5&&i<6&&(o=s,m=a);const y=n-s/2,v=o+y,w=d+y,O=m+y;return[v,w,O].map(I3)};function lte(t,e,r,n){return`rgba(${xp(0,255,t).toFixed()}, ${xp(0,255,e).toFixed()}, ${xp(0,255,r).toFixed()}, ${parseFloat(xp(0,1,n).toFixed(3))})`}function cte(t,e){const[r,n,i,s]=Jz(t);return lte(r,n,i,s-e)}function ute(t){const[e,r,n,i]=Jz(t);let s=a=>{const o=xp(0,255,a).toString(16);return o.length===1?`0${o}`:o};return`#${s(e)}${s(r)}${s(n)}${i<1?s(Math.round(i*255)):""}`}const hte=t=>Object.keys(t).length===0;function dte(t,e,r,n,i){for(e=e.split?e.split("."):e,n=0;n<e.length;n++)t=t?t[e[n]]:i;return t===i?r:t}const qo=(t,e,r)=>{const n=dte(t,`colors.${e}`,e);try{return ute(n),n}catch{return"#000000"}},fte=t=>{const[e,r,n]=Jz(t);return(e*299+r*587+n*114)/1e3},pte=t=>e=>{const r=qo(e,t);return fte(r)<128?"dark":"light"},mte=t=>e=>pte(t)(e)==="dark",Uy=(t,e)=>r=>{const n=qo(r,t);return cte(n,1-e)};function R3(t="1rem",e="rgba(255, 255, 255, 0.15)"){return{backgroundImage:`linear-gradient(
    45deg,
    ${e} 25%,
    transparent 25%,
    transparent 50%,
    ${e} 50%,
    ${e} 75%,
    transparent 75%,
    transparent
  )`,backgroundSize:`${t} ${t}`}}const gte=()=>`#${Math.floor(Math.random()*16777215).toString(16).padEnd(6,"0")}`;function yte(t){const e=gte();return!t||hte(t)?e:t.string&&t.colors?vte(t.string,t.colors):t.string&&!t.colors?xte(t.string):t.colors&&!t.string?bte(t.colors):e}function xte(t){let e=0;if(t.length===0)return e.toString();for(let n=0;n<t.length;n+=1)e=t.charCodeAt(n)+((e<<5)-e),e=e&e;let r="#";for(let n=0;n<3;n+=1){const i=e>>n*8&255;r+=`00${i.toString(16)}`.substr(-2)}return r}function vte(t,e){let r=0;if(t.length===0)return e[0];for(let n=0;n<t.length;n+=1)r=t.charCodeAt(n)+((r<<5)-r),r=r&r;return r=(r%e.length+e.length)%e.length,e[r]}function bte(t){return t[Math.floor(Math.random()*t.length)]}function zr(t,e){return r=>r.colorMode==="dark"?e:t}function e5(t){const{orientation:e,vertical:r,horizontal:n}=t;return e?e==="vertical"?r:n:{}}function Y8(t){return no(t)&&t.reference?t.reference:String(t)}const Tk=(t,...e)=>e.map(Y8).join(` ${t} `).replace(/calc/g,""),D3=(...t)=>`calc(${Tk("+",...t)})`,L3=(...t)=>`calc(${Tk("-",...t)})`,ZP=(...t)=>`calc(${Tk("*",...t)})`,F3=(...t)=>`calc(${Tk("/",...t)})`,B3=t=>{const e=Y8(t);return e!=null&&!Number.isNaN(parseFloat(e))?String(e).startsWith("-")?String(e).slice(1):`-${e}`:ZP(e,-1)},th=Object.assign(t=>({add:(...e)=>th(D3(t,...e)),subtract:(...e)=>th(L3(t,...e)),multiply:(...e)=>th(ZP(t,...e)),divide:(...e)=>th(F3(t,...e)),negate:()=>th(B3(t)),toString:()=>t.toString()}),{add:D3,subtract:L3,multiply:ZP,divide:F3,negate:B3});function _te(t){return!Number.isInteger(parseFloat(t.toString()))}function wte(t,e="-"){return t.replace(/\s+/g,e)}function J8(t){const e=wte(t.toString());return e.includes("\\.")?t:_te(t)?e.replace(".","\\."):t}function Ste(t,e=""){return[e,J8(t)].filter(Boolean).join("-")}function kte(t,e){return`var(${J8(t)}${e?`, ${e}`:""})`}function Cte(t,e=""){return`--${Ste(t,e)}`}function Ss(t,e){const r=Cte(t,e==null?void 0:e.prefix);return{variable:r,reference:kte(r,Tte(e==null?void 0:e.fallback))}}function Tte(t){return t==null?void 0:t.reference}const{definePartsStyle:f1,defineMultiStyleConfig:Ote}=si(bee.keys),Ja=Mr("alert-fg"),_h=Mr("alert-bg"),jte=f1({container:{bg:_h.reference,px:"4",py:"3"},title:{fontWeight:"bold",lineHeight:"6",marginEnd:"2"},description:{lineHeight:"6"},icon:{color:Ja.reference,flexShrink:0,marginEnd:"3",w:"5",h:"6"},spinner:{color:Ja.reference,flexShrink:0,marginEnd:"3",w:"5",h:"5"}});function t5(t){const{theme:e,colorScheme:r}=t,n=Uy(`${r}.200`,.16)(e);return{light:`colors.${r}.100`,dark:n}}const Pte=f1(t=>{const{colorScheme:e}=t,r=t5(t);return{container:{[Ja.variable]:`colors.${e}.600`,[_h.variable]:r.light,_dark:{[Ja.variable]:`colors.${e}.200`,[_h.variable]:r.dark}}}}),Ate=f1(t=>{const{colorScheme:e}=t,r=t5(t);return{container:{[Ja.variable]:`colors.${e}.600`,[_h.variable]:r.light,_dark:{[Ja.variable]:`colors.${e}.200`,[_h.variable]:r.dark},paddingStart:"3",borderStartWidth:"4px",borderStartColor:Ja.reference}}}),Ete=f1(t=>{const{colorScheme:e}=t,r=t5(t);return{container:{[Ja.variable]:`colors.${e}.600`,[_h.variable]:r.light,_dark:{[Ja.variable]:`colors.${e}.200`,[_h.variable]:r.dark},pt:"2",borderTopWidth:"4px",borderTopColor:Ja.reference}}}),zte=f1(t=>{const{colorScheme:e}=t;return{container:{[Ja.variable]:"colors.white",[_h.variable]:`colors.${e}.600`,_dark:{[Ja.variable]:"colors.gray.900",[_h.variable]:`colors.${e}.200`},color:Ja.reference}}}),Mte={subtle:Pte,"left-accent":Ate,"top-accent":Ete,solid:zte},Ite=Ote({baseStyle:jte,variants:Mte,defaultProps:{variant:"subtle",colorScheme:"blue"}}),eV={px:"1px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"},Rte={max:"max-content",min:"min-content",full:"100%","3xs":"14rem","2xs":"16rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem","8xl":"90rem",prose:"60ch"},Dte={sm:"640px",md:"768px",lg:"1024px",xl:"1280px"},tV={...eV,...Rte,container:Dte},Lte=t=>typeof t=="function";function Ho(t,...e){return Lte(t)?t(...e):t}const{definePartsStyle:rV,defineMultiStyleConfig:Fte}=si(_ee.keys),ly=Mr("avatar-border-color"),Ev=Mr("avatar-bg"),gb=Mr("avatar-font-size"),qy=Mr("avatar-size"),Bte={borderRadius:"full",border:"0.2em solid",borderColor:ly.reference,[ly.variable]:"white",_dark:{[ly.variable]:"colors.gray.800"}},$te={bg:Ev.reference,fontSize:gb.reference,width:qy.reference,height:qy.reference,lineHeight:"1",[Ev.variable]:"colors.gray.200",_dark:{[Ev.variable]:"colors.whiteAlpha.400"}},Nte=t=>{const{name:e,theme:r}=t,n=e?yte({string:e}):"colors.gray.400",i=mte(n)(r);let s="white";return i||(s="gray.800"),{bg:Ev.reference,fontSize:gb.reference,color:s,borderColor:ly.reference,verticalAlign:"top",width:qy.reference,height:qy.reference,"&:not([data-loaded])":{[Ev.variable]:n},[ly.variable]:"colors.white",_dark:{[ly.variable]:"colors.gray.800"}}},Vte={fontSize:gb.reference,lineHeight:"1"},Wte=rV(t=>({badge:Ho(Bte,t),excessLabel:Ho($te,t),container:Ho(Nte,t),label:Vte}));function cd(t){const e=t!=="100%"?tV[t]:void 0;return rV({container:{[qy.variable]:e??t,[gb.variable]:`calc(${e??t} / 2.5)`},excessLabel:{[qy.variable]:e??t,[gb.variable]:`calc(${e??t} / 2.5)`}})}const Ute={"2xs":cd(4),xs:cd(6),sm:cd(8),md:cd(12),lg:cd(16),xl:cd(24),"2xl":cd(32),full:cd("100%")},qte=Fte({baseStyle:Wte,sizes:Ute,defaultProps:{size:"md"}}),Ui=hee("badge",["bg","color","shadow"]),Qte={px:1,textTransform:"uppercase",fontSize:"xs",borderRadius:"sm",fontWeight:"bold",bg:Ui.bg.reference,color:Ui.color.reference,boxShadow:Ui.shadow.reference},Hte=t=>{const{colorScheme:e,theme:r}=t,n=Uy(`${e}.500`,.6)(r);return{[Ui.bg.variable]:`colors.${e}.500`,[Ui.color.variable]:"colors.white",_dark:{[Ui.bg.variable]:n,[Ui.color.variable]:"colors.whiteAlpha.800"}}},Gte=t=>{const{colorScheme:e,theme:r}=t,n=Uy(`${e}.200`,.16)(r);return{[Ui.bg.variable]:`colors.${e}.100`,[Ui.color.variable]:`colors.${e}.800`,_dark:{[Ui.bg.variable]:n,[Ui.color.variable]:`colors.${e}.200`}}},Xte=t=>{const{colorScheme:e,theme:r}=t,n=Uy(`${e}.200`,.8)(r);return{[Ui.color.variable]:`colors.${e}.500`,_dark:{[Ui.color.variable]:n},[Ui.shadow.variable]:`inset 0 0 0px 1px ${Ui.color.reference}`}},Kte={solid:Hte,subtle:Gte,outline:Xte},zv={baseStyle:Qte,variants:Kte,defaultProps:{variant:"subtle",colorScheme:"gray"}},{defineMultiStyleConfig:Zte,definePartsStyle:Yte}=si(wee.keys),fO=Mr("breadcrumb-link-decor"),Jte={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",outline:"none",color:"inherit",textDecoration:fO.reference,[fO.variable]:"none","&:not([aria-current=page])":{cursor:"pointer",_hover:{[fO.variable]:"underline"},_focusVisible:{boxShadow:"outline"}}},ere=Yte({link:Jte}),tre=Zte({baseStyle:ere}),rre={lineHeight:"1.2",borderRadius:"md",fontWeight:"semibold",transitionProperty:"common",transitionDuration:"normal",_focusVisible:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{_disabled:{bg:"initial"}}},nV=t=>{const{colorScheme:e,theme:r}=t;if(e==="gray")return{color:zr("gray.800","whiteAlpha.900")(t),_hover:{bg:zr("gray.100","whiteAlpha.200")(t)},_active:{bg:zr("gray.200","whiteAlpha.300")(t)}};const n=Uy(`${e}.200`,.12)(r),i=Uy(`${e}.200`,.24)(r);return{color:zr(`${e}.600`,`${e}.200`)(t),bg:"transparent",_hover:{bg:zr(`${e}.50`,n)(t)},_active:{bg:zr(`${e}.100`,i)(t)}}},nre=t=>{const{colorScheme:e}=t,r=zr("gray.200","whiteAlpha.300")(t);return{border:"1px solid",borderColor:e==="gray"?r:"currentColor",".chakra-button__group[data-attached][data-orientation=horizontal] > &:not(:last-of-type)":{marginEnd:"-1px"},".chakra-button__group[data-attached][data-orientation=vertical] > &:not(:last-of-type)":{marginBottom:"-1px"},...Ho(nV,t)}},ire={yellow:{bg:"yellow.400",color:"black",hoverBg:"yellow.500",activeBg:"yellow.600"},cyan:{bg:"cyan.400",color:"black",hoverBg:"cyan.500",activeBg:"cyan.600"}},sre=t=>{const{colorScheme:e}=t;if(e==="gray"){const o=zr("gray.100","whiteAlpha.200")(t);return{bg:o,color:zr("gray.800","whiteAlpha.900")(t),_hover:{bg:zr("gray.200","whiteAlpha.300")(t),_disabled:{bg:o}},_active:{bg:zr("gray.300","whiteAlpha.400")(t)}}}const{bg:r=`${e}.500`,color:n="white",hoverBg:i=`${e}.600`,activeBg:s=`${e}.700`}=ire[e]??{},a=zr(r,`${e}.200`)(t);return{bg:a,color:zr(n,"gray.800")(t),_hover:{bg:zr(i,`${e}.300`)(t),_disabled:{bg:a}},_active:{bg:zr(s,`${e}.400`)(t)}}},ore=t=>{const{colorScheme:e}=t;return{padding:0,height:"auto",lineHeight:"normal",verticalAlign:"baseline",color:zr(`${e}.500`,`${e}.200`)(t),_hover:{textDecoration:"underline",_disabled:{textDecoration:"none"}},_active:{color:zr(`${e}.700`,`${e}.500`)(t)}}},are={bg:"none",color:"inherit",display:"inline",lineHeight:"inherit",m:"0",p:"0"},lre={ghost:nV,outline:nre,solid:sre,link:ore,unstyled:are},cre={lg:{h:"12",minW:"12",fontSize:"lg",px:"6"},md:{h:"10",minW:"10",fontSize:"md",px:"4"},sm:{h:"8",minW:"8",fontSize:"sm",px:"3"},xs:{h:"6",minW:"6",fontSize:"xs",px:"2"}},ure={baseStyle:rre,variants:lre,sizes:cre,defaultProps:{variant:"solid",size:"md",colorScheme:"gray"}},{definePartsStyle:Dp,defineMultiStyleConfig:hre}=si(Wee.keys),d2=Mr("card-bg"),hh=Mr("card-padding"),iV=Mr("card-shadow"),lS=Mr("card-radius"),sV=Mr("card-border-width","0"),oV=Mr("card-border-color"),dre=Dp({container:{[d2.variable]:"colors.chakra-body-bg",backgroundColor:d2.reference,boxShadow:iV.reference,borderRadius:lS.reference,color:"chakra-body-text",borderWidth:sV.reference,borderColor:oV.reference},body:{padding:hh.reference,flex:"1 1 0%"},header:{padding:hh.reference},footer:{padding:hh.reference}}),fre={sm:Dp({container:{[lS.variable]:"radii.base",[hh.variable]:"space.3"}}),md:Dp({container:{[lS.variable]:"radii.md",[hh.variable]:"space.5"}}),lg:Dp({container:{[lS.variable]:"radii.xl",[hh.variable]:"space.7"}})},pre={elevated:Dp({container:{[iV.variable]:"shadows.base",_dark:{[d2.variable]:"colors.gray.700"}}}),outline:Dp({container:{[sV.variable]:"1px",[oV.variable]:"colors.chakra-border-color"}}),filled:Dp({container:{[d2.variable]:"colors.chakra-subtle-bg"}}),unstyled:{body:{[hh.variable]:0},header:{[hh.variable]:0},footer:{[hh.variable]:0}}},mre=hre({baseStyle:dre,variants:pre,sizes:fre,defaultProps:{variant:"elevated",size:"md"}}),{definePartsStyle:cS,defineMultiStyleConfig:gre}=si(See.keys),Mv=Mr("checkbox-size"),yre=t=>{const{colorScheme:e}=t;return{w:Mv.reference,h:Mv.reference,transitionProperty:"box-shadow",transitionDuration:"normal",border:"2px solid",borderRadius:"sm",borderColor:"inherit",color:"white",_checked:{bg:zr(`${e}.500`,`${e}.200`)(t),borderColor:zr(`${e}.500`,`${e}.200`)(t),color:zr("white","gray.900")(t),_hover:{bg:zr(`${e}.600`,`${e}.300`)(t),borderColor:zr(`${e}.600`,`${e}.300`)(t)},_disabled:{borderColor:zr("gray.200","transparent")(t),bg:zr("gray.200","whiteAlpha.300")(t),color:zr("gray.500","whiteAlpha.500")(t)}},_indeterminate:{bg:zr(`${e}.500`,`${e}.200`)(t),borderColor:zr(`${e}.500`,`${e}.200`)(t),color:zr("white","gray.900")(t)},_disabled:{bg:zr("gray.100","whiteAlpha.100")(t),borderColor:zr("gray.100","transparent")(t)},_focusVisible:{boxShadow:"outline"},_invalid:{borderColor:zr("red.500","red.300")(t)}}},xre={_disabled:{cursor:"not-allowed"}},vre={userSelect:"none",_disabled:{opacity:.4}},bre={transitionProperty:"transform",transitionDuration:"normal"},_re=cS(t=>({icon:bre,container:xre,control:Ho(yre,t),label:vre})),wre={sm:cS({control:{[Mv.variable]:"sizes.3"},label:{fontSize:"sm"},icon:{fontSize:"3xs"}}),md:cS({control:{[Mv.variable]:"sizes.4"},label:{fontSize:"md"},icon:{fontSize:"2xs"}}),lg:cS({control:{[Mv.variable]:"sizes.5"},label:{fontSize:"lg"},icon:{fontSize:"2xs"}})},gd=gre({baseStyle:_re,sizes:wre,defaultProps:{size:"md",colorScheme:"blue"}}),Iv=Ss("close-button-size"),Fx=Ss("close-button-bg"),Sre={w:[Iv.reference],h:[Iv.reference],borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{[Fx.variable]:"colors.blackAlpha.100",_dark:{[Fx.variable]:"colors.whiteAlpha.100"}},_active:{[Fx.variable]:"colors.blackAlpha.200",_dark:{[Fx.variable]:"colors.whiteAlpha.200"}},_focusVisible:{boxShadow:"outline"},bg:Fx.reference},kre={lg:{[Iv.variable]:"sizes.10",fontSize:"md"},md:{[Iv.variable]:"sizes.8",fontSize:"xs"},sm:{[Iv.variable]:"sizes.6",fontSize:"2xs"}},Cre={baseStyle:Sre,sizes:kre,defaultProps:{size:"md"}},{variants:Tre,defaultProps:Ore}=zv,jre={fontFamily:"mono",fontSize:"sm",px:"0.2em",borderRadius:"sm",bg:Ui.bg.reference,color:Ui.color.reference,boxShadow:Ui.shadow.reference},Pre={baseStyle:jre,variants:Tre,defaultProps:Ore},Are={w:"100%",mx:"auto",maxW:"prose",px:"4"},Ere={baseStyle:Are},zre={opacity:.6,borderColor:"inherit"},Mre={borderStyle:"solid"},Ire={borderStyle:"dashed"},Rre={solid:Mre,dashed:Ire},Dre={baseStyle:zre,variants:Rre,defaultProps:{variant:"solid"}},{definePartsStyle:YP,defineMultiStyleConfig:Lre}=si(kee.keys),pO=Mr("drawer-bg"),mO=Mr("drawer-box-shadow");function gg(t){return YP(t==="full"?{dialog:{maxW:"100vw",h:"100vh"}}:{dialog:{maxW:t}})}const Fre={bg:"blackAlpha.600",zIndex:"modal"},Bre={display:"flex",zIndex:"modal",justifyContent:"center"},$re=t=>{const{isFullHeight:e}=t;return{...e&&{height:"100vh"},zIndex:"modal",maxH:"100vh",color:"inherit",[pO.variable]:"colors.white",[mO.variable]:"shadows.lg",_dark:{[pO.variable]:"colors.gray.700",[mO.variable]:"shadows.dark-lg"},bg:pO.reference,boxShadow:mO.reference}},Nre={px:"6",py:"4",fontSize:"xl",fontWeight:"semibold"},Vre={position:"absolute",top:"2",insetEnd:"3"},Wre={px:"6",py:"2",flex:"1",overflow:"auto"},Ure={px:"6",py:"4"},qre=YP(t=>({overlay:Fre,dialogContainer:Bre,dialog:Ho($re,t),header:Nre,closeButton:Vre,body:Wre,footer:Ure})),Qre={xs:gg("xs"),sm:gg("md"),md:gg("lg"),lg:gg("2xl"),xl:gg("4xl"),full:gg("full")},Hre=Lre({baseStyle:qre,sizes:Qre,defaultProps:{size:"xs"}}),{definePartsStyle:Gre,defineMultiStyleConfig:Xre}=si(Cee.keys),Kre={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal"},Zre={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal",width:"full",_focusVisible:{boxShadow:"outline"},_placeholder:{opacity:.6}},Yre={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal",width:"full",_focusVisible:{boxShadow:"outline"},_placeholder:{opacity:.6}},Jre=Gre({preview:Kre,input:Zre,textarea:Yre}),ene=Xre({baseStyle:Jre}),{definePartsStyle:tne,defineMultiStyleConfig:rne}=si(Tee.keys),cy=Mr("form-control-color"),nne={marginStart:"1",[cy.variable]:"colors.red.500",_dark:{[cy.variable]:"colors.red.300"},color:cy.reference},ine={mt:"2",[cy.variable]:"colors.gray.600",_dark:{[cy.variable]:"colors.whiteAlpha.600"},color:cy.reference,lineHeight:"normal",fontSize:"sm"},sne=tne({container:{width:"100%",position:"relative"},requiredIndicator:nne,helperText:ine}),one=rne({baseStyle:sne}),{definePartsStyle:ane,defineMultiStyleConfig:lne}=si(Oee.keys),uy=Mr("form-error-color"),cne={[uy.variable]:"colors.red.500",_dark:{[uy.variable]:"colors.red.300"},color:uy.reference,mt:"2",fontSize:"sm",lineHeight:"normal"},une={marginEnd:"0.5em",[uy.variable]:"colors.red.500",_dark:{[uy.variable]:"colors.red.300"},color:uy.reference},hne=ane({text:cne,icon:une}),dne=lne({baseStyle:hne}),fne={fontSize:"md",marginEnd:"3",mb:"2",fontWeight:"medium",transitionProperty:"common",transitionDuration:"normal",opacity:1,_disabled:{opacity:.4}},pne={baseStyle:fne},mne={fontFamily:"heading",fontWeight:"bold"},gne={"4xl":{fontSize:["6xl",null,"7xl"],lineHeight:1},"3xl":{fontSize:["5xl",null,"6xl"],lineHeight:1},"2xl":{fontSize:["4xl",null,"5xl"],lineHeight:[1.2,null,1]},xl:{fontSize:["3xl",null,"4xl"],lineHeight:[1.33,null,1.2]},lg:{fontSize:["2xl",null,"3xl"],lineHeight:[1.33,null,1.2]},md:{fontSize:"xl",lineHeight:1.2},sm:{fontSize:"md",lineHeight:1.2},xs:{fontSize:"sm",lineHeight:1.2}},yne={baseStyle:mne,sizes:gne,defaultProps:{size:"xl"}},{definePartsStyle:ah,defineMultiStyleConfig:xne}=si(jee.keys),Bg=Mr("input-height"),$g=Mr("input-font-size"),Ng=Mr("input-padding"),Vg=Mr("input-border-radius"),vne=ah({addon:{height:Bg.reference,fontSize:$g.reference,px:Ng.reference,borderRadius:Vg.reference},field:{width:"100%",height:Bg.reference,fontSize:$g.reference,px:Ng.reference,borderRadius:Vg.reference,minWidth:0,outline:0,position:"relative",appearance:"none",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed"}}}),ud={lg:{[$g.variable]:"fontSizes.lg",[Ng.variable]:"space.4",[Vg.variable]:"radii.md",[Bg.variable]:"sizes.12"},md:{[$g.variable]:"fontSizes.md",[Ng.variable]:"space.4",[Vg.variable]:"radii.md",[Bg.variable]:"sizes.10"},sm:{[$g.variable]:"fontSizes.sm",[Ng.variable]:"space.3",[Vg.variable]:"radii.sm",[Bg.variable]:"sizes.8"},xs:{[$g.variable]:"fontSizes.xs",[Ng.variable]:"space.2",[Vg.variable]:"radii.sm",[Bg.variable]:"sizes.6"}},bne={lg:ah({field:ud.lg,group:ud.lg}),md:ah({field:ud.md,group:ud.md}),sm:ah({field:ud.sm,group:ud.sm}),xs:ah({field:ud.xs,group:ud.xs})};function r5(t){const{focusBorderColor:e,errorBorderColor:r}=t;return{focusBorderColor:e||zr("blue.500","blue.300")(t),errorBorderColor:r||zr("red.500","red.300")(t)}}const _ne=ah(t=>{const{theme:e}=t,{focusBorderColor:r,errorBorderColor:n}=r5(t);return{field:{border:"1px solid",borderColor:"inherit",bg:"inherit",_hover:{borderColor:zr("gray.300","whiteAlpha.400")(t)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:qo(e,n),boxShadow:`0 0 0 1px ${qo(e,n)}`},_focusVisible:{zIndex:1,borderColor:qo(e,r),boxShadow:`0 0 0 1px ${qo(e,r)}`}},addon:{border:"1px solid",borderColor:zr("inherit","whiteAlpha.50")(t),bg:zr("gray.100","whiteAlpha.300")(t)}}}),wne=ah(t=>{const{theme:e}=t,{focusBorderColor:r,errorBorderColor:n}=r5(t);return{field:{border:"2px solid",borderColor:"transparent",bg:zr("gray.100","whiteAlpha.50")(t),_hover:{bg:zr("gray.200","whiteAlpha.100")(t)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:qo(e,n)},_focusVisible:{bg:"transparent",borderColor:qo(e,r)}},addon:{border:"2px solid",borderColor:"transparent",bg:zr("gray.100","whiteAlpha.50")(t)}}}),Sne=ah(t=>{const{theme:e}=t,{focusBorderColor:r,errorBorderColor:n}=r5(t);return{field:{borderBottom:"1px solid",borderColor:"inherit",borderRadius:"0",px:"0",bg:"transparent",_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:qo(e,n),boxShadow:`0px 1px 0px 0px ${qo(e,n)}`},_focusVisible:{borderColor:qo(e,r),boxShadow:`0px 1px 0px 0px ${qo(e,r)}`}},addon:{borderBottom:"2px solid",borderColor:"inherit",borderRadius:"0",px:"0",bg:"transparent"}}}),kne=ah({field:{bg:"transparent",px:"0",height:"auto"},addon:{bg:"transparent",px:"0",height:"auto"}}),Cne={outline:_ne,filled:wne,flushed:Sne,unstyled:kne},Mn=xne({baseStyle:vne,sizes:bne,variants:Cne,defaultProps:{size:"md",variant:"outline"}}),gO=Mr("kbd-bg"),Tne={[gO.variable]:"colors.gray.100",_dark:{[gO.variable]:"colors.whiteAlpha.100"},bg:gO.reference,borderRadius:"md",borderWidth:"1px",borderBottomWidth:"3px",fontSize:"0.8em",fontWeight:"bold",lineHeight:"normal",px:"0.4em",whiteSpace:"nowrap"},One={baseStyle:Tne},jne={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focusVisible:{boxShadow:"outline"}},Pne={baseStyle:jne},{defineMultiStyleConfig:Ane,definePartsStyle:Ene}=si(Pee.keys),zne={marginEnd:"2",display:"inline",verticalAlign:"text-bottom"},Mne=Ene({icon:zne}),Ine=Ane({baseStyle:Mne}),{defineMultiStyleConfig:Rne,definePartsStyle:Dne}=si(Aee.keys),Xc=Mr("menu-bg"),yO=Mr("menu-shadow"),Lne={[Xc.variable]:"#fff",[yO.variable]:"shadows.sm",_dark:{[Xc.variable]:"colors.gray.700",[yO.variable]:"shadows.dark-lg"},color:"inherit",minW:"3xs",py:"2",zIndex:"dropdown",borderRadius:"md",borderWidth:"1px",bg:Xc.reference,boxShadow:yO.reference},Fne={py:"1.5",px:"3",transitionProperty:"background",transitionDuration:"ultra-fast",transitionTimingFunction:"ease-in",_focus:{[Xc.variable]:"colors.gray.100",_dark:{[Xc.variable]:"colors.whiteAlpha.100"}},_active:{[Xc.variable]:"colors.gray.200",_dark:{[Xc.variable]:"colors.whiteAlpha.200"}},_expanded:{[Xc.variable]:"colors.gray.100",_dark:{[Xc.variable]:"colors.whiteAlpha.100"}},_disabled:{opacity:.4,cursor:"not-allowed"},bg:Xc.reference},Bne={mx:4,my:2,fontWeight:"semibold",fontSize:"sm"},$ne={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0},Nne={opacity:.6},Vne={border:0,borderBottom:"1px solid",borderColor:"inherit",my:"2",opacity:.6},Wne={transitionProperty:"common",transitionDuration:"normal"},Une=Dne({button:Wne,list:Lne,item:Fne,groupTitle:Bne,icon:$ne,command:Nne,divider:Vne}),qne=Rne({baseStyle:Une}),{defineMultiStyleConfig:Qne,definePartsStyle:JP}=si(Eee.keys),xO=Mr("modal-bg"),vO=Mr("modal-shadow"),Hne={bg:"blackAlpha.600",zIndex:"modal"},Gne=t=>{const{isCentered:e,scrollBehavior:r}=t;return{display:"flex",zIndex:"modal",justifyContent:"center",alignItems:e?"center":"flex-start",overflow:r==="inside"?"hidden":"auto",overscrollBehaviorY:"none"}},Xne=t=>{const{isCentered:e,scrollBehavior:r}=t;return{borderRadius:"md",color:"inherit",my:e?"auto":"16",mx:e?"auto":void 0,zIndex:"modal",maxH:r==="inside"?"calc(100% - 7.5rem)":void 0,[xO.variable]:"colors.white",[vO.variable]:"shadows.lg",_dark:{[xO.variable]:"colors.gray.700",[vO.variable]:"shadows.dark-lg"},bg:xO.reference,boxShadow:vO.reference}},Kne={px:"6",py:"4",fontSize:"xl",fontWeight:"semibold"},Zne={position:"absolute",top:"2",insetEnd:"3"},Yne=t=>{const{scrollBehavior:e}=t;return{px:"6",py:"2",flex:"1",overflow:e==="inside"?"auto":void 0}},Jne={px:"6",py:"4"},eie=JP(t=>({overlay:Hne,dialogContainer:Ho(Gne,t),dialog:Ho(Xne,t),header:Kne,closeButton:Zne,body:Ho(Yne,t),footer:Jne}));function sc(t){return JP(t==="full"?{dialog:{maxW:"100vw",minH:"$100vh",my:"0",borderRadius:"0"}}:{dialog:{maxW:t}})}const tie={xs:sc("xs"),sm:sc("sm"),md:sc("md"),lg:sc("lg"),xl:sc("xl"),"2xl":sc("2xl"),"3xl":sc("3xl"),"4xl":sc("4xl"),"5xl":sc("5xl"),"6xl":sc("6xl"),full:sc("full")},rie=Qne({baseStyle:eie,sizes:tie,defaultProps:{size:"md"}}),aV={letterSpacings:{tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeights:{normal:"normal",none:1,shorter:1.25,short:1.375,base:1.5,tall:1.625,taller:"2",3:".75rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem"},fontWeights:{hairline:100,thin:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},fonts:{heading:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',body:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',mono:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'},fontSizes:{"3xs":"0.45rem","2xs":"0.625rem",xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2.25rem","5xl":"3rem","6xl":"3.75rem","7xl":"4.5rem","8xl":"6rem","9xl":"8rem"}},{defineMultiStyleConfig:nie,definePartsStyle:lV}=si(zee.keys),n5=Ss("number-input-stepper-width"),cV=Ss("number-input-input-padding"),iie=th(n5).add("0.5rem").toString(),bO=Ss("number-input-bg"),_O=Ss("number-input-color"),wO=Ss("number-input-border-color"),sie={[n5.variable]:"sizes.6",[cV.variable]:iie},oie=t=>{var e;return((e=Ho(Mn.baseStyle,t))==null?void 0:e.field)??{}},aie={width:n5.reference},lie={borderStart:"1px solid",borderStartColor:wO.reference,color:_O.reference,bg:bO.reference,[_O.variable]:"colors.chakra-body-text",[wO.variable]:"colors.chakra-border-color",_dark:{[_O.variable]:"colors.whiteAlpha.800",[wO.variable]:"colors.whiteAlpha.300"},_active:{[bO.variable]:"colors.gray.200",_dark:{[bO.variable]:"colors.whiteAlpha.300"}},_disabled:{opacity:.4,cursor:"not-allowed"}},cie=lV(t=>({root:sie,field:Ho(oie,t)??{},stepperGroup:aie,stepper:lie}));function sw(t){var s,a;const e=(s=Mn.sizes)==null?void 0:s[t],r={lg:"md",md:"md",sm:"sm",xs:"sm"},n=((a=e.field)==null?void 0:a.fontSize)??"md",i=aV.fontSizes[n];return lV({field:{...e.field,paddingInlineEnd:cV.reference,verticalAlign:"top"},stepper:{fontSize:th(i).multiply(.75).toString(),_first:{borderTopEndRadius:r[t]},_last:{borderBottomEndRadius:r[t],mt:"-1px",borderTopWidth:1}}})}const uie={xs:sw("xs"),sm:sw("sm"),md:sw("md"),lg:sw("lg")},hie=nie({baseStyle:cie,sizes:uie,variants:Mn.variants,defaultProps:Mn.defaultProps});var N6;const die={...(N6=Mn.baseStyle)==null?void 0:N6.field,textAlign:"center"},fie={lg:{fontSize:"lg",w:12,h:12,borderRadius:"md"},md:{fontSize:"md",w:10,h:10,borderRadius:"md"},sm:{fontSize:"sm",w:8,h:8,borderRadius:"sm"},xs:{fontSize:"xs",w:6,h:6,borderRadius:"sm"}};var V6;const pie={outline:t=>{var e,r;return((r=Ho((e=Mn.variants)==null?void 0:e.outline,t))==null?void 0:r.field)??{}},flushed:t=>{var e,r;return((r=Ho((e=Mn.variants)==null?void 0:e.flushed,t))==null?void 0:r.field)??{}},filled:t=>{var e,r;return((r=Ho((e=Mn.variants)==null?void 0:e.filled,t))==null?void 0:r.field)??{}},unstyled:((V6=Mn.variants)==null?void 0:V6.unstyled.field)??{}},mie={baseStyle:die,sizes:fie,variants:pie,defaultProps:Mn.defaultProps},{defineMultiStyleConfig:gie,definePartsStyle:yie}=si(Mee.keys),ow=Ss("popper-bg"),xie=Ss("popper-arrow-bg"),$3=Ss("popper-arrow-shadow-color"),vie={zIndex:"popover"},bie={[ow.variable]:"colors.white",bg:ow.reference,[xie.variable]:ow.reference,[$3.variable]:"colors.gray.200",_dark:{[ow.variable]:"colors.gray.700",[$3.variable]:"colors.whiteAlpha.300"},width:"xs",border:"1px solid",borderColor:"inherit",borderRadius:"md",boxShadow:"sm",zIndex:"inherit",_focusVisible:{outline:0,boxShadow:"outline"}},_ie={px:3,py:2,borderBottomWidth:"1px"},wie={px:3,py:2},Sie={px:3,py:2,borderTopWidth:"1px"},kie={position:"absolute",borderRadius:"md",top:1,insetEnd:2,padding:2},Cie=yie({popper:vie,content:bie,header:_ie,body:wie,footer:Sie,closeButton:kie}),Tie=gie({baseStyle:Cie}),{defineMultiStyleConfig:Oie,definePartsStyle:ov}=si(Iee.keys),jie=t=>{const{colorScheme:e,theme:r,isIndeterminate:n,hasStripe:i}=t,s=zr(R3(),R3("1rem","rgba(0,0,0,0.1)"))(t),a=zr(`${e}.500`,`${e}.200`)(t),o=`linear-gradient(
    to right,
    transparent 0%,
    ${qo(r,a)} 50%,
    transparent 100%
  )`;return{...!n&&i&&s,...n?{bgImage:o}:{bgColor:a}}},Pie={lineHeight:"1",fontSize:"0.25em",fontWeight:"bold",color:"white"},Aie=t=>({bg:zr("gray.100","whiteAlpha.300")(t)}),Eie=t=>({transitionProperty:"common",transitionDuration:"slow",...jie(t)}),zie=ov(t=>({label:Pie,filledTrack:Eie(t),track:Aie(t)})),Mie={xs:ov({track:{h:"1"}}),sm:ov({track:{h:"2"}}),md:ov({track:{h:"3"}}),lg:ov({track:{h:"4"}})},Iie=Oie({sizes:Mie,baseStyle:zie,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:Rie,definePartsStyle:uS}=si(Ree.keys),Die=t=>{var r;const e=(r=Ho(gd.baseStyle,t))==null?void 0:r.control;return{...e,borderRadius:"full",_checked:{...e==null?void 0:e._checked,_before:{content:'""',display:"inline-block",pos:"relative",w:"50%",h:"50%",borderRadius:"50%",bg:"currentColor"}}}},Lie=uS(t=>{var e,r;return{label:(e=gd.baseStyle)==null?void 0:e.call(gd,t).label,container:(r=gd.baseStyle)==null?void 0:r.call(gd,t).container,control:Die(t)}}),Fie={md:uS({control:{w:"4",h:"4"},label:{fontSize:"md"}}),lg:uS({control:{w:"5",h:"5"},label:{fontSize:"lg"}}),sm:uS({control:{width:"3",height:"3"},label:{fontSize:"sm"}})},Bie=Rie({baseStyle:Lie,sizes:Fie,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:$ie,definePartsStyle:Nie}=si(Dee.keys),aw=Mr("select-bg");var W6;const Vie={...(W6=Mn.baseStyle)==null?void 0:W6.field,appearance:"none",paddingBottom:"1px",lineHeight:"normal",bg:aw.reference,[aw.variable]:"colors.white",_dark:{[aw.variable]:"colors.gray.700"},"> option, > optgroup":{bg:aw.reference}},Wie={width:"6",height:"100%",insetEnd:"2",position:"relative",color:"currentColor",fontSize:"xl",_disabled:{opacity:.5}},Uie=Nie({field:Vie,icon:Wie}),lw={paddingInlineEnd:"8"};var U6,q6,Q6,H6,G6,X6,K6,Z6;const qie={lg:{...(U6=Mn.sizes)==null?void 0:U6.lg,field:{...(q6=Mn.sizes)==null?void 0:q6.lg.field,...lw}},md:{...(Q6=Mn.sizes)==null?void 0:Q6.md,field:{...(H6=Mn.sizes)==null?void 0:H6.md.field,...lw}},sm:{...(G6=Mn.sizes)==null?void 0:G6.sm,field:{...(X6=Mn.sizes)==null?void 0:X6.sm.field,...lw}},xs:{...(K6=Mn.sizes)==null?void 0:K6.xs,field:{...(Z6=Mn.sizes)==null?void 0:Z6.xs.field,...lw},icon:{insetEnd:"1"}}},Qie=$ie({baseStyle:Uie,sizes:qie,variants:Mn.variants,defaultProps:Mn.defaultProps}),SO=Mr("skeleton-start-color"),kO=Mr("skeleton-end-color"),Hie={[SO.variable]:"colors.gray.100",[kO.variable]:"colors.gray.400",_dark:{[SO.variable]:"colors.gray.800",[kO.variable]:"colors.gray.600"},background:SO.reference,borderColor:kO.reference,opacity:.7,borderRadius:"sm"},Gie={baseStyle:Hie},CO=Mr("skip-link-bg"),Xie={borderRadius:"md",fontWeight:"semibold",_focusVisible:{boxShadow:"outline",padding:"4",position:"fixed",top:"6",insetStart:"6",[CO.variable]:"colors.white",_dark:{[CO.variable]:"colors.gray.700"},bg:CO.reference}},Kie={baseStyle:Xie},{defineMultiStyleConfig:Zie,definePartsStyle:Ok}=si(Lee.keys),nm=Mr("slider-thumb-size"),yb=Mr("slider-track-size"),wd=Mr("slider-bg"),Yie=t=>{const{orientation:e}=t;return{display:"inline-block",position:"relative",cursor:"pointer",_disabled:{opacity:.6,cursor:"default",pointerEvents:"none"},...e5({orientation:e,vertical:{h:"100%",px:eh(nm.reference).divide(2).toString()},horizontal:{w:"100%",py:eh(nm.reference).divide(2).toString()}})}},Jie=t=>({...e5({orientation:t.orientation,horizontal:{h:yb.reference},vertical:{w:yb.reference}}),overflow:"hidden",borderRadius:"sm",[wd.variable]:"colors.gray.200",_dark:{[wd.variable]:"colors.whiteAlpha.200"},_disabled:{[wd.variable]:"colors.gray.300",_dark:{[wd.variable]:"colors.whiteAlpha.300"}},bg:wd.reference}),ese=t=>{const{orientation:e}=t;return{...e5({orientation:e,vertical:{left:"50%"},horizontal:{top:"50%"}}),w:nm.reference,h:nm.reference,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",outline:0,zIndex:1,borderRadius:"full",bg:"white",boxShadow:"base",border:"1px solid",borderColor:"transparent",transitionProperty:"transform",transitionDuration:"normal",_focusVisible:{boxShadow:"outline"},_active:{"--slider-thumb-scale":"1.15"},_disabled:{bg:"gray.300"}}},tse=t=>{const{colorScheme:e}=t;return{width:"inherit",height:"inherit",[wd.variable]:`colors.${e}.500`,_dark:{[wd.variable]:`colors.${e}.200`},bg:wd.reference}},rse=Ok(t=>({container:Yie(t),track:Jie(t),thumb:ese(t),filledTrack:tse(t)})),nse=Ok({container:{[nm.variable]:"sizes.4",[yb.variable]:"sizes.1"}}),ise=Ok({container:{[nm.variable]:"sizes.3.5",[yb.variable]:"sizes.1"}}),sse=Ok({container:{[nm.variable]:"sizes.2.5",[yb.variable]:"sizes.0.5"}}),ose={lg:nse,md:ise,sm:sse},ase=Zie({baseStyle:rse,sizes:ose,defaultProps:{size:"md",colorScheme:"blue"}}),dp=Ss("spinner-size"),lse={width:[dp.reference],height:[dp.reference]},cse={xs:{[dp.variable]:"sizes.3"},sm:{[dp.variable]:"sizes.4"},md:{[dp.variable]:"sizes.6"},lg:{[dp.variable]:"sizes.8"},xl:{[dp.variable]:"sizes.12"}},use={baseStyle:lse,sizes:cse,defaultProps:{size:"md"}},{defineMultiStyleConfig:hse,definePartsStyle:uV}=si(Fee.keys),dse={fontWeight:"medium"},fse={opacity:.8,marginBottom:"2"},pse={verticalAlign:"baseline",fontWeight:"semibold"},mse={marginEnd:1,w:"3.5",h:"3.5",verticalAlign:"middle"},gse=uV({container:{},label:dse,helpText:fse,number:pse,icon:mse}),yse={md:uV({label:{fontSize:"sm"},helpText:{fontSize:"sm"},number:{fontSize:"2xl"}})},xse=hse({baseStyle:gse,sizes:yse,defaultProps:{size:"md"}}),{defineMultiStyleConfig:vse,definePartsStyle:av}=si(["stepper","step","title","description","indicator","separator","icon","number"]),rh=Mr("stepper-indicator-size"),Wg=Mr("stepper-icon-size"),Ug=Mr("stepper-title-font-size"),lv=Mr("stepper-description-font-size"),Bx=Mr("stepper-accent-color"),bse=av(({colorScheme:t})=>({stepper:{display:"flex",justifyContent:"space-between",gap:"4","&[data-orientation=vertical]":{flexDirection:"column",alignItems:"flex-start"},"&[data-orientation=horizontal]":{flexDirection:"row",alignItems:"center"},[Bx.variable]:`colors.${t}.500`,_dark:{[Bx.variable]:`colors.${t}.200`}},title:{fontSize:Ug.reference,fontWeight:"medium"},description:{fontSize:lv.reference,color:"chakra-subtle-text"},number:{fontSize:Ug.reference},step:{flexShrink:0,position:"relative",display:"flex",gap:"2","&[data-orientation=horizontal]":{alignItems:"center"},flex:"1","&:last-of-type:not([data-stretch])":{flex:"initial"}},icon:{flexShrink:0,width:Wg.reference,height:Wg.reference},indicator:{flexShrink:0,borderRadius:"full",width:rh.reference,height:rh.reference,display:"flex",justifyContent:"center",alignItems:"center","&[data-status=active]":{borderWidth:"2px",borderColor:Bx.reference},"&[data-status=complete]":{bg:Bx.reference,color:"chakra-inverse-text"},"&[data-status=incomplete]":{borderWidth:"2px"}},separator:{bg:"chakra-border-color",flex:"1","&[data-status=complete]":{bg:Bx.reference},"&[data-orientation=horizontal]":{width:"100%",height:"2px",marginStart:"2"},"&[data-orientation=vertical]":{width:"2px",position:"absolute",height:"100%",maxHeight:`calc(100% - ${rh.reference} - 8px)`,top:`calc(${rh.reference} + 4px)`,insetStart:`calc(${rh.reference} / 2 - 1px)`}}})),_se=vse({baseStyle:bse,sizes:{xs:av({stepper:{[rh.variable]:"sizes.4",[Wg.variable]:"sizes.3",[Ug.variable]:"fontSizes.xs",[lv.variable]:"fontSizes.xs"}}),sm:av({stepper:{[rh.variable]:"sizes.6",[Wg.variable]:"sizes.4",[Ug.variable]:"fontSizes.sm",[lv.variable]:"fontSizes.xs"}}),md:av({stepper:{[rh.variable]:"sizes.8",[Wg.variable]:"sizes.5",[Ug.variable]:"fontSizes.md",[lv.variable]:"fontSizes.sm"}}),lg:av({stepper:{[rh.variable]:"sizes.10",[Wg.variable]:"sizes.6",[Ug.variable]:"fontSizes.lg",[lv.variable]:"fontSizes.md"}})},defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:wse,definePartsStyle:hS}=si(Bee.keys),Rv=Ss("switch-track-width"),Lp=Ss("switch-track-height"),TO=Ss("switch-track-diff"),Sse=th.subtract(Rv,Lp),eA=Ss("switch-thumb-x"),$x=Ss("switch-bg"),kse=t=>{const{colorScheme:e}=t;return{borderRadius:"full",p:"0.5",width:[Rv.reference],height:[Lp.reference],transitionProperty:"common",transitionDuration:"fast",[$x.variable]:"colors.gray.300",_dark:{[$x.variable]:"colors.whiteAlpha.400"},_focusVisible:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed"},_checked:{[$x.variable]:`colors.${e}.500`,_dark:{[$x.variable]:`colors.${e}.200`}},bg:$x.reference}},Cse={bg:"white",transitionProperty:"transform",transitionDuration:"normal",borderRadius:"inherit",width:[Lp.reference],height:[Lp.reference],_checked:{transform:`translateX(${eA.reference})`}},Tse=hS(t=>({container:{[TO.variable]:Sse,[eA.variable]:TO.reference,_rtl:{[eA.variable]:th(TO).negate().toString()}},track:kse(t),thumb:Cse})),Ose={sm:hS({container:{[Rv.variable]:"1.375rem",[Lp.variable]:"sizes.3"}}),md:hS({container:{[Rv.variable]:"1.875rem",[Lp.variable]:"sizes.4"}}),lg:hS({container:{[Rv.variable]:"2.875rem",[Lp.variable]:"sizes.6"}})},jse=wse({baseStyle:Tse,sizes:Ose,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:Pse,definePartsStyle:hy}=si($ee.keys),Ase=hy({table:{fontVariantNumeric:"lining-nums tabular-nums",borderCollapse:"collapse",width:"full"},th:{fontFamily:"heading",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"wider",textAlign:"start"},td:{textAlign:"start"},caption:{mt:4,fontFamily:"heading",textAlign:"center",fontWeight:"medium"}}),f2={"&[data-is-numeric=true]":{textAlign:"end"}},Ese=hy(t=>{const{colorScheme:e}=t;return{th:{color:zr("gray.600","gray.400")(t),borderBottom:"1px",borderColor:zr(`${e}.100`,`${e}.700`)(t),...f2},td:{borderBottom:"1px",borderColor:zr(`${e}.100`,`${e}.700`)(t),...f2},caption:{color:zr("gray.600","gray.100")(t)},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}}),zse=hy(t=>{const{colorScheme:e}=t;return{th:{color:zr("gray.600","gray.400")(t),borderBottom:"1px",borderColor:zr(`${e}.100`,`${e}.700`)(t),...f2},td:{borderBottom:"1px",borderColor:zr(`${e}.100`,`${e}.700`)(t),...f2},caption:{color:zr("gray.600","gray.100")(t)},tbody:{tr:{"&:nth-of-type(odd)":{"th, td":{borderBottomWidth:"1px",borderColor:zr(`${e}.100`,`${e}.700`)(t)},td:{background:zr(`${e}.100`,`${e}.700`)(t)}}}},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}}),Mse={simple:Ese,striped:zse,unstyled:{}},Ise={sm:hy({th:{px:"4",py:"1",lineHeight:"4",fontSize:"xs"},td:{px:"4",py:"2",fontSize:"sm",lineHeight:"4"},caption:{px:"4",py:"2",fontSize:"xs"}}),md:hy({th:{px:"6",py:"3",lineHeight:"4",fontSize:"xs"},td:{px:"6",py:"4",lineHeight:"5"},caption:{px:"6",py:"2",fontSize:"sm"}}),lg:hy({th:{px:"8",py:"4",lineHeight:"5",fontSize:"sm"},td:{px:"8",py:"5",lineHeight:"6"},caption:{px:"6",py:"2",fontSize:"md"}})},Rse=Pse({baseStyle:Ase,variants:Mse,sizes:Ise,defaultProps:{variant:"simple",size:"md",colorScheme:"gray"}}),ya=Mr("tabs-color"),hc=Mr("tabs-bg"),cw=Mr("tabs-border-color"),{defineMultiStyleConfig:Dse,definePartsStyle:mu}=si(Nee.keys),Lse=t=>{const{orientation:e}=t;return{display:e==="vertical"?"flex":"block"}},Fse=t=>{const{isFitted:e}=t;return{flex:e?1:void 0,transitionProperty:"common",transitionDuration:"normal",_focusVisible:{zIndex:1,boxShadow:"outline"},_disabled:{cursor:"not-allowed",opacity:.4}}},Bse=t=>{const{align:e="start",orientation:r}=t;return{justifyContent:{end:"flex-end",center:"center",start:"flex-start"}[e],flexDirection:r==="vertical"?"column":"row"}},$se={p:4},Nse=mu(t=>({root:Lse(t),tab:Fse(t),tablist:Bse(t),tabpanel:$se})),Vse={sm:mu({tab:{py:1,px:4,fontSize:"sm"}}),md:mu({tab:{fontSize:"md",py:2,px:4}}),lg:mu({tab:{fontSize:"lg",py:3,px:4}})},Wse=mu(t=>{const{colorScheme:e,orientation:r}=t,n=r==="vertical",i=n?"borderStart":"borderBottom",s=n?"marginStart":"marginBottom";return{tablist:{[i]:"2px solid",borderColor:"inherit"},tab:{[i]:"2px solid",borderColor:"transparent",[s]:"-2px",_selected:{[ya.variable]:`colors.${e}.600`,_dark:{[ya.variable]:`colors.${e}.300`},borderColor:"currentColor"},_active:{[hc.variable]:"colors.gray.200",_dark:{[hc.variable]:"colors.whiteAlpha.300"}},_disabled:{_active:{bg:"none"}},color:ya.reference,bg:hc.reference}}}),Use=mu(t=>{const{colorScheme:e}=t;return{tab:{borderTopRadius:"md",border:"1px solid",borderColor:"transparent",mb:"-1px",[cw.variable]:"transparent",_selected:{[ya.variable]:`colors.${e}.600`,[cw.variable]:"colors.white",_dark:{[ya.variable]:`colors.${e}.300`,[cw.variable]:"colors.gray.800"},borderColor:"inherit",borderBottomColor:cw.reference},color:ya.reference},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}),qse=mu(t=>{const{colorScheme:e}=t;return{tab:{border:"1px solid",borderColor:"inherit",[hc.variable]:"colors.gray.50",_dark:{[hc.variable]:"colors.whiteAlpha.50"},mb:"-1px",_notLast:{marginEnd:"-1px"},_selected:{[hc.variable]:"colors.white",[ya.variable]:`colors.${e}.600`,_dark:{[hc.variable]:"colors.gray.800",[ya.variable]:`colors.${e}.300`},borderColor:"inherit",borderTopColor:"currentColor",borderBottomColor:"transparent"},color:ya.reference,bg:hc.reference},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}),Qse=mu(t=>{const{colorScheme:e,theme:r}=t;return{tab:{borderRadius:"full",fontWeight:"semibold",color:"gray.600",_selected:{color:qo(r,`${e}.700`),bg:qo(r,`${e}.100`)}}}}),Hse=mu(t=>{const{colorScheme:e}=t;return{tab:{borderRadius:"full",fontWeight:"semibold",[ya.variable]:"colors.gray.600",_dark:{[ya.variable]:"inherit"},_selected:{[ya.variable]:"colors.white",[hc.variable]:`colors.${e}.600`,_dark:{[ya.variable]:"colors.gray.800",[hc.variable]:`colors.${e}.300`}},color:ya.reference,bg:hc.reference}}}),Gse=mu({}),Xse={line:Wse,enclosed:Use,"enclosed-colored":qse,"soft-rounded":Qse,"solid-rounded":Hse,unstyled:Gse},Kse=Dse({baseStyle:Nse,sizes:Vse,variants:Xse,defaultProps:{size:"md",variant:"line",colorScheme:"blue"}}),{defineMultiStyleConfig:Zse,definePartsStyle:Fp}=si(Vee.keys),N3=Mr("tag-bg"),V3=Mr("tag-color"),OO=Mr("tag-shadow"),dS=Mr("tag-min-height"),fS=Mr("tag-min-width"),pS=Mr("tag-font-size"),mS=Mr("tag-padding-inline"),Yse={fontWeight:"medium",lineHeight:1.2,outline:0,[V3.variable]:Ui.color.reference,[N3.variable]:Ui.bg.reference,[OO.variable]:Ui.shadow.reference,color:V3.reference,bg:N3.reference,boxShadow:OO.reference,borderRadius:"md",minH:dS.reference,minW:fS.reference,fontSize:pS.reference,px:mS.reference,_focusVisible:{[OO.variable]:"shadows.outline"}},Jse={lineHeight:1.2,overflow:"visible"},eoe={fontSize:"lg",w:"5",h:"5",transitionProperty:"common",transitionDuration:"normal",borderRadius:"full",marginStart:"1.5",marginEnd:"-1",opacity:.5,_disabled:{opacity:.4},_focusVisible:{boxShadow:"outline",bg:"rgba(0, 0, 0, 0.14)"},_hover:{opacity:.8},_active:{opacity:1}},toe=Fp({container:Yse,label:Jse,closeButton:eoe}),roe={sm:Fp({container:{[dS.variable]:"sizes.5",[fS.variable]:"sizes.5",[pS.variable]:"fontSizes.xs",[mS.variable]:"space.2"},closeButton:{marginEnd:"-2px",marginStart:"0.35rem"}}),md:Fp({container:{[dS.variable]:"sizes.6",[fS.variable]:"sizes.6",[pS.variable]:"fontSizes.sm",[mS.variable]:"space.2"}}),lg:Fp({container:{[dS.variable]:"sizes.8",[fS.variable]:"sizes.8",[pS.variable]:"fontSizes.md",[mS.variable]:"space.3"}})},noe={subtle:Fp(t=>{var e;return{container:(e=zv.variants)==null?void 0:e.subtle(t)}}),solid:Fp(t=>{var e;return{container:(e=zv.variants)==null?void 0:e.solid(t)}}),outline:Fp(t=>{var e;return{container:(e=zv.variants)==null?void 0:e.outline(t)}})},ioe=Zse({variants:noe,baseStyle:toe,sizes:roe,defaultProps:{size:"md",variant:"subtle",colorScheme:"gray"}});var Y6;const soe={...(Y6=Mn.baseStyle)==null?void 0:Y6.field,paddingY:"2",minHeight:"20",lineHeight:"short",verticalAlign:"top"};var J6;const ooe={outline:t=>{var e;return((e=Mn.variants)==null?void 0:e.outline(t).field)??{}},flushed:t=>{var e;return((e=Mn.variants)==null?void 0:e.flushed(t).field)??{}},filled:t=>{var e;return((e=Mn.variants)==null?void 0:e.filled(t).field)??{}},unstyled:((J6=Mn.variants)==null?void 0:J6.unstyled.field)??{}};var e$,t$,r$,n$;const aoe={xs:((e$=Mn.sizes)==null?void 0:e$.xs.field)??{},sm:((t$=Mn.sizes)==null?void 0:t$.sm.field)??{},md:((r$=Mn.sizes)==null?void 0:r$.md.field)??{},lg:((n$=Mn.sizes)==null?void 0:n$.lg.field)??{}},loe={baseStyle:soe,sizes:aoe,variants:ooe,defaultProps:{size:"md",variant:"outline"}},uw=Ss("tooltip-bg"),jO=Ss("tooltip-fg"),coe=Ss("popper-arrow-bg"),uoe={bg:uw.reference,color:jO.reference,[uw.variable]:"colors.gray.700",[jO.variable]:"colors.whiteAlpha.900",_dark:{[uw.variable]:"colors.gray.300",[jO.variable]:"colors.gray.900"},[coe.variable]:uw.reference,px:"2",py:"0.5",borderRadius:"sm",fontWeight:"medium",fontSize:"sm",boxShadow:"md",maxW:"xs",zIndex:"tooltip"},hoe={baseStyle:uoe},doe={Accordion:Zee,Alert:Ite,Avatar:qte,Badge:zv,Breadcrumb:tre,Button:ure,Checkbox:gd,CloseButton:Cre,Code:Pre,Container:Ere,Divider:Dre,Drawer:Hre,Editable:ene,Form:one,FormError:dne,FormLabel:pne,Heading:yne,Input:Mn,Kbd:One,Link:Pne,List:Ine,Menu:qne,Modal:rie,NumberInput:hie,PinInput:mie,Popover:Tie,Progress:Iie,Radio:Bie,Select:Qie,Skeleton:Gie,SkipLink:Kie,Slider:ase,Spinner:use,Stat:xse,Switch:jse,Table:Rse,Tabs:Kse,Tag:ioe,Textarea:loe,Tooltip:hoe,Card:mre,Stepper:_se},foe={none:0,"1px":"1px solid","2px":"2px solid","4px":"4px solid","8px":"8px solid"},poe={base:"0em",sm:"30em",md:"48em",lg:"62em",xl:"80em","2xl":"96em"},moe={transparent:"transparent",current:"currentColor",black:"#000000",white:"#FFFFFF",whiteAlpha:{50:"rgba(255, 255, 255, 0.04)",100:"rgba(255, 255, 255, 0.06)",200:"rgba(255, 255, 255, 0.08)",300:"rgba(255, 255, 255, 0.16)",400:"rgba(255, 255, 255, 0.24)",500:"rgba(255, 255, 255, 0.36)",600:"rgba(255, 255, 255, 0.48)",700:"rgba(255, 255, 255, 0.64)",800:"rgba(255, 255, 255, 0.80)",900:"rgba(255, 255, 255, 0.92)"},blackAlpha:{50:"rgba(0, 0, 0, 0.04)",100:"rgba(0, 0, 0, 0.06)",200:"rgba(0, 0, 0, 0.08)",300:"rgba(0, 0, 0, 0.16)",400:"rgba(0, 0, 0, 0.24)",500:"rgba(0, 0, 0, 0.36)",600:"rgba(0, 0, 0, 0.48)",700:"rgba(0, 0, 0, 0.64)",800:"rgba(0, 0, 0, 0.80)",900:"rgba(0, 0, 0, 0.92)"},gray:{50:"#F7FAFC",100:"#EDF2F7",200:"#E2E8F0",300:"#CBD5E0",400:"#A0AEC0",500:"#718096",600:"#4A5568",700:"#2D3748",800:"#1A202C",900:"#171923"},red:{50:"#FFF5F5",100:"#FED7D7",200:"#FEB2B2",300:"#FC8181",400:"#F56565",500:"#E53E3E",600:"#C53030",700:"#9B2C2C",800:"#822727",900:"#63171B"},orange:{50:"#FFFAF0",100:"#FEEBC8",200:"#FBD38D",300:"#F6AD55",400:"#ED8936",500:"#DD6B20",600:"#C05621",700:"#9C4221",800:"#7B341E",900:"#652B19"},yellow:{50:"#FFFFF0",100:"#FEFCBF",200:"#FAF089",300:"#F6E05E",400:"#ECC94B",500:"#D69E2E",600:"#B7791F",700:"#975A16",800:"#744210",900:"#5F370E"},green:{50:"#F0FFF4",100:"#C6F6D5",200:"#9AE6B4",300:"#68D391",400:"#48BB78",500:"#38A169",600:"#2F855A",700:"#276749",800:"#22543D",900:"#1C4532"},teal:{50:"#E6FFFA",100:"#B2F5EA",200:"#81E6D9",300:"#4FD1C5",400:"#38B2AC",500:"#319795",600:"#2C7A7B",700:"#285E61",800:"#234E52",900:"#1D4044"},blue:{50:"#ebf8ff",100:"#bee3f8",200:"#90cdf4",300:"#63b3ed",400:"#4299e1",500:"#3182ce",600:"#2b6cb0",700:"#2c5282",800:"#2a4365",900:"#1A365D"},cyan:{50:"#EDFDFD",100:"#C4F1F9",200:"#9DECF9",300:"#76E4F7",400:"#0BC5EA",500:"#00B5D8",600:"#00A3C4",700:"#0987A0",800:"#086F83",900:"#065666"},purple:{50:"#FAF5FF",100:"#E9D8FD",200:"#D6BCFA",300:"#B794F4",400:"#9F7AEA",500:"#805AD5",600:"#6B46C1",700:"#553C9A",800:"#44337A",900:"#322659"},pink:{50:"#FFF5F7",100:"#FED7E2",200:"#FBB6CE",300:"#F687B3",400:"#ED64A6",500:"#D53F8C",600:"#B83280",700:"#97266D",800:"#702459",900:"#521B41"}},goe={none:"0",sm:"0.125rem",base:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},yoe={xs:"0 0 0 1px rgba(0, 0, 0, 0.05)",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)",outline:"0 0 0 3px rgba(66, 153, 225, 0.6)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.06)",none:"none","dark-lg":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 5px 10px, rgba(0, 0, 0, 0.4) 0px 15px 40px"},xoe={common:"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform",colors:"background-color, border-color, color, fill, stroke",dimensions:"width, height",position:"left, right, top, bottom",background:"background-color, background-image, background-position"},voe={"ease-in":"cubic-bezier(0.4, 0, 1, 1)","ease-out":"cubic-bezier(0, 0, 0.2, 1)","ease-in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},boe={"ultra-fast":"50ms",faster:"100ms",fast:"150ms",normal:"200ms",slow:"300ms",slower:"400ms","ultra-slow":"500ms"},_oe={property:xoe,easing:voe,duration:boe},woe={hide:-1,auto:"auto",base:0,docked:10,dropdown:1e3,sticky:1100,banner:1200,overlay:1300,modal:1400,popover:1500,skipLink:1600,toast:1700,tooltip:1800},Soe={none:0,sm:"4px",base:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},koe={breakpoints:poe,zIndices:woe,radii:goe,blur:Soe,colors:moe,...aV,sizes:tV,shadows:yoe,space:eV,borders:foe,transition:_oe},Coe={colors:{"chakra-body-text":{_light:"gray.800",_dark:"whiteAlpha.900"},"chakra-body-bg":{_light:"white",_dark:"gray.800"},"chakra-border-color":{_light:"gray.200",_dark:"whiteAlpha.300"},"chakra-inverse-text":{_light:"white",_dark:"gray.800"},"chakra-subtle-bg":{_light:"gray.100",_dark:"gray.700"},"chakra-subtle-text":{_light:"gray.600",_dark:"gray.400"},"chakra-placeholder-color":{_light:"gray.500",_dark:"whiteAlpha.400"}}},Toe={global:{body:{fontFamily:"body",color:"chakra-body-text",bg:"chakra-body-bg",transitionProperty:"background-color",transitionDuration:"normal",lineHeight:"base"},"*::placeholder":{color:"chakra-placeholder-color"},"*, *::before, &::after":{borderColor:"chakra-border-color"}}},Ooe=["borders","breakpoints","colors","components","config","direction","fonts","fontSizes","fontWeights","letterSpacings","lineHeights","radii","shadows","sizes","space","styles","transition","zIndices"];function joe(t){return no(t)?Ooe.every(e=>Object.prototype.hasOwnProperty.call(t,e)):!1}const Poe="ltr",Aoe={useSystemColorMode:!1,initialColorMode:"light",cssVarPrefix:"chakra"},hV={semanticTokens:Coe,direction:Poe,...koe,components:doe,styles:Toe,config:Aoe};function Eoe(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function zoe(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var Moe=function(){function t(r){var n=this;this._insertTag=function(i){var s;n.tags.length===0?n.insertionPoint?s=n.insertionPoint.nextSibling:n.prepend?s=n.container.firstChild:s=n.before:s=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,s),n.tags.push(i)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(zoe(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var s=Eoe(i);try{s.insertRule(n,s.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){var i;return(i=n.parentNode)==null?void 0:i.removeChild(n)}),this.tags=[],this.ctr=0},t}(),bo="-ms-",p2="-moz-",An="-webkit-",dV="comm",i5="rule",s5="decl",Ioe="@import",fV="@keyframes",Roe="@layer",Doe=Math.abs,jk=String.fromCharCode,Loe=Object.assign;function Foe(t,e){return Zs(t,0)^45?(((e<<2^Zs(t,0))<<2^Zs(t,1))<<2^Zs(t,2))<<2^Zs(t,3):0}function pV(t){return t.trim()}function Boe(t,e){return(t=e.exec(t))?t[0]:t}function En(t,e,r){return t.replace(e,r)}function tA(t,e){return t.indexOf(e)}function Zs(t,e){return t.charCodeAt(e)|0}function xb(t,e,r){return t.slice(e,r)}function Jc(t){return t.length}function o5(t){return t.length}function hw(t,e){return e.push(t),t}function $oe(t,e){return t.map(e).join("")}var Pk=1,Qy=1,mV=0,Aa=0,Ji=0,v0="";function Ak(t,e,r,n,i,s,a){return{value:t,root:e,parent:r,type:n,props:i,children:s,line:Pk,column:Qy,length:a,return:""}}function Nx(t,e){return Loe(Ak("",null,null,"",null,null,0),t,{length:-t.length},e)}function Noe(){return Ji}function Voe(){return Ji=Aa>0?Zs(v0,--Aa):0,Qy--,Ji===10&&(Qy=1,Pk--),Ji}function el(){return Ji=Aa<mV?Zs(v0,Aa++):0,Qy++,Ji===10&&(Qy=1,Pk++),Ji}function gu(){return Zs(v0,Aa)}function gS(){return Aa}function p1(t,e){return xb(v0,t,e)}function vb(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function gV(t){return Pk=Qy=1,mV=Jc(v0=t),Aa=0,[]}function yV(t){return v0="",t}function yS(t){return pV(p1(Aa-1,rA(t===91?t+2:t===40?t+1:t)))}function Woe(t){for(;(Ji=gu())&&Ji<33;)el();return vb(t)>2||vb(Ji)>3?"":" "}function Uoe(t,e){for(;--e&&el()&&!(Ji<48||Ji>102||Ji>57&&Ji<65||Ji>70&&Ji<97););return p1(t,gS()+(e<6&&gu()==32&&el()==32))}function rA(t){for(;el();)switch(Ji){case t:return Aa;case 34:case 39:t!==34&&t!==39&&rA(Ji);break;case 40:t===41&&rA(t);break;case 92:el();break}return Aa}function qoe(t,e){for(;el()&&t+Ji!==57;)if(t+Ji===84&&gu()===47)break;return"/*"+p1(e,Aa-1)+"*"+jk(t===47?t:el())}function Qoe(t){for(;!vb(gu());)el();return p1(t,Aa)}function Hoe(t){return yV(xS("",null,null,null,[""],t=gV(t),0,[0],t))}function xS(t,e,r,n,i,s,a,o,d){for(var m=0,y=0,v=a,w=0,O=0,P=0,E=1,$=1,R=1,F=0,D="",U=i,X=s,ee=n,K=D;$;)switch(P=F,F=el()){case 40:if(P!=108&&Zs(K,v-1)==58){tA(K+=En(yS(F),"&","&\f"),"&\f")!=-1&&(R=-1);break}case 34:case 39:case 91:K+=yS(F);break;case 9:case 10:case 13:case 32:K+=Woe(P);break;case 92:K+=Uoe(gS()-1,7);continue;case 47:switch(gu()){case 42:case 47:hw(Goe(qoe(el(),gS()),e,r),d);break;default:K+="/"}break;case 123*E:o[m++]=Jc(K)*R;case 125*E:case 59:case 0:switch(F){case 0:case 125:$=0;case 59+y:R==-1&&(K=En(K,/\f/g,"")),O>0&&Jc(K)-v&&hw(O>32?U3(K+";",n,r,v-1):U3(En(K," ","")+";",n,r,v-2),d);break;case 59:K+=";";default:if(hw(ee=W3(K,e,r,m,y,i,o,D,U=[],X=[],v),s),F===123)if(y===0)xS(K,e,ee,ee,U,s,v,o,X);else switch(w===99&&Zs(K,3)===110?100:w){case 100:case 108:case 109:case 115:xS(t,ee,ee,n&&hw(W3(t,ee,ee,0,0,i,o,D,i,U=[],v),X),i,X,v,o,n?U:X);break;default:xS(K,ee,ee,ee,[""],X,0,o,X)}}m=y=O=0,E=R=1,D=K="",v=a;break;case 58:v=1+Jc(K),O=P;default:if(E<1){if(F==123)--E;else if(F==125&&E++==0&&Voe()==125)continue}switch(K+=jk(F),F*E){case 38:R=y>0?1:(K+="\f",-1);break;case 44:o[m++]=(Jc(K)-1)*R,R=1;break;case 64:gu()===45&&(K+=yS(el())),w=gu(),y=v=Jc(D=K+=Qoe(gS())),F++;break;case 45:P===45&&Jc(K)==2&&(E=0)}}return s}function W3(t,e,r,n,i,s,a,o,d,m,y){for(var v=i-1,w=i===0?s:[""],O=o5(w),P=0,E=0,$=0;P<n;++P)for(var R=0,F=xb(t,v+1,v=Doe(E=a[P])),D=t;R<O;++R)(D=pV(E>0?w[R]+" "+F:En(F,/&\f/g,w[R])))&&(d[$++]=D);return Ak(t,e,r,i===0?i5:o,d,m,y)}function Goe(t,e,r){return Ak(t,e,r,dV,jk(Noe()),xb(t,2,-2),0)}function U3(t,e,r,n){return Ak(t,e,r,s5,xb(t,0,n),xb(t,n+1,-1),n)}function dy(t,e){for(var r="",n=o5(t),i=0;i<n;i++)r+=e(t[i],i,t,e)||"";return r}function Xoe(t,e,r,n){switch(t.type){case Roe:if(t.children.length)break;case Ioe:case s5:return t.return=t.return||t.value;case dV:return"";case fV:return t.return=t.value+"{"+dy(t.children,n)+"}";case i5:t.value=t.props.join(",")}return Jc(r=dy(t.children,n))?t.return=t.value+"{"+r+"}":""}function Koe(t){var e=o5(t);return function(r,n,i,s){for(var a="",o=0;o<e;o++)a+=t[o](r,n,i,s)||"";return a}}function Zoe(t){return function(e){e.root||(e=e.return)&&t(e)}}var q3=function(e){var r=new WeakMap;return function(n){if(r.has(n))return r.get(n);var i=e(n);return r.set(n,i),i}};function xV(t){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=t(r)),e[r]}}var Yoe=function(e,r,n){for(var i=0,s=0;i=s,s=gu(),i===38&&s===12&&(r[n]=1),!vb(s);)el();return p1(e,Aa)},Joe=function(e,r){var n=-1,i=44;do switch(vb(i)){case 0:i===38&&gu()===12&&(r[n]=1),e[n]+=Yoe(Aa-1,r,n);break;case 2:e[n]+=yS(i);break;case 4:if(i===44){e[++n]=gu()===58?"&\f":"",r[n]=e[n].length;break}default:e[n]+=jk(i)}while(i=el());return e},eae=function(e,r){return yV(Joe(gV(e),r))},Q3=new WeakMap,tae=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!Q3.get(n))&&!i){Q3.set(e,!0);for(var s=[],a=eae(r,s),o=n.props,d=0,m=0;d<a.length;d++)for(var y=0;y<o.length;y++,m++)e.props[m]=s[d]?a[d].replace(/&\f/g,o[y]):o[y]+" "+a[d]}}},rae=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function vV(t,e){switch(Foe(t,e)){case 5103:return An+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return An+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return An+t+p2+t+bo+t+t;case 6828:case 4268:return An+t+bo+t+t;case 6165:return An+t+bo+"flex-"+t+t;case 5187:return An+t+En(t,/(\w+).+(:[^]+)/,An+"box-$1$2"+bo+"flex-$1$2")+t;case 5443:return An+t+bo+"flex-item-"+En(t,/flex-|-self/,"")+t;case 4675:return An+t+bo+"flex-line-pack"+En(t,/align-content|flex-|-self/,"")+t;case 5548:return An+t+bo+En(t,"shrink","negative")+t;case 5292:return An+t+bo+En(t,"basis","preferred-size")+t;case 6060:return An+"box-"+En(t,"-grow","")+An+t+bo+En(t,"grow","positive")+t;case 4554:return An+En(t,/([^-])(transform)/g,"$1"+An+"$2")+t;case 6187:return En(En(En(t,/(zoom-|grab)/,An+"$1"),/(image-set)/,An+"$1"),t,"")+t;case 5495:case 3959:return En(t,/(image-set\([^]*)/,An+"$1$`$1");case 4968:return En(En(t,/(.+:)(flex-)?(.*)/,An+"box-pack:$3"+bo+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+An+t+t;case 4095:case 3583:case 4068:case 2532:return En(t,/(.+)-inline(.+)/,An+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Jc(t)-1-e>6)switch(Zs(t,e+1)){case 109:if(Zs(t,e+4)!==45)break;case 102:return En(t,/(.+:)(.+)-([^]+)/,"$1"+An+"$2-$3$1"+p2+(Zs(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~tA(t,"stretch")?vV(En(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Zs(t,e+1)!==115)break;case 6444:switch(Zs(t,Jc(t)-3-(~tA(t,"!important")&&10))){case 107:return En(t,":",":"+An)+t;case 101:return En(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+An+(Zs(t,14)===45?"inline-":"")+"box$3$1"+An+"$2$3$1"+bo+"$2box$3")+t}break;case 5936:switch(Zs(t,e+11)){case 114:return An+t+bo+En(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return An+t+bo+En(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return An+t+bo+En(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return An+t+bo+t+t}return t}var nae=function(e,r,n,i){if(e.length>-1&&!e.return)switch(e.type){case s5:e.return=vV(e.value,e.length);break;case fV:return dy([Nx(e,{value:En(e.value,"@","@"+An)})],i);case i5:if(e.length)return $oe(e.props,function(s){switch(Boe(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return dy([Nx(e,{props:[En(s,/:(read-\w+)/,":"+p2+"$1")]})],i);case"::placeholder":return dy([Nx(e,{props:[En(s,/:(plac\w+)/,":"+An+"input-$1")]}),Nx(e,{props:[En(s,/:(plac\w+)/,":"+p2+"$1")]}),Nx(e,{props:[En(s,/:(plac\w+)/,bo+"input-$1")]})],i)}return""})}},iae=[nae],sae=function(e){var r=e.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(E){var $=E.getAttribute("data-emotion");$.indexOf(" ")!==-1&&(document.head.appendChild(E),E.setAttribute("data-s",""))})}var i=e.stylisPlugins||iae,s={},a,o=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(E){for(var $=E.getAttribute("data-emotion").split(" "),R=1;R<$.length;R++)s[$[R]]=!0;o.push(E)});var d,m=[tae,rae];{var y,v=[Xoe,Zoe(function(E){y.insert(E)})],w=Koe(m.concat(i,v)),O=function($){return dy(Hoe($),w)};d=function($,R,F,D){y=F,O($?$+"{"+R.styles+"}":R.styles),D&&(P.inserted[R.name]=!0)}}var P={key:r,sheet:new Moe({key:r,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:d};return P.sheet.hydrate(o),P};function tf(){return tf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},tf.apply(null,arguments)}var bV={exports:{}},Un={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vs=typeof Symbol=="function"&&Symbol.for,a5=Vs?Symbol.for("react.element"):60103,l5=Vs?Symbol.for("react.portal"):60106,Ek=Vs?Symbol.for("react.fragment"):60107,zk=Vs?Symbol.for("react.strict_mode"):60108,Mk=Vs?Symbol.for("react.profiler"):60114,Ik=Vs?Symbol.for("react.provider"):60109,Rk=Vs?Symbol.for("react.context"):60110,c5=Vs?Symbol.for("react.async_mode"):60111,Dk=Vs?Symbol.for("react.concurrent_mode"):60111,Lk=Vs?Symbol.for("react.forward_ref"):60112,Fk=Vs?Symbol.for("react.suspense"):60113,oae=Vs?Symbol.for("react.suspense_list"):60120,Bk=Vs?Symbol.for("react.memo"):60115,$k=Vs?Symbol.for("react.lazy"):60116,aae=Vs?Symbol.for("react.block"):60121,lae=Vs?Symbol.for("react.fundamental"):60117,cae=Vs?Symbol.for("react.responder"):60118,uae=Vs?Symbol.for("react.scope"):60119;function al(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case a5:switch(t=t.type,t){case c5:case Dk:case Ek:case Mk:case zk:case Fk:return t;default:switch(t=t&&t.$$typeof,t){case Rk:case Lk:case $k:case Bk:case Ik:return t;default:return e}}case l5:return e}}}function _V(t){return al(t)===Dk}Un.AsyncMode=c5;Un.ConcurrentMode=Dk;Un.ContextConsumer=Rk;Un.ContextProvider=Ik;Un.Element=a5;Un.ForwardRef=Lk;Un.Fragment=Ek;Un.Lazy=$k;Un.Memo=Bk;Un.Portal=l5;Un.Profiler=Mk;Un.StrictMode=zk;Un.Suspense=Fk;Un.isAsyncMode=function(t){return _V(t)||al(t)===c5};Un.isConcurrentMode=_V;Un.isContextConsumer=function(t){return al(t)===Rk};Un.isContextProvider=function(t){return al(t)===Ik};Un.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===a5};Un.isForwardRef=function(t){return al(t)===Lk};Un.isFragment=function(t){return al(t)===Ek};Un.isLazy=function(t){return al(t)===$k};Un.isMemo=function(t){return al(t)===Bk};Un.isPortal=function(t){return al(t)===l5};Un.isProfiler=function(t){return al(t)===Mk};Un.isStrictMode=function(t){return al(t)===zk};Un.isSuspense=function(t){return al(t)===Fk};Un.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Ek||t===Dk||t===Mk||t===zk||t===Fk||t===oae||typeof t=="object"&&t!==null&&(t.$$typeof===$k||t.$$typeof===Bk||t.$$typeof===Ik||t.$$typeof===Rk||t.$$typeof===Lk||t.$$typeof===lae||t.$$typeof===cae||t.$$typeof===uae||t.$$typeof===aae)};Un.typeOf=al;bV.exports=Un;var hae=bV.exports,wV=hae,dae={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},fae={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},SV={};SV[wV.ForwardRef]=dae;SV[wV.Memo]=fae;var pae=!0;function kV(t,e,r){var n="";return r.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(n+=i+" ")}),n}var u5=function(e,r,n){var i=e.key+"-"+r.name;(n===!1||pae===!1)&&e.registered[i]===void 0&&(e.registered[i]=r.styles)},h5=function(e,r,n){u5(e,r,n);var i=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var s=r;do e.insert(r===s?"."+i:"",s,e.sheet,!0),s=s.next;while(s!==void 0)}};function mae(t){for(var e=0,r,n=0,i=t.length;i>=4;++n,i-=4)r=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(n+2)&255)<<16;case 2:e^=(t.charCodeAt(n+1)&255)<<8;case 1:e^=t.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var gae={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},yae=/[A-Z]|^ms/g,xae=/_EMO_([^_]+?)_([^]*?)_EMO_/g,CV=function(e){return e.charCodeAt(1)===45},H3=function(e){return e!=null&&typeof e!="boolean"},PO=xV(function(t){return CV(t)?t:t.replace(yae,"-$&").toLowerCase()}),G3=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(xae,function(n,i,s){return eu={name:i,styles:s,next:eu},i})}return gae[e]!==1&&!CV(e)&&typeof r=="number"&&r!==0?r+"px":r};function bb(t,e,r){if(r==null)return"";var n=r;if(n.__emotion_styles!==void 0)return n;switch(typeof r){case"boolean":return"";case"object":{var i=r;if(i.anim===1)return eu={name:i.name,styles:i.styles,next:eu},i.name;var s=r;if(s.styles!==void 0){var a=s.next;if(a!==void 0)for(;a!==void 0;)eu={name:a.name,styles:a.styles,next:eu},a=a.next;var o=s.styles+";";return o}return vae(t,e,r)}case"function":{if(t!==void 0){var d=eu,m=r(t);return eu=d,bb(t,e,m)}break}}var y=r;if(e==null)return y;var v=e[y];return v!==void 0?v:y}function vae(t,e,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=bb(t,e,r[i])+";";else for(var s in r){var a=r[s];if(typeof a!="object"){var o=a;e!=null&&e[o]!==void 0?n+=s+"{"+e[o]+"}":H3(o)&&(n+=PO(s)+":"+G3(s,o)+";")}else if(Array.isArray(a)&&typeof a[0]=="string"&&(e==null||e[a[0]]===void 0))for(var d=0;d<a.length;d++)H3(a[d])&&(n+=PO(s)+":"+G3(s,a[d])+";");else{var m=bb(t,e,a);switch(s){case"animation":case"animationName":{n+=PO(s)+":"+m+";";break}default:n+=s+"{"+m+"}"}}}return n}var X3=/label:\s*([^\s;{]+)\s*(;|$)/g,eu;function Nk(t,e,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,i="";eu=void 0;var s=t[0];if(s==null||s.raw===void 0)n=!1,i+=bb(r,e,s);else{var a=s;i+=a[0]}for(var o=1;o<t.length;o++)if(i+=bb(r,e,t[o]),n){var d=s;i+=d[o]}X3.lastIndex=0;for(var m="",y;(y=X3.exec(i))!==null;)m+="-"+y[1];var v=mae(i)+m;return{name:v,styles:i,next:eu}}var bae=function(e){return e()},TV=dD.useInsertionEffect?dD.useInsertionEffect:!1,OV=TV||bae,K3=TV||I.useLayoutEffect,d5=I.createContext(typeof HTMLElement<"u"?sae({key:"css"}):null);d5.Provider;var _ae=function(){return I.useContext(d5)},f5=function(e){return I.forwardRef(function(r,n){var i=I.useContext(d5);return e(r,i,n)})},Hy=I.createContext({}),wae=function(e,r){if(typeof r=="function"){var n=r(e);return n}return tf({},e,r)},Sae=q3(function(t){return q3(function(e){return wae(t,e)})}),kae=function(e){var r=I.useContext(Hy);return e.theme!==r&&(r=Sae(r)(e.theme)),I.createElement(Hy.Provider,{value:r},e.children)},p5={}.hasOwnProperty,nA="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Cae=function(e,r){var n={};for(var i in r)p5.call(r,i)&&(n[i]=r[i]);return n[nA]=e,n},Tae=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return u5(r,n,i),OV(function(){return h5(r,n,i)}),null},Oae=f5(function(t,e,r){var n=t.css;typeof n=="string"&&e.registered[n]!==void 0&&(n=e.registered[n]);var i=t[nA],s=[n],a="";typeof t.className=="string"?a=kV(e.registered,s,t.className):t.className!=null&&(a=t.className+" ");var o=Nk(s,void 0,I.useContext(Hy));a+=e.key+"-"+o.name;var d={};for(var m in t)p5.call(t,m)&&m!=="css"&&m!==nA&&(d[m]=t[m]);return d.className=a,r&&(d.ref=r),I.createElement(I.Fragment,null,I.createElement(Tae,{cache:e,serialized:o,isStringTag:typeof i=="string"}),I.createElement(i,d))}),jae=Oae,Z3=function(e,r){var n=arguments;if(r==null||!p5.call(r,"css"))return I.createElement.apply(void 0,n);var i=n.length,s=new Array(i);s[0]=jae,s[1]=Cae(e,r);for(var a=2;a<i;a++)s[a]=n[a];return I.createElement.apply(null,s)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(Z3||(Z3={}));var Vk=f5(function(t,e){var r=t.styles,n=Nk([r],void 0,I.useContext(Hy)),i=I.useRef();return K3(function(){var s=e.key+"-global",a=new e.sheet.constructor({key:s,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),o=!1,d=document.querySelector('style[data-emotion="'+s+" "+n.name+'"]');return e.sheet.tags.length&&(a.before=e.sheet.tags[0]),d!==null&&(o=!0,d.setAttribute("data-emotion",s),a.hydrate([d])),i.current=[a,o],function(){a.flush()}},[e]),K3(function(){var s=i.current,a=s[0],o=s[1];if(o){s[1]=!1;return}if(n.next!==void 0&&h5(e,n.next,!0),a.tags.length){var d=a.tags[a.tags.length-1].nextElementSibling;a.before=d,a.flush()}e.insert("",n,a,!1)},[e,n.name]),null});function yc(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Nk(e)}function lo(){var t=yc.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}const m5=I.createContext({});m5.displayName="ColorModeContext";function Wk(){const t=I.useContext(m5);if(t===void 0)throw new Error("useColorMode must be used within a ColorModeProvider");return t}function Bt(t,e){const{colorMode:r}=Wk();return r==="dark"?e:t}const dw={light:"chakra-ui-light",dark:"chakra-ui-dark"};function Pae(t={}){const{preventTransition:e=!0,nonce:r}=t,n={setDataset:i=>{const s=e?n.preventTransition():void 0;document.documentElement.dataset.theme=i,document.documentElement.style.colorScheme=i,s==null||s()},setClassName(i){document.body.classList.add(i?dw.dark:dw.light),document.body.classList.remove(i?dw.light:dw.dark)},query(){return window.matchMedia("(prefers-color-scheme: dark)")},getSystemTheme(i){return n.query().matches??i==="dark"?"dark":"light"},addListener(i){const s=n.query(),a=o=>{i(o.matches?"dark":"light")};return typeof s.addListener=="function"?s.addListener(a):s.addEventListener("change",a),()=>{typeof s.removeListener=="function"?s.removeListener(a):s.removeEventListener("change",a)}},preventTransition(){const i=document.createElement("style");return i.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),r!==void 0&&(i.nonce=r),document.head.appendChild(i),()=>{window.getComputedStyle(document.body),requestAnimationFrame(()=>{requestAnimationFrame(()=>{document.head.removeChild(i)})})}}};return n}const Aae="chakra-ui-color-mode";function Eae(t){return{ssr:!1,type:"localStorage",get(e){if(!(globalThis!=null&&globalThis.document))return e;let r;try{r=localStorage.getItem(t)||e}catch{}return r||e},set(e){try{localStorage.setItem(t,e)}catch{}}}}const zae=Eae(Aae),Y3=()=>{},Mae=sY()?I.useLayoutEffect:I.useEffect;function J3(t,e){return t.type==="cookie"&&t.ssr?t.get(e):e}const jV=function(e){const{value:r,children:n,options:{useSystemColorMode:i,initialColorMode:s,disableTransitionOnChange:a}={},colorModeManager:o=zae}=e,d=_ae(),m=s==="dark"?"dark":"light",[y,v]=I.useState(()=>J3(o,m)),[w,O]=I.useState(()=>J3(o)),{getSystemTheme:P,setClassName:E,setDataset:$,addListener:R}=I.useMemo(()=>Pae({preventTransition:a,nonce:d==null?void 0:d.nonce}),[a,d==null?void 0:d.nonce]),F=s==="system"&&!y?w:y,D=I.useCallback(ee=>{const K=ee==="system"?P():ee;v(K),E(K==="dark"),$(K),o.set(K)},[o,P,E,$]);Mae(()=>{s==="system"&&O(P())},[]),I.useEffect(()=>{const ee=o.get();if(ee){D(ee);return}if(s==="system"){D("system");return}D(m)},[o,m,s,D]);const U=I.useCallback(()=>{D(F==="dark"?"light":"dark")},[F,D]);I.useEffect(()=>{if(i)return R(D)},[i,R,D]);const X=I.useMemo(()=>({colorMode:r??F,toggleColorMode:r?Y3:U,setColorMode:r?Y3:D,forced:r!==void 0}),[F,U,D,r]);return u.jsx(m5.Provider,{value:X,children:n})};jV.displayName="ColorModeProvider";const PV=String.raw,AV=PV`
  :root,
  :host {
    --chakra-vh: 100vh;
  }

  @supports (height: -webkit-fill-available) {
    :root,
    :host {
      --chakra-vh: -webkit-fill-available;
    }
  }

  @supports (height: -moz-fill-available) {
    :root,
    :host {
      --chakra-vh: -moz-fill-available;
    }
  }

  @supports (height: 100dvh) {
    :root,
    :host {
      --chakra-vh: 100dvh;
    }
  }
`,Iae=()=>u.jsx(Vk,{styles:AV}),Rae=({scope:t=""})=>u.jsx(Vk,{styles:PV`
      html {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        font-family: system-ui, sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
        -moz-osx-font-smoothing: grayscale;
        touch-action: manipulation;
      }

      body {
        position: relative;
        min-height: 100%;
        margin: 0;
        font-feature-settings: "kern";
      }

      ${t} :where(*, *::before, *::after) {
        border-width: 0;
        border-style: solid;
        box-sizing: border-box;
        word-wrap: break-word;
      }

      main {
        display: block;
      }

      ${t} hr {
        border-top-width: 1px;
        box-sizing: content-box;
        height: 0;
        overflow: visible;
      }

      ${t} :where(pre, code, kbd,samp) {
        font-family: SFMono-Regular, Menlo, Monaco, Consolas, monospace;
        font-size: 1em;
      }

      ${t} a {
        background-color: transparent;
        color: inherit;
        text-decoration: inherit;
      }

      ${t} abbr[title] {
        border-bottom: none;
        text-decoration: underline;
        -webkit-text-decoration: underline dotted;
        text-decoration: underline dotted;
      }

      ${t} :where(b, strong) {
        font-weight: bold;
      }

      ${t} small {
        font-size: 80%;
      }

      ${t} :where(sub,sup) {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
      }

      ${t} sub {
        bottom: -0.25em;
      }

      ${t} sup {
        top: -0.5em;
      }

      ${t} img {
        border-style: none;
      }

      ${t} :where(button, input, optgroup, select, textarea) {
        font-family: inherit;
        font-size: 100%;
        line-height: 1.15;
        margin: 0;
      }

      ${t} :where(button, input) {
        overflow: visible;
      }

      ${t} :where(button, select) {
        text-transform: none;
      }

      ${t} :where(
          button::-moz-focus-inner,
          [type="button"]::-moz-focus-inner,
          [type="reset"]::-moz-focus-inner,
          [type="submit"]::-moz-focus-inner
        ) {
        border-style: none;
        padding: 0;
      }

      ${t} fieldset {
        padding: 0.35em 0.75em 0.625em;
      }

      ${t} legend {
        box-sizing: border-box;
        color: inherit;
        display: table;
        max-width: 100%;
        padding: 0;
        white-space: normal;
      }

      ${t} progress {
        vertical-align: baseline;
      }

      ${t} textarea {
        overflow: auto;
      }

      ${t} :where([type="checkbox"], [type="radio"]) {
        box-sizing: border-box;
        padding: 0;
      }

      ${t} input[type="number"]::-webkit-inner-spin-button,
      ${t} input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none !important;
      }

      ${t} input[type="number"] {
        -moz-appearance: textfield;
      }

      ${t} input[type="search"] {
        -webkit-appearance: textfield;
        outline-offset: -2px;
      }

      ${t} input[type="search"]::-webkit-search-decoration {
        -webkit-appearance: none !important;
      }

      ${t} ::-webkit-file-upload-button {
        -webkit-appearance: button;
        font: inherit;
      }

      ${t} details {
        display: block;
      }

      ${t} summary {
        display: list-item;
      }

      template {
        display: none;
      }

      [hidden] {
        display: none !important;
      }

      ${t} :where(
          blockquote,
          dl,
          dd,
          h1,
          h2,
          h3,
          h4,
          h5,
          h6,
          hr,
          figure,
          p,
          pre
        ) {
        margin: 0;
      }

      ${t} button {
        background: transparent;
        padding: 0;
      }

      ${t} fieldset {
        margin: 0;
        padding: 0;
      }

      ${t} :where(ol, ul) {
        margin: 0;
        padding: 0;
      }

      ${t} textarea {
        resize: vertical;
      }

      ${t} :where(button, [role="button"]) {
        cursor: pointer;
      }

      ${t} button::-moz-focus-inner {
        border: 0 !important;
      }

      ${t} table {
        border-collapse: collapse;
      }

      ${t} :where(h1, h2, h3, h4, h5, h6) {
        font-size: inherit;
        font-weight: inherit;
      }

      ${t} :where(button, input, optgroup, select, textarea) {
        padding: 0;
        line-height: inherit;
        color: inherit;
      }

      ${t} :where(img, svg, video, canvas, audio, iframe, embed, object) {
        display: block;
      }

      ${t} :where(img, video) {
        max-width: 100%;
        height: auto;
      }

      [data-js-focus-visible]
        :focus:not([data-focus-visible-added]):not(
          [data-focus-visible-disabled]
        ) {
        outline: none;
        box-shadow: none;
      }

      ${t} select::-ms-expand {
        display: none;
      }

      ${AV}
    `});function Dae(t){const{cssVarsRoot:e,theme:r,children:n}=t,i=I.useMemo(()=>xee(r),[r]);return u.jsxs(kae,{theme:i,children:[u.jsx(Lae,{root:e}),n]})}function Lae({root:t=":host, :root"}){const e=[t,"[data-theme]"].join(",");return u.jsx(Vk,{styles:r=>({[e]:r.__cssVars})})}_n({name:"StylesContext",errorMessage:"useStyles: `styles` is undefined. Seems you forgot to wrap the components in `<StylesProvider />` "});function Fae(t){return _n({name:`${t}StylesContext`,errorMessage:`useStyles: "styles" is undefined. Seems you forgot to wrap the components in "<${t} />" `})}function Bae(){const{colorMode:t}=Wk();return u.jsx(Vk,{styles:e=>{const r=I8(e,"styles.global"),n=Ka(r,{theme:e,colorMode:t});return n?K8(n)(e):void 0}})}const[$ae,Nae]=_n({strict:!1,name:"PortalManagerContext"});function EV(t){const{children:e,zIndex:r}=t;return u.jsx($ae,{value:{zIndex:r},children:e})}EV.displayName="PortalManager";const zV=I.createContext({getDocument(){return document},getWindow(){return window}});zV.displayName="EnvironmentContext";function MV(t){const{children:e,environment:r,disabled:n}=t,i=I.useRef(null),s=I.useMemo(()=>r||{getDocument:()=>{var o;return((o=i.current)==null?void 0:o.ownerDocument)??document},getWindow:()=>{var o;return((o=i.current)==null?void 0:o.ownerDocument.defaultView)??window}},[r]),a=!n||!r;return u.jsxs(zV.Provider,{value:s,children:[e,a&&u.jsx("span",{id:"__chakra_env",hidden:!0,ref:i})]})}MV.displayName="EnvironmentProvider";const Vae=t=>{const{children:e,colorModeManager:r,portalZIndex:n,resetScope:i,resetCSS:s=!0,theme:a={},environment:o,cssVarsRoot:d,disableEnvironment:m,disableGlobalStyle:y}=t,v=u.jsx(MV,{environment:o,disabled:m,children:e});return u.jsx(Dae,{theme:a,cssVarsRoot:d,children:u.jsxs(jV,{colorModeManager:r,options:a.config,children:[s?u.jsx(Rae,{scope:i}):u.jsx(Iae,{}),!y&&u.jsx(Bae,{}),n?u.jsx(EV,{zIndex:n,children:v}):v]})})},IV=I.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),Uk=I.createContext({}),m1=I.createContext(null),qk=typeof document<"u",g5=qk?I.useLayoutEffect:I.useEffect,RV=I.createContext({strict:!1}),y5=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Wae="framerAppearId",DV="data-"+y5(Wae);function Uae(t,e,r,n){const{visualElement:i}=I.useContext(Uk),s=I.useContext(RV),a=I.useContext(m1),o=I.useContext(IV).reducedMotion,d=I.useRef();n=n||s.renderer,!d.current&&n&&(d.current=n(t,{visualState:e,parent:i,props:r,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:o}));const m=d.current;I.useInsertionEffect(()=>{m&&m.update(r,a)});const y=I.useRef(!!(r[DV]&&!window.HandoffComplete));return g5(()=>{m&&(m.render(),y.current&&m.animationState&&m.animationState.animateChanges())}),I.useEffect(()=>{m&&(m.updateFeatures(),!y.current&&m.animationState&&m.animationState.animateChanges(),y.current&&(y.current=!1,window.HandoffComplete=!0))}),m}function qg(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function qae(t,e,r){return I.useCallback(n=>{n&&t.mount&&t.mount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):qg(r)&&(r.current=n))},[e])}function _b(t){return typeof t=="string"||Array.isArray(t)}function Qk(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const x5=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],v5=["initial",...x5];function Hk(t){return Qk(t.animate)||v5.some(e=>_b(t[e]))}function LV(t){return!!(Hk(t)||t.variants)}function Qae(t,e){if(Hk(t)){const{initial:r,animate:n}=t;return{initial:r===!1||_b(r)?r:void 0,animate:_b(n)?n:void 0}}return t.inherit!==!1?e:{}}function Hae(t){const{initial:e,animate:r}=Qae(t,I.useContext(Uk));return I.useMemo(()=>({initial:e,animate:r}),[e4(e),e4(r)])}function e4(t){return Array.isArray(t)?t.join(" "):t}const t4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},wb={};for(const t in t4)wb[t]={isEnabled:e=>t4[t].some(r=>!!e[r])};function Gae(t){for(const e in t)wb[e]={...wb[e],...t[e]}}const b5=I.createContext({}),FV=I.createContext({}),Xae=Symbol.for("motionComponentSymbol");function Kae({preloadedFeatures:t,createVisualElement:e,useRender:r,useVisualState:n,Component:i}){t&&Gae(t);function s(o,d){let m;const y={...I.useContext(IV),...o,layoutId:Zae(o)},{isStatic:v}=y,w=Hae(o),O=n(o,v);if(!v&&qk){w.visualElement=Uae(i,O,y,e);const P=I.useContext(FV),E=I.useContext(RV).strict;w.visualElement&&(m=w.visualElement.loadFeatures(y,E,t,P))}return I.createElement(Uk.Provider,{value:w},m&&w.visualElement?I.createElement(m,{visualElement:w.visualElement,...y}):null,r(i,o,qae(O,w.visualElement,d),O,v,w.visualElement))}const a=I.forwardRef(s);return a[Xae]=i,a}function Zae({layoutId:t}){const e=I.useContext(b5).id;return e&&t!==void 0?e+"-"+t:t}function Yae(t){function e(n,i={}){return Kae(t(n,i))}if(typeof Proxy>"u")return e;const r=new Map;return new Proxy(e,{get:(n,i)=>(r.has(i)||r.set(i,e(i)),r.get(i))})}const Jae=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function _5(t){return typeof t!="string"||t.includes("-")?!1:!!(Jae.indexOf(t)>-1||/[A-Z]/.test(t))}const m2={};function ele(t){Object.assign(m2,t)}const g1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],bm=new Set(g1);function BV(t,{layout:e,layoutId:r}){return bm.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!m2[t]||t==="opacity")}const Ea=t=>!!(t&&t.getVelocity),tle={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},rle=g1.length;function nle(t,{enableHardwareAcceleration:e=!0,allowTransformNone:r=!0},n,i){let s="";for(let a=0;a<rle;a++){const o=g1[a];if(t[o]!==void 0){const d=tle[o]||o;s+=`${d}(${t[o]}) `}}return e&&!t.z&&(s+="translateZ(0)"),s=s.trim(),i?s=i(t,n?"":s):r&&n&&(s="none"),s}const $V=t=>e=>typeof e=="string"&&e.startsWith(t),NV=$V("--"),iA=$V("var(--"),ile=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,sle=(t,e)=>e&&typeof t=="number"?e.transform(t):t,rf=(t,e,r)=>Math.min(Math.max(r,t),e),_m={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Dv={..._m,transform:t=>rf(0,1,t)},fw={..._m,default:1},Lv=t=>Math.round(t*1e5)/1e5,Gk=/(-)?([\d]*\.?[\d])+/g,VV=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,ole=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function y1(t){return typeof t=="string"}const x1=t=>({test:e=>y1(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),dd=x1("deg"),yu=x1("%"),Dr=x1("px"),ale=x1("vh"),lle=x1("vw"),r4={...yu,parse:t=>yu.parse(t)/100,transform:t=>yu.transform(t*100)},n4={..._m,transform:Math.round},WV={borderWidth:Dr,borderTopWidth:Dr,borderRightWidth:Dr,borderBottomWidth:Dr,borderLeftWidth:Dr,borderRadius:Dr,radius:Dr,borderTopLeftRadius:Dr,borderTopRightRadius:Dr,borderBottomRightRadius:Dr,borderBottomLeftRadius:Dr,width:Dr,maxWidth:Dr,height:Dr,maxHeight:Dr,size:Dr,top:Dr,right:Dr,bottom:Dr,left:Dr,padding:Dr,paddingTop:Dr,paddingRight:Dr,paddingBottom:Dr,paddingLeft:Dr,margin:Dr,marginTop:Dr,marginRight:Dr,marginBottom:Dr,marginLeft:Dr,rotate:dd,rotateX:dd,rotateY:dd,rotateZ:dd,scale:fw,scaleX:fw,scaleY:fw,scaleZ:fw,skew:dd,skewX:dd,skewY:dd,distance:Dr,translateX:Dr,translateY:Dr,translateZ:Dr,x:Dr,y:Dr,z:Dr,perspective:Dr,transformPerspective:Dr,opacity:Dv,originX:r4,originY:r4,originZ:Dr,zIndex:n4,fillOpacity:Dv,strokeOpacity:Dv,numOctaves:n4};function w5(t,e,r,n){const{style:i,vars:s,transform:a,transformOrigin:o}=t;let d=!1,m=!1,y=!0;for(const v in e){const w=e[v];if(NV(v)){s[v]=w;continue}const O=WV[v],P=sle(w,O);if(bm.has(v)){if(d=!0,a[v]=P,!y)continue;w!==(O.default||0)&&(y=!1)}else v.startsWith("origin")?(m=!0,o[v]=P):i[v]=P}if(e.transform||(d||n?i.transform=nle(t.transform,r,y,n):i.transform&&(i.transform="none")),m){const{originX:v="50%",originY:w="50%",originZ:O=0}=o;i.transformOrigin=`${v} ${w} ${O}`}}const S5=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function UV(t,e,r){for(const n in e)!Ea(e[n])&&!BV(n,r)&&(t[n]=e[n])}function cle({transformTemplate:t},e,r){return I.useMemo(()=>{const n=S5();return w5(n,e,{enableHardwareAcceleration:!r},t),Object.assign({},n.vars,n.style)},[e])}function ule(t,e,r){const n=t.style||{},i={};return UV(i,n,t),Object.assign(i,cle(t,e,r)),t.transformValues?t.transformValues(i):i}function hle(t,e,r){const n={},i=ule(t,e,r);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=i,n}const dle=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function g2(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||dle.has(t)}let qV=t=>!g2(t);function fle(t){t&&(qV=e=>e.startsWith("on")?!g2(e):t(e))}try{fle(require("@emotion/is-prop-valid").default)}catch{}function ple(t,e,r){const n={};for(const i in t)i==="values"&&typeof t.values=="object"||(qV(i)||r===!0&&g2(i)||!e&&!g2(i)||t.draggable&&i.startsWith("onDrag"))&&(n[i]=t[i]);return n}function i4(t,e,r){return typeof t=="string"?t:Dr.transform(e+r*t)}function mle(t,e,r){const n=i4(e,t.x,t.width),i=i4(r,t.y,t.height);return`${n} ${i}`}const gle={offset:"stroke-dashoffset",array:"stroke-dasharray"},yle={offset:"strokeDashoffset",array:"strokeDasharray"};function xle(t,e,r=1,n=0,i=!0){t.pathLength=1;const s=i?gle:yle;t[s.offset]=Dr.transform(-n);const a=Dr.transform(e),o=Dr.transform(r);t[s.array]=`${a} ${o}`}function k5(t,{attrX:e,attrY:r,attrScale:n,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:d=0,...m},y,v,w){if(w5(t,m,y,w),v){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:O,style:P,dimensions:E}=t;O.transform&&(E&&(P.transform=O.transform),delete O.transform),E&&(i!==void 0||s!==void 0||P.transform)&&(P.transformOrigin=mle(E,i!==void 0?i:.5,s!==void 0?s:.5)),e!==void 0&&(O.x=e),r!==void 0&&(O.y=r),n!==void 0&&(O.scale=n),a!==void 0&&xle(O,a,o,d,!1)}const QV=()=>({...S5(),attrs:{}}),C5=t=>typeof t=="string"&&t.toLowerCase()==="svg";function vle(t,e,r,n){const i=I.useMemo(()=>{const s=QV();return k5(s,e,{enableHardwareAcceleration:!1},C5(n),t.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};UV(s,t.style,t),i.style={...s,...i.style}}return i}function ble(t=!1){return(r,n,i,{latestValues:s},a)=>{const d=(_5(r)?vle:hle)(n,s,a,r),y={...ple(n,typeof r=="string",t),...d,ref:i},{children:v}=n,w=I.useMemo(()=>Ea(v)?v.get():v,[v]);return I.createElement(r,{...y,children:w})}}function HV(t,{style:e,vars:r},n,i){Object.assign(t.style,e,i&&i.getProjectionStyles(n));for(const s in r)t.style.setProperty(s,r[s])}const GV=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function XV(t,e,r,n){HV(t,e,void 0,n);for(const i in e.attrs)t.setAttribute(GV.has(i)?i:y5(i),e.attrs[i])}function T5(t,e){const{style:r}=t,n={};for(const i in r)(Ea(r[i])||e.style&&Ea(e.style[i])||BV(i,t))&&(n[i]=r[i]);return n}function KV(t,e){const r=T5(t,e);for(const n in t)if(Ea(t[n])||Ea(e[n])){const i=g1.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[i]=t[n]}return r}function O5(t,e,r,n={},i={}){return typeof e=="function"&&(e=e(r!==void 0?r:t.custom,n,i)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(r!==void 0?r:t.custom,n,i)),e}function ZV(t){const e=I.useRef(null);return e.current===null&&(e.current=t()),e.current}const y2=t=>Array.isArray(t),_le=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),wle=t=>y2(t)?t[t.length-1]||0:t;function vS(t){const e=Ea(t)?t.get():t;return _le(e)?e.toValue():e}function Sle({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:r},n,i,s){const a={latestValues:kle(n,i,s,t),renderState:e()};return r&&(a.mount=o=>r(n,o,a)),a}const YV=t=>(e,r)=>{const n=I.useContext(Uk),i=I.useContext(m1),s=()=>Sle(t,e,n,i);return r?s():ZV(s)};function kle(t,e,r,n){const i={},s=n(t,{});for(const w in s)i[w]=vS(s[w]);let{initial:a,animate:o}=t;const d=Hk(t),m=LV(t);e&&m&&!d&&t.inherit!==!1&&(a===void 0&&(a=e.initial),o===void 0&&(o=e.animate));let y=r?r.initial===!1:!1;y=y||a===!1;const v=y?o:a;return v&&typeof v!="boolean"&&!Qk(v)&&(Array.isArray(v)?v:[v]).forEach(O=>{const P=O5(t,O);if(!P)return;const{transitionEnd:E,transition:$,...R}=P;for(const F in R){let D=R[F];if(Array.isArray(D)){const U=y?D.length-1:0;D=D[U]}D!==null&&(i[F]=D)}for(const F in E)i[F]=E[F]}),i}const Wi=t=>t;class s4{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const r=this.order.indexOf(e);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function Cle(t){let e=new s4,r=new s4,n=0,i=!1,s=!1;const a=new WeakSet,o={schedule:(d,m=!1,y=!1)=>{const v=y&&i,w=v?e:r;return m&&a.add(d),w.add(d)&&v&&i&&(n=e.order.length),d},cancel:d=>{r.remove(d),a.delete(d)},process:d=>{if(i){s=!0;return}if(i=!0,[e,r]=[r,e],r.clear(),n=e.order.length,n)for(let m=0;m<n;m++){const y=e.order[m];y(d),a.has(y)&&(o.schedule(y),t())}i=!1,s&&(s=!1,o.process(d))}};return o}const pw=["prepare","read","update","preRender","render","postRender"],Tle=40;function Ole(t,e){let r=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=pw.reduce((v,w)=>(v[w]=Cle(()=>r=!0),v),{}),a=v=>s[v].process(i),o=()=>{const v=performance.now();r=!1,i.delta=n?1e3/60:Math.max(Math.min(v-i.timestamp,Tle),1),i.timestamp=v,i.isProcessing=!0,pw.forEach(a),i.isProcessing=!1,r&&e&&(n=!1,t(o))},d=()=>{r=!0,n=!0,i.isProcessing||t(o)};return{schedule:pw.reduce((v,w)=>{const O=s[w];return v[w]=(P,E=!1,$=!1)=>(r||d(),O.schedule(P,E,$)),v},{}),cancel:v=>pw.forEach(w=>s[w].cancel(v)),state:i,steps:s}}const{schedule:ii,cancel:wh,state:wo,steps:AO}=Ole(typeof requestAnimationFrame<"u"?requestAnimationFrame:Wi,!0),jle={useVisualState:YV({scrapeMotionValuesFromProps:KV,createRenderState:QV,onMount:(t,e,{renderState:r,latestValues:n})=>{ii.read(()=>{try{r.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),ii.render(()=>{k5(r,n,{enableHardwareAcceleration:!1},C5(e.tagName),t.transformTemplate),XV(e,r)})}})},Ple={useVisualState:YV({scrapeMotionValuesFromProps:T5,createRenderState:S5})};function Ale(t,{forwardMotionProps:e=!1},r,n){return{..._5(t)?jle:Ple,preloadedFeatures:r,useRender:ble(e),createVisualElement:n,Component:t}}function lh(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}const JV=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function Xk(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const Ele=t=>e=>JV(e)&&t(e,Xk(e));function dh(t,e,r,n){return lh(t,e,Ele(r),n)}const zle=(t,e)=>r=>e(t(r)),Qd=(...t)=>t.reduce(zle);function e9(t){let e=null;return()=>{const r=()=>{e=null};return e===null?(e=t,r):!1}}const o4=e9("dragHorizontal"),a4=e9("dragVertical");function t9(t){let e=!1;if(t==="y")e=a4();else if(t==="x")e=o4();else{const r=o4(),n=a4();r&&n?e=()=>{r(),n()}:(r&&r(),n&&n())}return e}function r9(){const t=t9(!0);return t?(t(),!1):!0}class _f{constructor(e){this.isMounted=!1,this.node=e}update(){}}function l4(t,e){const r="pointer"+(e?"enter":"leave"),n="onHover"+(e?"Start":"End"),i=(s,a)=>{if(s.pointerType==="touch"||r9())return;const o=t.getProps();t.animationState&&o.whileHover&&t.animationState.setActive("whileHover",e),o[n]&&ii.update(()=>o[n](s,a))};return dh(t.current,r,i,{passive:!t.getProps()[n]})}class Mle extends _f{mount(){this.unmount=Qd(l4(this.node,!0),l4(this.node,!1))}unmount(){}}class Ile extends _f{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Qd(lh(this.node.current,"focus",()=>this.onFocus()),lh(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const n9=(t,e)=>e?t===e?!0:n9(t,e.parentElement):!1;function EO(t,e){if(!e)return;const r=new PointerEvent("pointer"+t);e(r,Xk(r))}class Rle extends _f{constructor(){super(...arguments),this.removeStartListeners=Wi,this.removeEndListeners=Wi,this.removeAccessibleListeners=Wi,this.startPointerPress=(e,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),s=dh(window,"pointerup",(o,d)=>{if(!this.checkPressEnd())return;const{onTap:m,onTapCancel:y,globalTapTarget:v}=this.node.getProps();ii.update(()=>{!v&&!n9(this.node.current,o.target)?y&&y(o,d):m&&m(o,d)})},{passive:!(n.onTap||n.onPointerUp)}),a=dh(window,"pointercancel",(o,d)=>this.cancelPress(o,d),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Qd(s,a),this.startPress(e,r)},this.startAccessiblePress=()=>{const e=s=>{if(s.key!=="Enter"||this.isPressing)return;const a=o=>{o.key!=="Enter"||!this.checkPressEnd()||EO("up",(d,m)=>{const{onTap:y}=this.node.getProps();y&&ii.update(()=>y(d,m))})};this.removeEndListeners(),this.removeEndListeners=lh(this.node.current,"keyup",a),EO("down",(o,d)=>{this.startPress(o,d)})},r=lh(this.node.current,"keydown",e),n=()=>{this.isPressing&&EO("cancel",(s,a)=>this.cancelPress(s,a))},i=lh(this.node.current,"blur",n);this.removeAccessibleListeners=Qd(r,i)}}startPress(e,r){this.isPressing=!0;const{onTapStart:n,whileTap:i}=this.node.getProps();i&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&ii.update(()=>n(e,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!r9()}cancelPress(e,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&ii.update(()=>n(e,r))}mount(){const e=this.node.getProps(),r=dh(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),n=lh(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Qd(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const sA=new WeakMap,zO=new WeakMap,Dle=t=>{const e=sA.get(t.target);e&&e(t)},Lle=t=>{t.forEach(Dle)};function Fle({root:t,...e}){const r=t||document;zO.has(r)||zO.set(r,{});const n=zO.get(r),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(Lle,{root:t,...e})),n[i]}function Ble(t,e,r){const n=Fle(e);return sA.set(t,r),n.observe(t),()=>{sA.delete(t),n.unobserve(t)}}const $le={some:0,all:1};class Nle extends _f{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:i="some",once:s}=e,a={root:r?r.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:$le[i]},o=d=>{const{isIntersecting:m}=d;if(this.isInView===m||(this.isInView=m,s&&!m&&this.hasEnteredView))return;m&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",m);const{onViewportEnter:y,onViewportLeave:v}=this.node.getProps(),w=m?y:v;w&&w(d)};return Ble(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(Vle(e,r))&&this.startObserver()}unmount(){}}function Vle({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const Wle={inView:{Feature:Nle},tap:{Feature:Rle},focus:{Feature:Ile},hover:{Feature:Mle}};function i9(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Ule(t){const e={};return t.values.forEach((r,n)=>e[n]=r.get()),e}function qle(t){const e={};return t.values.forEach((r,n)=>e[n]=r.getVelocity()),e}function Kk(t,e,r){const n=t.getProps();return O5(n,e,r!==void 0?r:n.custom,Ule(t),qle(t))}let j5=Wi;const Bp=t=>t*1e3,fh=t=>t/1e3,Qle={current:!1},s9=t=>Array.isArray(t)&&typeof t[0]=="number";function o9(t){return!!(!t||typeof t=="string"&&a9[t]||s9(t)||Array.isArray(t)&&t.every(o9))}const cv=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,a9={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cv([0,.65,.55,1]),circOut:cv([.55,0,1,.45]),backIn:cv([.31,.01,.66,-.59]),backOut:cv([.33,1.53,.69,.99])};function l9(t){if(t)return s9(t)?cv(t):Array.isArray(t)?t.map(l9):a9[t]}function Hle(t,e,r,{delay:n=0,duration:i,repeat:s=0,repeatType:a="loop",ease:o,times:d}={}){const m={[e]:r};d&&(m.offset=d);const y=l9(o);return Array.isArray(y)&&(m.easing=y),t.animate(m,{delay:n,duration:i,easing:Array.isArray(y)?"linear":y,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}function Gle(t,{repeat:e,repeatType:r="loop"}){const n=e&&r!=="loop"&&e%2===1?0:t.length-1;return t[n]}const c9=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,Xle=1e-7,Kle=12;function Zle(t,e,r,n,i){let s,a,o=0;do a=e+(r-e)/2,s=c9(a,n,i)-t,s>0?r=a:e=a;while(Math.abs(s)>Xle&&++o<Kle);return a}function v1(t,e,r,n){if(t===e&&r===n)return Wi;const i=s=>Zle(s,0,1,t,r);return s=>s===0||s===1?s:c9(i(s),e,n)}const Yle=v1(.42,0,1,1),Jle=v1(0,0,.58,1),u9=v1(.42,0,.58,1),ece=t=>Array.isArray(t)&&typeof t[0]!="number",h9=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,d9=t=>e=>1-t(1-e),P5=t=>1-Math.sin(Math.acos(t)),f9=d9(P5),tce=h9(P5),p9=v1(.33,1.53,.69,.99),A5=d9(p9),rce=h9(A5),nce=t=>(t*=2)<1?.5*A5(t):.5*(2-Math.pow(2,-10*(t-1))),ice={linear:Wi,easeIn:Yle,easeInOut:u9,easeOut:Jle,circIn:P5,circInOut:tce,circOut:f9,backIn:A5,backInOut:rce,backOut:p9,anticipate:nce},c4=t=>{if(Array.isArray(t)){j5(t.length===4);const[e,r,n,i]=t;return v1(e,r,n,i)}else if(typeof t=="string")return ice[t];return t},E5=(t,e)=>r=>!!(y1(r)&&ole.test(r)&&r.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(r,e)),m9=(t,e,r)=>n=>{if(!y1(n))return n;const[i,s,a,o]=n.match(Gk);return{[t]:parseFloat(i),[e]:parseFloat(s),[r]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},sce=t=>rf(0,255,t),MO={..._m,transform:t=>Math.round(sce(t))},vp={test:E5("rgb","red"),parse:m9("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+MO.transform(t)+", "+MO.transform(e)+", "+MO.transform(r)+", "+Lv(Dv.transform(n))+")"};function oce(t){let e="",r="",n="",i="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),i=t.substring(4,5),e+=e,r+=r,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const oA={test:E5("#"),parse:oce,transform:vp.transform},Qg={test:E5("hsl","hue"),parse:m9("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+yu.transform(Lv(e))+", "+yu.transform(Lv(r))+", "+Lv(Dv.transform(n))+")"},Fo={test:t=>vp.test(t)||oA.test(t)||Qg.test(t),parse:t=>vp.test(t)?vp.parse(t):Qg.test(t)?Qg.parse(t):oA.parse(t),transform:t=>y1(t)?t:t.hasOwnProperty("red")?vp.transform(t):Qg.transform(t)},Ti=(t,e,r)=>-r*t+r*e+t;function IO(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function ace({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let i=0,s=0,a=0;if(!e)i=s=a=r;else{const o=r<.5?r*(1+e):r+e-r*e,d=2*r-o;i=IO(d,o,t+1/3),s=IO(d,o,t),a=IO(d,o,t-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:n}}const RO=(t,e,r)=>{const n=t*t;return Math.sqrt(Math.max(0,r*(e*e-n)+n))},lce=[oA,vp,Qg],cce=t=>lce.find(e=>e.test(t));function u4(t){const e=cce(t);let r=e.parse(t);return e===Qg&&(r=ace(r)),r}const g9=(t,e)=>{const r=u4(t),n=u4(e),i={...r};return s=>(i.red=RO(r.red,n.red,s),i.green=RO(r.green,n.green,s),i.blue=RO(r.blue,n.blue,s),i.alpha=Ti(r.alpha,n.alpha,s),vp.transform(i))};function uce(t){var e,r;return isNaN(t)&&y1(t)&&(((e=t.match(Gk))===null||e===void 0?void 0:e.length)||0)+(((r=t.match(VV))===null||r===void 0?void 0:r.length)||0)>0}const y9={regex:ile,countKey:"Vars",token:"${v}",parse:Wi},x9={regex:VV,countKey:"Colors",token:"${c}",parse:Fo.parse},v9={regex:Gk,countKey:"Numbers",token:"${n}",parse:_m.parse};function DO(t,{regex:e,countKey:r,token:n,parse:i}){const s=t.tokenised.match(e);s&&(t["num"+r]=s.length,t.tokenised=t.tokenised.replace(e,n),t.values.push(...s.map(i)))}function x2(t){const e=t.toString(),r={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&DO(r,y9),DO(r,x9),DO(r,v9),r}function b9(t){return x2(t).values}function _9(t){const{values:e,numColors:r,numVars:n,tokenised:i}=x2(t),s=e.length;return a=>{let o=i;for(let d=0;d<s;d++)d<n?o=o.replace(y9.token,a[d]):d<n+r?o=o.replace(x9.token,Fo.transform(a[d])):o=o.replace(v9.token,Lv(a[d]));return o}}const hce=t=>typeof t=="number"?0:t;function dce(t){const e=b9(t);return _9(t)(e.map(hce))}const nf={test:uce,parse:b9,createTransformer:_9,getAnimatableNone:dce},w9=(t,e)=>r=>`${r>0?e:t}`;function S9(t,e){return typeof t=="number"?r=>Ti(t,e,r):Fo.test(t)?g9(t,e):t.startsWith("var(")?w9(t,e):C9(t,e)}const k9=(t,e)=>{const r=[...t],n=r.length,i=t.map((s,a)=>S9(s,e[a]));return s=>{for(let a=0;a<n;a++)r[a]=i[a](s);return r}},fce=(t,e)=>{const r={...t,...e},n={};for(const i in r)t[i]!==void 0&&e[i]!==void 0&&(n[i]=S9(t[i],e[i]));return i=>{for(const s in n)r[s]=n[s](i);return r}},C9=(t,e)=>{const r=nf.createTransformer(e),n=x2(t),i=x2(e);return n.numVars===i.numVars&&n.numColors===i.numColors&&n.numNumbers>=i.numNumbers?Qd(k9(n.values,i.values),r):w9(t,e)},Sb=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n},h4=(t,e)=>r=>Ti(t,e,r);function pce(t){return typeof t=="number"?h4:typeof t=="string"?Fo.test(t)?g9:C9:Array.isArray(t)?k9:typeof t=="object"?fce:h4}function mce(t,e,r){const n=[],i=r||pce(t[0]),s=t.length-1;for(let a=0;a<s;a++){let o=i(t[a],t[a+1]);if(e){const d=Array.isArray(e)?e[a]||Wi:e;o=Qd(d,o)}n.push(o)}return n}function T9(t,e,{clamp:r=!0,ease:n,mixer:i}={}){const s=t.length;if(j5(s===e.length),s===1)return()=>e[0];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=mce(e,n,i),o=a.length,d=m=>{let y=0;if(o>1)for(;y<t.length-2&&!(m<t[y+1]);y++);const v=Sb(t[y],t[y+1],m);return a[y](v)};return r?m=>d(rf(t[0],t[s-1],m)):d}function gce(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const i=Sb(0,e,n);t.push(Ti(r,1,i))}}function yce(t){const e=[0];return gce(e,t.length-1),e}function xce(t,e){return t.map(r=>r*e)}function vce(t,e){return t.map(()=>e||u9).splice(0,t.length-1)}function v2({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const i=ece(n)?n.map(c4):c4(n),s={done:!1,value:e[0]},a=xce(r&&r.length===e.length?r:yce(e),t),o=T9(a,e,{ease:Array.isArray(i)?i:vce(e,i)});return{calculatedDuration:t,next:d=>(s.value=o(d),s.done=d>=t,s)}}function O9(t,e){return e?t*(1e3/e):0}const bce=5;function j9(t,e,r){const n=Math.max(e-bce,0);return O9(r-t(n),e-n)}const LO=.001,_ce=.01,wce=10,Sce=.05,kce=1;function Cce({duration:t=800,bounce:e=.25,velocity:r=0,mass:n=1}){let i,s,a=1-e;a=rf(Sce,kce,a),t=rf(_ce,wce,fh(t)),a<1?(i=m=>{const y=m*a,v=y*t,w=y-r,O=aA(m,a),P=Math.exp(-v);return LO-w/O*P},s=m=>{const v=m*a*t,w=v*r+r,O=Math.pow(a,2)*Math.pow(m,2)*t,P=Math.exp(-v),E=aA(Math.pow(m,2),a);return(-i(m)+LO>0?-1:1)*((w-O)*P)/E}):(i=m=>{const y=Math.exp(-m*t),v=(m-r)*t+1;return-LO+y*v},s=m=>{const y=Math.exp(-m*t),v=(r-m)*(t*t);return y*v});const o=5/t,d=Oce(i,s,o);if(t=Bp(t),isNaN(d))return{stiffness:100,damping:10,duration:t};{const m=Math.pow(d,2)*n;return{stiffness:m,damping:a*2*Math.sqrt(n*m),duration:t}}}const Tce=12;function Oce(t,e,r){let n=r;for(let i=1;i<Tce;i++)n=n-t(n)/e(n);return n}function aA(t,e){return t*Math.sqrt(1-e*e)}const jce=["duration","bounce"],Pce=["stiffness","damping","mass"];function d4(t,e){return e.some(r=>t[r]!==void 0)}function Ace(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!d4(t,Pce)&&d4(t,jce)){const r=Cce(t);e={...e,...r,mass:1},e.isResolvedFromDuration=!0}return e}function P9({keyframes:t,restDelta:e,restSpeed:r,...n}){const i=t[0],s=t[t.length-1],a={done:!1,value:i},{stiffness:o,damping:d,mass:m,duration:y,velocity:v,isResolvedFromDuration:w}=Ace({...n,velocity:-fh(n.velocity||0)}),O=v||0,P=d/(2*Math.sqrt(o*m)),E=s-i,$=fh(Math.sqrt(o/m)),R=Math.abs(E)<5;r||(r=R?.01:2),e||(e=R?.005:.5);let F;if(P<1){const D=aA($,P);F=U=>{const X=Math.exp(-P*$*U);return s-X*((O+P*$*E)/D*Math.sin(D*U)+E*Math.cos(D*U))}}else if(P===1)F=D=>s-Math.exp(-$*D)*(E+(O+$*E)*D);else{const D=$*Math.sqrt(P*P-1);F=U=>{const X=Math.exp(-P*$*U),ee=Math.min(D*U,300);return s-X*((O+P*$*E)*Math.sinh(ee)+D*E*Math.cosh(ee))/D}}return{calculatedDuration:w&&y||null,next:D=>{const U=F(D);if(w)a.done=D>=y;else{let X=O;D!==0&&(P<1?X=j9(F,D,U):X=0);const ee=Math.abs(X)<=r,K=Math.abs(s-U)<=e;a.done=ee&&K}return a.value=a.done?s:U,a}}}function f4({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:d,restDelta:m=.5,restSpeed:y}){const v=t[0],w={done:!1,value:v},O=Y=>o!==void 0&&Y<o||d!==void 0&&Y>d,P=Y=>o===void 0?d:d===void 0||Math.abs(o-Y)<Math.abs(d-Y)?o:d;let E=r*e;const $=v+E,R=a===void 0?$:a($);R!==$&&(E=R-v);const F=Y=>-E*Math.exp(-Y/n),D=Y=>R+F(Y),U=Y=>{const ne=F(Y),oe=D(Y);w.done=Math.abs(ne)<=m,w.value=w.done?R:oe};let X,ee;const K=Y=>{O(w.value)&&(X=Y,ee=P9({keyframes:[w.value,P(w.value)],velocity:j9(D,Y,w.value),damping:i,stiffness:s,restDelta:m,restSpeed:y}))};return K(0),{calculatedDuration:null,next:Y=>{let ne=!1;return!ee&&X===void 0&&(ne=!0,U(Y),K(Y)),X!==void 0&&Y>X?ee.next(Y-X):(!ne&&U(Y),w)}}}const Ece=t=>{const e=({timestamp:r})=>t(r);return{start:()=>ii.update(e,!0),stop:()=>wh(e),now:()=>wo.isProcessing?wo.timestamp:performance.now()}},p4=2e4;function m4(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<p4;)e+=r,n=t.next(e);return e>=p4?1/0:e}const zce={decay:f4,inertia:f4,tween:v2,keyframes:v2,spring:P9};function b2({autoplay:t=!0,delay:e=0,driver:r=Ece,keyframes:n,type:i="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:o="loop",onPlay:d,onStop:m,onComplete:y,onUpdate:v,...w}){let O=1,P=!1,E,$;const R=()=>{$=new Promise(Le=>{E=Le})};R();let F;const D=zce[i]||v2;let U;D!==v2&&typeof n[0]!="number"&&(U=T9([0,100],n,{clamp:!1}),n=[0,100]);const X=D({...w,keyframes:n});let ee;o==="mirror"&&(ee=D({...w,keyframes:[...n].reverse(),velocity:-(w.velocity||0)}));let K="idle",Y=null,ne=null,oe=null;X.calculatedDuration===null&&s&&(X.calculatedDuration=m4(X));const{calculatedDuration:ce}=X;let Xe=1/0,Ae=1/0;ce!==null&&(Xe=ce+a,Ae=Xe*(s+1)-a);let We=0;const Ye=Le=>{if(ne===null)return;O>0&&(ne=Math.min(ne,Le)),O<0&&(ne=Math.min(Le-Ae/O,ne)),Y!==null?We=Y:We=Math.round(Le-ne)*O;const Oe=We-e*(O>=0?1:-1),Ie=O>=0?Oe<0:Oe>Ae;We=Math.max(Oe,0),K==="finished"&&Y===null&&(We=Ae);let st=We,Re=X;if(s){const Mt=Math.min(We,Ae)/Xe;let Et=Math.floor(Mt),xt=Mt%1;!xt&&Mt>=1&&(xt=1),xt===1&&Et--,Et=Math.min(Et,s+1),!!(Et%2)&&(o==="reverse"?(xt=1-xt,a&&(xt-=a/Xe)):o==="mirror"&&(Re=ee)),st=rf(0,1,xt)*Xe}const it=Ie?{done:!1,value:n[0]}:Re.next(st);U&&(it.value=U(it.value));let{done:Ke}=it;!Ie&&ce!==null&&(Ke=O>=0?We>=Ae:We<=0);const St=Y===null&&(K==="finished"||K==="running"&&Ke);return v&&v(it.value),St&&Me(),it},tt=()=>{F&&F.stop(),F=void 0},Be=()=>{K="idle",tt(),E(),R(),ne=oe=null},Me=()=>{K="finished",y&&y(),tt(),E()},Ge=()=>{if(P)return;F||(F=r(Ye));const Le=F.now();d&&d(),Y!==null?ne=Le-Y:(!ne||K==="finished")&&(ne=Le),K==="finished"&&R(),oe=ne,Y=null,K="running",F.start()};t&&Ge();const De={then(Le,Oe){return $.then(Le,Oe)},get time(){return fh(We)},set time(Le){Le=Bp(Le),We=Le,Y!==null||!F||O===0?Y=Le:ne=F.now()-Le/O},get duration(){const Le=X.calculatedDuration===null?m4(X):X.calculatedDuration;return fh(Le)},get speed(){return O},set speed(Le){Le===O||!F||(O=Le,De.time=fh(We))},get state(){return K},play:Ge,pause:()=>{K="paused",Y=We},stop:()=>{P=!0,K!=="idle"&&(K="idle",m&&m(),Be())},cancel:()=>{oe!==null&&Ye(oe),Be()},complete:()=>{K="finished"},sample:Le=>(ne=0,Ye(Le))};return De}function Mce(t){let e;return()=>(e===void 0&&(e=t()),e)}const Ice=Mce(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Rce=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),mw=10,Dce=2e4,Lce=(t,e)=>e.type==="spring"||t==="backgroundColor"||!o9(e.ease);function Fce(t,e,{onUpdate:r,onComplete:n,...i}){if(!(Ice()&&Rce.has(e)&&!i.repeatDelay&&i.repeatType!=="mirror"&&i.damping!==0&&i.type!=="inertia"))return!1;let a=!1,o,d,m=!1;const y=()=>{d=new Promise(D=>{o=D})};y();let{keyframes:v,duration:w=300,ease:O,times:P}=i;if(Lce(e,i)){const D=b2({...i,repeat:0,delay:0});let U={done:!1,value:v[0]};const X=[];let ee=0;for(;!U.done&&ee<Dce;)U=D.sample(ee),X.push(U.value),ee+=mw;P=void 0,v=X,w=ee-mw,O="linear"}const E=Hle(t.owner.current,e,v,{...i,duration:w,ease:O,times:P}),$=()=>{m=!1,E.cancel()},R=()=>{m=!0,ii.update($),o(),y()};return E.onfinish=()=>{m||(t.set(Gle(v,i)),n&&n(),R())},{then(D,U){return d.then(D,U)},attachTimeline(D){return E.timeline=D,E.onfinish=null,Wi},get time(){return fh(E.currentTime||0)},set time(D){E.currentTime=Bp(D)},get speed(){return E.playbackRate},set speed(D){E.playbackRate=D},get duration(){return fh(w)},play:()=>{a||(E.play(),wh($))},pause:()=>E.pause(),stop:()=>{if(a=!0,E.playState==="idle")return;const{currentTime:D}=E;if(D){const U=b2({...i,autoplay:!1});t.setWithVelocity(U.sample(D-mw).value,U.sample(D).value,mw)}R()},complete:()=>{m||E.finish()},cancel:R}}function Bce({keyframes:t,delay:e,onUpdate:r,onComplete:n}){const i=()=>(r&&r(t[t.length-1]),n&&n(),{time:0,speed:1,duration:0,play:Wi,pause:Wi,stop:Wi,then:s=>(s(),Promise.resolve()),cancel:Wi,complete:Wi});return e?b2({keyframes:[0,1],duration:0,delay:e,onComplete:i}):i()}const $ce={type:"spring",stiffness:500,damping:25,restSpeed:10},Nce=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Vce={type:"keyframes",duration:.8},Wce={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Uce=(t,{keyframes:e})=>e.length>2?Vce:bm.has(t)?t.startsWith("scale")?Nce(e[1]):$ce:Wce,lA=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(nf.test(e)||e==="0")&&!e.startsWith("url(")),qce=new Set(["brightness","contrast","saturate","opacity"]);function Qce(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(Gk)||[];if(!n)return t;const i=r.replace(n,"");let s=qce.has(e)?1:0;return n!==r&&(s*=100),e+"("+s+i+")"}const Hce=/([a-z-]*)\(.*?\)/g,cA={...nf,getAnimatableNone:t=>{const e=t.match(Hce);return e?e.map(Qce).join(" "):t}},Gce={...WV,color:Fo,backgroundColor:Fo,outlineColor:Fo,fill:Fo,stroke:Fo,borderColor:Fo,borderTopColor:Fo,borderRightColor:Fo,borderBottomColor:Fo,borderLeftColor:Fo,filter:cA,WebkitFilter:cA},z5=t=>Gce[t];function A9(t,e){let r=z5(t);return r!==cA&&(r=nf),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const E9=t=>/^0[^.\s]+$/.test(t);function Xce(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||E9(t)}function Kce(t,e,r,n){const i=lA(e,r);let s;Array.isArray(r)?s=[...r]:s=[null,r];const a=n.from!==void 0?n.from:t.get();let o;const d=[];for(let m=0;m<s.length;m++)s[m]===null&&(s[m]=m===0?a:s[m-1]),Xce(s[m])&&d.push(m),typeof s[m]=="string"&&s[m]!=="none"&&s[m]!=="0"&&(o=s[m]);if(i&&d.length&&o)for(let m=0;m<d.length;m++){const y=d[m];s[y]=A9(e,o)}return s}function Zce({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:d,elapsed:m,...y}){return!!Object.keys(y).length}function M5(t,e){return t[e]||t.default||t}const Yce={skipAnimations:!1},I5=(t,e,r,n={})=>i=>{const s=M5(n,t)||{},a=s.delay||n.delay||0;let{elapsed:o=0}=n;o=o-Bp(a);const d=Kce(e,t,r,s),m=d[0],y=d[d.length-1],v=lA(t,m),w=lA(t,y);let O={keyframes:d,velocity:e.getVelocity(),ease:"easeOut",...s,delay:-o,onUpdate:P=>{e.set(P),s.onUpdate&&s.onUpdate(P)},onComplete:()=>{i(),s.onComplete&&s.onComplete()}};if(Zce(s)||(O={...O,...Uce(t,O)}),O.duration&&(O.duration=Bp(O.duration)),O.repeatDelay&&(O.repeatDelay=Bp(O.repeatDelay)),!v||!w||Qle.current||s.type===!1||Yce.skipAnimations)return Bce(O);if(!n.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const P=Fce(e,t,O);if(P)return P}return b2(O)};function _2(t){return!!(Ea(t)&&t.add)}const z9=t=>/^\-?\d*\.?\d+$/.test(t);function R5(t,e){t.indexOf(e)===-1&&t.push(e)}function D5(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}class L5{constructor(){this.subscriptions=[]}add(e){return R5(this.subscriptions,e),()=>D5(this.subscriptions,e)}notify(e,r,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,r,n);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Jce=t=>!isNaN(parseFloat(t));class eue{constructor(e,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,i=!0)=>{this.prev=this.current,this.current=n;const{delta:s,timestamp:a}=wo;this.lastUpdated!==a&&(this.timeDelta=s,this.lastUpdated=a,ii.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>ii.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=Jce(this.current),this.owner=r.owner}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new L5);const n=this.events[e].add(r);return e==="change"?()=>{n(),ii.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e,r=!0){!r||!this.passiveEffect?this.updateAndNotify(e,r):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,r,n){this.set(r),this.prev=e,this.timeDelta=n}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?O9(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Gy(t,e){return new eue(t,e)}const M9=t=>e=>e.test(t),tue={test:t=>t==="auto",parse:t=>t},I9=[_m,Dr,yu,dd,lle,ale,tue],Vx=t=>I9.find(M9(t)),rue=[...I9,Fo,nf],nue=t=>rue.find(M9(t));function iue(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,Gy(r))}function sue(t,e){const r=Kk(t,e);let{transitionEnd:n={},transition:i={},...s}=r?t.makeTargetAnimatable(r,!1):{};s={...s,...n};for(const a in s){const o=wle(s[a]);iue(t,a,o)}}function oue(t,e,r){var n,i;const s=Object.keys(e).filter(o=>!t.hasValue(o)),a=s.length;if(a)for(let o=0;o<a;o++){const d=s[o],m=e[d];let y=null;Array.isArray(m)&&(y=m[0]),y===null&&(y=(i=(n=r[d])!==null&&n!==void 0?n:t.readValue(d))!==null&&i!==void 0?i:e[d]),y!=null&&(typeof y=="string"&&(z9(y)||E9(y))?y=parseFloat(y):!nue(y)&&nf.test(m)&&(y=A9(d,m)),t.addValue(d,Gy(y,{owner:t})),r[d]===void 0&&(r[d]=y),y!==null&&t.setBaseTarget(d,y))}}function aue(t,e){return e?(e[t]||e.default||e).from:void 0}function lue(t,e,r){const n={};for(const i in t){const s=aue(i,e);if(s!==void 0)n[i]=s;else{const a=r.getValue(i);a&&(n[i]=a.get())}}return n}function cue({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function uue(t,e){const r=t.get();if(Array.isArray(e)){for(let n=0;n<e.length;n++)if(e[n]!==r)return!0}else return r!==e}function R9(t,e,{delay:r=0,transitionOverride:n,type:i}={}){let{transition:s=t.getDefaultTransition(),transitionEnd:a,...o}=t.makeTargetAnimatable(e);const d=t.getValue("willChange");n&&(s=n);const m=[],y=i&&t.animationState&&t.animationState.getState()[i];for(const v in o){const w=t.getValue(v),O=o[v];if(!w||O===void 0||y&&cue(y,v))continue;const P={delay:r,elapsed:0,...M5(s||{},v)};if(window.HandoffAppearAnimations){const R=t.getProps()[DV];if(R){const F=window.HandoffAppearAnimations(R,v,w,ii);F!==null&&(P.elapsed=F,P.isHandoff=!0)}}let E=!P.isHandoff&&!uue(w,O);if(P.type==="spring"&&(w.getVelocity()||P.velocity)&&(E=!1),w.animation&&(E=!1),E)continue;w.start(I5(v,w,O,t.shouldReduceMotion&&bm.has(v)?{type:!1}:P));const $=w.animation;_2(d)&&(d.add(v),$.then(()=>d.remove(v))),m.push($)}return a&&Promise.all(m).then(()=>{a&&sue(t,a)}),m}function uA(t,e,r={}){const n=Kk(t,e,r.custom);let{transition:i=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(i=r.transitionOverride);const s=n?()=>Promise.all(R9(t,n,r)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(d=0)=>{const{delayChildren:m=0,staggerChildren:y,staggerDirection:v}=i;return hue(t,e,m+d,y,v,r)}:()=>Promise.resolve(),{when:o}=i;if(o){const[d,m]=o==="beforeChildren"?[s,a]:[a,s];return d().then(()=>m())}else return Promise.all([s(),a(r.delay)])}function hue(t,e,r=0,n=0,i=1,s){const a=[],o=(t.variantChildren.size-1)*n,d=i===1?(m=0)=>m*n:(m=0)=>o-m*n;return Array.from(t.variantChildren).sort(due).forEach((m,y)=>{m.notify("AnimationStart",e),a.push(uA(m,e,{...s,delay:r+d(y)}).then(()=>m.notify("AnimationComplete",e)))}),Promise.all(a)}function due(t,e){return t.sortNodePosition(e)}function fue(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const i=e.map(s=>uA(t,s,r));n=Promise.all(i)}else if(typeof e=="string")n=uA(t,e,r);else{const i=typeof e=="function"?Kk(t,e,r.custom):e;n=Promise.all(R9(t,i,r))}return n.then(()=>t.notify("AnimationComplete",e))}const pue=[...x5].reverse(),mue=x5.length;function gue(t){return e=>Promise.all(e.map(({animation:r,options:n})=>fue(t,r,n)))}function yue(t){let e=gue(t);const r=vue();let n=!0;const i=(d,m)=>{const y=Kk(t,m);if(y){const{transition:v,transitionEnd:w,...O}=y;d={...d,...O,...w}}return d};function s(d){e=d(t)}function a(d,m){const y=t.getProps(),v=t.getVariantContext(!0)||{},w=[],O=new Set;let P={},E=1/0;for(let R=0;R<mue;R++){const F=pue[R],D=r[F],U=y[F]!==void 0?y[F]:v[F],X=_b(U),ee=F===m?D.isActive:null;ee===!1&&(E=R);let K=U===v[F]&&U!==y[F]&&X;if(K&&n&&t.manuallyAnimateOnMount&&(K=!1),D.protectedKeys={...P},!D.isActive&&ee===null||!U&&!D.prevProp||Qk(U)||typeof U=="boolean")continue;let ne=xue(D.prevProp,U)||F===m&&D.isActive&&!K&&X||R>E&&X,oe=!1;const ce=Array.isArray(U)?U:[U];let Xe=ce.reduce(i,{});ee===!1&&(Xe={});const{prevResolvedValues:Ae={}}=D,We={...Ae,...Xe},Ye=tt=>{ne=!0,O.has(tt)&&(oe=!0,O.delete(tt)),D.needsAnimating[tt]=!0};for(const tt in We){const Be=Xe[tt],Me=Ae[tt];if(P.hasOwnProperty(tt))continue;let Ge=!1;y2(Be)&&y2(Me)?Ge=!i9(Be,Me):Ge=Be!==Me,Ge?Be!==void 0?Ye(tt):O.add(tt):Be!==void 0&&O.has(tt)?Ye(tt):D.protectedKeys[tt]=!0}D.prevProp=U,D.prevResolvedValues=Xe,D.isActive&&(P={...P,...Xe}),n&&t.blockInitialAnimation&&(ne=!1),ne&&(!K||oe)&&w.push(...ce.map(tt=>({animation:tt,options:{type:F,...d}})))}if(O.size){const R={};O.forEach(F=>{const D=t.getBaseTarget(F);D!==void 0&&(R[F]=D)}),w.push({animation:R})}let $=!!w.length;return n&&(y.initial===!1||y.initial===y.animate)&&!t.manuallyAnimateOnMount&&($=!1),n=!1,$?e(w):Promise.resolve()}function o(d,m,y){var v;if(r[d].isActive===m)return Promise.resolve();(v=t.variantChildren)===null||v===void 0||v.forEach(O=>{var P;return(P=O.animationState)===null||P===void 0?void 0:P.setActive(d,m)}),r[d].isActive=m;const w=a(y,d);for(const O in r)r[O].protectedKeys={};return w}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>r}}function xue(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!i9(e,t):!1}function rp(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function vue(){return{animate:rp(!0),whileInView:rp(),whileHover:rp(),whileTap:rp(),whileDrag:rp(),whileFocus:rp(),exit:rp()}}class bue extends _f{constructor(e){super(e),e.animationState||(e.animationState=yue(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),Qk(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let _ue=0;class wue extends _f{constructor(){super(...arguments),this.id=_ue++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const s=this.node.animationState.setActive("exit",!e,{custom:n??this.node.getProps().custom});r&&!e&&s.then(()=>r(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Sue={animation:{Feature:bue},exit:{Feature:wue}},g4=(t,e)=>Math.abs(t-e);function kue(t,e){const r=g4(t.x,e.x),n=g4(t.y,e.y);return Math.sqrt(r**2+n**2)}class D9{constructor(e,r,{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=BO(this.lastMoveEventInfo,this.history),w=this.startEvent!==null,O=kue(v.offset,{x:0,y:0})>=3;if(!w&&!O)return;const{point:P}=v,{timestamp:E}=wo;this.history.push({...P,timestamp:E});const{onStart:$,onMove:R}=this.handlers;w||($&&$(this.lastMoveEvent,v),this.startEvent=this.lastMoveEvent),R&&R(this.lastMoveEvent,v)},this.handlePointerMove=(v,w)=>{this.lastMoveEvent=v,this.lastMoveEventInfo=FO(w,this.transformPagePoint),ii.update(this.updatePoint,!0)},this.handlePointerUp=(v,w)=>{this.end();const{onEnd:O,onSessionEnd:P,resumeAnimation:E}=this.handlers;if(this.dragSnapToOrigin&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const $=BO(v.type==="pointercancel"?this.lastMoveEventInfo:FO(w,this.transformPagePoint),this.history);this.startEvent&&O&&O(v,$),P&&P(v,$)},!JV(e))return;this.dragSnapToOrigin=s,this.handlers=r,this.transformPagePoint=n,this.contextWindow=i||window;const a=Xk(e),o=FO(a,this.transformPagePoint),{point:d}=o,{timestamp:m}=wo;this.history=[{...d,timestamp:m}];const{onSessionStart:y}=r;y&&y(e,BO(o,this.history)),this.removeListeners=Qd(dh(this.contextWindow,"pointermove",this.handlePointerMove),dh(this.contextWindow,"pointerup",this.handlePointerUp),dh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),wh(this.updatePoint)}}function FO(t,e){return e?{point:e(t.point)}:t}function y4(t,e){return{x:t.x-e.x,y:t.y-e.y}}function BO({point:t},e){return{point:t,delta:y4(t,L9(e)),offset:y4(t,Cue(e)),velocity:Tue(e,.1)}}function Cue(t){return t[0]}function L9(t){return t[t.length-1]}function Tue(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const i=L9(t);for(;r>=0&&(n=t[r],!(i.timestamp-n.timestamp>Bp(e)));)r--;if(!n)return{x:0,y:0};const s=fh(i.timestamp-n.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-n.x)/s,y:(i.y-n.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function rl(t){return t.max-t.min}function hA(t,e=0,r=.01){return Math.abs(t-e)<=r}function x4(t,e,r,n=.5){t.origin=n,t.originPoint=Ti(e.min,e.max,t.origin),t.scale=rl(r)/rl(e),(hA(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=Ti(r.min,r.max,t.origin)-t.originPoint,(hA(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Fv(t,e,r,n){x4(t.x,e.x,r.x,n?n.originX:void 0),x4(t.y,e.y,r.y,n?n.originY:void 0)}function v4(t,e,r){t.min=r.min+e.min,t.max=t.min+rl(e)}function Oue(t,e,r){v4(t.x,e.x,r.x),v4(t.y,e.y,r.y)}function b4(t,e,r){t.min=e.min-r.min,t.max=t.min+rl(e)}function Bv(t,e,r){b4(t.x,e.x,r.x),b4(t.y,e.y,r.y)}function jue(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?Ti(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?Ti(r,t,n.max):Math.min(t,r)),t}function _4(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function Pue(t,{top:e,left:r,bottom:n,right:i}){return{x:_4(t.x,r,i),y:_4(t.y,e,n)}}function w4(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function Aue(t,e){return{x:w4(t.x,e.x),y:w4(t.y,e.y)}}function Eue(t,e){let r=.5;const n=rl(t),i=rl(e);return i>n?r=Sb(e.min,e.max-n,t.min):n>i&&(r=Sb(t.min,t.max-i,e.min)),rf(0,1,r)}function zue(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const dA=.35;function Mue(t=dA){return t===!1?t=0:t===!0&&(t=dA),{x:S4(t,"left","right"),y:S4(t,"top","bottom")}}function S4(t,e,r){return{min:k4(t,e),max:k4(t,r)}}function k4(t,e){return typeof t=="number"?t:t[e]||0}const C4=()=>({translate:0,scale:1,origin:0,originPoint:0}),Hg=()=>({x:C4(),y:C4()}),T4=()=>({min:0,max:0}),Yi=()=>({x:T4(),y:T4()});function bl(t){return[t("x"),t("y")]}function F9({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function Iue({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Rue(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function $O(t){return t===void 0||t===1}function fA({scale:t,scaleX:e,scaleY:r}){return!$O(t)||!$O(e)||!$O(r)}function ap(t){return fA(t)||B9(t)||t.z||t.rotate||t.rotateX||t.rotateY}function B9(t){return O4(t.x)||O4(t.y)}function O4(t){return t&&t!=="0%"}function w2(t,e,r){const n=t-r,i=e*n;return r+i}function j4(t,e,r,n,i){return i!==void 0&&(t=w2(t,i,n)),w2(t,r,n)+e}function pA(t,e=0,r=1,n,i){t.min=j4(t.min,e,r,n,i),t.max=j4(t.max,e,r,n,i)}function $9(t,{x:e,y:r}){pA(t.x,e.translate,e.scale,e.originPoint),pA(t.y,r.translate,r.scale,r.originPoint)}function Due(t,e,r,n=!1){const i=r.length;if(!i)return;e.x=e.y=1;let s,a;for(let o=0;o<i;o++){s=r[o],a=s.projectionDelta;const d=s.instance;d&&d.style&&d.style.display==="contents"||(n&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Gg(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,$9(t,a)),n&&ap(s.latestValues)&&Gg(t,s.latestValues))}e.x=P4(e.x),e.y=P4(e.y)}function P4(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function yd(t,e){t.min=t.min+e,t.max=t.max+e}function A4(t,e,[r,n,i]){const s=e[i]!==void 0?e[i]:.5,a=Ti(t.min,t.max,s);pA(t,e[r],e[n],a,e.scale)}const Lue=["x","scaleX","originX"],Fue=["y","scaleY","originY"];function Gg(t,e){A4(t.x,e,Lue),A4(t.y,e,Fue)}function N9(t,e){return F9(Rue(t.getBoundingClientRect(),e))}function Bue(t,e,r){const n=N9(t,r),{scroll:i}=e;return i&&(yd(n.x,i.offset.x),yd(n.y,i.offset.y)),n}const V9=({current:t})=>t?t.ownerDocument.defaultView:null,$ue=new WeakMap;class Nue{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Yi(),this.visualElement=e}start(e,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=y=>{const{dragSnapToOrigin:v}=this.getProps();v?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Xk(y,"page").point)},s=(y,v)=>{const{drag:w,dragPropagation:O,onDragStart:P}=this.getProps();if(w&&!O&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=t9(w),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),bl($=>{let R=this.getAxisMotionValue($).get()||0;if(yu.test(R)){const{projection:F}=this.visualElement;if(F&&F.layout){const D=F.layout.layoutBox[$];D&&(R=rl(D)*(parseFloat(R)/100))}}this.originPoint[$]=R}),P&&ii.update(()=>P(y,v),!1,!0);const{animationState:E}=this.visualElement;E&&E.setActive("whileDrag",!0)},a=(y,v)=>{const{dragPropagation:w,dragDirectionLock:O,onDirectionLock:P,onDrag:E}=this.getProps();if(!w&&!this.openGlobalLock)return;const{offset:$}=v;if(O&&this.currentDirection===null){this.currentDirection=Vue($),this.currentDirection!==null&&P&&P(this.currentDirection);return}this.updateAxis("x",v.point,$),this.updateAxis("y",v.point,$),this.visualElement.render(),E&&E(y,v)},o=(y,v)=>this.stop(y,v),d=()=>bl(y=>{var v;return this.getAnimationState(y)==="paused"&&((v=this.getAxisMotionValue(y).animation)===null||v===void 0?void 0:v.play())}),{dragSnapToOrigin:m}=this.getProps();this.panSession=new D9(e,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:m,contextWindow:V9(this.visualElement)})}stop(e,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=r;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&ii.update(()=>s(e,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:i}=this.getProps();if(!n||!gw(e,i,this.currentDirection))return;const s=this.getAxisMotionValue(e);let a=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(a=jue(a,this.constraints[e],this.elastic[e])),s.set(a)}resolveConstraints(){var e;const{dragConstraints:r,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,s=this.constraints;r&&qg(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&i?this.constraints=Pue(i.layoutBox,r):this.constraints=!1,this.elastic=Mue(n),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&bl(a=>{this.getAxisMotionValue(a)&&(this.constraints[a]=zue(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!qg(e))return!1;const n=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=Bue(n,i.root,this.visualElement.getTransformPagePoint());let a=Aue(i.layout.layoutBox,s);if(r){const o=r(Iue(a));this.hasMutatedConstraints=!!o,o&&(a=F9(o))}return a}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),d=this.constraints||{},m=bl(y=>{if(!gw(y,r,this.currentDirection))return;let v=d&&d[y]||{};a&&(v={min:0,max:0});const w=i?200:1e6,O=i?40:1e7,P={type:"inertia",velocity:n?e[y]:0,bounceStiffness:w,bounceDamping:O,timeConstant:750,restDelta:1,restSpeed:10,...s,...v};return this.startAxisValueAnimation(y,P)});return Promise.all(m).then(o)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return n.start(I5(e,n,0,r))}stopAnimation(){bl(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){bl(e=>{var r;return(r=this.getAxisMotionValue(e).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(e){const r="_drag"+e.toUpperCase(),n=this.visualElement.getProps(),i=n[r];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){bl(r=>{const{drag:n}=this.getProps();if(!gw(r,n,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(r);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[r];s.set(e[r]-Ti(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!qg(r)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};bl(a=>{const o=this.getAxisMotionValue(a);if(o){const d=o.get();i[a]=Eue({min:d,max:d},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),bl(a=>{if(!gw(a,e,null))return;const o=this.getAxisMotionValue(a),{min:d,max:m}=this.constraints[a];o.set(Ti(d,m,i[a]))})}addListeners(){if(!this.visualElement.current)return;$ue.set(this.visualElement,this);const e=this.visualElement.current,r=dh(e,"pointerdown",d=>{const{drag:m,dragListener:y=!0}=this.getProps();m&&y&&this.start(d)}),n=()=>{const{dragConstraints:d}=this.getProps();qg(d)&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),n();const a=lh(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",({delta:d,hasLayoutChanged:m})=>{this.isDragging&&m&&(bl(y=>{const v=this.getAxisMotionValue(y);v&&(this.originPoint[y]+=d[y].translate,v.set(v.get()+d[y].translate))}),this.visualElement.render())});return()=>{a(),r(),s(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=dA,dragMomentum:o=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function gw(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function Vue(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class Wue extends _f{constructor(e){super(e),this.removeGroupControls=Wi,this.removeListeners=Wi,this.controls=new Nue(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Wi}unmount(){this.removeGroupControls(),this.removeListeners()}}const E4=t=>(e,r)=>{t&&ii.update(()=>t(e,r))};class Uue extends _f{constructor(){super(...arguments),this.removePointerDownListener=Wi}onPointerDown(e){this.session=new D9(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:V9(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:E4(e),onStart:E4(r),onMove:n,onEnd:(s,a)=>{delete this.session,i&&ii.update(()=>i(s,a))}}}mount(){this.removePointerDownListener=dh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function W9(){const t=I.useContext(m1);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:r,register:n}=t,i=I.useId();return I.useEffect(()=>n(i),[]),!e&&r?[!1,()=>r&&r(i)]:[!0]}function que(){return Que(I.useContext(m1))}function Que(t){return t===null?!0:t.isPresent}const bS={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function z4(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Wx={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Dr.test(t))t=parseFloat(t);else return t;const r=z4(t,e.target.x),n=z4(t,e.target.y);return`${r}% ${n}%`}},Hue={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,i=nf.parse(t);if(i.length>5)return n;const s=nf.createTransformer(t),a=typeof i[0]!="number"?1:0,o=r.x.scale*e.x,d=r.y.scale*e.y;i[0+a]/=o,i[1+a]/=d;const m=Ti(o,d,.5);return typeof i[2+a]=="number"&&(i[2+a]/=m),typeof i[3+a]=="number"&&(i[3+a]/=m),s(i)}};class Gue extends $i.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:i}=this.props,{projection:s}=e;ele(Xue),s&&(r.group&&r.group.add(s),n&&n.register&&i&&n.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),bS.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:i,isPresent:s}=this.props,a=n.projection;return a&&(a.isPresent=s,i||e.layoutDependency!==r||r===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?a.promote():a.relegate()||ii.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function U9(t){const[e,r]=W9(),n=I.useContext(b5);return $i.createElement(Gue,{...t,layoutGroup:n,switchLayoutGroup:I.useContext(FV),isPresent:e,safeToRemove:r})}const Xue={borderRadius:{...Wx,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Wx,borderTopRightRadius:Wx,borderBottomLeftRadius:Wx,borderBottomRightRadius:Wx,boxShadow:Hue},q9=["TopLeft","TopRight","BottomLeft","BottomRight"],Kue=q9.length,M4=t=>typeof t=="string"?parseFloat(t):t,I4=t=>typeof t=="number"||Dr.test(t);function Zue(t,e,r,n,i,s){i?(t.opacity=Ti(0,r.opacity!==void 0?r.opacity:1,Yue(n)),t.opacityExit=Ti(e.opacity!==void 0?e.opacity:1,0,Jue(n))):s&&(t.opacity=Ti(e.opacity!==void 0?e.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let a=0;a<Kue;a++){const o=`border${q9[a]}Radius`;let d=R4(e,o),m=R4(r,o);if(d===void 0&&m===void 0)continue;d||(d=0),m||(m=0),d===0||m===0||I4(d)===I4(m)?(t[o]=Math.max(Ti(M4(d),M4(m),n),0),(yu.test(m)||yu.test(d))&&(t[o]+="%")):t[o]=m}(e.rotate||r.rotate)&&(t.rotate=Ti(e.rotate||0,r.rotate||0,n))}function R4(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Yue=Q9(0,.5,f9),Jue=Q9(.5,.95,Wi);function Q9(t,e,r){return n=>n<t?0:n>e?1:r(Sb(t,e,n))}function D4(t,e){t.min=e.min,t.max=e.max}function xl(t,e){D4(t.x,e.x),D4(t.y,e.y)}function L4(t,e,r,n,i){return t-=e,t=w2(t,1/r,n),i!==void 0&&(t=w2(t,1/i,n)),t}function ehe(t,e=0,r=1,n=.5,i,s=t,a=t){if(yu.test(e)&&(e=parseFloat(e),e=Ti(a.min,a.max,e/100)-a.min),typeof e!="number")return;let o=Ti(s.min,s.max,n);t===s&&(o-=e),t.min=L4(t.min,e,r,o,i),t.max=L4(t.max,e,r,o,i)}function F4(t,e,[r,n,i],s,a){ehe(t,e[r],e[n],e[i],e.scale,s,a)}const the=["x","scaleX","originX"],rhe=["y","scaleY","originY"];function B4(t,e,r,n){F4(t.x,e,the,r?r.x:void 0,n?n.x:void 0),F4(t.y,e,rhe,r?r.y:void 0,n?n.y:void 0)}function $4(t){return t.translate===0&&t.scale===1}function H9(t){return $4(t.x)&&$4(t.y)}function nhe(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function G9(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function N4(t){return rl(t.x)/rl(t.y)}class ihe{constructor(){this.members=[]}add(e){R5(this.members,e),e.scheduleRender()}remove(e){if(D5(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(i=>e===i);if(r===0)return!1;let n;for(let i=r;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){n=s;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function V4(t,e,r){let n="";const i=t.x.translate/e.x,s=t.y.translate/e.y;if((i||s)&&(n=`translate3d(${i}px, ${s}px, 0) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{rotate:d,rotateX:m,rotateY:y}=r;d&&(n+=`rotate(${d}deg) `),m&&(n+=`rotateX(${m}deg) `),y&&(n+=`rotateY(${y}deg) `)}const a=t.x.scale*e.x,o=t.y.scale*e.y;return(a!==1||o!==1)&&(n+=`scale(${a}, ${o})`),n||"none"}const she=(t,e)=>t.depth-e.depth;class ohe{constructor(){this.children=[],this.isDirty=!1}add(e){R5(this.children,e),this.isDirty=!0}remove(e){D5(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(she),this.isDirty=!1,this.children.forEach(e)}}function ahe(t,e){const r=performance.now(),n=({timestamp:i})=>{const s=i-r;s>=e&&(wh(n),t(s-e))};return ii.read(n,!0),()=>wh(n)}function lhe(t){window.MotionDebug&&window.MotionDebug.record(t)}function che(t){return t instanceof SVGElement&&t.tagName!=="svg"}function uhe(t,e,r){const n=Ea(t)?t:Gy(t);return n.start(I5("",n,e,r)),n.animation}const W4=["","X","Y","Z"],hhe={visibility:"hidden"},U4=1e3;let dhe=0;const lp={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function X9({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(a={},o=e==null?void 0:e()){this.id=dhe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,lp.totalNodes=lp.resolvedTargetDeltas=lp.recalculatedProjection=0,this.nodes.forEach(mhe),this.nodes.forEach(bhe),this.nodes.forEach(_he),this.nodes.forEach(ghe),lhe(lp)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let d=0;d<this.path.length;d++)this.path[d].shouldResetTransform=!0;this.root===this&&(this.nodes=new ohe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new L5),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const d=this.eventHandlers.get(a);d&&d.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=che(a),this.instance=a;const{layoutId:d,layout:m,visualElement:y}=this.options;if(y&&!y.current&&y.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(m||d)&&(this.isLayoutDirty=!0),t){let v;const w=()=>this.root.updateBlockedByResize=!1;t(a,()=>{this.root.updateBlockedByResize=!0,v&&v(),v=ahe(w,250),bS.hasAnimatedSinceResize&&(bS.hasAnimatedSinceResize=!1,this.nodes.forEach(Q4))})}d&&this.root.registerSharedNode(d,this),this.options.animate!==!1&&y&&(d||m)&&this.addEventListener("didUpdate",({delta:v,hasLayoutChanged:w,hasRelativeTargetChanged:O,layout:P})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const E=this.options.transition||y.getDefaultTransition()||The,{onLayoutAnimationStart:$,onLayoutAnimationComplete:R}=y.getProps(),F=!this.targetLayout||!G9(this.targetLayout,P)||O,D=!w&&O;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||D||w&&(F||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(v,D);const U={...M5(E,"layout"),onPlay:$,onComplete:R};(y.shouldReduceMotion||this.options.layoutRoot)&&(U.delay=0,U.type=!1),this.startAnimation(U)}else w||Q4(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=P})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,wh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(whe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let y=0;y<this.path.length;y++){const v=this.path[y];v.shouldResetTransform=!0,v.updateScroll("snapshot"),v.options.layoutRoot&&v.willUpdate(!1)}const{layoutId:o,layout:d}=this.options;if(o===void 0&&!d)return;const m=this.getTransformTemplate();this.prevTransformTemplateValue=m?m(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(q4);return}this.isUpdating||this.nodes.forEach(xhe),this.isUpdating=!1,this.nodes.forEach(vhe),this.nodes.forEach(fhe),this.nodes.forEach(phe),this.clearAllSnapshots();const o=performance.now();wo.delta=rf(0,1e3/60,o-wo.timestamp),wo.timestamp=o,wo.isProcessing=!0,AO.update.process(wo),AO.preRender.process(wo),AO.render.process(wo),wo.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(yhe),this.sharedNodes.forEach(She)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ii.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ii.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let d=0;d<this.path.length;d++)this.path[d].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Yi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&(this.scroll={animationId:this.root.animationId,phase:a,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform,o=this.projectionDelta&&!H9(this.projectionDelta),d=this.getTransformTemplate(),m=d?d(this.latestValues,""):void 0,y=m!==this.prevTransformTemplateValue;a&&(o||ap(this.latestValues)||y)&&(i(this.instance,m),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let d=this.removeElementScroll(o);return a&&(d=this.removeTransform(d)),Ohe(d),{animationId:this.root.animationId,measuredBox:o,layoutBox:d,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return Yi();const o=a.measureViewportBox(),{scroll:d}=this.root;return d&&(yd(o.x,d.offset.x),yd(o.y,d.offset.y)),o}removeElementScroll(a){const o=Yi();xl(o,a);for(let d=0;d<this.path.length;d++){const m=this.path[d],{scroll:y,options:v}=m;if(m!==this.root&&y&&v.layoutScroll){if(y.isRoot){xl(o,a);const{scroll:w}=this.root;w&&(yd(o.x,-w.offset.x),yd(o.y,-w.offset.y))}yd(o.x,y.offset.x),yd(o.y,y.offset.y)}}return o}applyTransform(a,o=!1){const d=Yi();xl(d,a);for(let m=0;m<this.path.length;m++){const y=this.path[m];!o&&y.options.layoutScroll&&y.scroll&&y!==y.root&&Gg(d,{x:-y.scroll.offset.x,y:-y.scroll.offset.y}),ap(y.latestValues)&&Gg(d,y.latestValues)}return ap(this.latestValues)&&Gg(d,this.latestValues),d}removeTransform(a){const o=Yi();xl(o,a);for(let d=0;d<this.path.length;d++){const m=this.path[d];if(!m.instance||!ap(m.latestValues))continue;fA(m.latestValues)&&m.updateSnapshot();const y=Yi(),v=m.measurePageBox();xl(y,v),B4(o,m.latestValues,m.snapshot?m.snapshot.layoutBox:void 0,y)}return ap(this.latestValues)&&B4(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==wo.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const d=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=d.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=d.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=d.isSharedProjectionDirty);const m=!!this.resumingFrom||this!==d;if(!(a||m&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:v,layoutId:w}=this.options;if(!(!this.layout||!(v||w))){if(this.resolvedRelativeTargetAt=wo.timestamp,!this.targetDelta&&!this.relativeTarget){const O=this.getClosestProjectingParent();O&&O.layout&&this.animationProgress!==1?(this.relativeParent=O,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Yi(),this.relativeTargetOrigin=Yi(),Bv(this.relativeTargetOrigin,this.layout.layoutBox,O.layout.layoutBox),xl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Yi(),this.targetWithTransforms=Yi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Oue(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):xl(this.target,this.layout.layoutBox),$9(this.target,this.targetDelta)):xl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const O=this.getClosestProjectingParent();O&&!!O.resumingFrom==!!this.resumingFrom&&!O.options.layoutScroll&&O.target&&this.animationProgress!==1?(this.relativeParent=O,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Yi(),this.relativeTargetOrigin=Yi(),Bv(this.relativeTargetOrigin,this.target,O.target),xl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}lp.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||fA(this.parent.latestValues)||B9(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),d=!!this.resumingFrom||this!==o;let m=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(m=!1),d&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(m=!1),this.resolvedRelativeTargetAt===wo.timestamp&&(m=!1),m)return;const{layout:y,layoutId:v}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(y||v))return;xl(this.layoutCorrected,this.layout.layoutBox);const w=this.treeScale.x,O=this.treeScale.y;Due(this.layoutCorrected,this.treeScale,this.path,d),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox);const{target:P}=o;if(!P){this.projectionTransform&&(this.projectionDelta=Hg(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Hg(),this.projectionDeltaWithTransform=Hg());const E=this.projectionTransform;Fv(this.projectionDelta,this.layoutCorrected,P,this.latestValues),this.projectionTransform=V4(this.projectionDelta,this.treeScale),(this.projectionTransform!==E||this.treeScale.x!==w||this.treeScale.y!==O)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",P)),lp.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),a){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(a,o=!1){const d=this.snapshot,m=d?d.latestValues:{},y={...this.latestValues},v=Hg();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const w=Yi(),O=d?d.source:void 0,P=this.layout?this.layout.source:void 0,E=O!==P,$=this.getStack(),R=!$||$.members.length<=1,F=!!(E&&!R&&this.options.crossfade===!0&&!this.path.some(Che));this.animationProgress=0;let D;this.mixTargetDelta=U=>{const X=U/1e3;H4(v.x,a.x,X),H4(v.y,a.y,X),this.setTargetDelta(v),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Bv(w,this.layout.layoutBox,this.relativeParent.layout.layoutBox),khe(this.relativeTarget,this.relativeTargetOrigin,w,X),D&&nhe(this.relativeTarget,D)&&(this.isProjectionDirty=!1),D||(D=Yi()),xl(D,this.relativeTarget)),E&&(this.animationValues=y,Zue(y,m,this.latestValues,X,F,R)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=X},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(wh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ii.update(()=>{bS.hasAnimatedSinceResize=!0,this.currentAnimation=uhe(0,U4,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(U4),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:d,layout:m,latestValues:y}=a;if(!(!o||!d||!m)){if(this!==a&&this.layout&&m&&K9(this.options.animationType,this.layout.layoutBox,m.layoutBox)){d=this.target||Yi();const v=rl(this.layout.layoutBox.x);d.x.min=a.target.x.min,d.x.max=d.x.min+v;const w=rl(this.layout.layoutBox.y);d.y.min=a.target.y.min,d.y.max=d.y.min+w}xl(o,d),Gg(o,y),Fv(this.projectionDeltaWithTransform,this.layoutCorrected,o,y)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new ihe),this.sharedNodes.get(a).add(o);const m=o.options.initialPromotionConfig;o.promote({transition:m?m.transition:void 0,preserveFollowOpacity:m&&m.shouldPreserveFollowOpacity?m.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:d}={}){const m=this.getStack();m&&m.promote(this,d),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:d}=a;if((d.rotate||d.rotateX||d.rotateY||d.rotateZ)&&(o=!0),!o)return;const m={};for(let y=0;y<W4.length;y++){const v="rotate"+W4[y];d[v]&&(m[v]=d[v],a.setStaticValue(v,0))}a.render();for(const y in m)a.setStaticValue(y,m[y]);a.scheduleRender()}getProjectionStyles(a){var o,d;if(!this.instance||this.isSVG)return;if(!this.isVisible)return hhe;const m={visibility:""},y=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,m.opacity="",m.pointerEvents=vS(a==null?void 0:a.pointerEvents)||"",m.transform=y?y(this.latestValues,""):"none",m;const v=this.getLead();if(!this.projectionDelta||!this.layout||!v.target){const E={};return this.options.layoutId&&(E.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,E.pointerEvents=vS(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!ap(this.latestValues)&&(E.transform=y?y({},""):"none",this.hasProjected=!1),E}const w=v.animationValues||v.latestValues;this.applyTransformsToTarget(),m.transform=V4(this.projectionDeltaWithTransform,this.treeScale,w),y&&(m.transform=y(w,m.transform));const{x:O,y:P}=this.projectionDelta;m.transformOrigin=`${O.origin*100}% ${P.origin*100}% 0`,v.animationValues?m.opacity=v===this?(d=(o=w.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&d!==void 0?d:1:this.preserveOpacity?this.latestValues.opacity:w.opacityExit:m.opacity=v===this?w.opacity!==void 0?w.opacity:"":w.opacityExit!==void 0?w.opacityExit:0;for(const E in m2){if(w[E]===void 0)continue;const{correct:$,applyTo:R}=m2[E],F=m.transform==="none"?w[E]:$(w[E],v);if(R){const D=R.length;for(let U=0;U<D;U++)m[R[U]]=F}else m[E]=F}return this.options.layoutId&&(m.pointerEvents=v===this?vS(a==null?void 0:a.pointerEvents)||"":"none"),m}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(q4),this.root.sharedNodes.clear()}}}function fhe(t){t.updateLayout()}function phe(t){var e;const r=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&r&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=t.layout,{animationType:s}=t.options,a=r.source!==t.layout.source;s==="size"?bl(v=>{const w=a?r.measuredBox[v]:r.layoutBox[v],O=rl(w);w.min=n[v].min,w.max=w.min+O}):K9(s,r.layoutBox,n)&&bl(v=>{const w=a?r.measuredBox[v]:r.layoutBox[v],O=rl(n[v]);w.max=w.min+O,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[v].max=t.relativeTarget[v].min+O)});const o=Hg();Fv(o,n,r.layoutBox);const d=Hg();a?Fv(d,t.applyTransform(i,!0),r.measuredBox):Fv(d,n,r.layoutBox);const m=!H9(o);let y=!1;if(!t.resumeFrom){const v=t.getClosestProjectingParent();if(v&&!v.resumeFrom){const{snapshot:w,layout:O}=v;if(w&&O){const P=Yi();Bv(P,r.layoutBox,w.layoutBox);const E=Yi();Bv(E,n,O.layoutBox),G9(P,E)||(y=!0),v.options.layoutRoot&&(t.relativeTarget=E,t.relativeTargetOrigin=P,t.relativeParent=v)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:d,layoutDelta:o,hasLayoutChanged:m,hasRelativeTargetChanged:y})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function mhe(t){lp.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function ghe(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function yhe(t){t.clearSnapshot()}function q4(t){t.clearMeasurements()}function xhe(t){t.isLayoutDirty=!1}function vhe(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Q4(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function bhe(t){t.resolveTargetDelta()}function _he(t){t.calcProjection()}function whe(t){t.resetRotation()}function She(t){t.removeLeadSnapshot()}function H4(t,e,r){t.translate=Ti(e.translate,0,r),t.scale=Ti(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function G4(t,e,r,n){t.min=Ti(e.min,r.min,n),t.max=Ti(e.max,r.max,n)}function khe(t,e,r,n){G4(t.x,e.x,r.x,n),G4(t.y,e.y,r.y,n)}function Che(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const The={duration:.45,ease:[.4,0,.1,1]},X4=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),K4=X4("applewebkit/")&&!X4("chrome/")?Math.round:Wi;function Z4(t){t.min=K4(t.min),t.max=K4(t.max)}function Ohe(t){Z4(t.x),Z4(t.y)}function K9(t,e,r){return t==="position"||t==="preserve-aspect"&&!hA(N4(e),N4(r),.2)}const jhe=X9({attachResizeListener:(t,e)=>lh(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),NO={current:void 0},Z9=X9({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!NO.current){const t=new jhe({});t.mount(window),t.setOptions({layoutScroll:!0}),NO.current=t}return NO.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Phe={pan:{Feature:Uue},drag:{Feature:Wue,ProjectionNode:Z9,MeasureLayout:U9}},Ahe=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Ehe(t){const e=Ahe.exec(t);if(!e)return[,];const[,r,n]=e;return[r,n]}function mA(t,e,r=1){const[n,i]=Ehe(t);if(!n)return;const s=window.getComputedStyle(e).getPropertyValue(n);if(s){const a=s.trim();return z9(a)?parseFloat(a):a}else return iA(i)?mA(i,e,r+1):i}function zhe(t,{...e},r){const n=t.current;if(!(n instanceof Element))return{target:e,transitionEnd:r};r&&(r={...r}),t.values.forEach(i=>{const s=i.get();if(!iA(s))return;const a=mA(s,n);a&&i.set(a)});for(const i in e){const s=e[i];if(!iA(s))continue;const a=mA(s,n);a&&(e[i]=a,r||(r={}),r[i]===void 0&&(r[i]=s))}return{target:e,transitionEnd:r}}const Mhe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),Y9=t=>Mhe.has(t),Ihe=t=>Object.keys(t).some(Y9),Y4=t=>t===_m||t===Dr,J4=(t,e)=>parseFloat(t.split(", ")[e]),eL=(t,e)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const i=n.match(/^matrix3d\((.+)\)$/);if(i)return J4(i[1],e);{const s=n.match(/^matrix\((.+)\)$/);return s?J4(s[1],t):0}},Rhe=new Set(["x","y","z"]),Dhe=g1.filter(t=>!Rhe.has(t));function Lhe(t){const e=[];return Dhe.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e.length&&t.render(),e}const Xy={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:eL(4,13),y:eL(5,14)};Xy.translateX=Xy.x;Xy.translateY=Xy.y;const Fhe=(t,e,r)=>{const n=e.measureViewportBox(),i=e.current,s=getComputedStyle(i),{display:a}=s,o={};a==="none"&&e.setStaticValue("display",t.display||"block"),r.forEach(m=>{o[m]=Xy[m](n,s)}),e.render();const d=e.measureViewportBox();return r.forEach(m=>{const y=e.getValue(m);y&&y.jump(o[m]),t[m]=Xy[m](d,s)}),t},Bhe=(t,e,r={},n={})=>{e={...e},n={...n};const i=Object.keys(e).filter(Y9);let s=[],a=!1;const o=[];if(i.forEach(d=>{const m=t.getValue(d);if(!t.hasValue(d))return;let y=r[d],v=Vx(y);const w=e[d];let O;if(y2(w)){const P=w.length,E=w[0]===null?1:0;y=w[E],v=Vx(y);for(let $=E;$<P&&w[$]!==null;$++)O?j5(Vx(w[$])===O):O=Vx(w[$])}else O=Vx(w);if(v!==O)if(Y4(v)&&Y4(O)){const P=m.get();typeof P=="string"&&m.set(parseFloat(P)),typeof w=="string"?e[d]=parseFloat(w):Array.isArray(w)&&O===Dr&&(e[d]=w.map(parseFloat))}else v!=null&&v.transform&&(O!=null&&O.transform)&&(y===0||w===0)?y===0?m.set(O.transform(y)):e[d]=v.transform(w):(a||(s=Lhe(t),a=!0),o.push(d),n[d]=n[d]!==void 0?n[d]:e[d],m.jump(w))}),o.length){const d=o.indexOf("height")>=0?window.pageYOffset:null,m=Fhe(e,t,o);return s.length&&s.forEach(([y,v])=>{t.getValue(y).set(v)}),t.render(),qk&&d!==null&&window.scrollTo({top:d}),{target:m,transitionEnd:n}}else return{target:e,transitionEnd:n}};function $he(t,e,r,n){return Ihe(e)?Bhe(t,e,r,n):{target:e,transitionEnd:n}}const Nhe=(t,e,r,n)=>{const i=zhe(t,e,n);return e=i.target,n=i.transitionEnd,$he(t,e,r,n)},gA={current:null},J9={current:!1};function Vhe(){if(J9.current=!0,!!qk)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>gA.current=t.matches;t.addListener(e),e()}else gA.current=!1}function Whe(t,e,r){const{willChange:n}=e;for(const i in e){const s=e[i],a=r[i];if(Ea(s))t.addValue(i,s),_2(n)&&n.add(i);else if(Ea(a))t.addValue(i,Gy(s,{owner:t})),_2(n)&&n.remove(i);else if(a!==s)if(t.hasValue(i)){const o=t.getValue(i);!o.hasAnimated&&o.set(s)}else{const o=t.getStaticValue(i);t.addValue(i,Gy(o!==void 0?o:s,{owner:t}))}}for(const i in r)e[i]===void 0&&t.removeValue(i);return e}const tL=new WeakMap,eW=Object.keys(wb),Uhe=eW.length,rL=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],qhe=v5.length;class Qhe{constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:i,visualState:s},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>ii.render(this.render,!1,!0);const{latestValues:o,renderState:d}=s;this.latestValues=o,this.baseTarget={...o},this.initialValues=r.initial?{...o}:{},this.renderState=d,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.isControllingVariants=Hk(r),this.isVariantNode=LV(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:m,...y}=this.scrapeMotionValuesFromProps(r,{});for(const v in y){const w=y[v];o[v]!==void 0&&Ea(w)&&(w.set(o[v],!1),_2(m)&&m.add(v))}}scrapeMotionValuesFromProps(e,r){return{}}mount(e){this.current=e,tL.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),J9.current||Vhe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:gA.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){tL.delete(this.current),this.projection&&this.projection.unmount(),wh(this.notifyUpdate),wh(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,r){const n=bm.has(e),i=r.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&ii.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),s=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{i(),s()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...r},n,i,s){let a,o;for(let d=0;d<Uhe;d++){const m=eW[d],{isEnabled:y,Feature:v,ProjectionNode:w,MeasureLayout:O}=wb[m];w&&(a=w),y(r)&&(!this.features[m]&&v&&(this.features[m]=new v(this)),O&&(o=O))}if((this.type==="html"||this.type==="svg")&&!this.projection&&a){this.projection=new a(this.latestValues,this.parent&&this.parent.projection);const{layoutId:d,layout:m,drag:y,dragConstraints:v,layoutScroll:w,layoutRoot:O}=r;this.projection.setOptions({layoutId:d,layout:m,alwaysMeasureLayout:!!y||v&&qg(v),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof m=="string"?m:"both",initialPromotionConfig:s,layoutScroll:w,layoutRoot:O})}return o}updateFeatures(){for(const e in this.features){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Yi()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}makeTargetAnimatable(e,r=!0){return this.makeTargetAnimatableFromInstance(e,this.props,r)}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<rL.length;n++){const i=rL[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s=e["on"+i];s&&(this.propEventSubscriptions[i]=this.on(i,s))}this.prevMotionValues=Whe(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<qhe;n++){const i=v5[n],s=this.props[i];(_b(s)||s===!1)&&(r[i]=s)}return r}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){r!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,r)),this.values.set(e,r),this.latestValues[e]=r.get()}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=Gy(r,{owner:this}),this.addValue(e,n)),n}readValue(e){var r;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(r=this.getBaseTargetFromProps(this.props,e))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var r;const{initial:n}=this.props,i=typeof n=="string"||typeof n=="object"?(r=O5(this.props,n))===null||r===void 0?void 0:r[e]:void 0;if(n&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Ea(s)?s:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new L5),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}}class tW extends Qhe{sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:r,...n},{transformValues:i},s){let a=lue(n,e||{},this);if(i&&(r&&(r=i(r)),n&&(n=i(n)),a&&(a=i(a))),s){oue(this,n,a);const o=Nhe(this,n,a,r);r=o.transitionEnd,n=o.target}return{transition:e,transitionEnd:r,...n}}}function Hhe(t){return window.getComputedStyle(t)}class Ghe extends tW{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,r){if(bm.has(r)){const n=z5(r);return n&&n.default||0}else{const n=Hhe(e),i=(NV(r)?n.getPropertyValue(r):n[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:r}){return N9(e,r)}build(e,r,n,i){w5(e,r,n,i.transformTemplate)}scrapeMotionValuesFromProps(e,r){return T5(e,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ea(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(e,r,n,i){HV(e,r,n,i)}}class Xhe extends tW{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(bm.has(r)){const n=z5(r);return n&&n.default||0}return r=GV.has(r)?r:y5(r),e.getAttribute(r)}measureInstanceViewportBox(){return Yi()}scrapeMotionValuesFromProps(e,r){return KV(e,r)}build(e,r,n,i){k5(e,r,n,this.isSVGTag,i.transformTemplate)}renderInstance(e,r,n,i){XV(e,r,n,i)}mount(e){this.isSVGTag=C5(e.tagName),super.mount(e)}}const Khe=(t,e)=>_5(t)?new Xhe(e,{enableHardwareAcceleration:!1}):new Ghe(e,{enableHardwareAcceleration:!0}),Zhe={layout:{ProjectionNode:Z9,MeasureLayout:U9}},Yhe={...Sue,...Wle,...Phe,...Zhe},Ln=Yae((t,e)=>Ale(t,e,Yhe,Khe));function rW(){const t=I.useRef(!1);return g5(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function Jhe(){const t=rW(),[e,r]=I.useState(0),n=I.useCallback(()=>{t.current&&r(e+1)},[e]);return[I.useCallback(()=>ii.postRender(n),[n]),e]}class ede extends I.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function tde({children:t,isPresent:e}){const r=I.useId(),n=I.useRef(null),i=I.useRef({width:0,height:0,top:0,left:0});return I.useInsertionEffect(()=>{const{width:s,height:a,top:o,left:d}=i.current;if(e||!n.current||!s||!a)return;n.current.dataset.motionPopId=r;const m=document.createElement("style");return document.head.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${s}px !important;
            height: ${a}px !important;
            top: ${o}px !important;
            left: ${d}px !important;
          }
        `),()=>{document.head.removeChild(m)}},[e]),I.createElement(ede,{isPresent:e,childRef:n,sizeRef:i},I.cloneElement(t,{ref:n}))}const VO=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=ZV(rde),d=I.useId(),m=I.useMemo(()=>({id:d,initial:e,isPresent:r,custom:i,onExitComplete:y=>{o.set(y,!0);for(const v of o.values())if(!v)return;n&&n()},register:y=>(o.set(y,!1),()=>o.delete(y))}),s?void 0:[r]);return I.useMemo(()=>{o.forEach((y,v)=>o.set(v,!1))},[r]),I.useEffect(()=>{!r&&!o.size&&n&&n()},[r]),a==="popLayout"&&(t=I.createElement(tde,{isPresent:r},t)),I.createElement(m1.Provider,{value:m},t)};function rde(){return new Map}function nde(t){return I.useEffect(()=>()=>t(),[])}const cp=t=>t.key||"";function ide(t,e){t.forEach(r=>{const n=cp(r);e.set(n,r)})}function sde(t){const e=[];return I.Children.forEach(t,r=>{I.isValidElement(r)&&e.push(r)}),e}const vc=({children:t,custom:e,initial:r=!0,onExitComplete:n,exitBeforeEnter:i,presenceAffectsLayout:s=!0,mode:a="sync"})=>{const o=I.useContext(b5).forceRender||Jhe()[0],d=rW(),m=sde(t);let y=m;const v=I.useRef(new Map).current,w=I.useRef(y),O=I.useRef(new Map).current,P=I.useRef(!0);if(g5(()=>{P.current=!1,ide(m,O),w.current=y}),nde(()=>{P.current=!0,O.clear(),v.clear()}),P.current)return I.createElement(I.Fragment,null,y.map(F=>I.createElement(VO,{key:cp(F),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:s,mode:a},F)));y=[...y];const E=w.current.map(cp),$=m.map(cp),R=E.length;for(let F=0;F<R;F++){const D=E[F];$.indexOf(D)===-1&&!v.has(D)&&v.set(D,void 0)}return a==="wait"&&v.size&&(y=[]),v.forEach((F,D)=>{if($.indexOf(D)!==-1)return;const U=O.get(D);if(!U)return;const X=E.indexOf(D);let ee=F;if(!ee){const K=()=>{v.delete(D);const Y=Array.from(O.keys()).filter(ne=>!$.includes(ne));if(Y.forEach(ne=>O.delete(ne)),w.current=m.filter(ne=>{const oe=cp(ne);return oe===D||Y.includes(oe)}),!v.size){if(d.current===!1)return;o(),n&&n()}};ee=I.createElement(VO,{key:cp(U),isPresent:!1,onExitComplete:K,custom:e,presenceAffectsLayout:s,mode:a},U),v.set(D,ee)}y.splice(X,0,ee)}),y=y.map(F=>{const D=F.key;return v.has(D)?F:I.createElement(VO,{key:cp(F),isPresent:!0,presenceAffectsLayout:s,mode:a},F)}),I.createElement(I.Fragment,null,v.size?y:y.map(F=>I.cloneElement(F)))},ode=(t,e)=>t.find(r=>r.id===e);function nL(t,e){const r=nW(t,e),n=r?t[r].findIndex(i=>i.id===e):-1;return{position:r,index:n}}function nW(t,e){for(const[r,n]of Object.entries(t))if(ode(n,e))return r}function ade(t){const e=t.includes("right"),r=t.includes("left");let n="center";return e&&(n="flex-end"),r&&(n="flex-start"),{display:"flex",flexDirection:"column",alignItems:n}}function lde(t){const r=t==="top"||t==="bottom"?"0 auto":void 0,n=t.includes("top")?"env(safe-area-inset-top, 0px)":void 0,i=t.includes("bottom")?"env(safe-area-inset-bottom, 0px)":void 0,s=t.includes("left")?void 0:"env(safe-area-inset-right, 0px)",a=t.includes("right")?void 0:"env(safe-area-inset-left, 0px)";return{position:"fixed",zIndex:"var(--toast-z-index, 5500)",pointerEvents:"none",display:"flex",flexDirection:"column",margin:r,top:n,bottom:i,right:s,left:a}}var cde=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,ude=xV(function(t){return cde.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),hde=ude,dde=function(e){return e!=="theme"},iL=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?hde:dde},sL=function(e,r,n){var i;if(r){var s=r.shouldForwardProp;i=e.__emotion_forwardProp&&s?function(a){return e.__emotion_forwardProp(a)&&s(a)}:s}return typeof i!="function"&&n&&(i=e.__emotion_forwardProp),i},fde=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return u5(r,n,i),OV(function(){return h5(r,n,i)}),null},pde=function t(e,r){var n=e.__emotion_real===e,i=n&&e.__emotion_base||e,s,a;r!==void 0&&(s=r.label,a=r.target);var o=sL(e,r,n),d=o||iL(i),m=!d("as");return function(){var y=arguments,v=n&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(s!==void 0&&v.push("label:"+s+";"),y[0]==null||y[0].raw===void 0)v.push.apply(v,y);else{var w=y[0];v.push(w[0]);for(var O=y.length,P=1;P<O;P++)v.push(y[P],w[P])}var E=f5(function($,R,F){var D=m&&$.as||i,U="",X=[],ee=$;if($.theme==null){ee={};for(var K in $)ee[K]=$[K];ee.theme=I.useContext(Hy)}typeof $.className=="string"?U=kV(R.registered,X,$.className):$.className!=null&&(U=$.className+" ");var Y=Nk(v.concat(X),R.registered,ee);U+=R.key+"-"+Y.name,a!==void 0&&(U+=" "+a);var ne=m&&o===void 0?iL(D):d,oe={};for(var ce in $)m&&ce==="as"||ne(ce)&&(oe[ce]=$[ce]);return oe.className=U,F&&(oe.ref=F),I.createElement(I.Fragment,null,I.createElement(fde,{cache:R,serialized:Y,isStringTag:typeof D=="string"}),I.createElement(D,oe))});return E.displayName=s!==void 0?s:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",E.defaultProps=e.defaultProps,E.__emotion_real=E,E.__emotion_base=i,E.__emotion_styles=v,E.__emotion_forwardProp=o,Object.defineProperty(E,"toString",{value:function(){return"."+a}}),E.withComponent=function($,R){var F=t($,tf({},r,R,{shouldForwardProp:sL(E,R,!0)}));return F.apply(void 0,v)},E}},mde=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],yA=pde.bind(null);mde.forEach(function(t){yA[t]=yA(t)});const gde=new Set([...UJ,"textStyle","layerStyle","apply","noOfLines","focusBorderColor","errorBorderColor","as","__css","css","sx"]),yde=new Set(["htmlWidth","htmlHeight","htmlSize","htmlTranslate"]);function xde(t){return(yde.has(t)||!gde.has(t))&&t[0]!=="_"}const vde=EY(yA),bde=({baseStyle:t})=>e=>{const{theme:r,css:n,__css:i,sx:s,...a}=e,[o]=LY(a,QJ),d=Ka(t,e),m=yY({},i,d,wk(o),s),y=K8(m)(e.theme);return n?[y,n]:y};function WO(t,e){const{baseStyle:r,...n}=e??{};n.shouldForwardProp||(n.shouldForwardProp=xde);const i=bde({baseStyle:r}),s=vde(t,n)(i);return I.forwardRef(function(d,m){const{children:y,...v}=d,{colorMode:w,forced:O}=Wk(),P=O?w:void 0;return I.createElement(s,{ref:m,"data-theme":P,...v},y)})}function _de(){const t=new Map;return new Proxy(WO,{apply(e,r,n){return WO(...n)},get(e,r){return t.has(r)||t.set(r,WO(r)),t.get(r)}})}const mt=_de(),wde={initial:t=>{const{position:e}=t,r=["top","bottom"].includes(e)?"y":"x";let n=["top-right","bottom-right"].includes(e)?1:-1;return e==="bottom"&&(n=1),{opacity:0,[r]:n*24}},animate:{opacity:1,y:0,x:0,scale:1,transition:{duration:.4,ease:[.4,0,.2,1]}},exit:{opacity:0,scale:.85,transition:{duration:.2,ease:[.4,0,1,1]}}},iW=I.memo(t=>{const{id:e,message:r,onCloseComplete:n,onRequestRemove:i,requestClose:s=!1,position:a="bottom",duration:o=5e3,containerStyle:d,motionVariants:m=wde,toastSpacing:y="0.5rem"}=t,[v,w]=I.useState(o),O=que();ef(()=>{O||n==null||n()},[O]),ef(()=>{w(o)},[o]);const P=()=>w(null),E=()=>w(o),$=()=>{O&&i()};I.useEffect(()=>{O&&s&&i()},[O,s,i]),XY($,v);const R=I.useMemo(()=>({pointerEvents:"auto",maxWidth:560,minWidth:300,margin:y,...d}),[d,y]),F=I.useMemo(()=>ade(a),[a]);return u.jsx(Ln.div,{layout:!0,className:"chakra-toast",variants:m,initial:"initial",animate:"animate",exit:"exit",onHoverStart:P,onHoverEnd:E,custom:{position:a},style:F,children:u.jsx(mt.div,{role:"status","aria-atomic":"true",className:"chakra-toast__inner",__css:R,children:Ka(r,{id:e,onClose:$})})})});iW.displayName="ToastComponent";function Tt(t){return I.forwardRef(t)}var Sde=typeof Element<"u",kde=typeof Map=="function",Cde=typeof Set=="function",Tde=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function _S(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var r,n,i;if(Array.isArray(t)){if(r=t.length,r!=e.length)return!1;for(n=r;n--!==0;)if(!_S(t[n],e[n]))return!1;return!0}var s;if(kde&&t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(s=t.entries();!(n=s.next()).done;)if(!e.has(n.value[0]))return!1;for(s=t.entries();!(n=s.next()).done;)if(!_S(n.value[1],e.get(n.value[0])))return!1;return!0}if(Cde&&t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(s=t.entries();!(n=s.next()).done;)if(!e.has(n.value[0]))return!1;return!0}if(Tde&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(r=t.length,r!=e.length)return!1;for(n=r;n--!==0;)if(t[n]!==e[n])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof e.valueOf=="function")return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof e.toString=="function")return t.toString()===e.toString();if(i=Object.keys(t),r=i.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(e,i[n]))return!1;if(Sde&&t instanceof Element)return!1;for(n=r;n--!==0;)if(!((i[n]==="_owner"||i[n]==="__v"||i[n]==="__o")&&t.$$typeof)&&!_S(t[i[n]],e[i[n]]))return!1;return!0}return t!==t&&e!==e}var Ode=function(e,r){try{return _S(e,r)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}};const jde=s1(Ode);function b1(){const t=I.useContext(Hy);if(!t)throw Error("useTheme: `theme` is undefined. Seems you forgot to wrap your app in `<ChakraProvider />` or `<ThemeProvider />`");return t}function sW(){const t=Wk(),e=b1();return{...t,theme:e}}function Pde(t,e,r){if(e==null)return e;const n=i=>{var s,a;return(a=(s=t.__cssMap)==null?void 0:s[i])==null?void 0:a.value};return n(e)??n(r)??r}function Ade(t,e,r){const n=Array.isArray(e)?e:[e],i=Array.isArray(r)?r:[r];return s=>{const a=i.filter(Boolean),o=n.map((d,m)=>{const y=`${t}.${d}`;return Pde(s,y,a[m]??d)});return Array.isArray(e)?o:o[0]}}function Ede(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!==void 0&&e!=="children"&&!I.isValidElement(r)))}function oW(t,e={}){const{styleConfig:r,...n}=e,{theme:i,colorMode:s}=sW(),a=t?I8(i,`components.${t}`):void 0,o=r||a,d=zl({theme:i,colorMode:s},(o==null?void 0:o.defaultProps)??{},Ede(n),(y,v)=>y?void 0:v),m=I.useRef({});if(o){const v=nee(o)(d);jde(m.current,v)||(m.current=v)}return m.current}function ll(t,e={}){return oW(t,e)}function ls(t,e={}){return oW(t,e)}const oL={path:u.jsxs("g",{stroke:"currentColor",strokeWidth:"1.5",children:[u.jsx("path",{strokeLinecap:"round",fill:"none",d:"M9,9a3,3,0,1,1,4,2.829,1.5,1.5,0,0,0-1,1.415V14.25"}),u.jsx("path",{fill:"currentColor",strokeLinecap:"round",d:"M12,17.25a.375.375,0,1,0,.375.375A.375.375,0,0,0,12,17.25h0"}),u.jsx("circle",{fill:"none",strokeMiterlimit:"10",cx:"12",cy:"12",r:"11.25"})]}),viewBox:"0 0 24 24"},ze=Tt((t,e)=>{const{as:r,viewBox:n,color:i="currentColor",focusable:s=!1,children:a,className:o,__css:d,...m}=t,y=lr("chakra-icon",o),v=ll("Icon",t),w={w:"1em",h:"1em",display:"inline-block",lineHeight:"1em",flexShrink:0,color:i,...d,...v},O={ref:e,focusable:s,className:y,__css:w},P=n??oL.viewBox;if(r&&typeof r!="string")return u.jsx(mt.svg,{as:r,...O,...m});const E=a??oL.path;return u.jsx(mt.svg,{verticalAlign:"middle",viewBox:P,...O,...m,children:E})});ze.displayName="Icon";function zde(t){return u.jsx(ze,{viewBox:"0 0 24 24",...t,children:u.jsx("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})})}function Mde(t){return u.jsx(ze,{viewBox:"0 0 24 24",...t,children:u.jsx("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"})})}function aL(t){return u.jsx(ze,{viewBox:"0 0 24 24",...t,children:u.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})}const Ide=lo({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),kn=Tt((t,e)=>{const r=ll("Spinner",t),{label:n="Loading...",thickness:i="2px",speed:s="0.45s",emptyColor:a="transparent",className:o,...d}=Rn(t),m=lr("chakra-spinner",o),y={display:"inline-block",borderColor:"currentColor",borderStyle:"solid",borderRadius:"99999px",borderWidth:i,borderBottomColor:a,borderLeftColor:a,animation:`${Ide} ${s} linear infinite`,...r};return u.jsx(mt.div,{ref:e,__css:y,className:m,...d,children:n&&u.jsx(mt.span,{srOnly:!0,children:n})})});kn.displayName="Spinner";const[Rde,F5]=_n({name:"AlertContext",hookName:"useAlertContext",providerName:"<Alert />"}),[Dde,B5]=_n({name:"AlertStylesContext",hookName:"useAlertStyles",providerName:"<Alert />"}),aW={info:{icon:Mde,colorScheme:"blue"},warning:{icon:aL,colorScheme:"orange"},success:{icon:zde,colorScheme:"green"},error:{icon:aL,colorScheme:"red"},loading:{icon:kn,colorScheme:"blue"}};function Lde(t){return aW[t].colorScheme}function Fde(t){return aW[t].icon}const io=Tt(function(e,r){const{status:n="info",addRole:i=!0,...s}=Rn(e),a=e.colorScheme??Lde(n),o=ls("Alert",{...e,colorScheme:a}),d={width:"100%",display:"flex",alignItems:"center",position:"relative",overflow:"hidden",...o.container};return u.jsx(Rde,{value:{status:n},children:u.jsx(Dde,{value:o,children:u.jsx(mt.div,{"data-status":n,role:i?"alert":void 0,ref:r,...s,className:lr("chakra-alert",e.className),__css:d})})})});io.displayName="Alert";function so(t){const{status:e}=F5(),r=Fde(e),n=B5(),i=e==="loading"?n.spinner:n.icon;return u.jsx(mt.span,{display:"inherit","data-status":e,...t,className:lr("chakra-alert__icon",t.className),__css:i,children:t.children||u.jsx(r,{h:"100%",w:"100%"})})}so.displayName="AlertIcon";const _1=Tt(function(e,r){const n=B5(),{status:i}=F5();return u.jsx(mt.div,{ref:r,"data-status":i,...e,className:lr("chakra-alert__title",e.className),__css:n.title})});_1.displayName="AlertTitle";const Ky=Tt(function(e,r){const{status:n}=F5(),i=B5(),s={display:"inline",...i.description};return u.jsx(mt.div,{ref:r,"data-status":n,...e,className:lr("chakra-alert__desc",e.className),__css:s})});Ky.displayName="AlertDescription";function Bde(t){return u.jsx(ze,{focusable:"false","aria-hidden":!0,...t,children:u.jsx("path",{fill:"currentColor",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"})})}const kb=Tt(function(e,r){const n=ll("CloseButton",e),{children:i,isDisabled:s,__css:a,...o}=Rn(e),d={outline:0,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0};return u.jsx(mt.button,{type:"button","aria-label":"Close",ref:r,disabled:s,__css:{...d,...n,...a},...o,children:i||u.jsx(Bde,{width:"1em",height:"1em"})})});kb.displayName="CloseButton";const $de=t=>{const{status:e,variant:r="solid",id:n,title:i,isClosable:s,onClose:a,description:o,colorScheme:d,icon:m}=t,y=n?{root:`toast-${n}`,title:`toast-${n}-title`,description:`toast-${n}-description`}:void 0;return u.jsxs(io,{addRole:!1,status:e,variant:r,id:y==null?void 0:y.root,alignItems:"start",borderRadius:"md",boxShadow:"lg",paddingEnd:8,textAlign:"start",width:"auto",colorScheme:d,children:[u.jsx(so,{children:m}),u.jsxs(mt.div,{flex:"1",maxWidth:"100%",children:[i&&u.jsx(_1,{id:y==null?void 0:y.title,children:i}),o&&u.jsx(Ky,{id:y==null?void 0:y.description,display:"block",children:o})]}),s&&u.jsx(kb,{size:"sm",onClick:a,position:"absolute",insetEnd:1,top:1})]})};function lW(t={}){const{render:e,toastComponent:r=$de}=t;return i=>typeof e=="function"?e({...i,...t}):u.jsx(r,{...i,...t})}const Nde={top:[],"top-left":[],"top-right":[],"bottom-left":[],bottom:[],"bottom-right":[]},nu=Vde(Nde);function Vde(t){let e=t;const r=new Set,n=i=>{e=i(e),r.forEach(s=>s())};return{getState:()=>e,subscribe:i=>(r.add(i),()=>{n(()=>t),r.delete(i)}),removeToast:(i,s)=>{n(a=>({...a,[s]:a[s].filter(o=>o.id!=i)}))},notify:(i,s)=>{const a=Wde(i,s),{position:o,id:d}=a;return n(m=>{const v=o.includes("top")?[a,...m[o]??[]]:[...m[o]??[],a];return{...m,[o]:v}}),d},update:(i,s)=>{i&&n(a=>{const o={...a},{position:d,index:m}=nL(o,i);return d&&m!==-1&&(o[d][m]={...o[d][m],...s,message:lW(s)}),o})},closeAll:({positions:i}={})=>{n(s=>(i??["bottom","bottom-right","bottom-left","top","top-left","top-right"]).reduce((d,m)=>(d[m]=s[m].map(y=>({...y,requestClose:!0})),d),{...s}))},close:i=>{n(s=>{const a=nW(s,i);return a?{...s,[a]:s[a].map(o=>o.id==i?{...o,requestClose:!0}:o)}:s})},isActive:i=>!!nL(nu.getState(),i).position}}let lL=0;function Wde(t,e={}){lL+=1;const r=e.id??lL,n=e.position??"bottom";return{id:r,message:t,position:n,duration:e.duration,onCloseComplete:e.onCloseComplete,onRequestRemove:()=>nu.removeToast(String(r),n),status:e.status,requestClose:!1,containerStyle:e.containerStyle}}const[cW,Ude]=_n({strict:!1,name:"PortalContext"}),$5="chakra-portal",qde=".chakra-portal",Qde=t=>u.jsx("div",{className:"chakra-portal-zIndex",style:{position:"absolute",zIndex:t.zIndex,top:0,left:0,right:0},children:t.children}),Hde=t=>{const{appendToParentPortal:e,children:r}=t,[n,i]=I.useState(null),s=I.useRef(null),[,a]=I.useState({});I.useEffect(()=>a({}),[]);const o=Ude(),d=Nae();Rp(()=>{if(!n)return;const y=n.ownerDocument,v=e?o??y.body:y.body;if(!v)return;s.current=y.createElement("div"),s.current.className=$5,v.appendChild(s.current),a({});const w=s.current;return()=>{v.contains(w)&&v.removeChild(w)}},[n]);const m=d!=null&&d.zIndex?u.jsx(Qde,{zIndex:d==null?void 0:d.zIndex,children:r}):r;return s.current?qz.createPortal(u.jsx(cW,{value:s.current,children:m}),s.current):u.jsx("span",{ref:y=>{y&&i(y)}})},Gde=t=>{const{children:e,containerRef:r,appendToParentPortal:n}=t,i=r.current,s=i??(typeof window<"u"?document.body:void 0),a=I.useMemo(()=>{const d=i==null?void 0:i.ownerDocument.createElement("div");return d&&(d.className=$5),d},[i]),[,o]=I.useState({});return Rp(()=>o({}),[]),Rp(()=>{if(!(!a||!s))return s.appendChild(a),()=>{s.removeChild(a)}},[a,s]),s&&a?qz.createPortal(u.jsx(cW,{value:n?a:null,children:e}),a):null};function b0(t){const e={appendToParentPortal:!0,...t},{containerRef:r,...n}=e;return r?u.jsx(Gde,{containerRef:r,...n}):u.jsx(Hde,{...n})}b0.className=$5;b0.selector=qde;b0.displayName="Portal";const[Xde,Kde]=_n({name:"ToastOptionsContext",strict:!1}),Zde=t=>{const e=I.useSyncExternalStore(nu.subscribe,nu.getState,nu.getState),{motionVariants:r,component:n=iW,portalProps:i,animatePresenceProps:s}=t,o=Object.keys(e).map(d=>{const m=e[d];return u.jsx("div",{role:"region","aria-live":"polite","aria-label":`Notifications-${d}`,id:`chakra-toast-manager-${d}`,style:lde(d),children:u.jsx(vc,{...s,initial:!1,children:m.map(y=>u.jsx(n,{motionVariants:r,...y},y.id))})},d)});return u.jsx(b0,{...i,children:o})},Yde=t=>function({children:r,theme:n=t,toastOptions:i,...s}){return u.jsxs(Vae,{theme:n,...s,children:[u.jsx(Xde,{value:i==null?void 0:i.defaultOptions,children:r}),u.jsx(Zde,{...i})]})},Jde=Yde(hV);function cL(t){return t.sort((e,r)=>{const n=e.compareDocumentPosition(r);if(n&Node.DOCUMENT_POSITION_FOLLOWING||n&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(n&Node.DOCUMENT_POSITION_PRECEDING||n&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(n&Node.DOCUMENT_POSITION_DISCONNECTED||n&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}const efe=t=>typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE;function uL(t,e,r){let n=t+1;return r&&n>=e&&(n=0),n}function hL(t,e,r){let n=t-1;return r&&n<0&&(n=e),n}const UO=typeof window<"u"?I.useLayoutEffect:I.useEffect,dL=t=>t;var tfe=Object.defineProperty,rfe=(t,e,r)=>e in t?tfe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zi=(t,e,r)=>(rfe(t,typeof e!="symbol"?e+"":e,r),r);class nfe{constructor(){zi(this,"descendants",new Map),zi(this,"register",e=>{if(e!=null)return efe(e)?this.registerNode(e):r=>{this.registerNode(r,e)}}),zi(this,"unregister",e=>{this.descendants.delete(e);const r=cL(Array.from(this.descendants.keys()));this.assignIndex(r)}),zi(this,"destroy",()=>{this.descendants.clear()}),zi(this,"assignIndex",e=>{this.descendants.forEach(r=>{const n=e.indexOf(r.node);r.index=n,r.node.dataset.index=r.index.toString()})}),zi(this,"count",()=>this.descendants.size),zi(this,"enabledCount",()=>this.enabledValues().length),zi(this,"values",()=>Array.from(this.descendants.values()).sort((r,n)=>r.index-n.index)),zi(this,"enabledValues",()=>this.values().filter(e=>!e.disabled)),zi(this,"item",e=>{if(this.count()!==0)return this.values()[e]}),zi(this,"enabledItem",e=>{if(this.enabledCount()!==0)return this.enabledValues()[e]}),zi(this,"first",()=>this.item(0)),zi(this,"firstEnabled",()=>this.enabledItem(0)),zi(this,"last",()=>this.item(this.descendants.size-1)),zi(this,"lastEnabled",()=>{const e=this.enabledValues().length-1;return this.enabledItem(e)}),zi(this,"indexOf",e=>{var r;return e?((r=this.descendants.get(e))==null?void 0:r.index)??-1:-1}),zi(this,"enabledIndexOf",e=>e==null?-1:this.enabledValues().findIndex(r=>r.node.isSameNode(e))),zi(this,"next",(e,r=!0)=>{const n=uL(e,this.count(),r);return this.item(n)}),zi(this,"nextEnabled",(e,r=!0)=>{const n=this.item(e);if(!n)return;const i=this.enabledIndexOf(n.node),s=uL(i,this.enabledCount(),r);return this.enabledItem(s)}),zi(this,"prev",(e,r=!0)=>{const n=hL(e,this.count()-1,r);return this.item(n)}),zi(this,"prevEnabled",(e,r=!0)=>{const n=this.item(e);if(!n)return;const i=this.enabledIndexOf(n.node),s=hL(i,this.enabledCount()-1,r);return this.enabledItem(s)}),zi(this,"registerNode",(e,r)=>{if(!e||this.descendants.has(e))return;const n=Array.from(this.descendants.keys()).concat(e),i=cL(n);r!=null&&r.disabled&&(r.disabled=!!r.disabled);const s={node:e,index:-1,...r};this.descendants.set(e,s),this.assignIndex(i)})}}function N5(){const[t,e]=_n({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});return[t,e,()=>{const i=I.useRef(new nfe);return UO(()=>()=>i.current.destroy()),i.current},i=>{const s=e(),[a,o]=I.useState(-1),d=I.useRef(null);UO(()=>()=>{d.current&&s.unregister(d.current)},[]),UO(()=>{if(!d.current)return;const y=Number(d.current.dataset.index);a!=y&&!Number.isNaN(y)&&o(y)});const m=dL(i?s.register(i):s.register);return{descendants:s,index:a,enabledIndex:s.enabledIndexOf(d.current),register:bi(m,d)}}]}const[ife,Zk]=_n({name:"AccordionStylesContext",hookName:"useAccordionStyles",providerName:"<Accordion />"}),[sfe,V5]=_n({name:"AccordionItemContext",hookName:"useAccordionItemContext",providerName:"<AccordionItem />"}),[ofe,AAe,afe,lfe]=N5();function cfe(t){const{onChange:e,defaultIndex:r,index:n,allowMultiple:i,allowToggle:s,...a}=t;dfe(t),ffe(t);const o=afe(),[d,m]=I.useState(-1);I.useEffect(()=>()=>{m(-1)},[]);const[y,v]=Kz({value:n,defaultValue(){return i?r??[]:r??-1},onChange:e});return{index:y,setIndex:v,htmlProps:a,getAccordionItemProps:O=>{let P=!1;return O!==null&&(P=Array.isArray(y)?y.includes(O):y===O),{isOpen:P,onChange:$=>{if(O!==null)if(i&&Array.isArray(y)){const R=$?y.concat(O):y.filter(F=>F!==O);v(R)}else $?v(O):s&&v(-1)}}},focusedIndex:d,setFocusedIndex:m,descendants:o}}const[ufe,W5]=_n({name:"AccordionContext",hookName:"useAccordionContext",providerName:"Accordion"});function hfe(t){const{isDisabled:e,isFocusable:r,id:n,...i}=t,{getAccordionItemProps:s,setFocusedIndex:a}=W5(),o=I.useRef(null),d=I.useId(),m=n??d,y=`accordion-button-${m}`,v=`accordion-panel-${m}`;pfe(t);const{register:w,index:O,descendants:P}=lfe({disabled:e&&!r}),{isOpen:E,onChange:$}=s(O===-1?null:O);mfe({isOpen:E,isDisabled:e});const R=()=>{$==null||$(!0)},F=()=>{$==null||$(!1)},D=I.useCallback(()=>{$==null||$(!E),a(O)},[O,a,E,$]),U=I.useCallback(Y=>{const oe={ArrowDown:()=>{const ce=P.nextEnabled(O);ce==null||ce.node.focus()},ArrowUp:()=>{const ce=P.prevEnabled(O);ce==null||ce.node.focus()},Home:()=>{const ce=P.firstEnabled();ce==null||ce.node.focus()},End:()=>{const ce=P.lastEnabled();ce==null||ce.node.focus()}}[Y.key];oe&&(Y.preventDefault(),oe(Y))},[P,O]),X=I.useCallback(()=>{a(O)},[a,O]),ee=I.useCallback(function(ne={},oe=null){return{...ne,type:"button",ref:bi(w,o,oe),id:y,disabled:!!e,"aria-expanded":!!E,"aria-controls":v,onClick:Cr(ne.onClick,D),onFocus:Cr(ne.onFocus,X),onKeyDown:Cr(ne.onKeyDown,U)}},[y,e,E,D,X,U,v,w]),K=I.useCallback(function(ne={},oe=null){return{...ne,ref:oe,role:"region",id:v,"aria-labelledby":y,hidden:!E}},[y,E,v]);return{isOpen:E,isDisabled:e,isFocusable:r,onOpen:R,onClose:F,getButtonProps:ee,getPanelProps:K,htmlProps:i}}function dfe(t){const e=t.index||t.defaultIndex,r=e!=null&&!Array.isArray(e)&&t.allowMultiple;h1({condition:!!r,message:`If 'allowMultiple' is passed, then 'index' or 'defaultIndex' must be an array. You passed: ${typeof e},`})}function ffe(t){h1({condition:!!(t.allowMultiple&&t.allowToggle),message:"If 'allowMultiple' is passed, 'allowToggle' will be ignored. Either remove 'allowToggle' or 'allowMultiple' depending on whether you want multiple accordions visible or not"})}function pfe(t){h1({condition:!!(t.isFocusable&&!t.isDisabled),message:`Using only 'isFocusable', this prop is reserved for situations where you pass 'isDisabled' but you still want the element to receive focus (A11y). Either remove it or pass 'isDisabled' as well.
    `})}function mfe(t){h1({condition:t.isOpen&&!!t.isDisabled,message:"Cannot open a disabled accordion item"})}const U5=Tt(function({children:e,reduceMotion:r,...n},i){const s=ls("Accordion",n),a=Rn(n),{htmlProps:o,descendants:d,...m}=cfe(a),y=I.useMemo(()=>({...m,reduceMotion:!!r}),[m,r]);return u.jsx(ofe,{value:d,children:u.jsx(ufe,{value:y,children:u.jsx(ife,{value:s,children:u.jsx(mt.div,{ref:i,...o,className:lr("chakra-accordion",n.className),__css:s.root,children:e})})})})});U5.displayName="Accordion";const q5=Tt(function(e,r){const{getButtonProps:n}=V5(),i=n(e,r),a={display:"flex",alignItems:"center",width:"100%",outline:0,...Zk().button};return u.jsx(mt.button,{...i,className:lr("chakra-accordion__button",e.className),__css:a})});q5.displayName="AccordionButton";function Q5(t){const{isOpen:e,isDisabled:r}=V5(),{reduceMotion:n}=W5(),i=lr("chakra-accordion__icon",t.className),s=Zk(),a={opacity:r?.4:1,transform:e?"rotate(-180deg)":void 0,transition:n?void 0:"transform 0.2s",transformOrigin:"center",...s.icon};return u.jsx(ze,{viewBox:"0 0 24 24","aria-hidden":!0,className:i,__css:a,...t,children:u.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})})}Q5.displayName="AccordionIcon";const H5=Tt(function(e,r){const{children:n,className:i}=e,{htmlProps:s,...a}=hfe(e),o=Zk(),d={...o.container,overflowAnchor:"none"},m=I.useMemo(()=>a,[a]);return u.jsx(sfe,{value:m,children:u.jsx(mt.div,{ref:r,...s,className:lr("chakra-accordion__item",i),__css:d,children:typeof n=="function"?n({isExpanded:!!a.isOpen,isDisabled:!!a.isDisabled}):n})})});H5.displayName="AccordionItem";const Xg={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1]},$p={enter:{duration:.2,ease:Xg.easeOut},exit:{duration:.1,ease:Xg.easeIn}},ph={enter:(t,e)=>({...t,delay:typeof e=="number"?e:e==null?void 0:e.enter}),exit:(t,e)=>({...t,delay:typeof e=="number"?e:e==null?void 0:e.exit})},gfe=t=>t!=null&&parseInt(t.toString(),10)>0,fL={exit:{height:{duration:.2,ease:Xg.ease},opacity:{duration:.3,ease:Xg.ease}},enter:{height:{duration:.3,ease:Xg.ease},opacity:{duration:.4,ease:Xg.ease}}},yfe={exit:({animateOpacity:t,startingHeight:e,transition:r,transitionEnd:n,delay:i})=>({...t&&{opacity:gfe(e)?1:0},height:e,transitionEnd:n==null?void 0:n.exit,transition:(r==null?void 0:r.exit)??ph.exit(fL.exit,i)}),enter:({animateOpacity:t,endingHeight:e,transition:r,transitionEnd:n,delay:i})=>({...t&&{opacity:1},height:e,transitionEnd:n==null?void 0:n.enter,transition:(r==null?void 0:r.enter)??ph.enter(fL.enter,i)})},bc=I.forwardRef((t,e)=>{const{in:r,unmountOnExit:n,animateOpacity:i=!0,startingHeight:s=0,endingHeight:a="auto",style:o,className:d,transition:m,transitionEnd:y,animatePresenceProps:v,...w}=t,[O,P]=I.useState(!1);I.useEffect(()=>{const D=setTimeout(()=>{P(!0)});return()=>clearTimeout(D)},[]),h1({condition:Number(s)>0&&!!n,message:"startingHeight and unmountOnExit are mutually exclusive. You can't use them together"});const E=parseFloat(s.toString())>0,$={startingHeight:s,endingHeight:a,animateOpacity:i,transition:O?m:{enter:{duration:0}},transitionEnd:{enter:y==null?void 0:y.enter,exit:n?y==null?void 0:y.exit:{...y==null?void 0:y.exit,display:E?"block":"none"}}},R=n?r:!0,F=r||n?"enter":"exit";return u.jsx(vc,{...v,initial:!1,custom:$,children:R&&u.jsx(Ln.div,{ref:e,...w,className:lr("chakra-collapse",d),style:{overflow:"hidden",display:"block",...o},custom:$,variants:yfe,initial:n?"exit":!1,animate:F,exit:"exit"})})});bc.displayName="Collapse";const G5=Tt(function(e,r){const{className:n,motionProps:i,...s}=e,{reduceMotion:a}=W5(),{getPanelProps:o,isOpen:d}=V5(),m=o(s,r),y=lr("chakra-accordion__panel",n),v=Zk();a||delete m.hidden;const w=u.jsx(mt.div,{...m,__css:v.panel,className:y});return a?w:u.jsx(bc,{in:d,...i,children:w})});G5.displayName="AccordionPanel";const Qt=Tt(function(e,r){const n=ll("Badge",e),{className:i,...s}=Rn(e);return u.jsx(mt.span,{ref:r,className:lr("chakra-badge",e.className),...s,__css:{display:"inline-block",whiteSpace:"nowrap",verticalAlign:"middle",...n}})});Qt.displayName="Badge";const ue=mt("div");ue.displayName="Box";const[xfe,vfe]=_n({strict:!1,name:"ButtonGroupContext"});function uv(t){const{children:e,className:r,...n}=t,i=I.isValidElement(e)?I.cloneElement(e,{"aria-hidden":!0,focusable:!1}):e,s=lr("chakra-button__icon",r);return u.jsx(mt.span,{display:"inline-flex",alignSelf:"center",flexShrink:0,...n,className:s,children:i})}uv.displayName="ButtonIcon";function xA(t){const{label:e,placement:r,spacing:n="0.5rem",children:i=u.jsx(kn,{color:"currentColor",width:"1em",height:"1em"}),className:s,__css:a,...o}=t,d=lr("chakra-button__spinner",s),m=r==="start"?"marginEnd":"marginStart",y=I.useMemo(()=>({display:"flex",alignItems:"center",position:e?"relative":"absolute",[m]:e?n:0,fontSize:"1em",lineHeight:"normal",...a}),[a,e,m,n]);return u.jsx(mt.div,{className:d,...o,__css:y,children:i})}xA.displayName="ButtonSpinner";function bfe(t){const[e,r]=I.useState(!t);return{ref:I.useCallback(s=>{s&&r(s.tagName==="BUTTON")},[]),type:e?"button":void 0}}const gt=Tt((t,e)=>{const r=vfe(),n=ll("Button",{...r,...t}),{isDisabled:i=r==null?void 0:r.isDisabled,isLoading:s,isActive:a,children:o,leftIcon:d,rightIcon:m,loadingText:y,iconSpacing:v="0.5rem",type:w,spinner:O,spinnerPlacement:P="start",className:E,as:$,shouldWrapChildren:R,...F}=Rn(t),D=I.useMemo(()=>{const K={...n==null?void 0:n._focus,zIndex:1};return{display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",outline:"none",...n,...!!r&&{_focus:K}}},[n,r]),{ref:U,type:X}=bfe($),ee={rightIcon:m,leftIcon:d,iconSpacing:v,children:o,shouldWrapChildren:R};return u.jsxs(mt.button,{disabled:i||s,ref:HY(e,U),as:$,type:w??X,"data-active":Sr(a),"data-loading":Sr(s),__css:D,className:lr("chakra-button",E),...F,children:[s&&P==="start"&&u.jsx(xA,{className:"chakra-button__spinner--start",label:y,placement:"start",spacing:v,children:O}),s?y||u.jsx(mt.span,{opacity:0,children:u.jsx(pL,{...ee})}):u.jsx(pL,{...ee}),s&&P==="end"&&u.jsx(xA,{className:"chakra-button__spinner--end",label:y,placement:"end",spacing:v,children:O})]})});gt.displayName="Button";function pL(t){const{leftIcon:e,rightIcon:r,children:n,iconSpacing:i,shouldWrapChildren:s}=t;return s?u.jsxs("span",{style:{display:"contents"},children:[e&&u.jsx(uv,{marginEnd:i,children:e}),n,r&&u.jsx(uv,{marginStart:i,children:r})]}):u.jsxs(u.Fragment,{children:[e&&u.jsx(uv,{marginEnd:i,children:e}),n,r&&u.jsx(uv,{marginStart:i,children:r})]})}const _fe={horizontal:{"> *:first-of-type:not(:last-of-type)":{borderEndRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderStartRadius:0}},vertical:{"> *:first-of-type:not(:last-of-type)":{borderBottomRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderTopRadius:0}}},wfe={horizontal:t=>({"& > *:not(style) ~ *:not(style)":{marginStart:t}}),vertical:t=>({"& > *:not(style) ~ *:not(style)":{marginTop:t}})},Yk=Tt(function(e,r){const{size:n,colorScheme:i,variant:s,className:a,spacing:o="0.5rem",isAttached:d,isDisabled:m,orientation:y="horizontal",...v}=e,w=lr("chakra-button__group",a),O=I.useMemo(()=>({size:n,colorScheme:i,variant:s,isDisabled:m}),[n,i,s,m]);let P={display:"inline-flex",...d?_fe[y]:wfe[y](o)};const E=y==="vertical";return u.jsx(xfe,{value:O,children:u.jsx(mt.div,{ref:r,role:"group",__css:P,className:w,"data-attached":d?"":void 0,"data-orientation":y,flexDir:E?"column":void 0,...v})})});Yk.displayName="ButtonGroup";const gr=Tt((t,e)=>{const{icon:r,children:n,isRound:i,"aria-label":s,...a}=t,o=r||n,d=I.isValidElement(o)?I.cloneElement(o,{"aria-hidden":!0,focusable:!1}):null;return u.jsx(gt,{px:"0",py:"0",borderRadius:i?"full":void 0,ref:e,"aria-label":s,...a,children:d})});gr.displayName="IconButton";const[Sfe,kfe]=Fae("Card"),Rr=Tt(function(e,r){const{className:n,children:i,direction:s="column",justify:a,align:o,...d}=Rn(e),m=ls("Card",e);return u.jsx(mt.div,{ref:r,className:lr("chakra-card",n),__css:{display:"flex",flexDirection:s,justifyContent:a,alignItems:o,position:"relative",minWidth:0,wordWrap:"break-word",...m.container},...d,children:u.jsx(Sfe,{value:m,children:i})})}),Lr=Tt(function(e,r){const{className:n,...i}=e,s=kfe();return u.jsx(mt.div,{ref:r,className:lr("chakra-card__body",n),__css:s.body,...i})}),im=mt("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});im.displayName="Center";const Cfe={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};Tt(function(e,r){const{axis:n="both",...i}=e;return u.jsx(mt.div,{ref:r,__css:Cfe[n],...i,position:"absolute"})});const[EAe,Tfe]=_n({name:"CheckboxGroupContext",strict:!1});function Ofe(t){return u.jsx(mt.svg,{width:"1.2em",viewBox:"0 0 12 10",style:{fill:"none",strokeWidth:2,stroke:"currentColor",strokeDasharray:16},...t,children:u.jsx("polyline",{points:"1.5 6 4.5 9 10.5 1"})})}function jfe(t){return u.jsx(mt.svg,{width:"1.2em",viewBox:"0 0 24 24",style:{stroke:"currentColor",strokeWidth:4},...t,children:u.jsx("line",{x1:"21",x2:"3",y1:"12",y2:"12"})})}function Pfe(t){const{isIndeterminate:e,isChecked:r,...n}=t,i=e?jfe:Ofe;return r||e?u.jsx(mt.div,{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:u.jsx(i,{...n})}):null}var Afe=()=>typeof document<"u",mL=!1,w1=null,sm=!1,vA=!1,bA=new Set;function X5(t,e){bA.forEach(r=>r(t,e))}var Efe=typeof window<"u"&&window.navigator!=null?/^Mac/.test(window.navigator.platform):!1;function zfe(t){return!(t.metaKey||!Efe&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function gL(t){sm=!0,zfe(t)&&(w1="keyboard",X5("keyboard",t))}function yg(t){if(w1="pointer",t.type==="mousedown"||t.type==="pointerdown"){sm=!0;const e=t.composedPath?t.composedPath()[0]:t.target;let r=!1;try{r=e.matches(":focus-visible")}catch{}if(r)return;X5("pointer",t)}}function Mfe(t){return t.mozInputSource===0&&t.isTrusted?!0:t.detail===0&&!t.pointerType}function Ife(t){Mfe(t)&&(sm=!0,w1="virtual")}function Rfe(t){t.target===window||t.target===document||t.target instanceof Element&&t.target.hasAttribute("tabindex")||(!sm&&!vA&&(w1="virtual",X5("virtual",t)),sm=!1,vA=!1)}function Dfe(){sm=!1,vA=!0}function yL(){return w1!=="pointer"}function Lfe(){if(!Afe()||mL)return;const{focus:t}=HTMLElement.prototype;HTMLElement.prototype.focus=function(...r){sm=!0,t.apply(this,r)},document.addEventListener("keydown",gL,!0),document.addEventListener("keyup",gL,!0),document.addEventListener("click",Ife,!0),window.addEventListener("focus",Rfe,!0),window.addEventListener("blur",Dfe,!1),typeof PointerEvent<"u"?(document.addEventListener("pointerdown",yg,!0),document.addEventListener("pointermove",yg,!0),document.addEventListener("pointerup",yg,!0)):(document.addEventListener("mousedown",yg,!0),document.addEventListener("mousemove",yg,!0),document.addEventListener("mouseup",yg,!0)),mL=!0}function uW(t){Lfe(),t(yL());const e=()=>t(yL());return bA.add(e),()=>{bA.delete(e)}}const[Ffe,hW]=_n({name:"FormControlStylesContext",errorMessage:`useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormControl />" `}),[Bfe,S1]=_n({strict:!1,name:"FormControlContext"});function $fe(t){const{id:e,isRequired:r,isInvalid:n,isDisabled:i,isReadOnly:s,...a}=t,o=I.useId(),d=e||`field-${o}`,m=`${d}-label`,y=`${d}-feedback`,v=`${d}-helptext`,[w,O]=I.useState(!1),[P,E]=I.useState(!1),[$,R]=I.useState(!1),F=I.useCallback((K={},Y=null)=>({id:v,...K,ref:bi(Y,ne=>{ne&&E(!0)})}),[v]),D=I.useCallback((K={},Y=null)=>({...K,ref:Y,"data-focus":Sr($),"data-disabled":Sr(i),"data-invalid":Sr(n),"data-readonly":Sr(s),id:K.id!==void 0?K.id:m,htmlFor:K.htmlFor!==void 0?K.htmlFor:d}),[d,i,$,n,s,m]),U=I.useCallback((K={},Y=null)=>({id:y,...K,ref:bi(Y,ne=>{ne&&O(!0)}),"aria-live":"polite"}),[y]),X=I.useCallback((K={},Y=null)=>({...K,...a,ref:Y,role:"group","data-focus":Sr($),"data-disabled":Sr(i),"data-invalid":Sr(n),"data-readonly":Sr(s)}),[a,i,$,n,s]),ee=I.useCallback((K={},Y=null)=>({...K,ref:Y,role:"presentation","aria-hidden":!0,children:K.children||"*"}),[]);return{isRequired:!!r,isInvalid:!!n,isReadOnly:!!s,isDisabled:!!i,isFocused:!!$,onFocus:()=>R(!0),onBlur:()=>R(!1),hasFeedbackText:w,setHasFeedbackText:O,hasHelpText:P,setHasHelpText:E,id:d,labelId:m,feedbackId:y,helpTextId:v,htmlProps:a,getHelpTextProps:F,getErrorMessageProps:U,getRootProps:X,getLabelProps:D,getRequiredIndicatorProps:ee}}const Ot=Tt(function(e,r){const n=ls("Form",e),i=Rn(e),{getRootProps:s,htmlProps:a,...o}=$fe(i),d=lr("chakra-form-control",e.className);return u.jsx(Bfe,{value:o,children:u.jsx(Ffe,{value:n,children:u.jsx(mt.div,{...s({},r),className:d,__css:n.container})})})});Ot.displayName="FormControl";const Nfe=Tt(function(e,r){const n=S1(),i=hW(),s=lr("chakra-form__helper-text",e.className);return u.jsx(mt.div,{...n==null?void 0:n.getHelpTextProps(e,r),__css:i.helperText,className:s})});Nfe.displayName="FormHelperText";function K5(t){const{isDisabled:e,isInvalid:r,isReadOnly:n,isRequired:i,...s}=Z5(t);return{...s,disabled:e,readOnly:n,required:i,"aria-invalid":Fl(r),"aria-required":Fl(i),"aria-readonly":Fl(n)}}function Z5(t){const e=S1(),{id:r,disabled:n,readOnly:i,required:s,isRequired:a,isInvalid:o,isReadOnly:d,isDisabled:m,onFocus:y,onBlur:v,...w}=t,O=t["aria-describedby"]?[t["aria-describedby"]]:[];return e!=null&&e.hasFeedbackText&&(e!=null&&e.isInvalid)&&O.push(e.feedbackId),e!=null&&e.hasHelpText&&O.push(e.helpTextId),{...w,"aria-describedby":O.join(" ")||void 0,id:r??(e==null?void 0:e.id),isDisabled:n??m??(e==null?void 0:e.isDisabled),isReadOnly:i??d??(e==null?void 0:e.isReadOnly),isRequired:s??a??(e==null?void 0:e.isRequired),isInvalid:o??(e==null?void 0:e.isInvalid),onFocus:Cr(e==null?void 0:e.onFocus,y),onBlur:Cr(e==null?void 0:e.onBlur,v)}}const dW={border:"0",clip:"rect(0, 0, 0, 0)",height:"1px",width:"1px",margin:"-1px",padding:"0",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"};function fW(t={}){const e=Z5(t),{isDisabled:r,isReadOnly:n,isRequired:i,isInvalid:s,id:a,onBlur:o,onFocus:d,"aria-describedby":m}=e,{defaultChecked:y,isChecked:v,isFocusable:w,onChange:O,isIndeterminate:P,name:E,value:$,tabIndex:R=void 0,"aria-label":F,"aria-labelledby":D,"aria-invalid":U,...X}=t,ee=Sk(X,["isDisabled","isReadOnly","isRequired","isInvalid","id","onBlur","onFocus","aria-describedby"]),K=Vi(O),Y=Vi(o),ne=Vi(d),[oe,ce]=I.useState(!1),[Xe,Ae]=I.useState(!1),[We,Ye]=I.useState(!1),tt=I.useRef(!1);I.useEffect(()=>uW(_t=>{tt.current=_t}),[]);const Be=I.useRef(null),[Me,Ge]=I.useState(!0),[De,Le]=I.useState(!!y),Oe=v!==void 0,Ie=Oe?v:De,st=I.useCallback(_t=>{if(n||r){_t.preventDefault();return}Oe||Le(Ie?_t.currentTarget.checked:P?!0:_t.currentTarget.checked),K==null||K(_t)},[n,r,Ie,Oe,P,K]);Rp(()=>{Be.current&&(Be.current.indeterminate=!!P)},[P]),ef(()=>{r&&ce(!1)},[r,ce]),Rp(()=>{const _t=Be.current;if(!(_t!=null&&_t.form))return;const rt=()=>{Le(!!y)};return _t.form.addEventListener("reset",rt),()=>{var Te;return(Te=_t.form)==null?void 0:Te.removeEventListener("reset",rt)}},[]);const Re=r&&!w,it=I.useCallback(_t=>{_t.key===" "&&Ye(!0)},[Ye]),Ke=I.useCallback(_t=>{_t.key===" "&&Ye(!1)},[Ye]);Rp(()=>{if(!Be.current)return;Be.current.checked!==Ie&&Le(Be.current.checked)},[Be.current]);const St=I.useCallback((_t={},rt=null)=>{const Te=ct=>{oe&&ct.preventDefault(),Ye(!0)};return{..._t,ref:rt,"data-active":Sr(We),"data-hover":Sr(Xe),"data-checked":Sr(Ie),"data-focus":Sr(oe),"data-focus-visible":Sr(oe&&tt.current),"data-indeterminate":Sr(P),"data-disabled":Sr(r),"data-invalid":Sr(s),"data-readonly":Sr(n),"aria-hidden":!0,onMouseDown:Cr(_t.onMouseDown,Te),onMouseUp:Cr(_t.onMouseUp,()=>Ye(!1)),onMouseEnter:Cr(_t.onMouseEnter,()=>Ae(!0)),onMouseLeave:Cr(_t.onMouseLeave,()=>Ae(!1))}},[We,Ie,r,oe,Xe,P,s,n]),Mt=I.useCallback((_t={},rt=null)=>({..._t,ref:rt,"data-active":Sr(We),"data-hover":Sr(Xe),"data-checked":Sr(Ie),"data-focus":Sr(oe),"data-focus-visible":Sr(oe&&tt.current),"data-indeterminate":Sr(P),"data-disabled":Sr(r),"data-invalid":Sr(s),"data-readonly":Sr(n)}),[We,Ie,r,oe,Xe,P,s,n]),Et=I.useCallback((_t={},rt=null)=>({...ee,..._t,ref:bi(rt,Te=>{Te&&Ge(Te.tagName==="LABEL")}),onClick:Cr(_t.onClick,()=>{var Te;Me||((Te=Be.current)==null||Te.click(),requestAnimationFrame(()=>{var ct;(ct=Be.current)==null||ct.focus({preventScroll:!0})}))}),"data-disabled":Sr(r),"data-checked":Sr(Ie),"data-invalid":Sr(s)}),[ee,r,Ie,s,Me]),xt=I.useCallback((_t={},rt=null)=>({..._t,ref:bi(Be,rt),type:"checkbox",name:E,value:$,id:a,tabIndex:R,onChange:Cr(_t.onChange,st),onBlur:Cr(_t.onBlur,Y,()=>ce(!1)),onFocus:Cr(_t.onFocus,ne,()=>ce(!0)),onKeyDown:Cr(_t.onKeyDown,it),onKeyUp:Cr(_t.onKeyUp,Ke),required:i,checked:Ie,disabled:Re,readOnly:n,"aria-label":F,"aria-labelledby":D,"aria-invalid":U?!!U:s,"aria-describedby":m,"aria-disabled":r,"aria-checked":P?"mixed":Ie,style:dW}),[E,$,a,R,st,Y,ne,it,Ke,i,Ie,Re,n,F,D,U,s,m,r,P]),et=I.useCallback((_t={},rt=null)=>({..._t,ref:rt,onMouseDown:Cr(_t.onMouseDown,Vfe),"data-disabled":Sr(r),"data-checked":Sr(Ie),"data-invalid":Sr(s)}),[Ie,r,s]);return{state:{isInvalid:s,isFocused:oe,isChecked:Ie,isActive:We,isHovered:Xe,isIndeterminate:P,isDisabled:r,isReadOnly:n,isRequired:i},getRootProps:Et,getCheckboxProps:St,getIndicatorProps:Mt,getInputProps:xt,getLabelProps:et,htmlProps:ee}}function Vfe(t){t.preventDefault(),t.stopPropagation()}function Wfe(t){const[e,r]=I.useState(t),[n,i]=I.useState(!1);return t!==e&&(i(!0),r(t)),n}const Ufe={display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"top",userSelect:"none",flexShrink:0},qfe={cursor:"pointer",display:"inline-flex",alignItems:"center",verticalAlign:"top",position:"relative"},Qfe=lo({from:{opacity:0,strokeDashoffset:16,transform:"scale(0.95)"},to:{opacity:1,strokeDashoffset:0,transform:"scale(1)"}}),Hfe=lo({from:{opacity:0},to:{opacity:1}}),Gfe=lo({from:{transform:"scaleX(0.65)"},to:{transform:"scaleX(1)"}}),Ga=Tt(function(e,r){const n=Tfe(),i={...n,...e},s=ls("Checkbox",i),a=Rn(e),{spacing:o="0.5rem",className:d,children:m,iconColor:y,iconSize:v,icon:w=u.jsx(Pfe,{}),isChecked:O,isDisabled:P=n==null?void 0:n.isDisabled,onChange:E,inputProps:$,...R}=a;let F=O;n!=null&&n.value&&a.value&&(F=n.value.includes(a.value));let D=E;n!=null&&n.onChange&&a.value&&(D=Hz(n.onChange,E));const{state:U,getInputProps:X,getCheckboxProps:ee,getLabelProps:K,getRootProps:Y}=fW({...R,isDisabled:P,isChecked:F,onChange:D}),ne=Wfe(U.isChecked),oe=I.useMemo(()=>({animation:ne?U.isIndeterminate?`${Hfe} 20ms linear, ${Gfe} 200ms linear`:`${Qfe} 200ms linear`:void 0,...s.icon,...wk({fontSize:v,color:y})}),[y,v,ne,U.isIndeterminate,s.icon]),ce=I.cloneElement(w,{__css:oe,isIndeterminate:U.isIndeterminate,isChecked:U.isChecked});return u.jsxs(mt.label,{__css:{...qfe,...s.container},className:lr("chakra-checkbox",d),...Y(),children:[u.jsx("input",{className:"chakra-checkbox__input",...X($,r)}),u.jsx(mt.span,{__css:{...Ufe,...s.control},className:"chakra-checkbox__control",...ee(),children:ce}),m&&u.jsx(mt.span,{className:"chakra-checkbox__label",...K(),__css:{marginStart:o,...s.label},children:m})]})});Ga.displayName="Checkbox";const nh=Tt(function(e,r){const n=ll("Code",e),{className:i,...s}=Rn(e);return u.jsx(mt.code,{ref:r,className:lr("chakra-code",e.className),...s,__css:{display:"inline-block",...n}})});nh.displayName="Code";const Nr=Tt(function(e,r){const{borderLeftWidth:n,borderBottomWidth:i,borderTopWidth:s,borderRightWidth:a,borderWidth:o,borderStyle:d,borderColor:m,...y}=ll("Divider",e),{className:v,orientation:w="horizontal",__css:O,...P}=Rn(e),E={vertical:{borderLeftWidth:n||a||o||"1px",height:"100%"},horizontal:{borderBottomWidth:i||s||o||"1px",width:"100%"}};return u.jsx(mt.hr,{ref:r,"aria-orientation":w,...P,__css:{...y,border:"0",borderColor:m,borderStyle:d,...E[w],...O},className:lr("chakra-divider",v)})});Nr.displayName="Divider";function hv(t){return typeof t=="function"}function Xfe(...t){return e=>t.reduce((r,n)=>n(r),e)}const Kfe=t=>function(...r){let n=[...r],i=r[r.length-1];return joe(i)&&n.length>1?n=n.slice(0,n.length-1):i=t,Xfe(...n.map(s=>a=>hv(s)?s(a):Yfe(a,s)))(i)},Zfe=Kfe(hV);function Yfe(...t){return zl({},...t,pW)}function pW(t,e,r,n){if((hv(t)||hv(e))&&Object.prototype.hasOwnProperty.call(n,r))return(...i)=>{const s=hv(t)?t(...i):t,a=hv(e)?e(...i):e;return zl({},s,a,pW)};if(no(t)&&NP(e)||NP(t)&&no(e))return e}const yr=Tt(function(e,r){const{direction:n,align:i,justify:s,wrap:a,basis:o,grow:d,shrink:m,...y}=e,v={display:"flex",flexDirection:n,alignItems:i,justifyContent:s,flexWrap:a,flexBasis:o,flexGrow:d,flexShrink:m};return u.jsx(mt.div,{ref:r,__css:v,...y})});yr.displayName="Flex";function mW(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var _A="data-focus-lock",gW="data-focus-lock-disabled",Jfe="data-no-focus-lock",epe="data-autofocus-inside",tpe="data-no-autofocus";function qO(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function rpe(t,e){var r=I.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=e,r.facade}var npe=typeof window<"u"?I.useLayoutEffect:I.useEffect,xL=new WeakMap;function yW(t,e){var r=rpe(null,function(n){return t.forEach(function(i){return qO(i,n)})});return npe(function(){var n=xL.get(r);if(n){var i=new Set(n),s=new Set(t),a=r.current;i.forEach(function(o){s.has(o)||qO(o,null)}),s.forEach(function(o){i.has(o)||qO(o,a)})}xL.set(r,t)},[t]),r}var QO={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},iu=function(){return iu=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},iu.apply(this,arguments)};function xW(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function ipe(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}function vW(t){return t}function bW(t,e){e===void 0&&(e=vW);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(s){var a=e(s,n);return r.push(a),function(){r=r.filter(function(o){return o!==a})}},assignSyncMedium:function(s){for(n=!0;r.length;){var a=r;r=[],a.forEach(s)}r={push:function(o){return s(o)},filter:function(){return r}}},assignMedium:function(s){n=!0;var a=[];if(r.length){var o=r;r=[],o.forEach(s),a=r}var d=function(){var y=a;a=[],y.forEach(s)},m=function(){return Promise.resolve().then(d)};m(),r={push:function(y){a.push(y),m()},filter:function(y){return a=a.filter(y),r}}}};return i}function Y5(t,e){return e===void 0&&(e=vW),bW(t,e)}function _W(t){t===void 0&&(t={});var e=bW(null);return e.options=iu({async:!0,ssr:!1},t),e}var wW=function(t){var e=t.sideCar,r=xW(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return I.createElement(n,iu({},r))};wW.isSideCarExport=!0;function spe(t,e){return t.useMedium(e),wW}var SW=Y5({},function(t){var e=t.target,r=t.currentTarget;return{target:e,currentTarget:r}}),kW=Y5(),ope=Y5(),ape=_W({async:!0,ssr:typeof document<"u"}),lpe=I.createContext(void 0),cpe=[],J5=I.forwardRef(function(e,r){var n,i=I.useState(),s=i[0],a=i[1],o=I.useRef(),d=I.useRef(!1),m=I.useRef(null),y=I.useState({}),v=y[1],w=e.children,O=e.disabled,P=O===void 0?!1:O,E=e.noFocusGuards,$=E===void 0?!1:E,R=e.persistentFocus,F=R===void 0?!1:R,D=e.crossFrame,U=D===void 0?!0:D,X=e.autoFocus,ee=X===void 0?!0:X;e.allowTextSelection;var K=e.group,Y=e.className,ne=e.whiteList,oe=e.hasPositiveIndices,ce=e.shards,Xe=ce===void 0?cpe:ce,Ae=e.as,We=Ae===void 0?"div":Ae,Ye=e.lockProps,tt=Ye===void 0?{}:Ye,Be=e.sideCar,Me=e.returnFocus,Ge=Me===void 0?!1:Me,De=e.focusOptions,Le=e.onActivation,Oe=e.onDeactivation,Ie=I.useState({}),st=Ie[0],Re=I.useCallback(function(Te){var ct=Te.captureFocusRestore;if(!m.current){var Vt,wt=(Vt=document)==null?void 0:Vt.activeElement;m.current=wt,wt!==document.body&&(m.current=ct(wt))}o.current&&Le&&Le(o.current),d.current=!0,v()},[Le]),it=I.useCallback(function(){d.current=!1,Oe&&Oe(o.current),v()},[Oe]),Ke=I.useCallback(function(Te){var ct=m.current;if(ct){var Vt=(typeof ct=="function"?ct():ct)||document.body,wt=typeof Ge=="function"?Ge(Vt):Ge;if(wt){var Ft=typeof wt=="object"?wt:void 0;m.current=null,Te?Promise.resolve().then(function(){return Vt.focus(Ft)}):Vt.focus(Ft)}}},[Ge]),St=I.useCallback(function(Te){d.current&&SW.useMedium(Te)},[]),Mt=kW.useMedium,Et=I.useCallback(function(Te){o.current!==Te&&(o.current=Te,a(Te))},[]),xt=tf((n={},n[gW]=P&&"disabled",n[_A]=K,n),tt),et=$!==!0,Yt=et&&$!=="tail",_t=yW([r,Et]),rt=I.useMemo(function(){return{observed:o,shards:Xe,enabled:!P,get active(){return d.current}}},[P,d,Xe,o]);return $i.createElement(I.Fragment,null,et&&[$i.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:P?-1:0,style:QO}),oe?$i.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:P?-1:1,style:QO}):null],!P&&$i.createElement(Be,{id:st,sideCar:ape,observed:s,disabled:P,persistentFocus:F,crossFrame:U,autoFocus:ee,whiteList:ne,shards:Xe,onActivation:Re,onDeactivation:it,returnFocus:Ke,focusOptions:De,noFocusGuards:$}),$i.createElement(We,tf({ref:_t},xt,{className:Y,onBlur:Mt,onFocus:St}),$i.createElement(lpe.Provider,{value:rt},w)),Yt&&$i.createElement("div",{"data-focus-guard":!0,tabIndex:P?-1:0,style:QO}))});J5.propTypes={};function wA(t,e){return wA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},wA(t,e)}function upe(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,wA(t,e)}function Cb(t){"@babel/helpers - typeof";return Cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cb(t)}function hpe(t,e){if(Cb(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Cb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dpe(t){var e=hpe(t,"string");return Cb(e)=="symbol"?e:e+""}function fpe(t,e,r){return(e=dpe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ppe(t,e){function r(n){return n.displayName||n.name||"Component"}return function(i){var s=[],a;function o(){a=t(s.map(function(m){return m.props})),e(a)}var d=function(m){upe(y,m);function y(){return m.apply(this,arguments)||this}y.peek=function(){return a};var v=y.prototype;return v.componentDidMount=function(){s.push(this),o()},v.componentDidUpdate=function(){o()},v.componentWillUnmount=function(){var O=s.indexOf(this);s.splice(O,1),o()},v.render=function(){return $i.createElement(i,this.props)},y}(I.PureComponent);return fpe(d,"displayName","SideEffect("+r(i)+")"),d}}var wu=function(t){for(var e=Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e},om=function(t){return Array.isArray(t)?t:[t]},CW=function(t){return Array.isArray(t)?t[0]:t},mpe=function(t){if(t.nodeType!==Node.ELEMENT_NODE)return!1;var e=window.getComputedStyle(t,null);return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},TW=function(t){return t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.host:t.parentNode},OW=function(t){return t===document||t&&t.nodeType===Node.DOCUMENT_NODE},gpe=function(t){return t.hasAttribute("inert")},ype=function(t,e){return!t||OW(t)||!mpe(t)&&!gpe(t)&&e(TW(t))},jW=function(t,e){var r=t.get(e);if(r!==void 0)return r;var n=ype(e,jW.bind(void 0,t));return t.set(e,n),n},xpe=function(t,e){return t&&!OW(t)?_pe(t)?e(TW(t)):!1:!0},PW=function(t,e){var r=t.get(e);if(r!==void 0)return r;var n=xpe(e,PW.bind(void 0,t));return t.set(e,n),n},AW=function(t){return t.dataset},vpe=function(t){return t.tagName==="BUTTON"},EW=function(t){return t.tagName==="INPUT"},zW=function(t){return EW(t)&&t.type==="radio"},bpe=function(t){return!((EW(t)||vpe(t))&&(t.type==="hidden"||t.disabled))},_pe=function(t){var e=t.getAttribute(tpe);return![!0,"true",""].includes(e)},eM=function(t){var e;return!!(t&&(!((e=AW(t))===null||e===void 0)&&e.focusGuard))},SA=function(t){return!eM(t)},wpe=function(t){return!!t},Spe=function(t,e){var r=Math.max(0,t.tabIndex),n=Math.max(0,e.tabIndex),i=r-n,s=t.index-e.index;if(i){if(!r)return 1;if(!n)return-1}return i||s},kpe=function(t){return t.tabIndex<0&&!t.hasAttribute("tabindex")?0:t.tabIndex},tM=function(t,e,r){return wu(t).map(function(n,i){var s=kpe(n);return{node:n,index:i,tabIndex:r&&s===-1?(n.dataset||{}).focusGuard?0:-1:s}}).filter(function(n){return!e||n.tabIndex>=0}).sort(Spe)},Cpe=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],rM=Cpe.join(","),Tpe="".concat(rM,", [data-focus-guard]"),MW=function(t,e){return wu((t.shadowRoot||t).children).reduce(function(r,n){return r.concat(n.matches(e?Tpe:rM)?[n]:[],MW(n))},[])},Ope=function(t,e){var r;return t instanceof HTMLIFrameElement&&(!((r=t.contentDocument)===null||r===void 0)&&r.body)?Zy([t.contentDocument.body],e):[t]},Zy=function(t,e){return t.reduce(function(r,n){var i,s=MW(n,e),a=(i=[]).concat.apply(i,s.map(function(o){return Ope(o,e)}));return r.concat(a,n.parentNode?wu(n.parentNode.querySelectorAll(rM)).filter(function(o){return o===n}):[])},[])},jpe=function(t){var e=t.querySelectorAll("[".concat(epe,"]"));return wu(e).map(function(r){return Zy([r])}).reduce(function(r,n){return r.concat(n)},[])},nM=function(t,e){return wu(t).filter(function(r){return jW(e,r)}).filter(function(r){return bpe(r)})},vL=function(t,e){return e===void 0&&(e=new Map),wu(t).filter(function(r){return PW(e,r)})},iM=function(t,e,r){return tM(nM(Zy(t,r),e),!0,r)},Tb=function(t,e){return tM(nM(Zy(t),e),!1)},Ppe=function(t,e){return nM(jpe(t),e)},Np=function(t,e){return t.shadowRoot?Np(t.shadowRoot,e):Object.getPrototypeOf(t).contains!==void 0&&Object.getPrototypeOf(t).contains.call(t,e)?!0:wu(t.children).some(function(r){var n;if(r instanceof HTMLIFrameElement){var i=(n=r.contentDocument)===null||n===void 0?void 0:n.body;return i?Np(i,e):!1}return Np(r,e)})},Ape=function(t){for(var e=new Set,r=t.length,n=0;n<r;n+=1)for(var i=n+1;i<r;i+=1){var s=t[n].compareDocumentPosition(t[i]);(s&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&e.add(i),(s&Node.DOCUMENT_POSITION_CONTAINS)>0&&e.add(n)}return t.filter(function(a,o){return!e.has(o)})},IW=function(t){return t.parentNode?IW(t.parentNode):t},sM=function(t){var e=om(t);return e.filter(Boolean).reduce(function(r,n){var i=n.getAttribute(_A);return r.push.apply(r,i?Ape(wu(IW(n).querySelectorAll("[".concat(_A,'="').concat(i,'"]:not([').concat(gW,'="disabled"])')))):[n]),r},[])},Epe=function(t){try{return t()}catch{return}},Ob=function(t){if(t===void 0&&(t=document),!(!t||!t.activeElement)){var e=t.activeElement;return e.shadowRoot?Ob(e.shadowRoot):e instanceof HTMLIFrameElement&&Epe(function(){return e.contentWindow.document})?Ob(e.contentWindow.document):e}},zpe=function(t,e){return t===e},Mpe=function(t,e){return!!wu(t.querySelectorAll("iframe")).some(function(r){return zpe(r,e)})},RW=function(t,e){return e===void 0&&(e=Ob(CW(t).ownerDocument)),!e||e.dataset&&e.dataset.focusGuard?!1:sM(t).some(function(r){return Np(r,e)||Mpe(r,e)})},Ipe=function(t){t===void 0&&(t=document);var e=Ob(t);return e?wu(t.querySelectorAll("[".concat(Jfe,"]"))).some(function(r){return Np(r,e)}):!1},Rpe=function(t,e){return e.filter(zW).filter(function(r){return r.name===t.name}).filter(function(r){return r.checked})[0]||t},oM=function(t,e){return zW(t)&&t.name?Rpe(t,e):t},Dpe=function(t){var e=new Set;return t.forEach(function(r){return e.add(oM(r,t))}),t.filter(function(r){return e.has(r)})},bL=function(t){return t[0]&&t.length>1?oM(t[0],t):t[0]},_L=function(t,e){return t.indexOf(oM(e,t))},kA="NEW_FOCUS",Lpe=function(t,e,r,n,i){var s=t.length,a=t[0],o=t[s-1],d=eM(n);if(!(n&&t.indexOf(n)>=0)){var m=n!==void 0?r.indexOf(n):-1,y=i?r.indexOf(i):m,v=i?t.indexOf(i):-1;if(m===-1)return v!==-1?v:kA;if(v===-1)return kA;var w=m-y,O=r.indexOf(a),P=r.indexOf(o),E=Dpe(r),$=n!==void 0?E.indexOf(n):-1,R=i?E.indexOf(i):$,F=E.filter(function(Y){return Y.tabIndex>=0}),D=n!==void 0?F.indexOf(n):-1,U=i?F.indexOf(i):D,X=D>=0&&U>=0?U-D:R-$;if(!w&&v>=0||e.length===0)return v;var ee=_L(t,e[0]),K=_L(t,e[e.length-1]);if(m<=O&&d&&Math.abs(w)>1)return K;if(m>=P&&d&&Math.abs(w)>1)return ee;if(w&&Math.abs(X)>1)return v;if(m<=O)return K;if(m>P)return ee;if(w)return Math.abs(w)>1?v:(s+v+w)%s}},Fpe=function(t){return function(e){var r,n=(r=AW(e))===null||r===void 0?void 0:r.autofocus;return e.autofocus||n!==void 0&&n!=="false"||t.indexOf(e)>=0}},wL=function(t,e,r){var n=t.map(function(s){var a=s.node;return a}),i=vL(n.filter(Fpe(r)));return i&&i.length?bL(i):bL(vL(e))},CA=function(t,e){return e===void 0&&(e=[]),e.push(t),t.parentNode&&CA(t.parentNode.host||t.parentNode,e),e},HO=function(t,e){for(var r=CA(t),n=CA(e),i=0;i<r.length;i+=1){var s=r[i];if(n.indexOf(s)>=0)return s}return!1},DW=function(t,e,r){var n=om(t),i=om(e),s=n[0],a=!1;return i.filter(Boolean).forEach(function(o){a=HO(a||o,o)||a,r.filter(Boolean).forEach(function(d){var m=HO(s,d);m&&(!a||Np(m,a)?a=m:a=HO(m,a))})}),a},SL=function(t,e){return t.reduce(function(r,n){return r.concat(Ppe(n,e))},[])},Bpe=function(t,e){var r=new Map;return e.forEach(function(n){return r.set(n.node,n)}),t.map(function(n){return r.get(n)}).filter(wpe)},$pe=function(t,e){var r=Ob(om(t).length>0?document:CW(t).ownerDocument),n=sM(t).filter(SA),i=DW(r||t,t,n),s=new Map,a=Tb(n,s),o=a.filter(function(P){var E=P.node;return SA(E)});if(o[0]){var d=Tb([i],s).map(function(P){var E=P.node;return E}),m=Bpe(d,o),y=m.map(function(P){var E=P.node;return E}),v=m.filter(function(P){var E=P.tabIndex;return E>=0}).map(function(P){var E=P.node;return E}),w=Lpe(y,v,d,r,e);if(w===kA){var O=wL(a,v,SL(n,s))||wL(a,y,SL(n,s));if(O)return{node:O};console.warn("focus-lock: cannot find any node to move focus into");return}return w===void 0?w:m[w]}},Npe=function(t){var e=sM(t).filter(SA),r=DW(t,t,e),n=tM(Zy([r],!0),!0,!0),i=Zy(e,!1);return n.map(function(s){var a=s.node,o=s.index;return{node:a,index:o,lockItem:i.indexOf(a)>=0,guard:eM(a)}})},aM=function(t,e){t&&("focus"in t&&t.focus(e),"contentWindow"in t&&t.contentWindow&&t.contentWindow.focus())},GO=0,XO=!1,LW=function(t,e,r){r===void 0&&(r={});var n=$pe(t,e);if(!XO&&n){if(GO>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),XO=!0,setTimeout(function(){XO=!1},1);return}GO++,aM(n.node,r.focusOptions),GO--}};function Ux(t){if(!t)return null;if(typeof WeakRef>"u")return function(){return t||null};var e=t?new WeakRef(t):null;return function(){return(e==null?void 0:e.deref())||null}}var Vpe=function(t){if(!t)return null;for(var e=[],r=t;r&&r!==document.body;)e.push({current:Ux(r),parent:Ux(r.parentElement),left:Ux(r.previousElementSibling),right:Ux(r.nextElementSibling)}),r=r.parentElement;return{element:Ux(t),stack:e,ownerDocument:t.ownerDocument}},Wpe=function(t){var e,r,n,i,s;if(t)for(var a=t.stack,o=t.ownerDocument,d=new Map,m=0,y=a;m<y.length;m++){var v=y[m],w=(e=v.parent)===null||e===void 0?void 0:e.call(v);if(w&&o.contains(w)){for(var O=(r=v.left)===null||r===void 0?void 0:r.call(v),P=v.current(),E=w.contains(P)?P:void 0,$=(n=v.right)===null||n===void 0?void 0:n.call(v),R=iM([w],d),F=(s=(i=E??(O==null?void 0:O.nextElementSibling))!==null&&i!==void 0?i:$)!==null&&s!==void 0?s:O;F;){for(var D=0,U=R;D<U.length;D++){var X=U[D];if(F!=null&&F.contains(X.node))return X.node}F=F.nextElementSibling}if(R.length)return R[0].node}}},FW=function(t){var e=Vpe(t);return function(){return Wpe(e)}},Upe=function(t,e,r){if(!t||!e)return console.error("no element or scope given"),{};var n=om(e);if(n.every(function(a){return!Np(a,t)}))return console.error("Active element is not contained in the scope"),{};var i=r?iM(n,new Map):Tb(n,new Map),s=i.findIndex(function(a){var o=a.node;return o===t});if(s!==-1)return{prev:i[s-1],next:i[s+1],first:i[0],last:i[i.length-1]}},qpe=function(t,e){var r=e?iM(om(t),new Map):Tb(om(t),new Map);return{first:r[0],last:r[r.length-1]}},Qpe=function(t){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},t)},BW=function(t,e,r){e===void 0&&(e={});var n=Qpe(e),i=Upe(t,n.scope,n.onlyTabbable);if(i){var s=r(i,n.cycle);s&&aM(s.node,n.focusOptions)}},Hpe=function(t,e){e===void 0&&(e={}),BW(t,e,function(r,n){var i=r.next,s=r.first;return i||n&&s})},Gpe=function(t,e){e===void 0&&(e={}),BW(t,e,function(r,n){var i=r.prev,s=r.last;return i||n&&s})},$W=function(t,e,r){var n,i=qpe(t,(n=e.onlyTabbable)!==null&&n!==void 0?n:!0),s=i[r];s&&aM(s.node,e.focusOptions)},Xpe=function(t,e){e===void 0&&(e={}),$W(t,e,"first")},Kpe=function(t,e){e===void 0&&(e={}),$W(t,e,"last")};function lM(t){setTimeout(t,1)}var Zpe=function(e){return e&&"current"in e?e.current:e},NW=function(){return document&&document.activeElement===document.body},Ype=function(){return NW()||Ipe()},fy=null,ca=null,kL=function(){return null},py=null,jb=!1,cM=!1,Jpe=function(){return!0},eme=function(e){return(fy.whiteList||Jpe)(e)},tme=function(e,r){py={observerNode:e,portaledElement:r}},rme=function(e){return py&&py.portaledElement===e};function CL(t,e,r,n){var i=null,s=t;do{var a=n[s];if(a.guard)a.node.dataset.focusAutoGuard&&(i=a);else if(a.lockItem){if(s!==t)return;i=null}else break}while((s+=r)!==e);i&&(i.node.tabIndex=0)}var nme=function(e){return e?!!jb:jb==="meanwhile"},ime=function t(e,r,n){return r&&(r.host===e&&(!r.activeElement||n.contains(r.activeElement))||r.parentNode&&t(e,r.parentNode,n))},sme=function(e,r){return r.some(function(n){return ime(e,n,n)})},VW=function(e){return Tb(e,new Map)},ome=function(e){return!VW([e.parentNode]).some(function(r){return r.node===e})},S2=function(){var e=!1;if(fy){var r=fy,n=r.observed,i=r.persistentFocus,s=r.autoFocus,a=r.shards,o=r.crossFrame,d=r.focusOptions,m=r.noFocusGuards,y=n||py&&py.portaledElement;if(NW()&&ca&&ca!==document.body&&(!document.body.contains(ca)||ome(ca))){var v=kL();v&&v.focus()}var w=document&&document.activeElement;if(y){var O=[y].concat(a.map(Zpe).filter(Boolean)),P=function(){if(!nme(o)||!m||!ca||cM)return!1;var D=VW(O),U=D.findIndex(function(X){var ee=X.node;return ee===ca});return U===0||U===D.length-1};if((!w||eme(w))&&(i||P()||!Ype()||!ca&&s)&&(y&&!(RW(O)||w&&sme(w,O)||rme(w))&&(document&&!ca&&w&&!s?(w.blur&&w.blur(),document.body.focus()):(e=LW(O,ca,{focusOptions:d}),py={})),ca=document&&document.activeElement,ca!==document.body&&(kL=FW(ca)),jb=!1),document&&w!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var E=document&&document.activeElement,$=Npe(O),R=$.map(function(F){var D=F.node;return D}).indexOf(E);R>-1&&($.filter(function(F){var D=F.guard,U=F.node;return D&&U.dataset.focusAutoGuard}).forEach(function(F){var D=F.node;return D.removeAttribute("tabIndex")}),CL(R,$.length,1,$),CL(R,-1,-1,$))}}}return e},WW=function(e){S2()&&e&&(e.stopPropagation(),e.preventDefault())},uM=function(){return lM(S2)},ame=function(e){var r=e.target,n=e.currentTarget;n.contains(r)||tme(n,r)},lme=function(){return null},UW=function(){cM=!0},qW=function(){cM=!1,jb="just",lM(function(){jb="meanwhile"})},cme=function(){document.addEventListener("focusin",WW),document.addEventListener("focusout",uM),window.addEventListener("focus",UW),window.addEventListener("blur",qW)},ume=function(){document.removeEventListener("focusin",WW),document.removeEventListener("focusout",uM),window.removeEventListener("focus",UW),window.removeEventListener("blur",qW)};function hme(t){return t.filter(function(e){var r=e.disabled;return!r})}var QW={moveFocusInside:LW,focusInside:RW,focusNextElement:Hpe,focusPrevElement:Gpe,focusFirstElement:Xpe,focusLastElement:Kpe,captureFocusRestore:FW};function dme(t){var e=t.slice(-1)[0];e&&!fy&&cme();var r=fy,n=r&&e&&e.id===r.id;fy=e,r&&!n&&(r.onDeactivation(),t.filter(function(i){var s=i.id;return s===r.id}).length||r.returnFocus(!e)),e?(ca=null,(!n||r.observed!==e.observed)&&e.onActivation(QW),S2(),lM(S2)):(ume(),ca=null)}SW.assignSyncMedium(ame);kW.assignMedium(uM);ope.assignMedium(function(t){return t(QW)});const fme=ppe(hme,dme)(lme);var TA=I.forwardRef(function(e,r){return $i.createElement(J5,tf({sideCar:fme,ref:r},e))}),HW=J5.propTypes||{};HW.sideCar;mW(HW,["sideCar"]);TA.propTypes={};const pme=TA.default??TA,GW=t=>{const{initialFocusRef:e,finalFocusRef:r,contentRef:n,restoreFocus:i,children:s,isDisabled:a,autoFocus:o,persistentFocus:d,lockFocusAcrossFrames:m}=t,y=I.useCallback(()=>{e!=null&&e.current?e.current.focus():n!=null&&n.current&&jY(n.current).length===0&&requestAnimationFrame(()=>{var P;(P=n.current)==null||P.focus()})},[e,n]),v=I.useCallback(()=>{var O;(O=r==null?void 0:r.current)==null||O.focus()},[r]),w=i&&!r;return u.jsx(pme,{crossFrame:m,persistentFocus:d,autoFocus:o,disabled:a,onActivation:y,onDeactivation:v,returnFocus:w,children:s})};GW.displayName="FocusLock";const jt=Tt(function(e,r){const n=ll("FormLabel",e),i=Rn(e),{className:s,children:a,requiredIndicator:o=u.jsx(XW,{}),optionalIndicator:d=null,...m}=i,y=S1(),v=(y==null?void 0:y.getLabelProps(m,r))??{ref:r,...m};return u.jsxs(mt.label,{...v,className:lr("chakra-form__label",i.className),__css:{display:"block",textAlign:"start",...n},children:[a,y!=null&&y.isRequired?o:d]})});jt.displayName="FormLabel";const XW=Tt(function(e,r){const n=S1(),i=hW();if(!(n!=null&&n.isRequired))return null;const s=lr("chakra-form__required-indicator",e.className);return u.jsx(mt.span,{...n==null?void 0:n.getRequiredIndicatorProps(e,r),__css:i.requiredIndicator,className:s})});XW.displayName="RequiredIndicator";const KW=Tt(function(e,r){const{templateAreas:n,gap:i,rowGap:s,columnGap:a,column:o,row:d,autoFlow:m,autoRows:y,templateRows:v,autoColumns:w,templateColumns:O,...P}=e,E={display:"grid",gridTemplateAreas:n,gridGap:i,gridRowGap:s,gridColumnGap:a,gridAutoColumns:w,gridColumn:o,gridRow:d,gridAutoFlow:m,gridAutoRows:y,gridTemplateRows:v,gridTemplateColumns:O};return u.jsx(mt.div,{ref:r,__css:E,...P})});KW.displayName="Grid";const Wr=Tt(function(e,r){const{columns:n,spacingX:i,spacingY:s,spacing:a,minChildWidth:o,...d}=e,m=b1(),y=o?gme(o,m):yme(n);return u.jsx(KW,{ref:r,gap:a,columnGap:i,rowGap:s,templateColumns:y,...d})});Wr.displayName="SimpleGrid";function mme(t){return typeof t=="number"?`${t}px`:t}function gme(t,e){return Xz(t,r=>{const n=Ade("sizes",r,mme(r))(e);return r===null?null:`repeat(auto-fit, minmax(${n}, 1fr))`})}function yme(t){return Xz(t,e=>e===null?null:`repeat(${e}, minmax(0, 1fr))`)}const Ar=Tt(function(e,r){const{htmlSize:n,...i}=e,s=ls("Input",i),a=Rn(i),o=K5(a),d=lr("chakra-input",e.className);return u.jsx(mt.input,{size:n,...o,__css:s.field,ref:r,className:d})});Ar.displayName="Input";Ar.id="Input";const[xme,vme]=_n({name:"InputGroupStylesContext",errorMessage:`useInputGroupStyles returned is 'undefined'. Seems you forgot to wrap the components in "<InputGroup />" `}),da=Tt(function(e,r){const n=ls("Input",e),{children:i,className:s,...a}=Rn(e),o=lr("chakra-input__group",s),d={},m=_k(i),y=n.field;m.forEach(w=>{n&&(y&&w.type.id==="InputLeftElement"&&(d.paddingStart=y.height??y.h),y&&w.type.id==="InputRightElement"&&(d.paddingEnd=y.height??y.h),w.type.id==="InputRightAddon"&&(d.borderEndRadius=0),w.type.id==="InputLeftAddon"&&(d.borderStartRadius=0))});const v=m.map(w=>{var P,E;const O=wk({size:((P=w.props)==null?void 0:P.size)||e.size,variant:((E=w.props)==null?void 0:E.variant)||e.variant});return w.type.id!=="Input"?I.cloneElement(w,O):I.cloneElement(w,Object.assign(O,d,w.props))});return u.jsx(mt.div,{className:o,ref:r,__css:{width:"100%",display:"flex",position:"relative",isolation:"isolate",...n.group},"data-group":!0,...a,children:u.jsx(xme,{value:n,children:v})})});da.displayName="InputGroup";const bme=mt("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),Jk=Tt(function(e,r){const{placement:n="left",...i}=e,s=vme(),a=s.field,d={[n==="left"?"insetStart":"insetEnd"]:"0",width:(a==null?void 0:a.height)??(a==null?void 0:a.h),height:(a==null?void 0:a.height)??(a==null?void 0:a.h),fontSize:a==null?void 0:a.fontSize,...s.element};return u.jsx(bme,{ref:r,__css:d,...i})});Jk.id="InputElement";Jk.displayName="InputElement";const wl=Tt(function(e,r){const{className:n,...i}=e,s=lr("chakra-input__left-element",n);return u.jsx(Jk,{ref:r,placement:"left",className:s,...i})});wl.id="InputLeftElement";wl.displayName="InputLeftElement";const Pb=Tt(function(e,r){const{className:n,...i}=e,s=lr("chakra-input__right-element",n);return u.jsx(Jk,{ref:r,placement:"right",className:s,...i})});Pb.id="InputRightElement";Pb.displayName="InputRightElement";const tu=Tt(function(e,r){const n=ll("Kbd",e),{className:i,...s}=Rn(e);return u.jsx(mt.kbd,{ref:r,className:lr("chakra-kbd",i),...s,__css:{fontFamily:"mono",...n}})});tu.displayName="Kbd";const[_me,ZW]=_n({name:"ListStylesContext",errorMessage:`useListStyles returned is 'undefined'. Seems you forgot to wrap the components in "<List />" `}),k1=Tt(function(e,r){const n=ls("List",e),{children:i,styleType:s="none",stylePosition:a,spacing:o,...d}=Rn(e),m=_k(i),v=o?{["& > *:not(style) ~ *:not(style)"]:{mt:o}}:{};return u.jsx(_me,{value:n,children:u.jsx(mt.ul,{ref:r,listStyleType:s,listStylePosition:a,role:"list",__css:{...n.container,...v},...d,children:m})})});k1.displayName="List";const wme=Tt((t,e)=>{const{as:r,...n}=t;return u.jsx(k1,{ref:e,as:"ol",styleType:"decimal",marginStart:"1em",...n})});wme.displayName="OrderedList";const Sme=Tt(function(e,r){const{as:n,...i}=e;return u.jsx(k1,{ref:r,as:"ul",styleType:"initial",marginStart:"1em",...i})});Sme.displayName="UnorderedList";const hM=Tt(function(e,r){const n=ZW();return u.jsx(mt.li,{ref:r,...e,__css:n.item})});hM.displayName="ListItem";const dM=Tt(function(e,r){const n=ZW();return u.jsx(ze,{ref:r,role:"presentation",...e,__css:n.icon})});dM.displayName="ListIcon";function kme(t,e,r,n){if(e==null)return n;if(!n)return t.find(a=>r(a).toLowerCase().startsWith(e.toLowerCase()));const i=t.filter(s=>r(s).toLowerCase().startsWith(e.toLowerCase()));if(i.length>0){let s;return i.includes(n)?(s=i.indexOf(n)+1,s===i.length&&(s=0),i[s]):(s=t.indexOf(i[0]),t[s])}return n}function Cme(t){const{key:e}=t;return e.length===1||e.length>1&&/[^a-zA-Z0-9]/.test(e)}function Tme(t={}){const{timeout:e=300,preventDefault:r=()=>!0}=t,[n,i]=I.useState([]),s=I.useRef(void 0),a=()=>{s.current&&(clearTimeout(s.current),s.current=null)},o=()=>{a(),s.current=setTimeout(()=>{i([]),s.current=null},e)};I.useEffect(()=>a,[]);function d(m){return y=>{if(y.key==="Backspace"){const v=[...n];v.pop(),i(v);return}if(Cme(y)){const v=n.concat(y.key);r(y)&&(y.preventDefault(),y.stopPropagation()),i(v),m(v.join("")),o()}}}return d}var Oa="top",Vl="bottom",Wl="right",ja="left",fM="auto",C1=[Oa,Vl,Wl,ja],Yy="start",Ab="end",Ome="clippingParents",YW="viewport",qx="popper",jme="reference",TL=C1.reduce(function(t,e){return t.concat([e+"-"+Yy,e+"-"+Ab])},[]),JW=[].concat(C1,[fM]).reduce(function(t,e){return t.concat([e,e+"-"+Yy,e+"-"+Ab])},[]),Pme="beforeRead",Ame="read",Eme="afterRead",zme="beforeMain",Mme="main",Ime="afterMain",Rme="beforeWrite",Dme="write",Lme="afterWrite",Fme=[Pme,Ame,Eme,zme,Mme,Ime,Rme,Dme,Lme];function _u(t){return t?(t.nodeName||"").toLowerCase():null}function nl(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function am(t){var e=nl(t).Element;return t instanceof e||t instanceof Element}function Bl(t){var e=nl(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function pM(t){if(typeof ShadowRoot>"u")return!1;var e=nl(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Bme(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},i=e.attributes[r]||{},s=e.elements[r];!Bl(s)||!_u(s)||(Object.assign(s.style,n),Object.keys(i).forEach(function(a){var o=i[a];o===!1?s.removeAttribute(a):s.setAttribute(a,o===!0?"":o)}))})}function $me(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],s=e.attributes[n]||{},a=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),o=a.reduce(function(d,m){return d[m]="",d},{});!Bl(i)||!_u(i)||(Object.assign(i.style,o),Object.keys(s).forEach(function(d){i.removeAttribute(d)}))})}}const Nme={name:"applyStyles",enabled:!0,phase:"write",fn:Bme,effect:$me,requires:["computeStyles"]};function xu(t){return t.split("-")[0]}var Vp=Math.max,k2=Math.min,Jy=Math.round;function OA(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function e7(){return!/^((?!chrome|android).)*safari/i.test(OA())}function e0(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),i=1,s=1;e&&Bl(t)&&(i=t.offsetWidth>0&&Jy(n.width)/t.offsetWidth||1,s=t.offsetHeight>0&&Jy(n.height)/t.offsetHeight||1);var a=am(t)?nl(t):window,o=a.visualViewport,d=!e7()&&r,m=(n.left+(d&&o?o.offsetLeft:0))/i,y=(n.top+(d&&o?o.offsetTop:0))/s,v=n.width/i,w=n.height/s;return{width:v,height:w,top:y,right:m+v,bottom:y+w,left:m,x:m,y}}function mM(t){var e=e0(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function t7(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&pM(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Sh(t){return nl(t).getComputedStyle(t)}function Vme(t){return["table","td","th"].indexOf(_u(t))>=0}function wf(t){return((am(t)?t.ownerDocument:t.document)||window.document).documentElement}function eC(t){return _u(t)==="html"?t:t.assignedSlot||t.parentNode||(pM(t)?t.host:null)||wf(t)}function OL(t){return!Bl(t)||Sh(t).position==="fixed"?null:t.offsetParent}function Wme(t){var e=/firefox/i.test(OA()),r=/Trident/i.test(OA());if(r&&Bl(t)){var n=Sh(t);if(n.position==="fixed")return null}var i=eC(t);for(pM(i)&&(i=i.host);Bl(i)&&["html","body"].indexOf(_u(i))<0;){var s=Sh(i);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return i;i=i.parentNode}return null}function T1(t){for(var e=nl(t),r=OL(t);r&&Vme(r)&&Sh(r).position==="static";)r=OL(r);return r&&(_u(r)==="html"||_u(r)==="body"&&Sh(r).position==="static")?e:r||Wme(t)||e}function gM(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function $v(t,e,r){return Vp(t,k2(e,r))}function Ume(t,e,r){var n=$v(t,e,r);return n>r?r:n}function r7(){return{top:0,right:0,bottom:0,left:0}}function n7(t){return Object.assign({},r7(),t)}function i7(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var qme=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,n7(typeof e!="number"?e:i7(e,C1))};function Qme(t){var e,r=t.state,n=t.name,i=t.options,s=r.elements.arrow,a=r.modifiersData.popperOffsets,o=xu(r.placement),d=gM(o),m=[ja,Wl].indexOf(o)>=0,y=m?"height":"width";if(!(!s||!a)){var v=qme(i.padding,r),w=mM(s),O=d==="y"?Oa:ja,P=d==="y"?Vl:Wl,E=r.rects.reference[y]+r.rects.reference[d]-a[d]-r.rects.popper[y],$=a[d]-r.rects.reference[d],R=T1(s),F=R?d==="y"?R.clientHeight||0:R.clientWidth||0:0,D=E/2-$/2,U=v[O],X=F-w[y]-v[P],ee=F/2-w[y]/2+D,K=$v(U,ee,X),Y=d;r.modifiersData[n]=(e={},e[Y]=K,e.centerOffset=K-ee,e)}}function Hme(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||t7(e.elements.popper,i)&&(e.elements.arrow=i))}const Gme={name:"arrow",enabled:!0,phase:"main",fn:Qme,effect:Hme,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function t0(t){return t.split("-")[1]}var Xme={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Kme(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:Jy(r*i)/i||0,y:Jy(n*i)/i||0}}function jL(t){var e,r=t.popper,n=t.popperRect,i=t.placement,s=t.variation,a=t.offsets,o=t.position,d=t.gpuAcceleration,m=t.adaptive,y=t.roundOffsets,v=t.isFixed,w=a.x,O=w===void 0?0:w,P=a.y,E=P===void 0?0:P,$=typeof y=="function"?y({x:O,y:E}):{x:O,y:E};O=$.x,E=$.y;var R=a.hasOwnProperty("x"),F=a.hasOwnProperty("y"),D=ja,U=Oa,X=window;if(m){var ee=T1(r),K="clientHeight",Y="clientWidth";if(ee===nl(r)&&(ee=wf(r),Sh(ee).position!=="static"&&o==="absolute"&&(K="scrollHeight",Y="scrollWidth")),ee=ee,i===Oa||(i===ja||i===Wl)&&s===Ab){U=Vl;var ne=v&&ee===X&&X.visualViewport?X.visualViewport.height:ee[K];E-=ne-n.height,E*=d?1:-1}if(i===ja||(i===Oa||i===Vl)&&s===Ab){D=Wl;var oe=v&&ee===X&&X.visualViewport?X.visualViewport.width:ee[Y];O-=oe-n.width,O*=d?1:-1}}var ce=Object.assign({position:o},m&&Xme),Xe=y===!0?Kme({x:O,y:E},nl(r)):{x:O,y:E};if(O=Xe.x,E=Xe.y,d){var Ae;return Object.assign({},ce,(Ae={},Ae[U]=F?"0":"",Ae[D]=R?"0":"",Ae.transform=(X.devicePixelRatio||1)<=1?"translate("+O+"px, "+E+"px)":"translate3d("+O+"px, "+E+"px, 0)",Ae))}return Object.assign({},ce,(e={},e[U]=F?E+"px":"",e[D]=R?O+"px":"",e.transform="",e))}function Zme(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,s=r.adaptive,a=s===void 0?!0:s,o=r.roundOffsets,d=o===void 0?!0:o,m={placement:xu(e.placement),variation:t0(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,jL(Object.assign({},m,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:d})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,jL(Object.assign({},m,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:d})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Yme={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Zme,data:{}};var yw={passive:!0};function Jme(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,s=i===void 0?!0:i,a=n.resize,o=a===void 0?!0:a,d=nl(e.elements.popper),m=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&m.forEach(function(y){y.addEventListener("scroll",r.update,yw)}),o&&d.addEventListener("resize",r.update,yw),function(){s&&m.forEach(function(y){y.removeEventListener("scroll",r.update,yw)}),o&&d.removeEventListener("resize",r.update,yw)}}const ege={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Jme,data:{}};var tge={left:"right",right:"left",bottom:"top",top:"bottom"};function wS(t){return t.replace(/left|right|bottom|top/g,function(e){return tge[e]})}var rge={start:"end",end:"start"};function PL(t){return t.replace(/start|end/g,function(e){return rge[e]})}function yM(t){var e=nl(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function xM(t){return e0(wf(t)).left+yM(t).scrollLeft}function nge(t,e){var r=nl(t),n=wf(t),i=r.visualViewport,s=n.clientWidth,a=n.clientHeight,o=0,d=0;if(i){s=i.width,a=i.height;var m=e7();(m||!m&&e==="fixed")&&(o=i.offsetLeft,d=i.offsetTop)}return{width:s,height:a,x:o+xM(t),y:d}}function ige(t){var e,r=wf(t),n=yM(t),i=(e=t.ownerDocument)==null?void 0:e.body,s=Vp(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),a=Vp(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-n.scrollLeft+xM(t),d=-n.scrollTop;return Sh(i||r).direction==="rtl"&&(o+=Vp(r.clientWidth,i?i.clientWidth:0)-s),{width:s,height:a,x:o,y:d}}function vM(t){var e=Sh(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function s7(t){return["html","body","#document"].indexOf(_u(t))>=0?t.ownerDocument.body:Bl(t)&&vM(t)?t:s7(eC(t))}function Nv(t,e){var r;e===void 0&&(e=[]);var n=s7(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),s=nl(n),a=i?[s].concat(s.visualViewport||[],vM(n)?n:[]):n,o=e.concat(a);return i?o:o.concat(Nv(eC(a)))}function jA(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function sge(t,e){var r=e0(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function AL(t,e,r){return e===YW?jA(nge(t,r)):am(e)?sge(e,r):jA(ige(wf(t)))}function oge(t){var e=Nv(eC(t)),r=["absolute","fixed"].indexOf(Sh(t).position)>=0,n=r&&Bl(t)?T1(t):t;return am(n)?e.filter(function(i){return am(i)&&t7(i,n)&&_u(i)!=="body"}):[]}function age(t,e,r,n){var i=e==="clippingParents"?oge(t):[].concat(e),s=[].concat(i,[r]),a=s[0],o=s.reduce(function(d,m){var y=AL(t,m,n);return d.top=Vp(y.top,d.top),d.right=k2(y.right,d.right),d.bottom=k2(y.bottom,d.bottom),d.left=Vp(y.left,d.left),d},AL(t,a,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function o7(t){var e=t.reference,r=t.element,n=t.placement,i=n?xu(n):null,s=n?t0(n):null,a=e.x+e.width/2-r.width/2,o=e.y+e.height/2-r.height/2,d;switch(i){case Oa:d={x:a,y:e.y-r.height};break;case Vl:d={x:a,y:e.y+e.height};break;case Wl:d={x:e.x+e.width,y:o};break;case ja:d={x:e.x-r.width,y:o};break;default:d={x:e.x,y:e.y}}var m=i?gM(i):null;if(m!=null){var y=m==="y"?"height":"width";switch(s){case Yy:d[m]=d[m]-(e[y]/2-r[y]/2);break;case Ab:d[m]=d[m]+(e[y]/2-r[y]/2);break}}return d}function Eb(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,s=r.strategy,a=s===void 0?t.strategy:s,o=r.boundary,d=o===void 0?Ome:o,m=r.rootBoundary,y=m===void 0?YW:m,v=r.elementContext,w=v===void 0?qx:v,O=r.altBoundary,P=O===void 0?!1:O,E=r.padding,$=E===void 0?0:E,R=n7(typeof $!="number"?$:i7($,C1)),F=w===qx?jme:qx,D=t.rects.popper,U=t.elements[P?F:w],X=age(am(U)?U:U.contextElement||wf(t.elements.popper),d,y,a),ee=e0(t.elements.reference),K=o7({reference:ee,element:D,placement:i}),Y=jA(Object.assign({},D,K)),ne=w===qx?Y:ee,oe={top:X.top-ne.top+R.top,bottom:ne.bottom-X.bottom+R.bottom,left:X.left-ne.left+R.left,right:ne.right-X.right+R.right},ce=t.modifiersData.offset;if(w===qx&&ce){var Xe=ce[i];Object.keys(oe).forEach(function(Ae){var We=[Wl,Vl].indexOf(Ae)>=0?1:-1,Ye=[Oa,Vl].indexOf(Ae)>=0?"y":"x";oe[Ae]+=Xe[Ye]*We})}return oe}function lge(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,s=r.rootBoundary,a=r.padding,o=r.flipVariations,d=r.allowedAutoPlacements,m=d===void 0?JW:d,y=t0(n),v=y?o?TL:TL.filter(function(P){return t0(P)===y}):C1,w=v.filter(function(P){return m.indexOf(P)>=0});w.length===0&&(w=v);var O=w.reduce(function(P,E){return P[E]=Eb(t,{placement:E,boundary:i,rootBoundary:s,padding:a})[xu(E)],P},{});return Object.keys(O).sort(function(P,E){return O[P]-O[E]})}function cge(t){if(xu(t)===fM)return[];var e=wS(t);return[PL(t),e,PL(e)]}function uge(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,s=i===void 0?!0:i,a=r.altAxis,o=a===void 0?!0:a,d=r.fallbackPlacements,m=r.padding,y=r.boundary,v=r.rootBoundary,w=r.altBoundary,O=r.flipVariations,P=O===void 0?!0:O,E=r.allowedAutoPlacements,$=e.options.placement,R=xu($),F=R===$,D=d||(F||!P?[wS($)]:cge($)),U=[$].concat(D).reduce(function(st,Re){return st.concat(xu(Re)===fM?lge(e,{placement:Re,boundary:y,rootBoundary:v,padding:m,flipVariations:P,allowedAutoPlacements:E}):Re)},[]),X=e.rects.reference,ee=e.rects.popper,K=new Map,Y=!0,ne=U[0],oe=0;oe<U.length;oe++){var ce=U[oe],Xe=xu(ce),Ae=t0(ce)===Yy,We=[Oa,Vl].indexOf(Xe)>=0,Ye=We?"width":"height",tt=Eb(e,{placement:ce,boundary:y,rootBoundary:v,altBoundary:w,padding:m}),Be=We?Ae?Wl:ja:Ae?Vl:Oa;X[Ye]>ee[Ye]&&(Be=wS(Be));var Me=wS(Be),Ge=[];if(s&&Ge.push(tt[Xe]<=0),o&&Ge.push(tt[Be]<=0,tt[Me]<=0),Ge.every(function(st){return st})){ne=ce,Y=!1;break}K.set(ce,Ge)}if(Y)for(var De=P?3:1,Le=function(Re){var it=U.find(function(Ke){var St=K.get(Ke);if(St)return St.slice(0,Re).every(function(Mt){return Mt})});if(it)return ne=it,"break"},Oe=De;Oe>0;Oe--){var Ie=Le(Oe);if(Ie==="break")break}e.placement!==ne&&(e.modifiersData[n]._skip=!0,e.placement=ne,e.reset=!0)}}const hge={name:"flip",enabled:!0,phase:"main",fn:uge,requiresIfExists:["offset"],data:{_skip:!1}};function EL(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function zL(t){return[Oa,Wl,Vl,ja].some(function(e){return t[e]>=0})}function dge(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,s=e.modifiersData.preventOverflow,a=Eb(e,{elementContext:"reference"}),o=Eb(e,{altBoundary:!0}),d=EL(a,n),m=EL(o,i,s),y=zL(d),v=zL(m);e.modifiersData[r]={referenceClippingOffsets:d,popperEscapeOffsets:m,isReferenceHidden:y,hasPopperEscaped:v},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":y,"data-popper-escaped":v})}const fge={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:dge};function pge(t,e,r){var n=xu(t),i=[ja,Oa].indexOf(n)>=0?-1:1,s=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,a=s[0],o=s[1];return a=a||0,o=(o||0)*i,[ja,Wl].indexOf(n)>=0?{x:o,y:a}:{x:a,y:o}}function mge(t){var e=t.state,r=t.options,n=t.name,i=r.offset,s=i===void 0?[0,0]:i,a=JW.reduce(function(y,v){return y[v]=pge(v,e.rects,s),y},{}),o=a[e.placement],d=o.x,m=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=d,e.modifiersData.popperOffsets.y+=m),e.modifiersData[n]=a}const gge={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:mge};function yge(t){var e=t.state,r=t.name;e.modifiersData[r]=o7({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const xge={name:"popperOffsets",enabled:!0,phase:"read",fn:yge,data:{}};function vge(t){return t==="x"?"y":"x"}function bge(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,s=i===void 0?!0:i,a=r.altAxis,o=a===void 0?!1:a,d=r.boundary,m=r.rootBoundary,y=r.altBoundary,v=r.padding,w=r.tether,O=w===void 0?!0:w,P=r.tetherOffset,E=P===void 0?0:P,$=Eb(e,{boundary:d,rootBoundary:m,padding:v,altBoundary:y}),R=xu(e.placement),F=t0(e.placement),D=!F,U=gM(R),X=vge(U),ee=e.modifiersData.popperOffsets,K=e.rects.reference,Y=e.rects.popper,ne=typeof E=="function"?E(Object.assign({},e.rects,{placement:e.placement})):E,oe=typeof ne=="number"?{mainAxis:ne,altAxis:ne}:Object.assign({mainAxis:0,altAxis:0},ne),ce=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Xe={x:0,y:0};if(ee){if(s){var Ae,We=U==="y"?Oa:ja,Ye=U==="y"?Vl:Wl,tt=U==="y"?"height":"width",Be=ee[U],Me=Be+$[We],Ge=Be-$[Ye],De=O?-Y[tt]/2:0,Le=F===Yy?K[tt]:Y[tt],Oe=F===Yy?-Y[tt]:-K[tt],Ie=e.elements.arrow,st=O&&Ie?mM(Ie):{width:0,height:0},Re=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:r7(),it=Re[We],Ke=Re[Ye],St=$v(0,K[tt],st[tt]),Mt=D?K[tt]/2-De-St-it-oe.mainAxis:Le-St-it-oe.mainAxis,Et=D?-K[tt]/2+De+St+Ke+oe.mainAxis:Oe+St+Ke+oe.mainAxis,xt=e.elements.arrow&&T1(e.elements.arrow),et=xt?U==="y"?xt.clientTop||0:xt.clientLeft||0:0,Yt=(Ae=ce==null?void 0:ce[U])!=null?Ae:0,_t=Be+Mt-Yt-et,rt=Be+Et-Yt,Te=$v(O?k2(Me,_t):Me,Be,O?Vp(Ge,rt):Ge);ee[U]=Te,Xe[U]=Te-Be}if(o){var ct,Vt=U==="x"?Oa:ja,wt=U==="x"?Vl:Wl,Ft=ee[X],Kr=X==="y"?"height":"width",yn=Ft+$[Vt],an=Ft-$[wt],Cn=[Oa,ja].indexOf(R)!==-1,xn=(ct=ce==null?void 0:ce[X])!=null?ct:0,di=Cn?yn:Ft-K[Kr]-Y[Kr]-xn+oe.altAxis,Pi=Cn?Ft+K[Kr]+Y[Kr]-xn-oe.altAxis:an,He=O&&Cn?Ume(di,Ft,Pi):$v(O?di:yn,Ft,O?Pi:an);ee[X]=He,Xe[X]=He-Ft}e.modifiersData[n]=Xe}}const _ge={name:"preventOverflow",enabled:!0,phase:"main",fn:bge,requiresIfExists:["offset"]};function wge(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Sge(t){return t===nl(t)||!Bl(t)?yM(t):wge(t)}function kge(t){var e=t.getBoundingClientRect(),r=Jy(e.width)/t.offsetWidth||1,n=Jy(e.height)/t.offsetHeight||1;return r!==1||n!==1}function Cge(t,e,r){r===void 0&&(r=!1);var n=Bl(e),i=Bl(e)&&kge(e),s=wf(e),a=e0(t,i,r),o={scrollLeft:0,scrollTop:0},d={x:0,y:0};return(n||!n&&!r)&&((_u(e)!=="body"||vM(s))&&(o=Sge(e)),Bl(e)?(d=e0(e,!0),d.x+=e.clientLeft,d.y+=e.clientTop):s&&(d.x=xM(s))),{x:a.left+o.scrollLeft-d.x,y:a.top+o.scrollTop-d.y,width:a.width,height:a.height}}function Tge(t){var e=new Map,r=new Set,n=[];t.forEach(function(s){e.set(s.name,s)});function i(s){r.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(o){if(!r.has(o)){var d=e.get(o);d&&i(d)}}),n.push(s)}return t.forEach(function(s){r.has(s.name)||i(s)}),n}function Oge(t){var e=Tge(t);return Fme.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function jge(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function Pge(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var ML={placement:"bottom",modifiers:[],strategy:"absolute"};function IL(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function Age(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,s=i===void 0?ML:i;return function(o,d,m){m===void 0&&(m=s);var y={placement:"bottom",orderedModifiers:[],options:Object.assign({},ML,s),modifiersData:{},elements:{reference:o,popper:d},attributes:{},styles:{}},v=[],w=!1,O={state:y,setOptions:function(R){var F=typeof R=="function"?R(y.options):R;E(),y.options=Object.assign({},s,y.options,F),y.scrollParents={reference:am(o)?Nv(o):o.contextElement?Nv(o.contextElement):[],popper:Nv(d)};var D=Oge(Pge([].concat(n,y.options.modifiers)));return y.orderedModifiers=D.filter(function(U){return U.enabled}),P(),O.update()},forceUpdate:function(){if(!w){var R=y.elements,F=R.reference,D=R.popper;if(IL(F,D)){y.rects={reference:Cge(F,T1(D),y.options.strategy==="fixed"),popper:mM(D)},y.reset=!1,y.placement=y.options.placement,y.orderedModifiers.forEach(function(oe){return y.modifiersData[oe.name]=Object.assign({},oe.data)});for(var U=0;U<y.orderedModifiers.length;U++){if(y.reset===!0){y.reset=!1,U=-1;continue}var X=y.orderedModifiers[U],ee=X.fn,K=X.options,Y=K===void 0?{}:K,ne=X.name;typeof ee=="function"&&(y=ee({state:y,options:Y,name:ne,instance:O})||y)}}}},update:jge(function(){return new Promise(function($){O.forceUpdate(),$(y)})}),destroy:function(){E(),w=!0}};if(!IL(o,d))return O;O.setOptions(m).then(function($){!w&&m.onFirstUpdate&&m.onFirstUpdate($)});function P(){y.orderedModifiers.forEach(function($){var R=$.name,F=$.options,D=F===void 0?{}:F,U=$.effect;if(typeof U=="function"){var X=U({state:y,name:R,instance:O,options:D}),ee=function(){};v.push(X||ee)}})}function E(){v.forEach(function($){return $()}),v=[]}return O}}var Ege=[ege,xge,Yme,Nme,gge,hge,_ge,Gme,fge],zge=Age({defaultModifiers:Ege});const xg=(t,e)=>({var:t,varRef:e?`var(${t}, ${e})`:`var(${t})`}),Ys={arrowShadowColor:xg("--popper-arrow-shadow-color"),arrowSize:xg("--popper-arrow-size","8px"),arrowSizeHalf:xg("--popper-arrow-size-half"),arrowBg:xg("--popper-arrow-bg"),transformOrigin:xg("--popper-transform-origin"),arrowOffset:xg("--popper-arrow-offset")};function Mge(t){if(t.includes("top"))return"1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("bottom"))return"-1px -1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("right"))return"-1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("left"))return"1px -1px 0px 0 var(--popper-arrow-shadow-color)"}const Ige={top:"bottom center","top-start":"bottom left","top-end":"bottom right",bottom:"top center","bottom-start":"top left","bottom-end":"top right",left:"right center","left-start":"right top","left-end":"right bottom",right:"left center","right-start":"left top","right-end":"left bottom"},Rge=t=>Ige[t],RL={scroll:!0,resize:!0};function Dge(t){let e;return typeof t=="object"?e={enabled:!0,options:{...RL,...t}}:e={enabled:t,options:RL},e}const Lge={name:"matchWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:t})=>{t.styles.popper.width=`${t.rects.reference.width}px`},effect:({state:t})=>()=>{const e=t.elements.reference;t.elements.popper.style.width=`${e.offsetWidth}px`}},Fge={name:"transformOrigin",enabled:!0,phase:"write",fn:({state:t})=>{DL(t)},effect:({state:t})=>()=>{DL(t)}},DL=t=>{t.elements.popper.style.setProperty(Ys.transformOrigin.var,Rge(t.placement))},Bge={name:"positionArrow",enabled:!0,phase:"afterWrite",fn:({state:t})=>{$ge(t)}},$ge=t=>{var r;if(!t.placement)return;const e=Nge(t.placement);if((r=t.elements)!=null&&r.arrow&&e){Object.assign(t.elements.arrow.style,{[e.property]:e.value,width:Ys.arrowSize.varRef,height:Ys.arrowSize.varRef,zIndex:-1});const n={[Ys.arrowSizeHalf.var]:`calc(${Ys.arrowSize.varRef} / 2 - 1px)`,[Ys.arrowOffset.var]:`calc(${Ys.arrowSizeHalf.varRef} * -1)`};for(const i in n)t.elements.arrow.style.setProperty(i,n[i])}},Nge=t=>{if(t.startsWith("top"))return{property:"bottom",value:Ys.arrowOffset.varRef};if(t.startsWith("bottom"))return{property:"top",value:Ys.arrowOffset.varRef};if(t.startsWith("left"))return{property:"right",value:Ys.arrowOffset.varRef};if(t.startsWith("right"))return{property:"left",value:Ys.arrowOffset.varRef}},Vge={name:"innerArrow",enabled:!0,phase:"main",requires:["arrow"],fn:({state:t})=>{LL(t)},effect:({state:t})=>()=>{LL(t)}},LL=t=>{if(!t.elements.arrow)return;const e=t.elements.arrow.querySelector("[data-popper-arrow-inner]");if(!e)return;const r=Mge(t.placement);r&&e.style.setProperty("--popper-arrow-default-shadow",r),Object.assign(e.style,{transform:"rotate(45deg)",background:Ys.arrowBg.varRef,top:0,left:0,width:"100%",height:"100%",position:"absolute",zIndex:"inherit",boxShadow:"var(--popper-arrow-shadow, var(--popper-arrow-default-shadow))"})},Wge={"start-start":{ltr:"left-start",rtl:"right-start"},"start-end":{ltr:"left-end",rtl:"right-end"},"end-start":{ltr:"right-start",rtl:"left-start"},"end-end":{ltr:"right-end",rtl:"left-end"},start:{ltr:"left",rtl:"right"},end:{ltr:"right",rtl:"left"}},Uge={"auto-start":"auto-end","auto-end":"auto-start","top-start":"top-end","top-end":"top-start","bottom-start":"bottom-end","bottom-end":"bottom-start"};function qge(t,e="ltr"){var n;const r=((n=Wge[t])==null?void 0:n[e])||t;return e==="ltr"?r:Uge[t]??r}function a7(t={}){const{enabled:e=!0,modifiers:r,placement:n="bottom",strategy:i="absolute",arrowPadding:s=8,eventListeners:a=!0,offset:o,gutter:d=8,flip:m=!0,boundary:y="clippingParents",preventOverflow:v=!0,matchWidth:w,direction:O="ltr"}=t,P=I.useRef(null),E=I.useRef(null),$=I.useRef(null),R=qge(n,O),F=I.useRef(()=>{}),D=I.useCallback(()=>{var oe;!e||!P.current||!E.current||((oe=F.current)==null||oe.call(F),$.current=zge(P.current,E.current,{placement:R,modifiers:[Vge,Bge,Fge,{...Lge,enabled:!!w},{name:"eventListeners",...Dge(a)},{name:"arrow",options:{padding:s}},{name:"offset",options:{offset:o??[0,d]}},{name:"flip",enabled:!!m,options:{padding:8}},{name:"preventOverflow",enabled:!!v,options:{boundary:y}},...r??[]],strategy:i}),$.current.forceUpdate(),F.current=$.current.destroy)},[R,e,r,w,a,s,o,d,m,v,y,i]);I.useEffect(()=>()=>{var oe;!P.current&&!E.current&&((oe=$.current)==null||oe.destroy(),$.current=null)},[]);const U=I.useCallback(oe=>{P.current=oe,D()},[D]),X=I.useCallback((oe={},ce=null)=>({...oe,ref:bi(U,ce)}),[U]),ee=I.useCallback(oe=>{E.current=oe,D()},[D]),K=I.useCallback((oe={},ce=null)=>({...oe,ref:bi(ee,ce),style:{...oe.style,position:i,minWidth:w?void 0:"max-content",inset:"0 auto auto 0"}}),[i,ee,w]),Y=I.useCallback((oe={},ce=null)=>{const{size:Xe,shadowColor:Ae,bg:We,style:Ye,...tt}=oe;return{...tt,ref:ce,"data-popper-arrow":"",style:Qge(oe)}},[]),ne=I.useCallback((oe={},ce=null)=>({...oe,ref:ce,"data-popper-arrow-inner":""}),[]);return{update(){var oe;(oe=$.current)==null||oe.update()},forceUpdate(){var oe;(oe=$.current)==null||oe.forceUpdate()},transformOrigin:Ys.transformOrigin.varRef,referenceRef:U,popperRef:ee,getPopperProps:K,getArrowProps:Y,getArrowInnerProps:ne,getReferenceProps:X}}function Qge(t){const{size:e,shadowColor:r,bg:n,style:i}=t,s={...i,position:"absolute"};return e&&(s["--popper-arrow-size"]=e),r&&(s["--popper-arrow-shadow-color"]=r),n&&(s["--popper-arrow-bg"]=n),s}function Hge(){const t=I.useRef(new Map),e=t.current,r=I.useCallback((i,s,a,o)=>{t.current.set(a,{type:s,el:i,options:o}),i.addEventListener(s,a,o)},[]),n=I.useCallback((i,s,a,o)=>{i.removeEventListener(s,a,o),t.current.delete(a)},[]);return I.useEffect(()=>()=>{e.forEach((i,s)=>{n(i.el,i.type,s,i.options)})},[n,e]),{add:r,remove:n}}function KO(t){var i,s;const e=((s=(i=t.composedPath)==null?void 0:i.call(t))==null?void 0:s[0])??t.target,{tagName:r,isContentEditable:n}=e;return r!=="INPUT"&&r!=="TEXTAREA"&&n!==!0}function l7(t={}){const{ref:e,isDisabled:r,isFocusable:n,clickOnEnter:i=!0,clickOnSpace:s=!0,onMouseDown:a,onMouseUp:o,onClick:d,onKeyDown:m,onKeyUp:y,tabIndex:v,onMouseOver:w,onMouseLeave:O,...P}=t,[E,$]=I.useState(!0),[R,F]=I.useState(!1),D=Hge(),U=Be=>{Be&&Be.tagName!=="BUTTON"&&$(!1)},X=E?v:v||0,ee=r&&!n,K=I.useCallback(Be=>{if(r){Be.stopPropagation(),Be.preventDefault();return}Be.currentTarget.focus(),d==null||d(Be)},[r,d]),Y=I.useCallback(Be=>{R&&KO(Be)&&(Be.preventDefault(),Be.stopPropagation(),F(!1),D.remove(document,"keyup",Y,!1))},[R,D]),ne=I.useCallback(Be=>{if(m==null||m(Be),r||Be.defaultPrevented||Be.metaKey||!KO(Be.nativeEvent)||E)return;const Me=i&&Be.key==="Enter";s&&Be.key===" "&&(Be.preventDefault(),F(!0)),Me&&(Be.preventDefault(),Be.currentTarget.click()),D.add(document,"keyup",Y,!1)},[r,E,m,i,s,D,Y]),oe=I.useCallback(Be=>{if(y==null||y(Be),r||Be.defaultPrevented||Be.metaKey||!KO(Be.nativeEvent)||E)return;s&&Be.key===" "&&(Be.preventDefault(),F(!1),Be.currentTarget.click())},[s,E,r,y]),ce=I.useCallback(Be=>{Be.button===0&&(F(!1),D.remove(document,"mouseup",ce,!1))},[D]),Xe=I.useCallback(Be=>{if(Be.button!==0)return;if(r){Be.stopPropagation(),Be.preventDefault();return}E||F(!0),Be.currentTarget.focus({preventScroll:!0}),D.add(document,"mouseup",ce,!1),a==null||a(Be)},[r,E,a,D,ce]),Ae=I.useCallback(Be=>{Be.button===0&&(E||F(!1),o==null||o(Be))},[o,E]),We=I.useCallback(Be=>{if(r){Be.preventDefault();return}w==null||w(Be)},[r,w]),Ye=I.useCallback(Be=>{R&&(Be.preventDefault(),F(!1)),O==null||O(Be)},[R,O]),tt=bi(e,U);return E?{...P,ref:tt,type:"button","aria-disabled":ee?void 0:r,disabled:ee,onClick:K,onMouseDown:a,onMouseUp:o,onKeyUp:y,onKeyDown:m,onMouseOver:w,onMouseLeave:O}:{...P,ref:tt,role:"button","data-active":Sr(R),"aria-disabled":r?"true":void 0,tabIndex:ee?void 0:X,onClick:K,onMouseDown:Xe,onMouseUp:Ae,onKeyUp:oe,onKeyDown:ne,onMouseOver:We,onMouseLeave:Ye}}const[Gge,Xge,Kge,Zge]=N5(),[Yge,O1]=_n({strict:!1,name:"MenuContext"});function c7(t){return(t==null?void 0:t.ownerDocument)??document}function Jge(t){return c7(t).activeElement===t}function eye(t={}){const{id:e,closeOnSelect:r=!0,closeOnBlur:n=!0,initialFocusRef:i,autoSelect:s=!0,isLazy:a,isOpen:o,defaultIsOpen:d,onClose:m,onOpen:y,placement:v="bottom-start",lazyBehavior:w="unmount",direction:O,computePositionOnMount:P=!1,...E}=t,$=I.useRef(null),R=I.useRef(null),F=I.useRef(!0),D=Kge(),U=I.useCallback(()=>{requestAnimationFrame(()=>{var Ie;(Ie=$.current)==null||Ie.focus({preventScroll:!1})})},[]),X=I.useCallback(()=>{const Ie=setTimeout(()=>{var st,Re;if(i)(st=i.current)==null||st.focus();else if(!D.count())(Re=$.current)==null||Re.focus({preventScroll:!1});else{const it=D.firstEnabled();it&&We(it.index)}});Ge.current.add(Ie)},[D,i]),ee=I.useCallback(()=>{const Ie=setTimeout(()=>{var st;if(!D.count())(st=$.current)==null||st.focus({preventScroll:!1});else{const Re=D.lastEnabled();Re&&We(Re.index)}});Ge.current.add(Ie)},[D]),K=I.useCallback(()=>{y==null||y(),s?X():U()},[s,X,U,y]),{isOpen:Y,onOpen:ne,onClose:oe,onToggle:ce}=rm({isOpen:o,defaultIsOpen:d,onClose:m,onOpen:K});GY({enabled:Y&&n,ref:$,handler:Ie=>{var Re,it,Ke;const st=((it=(Re=Ie.composedPath)==null?void 0:Re.call(Ie))==null?void 0:it[0])??Ie.target;(Ke=R.current)!=null&&Ke.contains(st)||oe()}});const Xe=a7({...E,enabled:Y||P,placement:v,direction:O}),[Ae,We]=I.useState(-1);VY($,{focusRef:R,visible:Y});const Ye=BY({isOpen:Y,ref:$}),[tt,Be]=UY(e,"menu-button","menu-list"),Me=I.useCallback(()=>{ne(),U()},[ne,U]),Ge=I.useRef(new Set([]));I.useEffect(()=>{const Ie=Ge.current;return()=>{Ie.forEach(st=>clearTimeout(st)),Ie.clear()}},[]),ef(()=>{var Ie;Y||(We(-1),(Ie=$.current)==null||Ie.scrollTo(0,0))},[Y]),ef(()=>{Y&&Ae===-1&&U()},[Ae,Y]),I.useEffect(()=>{var st;if(!Y)return;const Ie=D.item(Ae);(st=Ie==null?void 0:Ie.node)==null||st.focus({preventScroll:!F.current})},[D,Ae,Y]);const De=I.useCallback(()=>{ne(),X()},[X,ne]),Le=I.useCallback(()=>{F.current=!0,ne(),ee()},[ne,ee]),Oe=I.useCallback(()=>{var Ke,St;const Ie=c7($.current),st=(Ke=$.current)==null?void 0:Ke.contains(Ie.activeElement);if(!(Y&&!st))return;const it=(St=D.item(Ae))==null?void 0:St.node;it==null||it.focus({preventScroll:!F.current})},[Y,Ae,D]);return{openAndFocusMenu:Me,openAndFocusFirstItem:De,openAndFocusLastItem:Le,onTransitionEnd:Oe,unstable__animationState:Ye,descendants:D,popper:Xe,buttonId:tt,menuId:Be,forceUpdate:Xe.forceUpdate,orientation:"vertical",isOpen:Y,onToggle:ce,onOpen:ne,onClose:oe,menuRef:$,buttonRef:R,focusedIndex:Ae,closeOnSelect:r,closeOnBlur:n,autoSelect:s,setFocusedIndex:We,isLazy:a,lazyBehavior:w,initialFocusRef:i,scrollIntoViewRef:F}}function tye(t={},e=null){const r=O1(),{onToggle:n,popper:i,openAndFocusFirstItem:s,openAndFocusLastItem:a,scrollIntoViewRef:o}=r,d=I.useCallback(m=>{const y=m.key,w={Enter:s,ArrowDown:s,ArrowUp:a}[y];w&&(o.current=!0,m.preventDefault(),m.stopPropagation(),w(m))},[s,a,o]);return{...t,ref:bi(r.buttonRef,e,i.referenceRef),id:r.buttonId,"data-active":Sr(r.isOpen),"aria-expanded":r.isOpen,"aria-haspopup":"menu","aria-controls":r.menuId,onClick:Cr(t.onClick,n),onKeyDown:Cr(t.onKeyDown,d)}}function PA(t){var e;return sye(t)&&!!((e=t==null?void 0:t.getAttribute("role"))!=null&&e.startsWith("menuitem"))}function rye(t={},e=null){const r=O1();if(!r)throw new Error("useMenuContext: context is undefined. Seems you forgot to wrap component within <Menu>");const{focusedIndex:n,setFocusedIndex:i,menuRef:s,isOpen:a,onClose:o,menuId:d,isLazy:m,lazyBehavior:y,scrollIntoViewRef:v,unstable__animationState:w}=r,O=Xge(),P=Tme({preventDefault:F=>F.key!==" "&&PA(F.target)}),E=I.useCallback(F=>{if(!F.currentTarget.contains(F.target))return;const D=F.key,X={Tab:K=>K.preventDefault(),Escape:K=>{K.stopPropagation(),o()},ArrowDown:()=>{v.current=!0;const K=O.nextEnabled(n)??O.firstEnabled();K&&i(K.index)},ArrowUp:()=>{v.current=!0;const K=O.prevEnabled(n)??O.firstEnabled();K&&i(K.index)}}[D];if(X){F.preventDefault(),X(F);return}const ee=P(K=>{const Y=kme(O.values(),K,ne=>{var oe;return((oe=ne==null?void 0:ne.node)==null?void 0:oe.textContent)??""},O.item(n));if(Y){const ne=O.indexOf(Y.node);i(ne)}});PA(F.target)&&ee(F)},[O,n,P,o,i,v]),$=I.useRef(!1);a&&($.current=!0);const R=R8({wasSelected:$.current,enabled:m,mode:y,isSelected:w.present});return{...t,ref:bi(s,e),children:R?t.children:null,tabIndex:-1,role:"menu",id:d,style:{...t.style,transformOrigin:"var(--popper-transform-origin)"},"aria-orientation":"vertical",onKeyDown:Cr(t.onKeyDown,E)}}function nye(t={}){const{popper:e,isOpen:r}=O1();return e.getPopperProps({...t,style:{visibility:r?"visible":"hidden",...t.style}})}function iye(t={},e=null){const{onMouseEnter:r,onMouseMove:n,onMouseLeave:i,onClick:s,onFocus:a,isDisabled:o,isFocusable:d,closeOnSelect:m,type:y,...v}=t,w=O1(),{setFocusedIndex:O,focusedIndex:P,closeOnSelect:E,onClose:$,menuId:R,scrollIntoViewRef:F}=w,D=I.useRef(null),U=`${R}-menuitem-${I.useId()}`,{index:X,register:ee}=Zge({disabled:o&&!d}),K=I.useCallback(We=>{r==null||r(We),!o&&(F.current=!1,O(X))},[O,X,o,r,F]),Y=I.useCallback(We=>{n==null||n(We),D.current&&!Jge(D.current)&&K(We)},[K,n]),ne=I.useCallback(We=>{i==null||i(We),!o&&O(-1)},[O,o,i]),oe=I.useCallback(We=>{s==null||s(We),PA(We.currentTarget)&&(m??E)&&$()},[$,s,E,m]),ce=I.useCallback(We=>{a==null||a(We),O(X)},[O,a,X]),Xe=X===P,Ae=l7({onClick:oe,onFocus:ce,onMouseEnter:K,onMouseMove:Y,onMouseLeave:ne,ref:bi(ee,D,e),isDisabled:o,isFocusable:d});return{...v,...Ae,type:y??Ae.type,id:U,role:"menuitem",tabIndex:Xe?0:-1}}function sye(t){if(!oye(t))return!1;const e=t.ownerDocument.defaultView??window;return t instanceof e.HTMLElement}function oye(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}const[aye,j1]=_n({name:"MenuStylesContext",errorMessage:`useMenuStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Menu />" `}),sf=t=>{const{children:e}=t,r=ls("Menu",t),n=Rn(t),{direction:i}=b1(),{descendants:s,...a}=eye({...n,direction:i}),o=I.useMemo(()=>a,[a]),{isOpen:d,onClose:m,forceUpdate:y}=o;return u.jsx(Gge,{value:s,children:u.jsx(Yge,{value:o,children:u.jsx(aye,{value:r,children:Ka(e,{isOpen:d,onClose:m,forceUpdate:y})})})})};sf.displayName="Menu";const lye=Tt((t,e)=>{const r=j1();return u.jsx(mt.button,{ref:e,...t,__css:{display:"inline-flex",appearance:"none",alignItems:"center",outline:0,...r.button}})}),of=Tt((t,e)=>{const{children:r,as:n,...i}=t,s=tye(i,e),a=n||lye;return u.jsx(a,{...s,className:lr("chakra-menu__menu-button",t.className),children:u.jsx(mt.span,{__css:{pointerEvents:"none",flex:"1 1 auto",minW:0},children:t.children})})});of.displayName="MenuButton";const u7=Tt((t,e)=>{const r=j1();return u.jsx(mt.span,{ref:e,...t,__css:r.command,className:"chakra-menu__command"})});u7.displayName="MenuCommand";const h7=t=>{const{className:e,children:r,...n}=t,i=j1(),s=I.Children.only(r),a=I.isValidElement(s)?I.cloneElement(s,{focusable:"false","aria-hidden":!0,className:lr("chakra-menu__icon",s.props.className)}):null,o=lr("chakra-menu__icon-wrapper",e);return u.jsx(mt.span,{className:o,...n,__css:i.icon,children:a})};h7.displayName="MenuIcon";const cye=Tt((t,e)=>{const{type:r,...n}=t,i=j1(),s=n.as||r?r??void 0:"button",a=I.useMemo(()=>({textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,...i.item}),[i.item]);return u.jsx(mt.button,{ref:e,type:s,...n,__css:a})}),xa=Tt((t,e)=>{const{icon:r,iconSpacing:n="0.75rem",command:i,commandSpacing:s="0.75rem",children:a,...o}=t,d=iye(o,e),y=r||i?u.jsx("span",{style:{pointerEvents:"none",flex:1},children:a}):a;return u.jsxs(cye,{...d,className:lr("chakra-menu__menuitem",d.className),children:[r&&u.jsx(h7,{fontSize:"0.8em",marginEnd:n,children:r}),y,i&&u.jsx(u7,{marginStart:s,children:i})]})});xa.displayName="MenuItem";const uye={enter:{visibility:"visible",opacity:1,scale:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scale:.8,transition:{duration:.1,easings:"easeOut"}}},hye=mt(Ln.div),af=Tt(function(e,r){var w;const{rootProps:n,motionProps:i,...s}=e,{isOpen:a,onTransitionEnd:o,unstable__animationState:d}=O1(),m=rye(s,r),y=nye(n),v=j1();return u.jsx(mt.div,{...y,__css:{zIndex:e.zIndex??((w=v.list)==null?void 0:w.zIndex)},children:u.jsx(hye,{variants:uye,initial:!1,animate:a?"enter":"exit",__css:{outline:0,...v.list},...i,...m,className:lr("chakra-menu__menu-list",m.className),onUpdate:o,onAnimationComplete:Hz(d.onComplete,m.onAnimationComplete)})})});af.displayName="MenuList";var dye=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},vg=new WeakMap,xw=new WeakMap,vw={},ZO=0,d7=function(t){return t&&(t.host||d7(t.parentNode))},fye=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=d7(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},pye=function(t,e,r,n){var i=fye(e,Array.isArray(t)?t:[t]);vw[r]||(vw[r]=new WeakMap);var s=vw[r],a=[],o=new Set,d=new Set(i),m=function(v){!v||o.has(v)||(o.add(v),m(v.parentNode))};i.forEach(m);var y=function(v){!v||d.has(v)||Array.prototype.forEach.call(v.children,function(w){if(o.has(w))y(w);else try{var O=w.getAttribute(n),P=O!==null&&O!=="false",E=(vg.get(w)||0)+1,$=(s.get(w)||0)+1;vg.set(w,E),s.set(w,$),a.push(w),E===1&&P&&xw.set(w,!0),$===1&&w.setAttribute(r,"true"),P||w.setAttribute(n,"true")}catch(R){console.error("aria-hidden: cannot operate on ",w,R)}})};return y(e),o.clear(),ZO++,function(){a.forEach(function(v){var w=vg.get(v)-1,O=s.get(v)-1;vg.set(v,w),s.set(v,O),w||(xw.has(v)||v.removeAttribute(n),xw.delete(v)),O||v.removeAttribute(r)}),ZO--,ZO||(vg=new WeakMap,vg=new WeakMap,xw=new WeakMap,vw={})}},mye=function(t,e,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),i=dye(t);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live], script"))),pye(n,i,r,"aria-hidden")):function(){return null}},gye=Object.defineProperty,yye=(t,e,r)=>e in t?gye(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xye=(t,e,r)=>(yye(t,e+"",r),r);class vye{constructor(){xye(this,"modals"),this.modals=new Set}add(e){return this.modals.add(e),this.modals.size}remove(e){this.modals.delete(e)}isTopModal(e){if(!e)return!1;const r=Array.from(this.modals)[this.modals.size-1];return e===r}}const AA=new vye;function f7(t,e){const[r,n]=I.useState(0);return I.useEffect(()=>{const i=t.current;if(i){if(e){const s=AA.add(i);n(s)}return()=>{AA.remove(i),n(0)}}},[e,t]),r}function bye(t){const{isOpen:e,onClose:r,id:n,closeOnOverlayClick:i=!0,closeOnEsc:s=!0,useInert:a=!0,onOverlayClick:o,onEsc:d}=t,m=I.useRef(null),y=I.useRef(null),[v,w,O]=wye(n,"chakra-modal","chakra-modal--header","chakra-modal--body");_ye(m,e&&a);const P=f7(m,e),E=I.useRef(null),$=I.useCallback(ne=>{E.current=ne.target},[]),R=I.useCallback(ne=>{ne.key==="Escape"&&(ne.stopPropagation(),s&&(r==null||r()),d==null||d())},[s,r,d]),[F,D]=I.useState(!1),[U,X]=I.useState(!1),ee=I.useCallback((ne={},oe=null)=>({role:"dialog",...ne,ref:bi(oe,m),id:v,tabIndex:-1,"aria-modal":!0,"aria-labelledby":F?w:void 0,"aria-describedby":U?O:void 0,onClick:Cr(ne.onClick,ce=>ce.stopPropagation())}),[O,U,v,w,F]),K=I.useCallback(ne=>{ne.stopPropagation(),E.current===ne.target&&AA.isTopModal(m.current)&&(i&&(r==null||r()),o==null||o())},[r,i,o]),Y=I.useCallback((ne={},oe=null)=>({...ne,ref:bi(oe,y),onClick:Cr(ne.onClick,K),onKeyDown:Cr(ne.onKeyDown,R),onMouseDown:Cr(ne.onMouseDown,$)}),[R,$,K]);return{isOpen:e,onClose:r,headerId:w,bodyId:O,setBodyMounted:X,setHeaderMounted:D,dialogRef:m,overlayRef:y,getDialogProps:ee,getDialogContainerProps:Y,index:P}}function _ye(t,e){const r=t.current;I.useEffect(()=>{if(!(!t.current||!e))return mye(t.current)},[e,t,r])}function wye(t,...e){const r=I.useId(),n=t||r;return I.useMemo(()=>e.map(i=>`${i}-${n}`),[n,e])}const[Sye,_0]=_n({name:"ModalStylesContext",errorMessage:`useModalStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Modal />" `}),[kye,lm]=_n({strict:!0,name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap modal components in `<Modal />`"}),ss=t=>{const e={scrollBehavior:"outside",autoFocus:!0,trapFocus:!0,returnFocusOnClose:!0,blockScrollOnMount:!0,allowPinchZoom:!1,preserveScrollBarGap:!0,motionPreset:"scale",...t,lockFocusAcrossFrames:t.lockFocusAcrossFrames??!0},{portalProps:r,children:n,autoFocus:i,trapFocus:s,initialFocusRef:a,finalFocusRef:o,returnFocusOnClose:d,blockScrollOnMount:m,allowPinchZoom:y,preserveScrollBarGap:v,motionPreset:w,lockFocusAcrossFrames:O,animatePresenceProps:P,onCloseComplete:E}=e,$=ls("Modal",e),F={...bye(e),autoFocus:i,trapFocus:s,initialFocusRef:a,finalFocusRef:o,returnFocusOnClose:d,blockScrollOnMount:m,allowPinchZoom:y,preserveScrollBarGap:v,motionPreset:w,lockFocusAcrossFrames:O};return u.jsx(kye,{value:F,children:u.jsx(Sye,{value:$,children:u.jsx(vc,{...P,onExitComplete:E,children:F.isOpen&&u.jsx(b0,{...r,children:n})})})})};ss.displayName="Modal";var SS="right-scroll-bar-position",kS="width-before-scroll-bar",Cye="with-scroll-bars-hidden",Tye="--removed-body-scroll-bar-size",p7=_W(),YO=function(){},tC=I.forwardRef(function(t,e){var r=I.useRef(null),n=I.useState({onScrollCapture:YO,onWheelCapture:YO,onTouchMoveCapture:YO}),i=n[0],s=n[1],a=t.forwardProps,o=t.children,d=t.className,m=t.removeScrollBar,y=t.enabled,v=t.shards,w=t.sideCar,O=t.noRelative,P=t.noIsolation,E=t.inert,$=t.allowPinchZoom,R=t.as,F=R===void 0?"div":R,D=t.gapMode,U=xW(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),X=w,ee=yW([r,e]),K=iu(iu({},U),i);return I.createElement(I.Fragment,null,y&&I.createElement(X,{sideCar:p7,removeScrollBar:m,shards:v,noRelative:O,noIsolation:P,inert:E,setCallbacks:s,allowPinchZoom:!!$,lockRef:r,gapMode:D}),a?I.cloneElement(I.Children.only(o),iu(iu({},K),{ref:ee})):I.createElement(F,iu({},K,{className:d,ref:ee}),o))});tC.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};tC.classNames={fullWidth:kS,zeroRight:SS};var Oye=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function jye(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Oye();return e&&t.setAttribute("nonce",e),t}function Pye(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Aye(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Eye=function(){var t=0,e=null;return{add:function(r){t==0&&(e=jye())&&(Pye(e,r),Aye(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},zye=function(){var t=Eye();return function(e,r){I.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},m7=function(){var t=zye(),e=function(r){var n=r.styles,i=r.dynamic;return t(n,i),null};return e},Mye={left:0,top:0,right:0,gap:0},JO=function(t){return parseInt(t||"",10)||0},Iye=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],n=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[JO(r),JO(n),JO(i)]},Rye=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Mye;var e=Iye(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},Dye=m7(),my="data-scroll-locked",Lye=function(t,e,r,n){var i=t.left,s=t.top,a=t.right,o=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(Cye,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(my,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(SS,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(kS,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(SS," .").concat(SS,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(kS," .").concat(kS,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(my,`] {
    `).concat(Tye,": ").concat(o,`px;
  }
`)},FL=function(){var t=parseInt(document.body.getAttribute(my)||"0",10);return isFinite(t)?t:0},Fye=function(){I.useEffect(function(){return document.body.setAttribute(my,(FL()+1).toString()),function(){var t=FL()-1;t<=0?document.body.removeAttribute(my):document.body.setAttribute(my,t.toString())}},[])},Bye=function(t){var e=t.noRelative,r=t.noImportant,n=t.gapMode,i=n===void 0?"margin":n;Fye();var s=I.useMemo(function(){return Rye(i)},[i]);return I.createElement(Dye,{styles:Lye(s,!e,i,r?"":"!important")})},EA=!1;if(typeof window<"u")try{var bw=Object.defineProperty({},"passive",{get:function(){return EA=!0,!0}});window.addEventListener("test",bw,bw),window.removeEventListener("test",bw,bw)}catch{EA=!1}var bg=EA?{passive:!1}:!1,$ye=function(t){return t.tagName==="TEXTAREA"},g7=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!$ye(t)&&r[e]==="visible")},Nye=function(t){return g7(t,"overflowY")},Vye=function(t){return g7(t,"overflowX")},BL=function(t,e){var r=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var i=y7(t,n);if(i){var s=x7(t,n),a=s[1],o=s[2];if(a>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Wye=function(t){var e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[e,r,n]},Uye=function(t){var e=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[e,r,n]},y7=function(t,e){return t==="v"?Nye(e):Vye(e)},x7=function(t,e){return t==="v"?Wye(e):Uye(e)},qye=function(t,e){return t==="h"&&e==="rtl"?-1:1},Qye=function(t,e,r,n,i){var s=qye(t,window.getComputedStyle(e).direction),a=s*n,o=r.target,d=e.contains(o),m=!1,y=a>0,v=0,w=0;do{if(!o)break;var O=x7(t,o),P=O[0],E=O[1],$=O[2],R=E-$-s*P;(P||R)&&y7(t,o)&&(v+=R,w+=P);var F=o.parentNode;o=F&&F.nodeType===Node.DOCUMENT_FRAGMENT_NODE?F.host:F}while(!d&&o!==document.body||d&&(e.contains(o)||e===o));return(y&&Math.abs(v)<1||!y&&Math.abs(w)<1)&&(m=!0),m},_w=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},$L=function(t){return[t.deltaX,t.deltaY]},NL=function(t){return t&&"current"in t?t.current:t},Hye=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Gye=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Xye=0,_g=[];function Kye(t){var e=I.useRef([]),r=I.useRef([0,0]),n=I.useRef(),i=I.useState(Xye++)[0],s=I.useState(m7)[0],a=I.useRef(t);I.useEffect(function(){a.current=t},[t]),I.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var E=ipe([t.lockRef.current],(t.shards||[]).map(NL),!0).filter(Boolean);return E.forEach(function($){return $.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),E.forEach(function($){return $.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var o=I.useCallback(function(E,$){if("touches"in E&&E.touches.length===2||E.type==="wheel"&&E.ctrlKey)return!a.current.allowPinchZoom;var R=_w(E),F=r.current,D="deltaX"in E?E.deltaX:F[0]-R[0],U="deltaY"in E?E.deltaY:F[1]-R[1],X,ee=E.target,K=Math.abs(D)>Math.abs(U)?"h":"v";if("touches"in E&&K==="h"&&ee.type==="range")return!1;var Y=window.getSelection(),ne=Y&&Y.anchorNode,oe=ne?ne===ee||ne.contains(ee):!1;if(oe)return!1;var ce=BL(K,ee);if(!ce)return!0;if(ce?X=K:(X=K==="v"?"h":"v",ce=BL(K,ee)),!ce)return!1;if(!n.current&&"changedTouches"in E&&(D||U)&&(n.current=X),!X)return!0;var Xe=n.current||X;return Qye(Xe,$,E,Xe==="h"?D:U)},[]),d=I.useCallback(function(E){var $=E;if(!(!_g.length||_g[_g.length-1]!==s)){var R="deltaY"in $?$L($):_w($),F=e.current.filter(function(X){return X.name===$.type&&(X.target===$.target||$.target===X.shadowParent)&&Hye(X.delta,R)})[0];if(F&&F.should){$.cancelable&&$.preventDefault();return}if(!F){var D=(a.current.shards||[]).map(NL).filter(Boolean).filter(function(X){return X.contains($.target)}),U=D.length>0?o($,D[0]):!a.current.noIsolation;U&&$.cancelable&&$.preventDefault()}}},[]),m=I.useCallback(function(E,$,R,F){var D={name:E,delta:$,target:R,should:F,shadowParent:Zye(R)};e.current.push(D),setTimeout(function(){e.current=e.current.filter(function(U){return U!==D})},1)},[]),y=I.useCallback(function(E){r.current=_w(E),n.current=void 0},[]),v=I.useCallback(function(E){m(E.type,$L(E),E.target,o(E,t.lockRef.current))},[]),w=I.useCallback(function(E){m(E.type,_w(E),E.target,o(E,t.lockRef.current))},[]);I.useEffect(function(){return _g.push(s),t.setCallbacks({onScrollCapture:v,onWheelCapture:v,onTouchMoveCapture:w}),document.addEventListener("wheel",d,bg),document.addEventListener("touchmove",d,bg),document.addEventListener("touchstart",y,bg),function(){_g=_g.filter(function(E){return E!==s}),document.removeEventListener("wheel",d,bg),document.removeEventListener("touchmove",d,bg),document.removeEventListener("touchstart",y,bg)}},[]);var O=t.removeScrollBar,P=t.inert;return I.createElement(I.Fragment,null,P?I.createElement(s,{styles:Gye(i)}):null,O?I.createElement(Bye,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function Zye(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Yye=spe(p7,Kye);var v7=I.forwardRef(function(t,e){return I.createElement(tC,iu({},t,{ref:e,sideCar:Yye}))});v7.classNames=tC.classNames;function Jye(t){const{autoFocus:e,trapFocus:r,dialogRef:n,initialFocusRef:i,blockScrollOnMount:s,allowPinchZoom:a,finalFocusRef:o,returnFocusOnClose:d,preserveScrollBarGap:m,lockFocusAcrossFrames:y,isOpen:v}=lm(),[w,O]=W9();I.useEffect(()=>{!w&&O&&setTimeout(O)},[w,O]);const P=f7(n,v);return u.jsx(GW,{autoFocus:e,isDisabled:!r,initialFocusRef:i,finalFocusRef:o,restoreFocus:d,contentRef:n,lockFocusAcrossFrames:y,children:u.jsx(v7,{removeScrollBar:!m,allowPinchZoom:a,enabled:P===1&&s,forwardProps:!0,children:t.children})})}const e0e={initial:({offsetX:t,offsetY:e,transition:r,transitionEnd:n,delay:i})=>({opacity:0,x:t,y:e,transition:(r==null?void 0:r.exit)??ph.exit($p.exit,i),transitionEnd:n==null?void 0:n.exit}),enter:({transition:t,transitionEnd:e,delay:r})=>({opacity:1,x:0,y:0,transition:(t==null?void 0:t.enter)??ph.enter($p.enter,r),transitionEnd:e==null?void 0:e.enter}),exit:({offsetY:t,offsetX:e,transition:r,transitionEnd:n,reverse:i,delay:s})=>{const a={x:e,y:t};return{opacity:0,transition:(r==null?void 0:r.exit)??ph.exit($p.exit,s),...i?{...a,transitionEnd:n==null?void 0:n.exit}:{transitionEnd:{...a,...n==null?void 0:n.exit}}}}},dv={initial:"initial",animate:"enter",exit:"exit",variants:e0e},t0e=I.forwardRef(function(e,r){const{unmountOnExit:n,in:i,reverse:s=!0,className:a,offsetX:o=0,offsetY:d=8,transition:m,transitionEnd:y,delay:v,animatePresenceProps:w,...O}=e,P=n?i&&n:!0,E=i||n?"enter":"exit",$={offsetX:o,offsetY:d,reverse:s,transition:m,transitionEnd:y,delay:v};return u.jsx(vc,{...w,custom:$,children:P&&u.jsx(Ln.div,{ref:r,className:lr("chakra-offset-slide",a),custom:$,...dv,animate:E,...O})})});t0e.displayName="SlideFade";const r0e={exit:({reverse:t,initialScale:e,transition:r,transitionEnd:n,delay:i})=>({opacity:0,...t?{scale:e,transitionEnd:n==null?void 0:n.exit}:{transitionEnd:{scale:e,...n==null?void 0:n.exit}},transition:(r==null?void 0:r.exit)??ph.exit($p.exit,i)}),enter:({transitionEnd:t,transition:e,delay:r})=>({opacity:1,scale:1,transition:(e==null?void 0:e.enter)??ph.enter($p.enter,r),transitionEnd:t==null?void 0:t.enter})},b7={initial:"exit",animate:"enter",exit:"exit",variants:r0e},n0e=I.forwardRef(function(e,r){const{unmountOnExit:n,in:i,reverse:s=!0,initialScale:a=.95,className:o,transition:d,transitionEnd:m,delay:y,animatePresenceProps:v,...w}=e,O=n?i&&n:!0,P=i||n?"enter":"exit",E={initialScale:a,reverse:s,transition:d,transitionEnd:m,delay:y};return u.jsx(vc,{...v,custom:E,children:O&&u.jsx(Ln.div,{ref:r,className:lr("chakra-offset-slide",o),...b7,animate:P,custom:E,...w})})});n0e.displayName="ScaleFade";const i0e={slideInBottom:{...dv,custom:{offsetY:16,reverse:!0}},slideInRight:{...dv,custom:{offsetX:16,reverse:!0}},slideInTop:{...dv,custom:{offsetY:-16,reverse:!0}},slideInLeft:{...dv,custom:{offsetX:-16,reverse:!0}},scale:{...b7,custom:{initialScale:.95,reverse:!0}},none:{}},s0e=mt(Ln.section),o0e=t=>i0e[t||"none"],_7=I.forwardRef((t,e)=>{const{preset:r,motionProps:n=o0e(r),...i}=t;return u.jsx(s0e,{ref:e,...n,...i})});_7.displayName="ModalTransition";const os=Tt((t,e)=>{const{className:r,children:n,containerProps:i,motionProps:s,...a}=t,{getDialogProps:o,getDialogContainerProps:d}=lm(),m=o(a,e),y=d(i),v=lr("chakra-modal__content",r),w=_0(),O={display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0,...w.dialog},P={display:"flex",width:"100vw",height:"$100vh",position:"fixed",left:0,top:0,...w.dialogContainer},{motionPreset:E}=lm();return u.jsx(Jye,{children:u.jsx(mt.div,{...y,className:"chakra-modal__content-container",tabIndex:-1,__css:P,children:u.jsx(_7,{preset:E,motionProps:s,className:v,...m,__css:O,children:n})})})});os.displayName="ModalContent";const ws=Tt((t,e)=>{const{className:r,...n}=t,{bodyId:i,setBodyMounted:s}=lm();I.useEffect(()=>(s(!0),()=>s(!1)),[s]);const a=lr("chakra-modal__body",r),o=_0();return u.jsx(mt.div,{ref:e,className:a,id:i,...n,__css:o.body})});ws.displayName="ModalBody";const Ns=Tt((t,e)=>{const{onClick:r,className:n,...i}=t,{onClose:s}=lm(),a=lr("chakra-modal__close-btn",n),o=_0();return u.jsx(kb,{ref:e,__css:o.closeButton,className:a,onClick:Cr(r,d=>{d.stopPropagation(),s()}),...i})});Ns.displayName="ModalCloseButton";const To=Tt((t,e)=>{const{className:r,...n}=t,i=lr("chakra-modal__footer",r),s=_0(),a={display:"flex",alignItems:"center",justifyContent:"flex-end",...s.footer};return u.jsx(mt.footer,{ref:e,...n,__css:a,className:i})});To.displayName="ModalFooter";const P1=Tt((t,e)=>{const{className:r,...n}=t,{headerId:i,setHeaderMounted:s}=lm();I.useEffect(()=>(s(!0),()=>s(!1)),[s]);const a=lr("chakra-modal__header",r),o=_0(),d={flex:0,...o.header};return u.jsx(mt.header,{ref:e,className:a,id:i,...n,__css:d})});P1.displayName="ModalHeader";const a0e={enter:({transition:t,transitionEnd:e,delay:r}={})=>({opacity:1,transition:(t==null?void 0:t.enter)??ph.enter($p.enter,r),transitionEnd:e==null?void 0:e.enter}),exit:({transition:t,transitionEnd:e,delay:r}={})=>({opacity:0,transition:(t==null?void 0:t.exit)??ph.exit($p.exit,r),transitionEnd:e==null?void 0:e.exit})},w7={initial:"exit",animate:"enter",exit:"exit",variants:a0e},l0e=I.forwardRef(function(e,r){const{unmountOnExit:n,in:i,className:s,transition:a,transitionEnd:o,delay:d,animatePresenceProps:m,...y}=e,v=i||n?"enter":"exit",w=n?i&&n:!0,O={transition:a,transitionEnd:o,delay:d};return u.jsx(vc,{...m,custom:O,children:w&&u.jsx(Ln.div,{ref:r,className:lr("chakra-fade",s),custom:O,...w7,animate:v,...y})})});l0e.displayName="Fade";const c0e=mt(Ln.div),as=Tt((t,e)=>{const{className:r,transition:n,motionProps:i,...s}=t,a=lr("chakra-modal__overlay",r),d={pos:"fixed",left:"0",top:"0",w:"100vw",h:"100vh",..._0().overlay},{motionPreset:m}=lm(),v=i||(m==="none"?{}:w7);return u.jsx(c0e,{...v,__css:d,ref:e,className:a,...s})});as.displayName="ModalOverlay";const u0e=t=>u.jsx(ze,{viewBox:"0 0 24 24",...t,children:u.jsx("path",{fill:"currentColor",d:"M21,5H3C2.621,5,2.275,5.214,2.105,5.553C1.937,5.892,1.973,6.297,2.2,6.6l9,12 c0.188,0.252,0.485,0.4,0.8,0.4s0.611-0.148,0.8-0.4l9-12c0.228-0.303,0.264-0.708,0.095-1.047C21.725,5.214,21.379,5,21,5z"})}),h0e=t=>u.jsx(ze,{viewBox:"0 0 24 24",...t,children:u.jsx("path",{fill:"currentColor",d:"M12.8,5.4c-0.377-0.504-1.223-0.504-1.6,0l-9,12c-0.228,0.303-0.264,0.708-0.095,1.047 C2.275,18.786,2.621,19,3,19h18c0.379,0,0.725-0.214,0.895-0.553c0.169-0.339,0.133-0.744-0.095-1.047L12.8,5.4z"})});function VL(t,e,r,n){I.useEffect(()=>{if(!t.current||!n)return;const i=t.current.ownerDocument.defaultView??window,s=Array.isArray(e)?e:[e],a=new i.MutationObserver(o=>{for(const d of o)d.type==="attributes"&&d.attributeName&&s.includes(d.attributeName)&&r(d)});return a.observe(t.current,{attributes:!0,attributeFilter:s}),()=>a.disconnect()})}const d0e=50,WL=300;function f0e(t,e){const[r,n]=I.useState(!1),[i,s]=I.useState(null),[a,o]=I.useState(!0),d=I.useRef(null),m=()=>clearTimeout(d.current);qY(()=>{i==="increment"&&t(),i==="decrement"&&e()},r?d0e:null);const y=I.useCallback(()=>{a&&t(),d.current=setTimeout(()=>{o(!1),n(!0),s("increment")},WL)},[t,a]),v=I.useCallback(()=>{a&&e(),d.current=setTimeout(()=>{o(!1),n(!0),s("decrement")},WL)},[e,a]),w=I.useCallback(()=>{o(!0),n(!1),m()},[]);return I.useEffect(()=>()=>m(),[]),{up:y,down:v,stop:w,isSpinning:r}}const p0e=/^[Ee0-9+\-.]$/;function m0e(t){return p0e.test(t)}function g0e(t,e){if(t.key==null)return!0;const r=t.ctrlKey||t.altKey||t.metaKey;return!(t.key.length===1)||r?!0:e(t.key)}function y0e(t={}){const{focusInputOnChange:e=!0,clampValueOnBlur:r=!0,keepWithinRange:n=!0,min:i=Number.MIN_SAFE_INTEGER,max:s=Number.MAX_SAFE_INTEGER,step:a=1,isReadOnly:o,isDisabled:d,isRequired:m,isInvalid:y,pattern:v="[0-9]*(.[0-9]+)?",inputMode:w="decimal",allowMouseWheel:O,id:P,onChange:E,precision:$,name:R,"aria-describedby":F,"aria-label":D,"aria-labelledby":U,onFocus:X,onBlur:ee,onInvalid:K,getAriaValueText:Y,isValidCharacter:ne,format:oe,parse:ce,...Xe}=t,Ae=Vi(X),We=Vi(ee),Ye=Vi(K),tt=Vi(ne??m0e),Be=Vi(Y),Me=$Y(t),{update:Ge,increment:De,decrement:Le}=Me,[Oe,Ie]=I.useState(!1),st=!(o||d),Re=I.useRef(null),it=I.useRef(null),Ke=I.useRef(null),St=I.useRef(null),Mt=I.useCallback(He=>He.split("").filter(tt).join(""),[tt]),Et=I.useCallback(He=>(ce==null?void 0:ce(He))??He,[ce]),xt=I.useCallback(He=>((oe==null?void 0:oe(He))??He).toString(),[oe]);ef(()=>{(Me.valueAsNumber>s||Me.valueAsNumber<i)&&(Ye==null||Ye("rangeOverflow",xt(Me.value),Me.valueAsNumber))},[Me.valueAsNumber,Me.value,xt,Ye]),Rp(()=>{if(!Re.current)return;if(Re.current.value!=Me.value){const Vr=Et(Re.current.value);Me.setValue(Mt(Vr))}},[Et,Mt]);const et=I.useCallback((He=a)=>{st&&De(He)},[De,st,a]),Yt=I.useCallback((He=a)=>{st&&Le(He)},[Le,st,a]),_t=f0e(et,Yt);VL(Ke,"disabled",_t.stop,_t.isSpinning),VL(St,"disabled",_t.stop,_t.isSpinning);const rt=I.useCallback(He=>{if(He.nativeEvent.isComposing)return;const Ct=Et(He.currentTarget.value);Ge(Mt(Ct)),it.current={start:He.currentTarget.selectionStart,end:He.currentTarget.selectionEnd}},[Ge,Mt,Et]),Te=I.useCallback(He=>{var Vr;Ae==null||Ae(He),it.current&&(He.currentTarget.selectionStart=it.current.start??((Vr=He.currentTarget.value)==null?void 0:Vr.length),He.currentTarget.selectionEnd=it.current.end??He.currentTarget.selectionStart)},[Ae]),ct=I.useCallback(He=>{if(He.nativeEvent.isComposing)return;g0e(He,tt)||He.preventDefault();const Vr=Vt(He)*a,Ct=He.key,wn={ArrowUp:()=>et(Vr),ArrowDown:()=>Yt(Vr),Home:()=>Ge(i),End:()=>Ge(s)}[Ct];wn&&(He.preventDefault(),wn(He))},[tt,a,et,Yt,Ge,i,s]),Vt=He=>{let Vr=1;return(He.metaKey||He.ctrlKey)&&(Vr=.1),He.shiftKey&&(Vr=10),Vr},wt=I.useMemo(()=>{const He=Be==null?void 0:Be(Me.value);if(He!=null)return He;const Vr=Me.value.toString();return Vr||void 0},[Me.value,Be]),Ft=I.useCallback(()=>{let He=Me.value;if(Me.value==="")return;/^[eE]/.test(Me.value.toString())?Me.setValue(""):(Me.valueAsNumber<i&&(He=i),Me.valueAsNumber>s&&(He=s),Me.cast(He))},[Me,s,i]),Kr=I.useCallback(()=>{Ie(!1),r&&Ft()},[r,Ie,Ft]),yn=I.useCallback(()=>{e&&requestAnimationFrame(()=>{var He;(He=Re.current)==null||He.focus()})},[e]),an=I.useCallback(He=>{He.preventDefault(),_t.up(),yn()},[yn,_t]),Cn=I.useCallback(He=>{He.preventDefault(),_t.down(),yn()},[yn,_t]);Pv(()=>Re.current,"wheel",He=>{var vt;const Ct=(((vt=Re.current)==null?void 0:vt.ownerDocument)??document).activeElement===Re.current;if(!O||!Ct)return;He.preventDefault();const Ut=Vt(He)*a,wn=Math.sign(He.deltaY);wn===-1?et(Ut):wn===1&&Yt(Ut)},{passive:!1});const xn=I.useCallback((He={},Vr=null)=>{const Ct=d||n&&Me.isAtMax;return{...He,ref:bi(Vr,Ke),role:"button",tabIndex:-1,onPointerDown:Cr(He.onPointerDown,Ut=>{Ut.button!==0||Ct||an(Ut)}),onPointerLeave:Cr(He.onPointerLeave,_t.stop),onPointerUp:Cr(He.onPointerUp,_t.stop),disabled:Ct,"aria-disabled":Fl(Ct)}},[Me.isAtMax,n,an,_t.stop,d]),di=I.useCallback((He={},Vr=null)=>{const Ct=d||n&&Me.isAtMin;return{...He,ref:bi(Vr,St),role:"button",tabIndex:-1,onPointerDown:Cr(He.onPointerDown,Ut=>{Ut.button!==0||Ct||Cn(Ut)}),onPointerLeave:Cr(He.onPointerLeave,_t.stop),onPointerUp:Cr(He.onPointerUp,_t.stop),disabled:Ct,"aria-disabled":Fl(Ct)}},[Me.isAtMin,n,Cn,_t.stop,d]),Pi=I.useCallback((He={},Vr=null)=>({name:R,inputMode:w,type:"text",pattern:v,"aria-labelledby":U,"aria-label":D,"aria-describedby":F,id:P,disabled:d,role:"spinbutton",...He,readOnly:He.readOnly??o,"aria-readonly":He.readOnly??o,"aria-required":He.required??m,required:He.required??m,ref:bi(Re,Vr),value:xt(Me.value),"aria-valuemin":i,"aria-valuemax":s,"aria-valuenow":Number.isNaN(Me.valueAsNumber)?void 0:Me.valueAsNumber,"aria-invalid":Fl(y??Me.isOutOfRange),"aria-valuetext":wt,autoComplete:"off",autoCorrect:"off",onChange:Cr(He.onChange,rt),onKeyDown:Cr(He.onKeyDown,ct),onFocus:Cr(He.onFocus,Te,()=>Ie(!0)),onBlur:Cr(He.onBlur,We,Kr)}),[R,w,v,U,D,xt,F,P,d,m,o,y,Me.value,Me.valueAsNumber,Me.isOutOfRange,i,s,wt,rt,ct,Te,We,Kr]);return{value:xt(Me.value),valueAsNumber:Me.valueAsNumber,isFocused:Oe,isDisabled:d,isReadOnly:o,getIncrementButtonProps:xn,getDecrementButtonProps:di,getInputProps:Pi,htmlProps:Xe}}const[x0e,rC]=_n({name:"NumberInputStylesContext",errorMessage:`useNumberInputStyles returned is 'undefined'. Seems you forgot to wrap the components in "<NumberInput />" `}),[v0e,bM]=_n({name:"NumberInputContext",errorMessage:"useNumberInputContext: `context` is undefined. Seems you forgot to wrap number-input's components within <NumberInput />"}),Wp=Tt(function(e,r){const n=ls("NumberInput",e),i=Rn(e),s=Z5(i),{htmlProps:a,...o}=y0e(s),d=I.useMemo(()=>o,[o]);return u.jsx(v0e,{value:d,children:u.jsx(x0e,{value:n,children:u.jsx(mt.div,{...a,ref:r,className:lr("chakra-numberinput",e.className),__css:{position:"relative",zIndex:0,...n.root}})})})});Wp.displayName="NumberInput";const Up=Tt(function(e,r){const n=rC();return u.jsx(mt.div,{"aria-hidden":!0,ref:r,...e,__css:{display:"flex",flexDirection:"column",position:"absolute",top:"0",insetEnd:"0px",margin:"1px",height:"calc(100% - 2px)",zIndex:1,...n.stepperGroup}})});Up.displayName="NumberInputStepper";const qp=Tt(function(e,r){const{getInputProps:n}=bM(),i=n(e,r),s=rC();return u.jsx(mt.input,{...i,className:lr("chakra-numberinput__field",e.className),__css:{width:"100%",...s.field}})});qp.displayName="NumberInputField";const S7=mt("div",{baseStyle:{display:"flex",justifyContent:"center",alignItems:"center",flex:1,transitionProperty:"common",transitionDuration:"normal",userSelect:"none",cursor:"pointer",lineHeight:"normal"}}),Qp=Tt(function(e,r){const n=rC(),{getDecrementButtonProps:i}=bM(),s=i(e,r);return u.jsx(S7,{...s,__css:n.stepper,children:e.children??u.jsx(u0e,{})})});Qp.displayName="NumberDecrementStepper";const Hp=Tt(function(e,r){const{getIncrementButtonProps:n}=bM(),i=n(e,r),s=rC();return u.jsx(S7,{...i,__css:s.stepper,children:e.children??u.jsx(h0e,{})})});Hp.displayName="NumberIncrementStepper";function b0e(t){var r;const e=I.version;return typeof e!="string"||e.startsWith("18.")?t==null?void 0:t.ref:(r=t==null?void 0:t.props)==null?void 0:r.ref}function _0e(t,e,r){return(t-e)*100/(r-e)}lo({"0%":{strokeDasharray:"1, 400",strokeDashoffset:"0"},"50%":{strokeDasharray:"400, 400",strokeDashoffset:"-100"},"100%":{strokeDasharray:"400, 400",strokeDashoffset:"-260"}});lo({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}});const w0e=lo({"0%":{left:"-40%"},"100%":{left:"100%"}}),S0e=lo({from:{backgroundPosition:"1rem 0"},to:{backgroundPosition:"0 0"}});function k0e(t){const{value:e=0,min:r,max:n,valueText:i,getValueText:s,isIndeterminate:a,role:o="progressbar"}=t,d=_0e(e,r,n);return{bind:{"data-indeterminate":a?"":void 0,"aria-valuemax":n,"aria-valuemin":r,"aria-valuenow":a?void 0:e,"aria-valuetext":(()=>{if(e!=null)return typeof s=="function"?s(e,d):i})(),role:o},percent:d,value:e}}const[C0e,T0e]=_n({name:"ProgressStylesContext",errorMessage:`useProgressStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Progress />" `}),O0e=Tt((t,e)=>{const{min:r,max:n,value:i,isIndeterminate:s,role:a,...o}=t,d=k0e({value:i,min:r,max:n,isIndeterminate:s,role:a}),y={height:"100%",...T0e().filledTrack};return u.jsx(mt.div,{ref:e,style:{width:`${d.percent}%`,...o.style},...d.bind,...o,__css:y})}),Sf=Tt((t,e)=>{var K;const{value:r,min:n=0,max:i=100,hasStripe:s,isAnimated:a,children:o,borderRadius:d,isIndeterminate:m,"aria-label":y,"aria-labelledby":v,"aria-valuetext":w,title:O,role:P,...E}=Rn(t),$=ls("Progress",t),R=d??((K=$.track)==null?void 0:K.borderRadius),F={animation:`${S0e} 1s linear infinite`},X={...!m&&s&&a&&F,...m&&{position:"absolute",willChange:"left",minWidth:"50%",animation:`${w0e} 1s ease infinite normal none running`}},ee={overflow:"hidden",position:"relative",...$.track};return u.jsx(mt.div,{ref:e,borderRadius:R,__css:ee,...E,children:u.jsxs(C0e,{value:$,children:[u.jsx(O0e,{"aria-label":y,"aria-labelledby":v,"aria-valuetext":w,min:n,max:i,value:r,isIndeterminate:m,css:X,borderRadius:R,title:O,role:P}),o]})})});Sf.displayName="Progress";function j0e(t){return t&&no(t)&&no(t.target)}function P0e(t={}){const{onChange:e,value:r,defaultValue:n,name:i,isDisabled:s,isFocusable:a,isNative:o,...d}=t,[m,y]=I.useState(n||""),v=typeof r<"u",w=v?r:m,O=I.useRef(null),P=I.useCallback(()=>{const X=O.current;if(!X)return;let ee="input:not(:disabled):checked";const K=X.querySelector(ee);if(K){K.focus();return}ee="input:not(:disabled)";const Y=X.querySelector(ee);Y==null||Y.focus()},[]),$=`radio-${I.useId()}`,R=i||$,F=I.useCallback(X=>{const ee=j0e(X)?X.target.value:X;v||y(ee),e==null||e(String(ee))},[e,v]),D=I.useCallback((X={},ee=null)=>({...X,ref:bi(ee,O),role:"radiogroup"}),[]),U=I.useCallback((X={},ee=null)=>({...X,ref:ee,name:R,[o?"checked":"isChecked"]:w!=null?X.value===w:void 0,onChange(Y){F(Y)},"data-radiogroup":!0}),[o,R,F,w]);return{getRootProps:D,getRadioProps:U,name:R,ref:O,focus:P,setValue:y,value:w,onChange:F,isDisabled:s,isFocusable:a,htmlProps:d}}const[A0e,k7]=_n({name:"RadioGroupContext",strict:!1}),C7=Tt((t,e)=>{const{colorScheme:r,size:n,variant:i,children:s,className:a,isDisabled:o,isFocusable:d,...m}=t,{value:y,onChange:v,getRootProps:w,name:O,htmlProps:P}=P0e(m),E=I.useMemo(()=>({name:O,size:n,onChange:v,colorScheme:r,value:y,variant:i,isDisabled:o,isFocusable:d}),[O,n,v,r,y,i,o,d]);return u.jsx(A0e,{value:E,children:u.jsx(mt.div,{...w(P,e),className:lr("chakra-radio-group",a),children:s})})});C7.displayName="RadioGroup";function E0e(t={}){const{defaultChecked:e,isChecked:r,isFocusable:n,isDisabled:i,isReadOnly:s,isRequired:a,onChange:o,isInvalid:d,name:m,value:y,id:v,"data-radiogroup":w,"aria-describedby":O,...P}=t,E=`radio-${I.useId()}`,$=S1(),F=!!k7()||!!w;let U=!!$&&!F?$.id:E;U=v??U;const X=i??($==null?void 0:$.isDisabled),ee=s??($==null?void 0:$.isReadOnly),K=a??($==null?void 0:$.isRequired),Y=d??($==null?void 0:$.isInvalid),[ne,oe]=I.useState(!1),[ce,Xe]=I.useState(!1),[Ae,We]=I.useState(!1),[Ye,tt]=I.useState(!!e),Be=typeof r<"u",Me=Be?r:Ye,Ge=I.useRef(!1);I.useEffect(()=>uW(Et=>{Ge.current=Et}),[]);const De=I.useCallback(Et=>{if(ee||X){Et.preventDefault();return}Be||tt(Et.currentTarget.checked),o==null||o(Et)},[Be,X,ee,o]),Le=I.useCallback(Et=>{Et.key===" "&&We(!0)},[We]),Oe=I.useCallback(Et=>{Et.key===" "&&We(!1)},[We]),Ie=I.useCallback((Et={},xt=null)=>({...Et,ref:xt,"data-active":Sr(Ae),"data-hover":Sr(ce),"data-disabled":Sr(X),"data-invalid":Sr(Y),"data-checked":Sr(Me),"data-focus":Sr(ne),"data-focus-visible":Sr(ne&&Ge.current),"data-readonly":Sr(ee),"aria-hidden":!0,onMouseDown:Cr(Et.onMouseDown,()=>We(!0)),onMouseUp:Cr(Et.onMouseUp,()=>We(!1)),onMouseEnter:Cr(Et.onMouseEnter,()=>Xe(!0)),onMouseLeave:Cr(Et.onMouseLeave,()=>Xe(!1))}),[Ae,ce,X,Y,Me,ne,ee]),{onFocus:st,onBlur:Re}=$??{},it=I.useCallback((Et={},xt=null)=>{const et=X&&!n;return{...Et,id:U,ref:xt,type:"radio",name:m,value:y,onChange:Cr(Et.onChange,De),onBlur:Cr(Re,Et.onBlur,()=>oe(!1)),onFocus:Cr(st,Et.onFocus,()=>oe(!0)),onKeyDown:Cr(Et.onKeyDown,Le),onKeyUp:Cr(Et.onKeyUp,Oe),checked:Me,disabled:et,readOnly:ee,required:K,"aria-invalid":Fl(Y),"aria-disabled":Fl(et),"aria-required":Fl(K),"data-readonly":Sr(ee),"aria-describedby":O,style:dW}},[X,n,U,m,y,De,Re,st,Le,Oe,Me,ee,K,Y,O]);return{state:{isInvalid:Y,isFocused:ne,isChecked:Me,isActive:Ae,isHovered:ce,isDisabled:X,isReadOnly:ee,isRequired:K},getRadioProps:Ie,getInputProps:it,getLabelProps:(Et={},xt=null)=>({...Et,ref:xt,onMouseDown:Cr(Et.onMouseDown,z0e),"data-disabled":Sr(X),"data-checked":Sr(Me),"data-invalid":Sr(Y)}),getRootProps:(Et,xt=null)=>({htmlFor:U,...Et,ref:xt,"data-disabled":Sr(X),"data-checked":Sr(Me),"data-invalid":Sr(Y)}),htmlProps:P}}function z0e(t){t.preventDefault(),t.stopPropagation()}const T7=Tt((t,e)=>{const r=k7(),{onChange:n,value:i}=t,s=ls("Radio",{...r,...t}),a=Rn(t),{spacing:o="0.5rem",children:d,isDisabled:m=r==null?void 0:r.isDisabled,isFocusable:y=r==null?void 0:r.isFocusable,inputProps:v,...w}=a;let O=t.isChecked;(r==null?void 0:r.value)!=null&&i!=null&&(O=r.value===i);let P=n;r!=null&&r.onChange&&i!=null&&(P=Hz(r.onChange,n));const E=(t==null?void 0:t.name)??(r==null?void 0:r.name),{getInputProps:$,getRadioProps:R,getLabelProps:F,getRootProps:D,htmlProps:U}=E0e({...w,isChecked:O,isFocusable:y,isDisabled:m,onChange:P,name:E}),[X,ee]=F8(U,X8),K=R(ee),Y=$(v,e),ne=F(),oe=Object.assign({},X,D()),ce={display:"inline-flex",alignItems:"center",verticalAlign:"top",cursor:"pointer",position:"relative",...s.container},Xe={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,...s.control},Ae={userSelect:"none",marginStart:o,...s.label};return u.jsxs(mt.label,{className:"chakra-radio",...oe,__css:ce,children:[u.jsx("input",{className:"chakra-radio__input",...Y}),u.jsx(mt.span,{className:"chakra-radio__control",...K,__css:Xe}),d&&u.jsx(mt.span,{className:"chakra-radio__label",...ne,__css:Ae,children:d})]})});T7.displayName="Radio";const O7=Tt(function(e,r){const{children:n,placeholder:i,className:s,...a}=e;return u.jsxs(mt.select,{...a,ref:r,className:lr("chakra-select",s),children:[i&&u.jsx("option",{value:"",children:i}),n]})});O7.displayName="SelectField";const zn=Tt((t,e)=>{var D;const r=ls("Select",t),{rootProps:n,placeholder:i,icon:s,color:a,height:o,h:d,minH:m,minHeight:y,iconColor:v,iconSize:w,...O}=Rn(t),[P,E]=F8(O,X8),$=K5(E),R={width:"100%",height:"fit-content",position:"relative",color:a},F={paddingEnd:"2rem",...r.field,_focus:{zIndex:"unset",...(D=r.field)==null?void 0:D._focus}};return u.jsxs(mt.div,{className:"chakra-select__wrapper",__css:R,...P,...n,children:[u.jsx(O7,{ref:e,height:d??o,minH:m??y,placeholder:i,...$,__css:F,children:t.children}),u.jsx(j7,{"data-disabled":Sr($.disabled),...(v||a)&&{color:v||a},__css:r.icon,...w&&{fontSize:w},children:s})]})});zn.displayName="Select";const M0e=t=>u.jsx("svg",{viewBox:"0 0 24 24",...t,children:u.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),I0e=mt("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),j7=t=>{const{children:e=u.jsx(M0e,{}),...r}=t,n=I.cloneElement(e,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return u.jsx(I0e,{...r,className:"chakra-select__icon-wrapper",children:I.isValidElement(e)?n:null})};j7.displayName="SelectIcon";function ej(t){const{orientation:e,vertical:r,horizontal:n}=t;return e==="vertical"?r:n}function R0e(t){const{orientation:e,thumbPercents:r,isReversed:n}=t,i=O=>({position:"absolute",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",touchAction:"none",...ej({orientation:e,vertical:{bottom:`${r[O]}%`,transform:"translate(-50%, 50%) scale(var(--slider-thumb-scale, 1))"},horizontal:{left:`${r[O]}%`,transform:"translate(-50%, -50%) scale(var(--slider-thumb-scale, 1))"}})}),s={position:"relative",touchAction:"none",WebkitTapHighlightColor:"rgba(0,0,0,0)",userSelect:"none",outline:0},a={position:"absolute",...ej({orientation:e,vertical:{left:"50%",transform:"translateX(-50%)",height:"100%"},horizontal:{top:"50%",transform:"translateY(-50%)",width:"100%"}})},o=r.length===1,d=[0,n?100-r[0]:r[0]],m=o?d:r;let y=m[0];!o&&n&&(y=100-y);const v=Math.abs(m[m.length-1]-m[0]),w={...a,...ej({orientation:e,vertical:n?{height:`${v}%`,top:`${y}%`}:{height:`${v}%`,bottom:`${y}%`},horizontal:n?{width:`${v}%`,right:`${y}%`}:{width:`${v}%`,left:`${y}%`}})};return{trackStyle:a,innerTrackStyle:w,rootStyle:s,getThumbStyle:i}}function D0e(t){const{isReversed:e,direction:r,orientation:n}=t;return r==="ltr"||n==="vertical"?e:!e}function L0e(t){const{min:e=0,max:r=100,onChange:n,value:i,defaultValue:s,isReversed:a,direction:o="ltr",orientation:d="horizontal",id:m,isDisabled:y,isReadOnly:v,onChangeStart:w,onChangeEnd:O,step:P=1,getAriaValueText:E,"aria-valuetext":$,"aria-label":R,"aria-labelledby":F,name:D,focusThumbOnChange:U=!0,...X}=t,ee=Vi(w),K=Vi(O),Y=Vi(E),ne=D0e({isReversed:a,direction:o,orientation:d}),[oe,ce]=Kz({value:i,defaultValue:s??B0e(e,r),onChange:n}),[Xe,Ae]=I.useState(!1),[We,Ye]=I.useState(!1),tt=!(y||v),Be=(r-e)/10,Me=P||(r-e)/100,Ge=oS(oe,e,r),De=r-Ge+e,Oe=_3(ne?De:Ge,e,r),Ie=d==="vertical",st=$8({min:e,max:r,step:P,isDisabled:y,value:Ge,isInteractive:tt,isReversed:ne,isVertical:Ie,eventSource:null,focusThumbOnChange:U,orientation:d}),Re=I.useRef(null),it=I.useRef(null),Ke=I.useRef(null),St=I.useId(),Mt=m??St,[Et,xt]=[`slider-thumb-${Mt}`,`slider-track-${Mt}`],et=I.useCallback(Ct=>{var Di;if(!Re.current)return;const Ut=st.current;Ut.eventSource="pointer";const wn=Re.current.getBoundingClientRect(),{clientX:vt,clientY:vr}=((Di=Ct.touches)==null?void 0:Di[0])??Ct,tr=Ie?wn.bottom-vr:vt-wn.left,Zn=Ie?wn.height:wn.width;let _i=tr/Zn;ne&&(_i=1-_i);let pr=MY(_i,Ut.min,Ut.max);return Ut.step&&(pr=parseFloat(w3(pr,Ut.min,Ut.step))),pr=oS(pr,Ut.min,Ut.max),pr},[Ie,ne,st]),Yt=I.useCallback(Ct=>{const Ut=st.current;Ut.isInteractive&&(Ct=parseFloat(w3(Ct,Ut.min,Me)),Ct=oS(Ct,Ut.min,Ut.max),ce(Ct))},[Me,ce,st]),_t=I.useMemo(()=>({stepUp(Ct=Me){const Ut=ne?Ge-Ct:Ge+Ct;Yt(Ut)},stepDown(Ct=Me){const Ut=ne?Ge+Ct:Ge-Ct;Yt(Ut)},reset(){Yt(s||0)},stepTo(Ct){Yt(Ct)}}),[Yt,ne,Ge,Me,s]),rt=I.useCallback(Ct=>{const Ut=st.current,vt={ArrowRight:()=>_t.stepUp(),ArrowUp:()=>_t.stepUp(),ArrowLeft:()=>_t.stepDown(),ArrowDown:()=>_t.stepDown(),PageUp:()=>_t.stepUp(Be),PageDown:()=>_t.stepDown(Be),Home:()=>Yt(Ut.min),End:()=>Yt(Ut.max)}[Ct.key];vt&&(Ct.preventDefault(),Ct.stopPropagation(),vt(Ct),Ut.eventSource="keyboard")},[_t,Yt,Be,st]),Te=(Y==null?void 0:Y(Ge))??$,{getThumbStyle:ct,rootStyle:Vt,trackStyle:wt,innerTrackStyle:Ft}=I.useMemo(()=>{const Ct=st.current;return R0e({isReversed:ne,orientation:Ct.orientation,thumbPercents:[Oe]})},[ne,Oe,st]),Kr=I.useCallback(()=>{st.current.focusThumbOnChange&&setTimeout(()=>{var Ut;return(Ut=it.current)==null?void 0:Ut.focus()})},[st]);ef(()=>{const Ct=st.current;Kr(),Ct.eventSource==="keyboard"&&(K==null||K(Ct.value))},[Ge,K]);function yn(Ct){const Ut=et(Ct);Ut!=null&&Ut!==st.current.value&&ce(Ut)}uJ(Ke,{onPanSessionStart(Ct){const Ut=st.current;Ut.isInteractive&&(Ae(!0),Kr(),yn(Ct),ee==null||ee(Ut.value))},onPanSessionEnd(){const Ct=st.current;Ct.isInteractive&&(Ae(!1),K==null||K(Ct.value))},onPan(Ct){st.current.isInteractive&&yn(Ct)}});const an=I.useCallback((Ct={},Ut=null)=>({...Ct,...X,ref:bi(Ut,Ke),tabIndex:-1,"aria-disabled":Fl(y),"data-focused":Sr(We),style:{...Ct.style,...Vt}}),[X,y,We,Vt]),Cn=I.useCallback((Ct={},Ut=null)=>({...Ct,ref:bi(Ut,Re),id:xt,"data-disabled":Sr(y),style:{...Ct.style,...wt}}),[y,xt,wt]),xn=I.useCallback((Ct={},Ut=null)=>({...Ct,ref:Ut,style:{...Ct.style,...Ft}}),[Ft]),di=I.useCallback((Ct={},Ut=null)=>({...Ct,ref:bi(Ut,it),role:"slider",tabIndex:tt?0:void 0,id:Et,"data-active":Sr(Xe),"aria-valuetext":Te,"aria-valuemin":e,"aria-valuemax":r,"aria-valuenow":Ge,"aria-orientation":d,"aria-disabled":Fl(y),"aria-readonly":Fl(v),"aria-label":R,"aria-labelledby":R?void 0:F,style:{...Ct.style,...ct(0)},onKeyDown:Cr(Ct.onKeyDown,rt),onFocus:Cr(Ct.onFocus,()=>Ye(!0)),onBlur:Cr(Ct.onBlur,()=>Ye(!1))}),[tt,Et,Xe,Te,e,r,Ge,d,y,v,R,F,ct,rt]),Pi=I.useCallback((Ct,Ut=null)=>{const wn=!(Ct.value<e||Ct.value>r),vt=Ge>=Ct.value,vr=_3(Ct.value,e,r),tr={position:"absolute",pointerEvents:"none",...F0e({orientation:d,vertical:{bottom:ne?`${100-vr}%`:`${vr}%`},horizontal:{left:ne?`${100-vr}%`:`${vr}%`}})};return{...Ct,ref:Ut,role:"presentation","aria-hidden":!0,"data-disabled":Sr(y),"data-invalid":Sr(!wn),"data-highlighted":Sr(vt),style:{...Ct.style,...tr}}},[y,ne,r,e,d,Ge]),He=I.useCallback((Ct={},Ut=null)=>({...Ct,ref:Ut,type:"hidden",value:Ge,name:D}),[D,Ge]);return{state:{value:Ge,isFocused:We,isDragging:Xe},actions:_t,getRootProps:an,getTrackProps:Cn,getInnerTrackProps:xn,getThumbProps:di,getMarkerProps:Pi,getInputProps:He}}function F0e(t){const{orientation:e,vertical:r,horizontal:n}=t;return e==="vertical"?r:n}function B0e(t,e){return e<t?t:t+(e-t)/2}const[$0e,nC]=_n({name:"SliderContext",hookName:"useSliderContext",providerName:"<Slider />"}),[N0e,iC]=_n({name:"SliderStylesContext",hookName:"useSliderStyles",providerName:"<Slider />"}),Tl=Tt((t,e)=>{const r={...t,orientation:(t==null?void 0:t.orientation)??"horizontal"},n=ls("Slider",r),i=Rn(r),{direction:s}=b1();i.direction=s;const{getInputProps:a,getRootProps:o,...d}=L0e(i),m=o(),y=a({},e);return u.jsx($0e,{value:d,children:u.jsx(N0e,{value:n,children:u.jsxs(mt.div,{...m,className:lr("chakra-slider",r.className),__css:n.container,children:[r.children,u.jsx("input",{...y})]})})})});Tl.displayName="Slider";const Ol=Tt((t,e)=>{const{getThumbProps:r}=nC(),n=iC(),i=r(t,e);return u.jsx(mt.div,{...i,className:lr("chakra-slider__thumb",t.className),__css:n.thumb})});Ol.displayName="SliderThumb";const jl=Tt((t,e)=>{const{getTrackProps:r}=nC(),n=iC(),i=r(t,e);return u.jsx(mt.div,{...i,className:lr("chakra-slider__track",t.className),__css:n.track})});jl.displayName="SliderTrack";const Pl=Tt((t,e)=>{const{getInnerTrackProps:r}=nC(),n=iC(),i=r(t,e);return u.jsx(mt.div,{...i,className:lr("chakra-slider__filled-track",t.className),__css:n.filledTrack})});Pl.displayName="SliderFilledTrack";const V0e=Tt((t,e)=>{const{getMarkerProps:r}=nC(),n=iC(),i=r(t,e);return u.jsx(mt.div,{...i,className:lr("chakra-slider__marker",t.className),__css:n.mark})});V0e.displayName="SliderMark";const Zo=mt("div",{baseStyle:{flex:1,justifySelf:"stretch",alignSelf:"stretch"}});Zo.displayName="Spacer";const P7=t=>u.jsx(mt.div,{className:"chakra-stack__item",...t,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,...t.__css}});P7.displayName="StackItem";function W0e(t){const{spacing:e,direction:r}=t,n={column:{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":Xz(r,i=>n[i])}}const A1=Tt((t,e)=>{const{isInline:r,direction:n,align:i,justify:s,spacing:a="0.5rem",wrap:o,children:d,divider:m,className:y,shouldWrapChildren:v,...w}=t,O=r?"row":n??"column",P=I.useMemo(()=>W0e({spacing:a,direction:O}),[a,O]),E=!!m,$=!v&&!E,R=I.useMemo(()=>{const D=_k(d);return $?D:D.map((U,X)=>{const ee=typeof U.key<"u"?U.key:X,K=X+1===D.length,ne=v?u.jsx(P7,{children:U},ee):U;if(!E)return ne;const oe=I.cloneElement(m,{__css:P}),ce=K?null:oe;return u.jsxs(I.Fragment,{children:[ne,ce]},ee)})},[m,P,E,$,v,d]),F=lr("chakra-stack",y);return u.jsx(mt.div,{ref:e,display:"flex",alignItems:i,justifyContent:s,flexDirection:O,flexWrap:o,gap:E?void 0:a,className:F,...w,children:R})});A1.displayName="Stack";const fe=Tt((t,e)=>u.jsx(A1,{align:"center",...t,direction:"row",ref:e}));fe.displayName="HStack";const lt=Tt((t,e)=>u.jsx(A1,{align:"center",...t,direction:"column",ref:e}));lt.displayName="VStack";const[U0e,_M]=_n({name:"StatStylesContext",errorMessage:`useStatStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Stat />" `}),ts=Tt(function(e,r){const n=ls("Stat",e),i={position:"relative",flex:"1 1 0%",...n.container},{className:s,children:a,...o}=Rn(e);return u.jsx(U0e,{value:n,children:u.jsx(mt.div,{ref:r,...o,className:lr("chakra-stat",s),__css:i,children:u.jsx("dl",{children:a})})})});ts.displayName="Stat";const Hd=Tt(function(e,r){const n=_M();return u.jsx(mt.dd,{ref:r,...e,className:lr("chakra-stat__help-text",e.className),__css:n.helpText})});Hd.displayName="StatHelpText";const rs=Tt(function(e,r){const n=_M();return u.jsx(mt.dt,{ref:r,...e,className:lr("chakra-stat__label",e.className),__css:n.label})});rs.displayName="StatLabel";const ns=Tt(function(e,r){const n=_M();return u.jsx(mt.dd,{ref:r,...e,className:lr("chakra-stat__number",e.className),__css:{...n.number,fontFeatureSettings:"pnum",fontVariantNumeric:"proportional-nums"}})});ns.displayName="StatNumber";const fa=Tt(function(e,r){const n=ls("Switch",e),{spacing:i="0.5rem",children:s,...a}=Rn(e),{getIndicatorProps:o,getInputProps:d,getCheckboxProps:m,getRootProps:y,getLabelProps:v}=fW(a),w=I.useMemo(()=>({display:"inline-block",position:"relative",verticalAlign:"middle",lineHeight:0,...n.container}),[n.container]),O=I.useMemo(()=>({display:"inline-flex",flexShrink:0,justifyContent:"flex-start",boxSizing:"content-box",cursor:"pointer",...n.track}),[n.track]),P=I.useMemo(()=>({userSelect:"none",marginStart:i,...n.label}),[i,n.label]);return u.jsxs(mt.label,{...y(),className:lr("chakra-switch",e.className),__css:w,children:[u.jsx("input",{className:"chakra-switch__input",...d({},r)}),u.jsx(mt.span,{...m(),className:"chakra-switch__track",__css:O,children:u.jsx(mt.span,{__css:n.thumb,className:"chakra-switch__thumb",...o()})}),s&&u.jsx(mt.span,{className:"chakra-switch__label",...v(),__css:P,children:s})]})});fa.displayName="Switch";const[q0e,E1]=_n({name:"TableStylesContext",errorMessage:`useTableStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Table />" `}),sC=Tt((t,e)=>{const r=ls("Table",t),{className:n,layout:i,...s}=Rn(t);return u.jsx(q0e,{value:r,children:u.jsx(mt.table,{ref:e,__css:{tableLayout:i,...r.table},className:lr("chakra-table",n),...s})})});sC.displayName="Table";const wM=Tt((t,e)=>{const r=E1();return u.jsx(mt.tbody,{...t,ref:e,__css:r.tbody})}),Rd=Tt(({isNumeric:t,...e},r)=>{const n=E1();return u.jsx(mt.td,{...e,ref:r,__css:n.td,"data-is-numeric":t})}),Dd=Tt(({isNumeric:t,...e},r)=>{const n=E1();return u.jsx(mt.th,{...e,ref:r,__css:n.th,"data-is-numeric":t})}),SM=Tt((t,e)=>{const r=E1();return u.jsx(mt.thead,{...t,ref:e,__css:r.thead})}),r0=Tt((t,e)=>{const r=E1();return u.jsx(mt.tr,{...t,ref:e,__css:r.tr})}),[Q0e,H0e,G0e,X0e]=N5();function K0e(t){const{defaultIndex:e,onChange:r,index:n,isManual:i,isLazy:s,lazyBehavior:a="unmount",orientation:o="horizontal",direction:d="ltr",...m}=t,[y,v]=I.useState(e??0),[w,O]=Kz({defaultValue:e??0,value:n,onChange:r});I.useEffect(()=>{n!=null&&v(n)},[n]);const P=G0e(),E=I.useId();return{id:`tabs-${t.id??E}`,selectedIndex:w,focusedIndex:y,setSelectedIndex:O,setFocusedIndex:v,isManual:i,isLazy:s,lazyBehavior:a,orientation:o,descendants:P,direction:d,htmlProps:m}}const[Z0e,oC]=_n({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function Y0e(t){const{focusedIndex:e,orientation:r,direction:n}=oC(),i=H0e(),s=I.useCallback(a=>{const o=()=>{var D;const F=i.nextEnabled(e);F&&((D=F.node)==null||D.focus())},d=()=>{var D;const F=i.prevEnabled(e);F&&((D=F.node)==null||D.focus())},m=()=>{var D;const F=i.firstEnabled();F&&((D=F.node)==null||D.focus())},y=()=>{var D;const F=i.lastEnabled();F&&((D=F.node)==null||D.focus())},v=r==="horizontal",w=r==="vertical",O=a.key,P=n==="ltr"?"ArrowLeft":"ArrowRight",E=n==="ltr"?"ArrowRight":"ArrowLeft",R={[P]:()=>v&&d(),[E]:()=>v&&o(),ArrowDown:()=>w&&o(),ArrowUp:()=>w&&d(),Home:m,End:y}[O];R&&(a.preventDefault(),R(a))},[i,e,r,n]);return{...t,role:"tablist","aria-orientation":r,onKeyDown:Cr(t.onKeyDown,s)}}function J0e(t){const{isDisabled:e=!1,isFocusable:r=!1,...n}=t,{setSelectedIndex:i,isManual:s,id:a,setFocusedIndex:o,selectedIndex:d}=oC(),{index:m,register:y}=X0e({disabled:e&&!r}),v=m===d,w=()=>{i(m)},O=()=>{o(m),!s&&!(e&&r)&&i(m)};return{...l7({...n,ref:bi(y,t.ref),isDisabled:e,isFocusable:r,onClick:Cr(t.onClick,w)}),id:A7(a,m),role:"tab",tabIndex:v?0:-1,type:"button","aria-selected":v,"aria-controls":E7(a,m),onFocus:e?void 0:Cr(t.onFocus,O)}}const[exe,txe]=_n({});function rxe(t){const e=oC(),{id:r,selectedIndex:n}=e,s=_k(t.children).map((a,o)=>I.createElement(exe,{key:a.key??o,value:{isSelected:o===n,id:E7(r,o),tabId:A7(r,o),selectedIndex:n}},a));return{...t,children:s}}function nxe(t){const{children:e,...r}=t,{isLazy:n,lazyBehavior:i}=oC(),{isSelected:s,id:a,tabId:o}=txe(),d=I.useRef(!1);s&&(d.current=!0);const m=R8({wasSelected:d.current,isSelected:s,enabled:n,mode:i});return{tabIndex:0,...r,children:m?e:null,role:"tabpanel","aria-labelledby":o,hidden:!s,id:a}}function A7(t,e){return`${t}--tab-${e}`}function E7(t,e){return`${t}--tabpanel-${e}`}const[ixe,aC]=_n({name:"TabsStylesContext",errorMessage:`useTabsStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tabs />" `}),w0=Tt(function(e,r){const n=ls("Tabs",e),{children:i,className:s,...a}=Rn(e),{htmlProps:o,descendants:d,...m}=K0e(a),y=I.useMemo(()=>m,[m]),{isFitted:v,...w}=o,O={position:"relative",...n.root};return u.jsx(Q0e,{value:d,children:u.jsx(Z0e,{value:y,children:u.jsx(ixe,{value:n,children:u.jsx(mt.div,{className:lr("chakra-tabs",s),ref:r,...w,__css:O,children:i})})})})});w0.displayName="Tabs";const to=Tt(function(e,r){const n=aC(),i=J0e({...e,ref:r}),s={outline:"0",display:"flex",alignItems:"center",justifyContent:"center",...n.tab};return u.jsx(mt.button,{...i,className:lr("chakra-tabs__tab",e.className),__css:s})});to.displayName="Tab";const S0=Tt(function(e,r){const n=Y0e({...e,ref:r}),i=aC(),s={display:"flex",...i.tablist};return u.jsx(mt.div,{...n,className:lr("chakra-tabs__tablist",e.className),__css:s})});S0.displayName="TabList";const _a=Tt(function(e,r){const n=nxe({...e,ref:r}),i=aC();return u.jsx(mt.div,{outline:"0",...n,className:lr("chakra-tabs__tab-panel",e.className),__css:i.tabpanel})});_a.displayName="TabPanel";const z1=Tt(function(e,r){const n=rxe(e),i=aC();return u.jsx(mt.div,{...n,width:"100%",ref:r,className:lr("chakra-tabs__tab-panels",e.className),__css:i.tabpanels})});z1.displayName="TabPanels";const[sxe,z7]=_n({name:"TagStylesContext",errorMessage:`useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tag />" `}),cm=Tt((t,e)=>{const r=ls("Tag",t),n=Rn(t),i={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...r.container};return u.jsx(sxe,{value:r,children:u.jsx(mt.span,{ref:e,...n,__css:i})})});cm.displayName="Tag";const zb=Tt((t,e)=>{const r=z7();return u.jsx(mt.span,{ref:e,noOfLines:1,...t,__css:r.label})});zb.displayName="TagLabel";const oxe=Tt((t,e)=>u.jsx(ze,{ref:e,verticalAlign:"top",marginEnd:"0.5rem",...t}));oxe.displayName="TagLeftIcon";const axe=Tt((t,e)=>u.jsx(ze,{ref:e,verticalAlign:"top",marginStart:"0.5rem",...t}));axe.displayName="TagRightIcon";const M7=t=>u.jsx(ze,{verticalAlign:"inherit",viewBox:"0 0 512 512",...t,children:u.jsx("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});M7.displayName="TagCloseIcon";const I7=Tt((t,e)=>{const{isDisabled:r,children:n,...i}=t,a={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",...z7().closeButton};return u.jsx(mt.button,{ref:e,"aria-label":"close",...i,type:"button",disabled:r,__css:a,children:n||u.jsx(M7,{})})});I7.displayName="TagCloseButton";const lxe=["h","minH","height","minHeight"],lC=Tt((t,e)=>{const r=ll("Textarea",t),{className:n,rows:i,...s}=Rn(t),a=K5(s),o=i?Sk(r,lxe):r;return u.jsx(mt.textarea,{ref:e,rows:i,...a,className:lr("chakra-textarea",n),__css:o})});lC.displayName="Textarea";function cxe(t,e){const r=t??"bottom",i={"top-start":{ltr:"top-left",rtl:"top-right"},"top-end":{ltr:"top-right",rtl:"top-left"},"bottom-start":{ltr:"bottom-left",rtl:"bottom-right"},"bottom-end":{ltr:"bottom-right",rtl:"bottom-left"}}[r];return(i==null?void 0:i[e])??r}function uxe(t,e){const r=i=>({...e,...i,position:cxe((i==null?void 0:i.position)??(e==null?void 0:e.position),t)}),n=i=>{const s=r(i),a=lW(s);return nu.notify(a,s)};return n.update=(i,s)=>{nu.update(i,r(s))},n.promise=(i,s)=>{const a=n({...s.loading,status:"loading",duration:null});i.then(o=>n.update(a,{status:"success",duration:5e3,...Ka(s.success,o)})).catch(o=>n.update(a,{status:"error",duration:5e3,...Ka(s.error,o)}))},n.closeAll=nu.closeAll,n.close=nu.close,n.isActive=nu.isActive,n}function Yo(t){const{theme:e}=sW(),r=Kde();return I.useMemo(()=>uxe(e.direction,{...r,...t}),[t,e.direction,r])}const hxe={exit:{scale:.85,opacity:0,transition:{opacity:{duration:.15,easings:"easeInOut"},scale:{duration:.2,easings:"easeInOut"}}},enter:{scale:1,opacity:1,transition:{opacity:{easings:"easeOut",duration:.2},scale:{duration:.2,ease:[.175,.885,.4,1.1]}}}},zA=t=>{var e;return((e=t.current)==null?void 0:e.ownerDocument)||document},CS=t=>{var e,r;return((r=(e=t.current)==null?void 0:e.ownerDocument)==null?void 0:r.defaultView)||window};function dxe(t={}){const{openDelay:e=0,closeDelay:r=0,closeOnClick:n=!0,closeOnMouseDown:i,closeOnScroll:s,closeOnPointerDown:a=i,closeOnEsc:o=!0,onOpen:d,onClose:m,placement:y,id:v,isOpen:w,defaultIsOpen:O,arrowSize:P=10,arrowShadowColor:E,arrowPadding:$,modifiers:R,isDisabled:F,gutter:D,offset:U,direction:X,...ee}=t,{isOpen:K,onOpen:Y,onClose:ne}=rm({isOpen:w,defaultIsOpen:O,onOpen:d,onClose:m}),{referenceRef:oe,getPopperProps:ce,getArrowInnerProps:Xe,getArrowProps:Ae}=a7({enabled:K,placement:y,arrowPadding:$,modifiers:R,gutter:D,offset:U,direction:X}),We=I.useId(),tt=`tooltip-${v??We}`,Be=I.useRef(null),Me=I.useRef(void 0),Ge=I.useCallback(()=>{Me.current&&(clearTimeout(Me.current),Me.current=void 0)},[]),De=I.useRef(void 0),Le=I.useCallback(()=>{De.current&&(clearTimeout(De.current),De.current=void 0)},[]),Oe=I.useCallback(()=>{Le(),ne()},[ne,Le]),Ie=fxe(Be,Oe),st=I.useCallback(()=>{if(!F&&!Me.current){K&&Ie();const et=CS(Be);Me.current=et.setTimeout(Y,e)}},[Ie,F,K,Y,e]),Re=I.useCallback(()=>{Ge();const et=CS(Be);De.current=et.setTimeout(Oe,r)},[r,Oe,Ge]),it=I.useCallback(()=>{K&&n&&Re()},[n,Re,K]),Ke=I.useCallback(()=>{K&&a&&Re()},[a,Re,K]),St=I.useCallback(et=>{K&&et.key==="Escape"&&Re()},[K,Re]);Pv(()=>zA(Be),"keydown",o?St:void 0),Pv(()=>{if(!s)return null;const et=Be.current;if(!et)return null;const Yt=L8(et);return Yt.localName==="body"?CS(Be):Yt},"scroll",()=>{K&&s&&Oe()},{passive:!0,capture:!0}),I.useEffect(()=>{F&&(Ge(),K&&ne())},[F,K,ne,Ge]),I.useEffect(()=>()=>{Ge(),Le()},[Ge,Le]),Pv(()=>Be.current,"pointerleave",Re);const Mt=I.useCallback((et={},Yt=null)=>({...et,ref:bi(Be,Yt,oe),onPointerEnter:Cr(et.onPointerEnter,rt=>{rt.pointerType!=="touch"&&st()}),onClick:Cr(et.onClick,it),onPointerDown:Cr(et.onPointerDown,Ke),onFocus:Cr(et.onFocus,st),onBlur:Cr(et.onBlur,Re),"aria-describedby":K?tt:void 0}),[st,Re,Ke,K,tt,it,oe]),Et=I.useCallback((et={},Yt=null)=>ce({...et,style:{...et.style,[Ys.arrowSize.var]:P?`${P}px`:void 0,[Ys.arrowShadowColor.var]:E}},Yt),[ce,P,E]),xt=I.useCallback((et={},Yt=null)=>{const _t={...et.style,position:"relative",transformOrigin:Ys.transformOrigin.varRef};return{ref:Yt,...ee,...et,id:tt,role:"tooltip",style:_t}},[ee,tt]);return{isOpen:K,show:st,hide:Re,getTriggerProps:Mt,getTooltipProps:xt,getTooltipPositionerProps:Et,getArrowProps:Ae,getArrowInnerProps:Xe}}const tj="chakra-ui:close-tooltip";function fxe(t,e){return I.useEffect(()=>{const r=zA(t);return r.addEventListener(tj,e),()=>r.removeEventListener(tj,e)},[e,t]),()=>{const r=zA(t),n=CS(t);r.dispatchEvent(new n.CustomEvent(tj))}}const pxe=mt(Ln.div),wr=Tt((t,e)=>{const r=ll("Tooltip",t),n=Rn(t),i=b1(),{children:s,label:a,shouldWrapChildren:o,"aria-label":d,hasArrow:m,bg:y,portalProps:v,background:w,backgroundColor:O,bgColor:P,motionProps:E,animatePresenceProps:$,...R}=n,F=w??O??y??P;if(F){r.bg=F;const oe=JJ(i,"colors",F);r[Ys.arrowBg.var]=oe}const D=dxe({...R,direction:i.direction}),U=!I.isValidElement(s)||o;let X;if(U)X=u.jsx(mt.span,{display:"inline-block",tabIndex:0,...D.getTriggerProps(),children:s});else{const oe=I.Children.only(s);X=I.cloneElement(oe,D.getTriggerProps(oe.props,b0e(oe)))}const ee=!!d,K=D.getTooltipProps({},e),Y=ee?Sk(K,["role","id"]):K,ne=D8(K,["role","id"]);return a?u.jsxs(u.Fragment,{children:[X,u.jsx(vc,{...$,children:D.isOpen&&u.jsx(b0,{...v,children:u.jsx(mt.div,{...D.getTooltipPositionerProps(),__css:{zIndex:r.zIndex,pointerEvents:"none"},children:u.jsxs(pxe,{variants:hxe,initial:"exit",animate:"enter",exit:"exit",...E,...Y,__css:r,children:[a,ee&&u.jsx(mt.span,{srOnly:!0,...ne,children:d}),m&&u.jsx(mt.div,{"data-popper-arrow":!0,className:"chakra-tooltip__arrow-wrapper",children:u.jsx(mt.div,{"data-popper-arrow-inner":!0,className:"chakra-tooltip__arrow",__css:{bg:r.bg}})})]})})})})]}):u.jsx(u.Fragment,{children:s})});wr.displayName="Tooltip";const pn=Tt(function(e,r){const n=ll("Heading",e),{className:i,...s}=Rn(e);return u.jsx(mt.h2,{ref:r,className:lr("chakra-heading",e.className),...s,__css:n})});pn.displayName="Heading";const J=Tt(function(e,r){const n=ll("Text",e),{className:i,align:s,decoration:a,casing:o,...d}=Rn(e),m=wk({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return u.jsx(mt.p,{ref:r,className:lr("chakra-text",e.className),...m,...d,__css:n})});J.displayName="Text";const n0=Tt(function(e,r){const{spacing:n="0.5rem",spacingX:i,spacingY:s,children:a,justify:o,direction:d,align:m,className:y,shouldWrapChildren:v,...w}=e,O=I.useMemo(()=>v?I.Children.map(a,(P,E)=>u.jsx(um,{children:P},E)):a,[a,v]);return u.jsx(mt.div,{ref:r,className:lr("chakra-wrap",y),...w,children:u.jsx(mt.ul,{className:"chakra-wrap__list",__css:{display:"flex",flexWrap:"wrap",justifyContent:o,alignItems:m,flexDirection:d,listStyleType:"none",gap:n,columnGap:i,rowGap:s,padding:"0"},children:O})})});n0.displayName="Wrap";const um=Tt(function(e,r){const{className:n,...i}=e;return u.jsx(mt.li,{ref:r,__css:{display:"flex",alignItems:"flex-start"},className:lr("chakra-wrap__listitem",n),...i})});um.displayName="WrapItem";var k0=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},mxe={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},kd,KE,i$,gxe=(i$=class{constructor(){kr(this,kd,mxe);kr(this,KE,!1)}setTimeoutProvider(t){rr(this,kd,t)}setTimeout(t,e){return Pe(this,kd).setTimeout(t,e)}clearTimeout(t){Pe(this,kd).clearTimeout(t)}setInterval(t,e){return Pe(this,kd).setInterval(t,e)}clearInterval(t){Pe(this,kd).clearInterval(t)}},kd=new WeakMap,KE=new WeakMap,i$),bp=new gxe;function yxe(t){setTimeout(t,0)}var hm=typeof window>"u"||"Deno"in globalThis;function $o(){}function xxe(t,e){return typeof t=="function"?t(e):t}function MA(t){return typeof t=="number"&&t>=0&&t!==1/0}function R7(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Gd(t,e){return typeof t=="function"?t(e):t}function Sl(t,e){return typeof t=="function"?t(e):t}function UL(t,e){const{type:r="all",exact:n,fetchStatus:i,predicate:s,queryKey:a,stale:o}=t;if(a){if(n){if(e.queryHash!==kM(a,e.options))return!1}else if(!Mb(e.queryKey,a))return!1}if(r!=="all"){const d=e.isActive();if(r==="active"&&!d||r==="inactive"&&d)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||i&&i!==e.state.fetchStatus||s&&!s(e))}function qL(t,e){const{exact:r,status:n,predicate:i,mutationKey:s}=t;if(s){if(!e.options.mutationKey)return!1;if(r){if(dm(e.options.mutationKey)!==dm(s))return!1}else if(!Mb(e.options.mutationKey,s))return!1}return!(n&&e.state.status!==n||i&&!i(e))}function kM(t,e){return((e==null?void 0:e.queryKeyHashFn)||dm)(t)}function dm(t){return JSON.stringify(t,(e,r)=>IA(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function Mb(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(r=>Mb(t[r],e[r])):!1}var vxe=Object.prototype.hasOwnProperty;function D7(t,e,r=0){if(t===e)return t;if(r>500)return e;const n=QL(t)&&QL(e);if(!n&&!(IA(t)&&IA(e)))return e;const s=(n?t:Object.keys(t)).length,a=n?e:Object.keys(e),o=a.length,d=n?new Array(o):{};let m=0;for(let y=0;y<o;y++){const v=n?y:a[y],w=t[v],O=e[v];if(w===O){d[v]=w,(n?y<s:vxe.call(t,v))&&m++;continue}if(w===null||O===null||typeof w!="object"||typeof O!="object"){d[v]=O;continue}const P=D7(w,O,r+1);d[v]=P,P===w&&m++}return s===o&&m===s?t:d}function C2(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function QL(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function IA(t){if(!HL(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!HL(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function HL(t){return Object.prototype.toString.call(t)==="[object Object]"}function bxe(t){return new Promise(e=>{bp.setTimeout(e,t)})}function RA(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?D7(t,e):e}function _xe(t,e,r=0){const n=[...t,e];return r&&n.length>r?n.slice(1):n}function wxe(t,e,r=0){const n=[e,...t];return r&&n.length>r?n.slice(0,-1):n}var CM=Symbol();function L7(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===CM?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function TM(t,e){return typeof t=="function"?t(...e):!!t}function Sxe(t,e,r){let n=!1,i;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(i??(i=e()),n||(n=!0,i.aborted?r():i.addEventListener("abort",r,{once:!0})),i)}),t}var kp,Cd,Cy,s$,kxe=(s$=class extends k0{constructor(){super();kr(this,kp);kr(this,Cd);kr(this,Cy);rr(this,Cy,e=>{if(!hm&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){Pe(this,Cd)||this.setEventListener(Pe(this,Cy))}onUnsubscribe(){var e;this.hasListeners()||((e=Pe(this,Cd))==null||e.call(this),rr(this,Cd,void 0))}setEventListener(e){var r;rr(this,Cy,e),(r=Pe(this,Cd))==null||r.call(this),rr(this,Cd,e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(e){Pe(this,kp)!==e&&(rr(this,kp,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){var e;return typeof Pe(this,kp)=="boolean"?Pe(this,kp):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},kp=new WeakMap,Cd=new WeakMap,Cy=new WeakMap,s$),OM=new kxe;function DA(){let t,e;const r=new Promise((i,s)=>{t=i,e=s});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),t(i)},r.reject=i=>{n({status:"rejected",reason:i}),e(i)},r}var Cxe=yxe;function Txe(){let t=[],e=0,r=o=>{o()},n=o=>{o()},i=Cxe;const s=o=>{e?t.push(o):i(()=>{r(o)})},a=()=>{const o=t;t=[],o.length&&i(()=>{n(()=>{o.forEach(d=>{r(d)})})})};return{batch:o=>{let d;e++;try{d=o()}finally{e--,e||a()}return d},batchCalls:o=>(...d)=>{s(()=>{o(...d)})},schedule:s,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{i=o}}}var gs=Txe(),Ty,Td,Oy,o$,Oxe=(o$=class extends k0{constructor(){super();kr(this,Ty,!0);kr(this,Td);kr(this,Oy);rr(this,Oy,e=>{if(!hm&&window.addEventListener){const r=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){Pe(this,Td)||this.setEventListener(Pe(this,Oy))}onUnsubscribe(){var e;this.hasListeners()||((e=Pe(this,Td))==null||e.call(this),rr(this,Td,void 0))}setEventListener(e){var r;rr(this,Oy,e),(r=Pe(this,Td))==null||r.call(this),rr(this,Td,e(this.setOnline.bind(this)))}setOnline(e){Pe(this,Ty)!==e&&(rr(this,Ty,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return Pe(this,Ty)}},Ty=new WeakMap,Td=new WeakMap,Oy=new WeakMap,o$),T2=new Oxe;function jxe(t){return Math.min(1e3*2**t,3e4)}function F7(t){return(t??"online")==="online"?T2.isOnline():!0}var LA=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function B7(t){let e=!1,r=0,n;const i=DA(),s=()=>i.status!=="pending",a=E=>{var $;if(!s()){const R=new LA(E);w(R),($=t.onCancel)==null||$.call(t,R)}},o=()=>{e=!0},d=()=>{e=!1},m=()=>OM.isFocused()&&(t.networkMode==="always"||T2.isOnline())&&t.canRun(),y=()=>F7(t.networkMode)&&t.canRun(),v=E=>{s()||(n==null||n(),i.resolve(E))},w=E=>{s()||(n==null||n(),i.reject(E))},O=()=>new Promise(E=>{var $;n=R=>{(s()||m())&&E(R)},($=t.onPause)==null||$.call(t)}).then(()=>{var E;n=void 0,s()||(E=t.onContinue)==null||E.call(t)}),P=()=>{if(s())return;let E;const $=r===0?t.initialPromise:void 0;try{E=$??t.fn()}catch(R){E=Promise.reject(R)}Promise.resolve(E).then(v).catch(R=>{var ee;if(s())return;const F=t.retry??(hm?0:3),D=t.retryDelay??jxe,U=typeof D=="function"?D(r,R):D,X=F===!0||typeof F=="number"&&r<F||typeof F=="function"&&F(r,R);if(e||!X){w(R);return}r++,(ee=t.onFail)==null||ee.call(t,r,R),bxe(U).then(()=>m()?void 0:O()).then(()=>{e?w(R):P()})})};return{promise:i,status:()=>i.status,cancel:a,continue:()=>(n==null||n(),i),cancelRetry:o,continueRetry:d,canStart:y,start:()=>(y()?P():O().then(P),i)}}var Cp,a$,$7=(a$=class{constructor(){kr(this,Cp)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),MA(this.gcTime)&&rr(this,Cp,bp.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(hm?1/0:5*60*1e3))}clearGcTimeout(){Pe(this,Cp)&&(bp.clearTimeout(Pe(this,Cp)),rr(this,Cp,void 0))}},Cp=new WeakMap,a$),Tp,jy,_l,Op,Ls,e1,jp,ac,Qu,l$,Pxe=(l$=class extends $7{constructor(e){super();kr(this,ac);kr(this,Tp);kr(this,jy);kr(this,_l);kr(this,Op);kr(this,Ls);kr(this,e1);kr(this,jp);rr(this,jp,!1),rr(this,e1,e.defaultOptions),this.setOptions(e.options),this.observers=[],rr(this,Op,e.client),rr(this,_l,Pe(this,Op).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,rr(this,Tp,XL(this.options)),this.state=e.state??Pe(this,Tp),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=Pe(this,Ls))==null?void 0:e.promise}setOptions(e){if(this.options={...Pe(this,e1),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=XL(this.options);r.data!==void 0&&(this.setState(GL(r.data,r.dataUpdatedAt)),rr(this,Tp,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Pe(this,_l).remove(this)}setData(e,r){const n=RA(this.state.data,e,this.options);return Jr(this,ac,Qu).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(e,r){Jr(this,ac,Qu).call(this,{type:"setState",state:e,setStateOptions:r})}cancel(e){var n,i;const r=(n=Pe(this,Ls))==null?void 0:n.promise;return(i=Pe(this,Ls))==null||i.cancel(e),r?r.then($o).catch($o):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Pe(this,Tp))}isActive(){return this.observers.some(e=>Sl(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===CM||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Gd(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!R7(this.state.dataUpdatedAt,e)}onFocus(){var r;const e=this.observers.find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(r=Pe(this,Ls))==null||r.continue()}onOnline(){var r;const e=this.observers.find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(r=Pe(this,Ls))==null||r.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),Pe(this,_l).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(Pe(this,Ls)&&(Pe(this,jp)?Pe(this,Ls).cancel({revert:!0}):Pe(this,Ls).cancelRetry()),this.scheduleGc()),Pe(this,_l).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Jr(this,ac,Qu).call(this,{type:"invalidate"})}async fetch(e,r){var d,m,y,v,w,O,P,E,$,R,F,D;if(this.state.fetchStatus!=="idle"&&((d=Pe(this,Ls))==null?void 0:d.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Pe(this,Ls))return Pe(this,Ls).continueRetry(),Pe(this,Ls).promise}if(e&&this.setOptions(e),!this.options.queryFn){const U=this.observers.find(X=>X.options.queryFn);U&&this.setOptions(U.options)}const n=new AbortController,i=U=>{Object.defineProperty(U,"signal",{enumerable:!0,get:()=>(rr(this,jp,!0),n.signal)})},s=()=>{const U=L7(this.options,r),ee=(()=>{const K={client:Pe(this,Op),queryKey:this.queryKey,meta:this.meta};return i(K),K})();return rr(this,jp,!1),this.options.persister?this.options.persister(U,ee,this):U(ee)},o=(()=>{const U={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Pe(this,Op),state:this.state,fetchFn:s};return i(U),U})();(m=this.options.behavior)==null||m.onFetch(o,this),rr(this,jy,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((y=o.fetchOptions)==null?void 0:y.meta))&&Jr(this,ac,Qu).call(this,{type:"fetch",meta:(v=o.fetchOptions)==null?void 0:v.meta}),rr(this,Ls,B7({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:U=>{U instanceof LA&&U.revert&&this.setState({...Pe(this,jy),fetchStatus:"idle"}),n.abort()},onFail:(U,X)=>{Jr(this,ac,Qu).call(this,{type:"failed",failureCount:U,error:X})},onPause:()=>{Jr(this,ac,Qu).call(this,{type:"pause"})},onContinue:()=>{Jr(this,ac,Qu).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const U=await Pe(this,Ls).start();if(U===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(U),(O=(w=Pe(this,_l).config).onSuccess)==null||O.call(w,U,this),(E=(P=Pe(this,_l).config).onSettled)==null||E.call(P,U,this.state.error,this),U}catch(U){if(U instanceof LA){if(U.silent)return Pe(this,Ls).promise;if(U.revert){if(this.state.data===void 0)throw U;return this.state.data}}throw Jr(this,ac,Qu).call(this,{type:"error",error:U}),(R=($=Pe(this,_l).config).onError)==null||R.call($,U,this),(D=(F=Pe(this,_l).config).onSettled)==null||D.call(F,this.state.data,U,this),U}finally{this.scheduleGc()}}},Tp=new WeakMap,jy=new WeakMap,_l=new WeakMap,Op=new WeakMap,Ls=new WeakMap,e1=new WeakMap,jp=new WeakMap,ac=new WeakSet,Qu=function(e){const r=n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...N7(n.data,this.options),fetchMeta:e.meta??null};case"success":const i={...n,...GL(e.data,e.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return rr(this,jy,e.manual?i:void 0),i;case"error":const s=e.error;return{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=r(this.state),gs.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),Pe(this,_l).notify({query:this,type:"updated",action:e})})},l$);function N7(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:F7(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function GL(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function XL(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,n=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var ua,hn,t1,Lo,Pp,Py,Ku,Od,r1,Ay,Ey,Ap,Ep,jd,zy,Fn,fv,FA,BA,$A,NA,VA,WA,UA,V7,c$,Axe=(c$=class extends k0{constructor(e,r){super();kr(this,Fn);kr(this,ua);kr(this,hn);kr(this,t1);kr(this,Lo);kr(this,Pp);kr(this,Py);kr(this,Ku);kr(this,Od);kr(this,r1);kr(this,Ay);kr(this,Ey);kr(this,Ap);kr(this,Ep);kr(this,jd);kr(this,zy,new Set);this.options=r,rr(this,ua,e),rr(this,Od,null),rr(this,Ku,DA()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(Pe(this,hn).addObserver(this),KL(Pe(this,hn),this.options)?Jr(this,Fn,fv).call(this):this.updateResult(),Jr(this,Fn,NA).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return qA(Pe(this,hn),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return qA(Pe(this,hn),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Jr(this,Fn,VA).call(this),Jr(this,Fn,WA).call(this),Pe(this,hn).removeObserver(this)}setOptions(e){const r=this.options,n=Pe(this,hn);if(this.options=Pe(this,ua).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Sl(this.options.enabled,Pe(this,hn))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Jr(this,Fn,UA).call(this),Pe(this,hn).setOptions(this.options),r._defaulted&&!C2(this.options,r)&&Pe(this,ua).getQueryCache().notify({type:"observerOptionsUpdated",query:Pe(this,hn),observer:this});const i=this.hasListeners();i&&ZL(Pe(this,hn),n,this.options,r)&&Jr(this,Fn,fv).call(this),this.updateResult(),i&&(Pe(this,hn)!==n||Sl(this.options.enabled,Pe(this,hn))!==Sl(r.enabled,Pe(this,hn))||Gd(this.options.staleTime,Pe(this,hn))!==Gd(r.staleTime,Pe(this,hn)))&&Jr(this,Fn,FA).call(this);const s=Jr(this,Fn,BA).call(this);i&&(Pe(this,hn)!==n||Sl(this.options.enabled,Pe(this,hn))!==Sl(r.enabled,Pe(this,hn))||s!==Pe(this,jd))&&Jr(this,Fn,$A).call(this,s)}getOptimisticResult(e){const r=Pe(this,ua).getQueryCache().build(Pe(this,ua),e),n=this.createResult(r,e);return zxe(this,n)&&(rr(this,Lo,n),rr(this,Py,this.options),rr(this,Pp,Pe(this,hn).state)),n}getCurrentResult(){return Pe(this,Lo)}trackResult(e,r){return new Proxy(e,{get:(n,i)=>(this.trackProp(i),r==null||r(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&Pe(this,Ku).status==="pending"&&Pe(this,Ku).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(e){Pe(this,zy).add(e)}getCurrentQuery(){return Pe(this,hn)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const r=Pe(this,ua).defaultQueryOptions(e),n=Pe(this,ua).getQueryCache().build(Pe(this,ua),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(e){return Jr(this,Fn,fv).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),Pe(this,Lo)))}createResult(e,r){var ne;const n=Pe(this,hn),i=this.options,s=Pe(this,Lo),a=Pe(this,Pp),o=Pe(this,Py),m=e!==n?e.state:Pe(this,t1),{state:y}=e;let v={...y},w=!1,O;if(r._optimisticResults){const oe=this.hasListeners(),ce=!oe&&KL(e,r),Xe=oe&&ZL(e,n,r,i);(ce||Xe)&&(v={...v,...N7(y.data,e.options)}),r._optimisticResults==="isRestoring"&&(v.fetchStatus="idle")}let{error:P,errorUpdatedAt:E,status:$}=v;O=v.data;let R=!1;if(r.placeholderData!==void 0&&O===void 0&&$==="pending"){let oe;s!=null&&s.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(oe=s.data,R=!0):oe=typeof r.placeholderData=="function"?r.placeholderData((ne=Pe(this,Ey))==null?void 0:ne.state.data,Pe(this,Ey)):r.placeholderData,oe!==void 0&&($="success",O=RA(s==null?void 0:s.data,oe,r),w=!0)}if(r.select&&O!==void 0&&!R)if(s&&O===(a==null?void 0:a.data)&&r.select===Pe(this,r1))O=Pe(this,Ay);else try{rr(this,r1,r.select),O=r.select(O),O=RA(s==null?void 0:s.data,O,r),rr(this,Ay,O),rr(this,Od,null)}catch(oe){rr(this,Od,oe)}Pe(this,Od)&&(P=Pe(this,Od),O=Pe(this,Ay),E=Date.now(),$="error");const F=v.fetchStatus==="fetching",D=$==="pending",U=$==="error",X=D&&F,ee=O!==void 0,Y={status:$,fetchStatus:v.fetchStatus,isPending:D,isSuccess:$==="success",isError:U,isInitialLoading:X,isLoading:X,data:O,dataUpdatedAt:v.dataUpdatedAt,error:P,errorUpdatedAt:E,failureCount:v.fetchFailureCount,failureReason:v.fetchFailureReason,errorUpdateCount:v.errorUpdateCount,isFetched:v.dataUpdateCount>0||v.errorUpdateCount>0,isFetchedAfterMount:v.dataUpdateCount>m.dataUpdateCount||v.errorUpdateCount>m.errorUpdateCount,isFetching:F,isRefetching:F&&!D,isLoadingError:U&&!ee,isPaused:v.fetchStatus==="paused",isPlaceholderData:w,isRefetchError:U&&ee,isStale:jM(e,r),refetch:this.refetch,promise:Pe(this,Ku),isEnabled:Sl(r.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const oe=Y.data!==void 0,ce=Y.status==="error"&&!oe,Xe=Ye=>{ce?Ye.reject(Y.error):oe&&Ye.resolve(Y.data)},Ae=()=>{const Ye=rr(this,Ku,Y.promise=DA());Xe(Ye)},We=Pe(this,Ku);switch(We.status){case"pending":e.queryHash===n.queryHash&&Xe(We);break;case"fulfilled":(ce||Y.data!==We.value)&&Ae();break;case"rejected":(!ce||Y.error!==We.reason)&&Ae();break}}return Y}updateResult(){const e=Pe(this,Lo),r=this.createResult(Pe(this,hn),this.options);if(rr(this,Pp,Pe(this,hn).state),rr(this,Py,this.options),Pe(this,Pp).data!==void 0&&rr(this,Ey,Pe(this,hn)),C2(r,e))return;rr(this,Lo,r);const n=()=>{if(!e)return!0;const{notifyOnChangeProps:i}=this.options,s=typeof i=="function"?i():i;if(s==="all"||!s&&!Pe(this,zy).size)return!0;const a=new Set(s??Pe(this,zy));return this.options.throwOnError&&a.add("error"),Object.keys(Pe(this,Lo)).some(o=>{const d=o;return Pe(this,Lo)[d]!==e[d]&&a.has(d)})};Jr(this,Fn,V7).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Jr(this,Fn,NA).call(this)}},ua=new WeakMap,hn=new WeakMap,t1=new WeakMap,Lo=new WeakMap,Pp=new WeakMap,Py=new WeakMap,Ku=new WeakMap,Od=new WeakMap,r1=new WeakMap,Ay=new WeakMap,Ey=new WeakMap,Ap=new WeakMap,Ep=new WeakMap,jd=new WeakMap,zy=new WeakMap,Fn=new WeakSet,fv=function(e){Jr(this,Fn,UA).call(this);let r=Pe(this,hn).fetch(this.options,e);return e!=null&&e.throwOnError||(r=r.catch($o)),r},FA=function(){Jr(this,Fn,VA).call(this);const e=Gd(this.options.staleTime,Pe(this,hn));if(hm||Pe(this,Lo).isStale||!MA(e))return;const n=R7(Pe(this,Lo).dataUpdatedAt,e)+1;rr(this,Ap,bp.setTimeout(()=>{Pe(this,Lo).isStale||this.updateResult()},n))},BA=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(Pe(this,hn)):this.options.refetchInterval)??!1},$A=function(e){Jr(this,Fn,WA).call(this),rr(this,jd,e),!(hm||Sl(this.options.enabled,Pe(this,hn))===!1||!MA(Pe(this,jd))||Pe(this,jd)===0)&&rr(this,Ep,bp.setInterval(()=>{(this.options.refetchIntervalInBackground||OM.isFocused())&&Jr(this,Fn,fv).call(this)},Pe(this,jd)))},NA=function(){Jr(this,Fn,FA).call(this),Jr(this,Fn,$A).call(this,Jr(this,Fn,BA).call(this))},VA=function(){Pe(this,Ap)&&(bp.clearTimeout(Pe(this,Ap)),rr(this,Ap,void 0))},WA=function(){Pe(this,Ep)&&(bp.clearInterval(Pe(this,Ep)),rr(this,Ep,void 0))},UA=function(){const e=Pe(this,ua).getQueryCache().build(Pe(this,ua),this.options);if(e===Pe(this,hn))return;const r=Pe(this,hn);rr(this,hn,e),rr(this,t1,e.state),this.hasListeners()&&(r==null||r.removeObserver(this),e.addObserver(this))},V7=function(e){gs.batch(()=>{e.listeners&&this.listeners.forEach(r=>{r(Pe(this,Lo))}),Pe(this,ua).getQueryCache().notify({query:Pe(this,hn),type:"observerResultsUpdated"})})},c$);function Exe(t,e){return Sl(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function KL(t,e){return Exe(t,e)||t.state.data!==void 0&&qA(t,e,e.refetchOnMount)}function qA(t,e,r){if(Sl(e.enabled,t)!==!1&&Gd(e.staleTime,t)!=="static"){const n=typeof r=="function"?r(t):r;return n==="always"||n!==!1&&jM(t,e)}return!1}function ZL(t,e,r,n){return(t!==e||Sl(n.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&jM(t,r)}function jM(t,e){return Sl(e.enabled,t)!==!1&&t.isStaleByTime(Gd(e.staleTime,t))}function zxe(t,e){return!C2(t.getCurrentResult(),e)}function YL(t){return{onFetch:(e,r)=>{var y,v,w,O,P;const n=e.options,i=(w=(v=(y=e.fetchOptions)==null?void 0:y.meta)==null?void 0:v.fetchMore)==null?void 0:w.direction,s=((O=e.state.data)==null?void 0:O.pages)||[],a=((P=e.state.data)==null?void 0:P.pageParams)||[];let o={pages:[],pageParams:[]},d=0;const m=async()=>{let E=!1;const $=D=>{Sxe(D,()=>e.signal,()=>E=!0)},R=L7(e.options,e.fetchOptions),F=async(D,U,X)=>{if(E)return Promise.reject();if(U==null&&D.pages.length)return Promise.resolve(D);const K=(()=>{const ce={client:e.client,queryKey:e.queryKey,pageParam:U,direction:X?"backward":"forward",meta:e.options.meta};return $(ce),ce})(),Y=await R(K),{maxPages:ne}=e.options,oe=X?wxe:_xe;return{pages:oe(D.pages,Y,ne),pageParams:oe(D.pageParams,U,ne)}};if(i&&s.length){const D=i==="backward",U=D?Mxe:JL,X={pages:s,pageParams:a},ee=U(n,X);o=await F(X,ee,D)}else{const D=t??s.length;do{const U=d===0?a[0]??n.initialPageParam:JL(n,o);if(d>0&&U==null)break;o=await F(o,U),d++}while(d<D)}return o};e.options.persister?e.fetchFn=()=>{var E,$;return($=(E=e.options).persister)==null?void 0:$.call(E,m,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r)}:e.fetchFn=m}}}function JL(t,{pages:e,pageParams:r}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,r[n],r):void 0}function Mxe(t,{pages:e,pageParams:r}){var n;return e.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,e[0],e,r[0],r):void 0}var n1,Kc,_o,zp,Zc,fd,u$,Ixe=(u$=class extends $7{constructor(e){super();kr(this,Zc);kr(this,n1);kr(this,Kc);kr(this,_o);kr(this,zp);rr(this,n1,e.client),this.mutationId=e.mutationId,rr(this,_o,e.mutationCache),rr(this,Kc,[]),this.state=e.state||W7(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){Pe(this,Kc).includes(e)||(Pe(this,Kc).push(e),this.clearGcTimeout(),Pe(this,_o).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){rr(this,Kc,Pe(this,Kc).filter(r=>r!==e)),this.scheduleGc(),Pe(this,_o).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){Pe(this,Kc).length||(this.state.status==="pending"?this.scheduleGc():Pe(this,_o).remove(this))}continue(){var e;return((e=Pe(this,zp))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var a,o,d,m,y,v,w,O,P,E,$,R,F,D,U,X,ee,K;const r=()=>{Jr(this,Zc,fd).call(this,{type:"continue"})},n={client:Pe(this,n1),meta:this.options.meta,mutationKey:this.options.mutationKey};rr(this,zp,B7({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(new Error("No mutationFn found")),onFail:(Y,ne)=>{Jr(this,Zc,fd).call(this,{type:"failed",failureCount:Y,error:ne})},onPause:()=>{Jr(this,Zc,fd).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Pe(this,_o).canRun(this)}));const i=this.state.status==="pending",s=!Pe(this,zp).canStart();try{if(i)r();else{Jr(this,Zc,fd).call(this,{type:"pending",variables:e,isPaused:s}),Pe(this,_o).config.onMutate&&await Pe(this,_o).config.onMutate(e,this,n);const ne=await((o=(a=this.options).onMutate)==null?void 0:o.call(a,e,n));ne!==this.state.context&&Jr(this,Zc,fd).call(this,{type:"pending",context:ne,variables:e,isPaused:s})}const Y=await Pe(this,zp).start();return await((m=(d=Pe(this,_o).config).onSuccess)==null?void 0:m.call(d,Y,e,this.state.context,this,n)),await((v=(y=this.options).onSuccess)==null?void 0:v.call(y,Y,e,this.state.context,n)),await((O=(w=Pe(this,_o).config).onSettled)==null?void 0:O.call(w,Y,null,this.state.variables,this.state.context,this,n)),await((E=(P=this.options).onSettled)==null?void 0:E.call(P,Y,null,e,this.state.context,n)),Jr(this,Zc,fd).call(this,{type:"success",data:Y}),Y}catch(Y){try{await((R=($=Pe(this,_o).config).onError)==null?void 0:R.call($,Y,e,this.state.context,this,n))}catch(ne){Promise.reject(ne)}try{await((D=(F=this.options).onError)==null?void 0:D.call(F,Y,e,this.state.context,n))}catch(ne){Promise.reject(ne)}try{await((X=(U=Pe(this,_o).config).onSettled)==null?void 0:X.call(U,void 0,Y,this.state.variables,this.state.context,this,n))}catch(ne){Promise.reject(ne)}try{await((K=(ee=this.options).onSettled)==null?void 0:K.call(ee,void 0,Y,e,this.state.context,n))}catch(ne){Promise.reject(ne)}throw Jr(this,Zc,fd).call(this,{type:"error",error:Y}),Y}finally{Pe(this,_o).runNext(this)}}},n1=new WeakMap,Kc=new WeakMap,_o=new WeakMap,zp=new WeakMap,Zc=new WeakSet,fd=function(e){const r=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=r(this.state),gs.batch(()=>{Pe(this,Kc).forEach(n=>{n.onMutationUpdate(e)}),Pe(this,_o).notify({mutation:this,type:"updated",action:e})})},u$);function W7(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Zu,lc,i1,h$,Rxe=(h$=class extends k0{constructor(e={}){super();kr(this,Zu);kr(this,lc);kr(this,i1);this.config=e,rr(this,Zu,new Set),rr(this,lc,new Map),rr(this,i1,0)}build(e,r,n){const i=new Ixe({client:e,mutationCache:this,mutationId:++$_(this,i1)._,options:e.defaultMutationOptions(r),state:n});return this.add(i),i}add(e){Pe(this,Zu).add(e);const r=ww(e);if(typeof r=="string"){const n=Pe(this,lc).get(r);n?n.push(e):Pe(this,lc).set(r,[e])}this.notify({type:"added",mutation:e})}remove(e){if(Pe(this,Zu).delete(e)){const r=ww(e);if(typeof r=="string"){const n=Pe(this,lc).get(r);if(n)if(n.length>1){const i=n.indexOf(e);i!==-1&&n.splice(i,1)}else n[0]===e&&Pe(this,lc).delete(r)}}this.notify({type:"removed",mutation:e})}canRun(e){const r=ww(e);if(typeof r=="string"){const n=Pe(this,lc).get(r),i=n==null?void 0:n.find(s=>s.state.status==="pending");return!i||i===e}else return!0}runNext(e){var n;const r=ww(e);if(typeof r=="string"){const i=(n=Pe(this,lc).get(r))==null?void 0:n.find(s=>s!==e&&s.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){gs.batch(()=>{Pe(this,Zu).forEach(e=>{this.notify({type:"removed",mutation:e})}),Pe(this,Zu).clear(),Pe(this,lc).clear()})}getAll(){return Array.from(Pe(this,Zu))}find(e){const r={exact:!0,...e};return this.getAll().find(n=>qL(r,n))}findAll(e={}){return this.getAll().filter(r=>qL(e,r))}notify(e){gs.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){const e=this.getAll().filter(r=>r.state.isPaused);return gs.batch(()=>Promise.all(e.map(r=>r.continue().catch($o))))}},Zu=new WeakMap,lc=new WeakMap,i1=new WeakMap,h$);function ww(t){var e;return(e=t.options.scope)==null?void 0:e.id}var Yu,Pd,ha,Ju,gh,TS,QA,d$,Dxe=(d$=class extends k0{constructor(r,n){super();kr(this,gh);kr(this,Yu);kr(this,Pd);kr(this,ha);kr(this,Ju);rr(this,Yu,r),this.setOptions(n),this.bindMethods(),Jr(this,gh,TS).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var i;const n=this.options;this.options=Pe(this,Yu).defaultMutationOptions(r),C2(this.options,n)||Pe(this,Yu).getMutationCache().notify({type:"observerOptionsUpdated",mutation:Pe(this,ha),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&dm(n.mutationKey)!==dm(this.options.mutationKey)?this.reset():((i=Pe(this,ha))==null?void 0:i.state.status)==="pending"&&Pe(this,ha).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=Pe(this,ha))==null||r.removeObserver(this)}onMutationUpdate(r){Jr(this,gh,TS).call(this),Jr(this,gh,QA).call(this,r)}getCurrentResult(){return Pe(this,Pd)}reset(){var r;(r=Pe(this,ha))==null||r.removeObserver(this),rr(this,ha,void 0),Jr(this,gh,TS).call(this),Jr(this,gh,QA).call(this)}mutate(r,n){var i;return rr(this,Ju,n),(i=Pe(this,ha))==null||i.removeObserver(this),rr(this,ha,Pe(this,Yu).getMutationCache().build(Pe(this,Yu),this.options)),Pe(this,ha).addObserver(this),Pe(this,ha).execute(r)}},Yu=new WeakMap,Pd=new WeakMap,ha=new WeakMap,Ju=new WeakMap,gh=new WeakSet,TS=function(){var n;const r=((n=Pe(this,ha))==null?void 0:n.state)??W7();rr(this,Pd,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},QA=function(r){gs.batch(()=>{var n,i,s,a,o,d,m,y;if(Pe(this,Ju)&&this.hasListeners()){const v=Pe(this,Pd).variables,w=Pe(this,Pd).context,O={client:Pe(this,Yu),meta:this.options.meta,mutationKey:this.options.mutationKey};if((r==null?void 0:r.type)==="success"){try{(i=(n=Pe(this,Ju)).onSuccess)==null||i.call(n,r.data,v,w,O)}catch(P){Promise.reject(P)}try{(a=(s=Pe(this,Ju)).onSettled)==null||a.call(s,r.data,null,v,w,O)}catch(P){Promise.reject(P)}}else if((r==null?void 0:r.type)==="error"){try{(d=(o=Pe(this,Ju)).onError)==null||d.call(o,r.error,v,w,O)}catch(P){Promise.reject(P)}try{(y=(m=Pe(this,Ju)).onSettled)==null||y.call(m,void 0,r.error,v,w,O)}catch(P){Promise.reject(P)}}}this.listeners.forEach(v=>{v(Pe(this,Pd))})})},d$),Yc,f$,Lxe=(f$=class extends k0{constructor(e={}){super();kr(this,Yc);this.config=e,rr(this,Yc,new Map)}build(e,r,n){const i=r.queryKey,s=r.queryHash??kM(i,r);let a=this.get(s);return a||(a=new Pxe({client:e,queryKey:i,queryHash:s,options:e.defaultQueryOptions(r),state:n,defaultOptions:e.getQueryDefaults(i)}),this.add(a)),a}add(e){Pe(this,Yc).has(e.queryHash)||(Pe(this,Yc).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const r=Pe(this,Yc).get(e.queryHash);r&&(e.destroy(),r===e&&Pe(this,Yc).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){gs.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return Pe(this,Yc).get(e)}getAll(){return[...Pe(this,Yc).values()]}find(e){const r={exact:!0,...e};return this.getAll().find(n=>UL(r,n))}findAll(e={}){const r=this.getAll();return Object.keys(e).length>0?r.filter(n=>UL(e,n)):r}notify(e){gs.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){gs.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){gs.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Yc=new WeakMap,f$),Mi,Ad,Ed,My,Iy,zd,Ry,Dy,p$,Fxe=(p$=class{constructor(t={}){kr(this,Mi);kr(this,Ad);kr(this,Ed);kr(this,My);kr(this,Iy);kr(this,zd);kr(this,Ry);kr(this,Dy);rr(this,Mi,t.queryCache||new Lxe),rr(this,Ad,t.mutationCache||new Rxe),rr(this,Ed,t.defaultOptions||{}),rr(this,My,new Map),rr(this,Iy,new Map),rr(this,zd,0)}mount(){$_(this,zd)._++,Pe(this,zd)===1&&(rr(this,Ry,OM.subscribe(async t=>{t&&(await this.resumePausedMutations(),Pe(this,Mi).onFocus())})),rr(this,Dy,T2.subscribe(async t=>{t&&(await this.resumePausedMutations(),Pe(this,Mi).onOnline())})))}unmount(){var t,e;$_(this,zd)._--,Pe(this,zd)===0&&((t=Pe(this,Ry))==null||t.call(this),rr(this,Ry,void 0),(e=Pe(this,Dy))==null||e.call(this),rr(this,Dy,void 0))}isFetching(t){return Pe(this,Mi).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return Pe(this,Ad).findAll({...t,status:"pending"}).length}getQueryData(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=Pe(this,Mi).get(e.queryHash))==null?void 0:r.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=Pe(this,Mi).build(this,e),n=r.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(Gd(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(t){return Pe(this,Mi).findAll(t).map(({queryKey:e,state:r})=>{const n=r.data;return[e,n]})}setQueryData(t,e,r){const n=this.defaultQueryOptions({queryKey:t}),i=Pe(this,Mi).get(n.queryHash),s=i==null?void 0:i.state.data,a=xxe(e,s);if(a!==void 0)return Pe(this,Mi).build(this,n).setData(a,{...r,manual:!0})}setQueriesData(t,e,r){return gs.batch(()=>Pe(this,Mi).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,r)]))}getQueryState(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=Pe(this,Mi).get(e.queryHash))==null?void 0:r.state}removeQueries(t){const e=Pe(this,Mi);gs.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=Pe(this,Mi);return gs.batch(()=>(r.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},n=gs.batch(()=>Pe(this,Mi).findAll(t).map(i=>i.cancel(r)));return Promise.all(n).then($o).catch($o)}invalidateQueries(t,e={}){return gs.batch(()=>(Pe(this,Mi).findAll(t).forEach(r=>{r.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},n=gs.batch(()=>Pe(this,Mi).findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let s=i.fetch(void 0,r);return r.throwOnError||(s=s.catch($o)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then($o)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=Pe(this,Mi).build(this,e);return r.isStaleByTime(Gd(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then($o).catch($o)}fetchInfiniteQuery(t){return t.behavior=YL(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then($o).catch($o)}ensureInfiniteQueryData(t){return t.behavior=YL(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return T2.isOnline()?Pe(this,Ad).resumePausedMutations():Promise.resolve()}getQueryCache(){return Pe(this,Mi)}getMutationCache(){return Pe(this,Ad)}getDefaultOptions(){return Pe(this,Ed)}setDefaultOptions(t){rr(this,Ed,t)}setQueryDefaults(t,e){Pe(this,My).set(dm(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...Pe(this,My).values()],r={};return e.forEach(n=>{Mb(t,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(t,e){Pe(this,Iy).set(dm(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...Pe(this,Iy).values()],r={};return e.forEach(n=>{Mb(t,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...Pe(this,Ed).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=kM(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===CM&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...Pe(this,Ed).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){Pe(this,Mi).clear(),Pe(this,Ad).clear()}},Mi=new WeakMap,Ad=new WeakMap,Ed=new WeakMap,My=new WeakMap,Iy=new WeakMap,zd=new WeakMap,Ry=new WeakMap,Dy=new WeakMap,p$),U7=I.createContext(void 0),Jo=t=>{const e=I.useContext(U7);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},Bxe=({client:t,children:e})=>(I.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),u.jsx(U7.Provider,{value:t,children:e})),q7=I.createContext(!1),$xe=()=>I.useContext(q7);q7.Provider;function Nxe(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var Vxe=I.createContext(Nxe()),Wxe=()=>I.useContext(Vxe),Uxe=(t,e,r)=>{const n=r!=null&&r.state.error&&typeof t.throwOnError=="function"?TM(t.throwOnError,[r.state.error,r]):t.throwOnError;(t.suspense||t.experimental_prefetchInRender||n)&&(e.isReset()||(t.retryOnMount=!1))},qxe=t=>{I.useEffect(()=>{t.clearReset()},[t])},Qxe=({result:t,errorResetBoundary:e,throwOnError:r,query:n,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&n&&(i&&t.data===void 0||TM(r,[t.error,n])),Hxe=t=>{if(t.suspense){const r=i=>i==="static"?i:Math.max(i??1e3,1e3),n=t.staleTime;t.staleTime=typeof n=="function"?(...i)=>r(n(...i)):r(n),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},Gxe=(t,e)=>t.isLoading&&t.isFetching&&!e,Xxe=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,eF=(t,e,r)=>e.fetchOptimistic(t).catch(()=>{r.clearReset()});function Kxe(t,e,r){var w,O,P,E;const n=$xe(),i=Wxe(),s=Jo(),a=s.defaultQueryOptions(t);(O=(w=s.getDefaultOptions().queries)==null?void 0:w._experimental_beforeQuery)==null||O.call(w,a);const o=s.getQueryCache().get(a.queryHash);a._optimisticResults=n?"isRestoring":"optimistic",Hxe(a),Uxe(a,i,o),qxe(i);const d=!s.getQueryCache().get(a.queryHash),[m]=I.useState(()=>new e(s,a)),y=m.getOptimisticResult(a),v=!n&&t.subscribed!==!1;if(I.useSyncExternalStore(I.useCallback($=>{const R=v?m.subscribe(gs.batchCalls($)):$o;return m.updateResult(),R},[m,v]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),I.useEffect(()=>{m.setOptions(a)},[a,m]),Xxe(a,y))throw eF(a,m,i);if(Qxe({result:y,errorResetBoundary:i,throwOnError:a.throwOnError,query:o,suspense:a.suspense}))throw y.error;if((E=(P=s.getDefaultOptions().queries)==null?void 0:P._experimental_afterQuery)==null||E.call(P,a,y),a.experimental_prefetchInRender&&!hm&&Gxe(y,n)){const $=d?eF(a,m,i):o==null?void 0:o.promise;$==null||$.catch($o).finally(()=>{m.updateResult()})}return a.notifyOnChangeProps?y:m.trackResult(y)}function Xr(t,e){return Kxe(t,Axe)}function su(t,e){const r=Jo(),[n]=I.useState(()=>new Dxe(r,t));I.useEffect(()=>{n.setOptions(t)},[n,t]);const i=I.useSyncExternalStore(I.useCallback(a=>n.subscribe(gs.batchCalls(a)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),s=I.useCallback((a,o)=>{n.mutate(a,o).catch($o)},[n]);if(i.error&&TM(n.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:s,mutateAsync:i.mutate}}var Q7={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},tF=$i.createContext&&$i.createContext(Q7),Zxe=["attr","size","title"];function Yxe(t,e){if(t==null)return{};var r=Jxe(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Jxe(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function O2(){return O2=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},O2.apply(this,arguments)}function rF(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function j2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rF(Object(r),!0).forEach(function(n){eve(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rF(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function eve(t,e,r){return e=tve(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tve(t){var e=rve(t,"string");return typeof e=="symbol"?e:e+""}function rve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H7(t){return t&&t.map((e,r)=>$i.createElement(e.tag,j2({key:r},e.attr),H7(e.child)))}function ir(t){return e=>$i.createElement(nve,O2({attr:j2({},t.attr)},e),H7(t.child))}function nve(t){var e=r=>{var{attr:n,size:i,title:s}=t,a=Yxe(t,Zxe),o=i||r.size||"1em",d;return r.className&&(d=r.className),t.className&&(d=(d?d+" ":"")+t.className),$i.createElement("svg",O2({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,a,{className:d,style:j2(j2({color:t.color||r.color},r.style),t.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&$i.createElement("title",null,s),t.children)};return tF!==void 0?$i.createElement(tF.Consumer,null,r=>e(r)):e(Q7)}function M1(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 18 12 15 21 9 3 6 12 2 12"},child:[]}]})(t)}function Gp(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"},child:[]}]})(t)}function G7(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"},child:[]},{tag:"line",attr:{x1:"12",y1:"9",x2:"12",y2:"13"},child:[]},{tag:"line",attr:{x1:"12",y1:"17",x2:"12.01",y2:"17"},child:[]}]})(t)}function ive(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"polyline",attr:{points:"19 12 12 19 5 12"},child:[]}]})(t)}function sve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"12",x2:"5",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 19 5 12 12 5"},child:[]}]})(t)}function pv(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 5 19 12 12 19"},child:[]}]})(t)}function ove(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"},child:[]},{tag:"path",attr:{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"},child:[]}]})(t)}function PM(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"},child:[]},{tag:"polyline",attr:{points:"3.27 6.96 12 12.01 20.73 6.96"},child:[]},{tag:"line",attr:{x1:"12",y1:"22.08",x2:"12",y2:"12"},child:[]}]})(t)}function nF(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"},child:[]}]})(t)}function lf(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},child:[]},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"},child:[]}]})(t)}function AM(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"},child:[]}]})(t)}function Ul(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(t)}function ave(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(t)}function X7(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(t)}function i0(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(t)}function lve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]}]})(t)}function cC(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(t)}function cve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"},child:[]}]})(t)}function Ml(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"16 18 22 12 16 6"},child:[]},{tag:"polyline",attr:{points:"8 6 2 12 8 18"},child:[]}]})(t)}function K7(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 3h7a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-7m0-18H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h7m0-18v18"},child:[]}]})(t)}function iF(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},child:[]}]})(t)}function uve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"4",y:"4",width:"16",height:"16",rx:"2",ry:"2"},child:[]},{tag:"rect",attr:{x:"9",y:"9",width:"6",height:"6"},child:[]},{tag:"line",attr:{x1:"9",y1:"1",x2:"9",y2:"4"},child:[]},{tag:"line",attr:{x1:"15",y1:"1",x2:"15",y2:"4"},child:[]},{tag:"line",attr:{x1:"9",y1:"20",x2:"9",y2:"23"},child:[]},{tag:"line",attr:{x1:"15",y1:"20",x2:"15",y2:"23"},child:[]},{tag:"line",attr:{x1:"20",y1:"9",x2:"23",y2:"9"},child:[]},{tag:"line",attr:{x1:"20",y1:"14",x2:"23",y2:"14"},child:[]},{tag:"line",attr:{x1:"1",y1:"9",x2:"4",y2:"9"},child:[]},{tag:"line",attr:{x1:"1",y1:"14",x2:"4",y2:"14"},child:[]}]})(t)}function Wn(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"ellipse",attr:{cx:"12",cy:"5",rx:"9",ry:"3"},child:[]},{tag:"path",attr:{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"},child:[]},{tag:"path",attr:{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"},child:[]}]})(t)}function gy(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"7 10 12 15 17 10"},child:[]},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"},child:[]}]})(t)}function Wo(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"},child:[]}]})(t)}function hve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"},child:[]}]})(t)}function _c(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 20h9"},child:[]},{tag:"path",attr:{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"},child:[]}]})(t)}function dve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"},child:[]},{tag:"polyline",attr:{points:"15 3 21 3 21 9"},child:[]},{tag:"line",attr:{x1:"10",y1:"14",x2:"21",y2:"3"},child:[]}]})(t)}function cf(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},child:[]},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"},child:[]}]})(t)}function Ri(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]}]})(t)}function Z7(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"},child:[]},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"},child:[]},{tag:"polyline",attr:{points:"10 9 9 9 8 9"},child:[]}]})(t)}function Y7(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"},child:[]},{tag:"polyline",attr:{points:"13 2 13 9 20 9"},child:[]}]})(t)}function fve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"},child:[]}]})(t)}function mh(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"},child:[]}]})(t)}function xs(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"path",attr:{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"},child:[]}]})(t)}function uf(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"7",height:"7"},child:[]},{tag:"rect",attr:{x:"14",y:"3",width:"7",height:"7"},child:[]},{tag:"rect",attr:{x:"14",y:"14",width:"7",height:"7"},child:[]},{tag:"rect",attr:{x:"3",y:"14",width:"7",height:"7"},child:[]}]})(t)}function yy(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"22",y1:"12",x2:"2",y2:"12"},child:[]},{tag:"path",attr:{d:"M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"},child:[]},{tag:"line",attr:{x1:"6",y1:"16",x2:"6.01",y2:"16"},child:[]},{tag:"line",attr:{x1:"10",y1:"16",x2:"10.01",y2:"16"},child:[]}]})(t)}function J7(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"path",attr:{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"},child:[]},{tag:"line",attr:{x1:"12",y1:"17",x2:"12.01",y2:"17"},child:[]}]})(t)}function pve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},child:[]},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"},child:[]}]})(t)}function wc(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"8.5",r:"1.5"},child:[]},{tag:"polyline",attr:{points:"21 15 16 10 5 21"},child:[]}]})(t)}function I1(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"},child:[]}]})(t)}function hi(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 2 7 12 12 22 7 12 2"},child:[]},{tag:"polyline",attr:{points:"2 17 12 22 22 17"},child:[]},{tag:"polyline",attr:{points:"2 12 12 17 22 12"},child:[]}]})(t)}function mve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"},child:[]},{tag:"path",attr:{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"},child:[]}]})(t)}function gve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(t)}function P2(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(t)}function Sc(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"18"},child:[]},{tag:"line",attr:{x1:"16",y1:"6",x2:"16",y2:"22"},child:[]}]})(t)}function yve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 3 21 3 21 9"},child:[]},{tag:"polyline",attr:{points:"9 21 3 21 3 15"},child:[]},{tag:"line",attr:{x1:"21",y1:"3",x2:"14",y2:"10"},child:[]},{tag:"line",attr:{x1:"3",y1:"21",x2:"10",y2:"14"},child:[]}]})(t)}function eU(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(t)}function xve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"16.5",y1:"9.4",x2:"7.5",y2:"4.21"},child:[]},{tag:"path",attr:{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"},child:[]},{tag:"polyline",attr:{points:"3.27 6.96 12 12.01 20.73 6.96"},child:[]},{tag:"line",attr:{x1:"12",y1:"22.08",x2:"12",y2:"12"},child:[]}]})(t)}function sF(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"},child:[]}]})(t)}function EM(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"5 3 19 12 5 21 5 3"},child:[]}]})(t)}function vve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"16"},child:[]},{tag:"line",attr:{x1:"8",y1:"12",x2:"16",y2:"12"},child:[]}]})(t)}function vs(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(t)}function bve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"1 4 1 10 7 10"},child:[]},{tag:"polyline",attr:{points:"23 20 23 14 17 14"},child:[]},{tag:"path",attr:{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"},child:[]}]})(t)}function Su(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(t)}function OS(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},child:[]},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"},child:[]},{tag:"polyline",attr:{points:"7 3 7 8 15 8"},child:[]}]})(t)}function Ib(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(t)}function ql(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"2",width:"20",height:"8",rx:"2",ry:"2"},child:[]},{tag:"rect",attr:{x:"2",y:"14",width:"20",height:"8",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"6.01",y2:"6"},child:[]},{tag:"line",attr:{x1:"6",y1:"18",x2:"6.01",y2:"18"},child:[]}]})(t)}function R1(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(t)}function tU(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},child:[]}]})(t)}function _ve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"},child:[]}]})(t)}function wve(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"rect",attr:{x:"9",y:"9",width:"6",height:"6"},child:[]}]})(t)}function Vo(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"},child:[]}]})(t)}function Xd(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"},child:[]},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"},child:[]},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"},child:[]},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"},child:[]}]})(t)}function Vv(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]},{tag:"line",attr:{x1:"12",y1:"12",x2:"12",y2:"21"},child:[]},{tag:"path",attr:{d:"M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"},child:[]},{tag:"polyline",attr:{points:"16 16 12 12 8 16"},child:[]}]})(t)}function Hl(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"17 8 12 3 7 8"},child:[]},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"},child:[]}]})(t)}function oF(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(t)}function A2(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(t)}function uC(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"15",y1:"9",x2:"9",y2:"15"},child:[]},{tag:"line",attr:{x1:"9",y1:"9",x2:"15",y2:"15"},child:[]}]})(t)}function hf(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(t)}function vu(t){return ir({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"},child:[]}]})(t)}const Sve={},aF=t=>{let e;const r=new Set,n=(y,v)=>{const w=typeof y=="function"?y(e):y;if(!Object.is(w,e)){const O=e;e=v??(typeof w!="object"||w===null)?w:Object.assign({},e,w),r.forEach(P=>P(e,O))}},i=()=>e,d={setState:n,getState:i,getInitialState:()=>m,subscribe:y=>(r.add(y),()=>r.delete(y)),destroy:()=>{(Sve?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},m=e=t(n,i,d);return d},kve=t=>t?aF(t):aF;var rU={exports:{}},nU={},iU={exports:{}},sU={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s0=I;function Cve(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Tve=typeof Object.is=="function"?Object.is:Cve,Ove=s0.useState,jve=s0.useEffect,Pve=s0.useLayoutEffect,Ave=s0.useDebugValue;function Eve(t,e){var r=e(),n=Ove({inst:{value:r,getSnapshot:e}}),i=n[0].inst,s=n[1];return Pve(function(){i.value=r,i.getSnapshot=e,rj(i)&&s({inst:i})},[t,r,e]),jve(function(){return rj(i)&&s({inst:i}),t(function(){rj(i)&&s({inst:i})})},[t]),Ave(r),r}function rj(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Tve(t,r)}catch{return!0}}function zve(t,e){return e()}var Mve=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?zve:Eve;sU.useSyncExternalStore=s0.useSyncExternalStore!==void 0?s0.useSyncExternalStore:Mve;iU.exports=sU;var Ive=iU.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hC=I,Rve=Ive;function Dve(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Lve=typeof Object.is=="function"?Object.is:Dve,Fve=Rve.useSyncExternalStore,Bve=hC.useRef,$ve=hC.useEffect,Nve=hC.useMemo,Vve=hC.useDebugValue;nU.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var s=Bve(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=Nve(function(){function d(O){if(!m){if(m=!0,y=O,O=n(O),i!==void 0&&a.hasValue){var P=a.value;if(i(P,O))return v=P}return v=O}if(P=v,Lve(y,O))return P;var E=n(O);return i!==void 0&&i(P,E)?(y=O,P):(y=O,v=E)}var m=!1,y,v,w=r===void 0?null:r;return[function(){return d(e())},w===null?void 0:function(){return d(w())}]},[e,r,n,i]);var o=Fve(t,s[0],s[1]);return $ve(function(){a.hasValue=!0,a.value=o},[o]),Vve(o),o};rU.exports=nU;var Wve=rU.exports;const Uve=s1(Wve),oU={},{useDebugValue:qve}=$i,{useSyncExternalStoreWithSelector:Qve}=Uve;let lF=!1;const Hve=t=>t;function Gve(t,e=Hve,r){(oU?"production":void 0)!=="production"&&r&&!lF&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),lF=!0);const n=Qve(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,r);return qve(n),n}const cF=t=>{(oU?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?kve(t):t,r=(n,i)=>Gve(e,n,i);return Object.assign(r,e),r},zM=t=>t?cF(t):cF,Xve=()=>{try{const t=localStorage.getItem("cloudbench-settings");if(t)return JSON.parse(t)}catch{}return{showHiddenPGServices:!1}},Kve=t=>{try{localStorage.setItem("cloudbench-settings",JSON.stringify(t))}catch{}},bt=zM(t=>({activeDialog:null,dialogData:null,activePreview:null,previewMode:"2d",statusMessage:"Ready",errorMessage:null,successMessage:null,isLoading:!1,sidebarWidth:420,settings:Xve(),openDialog:(e,r)=>{t({activeDialog:e,dialogData:r??null})},closeDialog:()=>{t({activeDialog:null,dialogData:null})},setPreview:e=>{t({activePreview:e})},setPreviewMode:e=>{t({previewMode:e})},setStatus:e=>{t({statusMessage:e})},setError:e=>{t({errorMessage:e}),e&&setTimeout(()=>{t(r=>r.errorMessage===e?{errorMessage:null}:r)},5e3)},setSuccess:e=>{t({successMessage:e}),e&&setTimeout(()=>{t(r=>r.successMessage===e?{successMessage:null}:r)},3e3)},setLoading:e=>{t({isLoading:e})},setSidebarWidth:e=>{t({sidebarWidth:Math.max(200,Math.min(600,e))})},clearMessages:()=>{t({errorMessage:null,successMessage:null})},setShowHiddenPGServices:e=>{t(r=>{const n={...r.settings,showHiddenPGServices:e};return Kve(n),{settings:n}})}})),Xt="/api";async function sr(t){if(!t.ok){const e=await t.json().catch(()=>({error:"Unknown error"}));throw new Error(e.error||`HTTP ${t.status}`)}if(t.status!==204)return t.json()}async function Zve(){const t=await fetch(`${Xt}/connections`);return sr(t)}async function Yve(t){const e=await fetch(`${Xt}/connections`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return sr(e)}async function Jve(t,e){const r=await fetch(`${Xt}/connections/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return sr(r)}async function ebe(t){const e=await fetch(`${Xt}/connections/${t}`,{method:"DELETE"});return sr(e)}async function tbe(t){const e=await fetch(`${Xt}/connections/${t}/test`,{method:"POST"});return sr(e)}async function rbe(t){const e=await fetch(`${Xt}/connections/${t}/info`);return sr(e)}async function aU(t){const e=await fetch(`${Xt}/workspaces/${t}`);return sr(e)}async function lU(t,e){const r=await fetch(`${Xt}/workspaces/${t}/${e}`);return sr(r)}async function nbe(t,e){const r=await fetch(`${Xt}/workspaces/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return sr(r)}async function ibe(t,e,r){const n=await fetch(`${Xt}/workspaces/${t}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return sr(n)}async function sbe(t,e,r=!1){const i=await fetch(`${Xt}/workspaces/${t}/${e}${r?"?recurse=true":""}`,{method:"DELETE"});return sr(i)}async function MM(t,e){const r=await fetch(`${Xt}/datastores/${t}/${e}`);return sr(r)}async function cU(t,e,r){const n=await fetch(`${Xt}/datastores/${t}/${e}/${r}`);return sr(n)}async function obe(t,e,r,n=!1){const s=await fetch(`${Xt}/datastores/${t}/${e}/${r}${n?"?recurse=true":""}`,{method:"DELETE"});return sr(s)}async function uU(t,e,r){const n=await fetch(`${Xt}/datastores/${t}/${e}/${r}/available`);return(await sr(n)).available||[]}async function hU(t,e,r,n){const i=await fetch(`${Xt}/datastores/${t}/${e}/${r}/publish`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({featureTypes:n})});return sr(i)}async function IM(t,e){const r=await fetch(`${Xt}/coveragestores/${t}/${e}`);return sr(r)}async function dU(t,e,r){const n=await fetch(`${Xt}/coveragestores/${t}/${e}/${r}`);return sr(n)}async function abe(t,e,r,n=!1){const s=await fetch(`${Xt}/coveragestores/${t}/${e}/${r}${n?"?recurse=true":""}`,{method:"DELETE"});return sr(s)}async function D1(t,e){const r=await fetch(`${Xt}/layers/${t}/${e}`);return sr(r)}async function fU(t,e,r){const n=await fetch(`${Xt}/layers/${t}/${e}/${r}`);return sr(n)}async function lbe(t,e,r){const n=await fetch(`${Xt}/layers/${t}/${e}/${r}`,{method:"DELETE"});return sr(n)}async function cbe(t,e,r){const n=await fetch(`${Xt}/layermetadata/${t}/${e}/${r}`);return sr(n)}async function ube(t,e,r){const n=await fetch(`${Xt}/layers/${t}/${e}/${r}/count`);return(await sr(n)).count}async function hbe(t,e,r,n){const i=await fetch(`${Xt}/layermetadata/${t}/${e}/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return sr(i)}async function RM(t,e){const r=await fetch(`${Xt}/styles/${t}/${e}`);return sr(r)}async function dbe(t,e,r,n=!1){const s=await fetch(`${Xt}/styles/${t}/${e}/${r}${n?"?purge=true":""}`,{method:"DELETE"});return sr(s)}async function pU(t,e,r){const n=await fetch(`${Xt}/layerstyles/${t}/${e}/${r}`);return sr(n)}async function fbe(t,e,r,n,i){const s=await fetch(`${Xt}/layerstyles/${t}/${e}/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({defaultStyle:n,additionalStyles:i})});return sr(s)}async function mU(t,e,r){const n=await fetch(`${Xt}/styles/${t}/${e}/${r}`);return sr(n)}async function pbe(t,e,r,n,i="sld"){const s=await fetch(`${Xt}/styles/${t}/${e}/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:n,format:i})});return sr(s)}async function mbe(t,e,r,n,i="sld"){const s=await fetch(`${Xt}/styles/${t}/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,content:n,format:i})});return sr(s)}async function gU(t,e){const r=await fetch(`${Xt}/layergroups/${t}/${e}`);return sr(r)}async function gbe(t,e,r){const n=await fetch(`${Xt}/layergroups/${t}/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return sr(n)}async function yU(t,e,r){const n=await fetch(`${Xt}/layergroups/${t}/${e}/${r}`);return sr(n)}async function ybe(t,e,r,n){const i=await fetch(`${Xt}/layergroups/${t}/${e}/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return sr(i)}async function xbe(t,e,r){const n=await fetch(`${Xt}/layergroups/${t}/${e}/${r}`,{method:"DELETE"});return sr(n)}async function vbe(t,e,r){const n=await fetch(`${Xt}/featuretypes/${t}/${e}/${r}`);return sr(n)}async function bbe(t,e,r,n){const i=await fetch(`${Xt}/featuretypes/${t}/${e}/${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n})});return sr(i)}async function _be(t,e,r){const n=await fetch(`${Xt}/coverages/${t}/${e}/${r}`);return sr(n)}async function wbe(t,e,r,n){const i=new FormData;return i.append("file",r),new Promise((s,a)=>{const o=new XMLHttpRequest;o.upload.addEventListener("progress",d=>{if(d.lengthComputable&&n){const m=Math.round(d.loaded/d.total*100);n(m)}}),o.addEventListener("load",()=>{o.status>=200&&o.status<300?s(JSON.parse(o.responseText)):a(new Error(JSON.parse(o.responseText).error||"Upload failed"))}),o.addEventListener("error",()=>{a(new Error("Network error"))}),o.open("POST",`${Xt}/upload?connId=${encodeURIComponent(t)}&workspace=${encodeURIComponent(e)}`),o.send(i)})}async function il(t){const e=await fetch(`${Xt}/preview`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return sr(e)}async function Sbe(t,e){const r=await fetch(`${Xt}/gwc/layers/${t}/${e}`);return sr(r)}async function kbe(t,e){const r=await fetch(`${Xt}/gwc/seed/${t}/${e}`);return sr(r)}async function Cbe(t,e,r){const n=await fetch(`${Xt}/gwc/seed/${t}/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return sr(n)}async function Tbe(t,e){const r=await fetch(`${Xt}/gwc/seed/${t}/${e}`,{method:"DELETE"});return sr(r)}async function Obe(t,e,r){const n=await fetch(`${Xt}/gwc/truncate/${t}/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});return sr(n)}async function jbe(t){const e=await fetch(`${Xt}/settings/${t}`);return sr(e)}async function Pbe(t,e){const r=await fetch(`${Xt}/settings/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return sr(r)}async function Abe(){const t=await fetch(`${Xt}/sync/configs`);return sr(t)}async function Ebe(t){const e=await fetch(`${Xt}/sync/configs`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return sr(e)}async function zbe(t){const e=await fetch(`${Xt}/sync/configs/${t}`,{method:"DELETE"});return sr(e)}async function Mbe(t){const e=await fetch(`${Xt}/sync/start`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return sr(e)}async function Ibe(){const t=await fetch(`${Xt}/sync/status`);return sr(t)}async function Rbe(t){const e=await fetch(`${Xt}/sync/stop/${t}`,{method:"POST"});return sr(e)}async function Dbe(){const t=await fetch(`${Xt}/sync/stop`,{method:"POST"});return sr(t)}async function Lbe(){const t=await fetch(`${Xt}/dashboard`);return sr(t)}function xU(t,e,r,n){let i=`${Xt}/download/${t}/${e}/${r}`;n&&(i+=`/${n}`),window.open(i,"_blank")}function Fbe(t,e,r){const n=`${Xt}/download/${t}/shapefile/${e}/${r}`;window.open(n,"_blank")}function Bbe(t,e,r){const n=`${Xt}/download/${t}/geotiff/${e}/${r}`;window.open(n,"_blank")}function $be(t){const e=`${Xt}/download/logs/${t}`;window.open(e,"_blank")}async function Nbe(t,e){let r=`${Xt}/search?q=${encodeURIComponent(t)}`;const n=await fetch(r);return sr(n)}async function Vbe(){const t=await fetch(`${Xt}/search/suggestions`);return sr(t)}async function DM(){const t=await fetch(`${Xt}/pg/services`);return sr(t)}async function uF(t){const e=await fetch(`${Xt}/pg/services`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return sr(e)}async function Wbe(t){const e=await fetch(`${Xt}/pg/services/${encodeURIComponent(t)}`,{method:"DELETE"});return sr(e)}async function vU(t){const e=await fetch(`${Xt}/pg/services/${encodeURIComponent(t)}/test`,{method:"POST"});return sr(e)}async function bU(t){const e=await fetch(`${Xt}/pg/services/${encodeURIComponent(t)}/parse`,{method:"POST"});return sr(e)}async function Ube(t,e){const r=await fetch(`${Xt}/pg/services/${encodeURIComponent(t)}/hide`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hidden:e})});return sr(r)}async function _U(t){const e=await fetch(`${Xt}/pg/services/${encodeURIComponent(t)}/stats`);return sr(e)}async function qbe(t,e){const r=await fetch(`${Xt}/pg/services/${encodeURIComponent(t)}/schemastats?schema=${encodeURIComponent(e)}`);return sr(r)}async function Qbe(){const t=await fetch(`${Xt}/pg/ogr2ogr/status`);return sr(t)}async function Hbe(t,e){const r=new FormData;return r.append("file",t),new Promise((n,i)=>{const s=new XMLHttpRequest;s.upload.addEventListener("progress",a=>{if(a.lengthComputable&&e){const o=Math.round(a.loaded/a.total*100);e(o)}}),s.addEventListener("load",()=>{s.status>=200&&s.status<300?n(JSON.parse(s.responseText)):i(new Error(JSON.parse(s.responseText).error||"Upload failed"))}),s.addEventListener("error",()=>{i(new Error("Network error"))}),s.open("POST",`${Xt}/pg/import/upload`),s.send(r)})}async function Gbe(t){const e=await fetch(`${Xt}/pg/detect-layers`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:t})});return sr(e)}async function Xbe(t){const e=await fetch(`${Xt}/pg/import`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return sr(e)}async function Kbe(t){const e=await fetch(`${Xt}/pg/import/raster`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return sr(e)}async function Zbe(t){const e=await fetch(`${Xt}/pg/import/${t}`);return sr(e)}async function wU(t,e,r=100){const n=await fetch(`${Xt}/query/execute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({service_name:t,sql:e,max_rows:r})});return sr(n)}async function Ybe(t,e,r,n=100,i=0){const s=`SELECT * FROM "${e}"."${r}" LIMIT ${n} OFFSET ${i}`;return wU(t,s,n)}const Js=zM(t=>({connections:[],pgServices:[],activeConnectionId:null,isLoading:!1,error:null,fetchConnections:async()=>{t({isLoading:!0,error:null});try{const e=await Zve(),r=e.find(n=>n.isActive);t({connections:e,activeConnectionId:(r==null?void 0:r.id)??null,isLoading:!1})}catch(e){t({error:e.message,isLoading:!1})}},addConnection:async e=>{t({isLoading:!0,error:null});try{const r=await Yve(e);return t(n=>({connections:[...n.connections,r],isLoading:!1})),r}catch(r){throw t({error:r.message,isLoading:!1}),r}},updateConnection:async(e,r)=>{t({isLoading:!0,error:null});try{const n=await Jve(e,r);t(i=>({connections:i.connections.map(s=>s.id===e?n:s),isLoading:!1}))}catch(n){throw t({error:n.message,isLoading:!1}),n}},removeConnection:async e=>{t({isLoading:!0,error:null});try{await ebe(e),t(r=>({connections:r.connections.filter(n=>n.id!==e),activeConnectionId:r.activeConnectionId===e?null:r.activeConnectionId,isLoading:!1}))}catch(r){throw t({error:r.message,isLoading:!1}),r}},setActiveConnection:e=>{t({activeConnectionId:e})},testConnection:async e=>{try{const r=await tbe(e);return{success:r.success,message:r.message}}catch(r){return{success:!1,message:r.message}}},clearError:()=>t({error:null}),refreshPGServices:async()=>{try{const e=await DM();t({pgServices:e})}catch(e){console.error("Failed to fetch PG services:",e)}}})),Er=zM((t,e)=>({expandedNodes:new Set,selectedNode:null,toggleNode:r=>{t(n=>{const i=new Set(n.expandedNodes);return i.has(r)?i.delete(r):i.add(r),{expandedNodes:i}})},expandNode:r=>{t(n=>{const i=new Set(n.expandedNodes);return i.add(r),{expandedNodes:i}})},collapseNode:r=>{t(n=>{const i=new Set(n.expandedNodes);return i.delete(r),{expandedNodes:i}})},selectNode:r=>{t({selectedNode:r})},isExpanded:r=>e().expandedNodes.has(r),clearSelection:()=>{t({selectedNode:null})},reset:()=>{t({expandedNodes:new Set,selectedNode:null})}}));function kf(t,e,r,n){const i=[t];return e&&i.push(e),r&&i.push(r),n&&i.push(n),i.join(":")}function Jbe({onSearchClick:t}){const e=Bt("kartoza.700","gray.800"),r=bt(d=>d.openDialog),n=Js(d=>d.fetchConnections),i=Er(d=>d.selectedNode),s=()=>{r("connection",{mode:"create"})},a=()=>{if(!i){bt.getState().setError("Select a workspace or PostgreSQL service first");return}const d=i.type;if(d==="postgresql"||d==="pgservice"||d==="pgschema"||d==="pgtable"||d==="pgview"||d==="pgcolumn"){const m=i.serviceName,y=d==="pgschema"?i.schemaName:void 0;if(!m){bt.getState().setError("Select a PostgreSQL service first");return}r("pgupload",{mode:"create",data:{serviceName:m,schemaName:y}});return}if(!i.workspace){bt.getState().setError("Select a workspace first");return}r("upload",{mode:"create"})},o=()=>{n(),bt.getState().setStatus("Refreshing...")};return u.jsx(ue,{bg:e,px:4,py:2,children:u.jsxs(yr,{align:"center",children:[u.jsx(pn,{size:"md",color:"white",fontWeight:"bold",children:"Kartoza GeoServer Client"}),u.jsx(ue,{mx:8,flex:"1",maxW:"400px",onClick:t,cursor:"pointer",children:u.jsxs(da,{size:"sm",children:[u.jsx(wl,{pointerEvents:"none",children:u.jsx(Ib,{color:"gray.400"})}),u.jsx(Ar,{placeholder:"Search...",bg:"whiteAlpha.100",border:"1px solid",borderColor:"whiteAlpha.200",color:"white",_placeholder:{color:"whiteAlpha.500"},_hover:{borderColor:"whiteAlpha.400",bg:"whiteAlpha.200"},borderRadius:"md",readOnly:!0,cursor:"pointer"}),u.jsxs(fe,{position:"absolute",right:2,top:"50%",transform:"translateY(-50%)",spacing:1,children:[u.jsx(tu,{size:"xs",bg:"whiteAlpha.200",color:"whiteAlpha.700",borderColor:"whiteAlpha.300",children:""}),u.jsx(tu,{size:"xs",bg:"whiteAlpha.200",color:"whiteAlpha.700",borderColor:"whiteAlpha.300",children:"K"})]})]})}),u.jsx(Zo,{}),u.jsxs(yr,{gap:2,children:[u.jsx(wr,{label:"Add Connection",placement:"bottom",children:u.jsx(gr,{"aria-label":"Add connection",icon:u.jsx(vs,{}),variant:"ghost",color:"white",_hover:{bg:"kartoza.600"},onClick:s})}),u.jsx(wr,{label:(i==null?void 0:i.type)==="postgresql"||(i==null?void 0:i.type)==="pgservice"||(i==null?void 0:i.type)==="pgschema"||(i==null?void 0:i.type)==="pgtable"||(i==null?void 0:i.type)==="pgview"||(i==null?void 0:i.type)==="pgcolumn"?"Upload to PostgreSQL":"Upload to GeoServer",placement:"bottom",children:u.jsx(gr,{"aria-label":"Upload files",icon:u.jsx(Hl,{}),variant:"ghost",color:"white",_hover:{bg:"kartoza.600"},onClick:a})}),u.jsx(wr,{label:"Refresh",placement:"bottom",children:u.jsx(gr,{"aria-label":"Refresh",icon:u.jsx(Su,{}),variant:"ghost",color:"white",_hover:{bg:"kartoza.600"},onClick:o})}),u.jsxs(sf,{children:[u.jsx(of,{as:gr,"aria-label":"Settings",icon:u.jsx(R1,{}),variant:"ghost",color:"white",_hover:{bg:"kartoza.600"}}),u.jsxs(af,{children:[u.jsx(xa,{icon:u.jsx(bve,{}),onClick:()=>r("sync",{mode:"create"}),children:"Sync Server(s)"}),u.jsx(xa,{icon:u.jsx(J7,{}),children:"Help"}),u.jsx(xa,{icon:u.jsx(vs,{}),onClick:()=>r("workspace",{mode:"create"}),children:"New Workspace"}),u.jsx(xa,{icon:u.jsx(vs,{}),onClick:()=>r("datastore",{mode:"create"}),children:"New Data Store"}),u.jsx(xa,{icon:u.jsx(vs,{}),onClick:()=>r("coveragestore",{mode:"create"}),children:"New Coverage Store"})]})]})]})]})})}function fm(t){return ir({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M23.5594 14.7228a.5269.5269 0 0 0-.0563-.1191c-.139-.2632-.4768-.3418-1.0074-.2321-1.6533.3411-2.2935.1312-2.5256-.0191 1.342-2.0482 2.445-4.522 3.0411-6.8297.2714-1.0507.7982-3.5237.1222-4.7316a1.5641 1.5641 0 0 0-.1509-.235C21.6931.9086 19.8007.0248 17.5099.0005c-1.4947-.0158-2.7705.3461-3.1161.4794a9.449 9.449 0 0 0-.5159-.0816 8.044 8.044 0 0 0-1.3114-.1278c-1.1822-.0184-2.2038.2642-3.0498.8406-.8573-.3211-4.7888-1.645-7.2219.0788C.9359 2.1526.3086 3.8733.4302 6.3043c.0409.818.5069 3.334 1.2423 5.7436.4598 1.5065.9387 2.7019 1.4334 3.582.553.9942 1.1259 1.5933 1.7143 1.7895.4474.1491 1.1327.1441 1.8581-.7279.8012-.9635 1.5903-1.8258 1.9446-2.2069.4351.2355.9064.3625 1.39.3772a.0569.0569 0 0 0 .0004.0041 11.0312 11.0312 0 0 0-.2472.3054c-.3389.4302-.4094.5197-1.5002.7443-.3102.064-1.1344.2339-1.1464.8115-.0025.1224.0329.2309.0919.3268.2269.4231.9216.6097 1.015.6331 1.3345.3335 2.5044.092 3.3714-.6787-.017 2.231.0775 4.4174.3454 5.0874.2212.5529.7618 1.9045 2.4692 1.9043.2505 0 .5263-.0291.8296-.0941 1.7819-.3821 2.5557-1.1696 2.855-2.9059.1503-.8707.4016-2.8753.5388-4.1012.0169-.0703.0357-.1207.057-.1362.0007-.0005.0697-.0471.4272.0307a.3673.3673 0 0 0 .0443.0068l.2539.0223.0149.001c.8468.0384 1.9114-.1426 2.5312-.4308.6438-.2988 1.8057-1.0323 1.5951-1.6698zM2.371 11.8765c-.7435-2.4358-1.1779-4.8851-1.2123-5.5719-.1086-2.1714.4171-3.6829 1.5623-4.4927 1.8367-1.2986 4.8398-.5408 6.108-.13-.0032.0032-.0066.0061-.0098.0094-2.0238 2.044-1.9758 5.536-1.9708 5.7495-.0002.0823.0066.1989.0162.3593.0348.5873.0996 1.6804-.0735 2.9184-.1609 1.1504.1937 2.2764.9728 3.0892.0806.0841.1648.1631.2518.2374-.3468.3714-1.1004 1.1926-1.9025 2.1576-.5677.6825-.9597.5517-1.0886.5087-.3919-.1307-.813-.5871-1.2381-1.3223-.4796-.839-.9635-2.0317-1.4155-3.5126zm6.0072 5.0871c-.1711-.0428-.3271-.1132-.4322-.1772.0889-.0394.2374-.0902.4833-.1409 1.2833-.2641 1.4815-.4506 1.9143-1.0002.0992-.126.2116-.2687.3673-.4426a.3549.3549 0 0 0 .0737-.1298c.1708-.1513.2724-.1099.4369-.0417.156.0646.3078.26.3695.4752.0291.1016.0619.2945-.0452.4444-.9043 1.2658-2.2216 1.2494-3.1676 1.0128zm2.094-3.988-.0525.141c-.133.3566-.2567.6881-.3334 1.003-.6674-.0021-1.3168-.2872-1.8105-.8024-.6279-.6551-.9131-1.5664-.7825-2.5004.1828-1.3079.1153-2.4468.079-3.0586-.005-.0857-.0095-.1607-.0122-.2199.2957-.2621 1.6659-.9962 2.6429-.7724.4459.1022.7176.4057.8305.928.5846 2.7038.0774 3.8307-.3302 4.7363-.084.1866-.1633.3629-.2311.5454zm7.3637 4.5725c-.0169.1768-.0358.376-.0618.5959l-.146.4383a.3547.3547 0 0 0-.0182.1077c-.0059.4747-.054.6489-.115.8693-.0634.2292-.1353.4891-.1794 1.0575-.11 1.4143-.8782 2.2267-2.4172 2.5565-1.5155.3251-1.7843-.4968-2.0212-1.2217a6.5824 6.5824 0 0 0-.0769-.2266c-.2154-.5858-.1911-1.4119-.1574-2.5551.0165-.5612-.0249-1.9013-.3302-2.6462.0044-.2932.0106-.5909.019-.8918a.3529.3529 0 0 0-.0153-.1126 1.4927 1.4927 0 0 0-.0439-.208c-.1226-.4283-.4213-.7866-.7797-.9351-.1424-.059-.4038-.1672-.7178-.0869.067-.276.1831-.5875.309-.9249l.0529-.142c.0595-.16.134-.3257.213-.5012.4265-.9476 1.0106-2.2453.3766-5.1772-.2374-1.0981-1.0304-1.6343-2.2324-1.5098-.7207.0746-1.3799.3654-1.7088.5321a5.6716 5.6716 0 0 0-.1958.1041c.0918-1.1064.4386-3.1741 1.7357-4.4823a4.0306 4.0306 0 0 1 .3033-.276.3532.3532 0 0 0 .1447-.0644c.7524-.5706 1.6945-.8506 2.802-.8325.4091.0067.8017.0339 1.1742.081 1.939.3544 3.2439 1.4468 4.0359 2.3827.8143.9623 1.2552 1.9315 1.4312 2.4543-1.3232-.1346-2.2234.1268-2.6797.779-.9926 1.4189.543 4.1729 1.2811 5.4964.1353.2426.2522.4522.2889.5413.2403.5825.5515.9713.7787 1.2552.0696.087.1372.1714.1885.245-.4008.1155-1.1208.3825-1.0552 1.717-.0123.1563-.0423.4469-.0834.8148-.0461.2077-.0702.4603-.0994.7662zm.8905-1.6211c-.0405-.8316.2691-.9185.5967-1.0105a2.8566 2.8566 0 0 0 .135-.0406 1.202 1.202 0 0 0 .1342.103c.5703.3765 1.5823.4213 3.0068.1344-.2016.1769-.5189.3994-.9533.6011-.4098.1903-1.0957.333-1.7473.3636-.7197.0336-1.0859-.0807-1.1721-.151zm.5695-9.2712c-.0059.3508-.0542.6692-.1054 1.0017-.055.3576-.112.7274-.1264 1.1762-.0142.4368.0404.8909.0932 1.3301.1066.887.216 1.8003-.2075 2.7014a3.5272 3.5272 0 0 1-.1876-.3856c-.0527-.1276-.1669-.3326-.3251-.6162-.6156-1.1041-2.0574-3.6896-1.3193-4.7446.3795-.5427 1.3408-.5661 2.1781-.463zm.2284 7.0137a12.3762 12.3762 0 0 0-.0853-.1074l-.0355-.0444c.7262-1.1995.5842-2.3862.4578-3.4385-.0519-.4318-.1009-.8396-.0885-1.2226.0129-.4061.0666-.7543.1185-1.0911.0639-.415.1288-.8443.1109-1.3505.0134-.0531.0188-.1158.0118-.1902-.0457-.4855-.5999-1.938-1.7294-3.253-.6076-.7073-1.4896-1.4972-2.6889-2.0395.5251-.1066 1.2328-.2035 2.0244-.1859 2.0515.0456 3.6746.8135 4.8242 2.2824a.908.908 0 0 1 .0667.1002c.7231 1.3556-.2762 6.2751-2.9867 10.5405zm-8.8166-6.1162c-.025.1794-.3089.4225-.6211.4225a.5821.5821 0 0 1-.0809-.0056c-.1873-.026-.3765-.144-.5059-.3156-.0458-.0605-.1203-.178-.1055-.2844.0055-.0401.0261-.0985.0925-.1488.1182-.0894.3518-.1226.6096-.0867.3163.0441.6426.1938.6113.4186zm7.9305-.4114c.0111.0792-.049.201-.1531.3102-.0683.0717-.212.1961-.4079.2232a.5456.5456 0 0 1-.075.0052c-.2935 0-.5414-.2344-.5607-.3717-.024-.1765.2641-.3106.5611-.352.297-.0414.6111.0088.6356.1851z"},child:[]}]})(t)}function SU(t){switch(t){case"cloudbench":return cve;case"geoserver":return xs;case"postgresql":return fm;case"connection":return ql;case"pgservice":return Wn;case"pgschema":return mh;case"pgtable":return Vo;case"pgview":return Ri;case"pgcolumn":return K7;case"workspace":return mh;case"datastores":case"datastore":return Wn;case"coveragestores":case"coveragestore":return wc;case"layers":case"layer":return hi;case"styles":case"style":return Wo;case"layergroups":case"layergroup":return uf;case"featuretype":return Z7;case"coverage":return Sc;default:return mh}}function kU(t){switch(t){case"cloudbench":return"kartoza.500";case"geoserver":return"blue.500";case"postgresql":return"blue.600";case"connection":return"kartoza.500";case"pgservice":return"blue.500";case"pgschema":return"cyan.500";case"pgtable":return"green.500";case"pgview":return"purple.500";case"pgcolumn":return"gray.500";case"workspace":return"accent.400";case"datastores":case"datastore":return"green.500";case"coveragestores":case"coveragestore":return"purple.500";case"layers":case"layer":return"blue.500";case"styles":case"style":return"pink.500";case"layergroups":case"layergroup":return"cyan.500";case"featuretype":return"teal.500";case"coverage":return"orange.500";default:return"gray.500"}}function e1e(){const t=Js(r=>r.connections),e=Js(r=>r.fetchConnections);return I.useEffect(()=>{e()},[e]),u.jsx(ue,{children:u.jsx(t1e,{connections:t})})}function t1e({connections:t}){const e="cloudbench-root",r=Er(m=>m.isExpanded(e)),n=Er(m=>m.toggleNode),i=Er(m=>m.selectNode),s=Er(m=>m.selectedNode);I.useEffect(()=>{r||n(e)},[]);const a={id:e,name:"Kartoza CloudBench",type:"cloudbench"},o=(s==null?void 0:s.id)===e,d=()=>{i(a),n(e)};return u.jsxs(ue,{children:[u.jsx(Cc,{node:a,isExpanded:r,isSelected:o,isLoading:!1,onClick:d,level:0}),r&&u.jsxs(ue,{pl:4,children:[u.jsx(r1e,{connections:t}),u.jsx(n1e,{})]})]})}function r1e({connections:t}){const e="geoserver-root",r=Er(m=>m.isExpanded(e)),n=Er(m=>m.toggleNode),i=Er(m=>m.selectNode),s=Er(m=>m.selectedNode);I.useEffect(()=>{r||n(e)},[]);const a={id:e,name:"GeoServer",type:"geoserver"},o=(s==null?void 0:s.id)===e,d=()=>{i(a),n(e)};return u.jsxs(ue,{children:[u.jsx(Cc,{node:a,isExpanded:r,isSelected:o,isLoading:!1,onClick:d,level:1,count:t.length}),r&&u.jsx(ue,{pl:4,children:t.length===0?u.jsx(ue,{px:2,py:3,children:u.jsx(J,{color:"gray.500",fontSize:"sm",children:"No connections yet. Click + to add one."})}):t.map(m=>u.jsx(l1e,{connectionId:m.id,name:m.name,url:m.url},m.id))})]})}function n1e(){const t="postgresql-root",e=Er(w=>w.isExpanded(t)),r=Er(w=>w.toggleNode),n=Er(w=>w.selectNode),i=Er(w=>w.selectedNode),s=bt(w=>w.settings.showHiddenPGServices),{data:a,isLoading:o}=Xr({queryKey:["pgservices"],queryFn:()=>DM(),staleTime:3e4}),d=a==null?void 0:a.filter(w=>s||!w.hidden);I.useEffect(()=>{e||r(t)},[]);const m={id:t,name:"PostgreSQL",type:"postgresql"},y=(i==null?void 0:i.id)===t,v=()=>{n(m),r(t)};return u.jsxs(ue,{children:[u.jsx(Cc,{node:m,isExpanded:e,isSelected:y,isLoading:o,onClick:v,level:1,count:d==null?void 0:d.length}),e&&u.jsx(ue,{pl:4,children:!d||d.length===0?u.jsx(ue,{px:2,py:3,children:u.jsx(J,{color:"gray.500",fontSize:"sm",children:"No PostgreSQL services. Click + to add one."})}):d.map(w=>u.jsx(i1e,{service:w},w.name))})]})}function i1e({service:t}){var U;const e=kf("pgservice",t.name),r=Er(X=>X.isExpanded(e)),n=Er(X=>X.toggleNode),i=Er(X=>X.selectNode),s=Er(X=>X.selectedNode),a=bt(X=>X.openDialog),o=Yo(),d=Jo(),{data:m,isLoading:y}=Xr({queryKey:["pgschemas",t.name],queryFn:async()=>{const X=await fetch(`/api/pg/services/${encodeURIComponent(t.name)}/schemas`);if(!X.ok)throw new Error("Failed to fetch schemas");return X.json()},enabled:r&&t.is_parsed,staleTime:6e4}),v={id:e,name:t.name,type:"pgservice",serviceName:t.name},w=(s==null?void 0:s.id)===e,O=()=>{i(v),n(e)},P=async X=>{X.stopPropagation();try{await bU(t.name),o({title:"Schema Parsed",description:`Successfully parsed schema for ${t.name}`,status:"success",duration:3e3}),d.invalidateQueries({queryKey:["pgservices"]}),d.invalidateQueries({queryKey:["pgschemas",t.name]})}catch(ee){o({title:"Parse Failed",description:ee.message,status:"error",duration:5e3})}},E=X=>{X.stopPropagation(),a("confirm",{mode:"delete",title:"Delete PostgreSQL Service",message:`Are you sure you want to remove "${t.name}" from pg_service.conf?`,data:{pgServiceName:t.name}})},$=X=>{X.stopPropagation(),a("query",{mode:"view",data:{serviceName:t.name}})},R=X=>{X.stopPropagation(),a("pgupload",{mode:"create",data:{serviceName:t.name}})},F=X=>{X.stopPropagation(),d.invalidateQueries({queryKey:["pgschemas",t.name]})},D=t.host?`${t.host}:${t.port||"5432"}/${t.dbname||""}`:"";return u.jsxs(ue,{children:[u.jsx(Cc,{node:{...v,name:t.name},isExpanded:r,isSelected:w,isLoading:y,onClick:O,onDelete:E,onQuery:t.is_parsed?$:void 0,onUpload:R,onRefresh:t.is_parsed?F:void 0,level:2,count:(U=m==null?void 0:m.schemas)==null?void 0:U.length}),r&&!t.is_parsed&&u.jsxs(ue,{pl:8,py:2,children:[u.jsx(gt,{size:"sm",colorScheme:"blue",variant:"outline",leftIcon:u.jsx(Wn,{size:14}),onClick:P,children:"Parse Schema"}),u.jsx(J,{fontSize:"xs",color:"gray.500",mt:1,children:D})]}),r&&t.is_parsed&&(m==null?void 0:m.schemas)&&u.jsx(ue,{pl:4,children:m.schemas.map(X=>u.jsx(s1e,{serviceName:t.name,schema:X},X.name))})]})}function s1e({serviceName:t,schema:e}){const r=kf("pgschema",t,e.name),n=Er(P=>P.isExpanded(r)),i=Er(P=>P.toggleNode),s=Er(P=>P.selectNode),a=Er(P=>P.selectedNode),o=bt(P=>P.openDialog),d=Jo(),m={id:r,name:e.name,type:"pgschema",serviceName:t,schemaName:e.name},y=(a==null?void 0:a.id)===r,v=()=>{s(m),i(r)},w=P=>{P.stopPropagation(),o("pgupload",{mode:"create",data:{serviceName:t,schemaName:e.name}})},O=P=>{P.stopPropagation(),d.invalidateQueries({queryKey:["pgschemas",t]})};return u.jsxs(ue,{children:[u.jsx(Cc,{node:m,isExpanded:n,isSelected:y,isLoading:!1,onClick:v,onUpload:w,onRefresh:O,level:3,count:e.tables.length}),n&&u.jsx(ue,{pl:4,children:e.tables.map(P=>u.jsx(o1e,{serviceName:t,schemaName:e.name,table:P},P.name))})]})}function o1e({serviceName:t,schemaName:e,table:r}){const n=r.is_view?"pgview":"pgtable",i=kf(n,t,e,r.name),s=Er(E=>E.isExpanded(i)),a=Er(E=>E.toggleNode),o=Er(E=>E.selectNode),d=Er(E=>E.selectedNode),m=bt(E=>E.openDialog),y={id:i,name:r.name,type:n,serviceName:t,schemaName:e,tableName:r.name},v=(d==null?void 0:d.id)===i,w=()=>{o(y),a(i)},O=E=>{E.stopPropagation(),m("dataviewer",{mode:"view",data:{serviceName:t,schemaName:e,tableName:r.name,isView:r.is_view}})},P=E=>{E.stopPropagation(),m("query",{mode:"view",data:{serviceName:t,schemaName:e,tableName:r.name,initialSQL:`SELECT * FROM "${e}"."${r.name}" LIMIT 100`}})};return u.jsxs(ue,{children:[u.jsx(Cc,{node:y,isExpanded:s,isSelected:v,isLoading:!1,onClick:w,level:4,count:r.columns.length,onShowData:O,onQuery:P}),s&&u.jsx(ue,{pl:4,children:r.columns.map(E=>u.jsx(a1e,{serviceName:t,schemaName:e,tableName:r.name,column:E},E.name))})]})}function a1e({serviceName:t,schemaName:e,tableName:r,column:n}){const i=kf("pgcolumn",t,e,`${r}:${n.name}`),s=Er(y=>y.selectNode),a=Er(y=>y.selectedNode),o={id:i,name:`${n.name} (${n.type}${n.nullable?", nullable":""})`,type:"pgcolumn",serviceName:t,schemaName:e,tableName:r},d=(a==null?void 0:a.id)===i,m=()=>{s(o)};return u.jsx(Cc,{node:o,isExpanded:!1,isSelected:d,isLoading:!1,onClick:m,level:5,isLeaf:!0})}function l1e({connectionId:t,name:e,url:r}){const n=kf("connection",t),i=Er(R=>R.isExpanded(n)),s=Er(R=>R.toggleNode),a=Er(R=>R.selectNode),o=Er(R=>R.selectedNode),d=bt(R=>R.openDialog),{data:m,isLoading:y}=Xr({queryKey:["workspaces",t],queryFn:()=>aU(t),staleTime:3e4}),v={id:n,name:e,type:"connection",connectionId:t},w=(o==null?void 0:o.id)===n,O=()=>{a(v),s(n)},P=R=>{R.stopPropagation(),d("connection",{mode:"edit",data:{connectionId:t}})},E=R=>{R.stopPropagation(),d("confirm",{mode:"delete",title:"Delete Connection",message:`Are you sure you want to delete connection "${e}"?`,data:{connectionId:t}})},$=R=>{R.stopPropagation();const F=r.replace(/\/rest\/?$/,"/web");window.open(F,"_blank","noopener,noreferrer")};return u.jsxs(ue,{children:[u.jsx(Cc,{node:v,isExpanded:i,isSelected:w,isLoading:y,onClick:O,onEdit:P,onDelete:E,onOpenAdmin:$,level:2,count:m==null?void 0:m.length}),i&&m&&u.jsx(ue,{pl:4,children:m.map(R=>u.jsx(c1e,{connectionId:t,workspace:R.name},R.name))})]})}function c1e({connectionId:t,workspace:e}){const r=kf("workspace",t,e),n=Er(P=>P.isExpanded(r)),i=Er(P=>P.toggleNode),s=Er(P=>P.selectNode),a=Er(P=>P.selectedNode),o=bt(P=>P.openDialog),d={id:r,name:e,type:"workspace",connectionId:t,workspace:e},m=(a==null?void 0:a.id)===r,y=()=>{s(d),i(r)},v=P=>{P.stopPropagation(),o("workspace",{mode:"edit",data:{connectionId:t,workspace:e}})},w=P=>{P.stopPropagation(),o("confirm",{mode:"delete",title:"Delete Workspace",message:`Are you sure you want to delete workspace "${e}"?`,data:{connectionId:t,workspace:e}})},O=P=>{P.stopPropagation(),xU(t,"workspace",e)};return u.jsxs(ue,{children:[u.jsx(Cc,{node:d,isExpanded:n,isSelected:m,isLoading:!1,onClick:y,onEdit:v,onDownloadConfig:O,onDelete:w,level:3}),n&&u.jsxs(ue,{pl:4,children:[u.jsx(Qx,{connectionId:t,workspace:e,category:"datastores",label:"Data Stores"}),u.jsx(Qx,{connectionId:t,workspace:e,category:"coveragestores",label:"Coverage Stores"}),u.jsx(Qx,{connectionId:t,workspace:e,category:"layers",label:"Layers"}),u.jsx(Qx,{connectionId:t,workspace:e,category:"styles",label:"Styles"}),u.jsx(Qx,{connectionId:t,workspace:e,category:"layergroups",label:"Layer Groups"})]})]})}function Qx({connectionId:t,workspace:e,category:r,label:n}){const i=kf(r,t,e),s=Er(E=>E.isExpanded(i)),a=Er(E=>E.toggleNode),o=Er(E=>E.selectNode),d=Er(E=>E.selectedNode),{data:m,isLoading:y}=Xr({queryKey:[r,t,e],queryFn:async()=>{switch(r){case"datastores":return MM(t,e);case"coveragestores":return IM(t,e);case"layers":return D1(t,e);case"styles":return RM(t,e);case"layergroups":return gU(t,e)}},staleTime:3e4}),v={id:i,name:n,type:r,connectionId:t,workspace:e},w=(d==null?void 0:d.id)===i,O=()=>{o(v),a(i)},P=()=>{switch(r){case"datastores":return"datastore";case"coveragestores":return"coveragestore";case"layers":return"layer";case"styles":return"style";case"layergroups":return"layergroup"}};return u.jsxs(ue,{children:[u.jsx(Cc,{node:v,isExpanded:s,isSelected:w,isLoading:y,onClick:O,level:4,count:m==null?void 0:m.length}),s&&m&&u.jsx(ue,{pl:4,children:m.map(E=>u.jsx(u1e,{connectionId:t,workspace:e,name:E.name,type:P(),storeType:r==="coveragestores"?"coveragestore":r==="datastores"?"datastore":void 0},E.name))})]})}function u1e({connectionId:t,workspace:e,name:r,type:n,storeType:i}){const s=kf(n,t,e,r),a=Er(Oe=>Oe.isExpanded(s)),o=Er(Oe=>Oe.toggleNode),d=Er(Oe=>Oe.selectNode),m=Er(Oe=>Oe.selectedNode),y=bt(Oe=>Oe.openDialog),v=bt(Oe=>Oe.setPreview),w=bt(Oe=>Oe.setPreviewMode),O=n==="datastore"||n==="coveragestore",{data:P,isLoading:E,error:$}=Xr({queryKey:["featuretypes",t,e,r],queryFn:()=>vbe(t,e,r),enabled:O&&n==="datastore"&&a,staleTime:3e4}),{data:R,isLoading:F,error:D}=Xr({queryKey:["coverages",t,e,r],queryFn:()=>_be(t,e,r),enabled:O&&n==="coveragestore"&&a,staleTime:3e4}),{data:U,error:X}=Xr({queryKey:["available-featuretypes",t,e,r],queryFn:()=>uU(t,e,r),enabled:O&&n==="datastore"&&a,staleTime:3e4}),ee=(m==null?void 0:m.id)===s,{data:K}=Xr({queryKey:["feature-count",t,e,r],queryFn:()=>ube(t,e,r),enabled:n==="layer"&&ee,staleTime:5*60*1e3,gcTime:10*60*1e3,retry:!1});$&&console.error("Feature types error:",$),D&&console.error("Coverages error:",D),X&&console.error("Available feature types error:",X);const Y={id:s,name:r,type:n,connectionId:t,workspace:e,storeName:n==="layer"?void 0:r,storeType:i},ne=E||F,oe=()=>{d(Y),O&&o(s)},ce=Oe=>{Oe.stopPropagation();const Ie=i==="coveragestore"?"raster":"vector";il({connId:t,workspace:e,layerName:r,storeName:r,storeType:i,layerType:Ie}).then(({url:st})=>{v({url:st,layerName:r,workspace:e,connectionId:t,storeName:r,storeType:i,layerType:Ie})}).catch(st=>{bt.getState().setError(st.message)})},Xe=Oe=>{Oe.stopPropagation();const Ie=i==="coveragestore"?"raster":"vector";w("3d"),v({url:"",layerName:r,workspace:e,connectionId:t,storeName:r,storeType:i,layerType:Ie,nodeType:n})},Ae=async Oe=>{var Ie;if(Oe.stopPropagation(),n==="style")y("style",{mode:"edit",data:{connectionId:t,workspace:e,name:r}});else if(n==="layer")y("layer",{mode:"edit",data:{connectionId:t,workspace:e,layerName:r,storeType:i}});else if(n==="layergroup")try{const st=await yU(t,e,r),Re=((Ie=st.layers)==null?void 0:Ie.map(it=>{const Ke=it.name.split(":");return Ke.length>1?Ke[1]:it.name}))||[];y("layergroup",{mode:"edit",data:{connectionId:t,workspace:e,name:st.name,title:st.title||"",mode:st.mode,layers:Re}})}catch(st){bt.getState().setError(st.message)}},We=Oe=>{Oe.stopPropagation(),y("confirm",{mode:"delete",title:`Delete ${n}`,message:`Are you sure you want to delete "${r}"?`,data:{connectionId:t,workspace:e,name:r,type:n}})},Ye=Oe=>{Oe.stopPropagation();const st={datastore:"datastore",coveragestore:"coveragestore",layer:"layer",style:"style",layergroup:"layergroup"}[n];st&&xU(t,st,e,r)},tt=Oe=>{Oe.stopPropagation(),n==="layer"||i==="datastore"?Fbe(t,e,r):i==="coveragestore"&&Bbe(t,e,r)},Be=["datastore","coveragestore","layer","style","layergroup"].includes(n),Me=n==="layer",Ge=i==="coveragestore"?"GeoTIFF":"Shapefile",De=n==="style"||n==="layer"||n==="layergroup",Le=n==="datastore"?((P==null?void 0:P.length)||0)+((U==null?void 0:U.length)||0):n==="coveragestore"?R==null?void 0:R.length:n==="layer"&&K!==void 0&&K>=0?K:void 0;return u.jsxs(ue,{children:[u.jsx(Cc,{node:Y,isExpanded:a,isSelected:ee,isLoading:ne,onClick:oe,onEdit:De?Ae:void 0,onPreview:n==="layer"||n==="datastore"||n==="coveragestore"?ce:void 0,onTerria:n==="layer"||n==="layergroup"?Xe:void 0,onDownloadConfig:Be?Ye:void 0,onDownloadData:Me?tt:void 0,downloadDataLabel:Ge,onDelete:We,level:5,isLeaf:!O,count:Le}),a&&n==="datastore"&&u.jsx(ue,{pl:4,children:$?u.jsxs(J,{fontSize:"xs",color:"red.500",px:2,py:2,children:["Error loading datasets: ",$.message]}):u.jsx(h1e,{connectionId:t,workspace:e,storeName:r,featureTypes:P||[],availableFeatureTypes:U||[]})}),a&&n==="coveragestore"&&u.jsx(ue,{pl:4,children:D?u.jsxs(J,{fontSize:"xs",color:"red.500",px:2,py:2,children:["Error loading coverages: ",D.message]}):u.jsx(d1e,{connectionId:t,workspace:e,storeName:r,coverages:R||[]})})]})}function h1e({connectionId:t,workspace:e,storeName:r,featureTypes:n,availableFeatureTypes:i}){const s=Yo(),a=Jo(),[o,d]=I.useState(new Set),[m,y]=I.useState(!1),v=bt(D=>D.setPreview),w=D=>{const U=new Set(o);U.has(D)?U.delete(D):U.add(D),d(U)},O=()=>{d(new Set(i))},P=async()=>{if(o.size!==0){y(!0);try{const D=await hU(t,e,r,Array.from(o));D.published.length>0&&(s({title:"Layers Published",description:`Successfully published ${D.published.length} layer(s)`,status:"success",duration:3e3}),a.invalidateQueries({queryKey:["featuretypes",t,e,r]}),a.invalidateQueries({queryKey:["available-featuretypes",t,e,r]}),a.invalidateQueries({queryKey:["layers",t,e]}),d(new Set)),D.errors.length>0&&s({title:"Some layers failed to publish",description:D.errors.join(", "),status:"warning",duration:5e3})}catch(D){s({title:"Failed to publish layers",description:D instanceof Error?D.message:"Unknown error",status:"error",duration:5e3})}finally{y(!1)}}},E=async D=>{try{await bbe(t,e,r,D),s({title:"Layer Published",description:`Successfully published ${D}`,status:"success",duration:3e3}),a.invalidateQueries({queryKey:["featuretypes",t,e,r]}),a.invalidateQueries({queryKey:["available-featuretypes",t,e,r]}),a.invalidateQueries({queryKey:["layers",t,e]})}catch(U){s({title:"Failed to publish layer",description:U instanceof Error?U.message:"Unknown error",status:"error",duration:5e3})}},$=D=>{il({connId:t,workspace:e,layerName:D,storeName:r,storeType:"datastore",layerType:"vector"}).then(({url:U})=>{v({url:U,layerName:D,workspace:e,connectionId:t,storeName:r,storeType:"datastore",layerType:"vector"})}).catch(U=>{s({title:"Preview failed",description:U.message,status:"error",duration:3e3})})},R=Bt("yellow.50","yellow.900"),F=Bt("green.50","green.900");return u.jsxs(ue,{children:[n.length>0&&u.jsxs(ue,{mb:2,children:[u.jsxs(J,{fontSize:"xs",fontWeight:"600",color:"gray.500",px:2,py:1,children:["Published (",n.length,")"]}),n.map(D=>u.jsx(HA,{name:D.name,isPublished:!0,bg:F,onPreview:()=>$(D.name)},D.name))]}),i.length>0&&u.jsxs(ue,{children:[u.jsxs(yr,{align:"center",justify:"space-between",px:2,py:1,children:[u.jsxs(J,{fontSize:"xs",fontWeight:"600",color:"gray.500",children:["Available to Publish (",i.length,")"]}),u.jsxs(yr,{gap:1,children:[u.jsx(gt,{size:"xs",variant:"ghost",onClick:O,isDisabled:o.size===i.length,children:"Select All"}),o.size>0&&u.jsxs(gt,{size:"xs",colorScheme:"kartoza",leftIcon:u.jsx(Hl,{size:12}),onClick:P,isLoading:m,children:["Publish (",o.size,")"]})]})]}),i.map(D=>u.jsx(HA,{name:D,isPublished:!1,bg:R,isSelected:o.has(D),onToggleSelect:()=>w(D),onPublish:()=>E(D)},D))]}),n.length===0&&i.length===0&&u.jsx(J,{fontSize:"xs",color:"gray.500",px:2,py:2,fontStyle:"italic",children:"No datasets in this store"})]})}function d1e({connectionId:t,workspace:e,storeName:r,coverages:n}){const i=bt(d=>d.setPreview),s=Yo(),a=d=>{il({connId:t,workspace:e,layerName:d,storeName:r,storeType:"coveragestore",layerType:"raster"}).then(({url:m})=>{i({url:m,layerName:d,workspace:e,connectionId:t,storeName:r,storeType:"coveragestore",layerType:"raster"})}).catch(m=>{s({title:"Preview failed",description:m.message,status:"error",duration:3e3})})},o=Bt("purple.50","purple.900");return u.jsxs(ue,{children:[n.length>0&&u.jsxs(ue,{children:[u.jsxs(J,{fontSize:"xs",fontWeight:"600",color:"gray.500",px:2,py:1,children:["Coverages (",n.length,")"]}),n.map(d=>u.jsx(HA,{name:d.name,isPublished:!0,isCoverage:!0,bg:o,onPreview:()=>a(d.name)},d.name))]}),n.length===0&&u.jsx(J,{fontSize:"xs",color:"gray.500",px:2,py:2,fontStyle:"italic",children:"No coverages in this store"})]})}function HA({name:t,isPublished:e,isCoverage:r=!1,bg:n,isSelected:i,onToggleSelect:s,onPublish:a,onPreview:o}){const d=Bt("gray.100","gray.600"),m=r?"coverage":"featuretype",y=SU(m),v=kU(m);return u.jsxs(yr,{align:"center",py:1.5,px:2,pl:6,bg:n,_hover:{bg:d},borderRadius:"md",mx:1,my:.5,role:"group",children:[!e&&s&&u.jsx(Ga,{size:"sm",isChecked:i,onChange:s,mr:2,colorScheme:"kartoza"}),u.jsx(ue,{p:1,borderRadius:"md",mr:2,children:u.jsx(ze,{as:y,boxSize:3.5,color:v})}),u.jsx(J,{flex:"1",fontSize:"sm",noOfLines:1,children:t}),e&&u.jsx(Qt,{colorScheme:"green",fontSize:"2xs",mr:2,children:"Published"}),u.jsxs(yr,{gap:1,opacity:0,_groupHover:{opacity:1},transition:"opacity 0.15s",children:[o&&u.jsx(wr,{label:"Preview",fontSize:"xs",children:u.jsx(gr,{"aria-label":"Preview",icon:u.jsx(Ri,{size:12}),size:"xs",variant:"ghost",colorScheme:"kartoza",onClick:w=>{w.stopPropagation(),o()}})}),!e&&a&&u.jsx(wr,{label:"Publish as Layer",fontSize:"xs",children:u.jsx(gr,{"aria-label":"Publish",icon:u.jsx(vs,{size:12}),size:"xs",variant:"ghost",colorScheme:"green",onClick:w=>{w.stopPropagation(),a()}})})]})]})}function Cc({node:t,isExpanded:e,isSelected:r,isLoading:n,onClick:i,onEdit:s,onDelete:a,onPreview:o,onTerria:d,onOpenAdmin:m,onQuery:y,onShowData:v,onUpload:w,onRefresh:O,onDownloadConfig:P,onDownloadData:E,downloadDataLabel:$,level:R,isLeaf:F,count:D}){const U=Bt(r?"kartoza.50":"transparent",r?"kartoza.900":"transparent"),X=Bt("gray.50","gray.700"),ee=Bt("gray.800","gray.100"),K=Bt("kartoza.700","kartoza.200"),Y=Bt("kartoza.500","kartoza.400"),ne=Bt("gray.500","gray.400"),oe=kU(t.type),ce=SU(t.type);return u.jsxs(yr,{align:"center",py:2,px:2,pl:R*4+2,cursor:"pointer",bg:U,borderLeft:r?"3px solid":"3px solid transparent",borderLeftColor:r?Y:"transparent",_hover:{bg:r?U:X,"& .chevron-icon":{color:"kartoza.500"}},borderRadius:"md",transition:"all 0.15s ease",onClick:i,role:"group",mx:1,my:.5,children:[!F&&u.jsx(ue,{w:4,mr:2,color:ne,className:"chevron-icon",transition:"color 0.15s",children:n?u.jsx(kn,{size:"xs",color:"kartoza.500"}):e?u.jsx(Ul,{size:14}):u.jsx(X7,{size:14})}),F&&u.jsx(ue,{w:4,mr:2}),u.jsx(ue,{p:1.5,borderRadius:"md",bg:r?`${oe.split(".")[0]}.100`:"transparent",mr:2,transition:"background 0.15s",_groupHover:{bg:`${oe.split(".")[0]}.50`},children:u.jsx(ze,{as:ce,boxSize:4,color:oe})}),u.jsx(J,{flex:"1",fontSize:"sm",color:r?K:ee,fontWeight:r?"600":"normal",noOfLines:1,letterSpacing:r?"-0.01em":"normal",children:t.name}),D!==void 0&&D>=0&&u.jsx(Qt,{colorScheme:oe.split(".")[0],variant:"subtle",fontSize:"xs",borderRadius:"full",px:2,mr:2,fontWeight:"600",children:D}),m&&u.jsx(wr,{label:"Open GeoServer Admin",fontSize:"xs",children:u.jsx(gr,{"aria-label":"Open Admin",icon:u.jsx(dve,{size:14}),size:"xs",variant:"ghost",colorScheme:"blue",onClick:m,_hover:{bg:"blue.50"},mr:1})}),u.jsxs(yr,{gap:1,opacity:0,_groupHover:{opacity:1},transition:"opacity 0.15s",children:[(P||E)&&u.jsxs(sf,{isLazy:!0,placement:"bottom-end",children:[u.jsx(wr,{label:"Download",fontSize:"xs",children:u.jsx(of,{as:gr,"aria-label":"Download",icon:u.jsx(gy,{size:14}),size:"xs",variant:"ghost",colorScheme:"kartoza",onClick:Xe=>Xe.stopPropagation(),_hover:{bg:"kartoza.100"}})}),u.jsxs(af,{minW:"180px",fontSize:"sm",children:[P&&u.jsx(xa,{icon:u.jsx(Z7,{}),onClick:P,children:"Download Config (JSON)"}),E&&u.jsxs(xa,{icon:u.jsx(Sc,{}),onClick:E,children:["Download ",$||"Data"]})]})]}),o&&u.jsx(wr,{label:"Preview",fontSize:"xs",children:u.jsx(gr,{"aria-label":"Preview",icon:u.jsx(Ri,{size:14}),size:"xs",variant:"ghost",colorScheme:"kartoza",onClick:o,_hover:{bg:"kartoza.100"}})}),O&&u.jsx(wr,{label:"Refresh",fontSize:"xs",children:u.jsx(gr,{"aria-label":"Refresh",icon:u.jsx(Su,{size:14}),size:"xs",variant:"ghost",colorScheme:"cyan",onClick:O,_hover:{bg:"cyan.50"}})}),w&&u.jsx(wr,{label:"Import Data",fontSize:"xs",children:u.jsx(gr,{"aria-label":"Import Data",icon:u.jsx(Hl,{size:14}),size:"xs",variant:"ghost",colorScheme:"green",onClick:w,_hover:{bg:"green.50"}})}),v&&u.jsx(wr,{label:"View Data",fontSize:"xs",children:u.jsx(gr,{"aria-label":"View Data",icon:u.jsx(Vo,{size:14}),size:"xs",variant:"ghost",colorScheme:"blue",onClick:v,_hover:{bg:"blue.50"}})}),y&&u.jsx(wr,{label:"Query",fontSize:"xs",children:u.jsx(gr,{"aria-label":"Query",icon:u.jsx(Ml,{size:14}),size:"xs",variant:"ghost",colorScheme:"purple",onClick:y,_hover:{bg:"purple.50"}})}),d&&u.jsx(wr,{label:"Open in Terria 3D",fontSize:"xs",children:u.jsx(gr,{"aria-label":"Open in Terria 3D",icon:u.jsx(xs,{size:14}),size:"xs",variant:"ghost",colorScheme:"teal",onClick:d,_hover:{bg:"teal.50"}})}),s&&u.jsx(wr,{label:"Edit",fontSize:"xs",children:u.jsx(gr,{"aria-label":"Edit",icon:u.jsx(hve,{size:14}),size:"xs",variant:"ghost",colorScheme:"kartoza",onClick:s,_hover:{bg:"kartoza.100"}})}),a&&u.jsx(wr,{label:"Delete",fontSize:"xs",children:u.jsx(gr,{"aria-label":"Delete",icon:u.jsx(Xd,{size:14}),size:"xs",variant:"ghost",colorScheme:"red",onClick:a,_hover:{bg:"red.50"}})})]})]})}function f1e(){const t=Bt("gray.100","gray.700");return u.jsxs(ue,{h:"100%",children:[u.jsx(ue,{bg:t,px:3,py:2,children:u.jsx(pn,{size:"sm",color:"gray.700",children:"GeoServer Explorer"})}),u.jsx(ue,{p:2,children:u.jsx(e1e,{})})]})}function p1e(){const t=Bt("gray.100","gray.800"),e=Bt("gray.200","gray.700"),r=bt(y=>y.statusMessage),n=bt(y=>y.errorMessage),i=bt(y=>y.successMessage),s=bt(y=>y.setError),a=bt(y=>y.setSuccess),o=Js(y=>y.connections),d=Js(y=>y.activeConnectionId),m=o.find(y=>y.id===d);return u.jsxs(ue,{children:[n&&u.jsxs(io,{status:"error",variant:"solid",children:[u.jsx(so,{}),u.jsx(J,{flex:"1",children:n}),u.jsx(kb,{onClick:()=>s(null)})]}),i&&u.jsxs(io,{status:"success",variant:"solid",children:[u.jsx(so,{}),u.jsx(J,{flex:"1",children:i}),u.jsx(kb,{onClick:()=>a(null)})]}),u.jsx(ue,{bg:t,borderTop:"1px",borderColor:e,px:4,py:1,children:u.jsxs(yr,{justify:"space-between",align:"center",children:[u.jsx(J,{fontSize:"sm",color:"gray.600",children:r}),u.jsxs(yr,{gap:4,children:[u.jsxs(J,{fontSize:"sm",color:"gray.600",children:["Connections: ",o.length]}),m&&u.jsxs(J,{fontSize:"sm",color:"kartoza.500",fontWeight:"medium",children:["Active: ",m.name]})]})]})})]})}function m1e({children:t,onSearchClick:e}){const r=bt(w=>w.sidebarWidth),n=bt(w=>w.setSidebarWidth),i=Bt("gray.50","gray.900"),s=Bt("gray.200","gray.700"),a=Bt("gray.300","gray.600"),o=Bt("kartoza.400","kartoza.500"),[d,m]=I.useState(!1),y=I.useRef(null),v=I.useCallback(w=>{w.preventDefault(),m(!0);const O=E=>{if(y.current){const $=y.current.getBoundingClientRect(),R=E.clientX-$.left;n(R)}},P=()=>{m(!1),document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",P),document.body.style.cursor="",document.body.style.userSelect=""};document.addEventListener("mousemove",O),document.addEventListener("mouseup",P),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},[n]);return u.jsxs(yr,{direction:"column",h:"100vh",bg:i,children:[u.jsx(Jbe,{onSearchClick:e}),u.jsxs(yr,{flex:"1",overflow:"hidden",ref:y,children:[u.jsx(ue,{w:`${r}px`,borderRight:"1px",borderColor:s,overflow:"auto",flexShrink:0,position:"relative",children:u.jsx(f1e,{})}),u.jsx(ue,{w:"6px",cursor:"col-resize",bg:d?o:"transparent",_hover:{bg:o},transition:"background 0.15s",flexShrink:0,position:"relative",onMouseDown:v,ml:"-3px",zIndex:10,children:u.jsx(ue,{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",h:"40px",w:"4px",borderRadius:"full",bg:d?"white":a,opacity:d?1:0,_groupHover:{opacity:.8},transition:"opacity 0.15s",sx:{"[data-resize-handle]:hover &":{opacity:.8}}})}),u.jsx(ue,{flex:"1",overflow:"auto",p:4,display:"flex",flexDirection:"column",children:t})]}),u.jsx(p1e,{})]})}var CU={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(t,e){(function(r,n){t.exports=n()})(Jx,function(){var r={},n={};function i(a,o,d){if(n[a]=d,a==="index"){var m="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",y={};return n.shared(y),n.index(r,y),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([m],{type:"text/javascript"}))),r}}i("shared",["exports"],function(a){function o(h,c,f,g){return new(f||(f=Promise))(function(_,C){function T(B){try{z(g.next(B))}catch(N){C(N)}}function j(B){try{z(g.throw(B))}catch(N){C(N)}}function z(B){var N;B.done?_(B.value):(N=B.value,N instanceof f?N:new f(function(q){q(N)})).then(T,j)}z((g=g.apply(h,c||[])).next())})}function d(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}typeof SuppressedError=="function"&&SuppressedError;var m=y;function y(h,c){this.x=h,this.y=c}y.prototype={clone:function(){return new y(this.x,this.y)},add:function(h){return this.clone()._add(h)},sub:function(h){return this.clone()._sub(h)},multByPoint:function(h){return this.clone()._multByPoint(h)},divByPoint:function(h){return this.clone()._divByPoint(h)},mult:function(h){return this.clone()._mult(h)},div:function(h){return this.clone()._div(h)},rotate:function(h){return this.clone()._rotate(h)},rotateAround:function(h,c){return this.clone()._rotateAround(h,c)},matMult:function(h){return this.clone()._matMult(h)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(h){return this.x===h.x&&this.y===h.y},dist:function(h){return Math.sqrt(this.distSqr(h))},distSqr:function(h){var c=h.x-this.x,f=h.y-this.y;return c*c+f*f},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith:function(h){return this.angleWithSep(h.x,h.y)},angleWithSep:function(h,c){return Math.atan2(this.x*c-this.y*h,this.x*h+this.y*c)},_matMult:function(h){var c=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=c,this},_add:function(h){return this.x+=h.x,this.y+=h.y,this},_sub:function(h){return this.x-=h.x,this.y-=h.y,this},_mult:function(h){return this.x*=h,this.y*=h,this},_div:function(h){return this.x/=h,this.y/=h,this},_multByPoint:function(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint:function(h){return this.x/=h.x,this.y/=h.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var h=this.y;return this.y=this.x,this.x=-h,this},_rotate:function(h){var c=Math.cos(h),f=Math.sin(h),g=f*this.x+c*this.y;return this.x=c*this.x-f*this.y,this.y=g,this},_rotateAround:function(h,c){var f=Math.cos(h),g=Math.sin(h),_=c.y+g*(this.x-c.x)+f*(this.y-c.y);return this.x=c.x+f*(this.x-c.x)-g*(this.y-c.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},y.convert=function(h){return h instanceof y?h:Array.isArray(h)?new y(h[0],h[1]):h};var v=d(m),w=O;function O(h,c,f,g){this.cx=3*h,this.bx=3*(f-h)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(g-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=h,this.p1y=c,this.p2x=f,this.p2y=g}O.prototype={sampleCurveX:function(h){return((this.ax*h+this.bx)*h+this.cx)*h},sampleCurveY:function(h){return((this.ay*h+this.by)*h+this.cy)*h},sampleCurveDerivativeX:function(h){return(3*this.ax*h+2*this.bx)*h+this.cx},solveCurveX:function(h,c){if(c===void 0&&(c=1e-6),h<0)return 0;if(h>1)return 1;for(var f=h,g=0;g<8;g++){var _=this.sampleCurveX(f)-h;if(Math.abs(_)<c)return f;var C=this.sampleCurveDerivativeX(f);if(Math.abs(C)<1e-6)break;f-=_/C}var T=0,j=1;for(f=h,g=0;g<20&&(_=this.sampleCurveX(f),!(Math.abs(_-h)<c));g++)h>_?T=f:j=f,f=.5*(j-T)+T;return f},solve:function(h,c){return this.sampleCurveY(this.solveCurveX(h,c))}};var P=d(w);let E,$;function R(){return E==null&&(E=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),E}function F(){if($==null&&($=!1,R())){const c=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(c){for(let g=0;g<5*5;g++){const _=4*g;c.fillStyle=`rgb(${_},${_+1},${_+2})`,c.fillRect(g%5,Math.floor(g/5),1,1)}const f=c.getImageData(0,0,5,5).data;for(let g=0;g<5*5*4;g++)if(g%4!=3&&f[g]!==g){$=!0;break}}}return $||!1}function D(h,c,f,g){const _=new P(h,c,f,g);return C=>_.solve(C)}const U=D(.25,.1,.25,1);function X(h,c,f){return Math.min(f,Math.max(c,h))}function ee(h,c,f){const g=f-c,_=((h-c)%g+g)%g+c;return _===c?f:_}function K(h,...c){for(const f of c)for(const g in f)h[g]=f[g];return h}let Y=1;function ne(h,c,f){const g={};for(const _ in h)g[_]=c.call(this,h[_],_,h);return g}function oe(h,c,f){const g={};for(const _ in h)c.call(this,h[_],_,h)&&(g[_]=h[_]);return g}function ce(h){return Array.isArray(h)?h.map(ce):typeof h=="object"&&h?ne(h,ce):h}const Xe={};function Ae(h){Xe[h]||(typeof console<"u"&&console.warn(h),Xe[h]=!0)}function We(h,c,f){return(f.y-h.y)*(c.x-h.x)>(c.y-h.y)*(f.x-h.x)}function Ye(h){return typeof WorkerGlobalScope<"u"&&h!==void 0&&h instanceof WorkerGlobalScope}let tt=null;function Be(h){return typeof ImageBitmap<"u"&&h instanceof ImageBitmap}const Me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ge(h,c,f,g,_){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const C=new VideoFrame(h,{timestamp:0});try{const T=C==null?void 0:C.format;if(!T||!T.startsWith("BGR")&&!T.startsWith("RGB"))throw new Error(`Unrecognized format ${T}`);const j=T.startsWith("BGR"),z=new Uint8ClampedArray(g*_*4);if(yield C.copyTo(z,function(B,N,q,Z,re){const se=4*Math.max(-N,0),ae=(Math.max(0,q)-q)*Z*4+se,me=4*Z,we=Math.max(0,N),Ze=Math.max(0,q);return{rect:{x:we,y:Ze,width:Math.min(B.width,N+Z)-we,height:Math.min(B.height,q+re)-Ze},layout:[{offset:ae,stride:me}]}}(h,c,f,g,_)),j)for(let B=0;B<z.length;B+=4){const N=z[B];z[B]=z[B+2],z[B+2]=N}return z}finally{C.close()}})}let De,Le;const Oe="AbortError";function Ie(){return new Error(Oe)}const st={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Re(h){return st.REGISTERED_PROTOCOLS[h.substring(0,h.indexOf("://"))]}const it="global-dispatcher";class Ke extends Error{constructor(c,f,g,_){super(`AJAXError: ${f} (${c}): ${g}`),this.status=c,this.statusText=f,this.url=g,this.body=_}}const St=()=>Ye(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Mt=function(h,c){if(/:\/\//.test(h.url)&&!/^https?:|^file:/.test(h.url)){const g=Re(h.url);if(g)return g(h,c);if(Ye(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,targetMapId:it},c)}if(!(/^file:/.test(f=h.url)||/^file:/.test(St())&&!/^\w+:/.test(f))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(g,_){return o(this,void 0,void 0,function*(){const C=new Request(g.url,{method:g.method||"GET",body:g.body,credentials:g.credentials,headers:g.headers,cache:g.cache,referrer:St(),signal:_.signal});g.type!=="json"||C.headers.has("Accept")||C.headers.set("Accept","application/json");const T=yield fetch(C);if(!T.ok){const B=yield T.blob();throw new Ke(T.status,T.statusText,g.url,B)}let j;j=g.type==="arrayBuffer"||g.type==="image"?T.arrayBuffer():g.type==="json"?T.json():T.text();const z=yield j;if(_.signal.aborted)throw Ie();return{data:z,cacheControl:T.headers.get("Cache-Control"),expires:T.headers.get("Expires")}})}(h,c);if(Ye(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,mustQueue:!0,targetMapId:it},c)}var f;return function(g,_){return new Promise((C,T)=>{var j;const z=new XMLHttpRequest;z.open(g.method||"GET",g.url,!0),g.type!=="arrayBuffer"&&g.type!=="image"||(z.responseType="arraybuffer");for(const B in g.headers)z.setRequestHeader(B,g.headers[B]);g.type==="json"&&(z.responseType="text",!((j=g.headers)===null||j===void 0)&&j.Accept||z.setRequestHeader("Accept","application/json")),z.withCredentials=g.credentials==="include",z.onerror=()=>{T(new Error(z.statusText))},z.onload=()=>{if(!_.signal.aborted)if((z.status>=200&&z.status<300||z.status===0)&&z.response!==null){let B=z.response;if(g.type==="json")try{B=JSON.parse(z.response)}catch(N){return void T(N)}C({data:B,cacheControl:z.getResponseHeader("Cache-Control"),expires:z.getResponseHeader("Expires")})}else{const B=new Blob([z.response],{type:z.getResponseHeader("Content-Type")});T(new Ke(z.status,z.statusText,g.url,B))}},_.signal.addEventListener("abort",()=>{z.abort(),T(Ie())}),z.send(g.body)})}(h,c)};function Et(h){if(!h||h.indexOf("://")<=0||h.indexOf("data:image/")===0||h.indexOf("blob:")===0)return!0;const c=new URL(h),f=window.location;return c.protocol===f.protocol&&c.host===f.host}function xt(h,c,f){f[h]&&f[h].indexOf(c)!==-1||(f[h]=f[h]||[],f[h].push(c))}function et(h,c,f){if(f&&f[h]){const g=f[h].indexOf(c);g!==-1&&f[h].splice(g,1)}}class Yt{constructor(c,f={}){K(this,f),this.type=c}}class _t extends Yt{constructor(c,f={}){super("error",K({error:c},f))}}class rt{on(c,f){return this._listeners=this._listeners||{},xt(c,f,this._listeners),this}off(c,f){return et(c,f,this._listeners),et(c,f,this._oneTimeListeners),this}once(c,f){return f?(this._oneTimeListeners=this._oneTimeListeners||{},xt(c,f,this._oneTimeListeners),this):new Promise(g=>this.once(c,g))}fire(c,f){typeof c=="string"&&(c=new Yt(c,f||{}));const g=c.type;if(this.listens(g)){c.target=this;const _=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const j of _)j.call(this,c);const C=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const j of C)et(g,j,this._oneTimeListeners),j.call(this,c);const T=this._eventedParent;T&&(K(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(c))}else c instanceof _t&&console.error(c.error);return this}listens(c){return this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c)}setEventedParent(c,f){return this._eventedParent=c,this._eventedParentData=f,this}}var Te={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ct=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Vt(h,c){const f={};for(const g in h)g!=="ref"&&(f[g]=h[g]);return ct.forEach(g=>{g in c&&(f[g]=c[g])}),f}function wt(h,c){if(Array.isArray(h)){if(!Array.isArray(c)||h.length!==c.length)return!1;for(let f=0;f<h.length;f++)if(!wt(h[f],c[f]))return!1;return!0}if(typeof h=="object"&&h!==null&&c!==null){if(typeof c!="object"||Object.keys(h).length!==Object.keys(c).length)return!1;for(const f in h)if(!wt(h[f],c[f]))return!1;return!0}return h===c}function Ft(h,c){h.push(c)}function Kr(h,c,f){Ft(f,{command:"addSource",args:[h,c[h]]})}function yn(h,c,f){Ft(c,{command:"removeSource",args:[h]}),f[h]=!0}function an(h,c,f,g){yn(h,f,g),Kr(h,c,f)}function Cn(h,c,f){let g;for(g in h[f])if(Object.prototype.hasOwnProperty.call(h[f],g)&&g!=="data"&&!wt(h[f][g],c[f][g]))return!1;for(g in c[f])if(Object.prototype.hasOwnProperty.call(c[f],g)&&g!=="data"&&!wt(h[f][g],c[f][g]))return!1;return!0}function xn(h,c,f,g,_,C){h=h||{},c=c||{};for(const T in h)Object.prototype.hasOwnProperty.call(h,T)&&(wt(h[T],c[T])||f.push({command:C,args:[g,T,c[T],_]}));for(const T in c)Object.prototype.hasOwnProperty.call(c,T)&&!Object.prototype.hasOwnProperty.call(h,T)&&(wt(h[T],c[T])||f.push({command:C,args:[g,T,c[T],_]}))}function di(h){return h.id}function Pi(h,c){return h[c.id]=c,h}class He{constructor(c,f,g,_){this.message=(c?`${c}: `:"")+g,_&&(this.identifier=_),f!=null&&f.__line__&&(this.line=f.__line__)}}function Vr(h,...c){for(const f of c)for(const g in f)h[g]=f[g];return h}class Ct extends Error{constructor(c,f){super(f),this.message=f,this.key=c}}class Ut{constructor(c,f=[]){this.parent=c,this.bindings={};for(const[g,_]of f)this.bindings[g]=_}concat(c){return new Ut(this,c)}get(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(`${c} not found in scope.`)}has(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)}}const wn={kind:"null"},vt={kind:"number"},vr={kind:"string"},tr={kind:"boolean"},Zn={kind:"color"},_i={kind:"object"},pr={kind:"value"},Di={kind:"collator"},ks={kind:"formatted"},Li={kind:"padding"},cs={kind:"resolvedImage"},ge={kind:"variableAnchorOffsetCollection"};function W(h,c){return{kind:"array",itemType:h,N:c}}function Q(h){if(h.kind==="array"){const c=Q(h.itemType);return typeof h.N=="number"?`array<${c}, ${h.N}>`:h.itemType.kind==="value"?"array":`array<${c}>`}return h.kind}const te=[wn,vt,vr,tr,Zn,ks,_i,W(pr),Li,cs,ge];function de(h,c){if(c.kind==="error")return null;if(h.kind==="array"){if(c.kind==="array"&&(c.N===0&&c.itemType.kind==="value"||!de(h.itemType,c.itemType))&&(typeof h.N!="number"||h.N===c.N))return null}else{if(h.kind===c.kind)return null;if(h.kind==="value"){for(const f of te)if(!de(f,c))return null}}return`Expected ${Q(h)} but found ${Q(c)} instead.`}function be(h,c){return c.some(f=>f.kind===h.kind)}function ke(h,c){return c.some(f=>f==="null"?h===null:f==="array"?Array.isArray(h):f==="object"?h&&!Array.isArray(h)&&typeof h=="object":f===typeof h)}function $e(h,c){return h.kind==="array"&&c.kind==="array"?h.itemType.kind===c.itemType.kind&&typeof h.N=="number":h.kind===c.kind}const _e=.96422,nt=.82521,dt=4/29,ve=6/29,ut=3*ve*ve,Dt=ve*ve*ve,nr=Math.PI/180,Ur=180/Math.PI;function Ir(h){return(h%=360)<0&&(h+=360),h}function en([h,c,f,g]){let _,C;const T=fi((.2225045*(h=Fr(h))+.7168786*(c=Fr(c))+.0606169*(f=Fr(f)))/1);h===c&&c===f?_=C=T:(_=fi((.4360747*h+.3850649*c+.1430804*f)/_e),C=fi((.0139322*h+.0971045*c+.7141733*f)/nt));const j=116*T-16;return[j<0?0:j,500*(_-T),200*(T-C),g]}function Fr(h){return h<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function fi(h){return h>Dt?Math.pow(h,1/3):h/ut+dt}function Yn([h,c,f,g]){let _=(h+16)/116,C=isNaN(c)?_:_+c/500,T=isNaN(f)?_:_-f/200;return _=1*mn(_),C=_e*mn(C),T=nt*mn(T),[Br(3.1338561*C-1.6168667*_-.4906146*T),Br(-.9787684*C+1.9161415*_+.033454*T),Br(.0719453*C-.2289914*_+1.4052427*T),g]}function Br(h){return(h=h<=.00304?12.92*h:1.055*Math.pow(h,1/2.4)-.055)<0?0:h>1?1:h}function mn(h){return h>ve?h*h*h:ut*(h-dt)}function Bn(h){return parseInt(h.padEnd(2,h),16)/255}function Ai(h,c){return wi(c?h/100:h,0,1)}function wi(h,c,f){return Math.min(Math.max(c,h),f)}function us(h){return!h.some(Number.isNaN)}const Ma={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class ln{constructor(c,f,g,_=1,C=!0){this.r=c,this.g=f,this.b=g,this.a=_,C||(this.r*=_,this.g*=_,this.b*=_,_||this.overwriteGetter("rgb",[c,f,g,_]))}static parse(c){if(c instanceof ln)return c;if(typeof c!="string")return;const f=function(g){if((g=g.toLowerCase().trim())==="transparent")return[0,0,0,0];const _=Ma[g];if(_){const[T,j,z]=_;return[T/255,j/255,z/255,1]}if(g.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(g)){const T=g.length<6?1:2;let j=1;return[Bn(g.slice(j,j+=T)),Bn(g.slice(j,j+=T)),Bn(g.slice(j,j+=T)),Bn(g.slice(j,j+T)||"ff")]}if(g.startsWith("rgb")){const T=g.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[j,z,B,N,q,Z,re,se,ae,me,we,Ze]=T,Ee=[N||" ",re||" ",me].join("");if(Ee==="  "||Ee==="  /"||Ee===",,"||Ee===",,,"){const Qe=[B,Z,ae].join(""),ot=Qe==="%%%"?100:Qe===""?255:0;if(ot){const yt=[wi(+z/ot,0,1),wi(+q/ot,0,1),wi(+se/ot,0,1),we?Ai(+we,Ze):1];if(us(yt))return yt}}return}}const C=g.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(C){const[T,j,z,B,N,q,Z,re,se]=C,ae=[z||" ",N||" ",Z].join("");if(ae==="  "||ae==="  /"||ae===",,"||ae===",,,"){const me=[+j,wi(+B,0,100),wi(+q,0,100),re?Ai(+re,se):1];if(us(me))return function([we,Ze,Ee,Qe]){function ot(yt){const Wt=(yt+we/30)%12,xr=Ze*Math.min(Ee,1-Ee);return Ee-xr*Math.max(-1,Math.min(Wt-3,9-Wt,1))}return we=Ir(we),Ze/=100,Ee/=100,[ot(0),ot(8),ot(4),Qe]}(me)}}}(c);return f?new ln(...f,!1):void 0}get rgb(){const{r:c,g:f,b:g,a:_}=this,C=_||1/0;return this.overwriteGetter("rgb",[c/C,f/C,g/C,_])}get hcl(){return this.overwriteGetter("hcl",function(c){const[f,g,_,C]=en(c),T=Math.sqrt(g*g+_*_);return[Math.round(1e4*T)?Ir(Math.atan2(_,g)*Ur):NaN,T,f,C]}(this.rgb))}get lab(){return this.overwriteGetter("lab",en(this.rgb))}overwriteGetter(c,f){return Object.defineProperty(this,c,{value:f}),f}toString(){const[c,f,g,_]=this.rgb;return`rgba(${[c,f,g].map(C=>Math.round(255*C)).join(",")},${_})`}}ln.black=new ln(0,0,0,1),ln.white=new ln(1,1,1,1),ln.transparent=new ln(0,0,0,0),ln.red=new ln(1,0,0,1);class Tf{constructor(c,f,g){this.sensitivity=c?f?"variant":"case":f?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(c,f){return this.collator.compare(c,f)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class jc{constructor(c,f,g,_,C){this.text=c,this.image=f,this.scale=g,this.fontStack=_,this.textColor=C}}class Cs{constructor(c){this.sections=c}static fromString(c){return new Cs([new jc(c,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(c=>c.text.length!==0||c.image&&c.image.name.length!==0)}static factory(c){return c instanceof Cs?c:Cs.fromString(c)}toString(){return this.sections.length===0?"":this.sections.map(c=>c.text).join("")}}class Ws{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof Ws)return c;if(typeof c=="number")return new Ws([c,c,c,c]);if(Array.isArray(c)&&!(c.length<1||c.length>4)){for(const f of c)if(typeof f!="number")return;switch(c.length){case 1:c=[c[0],c[0],c[0],c[0]];break;case 2:c=[c[0],c[1],c[0],c[1]];break;case 3:c=[c[0],c[1],c[2],c[1]]}return new Ws(c)}}toString(){return JSON.stringify(this.values)}}const j0=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class uo{constructor(c){this.values=c.slice()}static parse(c){if(c instanceof uo)return c;if(Array.isArray(c)&&!(c.length<1)&&c.length%2==0){for(let f=0;f<c.length;f+=2){const g=c[f],_=c[f+1];if(typeof g!="string"||!j0.has(g)||!Array.isArray(_)||_.length!==2||typeof _[0]!="number"||typeof _[1]!="number")return}return new uo(c)}}toString(){return JSON.stringify(this.values)}}class Ts{constructor(c){this.name=c.name,this.available=c.available}toString(){return this.name}static fromString(c){return c?new Ts({name:c,available:!1}):null}}function Pc(h,c,f,g){return typeof h=="number"&&h>=0&&h<=255&&typeof c=="number"&&c>=0&&c<=255&&typeof f=="number"&&f>=0&&f<=255?g===void 0||typeof g=="number"&&g>=0&&g<=1?null:`Invalid rgba value [${[h,c,f,g].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof g=="number"?[h,c,f,g]:[h,c,f]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Xl(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof ln||h instanceof Tf||h instanceof Cs||h instanceof Ws||h instanceof uo||h instanceof Ts)return!0;if(Array.isArray(h)){for(const c of h)if(!Xl(c))return!1;return!0}if(typeof h=="object"){for(const c in h)if(!Xl(h[c]))return!1;return!0}return!1}function pi(h){if(h===null)return wn;if(typeof h=="string")return vr;if(typeof h=="boolean")return tr;if(typeof h=="number")return vt;if(h instanceof ln)return Zn;if(h instanceof Tf)return Di;if(h instanceof Cs)return ks;if(h instanceof Ws)return Li;if(h instanceof uo)return ge;if(h instanceof Ts)return cs;if(Array.isArray(h)){const c=h.length;let f;for(const g of h){const _=pi(g);if(f){if(f===_)continue;f=pr;break}f=_}return W(f||pr,c)}return _i}function Ou(h){const c=typeof h;return h===null?"":c==="string"||c==="number"||c==="boolean"?String(h):h instanceof ln||h instanceof Cs||h instanceof Ws||h instanceof uo||h instanceof Ts?h.toString():JSON.stringify(h)}class jo{constructor(c,f){this.type=c,this.value=f}static parse(c,f){if(c.length!==2)return f.error(`'literal' expression requires exactly one argument, but found ${c.length-1} instead.`);if(!Xl(c[1]))return f.error("invalid value");const g=c[1];let _=pi(g);const C=f.expectedType;return _.kind!=="array"||_.N!==0||!C||C.kind!=="array"||typeof C.N=="number"&&C.N!==0||(_=C),new jo(_,g)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class oi{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}}const jh={string:vr,number:vt,boolean:tr,object:_i};class Po{constructor(c,f){this.type=c,this.args=f}static parse(c,f){if(c.length<2)return f.error("Expected at least one argument.");let g,_=1;const C=c[0];if(C==="array"){let j,z;if(c.length>2){const B=c[1];if(typeof B!="string"||!(B in jh)||B==="object")return f.error('The item type argument of "array" must be one of string, number, boolean',1);j=jh[B],_++}else j=pr;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return f.error('The length argument to "array" must be a positive integer literal',2);z=c[2],_++}g=W(j,z)}else{if(!jh[C])throw new Error(`Types doesn't contain name = ${C}`);g=jh[C]}const T=[];for(;_<c.length;_++){const j=f.parse(c[_],_,pr);if(!j)return null;T.push(j)}return new Po(g,T)}evaluate(c){for(let f=0;f<this.args.length;f++){const g=this.args[f].evaluate(c);if(!de(this.type,pi(g)))return g;if(f===this.args.length-1)throw new oi(`Expected value to be of type ${Q(this.type)}, but found ${Q(pi(g))} instead.`)}throw new Error}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}const Of={"to-boolean":tr,"to-color":Zn,"to-number":vt,"to-string":vr};class Ao{constructor(c,f){this.type=c,this.args=f}static parse(c,f){if(c.length<2)return f.error("Expected at least one argument.");const g=c[0];if(!Of[g])throw new Error(`Can't parse ${g} as it is not part of the known types`);if((g==="to-boolean"||g==="to-string")&&c.length!==2)return f.error("Expected one argument.");const _=Of[g],C=[];for(let T=1;T<c.length;T++){const j=f.parse(c[T],T,pr);if(!j)return null;C.push(j)}return new Ao(_,C)}evaluate(c){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(c);case"color":{let f,g;for(const _ of this.args){if(f=_.evaluate(c),g=null,f instanceof ln)return f;if(typeof f=="string"){const C=c.parseColor(f);if(C)return C}else if(Array.isArray(f)&&(g=f.length<3||f.length>4?`Invalid rbga value ${JSON.stringify(f)}: expected an array containing either three or four numeric values.`:Pc(f[0],f[1],f[2],f[3]),!g))return new ln(f[0]/255,f[1]/255,f[2]/255,f[3])}throw new oi(g||`Could not parse color from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"padding":{let f;for(const g of this.args){f=g.evaluate(c);const _=Ws.parse(f);if(_)return _}throw new oi(`Could not parse padding from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"variableAnchorOffsetCollection":{let f;for(const g of this.args){f=g.evaluate(c);const _=uo.parse(f);if(_)return _}throw new oi(`Could not parse variableAnchorOffsetCollection from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"number":{let f=null;for(const g of this.args){if(f=g.evaluate(c),f===null)return 0;const _=Number(f);if(!isNaN(_))return _}throw new oi(`Could not convert ${JSON.stringify(f)} to number.`)}case"formatted":return Cs.fromString(Ou(this.args[0].evaluate(c)));case"resolvedImage":return Ts.fromString(Ou(this.args[0].evaluate(c)));default:return Ou(this.args[0].evaluate(c))}}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}const Ph=["Unknown","Point","LineString","Polygon"];class Ac{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ph[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(c){let f=this._parseColorCache[c];return f||(f=this._parseColorCache[c]=ln.parse(c)),f}}class Kl{constructor(c,f,g=[],_,C=new Ut,T=[]){this.registry=c,this.path=g,this.key=g.map(j=>`[${j}]`).join(""),this.scope=C,this.errors=T,this.expectedType=_,this._isConstant=f}parse(c,f,g,_,C={}){return f?this.concat(f,g,_)._parse(c,C):this._parse(c,C)}_parse(c,f){function g(_,C,T){return T==="assert"?new Po(C,[_]):T==="coerce"?new Ao(C,[_]):_}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=c[0];if(typeof _!="string")return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const C=this.registry[_];if(C){let T=C.parse(c,this);if(!T)return null;if(this.expectedType){const j=this.expectedType,z=T.type;if(j.kind!=="string"&&j.kind!=="number"&&j.kind!=="boolean"&&j.kind!=="object"&&j.kind!=="array"||z.kind!=="value")if(j.kind!=="color"&&j.kind!=="formatted"&&j.kind!=="resolvedImage"||z.kind!=="value"&&z.kind!=="string")if(j.kind!=="padding"||z.kind!=="value"&&z.kind!=="number"&&z.kind!=="array")if(j.kind!=="variableAnchorOffsetCollection"||z.kind!=="value"&&z.kind!=="array"){if(this.checkSubtype(j,z))return null}else T=g(T,j,f.typeAnnotation||"coerce");else T=g(T,j,f.typeAnnotation||"coerce");else T=g(T,j,f.typeAnnotation||"coerce");else T=g(T,j,f.typeAnnotation||"assert")}if(!(T instanceof jo)&&T.type.kind!=="resolvedImage"&&this._isConstant(T)){const j=new Ac;try{T=new jo(T.type,T.evaluate(j))}catch(z){return this.error(z.message),null}}return T}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof c} instead.`)}concat(c,f,g){const _=typeof c=="number"?this.path.concat(c):this.path,C=g?this.scope.concat(g):this.scope;return new Kl(this.registry,this._isConstant,_,f||null,C,this.errors)}error(c,...f){const g=`${this.key}${f.map(_=>`[${_}]`).join("")}`;this.errors.push(new Ct(g,c))}checkSubtype(c,f){const g=de(c,f);return g&&this.error(g),g}}class cl{constructor(c,f){this.type=f.type,this.bindings=[].concat(c),this.result=f}evaluate(c){return this.result.evaluate(c)}eachChild(c){for(const f of this.bindings)c(f[1]);c(this.result)}static parse(c,f){if(c.length<4)return f.error(`Expected at least 3 arguments, but found ${c.length-1} instead.`);const g=[];for(let C=1;C<c.length-1;C+=2){const T=c[C];if(typeof T!="string")return f.error(`Expected string, but found ${typeof T} instead.`,C);if(/[^a-zA-Z0-9_]/.test(T))return f.error("Variable names must contain only alphanumeric characters or '_'.",C);const j=f.parse(c[C+1],C+1);if(!j)return null;g.push([T,j])}const _=f.parse(c[c.length-1],c.length-1,f.expectedType,g);return _?new cl(g,_):null}outputDefined(){return this.result.outputDefined()}}class tn{constructor(c,f){this.type=f.type,this.name=c,this.boundExpression=f}static parse(c,f){if(c.length!==2||typeof c[1]!="string")return f.error("'var' expression requires exactly one string literal argument.");const g=c[1];return f.scope.has(g)?new tn(g,f.scope.get(g)):f.error(`Unknown variable "${g}". Make sure "${g}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(c){return this.boundExpression.evaluate(c)}eachChild(){}outputDefined(){return!1}}class jf{constructor(c,f,g){this.type=c,this.index=f,this.input=g}static parse(c,f){if(c.length!==3)return f.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const g=f.parse(c[1],1,vt),_=f.parse(c[2],2,W(f.expectedType||pr));return g&&_?new jf(_.type.itemType,g,_):null}evaluate(c){const f=this.index.evaluate(c),g=this.input.evaluate(c);if(f<0)throw new oi(`Array index out of bounds: ${f} < 0.`);if(f>=g.length)throw new oi(`Array index out of bounds: ${f} > ${g.length-1}.`);if(f!==Math.floor(f))throw new oi(`Array index must be an integer, but found ${f} instead.`);return g[f]}eachChild(c){c(this.index),c(this.input)}outputDefined(){return!1}}class Pf{constructor(c,f){this.type=tr,this.needle=c,this.haystack=f}static parse(c,f){if(c.length!==3)return f.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const g=f.parse(c[1],1,pr),_=f.parse(c[2],2,pr);return g&&_?be(g.type,[tr,vr,vt,wn,pr])?new Pf(g,_):f.error(`Expected first argument to be of type boolean, string, number or null, but found ${Q(g.type)} instead`):null}evaluate(c){const f=this.needle.evaluate(c),g=this.haystack.evaluate(c);if(!g)return!1;if(!ke(f,["boolean","string","number","null"]))throw new oi(`Expected first argument to be of type boolean, string, number or null, but found ${Q(pi(f))} instead.`);if(!ke(g,["string","array"]))throw new oi(`Expected second argument to be of type array or string, but found ${Q(pi(g))} instead.`);return g.indexOf(f)>=0}eachChild(c){c(this.needle),c(this.haystack)}outputDefined(){return!0}}class Ec{constructor(c,f,g){this.type=vt,this.needle=c,this.haystack=f,this.fromIndex=g}static parse(c,f){if(c.length<=2||c.length>=5)return f.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const g=f.parse(c[1],1,pr),_=f.parse(c[2],2,pr);if(!g||!_)return null;if(!be(g.type,[tr,vr,vt,wn,pr]))return f.error(`Expected first argument to be of type boolean, string, number or null, but found ${Q(g.type)} instead`);if(c.length===4){const C=f.parse(c[3],3,vt);return C?new Ec(g,_,C):null}return new Ec(g,_)}evaluate(c){const f=this.needle.evaluate(c),g=this.haystack.evaluate(c);if(!ke(f,["boolean","string","number","null"]))throw new oi(`Expected first argument to be of type boolean, string, number or null, but found ${Q(pi(f))} instead.`);let _;if(this.fromIndex&&(_=this.fromIndex.evaluate(c)),ke(g,["string"])){const C=g.indexOf(f,_);return C===-1?-1:[...g.slice(0,C)].length}if(ke(g,["array"]))return g.indexOf(f,_);throw new oi(`Expected second argument to be of type array or string, but found ${Q(pi(g))} instead.`)}eachChild(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)}outputDefined(){return!1}}class Ah{constructor(c,f,g,_,C,T){this.inputType=c,this.type=f,this.input=g,this.cases=_,this.outputs=C,this.otherwise=T}static parse(c,f){if(c.length<5)return f.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if(c.length%2!=1)return f.error("Expected an even number of arguments.");let g,_;f.expectedType&&f.expectedType.kind!=="value"&&(_=f.expectedType);const C={},T=[];for(let B=2;B<c.length-1;B+=2){let N=c[B];const q=c[B+1];Array.isArray(N)||(N=[N]);const Z=f.concat(B);if(N.length===0)return Z.error("Expected at least one branch label.");for(const se of N){if(typeof se!="number"&&typeof se!="string")return Z.error("Branch labels must be numbers or strings.");if(typeof se=="number"&&Math.abs(se)>Number.MAX_SAFE_INTEGER)return Z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof se=="number"&&Math.floor(se)!==se)return Z.error("Numeric branch labels must be integer values.");if(g){if(Z.checkSubtype(g,pi(se)))return null}else g=pi(se);if(C[String(se)]!==void 0)return Z.error("Branch labels must be unique.");C[String(se)]=T.length}const re=f.parse(q,B,_);if(!re)return null;_=_||re.type,T.push(re)}const j=f.parse(c[1],1,pr);if(!j)return null;const z=f.parse(c[c.length-1],c.length-1,_);return z?j.type.kind!=="value"&&f.concat(1).checkSubtype(g,j.type)?null:new Ah(g,_,j,C,T,z):null}evaluate(c){const f=this.input.evaluate(c);return(pi(f)===this.inputType&&this.outputs[this.cases[f]]||this.otherwise).evaluate(c)}eachChild(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)}outputDefined(){return this.outputs.every(c=>c.outputDefined())&&this.otherwise.outputDefined()}}class Eh{constructor(c,f,g){this.type=c,this.branches=f,this.otherwise=g}static parse(c,f){if(c.length<4)return f.error(`Expected at least 3 arguments, but found only ${c.length-1}.`);if(c.length%2!=0)return f.error("Expected an odd number of arguments.");let g;f.expectedType&&f.expectedType.kind!=="value"&&(g=f.expectedType);const _=[];for(let T=1;T<c.length-1;T+=2){const j=f.parse(c[T],T,tr);if(!j)return null;const z=f.parse(c[T+1],T+1,g);if(!z)return null;_.push([j,z]),g=g||z.type}const C=f.parse(c[c.length-1],c.length-1,g);if(!C)return null;if(!g)throw new Error("Can't infer output type");return new Eh(g,_,C)}evaluate(c){for(const[f,g]of this.branches)if(f.evaluate(c))return g.evaluate(c);return this.otherwise.evaluate(c)}eachChild(c){for(const[f,g]of this.branches)c(f),c(g);c(this.otherwise)}outputDefined(){return this.branches.every(([c,f])=>f.outputDefined())&&this.otherwise.outputDefined()}}class ju{constructor(c,f,g,_){this.type=c,this.input=f,this.beginIndex=g,this.endIndex=_}static parse(c,f){if(c.length<=2||c.length>=5)return f.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const g=f.parse(c[1],1,pr),_=f.parse(c[2],2,vt);if(!g||!_)return null;if(!be(g.type,[W(pr),vr,pr]))return f.error(`Expected first argument to be of type array or string, but found ${Q(g.type)} instead`);if(c.length===4){const C=f.parse(c[3],3,vt);return C?new ju(g.type,g,_,C):null}return new ju(g.type,g,_)}evaluate(c){const f=this.input.evaluate(c),g=this.beginIndex.evaluate(c);let _;if(this.endIndex&&(_=this.endIndex.evaluate(c)),ke(f,["string"]))return[...f].slice(g,_).join("");if(ke(f,["array"]))return f.slice(g,_);throw new oi(`Expected first argument to be of type array or string, but found ${Q(pi(f))} instead.`)}eachChild(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)}outputDefined(){return!1}}function zh(h,c){const f=h.length-1;let g,_,C=0,T=f,j=0;for(;C<=T;)if(j=Math.floor((C+T)/2),g=h[j],_=h[j+1],g<=c){if(j===f||c<_)return j;C=j+1}else{if(!(g>c))throw new oi("Input is not a number.");T=j-1}return 0}class ul{constructor(c,f,g){this.type=c,this.input=f,this.labels=[],this.outputs=[];for(const[_,C]of g)this.labels.push(_),this.outputs.push(C)}static parse(c,f){if(c.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return f.error("Expected an even number of arguments.");const g=f.parse(c[1],1,vt);if(!g)return null;const _=[];let C=null;f.expectedType&&f.expectedType.kind!=="value"&&(C=f.expectedType);for(let T=1;T<c.length;T+=2){const j=T===1?-1/0:c[T],z=c[T+1],B=T,N=T+1;if(typeof j!="number")return f.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(_.length&&_[_.length-1][0]>=j)return f.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',B);const q=f.parse(z,N,C);if(!q)return null;C=C||q.type,_.push([j,q])}return new ul(C,g,_)}evaluate(c){const f=this.labels,g=this.outputs;if(f.length===1)return g[0].evaluate(c);const _=this.input.evaluate(c);if(_<=f[0])return g[0].evaluate(c);const C=f.length;return _>=f[C-1]?g[C-1].evaluate(c):g[zh(f,_)].evaluate(c)}eachChild(c){c(this.input);for(const f of this.outputs)c(f)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}}function km(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var P0=Cm;function Cm(h,c,f,g){this.cx=3*h,this.bx=3*(f-h)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(g-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=h,this.p1y=c,this.p2x=f,this.p2y=g}Cm.prototype={sampleCurveX:function(h){return((this.ax*h+this.bx)*h+this.cx)*h},sampleCurveY:function(h){return((this.ay*h+this.by)*h+this.cy)*h},sampleCurveDerivativeX:function(h){return(3*this.ax*h+2*this.bx)*h+this.cx},solveCurveX:function(h,c){if(c===void 0&&(c=1e-6),h<0)return 0;if(h>1)return 1;for(var f=h,g=0;g<8;g++){var _=this.sampleCurveX(f)-h;if(Math.abs(_)<c)return f;var C=this.sampleCurveDerivativeX(f);if(Math.abs(C)<1e-6)break;f-=_/C}var T=0,j=1;for(f=h,g=0;g<20&&(_=this.sampleCurveX(f),!(Math.abs(_-h)<c));g++)h>_?T=f:j=f,f=.5*(j-T)+T;return f},solve:function(h,c){return this.sampleCurveY(this.solveCurveX(h,c))}};var Mh=km(P0);function Ia(h,c,f){return h+f*(c-h)}function Zl(h,c,f){return h.map((g,_)=>Ia(g,c[_],f))}const Gi={number:Ia,color:function(h,c,f,g="rgb"){switch(g){case"rgb":{const[_,C,T,j]=Zl(h.rgb,c.rgb,f);return new ln(_,C,T,j,!1)}case"hcl":{const[_,C,T,j]=h.hcl,[z,B,N,q]=c.hcl;let Z,re;if(isNaN(_)||isNaN(z))isNaN(_)?isNaN(z)?Z=NaN:(Z=z,T!==1&&T!==0||(re=B)):(Z=_,N!==1&&N!==0||(re=C));else{let Ze=z-_;z>_&&Ze>180?Ze-=360:z<_&&_-z>180&&(Ze+=360),Z=_+f*Ze}const[se,ae,me,we]=function([Ze,Ee,Qe,ot]){return Ze=isNaN(Ze)?0:Ze*nr,Yn([Qe,Math.cos(Ze)*Ee,Math.sin(Ze)*Ee,ot])}([Z,re??Ia(C,B,f),Ia(T,N,f),Ia(j,q,f)]);return new ln(se,ae,me,we,!1)}case"lab":{const[_,C,T,j]=Yn(Zl(h.lab,c.lab,f));return new ln(_,C,T,j,!1)}}},array:Zl,padding:function(h,c,f){return new Ws(Zl(h.values,c.values,f))},variableAnchorOffsetCollection:function(h,c,f){const g=h.values,_=c.values;if(g.length!==_.length)throw new oi(`Cannot interpolate values of different length. from: ${h.toString()}, to: ${c.toString()}`);const C=[];for(let T=0;T<g.length;T+=2){if(g[T]!==_[T])throw new oi(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${g[T]}, to[${T}]: ${_[T]}`);C.push(g[T]);const[j,z]=g[T+1],[B,N]=_[T+1];C.push([Ia(j,B,f),Ia(z,N,f)])}return new uo(C)}};class Os{constructor(c,f,g,_,C){this.type=c,this.operator=f,this.interpolation=g,this.input=_,this.labels=[],this.outputs=[];for(const[T,j]of C)this.labels.push(T),this.outputs.push(j)}static interpolationFactor(c,f,g,_){let C=0;if(c.name==="exponential")C=Pu(f,c.base,g,_);else if(c.name==="linear")C=Pu(f,1,g,_);else if(c.name==="cubic-bezier"){const T=c.controlPoints;C=new Mh(T[0],T[1],T[2],T[3]).solve(Pu(f,1,g,_))}return C}static parse(c,f){let[g,_,C,...T]=c;if(!Array.isArray(_)||_.length===0)return f.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const B=_[1];if(typeof B!="number")return f.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:B}}else{if(_[0]!=="cubic-bezier")return f.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const B=_.slice(1);if(B.length!==4||B.some(N=>typeof N!="number"||N<0||N>1))return f.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:B}}}if(c.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return f.error("Expected an even number of arguments.");if(C=f.parse(C,2,vt),!C)return null;const j=[];let z=null;g==="interpolate-hcl"||g==="interpolate-lab"?z=Zn:f.expectedType&&f.expectedType.kind!=="value"&&(z=f.expectedType);for(let B=0;B<T.length;B+=2){const N=T[B],q=T[B+1],Z=B+3,re=B+4;if(typeof N!="number")return f.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(j.length&&j[j.length-1][0]>=N)return f.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Z);const se=f.parse(q,re,z);if(!se)return null;z=z||se.type,j.push([N,se])}return $e(z,vt)||$e(z,Zn)||$e(z,Li)||$e(z,ge)||$e(z,W(vt))?new Os(z,g,_,C,j):f.error(`Type ${Q(z)} is not interpolatable.`)}evaluate(c){const f=this.labels,g=this.outputs;if(f.length===1)return g[0].evaluate(c);const _=this.input.evaluate(c);if(_<=f[0])return g[0].evaluate(c);const C=f.length;if(_>=f[C-1])return g[C-1].evaluate(c);const T=zh(f,_),j=Os.interpolationFactor(this.interpolation,_,f[T],f[T+1]),z=g[T].evaluate(c),B=g[T+1].evaluate(c);switch(this.operator){case"interpolate":return Gi[this.type.kind](z,B,j);case"interpolate-hcl":return Gi.color(z,B,j,"hcl");case"interpolate-lab":return Gi.color(z,B,j,"lab")}}eachChild(c){c(this.input);for(const f of this.outputs)c(f)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}}function Pu(h,c,f,g){const _=g-f,C=h-f;return _===0?0:c===1?C/_:(Math.pow(c,C)-1)/(Math.pow(c,_)-1)}class zc{constructor(c,f){this.type=c,this.args=f}static parse(c,f){if(c.length<2)return f.error("Expectected at least one argument.");let g=null;const _=f.expectedType;_&&_.kind!=="value"&&(g=_);const C=[];for(const j of c.slice(1)){const z=f.parse(j,1+C.length,g,void 0,{typeAnnotation:"omit"});if(!z)return null;g=g||z.type,C.push(z)}if(!g)throw new Error("No output type");const T=_&&C.some(j=>de(_,j.type));return new zc(T?pr:g,C)}evaluate(c){let f,g=null,_=0;for(const C of this.args)if(_++,g=C.evaluate(c),g&&g instanceof Ts&&!g.available&&(f||(f=g.name),g=null,_===this.args.length&&(g=f)),g!==null)break;return g}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}}function Au(h,c){return h==="=="||h==="!="?c.kind==="boolean"||c.kind==="string"||c.kind==="number"||c.kind==="null"||c.kind==="value":c.kind==="string"||c.kind==="number"||c.kind==="value"}function hl(h,c,f,g){return g.compare(c,f)===0}function ea(h,c,f){const g=h!=="=="&&h!=="!=";return class TU{constructor(C,T,j){this.type=tr,this.lhs=C,this.rhs=T,this.collator=j,this.hasUntypedArgument=C.type.kind==="value"||T.type.kind==="value"}static parse(C,T){if(C.length!==3&&C.length!==4)return T.error("Expected two or three arguments.");const j=C[0];let z=T.parse(C[1],1,pr);if(!z)return null;if(!Au(j,z.type))return T.concat(1).error(`"${j}" comparisons are not supported for type '${Q(z.type)}'.`);let B=T.parse(C[2],2,pr);if(!B)return null;if(!Au(j,B.type))return T.concat(2).error(`"${j}" comparisons are not supported for type '${Q(B.type)}'.`);if(z.type.kind!==B.type.kind&&z.type.kind!=="value"&&B.type.kind!=="value")return T.error(`Cannot compare types '${Q(z.type)}' and '${Q(B.type)}'.`);g&&(z.type.kind==="value"&&B.type.kind!=="value"?z=new Po(B.type,[z]):z.type.kind!=="value"&&B.type.kind==="value"&&(B=new Po(z.type,[B])));let N=null;if(C.length===4){if(z.type.kind!=="string"&&B.type.kind!=="string"&&z.type.kind!=="value"&&B.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(N=T.parse(C[3],3,Di),!N)return null}return new TU(z,B,N)}evaluate(C){const T=this.lhs.evaluate(C),j=this.rhs.evaluate(C);if(g&&this.hasUntypedArgument){const z=pi(T),B=pi(j);if(z.kind!==B.kind||z.kind!=="string"&&z.kind!=="number")throw new oi(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${z.kind}, ${B.kind}) instead.`)}if(this.collator&&!g&&this.hasUntypedArgument){const z=pi(T),B=pi(j);if(z.kind!=="string"||B.kind!=="string")return c(C,T,j)}return this.collator?f(C,T,j,this.collator.evaluate(C)):c(C,T,j)}eachChild(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)}outputDefined(){return!0}}}const A0=ea("==",function(h,c,f){return c===f},hl),Af=ea("!=",function(h,c,f){return c!==f},function(h,c,f,g){return!hl(0,c,f,g)}),Tm=ea("<",function(h,c,f){return c<f},function(h,c,f,g){return g.compare(c,f)<0}),Om=ea(">",function(h,c,f){return c>f},function(h,c,f,g){return g.compare(c,f)>0}),E0=ea("<=",function(h,c,f){return c<=f},function(h,c,f,g){return g.compare(c,f)<=0}),jm=ea(">=",function(h,c,f){return c>=f},function(h,c,f,g){return g.compare(c,f)>=0});class Mc{constructor(c,f,g){this.type=Di,this.locale=g,this.caseSensitive=c,this.diacriticSensitive=f}static parse(c,f){if(c.length!==2)return f.error("Expected one argument.");const g=c[1];if(typeof g!="object"||Array.isArray(g))return f.error("Collator options argument must be an object.");const _=f.parse(g["case-sensitive"]!==void 0&&g["case-sensitive"],1,tr);if(!_)return null;const C=f.parse(g["diacritic-sensitive"]!==void 0&&g["diacritic-sensitive"],1,tr);if(!C)return null;let T=null;return g.locale&&(T=f.parse(g.locale,1,vr),!T)?null:new Mc(_,C,T)}evaluate(c){return new Tf(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)}eachChild(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)}outputDefined(){return!1}}class Ef{constructor(c,f,g,_,C){this.type=vr,this.number=c,this.locale=f,this.currency=g,this.minFractionDigits=_,this.maxFractionDigits=C}static parse(c,f){if(c.length!==3)return f.error("Expected two arguments.");const g=f.parse(c[1],1,vt);if(!g)return null;const _=c[2];if(typeof _!="object"||Array.isArray(_))return f.error("NumberFormat options argument must be an object.");let C=null;if(_.locale&&(C=f.parse(_.locale,1,vr),!C))return null;let T=null;if(_.currency&&(T=f.parse(_.currency,1,vr),!T))return null;let j=null;if(_["min-fraction-digits"]&&(j=f.parse(_["min-fraction-digits"],1,vt),!j))return null;let z=null;return _["max-fraction-digits"]&&(z=f.parse(_["max-fraction-digits"],1,vt),!z)?null:new Ef(g,C,T,j,z)}evaluate(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))}eachChild(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)}outputDefined(){return!1}}class ye{constructor(c){this.type=ks,this.sections=c}static parse(c,f){if(c.length<2)return f.error("Expected at least one argument.");const g=c[1];if(!Array.isArray(g)&&typeof g=="object")return f.error("First argument must be an image or text section.");const _=[];let C=!1;for(let T=1;T<=c.length-1;++T){const j=c[T];if(C&&typeof j=="object"&&!Array.isArray(j)){C=!1;let z=null;if(j["font-scale"]&&(z=f.parse(j["font-scale"],1,vt),!z))return null;let B=null;if(j["text-font"]&&(B=f.parse(j["text-font"],1,W(vr)),!B))return null;let N=null;if(j["text-color"]&&(N=f.parse(j["text-color"],1,Zn),!N))return null;const q=_[_.length-1];q.scale=z,q.font=B,q.textColor=N}else{const z=f.parse(c[T],1,pr);if(!z)return null;const B=z.type.kind;if(B!=="string"&&B!=="value"&&B!=="null"&&B!=="resolvedImage")return f.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");C=!0,_.push({content:z,scale:null,font:null,textColor:null})}}return new ye(_)}evaluate(c){return new Cs(this.sections.map(f=>{const g=f.content.evaluate(c);return pi(g)===cs?new jc("",g,null,null,null):new jc(Ou(g),null,f.scale?f.scale.evaluate(c):null,f.font?f.font.evaluate(c).join(","):null,f.textColor?f.textColor.evaluate(c):null)}))}eachChild(c){for(const f of this.sections)c(f.content),f.scale&&c(f.scale),f.font&&c(f.font),f.textColor&&c(f.textColor)}outputDefined(){return!1}}class Ne{constructor(c){this.type=cs,this.input=c}static parse(c,f){if(c.length!==2)return f.error("Expected two arguments.");const g=f.parse(c[1],1,vr);return g?new Ne(g):f.error("No image name provided.")}evaluate(c){const f=this.input.evaluate(c),g=Ts.fromString(f);return g&&c.availableImages&&(g.available=c.availableImages.indexOf(f)>-1),g}eachChild(c){c(this.input)}outputDefined(){return!1}}class at{constructor(c){this.type=vt,this.input=c}static parse(c,f){if(c.length!==2)return f.error(`Expected 1 argument, but found ${c.length-1} instead.`);const g=f.parse(c[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?f.error(`Expected argument of type string or array, but found ${Q(g.type)} instead.`):new at(g):null}evaluate(c){const f=this.input.evaluate(c);if(typeof f=="string")return[...f].length;if(Array.isArray(f))return f.length;throw new oi(`Expected value to be of type string or array, but found ${Q(pi(f))} instead.`)}eachChild(c){c(this.input)}outputDefined(){return!1}}const Jt=8192;function rn(h,c){const f=(180+h[0])/360,g=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,_=Math.pow(2,c.z);return[Math.round(f*_*Jt),Math.round(g*_*Jt)]}function vn(h,c){const f=Math.pow(2,c.z);return[(_=(h[0]/Jt+c.x)/f,360*_-180),(g=(h[1]/Jt+c.y)/f,360/Math.PI*Math.atan(Math.exp((180-360*g)*Math.PI/180))-90)];var g,_}function gn(h,c){h[0]=Math.min(h[0],c[0]),h[1]=Math.min(h[1],c[1]),h[2]=Math.max(h[2],c[0]),h[3]=Math.max(h[3],c[1])}function Hr(h,c){return!(h[0]<=c[0]||h[2]>=c[2]||h[1]<=c[1]||h[3]>=c[3])}function br(h,c,f){const g=h[0]-c[0],_=h[1]-c[1],C=h[0]-f[0],T=h[1]-f[1];return g*T-C*_==0&&g*C<=0&&_*T<=0}function js(h,c,f,g){return(_=[g[0]-f[0],g[1]-f[1]])[0]*(C=[c[0]-h[0],c[1]-h[1]])[1]-_[1]*C[0]!=0&&!(!q1(h,c,f,g)||!q1(f,g,h,c));var _,C}function Us(h,c,f){for(const g of f)for(let _=0;_<g.length-1;++_)if(js(h,c,g[_],g[_+1]))return!0;return!1}function ta(h,c,f=!1){let g=!1;for(const j of c)for(let z=0;z<j.length-1;z++){if(br(h,j[z],j[z+1]))return f;(C=j[z])[1]>(_=h)[1]!=(T=j[z+1])[1]>_[1]&&_[0]<(T[0]-C[0])*(_[1]-C[1])/(T[1]-C[1])+C[0]&&(g=!g)}var _,C,T;return g}function zf(h,c){for(const f of c)if(ta(h,f))return!0;return!1}function Ih(h,c){for(const f of h)if(!ta(f,c))return!1;for(let f=0;f<h.length-1;++f)if(Us(h[f],h[f+1],c))return!1;return!0}function Pm(h,c){for(const f of c)if(Ih(h,f))return!0;return!1}function q1(h,c,f,g){const _=g[0]-f[0],C=g[1]-f[1],T=(h[0]-f[0])*C-_*(h[1]-f[1]),j=(c[0]-f[0])*C-_*(c[1]-f[1]);return T>0&&j<0||T<0&&j>0}function z0(h,c,f){const g=[];for(let _=0;_<h.length;_++){const C=[];for(let T=0;T<h[_].length;T++){const j=rn(h[_][T],f);gn(c,j),C.push(j)}g.push(C)}return g}function Q1(h,c,f){const g=[];for(let _=0;_<h.length;_++){const C=z0(h[_],c,f);g.push(C)}return g}function H1(h,c,f,g){if(h[0]<f[0]||h[0]>f[2]){const _=.5*g;let C=h[0]-f[0]>_?-g:f[0]-h[0]>_?g:0;C===0&&(C=h[0]-f[2]>_?-g:f[2]-h[0]>_?g:0),h[0]+=C}gn(c,h)}function G1(h,c,f,g){const _=Math.pow(2,g.z)*Jt,C=[g.x*Jt,g.y*Jt],T=[];for(const j of h)for(const z of j){const B=[z.x+C[0],z.y+C[1]];H1(B,c,f,_),T.push(B)}return T}function X1(h,c,f,g){const _=Math.pow(2,g.z)*Jt,C=[g.x*Jt,g.y*Jt],T=[];for(const z of h){const B=[];for(const N of z){const q=[N.x+C[0],N.y+C[1]];gn(c,q),B.push(q)}T.push(B)}if(c[2]-c[0]<=_/2){(j=c)[0]=j[1]=1/0,j[2]=j[3]=-1/0;for(const z of T)for(const B of z)H1(B,c,f,_)}var j;return T}class Eu{constructor(c,f){this.type=tr,this.geojson=c,this.geometries=f}static parse(c,f){if(c.length!==2)return f.error(`'within' expression requires exactly one argument, but found ${c.length-1} instead.`);if(Xl(c[1])){const g=c[1];if(g.type==="FeatureCollection"){const _=[];for(const C of g.features){const{type:T,coordinates:j}=C.geometry;T==="Polygon"&&_.push(j),T==="MultiPolygon"&&_.push(...j)}if(_.length)return new Eu(g,{type:"MultiPolygon",coordinates:_})}else if(g.type==="Feature"){const _=g.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Eu(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new Eu(g,g)}return f.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(f,g){const _=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],T=f.canonicalID();if(g.type==="Polygon"){const j=z0(g.coordinates,C,T),z=G1(f.geometry(),_,C,T);if(!Hr(_,C))return!1;for(const B of z)if(!ta(B,j))return!1}if(g.type==="MultiPolygon"){const j=Q1(g.coordinates,C,T),z=G1(f.geometry(),_,C,T);if(!Hr(_,C))return!1;for(const B of z)if(!zf(B,j))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(f,g){const _=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],T=f.canonicalID();if(g.type==="Polygon"){const j=z0(g.coordinates,C,T),z=X1(f.geometry(),_,C,T);if(!Hr(_,C))return!1;for(const B of z)if(!Ih(B,j))return!1}if(g.type==="MultiPolygon"){const j=Q1(g.coordinates,C,T),z=X1(f.geometry(),_,C,T);if(!Hr(_,C))return!1;for(const B of z)if(!Pm(B,j))return!1}return!0}(c,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let K1=class{constructor(h=[],c=(f,g)=>f<g?-1:f>g?1:0){if(this.data=h,this.length=this.data.length,this.compare=c,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(h){this.data.push(h),this._up(this.length++)}pop(){if(this.length===0)return;const h=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:c,compare:f}=this,g=c[h];for(;h>0;){const _=h-1>>1,C=c[_];if(f(g,C)>=0)break;c[h]=C,h=_}c[h]=g}_down(h){const{data:c,compare:f}=this,g=this.length>>1,_=c[h];for(;h<g;){let C=1+(h<<1);const T=C+1;if(T<this.length&&f(c[T],c[C])<0&&(C=T),f(c[C],_)>=0)break;c[h]=c[C],h=C}c[h]=_}};function EC(h,c,f,g,_){Z1(h,c,f,g||h.length-1,_||zC)}function Z1(h,c,f,g,_){for(;g>f;){if(g-f>600){var C=g-f+1,T=c-f+1,j=Math.log(C),z=.5*Math.exp(2*j/3),B=.5*Math.sqrt(j*z*(C-z)/C)*(T-C/2<0?-1:1);Z1(h,c,Math.max(f,Math.floor(c-T*z/C+B)),Math.min(g,Math.floor(c+(C-T)*z/C+B)),_)}var N=h[c],q=f,Z=g;for(Mf(h,f,c),_(h[g],N)>0&&Mf(h,f,g);q<Z;){for(Mf(h,q,Z),q++,Z--;_(h[q],N)<0;)q++;for(;_(h[Z],N)>0;)Z--}_(h[f],N)===0?Mf(h,f,Z):Mf(h,++Z,g),Z<=c&&(f=Z+1),c<=Z&&(g=Z-1)}}function Mf(h,c,f){var g=h[c];h[c]=h[f],h[f]=g}function zC(h,c){return h<c?-1:h>c?1:0}function Am(h,c){if(h.length<=1)return[h];const f=[];let g,_;for(const C of h){const T=IC(C);T!==0&&(C.area=Math.abs(T),_===void 0&&(_=T<0),_===T<0?(g&&f.push(g),g=[C]):g.push(C))}if(g&&f.push(g),c>1)for(let C=0;C<f.length;C++)f[C].length<=c||(EC(f[C],c,1,f[C].length-1,MC),f[C]=f[C].slice(0,c));return f}function MC(h,c){return c.area-h.area}function IC(h){let c=0;for(let f,g,_=0,C=h.length,T=C-1;_<C;T=_++)f=h[_],g=h[T],c+=(g.x-f.x)*(f.y+g.y);return c}const Y1=1/298.257223563,J1=Y1*(2-Y1),e_=Math.PI/180;class M0{constructor(c){const f=6378.137*e_*1e3,g=Math.cos(c*e_),_=1/(1-J1*(1-g*g)),C=Math.sqrt(_);this.kx=f*C*g,this.ky=f*C*_*(1-J1)}distance(c,f){const g=this.wrap(c[0]-f[0])*this.kx,_=(c[1]-f[1])*this.ky;return Math.sqrt(g*g+_*_)}pointOnLine(c,f){let g,_,C,T,j=1/0;for(let z=0;z<c.length-1;z++){let B=c[z][0],N=c[z][1],q=this.wrap(c[z+1][0]-B)*this.kx,Z=(c[z+1][1]-N)*this.ky,re=0;q===0&&Z===0||(re=(this.wrap(f[0]-B)*this.kx*q+(f[1]-N)*this.ky*Z)/(q*q+Z*Z),re>1?(B=c[z+1][0],N=c[z+1][1]):re>0&&(B+=q/this.kx*re,N+=Z/this.ky*re)),q=this.wrap(f[0]-B)*this.kx,Z=(f[1]-N)*this.ky;const se=q*q+Z*Z;se<j&&(j=se,g=B,_=N,C=z,T=re)}return{point:[g,_],index:C,t:Math.max(0,Math.min(1,T))}}wrap(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}}function t_(h,c){return c[0]-h[0]}function Em(h){return h[1]-h[0]+1}function Yl(h,c){return h[1]>=h[0]&&h[1]<c}function I0(h,c){if(h[0]>h[1])return[null,null];const f=Em(h);if(c){if(f===2)return[h,null];const _=Math.floor(f/2);return[[h[0],h[0]+_],[h[0]+_,h[1]]]}if(f===1)return[h,null];const g=Math.floor(f/2)-1;return[[h[0],h[0]+g],[h[0]+g+1,h[1]]]}function R0(h,c){if(!Yl(c,h.length))return[1/0,1/0,-1/0,-1/0];const f=[1/0,1/0,-1/0,-1/0];for(let g=c[0];g<=c[1];++g)gn(f,h[g]);return f}function D0(h){const c=[1/0,1/0,-1/0,-1/0];for(const f of h)for(const g of f)gn(c,g);return c}function zm(h){return h[0]!==-1/0&&h[1]!==-1/0&&h[2]!==1/0&&h[3]!==1/0}function L0(h,c,f){if(!zm(h)||!zm(c))return NaN;let g=0,_=0;return h[2]<c[0]&&(g=c[0]-h[2]),h[0]>c[2]&&(g=h[0]-c[2]),h[1]>c[3]&&(_=h[1]-c[3]),h[3]<c[1]&&(_=c[1]-h[3]),f.distance([0,0],[g,_])}function zu(h,c,f){const g=f.pointOnLine(c,h);return f.distance(h,g.point)}function F0(h,c,f,g,_){const C=Math.min(zu(h,[f,g],_),zu(c,[f,g],_)),T=Math.min(zu(f,[h,c],_),zu(g,[h,c],_));return Math.min(C,T)}function RC(h,c,f,g,_){if(!Yl(c,h.length)||!Yl(g,f.length))return 1/0;let C=1/0;for(let T=c[0];T<c[1];++T){const j=h[T],z=h[T+1];for(let B=g[0];B<g[1];++B){const N=f[B],q=f[B+1];if(js(j,z,N,q))return 0;C=Math.min(C,F0(j,z,N,q,_))}}return C}function mi(h,c,f,g,_){if(!Yl(c,h.length)||!Yl(g,f.length))return NaN;let C=1/0;for(let T=c[0];T<=c[1];++T)for(let j=g[0];j<=g[1];++j)if(C=Math.min(C,_.distance(h[T],f[j])),C===0)return C;return C}function DC(h,c,f){if(ta(h,c,!0))return 0;let g=1/0;for(const _ of c){const C=_[0],T=_[_.length-1];if(C!==T&&(g=Math.min(g,zu(h,[T,C],f)),g===0))return g;const j=f.pointOnLine(_,h);if(g=Math.min(g,f.distance(h,j.point)),g===0)return g}return g}function qr(h,c,f,g){if(!Yl(c,h.length))return NaN;for(let C=c[0];C<=c[1];++C)if(ta(h[C],f,!0))return 0;let _=1/0;for(let C=c[0];C<c[1];++C){const T=h[C],j=h[C+1];for(const z of f)for(let B=0,N=z.length,q=N-1;B<N;q=B++){const Z=z[q],re=z[B];if(js(T,j,Z,re))return 0;_=Math.min(_,F0(T,j,Z,re,g))}}return _}function Mm(h,c){for(const f of h)for(const g of f)if(ta(g,c,!0))return!0;return!1}function $n(h,c,f,g=1/0){const _=D0(h),C=D0(c);if(g!==1/0&&L0(_,C,f)>=g)return g;if(Hr(_,C)){if(Mm(h,c))return 0}else if(Mm(c,h))return 0;let T=1/0;for(const j of h)for(let z=0,B=j.length,N=B-1;z<B;N=z++){const q=j[N],Z=j[z];for(const re of c)for(let se=0,ae=re.length,me=ae-1;se<ae;me=se++){const we=re[me],Ze=re[se];if(js(q,Z,we,Ze))return 0;T=Math.min(T,F0(q,Z,we,Ze,f))}}return T}function Tn(h,c,f,g,_,C){if(!C)return;const T=L0(R0(g,C),_,f);T<c&&h.push([T,C,[0,0]])}function Mu(h,c,f,g,_,C,T){if(!C||!T)return;const j=L0(R0(g,C),R0(_,T),f);j<c&&h.push([j,C,T])}function If(h,c,f,g,_=1/0){let C=Math.min(g.distance(h[0],f[0][0]),_);if(C===0)return C;const T=new K1([[0,[0,h.length-1],[0,0]]],t_),j=D0(f);for(;T.length>0;){const z=T.pop();if(z[0]>=C)continue;const B=z[1],N=c?50:100;if(Em(B)<=N){if(!Yl(B,h.length))return NaN;if(c){const q=qr(h,B,f,g);if(isNaN(q)||q===0)return q;C=Math.min(C,q)}else for(let q=B[0];q<=B[1];++q){const Z=DC(h[q],f,g);if(C=Math.min(C,Z),C===0)return 0}}else{const q=I0(B,c);Tn(T,C,g,h,j,q[0]),Tn(T,C,g,h,j,q[1])}}return C}function Rf(h,c,f,g,_,C=1/0){let T=Math.min(C,_.distance(h[0],f[0]));if(T===0)return T;const j=new K1([[0,[0,h.length-1],[0,f.length-1]]],t_);for(;j.length>0;){const z=j.pop();if(z[0]>=T)continue;const B=z[1],N=z[2],q=c?50:100,Z=g?50:100;if(Em(B)<=q&&Em(N)<=Z){if(!Yl(B,h.length)&&Yl(N,f.length))return NaN;let re;if(c&&g)re=RC(h,B,f,N,_),T=Math.min(T,re);else if(c&&!g){const se=h.slice(B[0],B[1]+1);for(let ae=N[0];ae<=N[1];++ae)if(re=zu(f[ae],se,_),T=Math.min(T,re),T===0)return T}else if(!c&&g){const se=f.slice(N[0],N[1]+1);for(let ae=B[0];ae<=B[1];++ae)if(re=zu(h[ae],se,_),T=Math.min(T,re),T===0)return T}else re=mi(h,B,f,N,_),T=Math.min(T,re)}else{const re=I0(B,c),se=I0(N,g);Mu(j,T,_,h,f,re[0],se[0]),Mu(j,T,_,h,f,re[0],se[1]),Mu(j,T,_,h,f,re[1],se[0]),Mu(j,T,_,h,f,re[1],se[1])}}return T}function B0(h){return h.type==="MultiPolygon"?h.coordinates.map(c=>({type:"Polygon",coordinates:c})):h.type==="MultiLineString"?h.coordinates.map(c=>({type:"LineString",coordinates:c})):h.type==="MultiPoint"?h.coordinates.map(c=>({type:"Point",coordinates:c})):[h]}class Iu{constructor(c,f){this.type=vt,this.geojson=c,this.geometries=f}static parse(c,f){if(c.length!==2)return f.error(`'distance' expression requires exactly one argument, but found ${c.length-1} instead.`);if(Xl(c[1])){const g=c[1];if(g.type==="FeatureCollection")return new Iu(g,g.features.map(_=>B0(_.geometry)).flat());if(g.type==="Feature")return new Iu(g,B0(g.geometry));if("type"in g&&"coordinates"in g)return new Iu(g,B0(g))}return f.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(f,g){const _=f.geometry(),C=_.flat().map(z=>vn([z.x,z.y],f.canonical));if(_.length===0)return NaN;const T=new M0(C[0][1]);let j=1/0;for(const z of g){switch(z.type){case"Point":j=Math.min(j,Rf(C,!1,[z.coordinates],!1,T,j));break;case"LineString":j=Math.min(j,Rf(C,!1,z.coordinates,!0,T,j));break;case"Polygon":j=Math.min(j,If(C,!1,z.coordinates,T,j))}if(j===0)return j}return j}(c,this.geometries);if(c.geometryType()==="LineString")return function(f,g){const _=f.geometry(),C=_.flat().map(z=>vn([z.x,z.y],f.canonical));if(_.length===0)return NaN;const T=new M0(C[0][1]);let j=1/0;for(const z of g){switch(z.type){case"Point":j=Math.min(j,Rf(C,!0,[z.coordinates],!1,T,j));break;case"LineString":j=Math.min(j,Rf(C,!0,z.coordinates,!0,T,j));break;case"Polygon":j=Math.min(j,If(C,!0,z.coordinates,T,j))}if(j===0)return j}return j}(c,this.geometries);if(c.geometryType()==="Polygon")return function(f,g){const _=f.geometry();if(_.length===0||_[0].length===0)return NaN;const C=Am(_,0).map(z=>z.map(B=>B.map(N=>vn([N.x,N.y],f.canonical)))),T=new M0(C[0][0][0][1]);let j=1/0;for(const z of g)for(const B of C){switch(z.type){case"Point":j=Math.min(j,If([z.coordinates],!1,B,T,j));break;case"LineString":j=Math.min(j,If(z.coordinates,!0,B,T,j));break;case"Polygon":j=Math.min(j,$n(B,z.coordinates,T,j))}if(j===0)return j}return j}(c,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Rh={"==":A0,"!=":Af,">":Om,"<":Tm,">=":jm,"<=":E0,array:Po,at:jf,boolean:Po,case:Eh,coalesce:zc,collator:Mc,format:ye,image:Ne,in:Pf,"index-of":Ec,interpolate:Os,"interpolate-hcl":Os,"interpolate-lab":Os,length:at,let:cl,literal:jo,match:Ah,number:Po,"number-format":Ef,object:Po,slice:ju,step:ul,string:Po,"to-boolean":Ao,"to-color":Ao,"to-number":Ao,"to-string":Ao,var:tn,within:Eu,distance:Iu};class ra{constructor(c,f,g,_){this.name=c,this.type=f,this._evaluate=g,this.args=_}evaluate(c){return this._evaluate(c,this.args)}eachChild(c){this.args.forEach(c)}outputDefined(){return!1}static parse(c,f){const g=c[0],_=ra.definitions[g];if(!_)return f.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0);const C=Array.isArray(_)?_[0]:_.type,T=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,j=T.filter(([B])=>!Array.isArray(B)||B.length===c.length-1);let z=null;for(const[B,N]of j){z=new Kl(f.registry,Df,f.path,null,f.scope);const q=[];let Z=!1;for(let re=1;re<c.length;re++){const se=c[re],ae=Array.isArray(B)?B[re-1]:B.type,me=z.parse(se,1+q.length,ae);if(!me){Z=!0;break}q.push(me)}if(!Z)if(Array.isArray(B)&&B.length!==q.length)z.error(`Expected ${B.length} arguments, but found ${q.length} instead.`);else{for(let re=0;re<q.length;re++){const se=Array.isArray(B)?B[re]:B.type,ae=q[re];z.concat(re+1).checkSubtype(se,ae.type)}if(z.errors.length===0)return new ra(g,C,N,q)}}if(j.length===1)f.errors.push(...z.errors);else{const B=(j.length?j:T).map(([q])=>{return Z=q,Array.isArray(Z)?`(${Z.map(Q).join(", ")})`:`(${Q(Z.type)}...)`;var Z}).join(" | "),N=[];for(let q=1;q<c.length;q++){const Z=f.parse(c[q],1+N.length);if(!Z)return null;N.push(Q(Z.type))}f.error(`Expected arguments of type ${B}, but found (${N.join(", ")}) instead.`)}return null}static register(c,f){ra.definitions=f;for(const g in f)c[g]=ra}}function $0(h,[c,f,g,_]){c=c.evaluate(h),f=f.evaluate(h),g=g.evaluate(h);const C=_?_.evaluate(h):1,T=Pc(c,f,g,C);if(T)throw new oi(T);return new ln(c/255,f/255,g/255,C,!1)}function N0(h,c){return h in c}function V0(h,c){const f=c[h];return f===void 0?null:f}function Ru(h){return{type:h}}function Df(h){if(h instanceof tn)return Df(h.boundExpression);if(h instanceof ra&&h.name==="error"||h instanceof Mc||h instanceof Eu||h instanceof Iu)return!1;const c=h instanceof Ao||h instanceof Po;let f=!0;return h.eachChild(g=>{f=c?f&&Df(g):f&&g instanceof jo}),!!f&&Lf(h)&&Ff(h,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Lf(h){if(h instanceof ra&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof Eu||h instanceof Iu)return!1;let c=!0;return h.eachChild(f=>{c&&!Lf(f)&&(c=!1)}),c}function Dh(h){if(h instanceof ra&&h.name==="feature-state")return!1;let c=!0;return h.eachChild(f=>{c&&!Dh(f)&&(c=!1)}),c}function Ff(h,c){if(h instanceof ra&&c.indexOf(h.name)>=0)return!1;let f=!0;return h.eachChild(g=>{f&&!Ff(g,c)&&(f=!1)}),f}function Im(h){return{result:"success",value:h}}function Lh(h){return{result:"error",value:h}}function Fh(h){return h["property-type"]==="data-driven"||h["property-type"]==="cross-faded-data-driven"}function r_(h){return!!h.expression&&h.expression.parameters.indexOf("zoom")>-1}function W0(h){return!!h.expression&&h.expression.interpolated}function cn(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}function Rm(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)}function LC(h){return h}function n_(h,c){const f=c.type==="color",g=h.stops&&typeof h.stops[0][0]=="object",_=g||!(g||h.property!==void 0),C=h.type||(W0(c)?"exponential":"interval");if(f||c.type==="padding"){const N=f?ln.parse:Ws.parse;(h=Vr({},h)).stops&&(h.stops=h.stops.map(q=>[q[0],N(q[1])])),h.default=N(h.default?h.default:c.default)}if(h.colorSpace&&(T=h.colorSpace)!=="rgb"&&T!=="hcl"&&T!=="lab")throw new Error(`Unknown color space: "${h.colorSpace}"`);var T;let j,z,B;if(C==="exponential")j=s_;else if(C==="interval")j=Dm;else if(C==="categorical"){j=i_,z=Object.create(null);for(const N of h.stops)z[N[0]]=N[1];B=typeof h.stops[0][0]}else{if(C!=="identity")throw new Error(`Unknown function type "${C}"`);j=o_}if(g){const N={},q=[];for(let se=0;se<h.stops.length;se++){const ae=h.stops[se],me=ae[0].zoom;N[me]===void 0&&(N[me]={zoom:me,type:h.type,property:h.property,default:h.default,stops:[]},q.push(me)),N[me].stops.push([ae[0].value,ae[1]])}const Z=[];for(const se of q)Z.push([N[se].zoom,n_(N[se],c)]);const re={name:"linear"};return{kind:"composite",interpolationType:re,interpolationFactor:Os.interpolationFactor.bind(void 0,re),zoomStops:Z.map(se=>se[0]),evaluate:({zoom:se},ae)=>s_({stops:Z,base:h.base},c,se).evaluate(se,ae)}}if(_){const N=C==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:N,interpolationFactor:Os.interpolationFactor.bind(void 0,N),zoomStops:h.stops.map(q=>q[0]),evaluate:({zoom:q})=>j(h,c,q,z,B)}}return{kind:"source",evaluate(N,q){const Z=q&&q.properties?q.properties[h.property]:void 0;return Z===void 0?Bh(h.default,c.default):j(h,c,Z,z,B)}}}function Bh(h,c,f){return h!==void 0?h:c!==void 0?c:f!==void 0?f:void 0}function i_(h,c,f,g,_){return Bh(typeof f===_?g[f]:void 0,h.default,c.default)}function Dm(h,c,f){if(cn(f)!=="number")return Bh(h.default,c.default);const g=h.stops.length;if(g===1||f<=h.stops[0][0])return h.stops[0][1];if(f>=h.stops[g-1][0])return h.stops[g-1][1];const _=zh(h.stops.map(C=>C[0]),f);return h.stops[_][1]}function s_(h,c,f){const g=h.base!==void 0?h.base:1;if(cn(f)!=="number")return Bh(h.default,c.default);const _=h.stops.length;if(_===1||f<=h.stops[0][0])return h.stops[0][1];if(f>=h.stops[_-1][0])return h.stops[_-1][1];const C=zh(h.stops.map(N=>N[0]),f),T=function(N,q,Z,re){const se=re-Z,ae=N-Z;return se===0?0:q===1?ae/se:(Math.pow(q,ae)-1)/(Math.pow(q,se)-1)}(f,g,h.stops[C][0],h.stops[C+1][0]),j=h.stops[C][1],z=h.stops[C+1][1],B=Gi[c.type]||LC;return typeof j.evaluate=="function"?{evaluate(...N){const q=j.evaluate.apply(void 0,N),Z=z.evaluate.apply(void 0,N);if(q!==void 0&&Z!==void 0)return B(q,Z,T,h.colorSpace)}}:B(j,z,T,h.colorSpace)}function o_(h,c,f){switch(c.type){case"color":f=ln.parse(f);break;case"formatted":f=Cs.fromString(f.toString());break;case"resolvedImage":f=Ts.fromString(f.toString());break;case"padding":f=Ws.parse(f);break;default:cn(f)===c.type||c.type==="enum"&&c.values[f]||(f=void 0)}return Bh(f,h.default,c.default)}ra.register(Rh,{error:[{kind:"error"},[vr],(h,[c])=>{throw new oi(c.evaluate(h))}],typeof:[vr,[pr],(h,[c])=>Q(pi(c.evaluate(h)))],"to-rgba":[W(vt,4),[Zn],(h,[c])=>{const[f,g,_,C]=c.evaluate(h).rgb;return[255*f,255*g,255*_,C]}],rgb:[Zn,[vt,vt,vt],$0],rgba:[Zn,[vt,vt,vt,vt],$0],has:{type:tr,overloads:[[[vr],(h,[c])=>N0(c.evaluate(h),h.properties())],[[vr,_i],(h,[c,f])=>N0(c.evaluate(h),f.evaluate(h))]]},get:{type:pr,overloads:[[[vr],(h,[c])=>V0(c.evaluate(h),h.properties())],[[vr,_i],(h,[c,f])=>V0(c.evaluate(h),f.evaluate(h))]]},"feature-state":[pr,[vr],(h,[c])=>V0(c.evaluate(h),h.featureState||{})],properties:[_i,[],h=>h.properties()],"geometry-type":[vr,[],h=>h.geometryType()],id:[pr,[],h=>h.id()],zoom:[vt,[],h=>h.globals.zoom],"heatmap-density":[vt,[],h=>h.globals.heatmapDensity||0],"line-progress":[vt,[],h=>h.globals.lineProgress||0],accumulated:[pr,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],"+":[vt,Ru(vt),(h,c)=>{let f=0;for(const g of c)f+=g.evaluate(h);return f}],"*":[vt,Ru(vt),(h,c)=>{let f=1;for(const g of c)f*=g.evaluate(h);return f}],"-":{type:vt,overloads:[[[vt,vt],(h,[c,f])=>c.evaluate(h)-f.evaluate(h)],[[vt],(h,[c])=>-c.evaluate(h)]]},"/":[vt,[vt,vt],(h,[c,f])=>c.evaluate(h)/f.evaluate(h)],"%":[vt,[vt,vt],(h,[c,f])=>c.evaluate(h)%f.evaluate(h)],ln2:[vt,[],()=>Math.LN2],pi:[vt,[],()=>Math.PI],e:[vt,[],()=>Math.E],"^":[vt,[vt,vt],(h,[c,f])=>Math.pow(c.evaluate(h),f.evaluate(h))],sqrt:[vt,[vt],(h,[c])=>Math.sqrt(c.evaluate(h))],log10:[vt,[vt],(h,[c])=>Math.log(c.evaluate(h))/Math.LN10],ln:[vt,[vt],(h,[c])=>Math.log(c.evaluate(h))],log2:[vt,[vt],(h,[c])=>Math.log(c.evaluate(h))/Math.LN2],sin:[vt,[vt],(h,[c])=>Math.sin(c.evaluate(h))],cos:[vt,[vt],(h,[c])=>Math.cos(c.evaluate(h))],tan:[vt,[vt],(h,[c])=>Math.tan(c.evaluate(h))],asin:[vt,[vt],(h,[c])=>Math.asin(c.evaluate(h))],acos:[vt,[vt],(h,[c])=>Math.acos(c.evaluate(h))],atan:[vt,[vt],(h,[c])=>Math.atan(c.evaluate(h))],min:[vt,Ru(vt),(h,c)=>Math.min(...c.map(f=>f.evaluate(h)))],max:[vt,Ru(vt),(h,c)=>Math.max(...c.map(f=>f.evaluate(h)))],abs:[vt,[vt],(h,[c])=>Math.abs(c.evaluate(h))],round:[vt,[vt],(h,[c])=>{const f=c.evaluate(h);return f<0?-Math.round(-f):Math.round(f)}],floor:[vt,[vt],(h,[c])=>Math.floor(c.evaluate(h))],ceil:[vt,[vt],(h,[c])=>Math.ceil(c.evaluate(h))],"filter-==":[tr,[vr,pr],(h,[c,f])=>h.properties()[c.value]===f.value],"filter-id-==":[tr,[pr],(h,[c])=>h.id()===c.value],"filter-type-==":[tr,[vr],(h,[c])=>h.geometryType()===c.value],"filter-<":[tr,[vr,pr],(h,[c,f])=>{const g=h.properties()[c.value],_=f.value;return typeof g==typeof _&&g<_}],"filter-id-<":[tr,[pr],(h,[c])=>{const f=h.id(),g=c.value;return typeof f==typeof g&&f<g}],"filter->":[tr,[vr,pr],(h,[c,f])=>{const g=h.properties()[c.value],_=f.value;return typeof g==typeof _&&g>_}],"filter-id->":[tr,[pr],(h,[c])=>{const f=h.id(),g=c.value;return typeof f==typeof g&&f>g}],"filter-<=":[tr,[vr,pr],(h,[c,f])=>{const g=h.properties()[c.value],_=f.value;return typeof g==typeof _&&g<=_}],"filter-id-<=":[tr,[pr],(h,[c])=>{const f=h.id(),g=c.value;return typeof f==typeof g&&f<=g}],"filter->=":[tr,[vr,pr],(h,[c,f])=>{const g=h.properties()[c.value],_=f.value;return typeof g==typeof _&&g>=_}],"filter-id->=":[tr,[pr],(h,[c])=>{const f=h.id(),g=c.value;return typeof f==typeof g&&f>=g}],"filter-has":[tr,[pr],(h,[c])=>c.value in h.properties()],"filter-has-id":[tr,[],h=>h.id()!==null&&h.id()!==void 0],"filter-type-in":[tr,[W(vr)],(h,[c])=>c.value.indexOf(h.geometryType())>=0],"filter-id-in":[tr,[W(pr)],(h,[c])=>c.value.indexOf(h.id())>=0],"filter-in-small":[tr,[vr,W(pr)],(h,[c,f])=>f.value.indexOf(h.properties()[c.value])>=0],"filter-in-large":[tr,[vr,W(pr)],(h,[c,f])=>function(g,_,C,T){for(;C<=T;){const j=C+T>>1;if(_[j]===g)return!0;_[j]>g?T=j-1:C=j+1}return!1}(h.properties()[c.value],f.value,0,f.value.length-1)],all:{type:tr,overloads:[[[tr,tr],(h,[c,f])=>c.evaluate(h)&&f.evaluate(h)],[Ru(tr),(h,c)=>{for(const f of c)if(!f.evaluate(h))return!1;return!0}]]},any:{type:tr,overloads:[[[tr,tr],(h,[c,f])=>c.evaluate(h)||f.evaluate(h)],[Ru(tr),(h,c)=>{for(const f of c)if(f.evaluate(h))return!0;return!1}]]},"!":[tr,[tr],(h,[c])=>!c.evaluate(h)],"is-supported-script":[tr,[vr],(h,[c])=>{const f=h.globals&&h.globals.isSupportedScript;return!f||f(c.evaluate(h))}],upcase:[vr,[vr],(h,[c])=>c.evaluate(h).toUpperCase()],downcase:[vr,[vr],(h,[c])=>c.evaluate(h).toLowerCase()],concat:[vr,Ru(pr),(h,c)=>c.map(f=>Ou(f.evaluate(h))).join("")],"resolved-locale":[vr,[Di],(h,[c])=>c.evaluate(h).resolvedLocale()]});class Lm{constructor(c,f){var g;this.expression=c,this._warningHistory={},this._evaluator=new Ac,this._defaultValue=f?(g=f).type==="color"&&Rm(g.default)?new ln(0,0,0,0):g.type==="color"?ln.parse(g.default)||null:g.type==="padding"?Ws.parse(g.default)||null:g.type==="variableAnchorOffsetCollection"?uo.parse(g.default)||null:g.default===void 0?null:g.default:null,this._enumValues=f&&f.type==="enum"?f.values:null}evaluateWithoutErrorHandling(c,f,g,_,C,T){return this._evaluator.globals=c,this._evaluator.feature=f,this._evaluator.featureState=g,this._evaluator.canonical=_,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=T,this.expression.evaluate(this._evaluator)}evaluate(c,f,g,_,C,T){this._evaluator.globals=c,this._evaluator.feature=f||null,this._evaluator.featureState=g||null,this._evaluator.canonical=_,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=T||null;try{const j=this.expression.evaluate(this._evaluator);if(j==null||typeof j=="number"&&j!=j)return this._defaultValue;if(this._enumValues&&!(j in this._enumValues))throw new oi(`Expected value to be one of ${Object.keys(this._enumValues).map(z=>JSON.stringify(z)).join(", ")}, but found ${JSON.stringify(j)} instead.`);return j}catch(j){return this._warningHistory[j.message]||(this._warningHistory[j.message]=!0,typeof console<"u"&&console.warn(j.message)),this._defaultValue}}}function Fm(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in Rh}function $h(h,c){const f=new Kl(Rh,Df,[],c?function(_){const C={color:Zn,string:vr,number:vt,enum:vr,boolean:tr,formatted:ks,padding:Li,resolvedImage:cs,variableAnchorOffsetCollection:ge};return _.type==="array"?W(C[_.value]||pr,_.length):C[_.type]}(c):void 0),g=f.parse(h,void 0,void 0,void 0,c&&c.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?Im(new Lm(g,c)):Lh(f.errors)}class Nh{constructor(c,f){this.kind=c,this._styleExpression=f,this.isStateDependent=c!=="constant"&&!Dh(f.expression)}evaluateWithoutErrorHandling(c,f,g,_,C,T){return this._styleExpression.evaluateWithoutErrorHandling(c,f,g,_,C,T)}evaluate(c,f,g,_,C,T){return this._styleExpression.evaluate(c,f,g,_,C,T)}}class Vh{constructor(c,f,g,_){this.kind=c,this.zoomStops=g,this._styleExpression=f,this.isStateDependent=c!=="camera"&&!Dh(f.expression),this.interpolationType=_}evaluateWithoutErrorHandling(c,f,g,_,C,T){return this._styleExpression.evaluateWithoutErrorHandling(c,f,g,_,C,T)}evaluate(c,f,g,_,C,T){return this._styleExpression.evaluate(c,f,g,_,C,T)}interpolationFactor(c,f,g){return this.interpolationType?Os.interpolationFactor(this.interpolationType,c,f,g):0}}function U0(h,c){const f=$h(h,c);if(f.result==="error")return f;const g=f.value.expression,_=Lf(g);if(!_&&!Fh(c))return Lh([new Ct("","data expressions not supported")]);const C=Ff(g,["zoom"]);if(!C&&!r_(c))return Lh([new Ct("","zoom expressions not supported")]);const T=Bf(g);return T||C?T instanceof Ct?Lh([T]):T instanceof Os&&!W0(c)?Lh([new Ct("",'"interpolate" expressions cannot be used with this property')]):Im(T?new Vh(_?"camera":"composite",f.value,T.labels,T instanceof Os?T.interpolation:void 0):new Nh(_?"constant":"source",f.value)):Lh([new Ct("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Wh{constructor(c,f){this._parameters=c,this._specification=f,Vr(this,n_(this._parameters,this._specification))}static deserialize(c){return new Wh(c._parameters,c._specification)}static serialize(c){return{_parameters:c._parameters,_specification:c._specification}}}function Bf(h){let c=null;if(h instanceof cl)c=Bf(h.result);else if(h instanceof zc){for(const f of h.args)if(c=Bf(f),c)break}else(h instanceof ul||h instanceof Os)&&h.input instanceof ra&&h.input.name==="zoom"&&(c=h);return c instanceof Ct||h.eachChild(f=>{const g=Bf(f);g instanceof Ct?c=g:!c&&g?c=new Ct("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&g&&c!==g&&(c=new Ct("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),c}function Bm(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(const c of h.slice(1))if(!Bm(c)&&typeof c!="boolean")return!1;return!0;default:return!0}}const $m={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function q0(h){if(h==null)return{filter:()=>!0,needGeometry:!1};Bm(h)||(h=Nm(h));const c=$h(h,$m);if(c.result==="error")throw new Error(c.value.map(f=>`${f.key}: ${f.message}`).join(", "));return{filter:(f,g,_)=>c.value.evaluate(f,g,{},_),needGeometry:a_(h)}}function FC(h,c){return h<c?-1:h>c?1:0}function a_(h){if(!Array.isArray(h))return!1;if(h[0]==="within"||h[0]==="distance")return!0;for(let c=1;c<h.length;c++)if(a_(h[c]))return!0;return!1}function Nm(h){if(!h)return!0;const c=h[0];return h.length<=1?c!=="any":c==="=="?Q0(h[1],h[2],"=="):c==="!="?Ps(Q0(h[1],h[2],"==")):c==="<"||c===">"||c==="<="||c===">="?Q0(h[1],h[2],c):c==="any"?(f=h.slice(1),["any"].concat(f.map(Nm))):c==="all"?["all"].concat(h.slice(1).map(Nm)):c==="none"?["all"].concat(h.slice(1).map(Nm).map(Ps)):c==="in"?$f(h[1],h.slice(2)):c==="!in"?Ps($f(h[1],h.slice(2))):c==="has"?Nf(h[1]):c!=="!has"||Ps(Nf(h[1]));var f}function Q0(h,c,f){switch(h){case"$type":return[`filter-type-${f}`,c];case"$id":return[`filter-id-${f}`,c];default:return[`filter-${f}`,h,c]}}function $f(h,c){if(c.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",c]];case"$id":return["filter-id-in",["literal",c]];default:return c.length>200&&!c.some(f=>typeof f!=typeof c[0])?["filter-in-large",h,["literal",c.sort(FC)]]:["filter-in-small",h,["literal",c]]}}function Nf(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function Ps(h){return["!",h]}function Du(h){const c=typeof h;if(c==="number"||c==="boolean"||c==="string"||h==null)return JSON.stringify(h);if(Array.isArray(h)){let _="[";for(const C of h)_+=`${Du(C)},`;return`${_}]`}const f=Object.keys(h).sort();let g="{";for(let _=0;_<f.length;_++)g+=`${JSON.stringify(f[_])}:${Du(h[f[_]])},`;return`${g}}`}function l_(h){let c="";for(const f of ct)c+=`/${Du(h[f])}`;return c}function c_(h){const c=h.value;return c?[new He(h.key,c,"constants have been deprecated as of v8")]:[]}function gi(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function Ra(h){if(Array.isArray(h))return h.map(Ra);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){const c={};for(const f in h)c[f]=Ra(h[f]);return c}return gi(h)}function Eo(h){const c=h.key,f=h.value,g=h.valueSpec||{},_=h.objectElementValidators||{},C=h.style,T=h.styleSpec,j=h.validateSpec;let z=[];const B=cn(f);if(B!=="object")return[new He(c,f,`object expected, ${B} found`)];for(const N in f){const q=N.split(".")[0],Z=g[q]||g["*"];let re;if(_[q])re=_[q];else if(g[q])re=j;else if(_["*"])re=_["*"];else{if(!g["*"]){z.push(new He(c,f[N],`unknown property "${N}"`));continue}re=j}z=z.concat(re({key:(c&&`${c}.`)+N,value:f[N],valueSpec:Z,style:C,styleSpec:T,object:f,objectKey:N,validateSpec:j},f))}for(const N in g)_[N]||g[N].required&&g[N].default===void 0&&f[N]===void 0&&z.push(new He(c,f,`missing required property "${N}"`));return z}function Vf(h){const c=h.value,f=h.valueSpec,g=h.style,_=h.styleSpec,C=h.key,T=h.arrayElementValidator||h.validateSpec;if(cn(c)!=="array")return[new He(C,c,`array expected, ${cn(c)} found`)];if(f.length&&c.length!==f.length)return[new He(C,c,`array length ${f.length} expected, length ${c.length} found`)];if(f["min-length"]&&c.length<f["min-length"])return[new He(C,c,`array length at least ${f["min-length"]} expected, length ${c.length} found`)];let j={type:f.value,values:f.values};_.$version<7&&(j.function=f.function),cn(f.value)==="object"&&(j=f.value);let z=[];for(let B=0;B<c.length;B++)z=z.concat(T({array:c,arrayIndex:B,value:c[B],valueSpec:j,validateSpec:h.validateSpec,style:g,styleSpec:_,key:`${C}[${B}]`}));return z}function H0(h){const c=h.key,f=h.value,g=h.valueSpec;let _=cn(f);return _==="number"&&f!=f&&(_="NaN"),_!=="number"?[new He(c,f,`number expected, ${_} found`)]:"minimum"in g&&f<g.minimum?[new He(c,f,`${f} is less than the minimum value ${g.minimum}`)]:"maximum"in g&&f>g.maximum?[new He(c,f,`${f} is greater than the maximum value ${g.maximum}`)]:[]}function Vm(h){const c=h.valueSpec,f=gi(h.value.type);let g,_,C,T={};const j=f!=="categorical"&&h.value.property===void 0,z=!j,B=cn(h.value.stops)==="array"&&cn(h.value.stops[0])==="array"&&cn(h.value.stops[0][0])==="object",N=Eo({key:h.key,value:h.value,valueSpec:h.styleSpec.function,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(re){if(f==="identity")return[new He(re.key,re.value,'identity function may not have a "stops" property')];let se=[];const ae=re.value;return se=se.concat(Vf({key:re.key,value:ae,valueSpec:re.valueSpec,validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec,arrayElementValidator:q})),cn(ae)==="array"&&ae.length===0&&se.push(new He(re.key,ae,"array must have at least one stop")),se},default:function(re){return re.validateSpec({key:re.key,value:re.value,valueSpec:c,validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec})}}});return f==="identity"&&j&&N.push(new He(h.key,h.value,'missing required property "property"')),f==="identity"||h.value.stops||N.push(new He(h.key,h.value,'missing required property "stops"')),f==="exponential"&&h.valueSpec.expression&&!W0(h.valueSpec)&&N.push(new He(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(z&&!Fh(h.valueSpec)?N.push(new He(h.key,h.value,"property functions not supported")):j&&!r_(h.valueSpec)&&N.push(new He(h.key,h.value,"zoom functions not supported"))),f!=="categorical"&&!B||h.value.property!==void 0||N.push(new He(h.key,h.value,'"property" property is required')),N;function q(re){let se=[];const ae=re.value,me=re.key;if(cn(ae)!=="array")return[new He(me,ae,`array expected, ${cn(ae)} found`)];if(ae.length!==2)return[new He(me,ae,`array length 2 expected, length ${ae.length} found`)];if(B){if(cn(ae[0])!=="object")return[new He(me,ae,`object expected, ${cn(ae[0])} found`)];if(ae[0].zoom===void 0)return[new He(me,ae,"object stop key must have zoom")];if(ae[0].value===void 0)return[new He(me,ae,"object stop key must have value")];if(C&&C>gi(ae[0].zoom))return[new He(me,ae[0].zoom,"stop zoom values must appear in ascending order")];gi(ae[0].zoom)!==C&&(C=gi(ae[0].zoom),_=void 0,T={}),se=se.concat(Eo({key:`${me}[0]`,value:ae[0],valueSpec:{zoom:{}},validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec,objectElementValidators:{zoom:H0,value:Z}}))}else se=se.concat(Z({key:`${me}[0]`,value:ae[0],validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec},ae));return Fm(Ra(ae[1]))?se.concat([new He(`${me}[1]`,ae[1],"expressions are not allowed in function stops.")]):se.concat(re.validateSpec({key:`${me}[1]`,value:ae[1],valueSpec:c,validateSpec:re.validateSpec,style:re.style,styleSpec:re.styleSpec}))}function Z(re,se){const ae=cn(re.value),me=gi(re.value),we=re.value!==null?re.value:se;if(g){if(ae!==g)return[new He(re.key,we,`${ae} stop domain type must match previous stop domain type ${g}`)]}else g=ae;if(ae!=="number"&&ae!=="string"&&ae!=="boolean")return[new He(re.key,we,"stop domain value must be a number, string, or boolean")];if(ae!=="number"&&f!=="categorical"){let Ze=`number expected, ${ae} found`;return Fh(c)&&f===void 0&&(Ze+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new He(re.key,we,Ze)]}return f!=="categorical"||ae!=="number"||isFinite(me)&&Math.floor(me)===me?f!=="categorical"&&ae==="number"&&_!==void 0&&me<_?[new He(re.key,we,"stop domain values must appear in ascending order")]:(_=me,f==="categorical"&&me in T?[new He(re.key,we,"stop domain values must be unique")]:(T[me]=!0,[])):[new He(re.key,we,`integer expected, found ${me}`)]}}function Uh(h){const c=(h.expressionContext==="property"?U0:$h)(Ra(h.value),h.valueSpec);if(c.result==="error")return c.value.map(g=>new He(`${h.key}${g.key}`,h.value,g.message));const f=c.value.expression||c.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!f.outputDefined())return[new He(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!Dh(f))return[new He(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter"&&!Dh(f))return[new He(h.key,h.value,'"feature-state" data expressions are not supported with filters.')];if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!Ff(f,["zoom","feature-state"]))return[new He(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!Lf(f))return[new He(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Jl(h){const c=h.key,f=h.value,g=h.valueSpec,_=[];return Array.isArray(g.values)?g.values.indexOf(gi(f))===-1&&_.push(new He(c,f,`expected one of [${g.values.join(", ")}], ${JSON.stringify(f)} found`)):Object.keys(g.values).indexOf(gi(f))===-1&&_.push(new He(c,f,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(f)} found`)),_}function G0(h){return Bm(Ra(h.value))?Uh(Vr({},h,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Wm(h)}function Wm(h){const c=h.value,f=h.key;if(cn(c)!=="array")return[new He(f,c,`array expected, ${cn(c)} found`)];const g=h.styleSpec;let _,C=[];if(c.length<1)return[new He(f,c,"filter array must have at least 1 element")];switch(C=C.concat(Jl({key:`${f}[0]`,value:c[0],valueSpec:g.filter_operator,style:h.style,styleSpec:h.styleSpec})),gi(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&gi(c[1])==="$type"&&C.push(new He(f,c,`"$type" cannot be use with operator "${c[0]}"`));case"==":case"!=":c.length!==3&&C.push(new He(f,c,`filter array for operator "${c[0]}" must have 3 elements`));case"in":case"!in":c.length>=2&&(_=cn(c[1]),_!=="string"&&C.push(new He(`${f}[1]`,c[1],`string expected, ${_} found`)));for(let T=2;T<c.length;T++)_=cn(c[T]),gi(c[1])==="$type"?C=C.concat(Jl({key:`${f}[${T}]`,value:c[T],valueSpec:g.geometry_type,style:h.style,styleSpec:h.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&C.push(new He(`${f}[${T}]`,c[T],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let T=1;T<c.length;T++)C=C.concat(Wm({key:`${f}[${T}]`,value:c[T],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":_=cn(c[1]),c.length!==2?C.push(new He(f,c,`filter array for "${c[0]}" operator must have 2 elements`)):_!=="string"&&C.push(new He(`${f}[1]`,c[1],`string expected, ${_} found`))}return C}function X0(h,c){const f=h.key,g=h.validateSpec,_=h.style,C=h.styleSpec,T=h.value,j=h.objectKey,z=C[`${c}_${h.layerType}`];if(!z)return[];const B=j.match(/^(.*)-transition$/);if(c==="paint"&&B&&z[B[1]]&&z[B[1]].transition)return g({key:f,value:T,valueSpec:C.transition,style:_,styleSpec:C});const N=h.valueSpec||z[j];if(!N)return[new He(f,T,`unknown property "${j}"`)];let q;if(cn(T)==="string"&&Fh(N)&&!N.tokens&&(q=/^{([^}]+)}$/.exec(T)))return[new He(f,T,`"${j}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(q[1])} }\`.`)];const Z=[];return h.layerType==="symbol"&&(j==="text-field"&&_&&!_.glyphs&&Z.push(new He(f,T,'use of "text-field" requires a style "glyphs" property')),j==="text-font"&&Rm(Ra(T))&&gi(T.type)==="identity"&&Z.push(new He(f,T,'"text-font" does not support identity functions'))),Z.concat(g({key:h.key,value:T,valueSpec:N,style:_,styleSpec:C,expressionContext:"property",propertyType:c,propertyKey:j}))}function Um(h){return X0(h,"paint")}function K0(h){return X0(h,"layout")}function Z0(h){let c=[];const f=h.value,g=h.key,_=h.style,C=h.styleSpec;f.type||f.ref||c.push(new He(g,f,'either "type" or "ref" is required'));let T=gi(f.type);const j=gi(f.ref);if(f.id){const z=gi(f.id);for(let B=0;B<h.arrayIndex;B++){const N=_.layers[B];gi(N.id)===z&&c.push(new He(g,f.id,`duplicate layer id "${f.id}", previously used at line ${N.id.__line__}`))}}if("ref"in f){let z;["type","source","source-layer","filter","layout"].forEach(B=>{B in f&&c.push(new He(g,f[B],`"${B}" is prohibited for ref layers`))}),_.layers.forEach(B=>{gi(B.id)===j&&(z=B)}),z?z.ref?c.push(new He(g,f.ref,"ref cannot reference another ref layer")):T=gi(z.type):c.push(new He(g,f.ref,`ref layer "${j}" not found`))}else if(T!=="background")if(f.source){const z=_.sources&&_.sources[f.source],B=z&&gi(z.type);z?B==="vector"&&T==="raster"?c.push(new He(g,f.source,`layer "${f.id}" requires a raster source`)):B!=="raster-dem"&&T==="hillshade"?c.push(new He(g,f.source,`layer "${f.id}" requires a raster-dem source`)):B==="raster"&&T!=="raster"?c.push(new He(g,f.source,`layer "${f.id}" requires a vector source`)):B!=="vector"||f["source-layer"]?B==="raster-dem"&&T!=="hillshade"?c.push(new He(g,f.source,"raster-dem source can only be used with layer type 'hillshade'.")):T!=="line"||!f.paint||!f.paint["line-gradient"]||B==="geojson"&&z.lineMetrics||c.push(new He(g,f,`layer "${f.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):c.push(new He(g,f,`layer "${f.id}" must specify a "source-layer"`)):c.push(new He(g,f.source,`source "${f.source}" not found`))}else c.push(new He(g,f,'missing required property "source"'));return c=c.concat(Eo({key:g,value:f,valueSpec:C.layer,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,objectElementValidators:{"*":()=>[],type:()=>h.validateSpec({key:`${g}.type`,value:f.type,valueSpec:C.layer.type,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,object:f,objectKey:"type"}),filter:G0,layout:z=>Eo({layer:f,key:z.key,value:z.value,style:z.style,styleSpec:z.styleSpec,validateSpec:z.validateSpec,objectElementValidators:{"*":B=>K0(Vr({layerType:T},B))}}),paint:z=>Eo({layer:f,key:z.key,value:z.value,style:z.style,styleSpec:z.styleSpec,validateSpec:z.validateSpec,objectElementValidators:{"*":B=>Um(Vr({layerType:T},B))}})}})),c}function Lu(h){const c=h.value,f=h.key,g=cn(c);return g!=="string"?[new He(f,c,`string expected, ${g} found`)]:[]}const qm={promoteId:function({key:h,value:c}){if(cn(c)==="string")return Lu({key:h,value:c});{const f=[];for(const g in c)f.push(...Lu({key:`${h}.${g}`,value:c[g]}));return f}}};function Wf(h){const c=h.value,f=h.key,g=h.styleSpec,_=h.style,C=h.validateSpec;if(!c.type)return[new He(f,c,'"type" is required')];const T=gi(c.type);let j;switch(T){case"vector":case"raster":return j=Eo({key:f,value:c,valueSpec:g[`source_${T.replace("-","_")}`],style:h.style,styleSpec:g,objectElementValidators:qm,validateSpec:C}),j;case"raster-dem":return j=function(z){var B;const N=(B=z.sourceName)!==null&&B!==void 0?B:"",q=z.value,Z=z.styleSpec,re=Z.source_raster_dem,se=z.style;let ae=[];const me=cn(q);if(q===void 0)return ae;if(me!=="object")return ae.push(new He("source_raster_dem",q,`object expected, ${me} found`)),ae;const we=gi(q.encoding)==="custom",Ze=["redFactor","greenFactor","blueFactor","baseShift"],Ee=z.value.encoding?`"${z.value.encoding}"`:"Default";for(const Qe in q)!we&&Ze.includes(Qe)?ae.push(new He(Qe,q[Qe],`In "${N}": "${Qe}" is only valid when "encoding" is set to "custom". ${Ee} encoding found`)):re[Qe]?ae=ae.concat(z.validateSpec({key:Qe,value:q[Qe],valueSpec:re[Qe],validateSpec:z.validateSpec,style:se,styleSpec:Z})):ae.push(new He(Qe,q[Qe],`unknown property "${Qe}"`));return ae}({sourceName:f,value:c,style:h.style,styleSpec:g,validateSpec:C}),j;case"geojson":if(j=Eo({key:f,value:c,valueSpec:g.source_geojson,style:_,styleSpec:g,validateSpec:C,objectElementValidators:qm}),c.cluster)for(const z in c.clusterProperties){const[B,N]=c.clusterProperties[z],q=typeof B=="string"?[B,["accumulated"],["get",z]]:B;j.push(...Uh({key:`${f}.${z}.map`,value:N,expressionContext:"cluster-map"})),j.push(...Uh({key:`${f}.${z}.reduce`,value:q,expressionContext:"cluster-reduce"}))}return j;case"video":return Eo({key:f,value:c,valueSpec:g.source_video,style:_,validateSpec:C,styleSpec:g});case"image":return Eo({key:f,value:c,valueSpec:g.source_image,style:_,validateSpec:C,styleSpec:g});case"canvas":return[new He(f,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Jl({key:`${f}.type`,value:c.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Y0(h){const c=h.value,f=h.styleSpec,g=f.light,_=h.style;let C=[];const T=cn(c);if(c===void 0)return C;if(T!=="object")return C=C.concat([new He("light",c,`object expected, ${T} found`)]),C;for(const j in c){const z=j.match(/^(.*)-transition$/);C=C.concat(z&&g[z[1]]&&g[z[1]].transition?h.validateSpec({key:j,value:c[j],valueSpec:f.transition,validateSpec:h.validateSpec,style:_,styleSpec:f}):g[j]?h.validateSpec({key:j,value:c[j],valueSpec:g[j],validateSpec:h.validateSpec,style:_,styleSpec:f}):[new He(j,c[j],`unknown property "${j}"`)])}return C}function J0(h){const c=h.value,f=h.styleSpec,g=f.sky,_=h.style,C=cn(c);if(c===void 0)return[];if(C!=="object")return[new He("sky",c,`object expected, ${C} found`)];let T=[];for(const j in c)T=T.concat(g[j]?h.validateSpec({key:j,value:c[j],valueSpec:g[j],style:_,styleSpec:f}):[new He(j,c[j],`unknown property "${j}"`)]);return T}function ex(h){const c=h.value,f=h.styleSpec,g=f.terrain,_=h.style;let C=[];const T=cn(c);if(c===void 0)return C;if(T!=="object")return C=C.concat([new He("terrain",c,`object expected, ${T} found`)]),C;for(const j in c)C=C.concat(g[j]?h.validateSpec({key:j,value:c[j],valueSpec:g[j],validateSpec:h.validateSpec,style:_,styleSpec:f}):[new He(j,c[j],`unknown property "${j}"`)]);return C}function tx(h){let c=[];const f=h.value,g=h.key;if(Array.isArray(f)){const _=[],C=[];for(const T in f)f[T].id&&_.includes(f[T].id)&&c.push(new He(g,f,`all the sprites' ids must be unique, but ${f[T].id} is duplicated`)),_.push(f[T].id),f[T].url&&C.includes(f[T].url)&&c.push(new He(g,f,`all the sprites' URLs must be unique, but ${f[T].url} is duplicated`)),C.push(f[T].url),c=c.concat(Eo({key:`${g}[${T}]`,value:f[T],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:h.validateSpec}));return c}return Lu({key:g,value:f})}const Qm={"*":()=>[],array:Vf,boolean:function(h){const c=h.value,f=h.key,g=cn(c);return g!=="boolean"?[new He(f,c,`boolean expected, ${g} found`)]:[]},number:H0,color:function(h){const c=h.key,f=h.value,g=cn(f);return g!=="string"?[new He(c,f,`color expected, ${g} found`)]:ln.parse(String(f))?[]:[new He(c,f,`color expected, "${f}" found`)]},constants:c_,enum:Jl,filter:G0,function:Vm,layer:Z0,object:Eo,source:Wf,light:Y0,sky:J0,terrain:ex,projection:function(h){const c=h.value,f=h.styleSpec,g=f.projection,_=h.style,C=cn(c);if(c===void 0)return[];if(C!=="object")return[new He("projection",c,`object expected, ${C} found`)];let T=[];for(const j in c)T=T.concat(g[j]?h.validateSpec({key:j,value:c[j],valueSpec:g[j],style:_,styleSpec:f}):[new He(j,c[j],`unknown property "${j}"`)]);return T},string:Lu,formatted:function(h){return Lu(h).length===0?[]:Uh(h)},resolvedImage:function(h){return Lu(h).length===0?[]:Uh(h)},padding:function(h){const c=h.key,f=h.value;if(cn(f)==="array"){if(f.length<1||f.length>4)return[new He(c,f,`padding requires 1 to 4 values; ${f.length} values found`)];const g={type:"number"};let _=[];for(let C=0;C<f.length;C++)_=_.concat(h.validateSpec({key:`${c}[${C}]`,value:f[C],validateSpec:h.validateSpec,valueSpec:g}));return _}return H0({key:c,value:f,valueSpec:{}})},variableAnchorOffsetCollection:function(h){const c=h.key,f=h.value,g=cn(f),_=h.styleSpec;if(g!=="array"||f.length<1||f.length%2!=0)return[new He(c,f,"variableAnchorOffsetCollection requires a non-empty array of even length")];let C=[];for(let T=0;T<f.length;T+=2)C=C.concat(Jl({key:`${c}[${T}]`,value:f[T],valueSpec:_.layout_symbol["text-anchor"]})),C=C.concat(Vf({key:`${c}[${T+1}]`,value:f[T+1],valueSpec:{length:2,value:"number"},validateSpec:h.validateSpec,style:h.style,styleSpec:_}));return C},sprite:tx};function Uf(h){const c=h.value,f=h.valueSpec,g=h.styleSpec;return h.validateSpec=Uf,f.expression&&Rm(gi(c))?Vm(h):f.expression&&Fm(Ra(c))?Uh(h):f.type&&Qm[f.type]?Qm[f.type](h):Eo(Vr({},h,{valueSpec:f.type?g[f.type]:f}))}function u_(h){const c=h.value,f=h.key,g=Lu(h);return g.length||(c.indexOf("{fontstack}")===-1&&g.push(new He(f,c,'"glyphs" url must include a "{fontstack}" token')),c.indexOf("{range}")===-1&&g.push(new He(f,c,'"glyphs" url must include a "{range}" token'))),g}function na(h,c=Te){let f=[];return f=f.concat(Uf({key:"",value:h,valueSpec:c.$root,styleSpec:c,style:h,validateSpec:Uf,objectElementValidators:{glyphs:u_,"*":()=>[]}})),h.constants&&(f=f.concat(c_({key:"constants",value:h.constants}))),rx(f)}function dl(h){return function(c){return h({...c,validateSpec:Uf})}}function rx(h){return[].concat(h).sort((c,f)=>c.line-f.line)}function Da(h){return function(...c){return rx(h.apply(this,c))}}na.source=Da(dl(Wf)),na.sprite=Da(dl(tx)),na.glyphs=Da(dl(u_)),na.light=Da(dl(Y0)),na.sky=Da(dl(J0)),na.terrain=Da(dl(ex)),na.layer=Da(dl(Z0)),na.filter=Da(dl(G0)),na.paintProperty=Da(dl(Um)),na.layoutProperty=Da(dl(K0));const Fu=na,BC=Fu.light,$C=Fu.sky,h_=Fu.paintProperty,d_=Fu.layoutProperty;function nx(h,c){let f=!1;if(c&&c.length)for(const g of c)h.fire(new _t(new Error(g.message))),f=!0;return f}class qh{constructor(c,f,g){const _=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;const T=new Int32Array(this.arrayBuffer);c=T[0],this.d=(f=T[1])+2*(g=T[2]);for(let z=0;z<this.d*this.d;z++){const B=T[3+z],N=T[3+z+1];_.push(B===N?null:T.subarray(B,N))}const j=T[3+_.length+1];this.keys=T.subarray(T[3+_.length],j),this.bboxes=T.subarray(j),this.insert=this._insertReadonly}else{this.d=f+2*g;for(let T=0;T<this.d*this.d;T++)_.push([]);this.keys=[],this.bboxes=[]}this.n=f,this.extent=c,this.padding=g,this.scale=f/c,this.uid=0;const C=g/f*c;this.min=-C,this.max=c+C}insert(c,f,g,_,C){this._forEachCell(f,g,_,C,this._insertCell,this.uid++,void 0,void 0),this.keys.push(c),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(_),this.bboxes.push(C)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(c,f,g,_,C,T){this.cells[C].push(T)}query(c,f,g,_,C){const T=this.min,j=this.max;if(c<=T&&f<=T&&j<=g&&j<=_&&!C)return Array.prototype.slice.call(this.keys);{const z=[];return this._forEachCell(c,f,g,_,this._queryCell,z,{},C),z}}_queryCell(c,f,g,_,C,T,j,z){const B=this.cells[C];if(B!==null){const N=this.keys,q=this.bboxes;for(let Z=0;Z<B.length;Z++){const re=B[Z];if(j[re]===void 0){const se=4*re;(z?z(q[se+0],q[se+1],q[se+2],q[se+3]):c<=q[se+2]&&f<=q[se+3]&&g>=q[se+0]&&_>=q[se+1])?(j[re]=!0,T.push(N[re])):j[re]=!1}}}}_forEachCell(c,f,g,_,C,T,j,z){const B=this._convertToCellCoord(c),N=this._convertToCellCoord(f),q=this._convertToCellCoord(g),Z=this._convertToCellCoord(_);for(let re=B;re<=q;re++)for(let se=N;se<=Z;se++){const ae=this.d*se+re;if((!z||z(this._convertFromCellCoord(re),this._convertFromCellCoord(se),this._convertFromCellCoord(re+1),this._convertFromCellCoord(se+1)))&&C.call(this,c,f,g,_,ae,T,j,z))return}}_convertFromCellCoord(c){return(c-this.padding)/this.scale}_convertToCellCoord(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const c=this.cells,f=3+this.cells.length+1+1;let g=0;for(let T=0;T<this.cells.length;T++)g+=this.cells[T].length;const _=new Int32Array(f+g+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;let C=f;for(let T=0;T<c.length;T++){const j=c[T];_[3+T]=C,_.set(j,C),C+=j.length}return _[3+c.length]=C,_.set(this.keys,C),C+=this.keys.length,_[3+c.length+1]=C,_.set(this.bboxes,C),C+=this.bboxes.length,_.buffer}static serialize(c,f){const g=c.toArrayBuffer();return f&&f.push(g),{buffer:g}}static deserialize(c){return new qh(c.buffer)}}const ia={};function Kt(h,c,f={}){if(ia[h])throw new Error(`${h} is already registered.`);Object.defineProperty(c,"_classRegistryKey",{value:h,writeable:!1}),ia[h]={klass:c,omit:f.omit||[],shallow:f.shallow||[]}}Kt("Object",Object),Kt("TransferableGridIndex",qh),Kt("Color",ln),Kt("Error",Error),Kt("AJAXError",Ke),Kt("ResolvedImage",Ts),Kt("StylePropertyFunction",Wh),Kt("StyleExpression",Lm,{omit:["_evaluator"]}),Kt("ZoomDependentExpression",Vh),Kt("ZoomConstantExpression",Nh),Kt("CompoundExpression",ra,{omit:["_evaluate"]});for(const h in Rh)Rh[h]._classRegistryKey||Kt(`Expression_${h}`,Rh[h]);function Hm(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function ix(h){return h.$name||h.constructor._classRegistryKey}function f_(h){return!function(c){if(c===null||typeof c!="object")return!1;const f=ix(c);return!(!f||f==="Object")}(h)&&(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob||h instanceof Error||Hm(h)||Be(h)||ArrayBuffer.isView(h)||h instanceof ImageData)}function Qh(h,c){if(f_(h))return(Hm(h)||Be(h))&&c&&c.push(h),ArrayBuffer.isView(h)&&c&&c.push(h.buffer),h instanceof ImageData&&c&&c.push(h.data.buffer),h;if(Array.isArray(h)){const C=[];for(const T of h)C.push(Qh(T,c));return C}if(typeof h!="object")throw new Error("can't serialize object of type "+typeof h);const f=ix(h);if(!f)throw new Error(`can't serialize object of unregistered class ${h.constructor.name}`);if(!ia[f])throw new Error(`${f} is not registered.`);const{klass:g}=ia[f],_=g.serialize?g.serialize(h,c):{};if(g.serialize){if(c&&_===c[c.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const C in h){if(!h.hasOwnProperty(C)||ia[f].omit.indexOf(C)>=0)continue;const T=h[C];_[C]=ia[f].shallow.indexOf(C)>=0?T:Qh(T,c)}h instanceof Error&&(_.message=h.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(_.$name=f),_}function Hh(h){if(f_(h))return h;if(Array.isArray(h))return h.map(Hh);if(typeof h!="object")throw new Error("can't deserialize object of type "+typeof h);const c=ix(h)||"Object";if(!ia[c])throw new Error(`can't deserialize unregistered class ${c}`);const{klass:f}=ia[c];if(!f)throw new Error(`can't deserialize unregistered class ${c}`);if(f.deserialize)return f.deserialize(h);const g=Object.create(f.prototype);for(const _ of Object.keys(h)){if(_==="$name")continue;const C=h[_];g[_]=ia[c].shallow.indexOf(_)>=0?C:Hh(C)}return g}class sx{constructor(){this.first=!0}update(c,f){const g=Math.floor(c);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=f):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=f),c!==this.lastZoom&&(this.lastZoom=c,this.lastFloorZoom=g,!0))}}const Zr={"Latin-1 Supplement":h=>h>=128&&h<=255,"Hangul Jamo":h=>h>=4352&&h<=4607,Khmer:h=>h>=6016&&h<=6143,"General Punctuation":h=>h>=8192&&h<=8303,"Letterlike Symbols":h=>h>=8448&&h<=8527,"Number Forms":h=>h>=8528&&h<=8591,"Miscellaneous Technical":h=>h>=8960&&h<=9215,"Control Pictures":h=>h>=9216&&h<=9279,"Optical Character Recognition":h=>h>=9280&&h<=9311,"Enclosed Alphanumerics":h=>h>=9312&&h<=9471,"Geometric Shapes":h=>h>=9632&&h<=9727,"Miscellaneous Symbols":h=>h>=9728&&h<=9983,"Miscellaneous Symbols and Arrows":h=>h>=11008&&h<=11263,"Ideographic Description Characters":h=>h>=12272&&h<=12287,"CJK Symbols and Punctuation":h=>h>=12288&&h<=12351,Katakana:h=>h>=12448&&h<=12543,Kanbun:h=>h>=12688&&h<=12703,"CJK Strokes":h=>h>=12736&&h<=12783,"Enclosed CJK Letters and Months":h=>h>=12800&&h<=13055,"CJK Compatibility":h=>h>=13056&&h<=13311,"Yijing Hexagram Symbols":h=>h>=19904&&h<=19967,"Private Use Area":h=>h>=57344&&h<=63743,"Vertical Forms":h=>h>=65040&&h<=65055,"CJK Compatibility Forms":h=>h>=65072&&h<=65103,"Small Form Variants":h=>h>=65104&&h<=65135,"Halfwidth and Fullwidth Forms":h=>h>=65280&&h<=65519};function ox(h){for(const c of h)if(lx(c.charCodeAt(0)))return!0;return!1}function NC(h){for(const c of h)if(!Gh(c.charCodeAt(0)))return!1;return!0}function ax(h){const c=h.map(f=>{try{return new RegExp(`\\p{sc=${f}}`,"u").source}catch{return null}}).filter(f=>f);return new RegExp(c.join("|"),"u")}const VC=ax(["Arab","Dupl","Mong","Ougr","Syrc"]);function Gh(h){return!VC.test(String.fromCodePoint(h))}const p_=ax(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function lx(h){return!(h!==746&&h!==747&&(h<4352||!(Zr["CJK Compatibility Forms"](h)&&!(h>=65097&&h<=65103)||Zr["CJK Compatibility"](h)||Zr["CJK Strokes"](h)||!(!Zr["CJK Symbols and Punctuation"](h)||h>=12296&&h<=12305||h>=12308&&h<=12319||h===12336)||Zr["Enclosed CJK Letters and Months"](h)||Zr["Ideographic Description Characters"](h)||Zr.Kanbun(h)||Zr.Katakana(h)&&h!==12540||!(!Zr["Halfwidth and Fullwidth Forms"](h)||h===65288||h===65289||h===65293||h>=65306&&h<=65310||h===65339||h===65341||h===65343||h>=65371&&h<=65503||h===65507||h>=65512&&h<=65519)||!(!Zr["Small Form Variants"](h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||Zr["Vertical Forms"](h)||Zr["Yijing Hexagram Symbols"](h)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(h))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(h))||p_.test(String.fromCodePoint(h)))))}function m_(h){return!(lx(h)||function(c){return!!(Zr["Latin-1 Supplement"](c)&&(c===167||c===169||c===174||c===177||c===188||c===189||c===190||c===215||c===247)||Zr["General Punctuation"](c)&&(c===8214||c===8224||c===8225||c===8240||c===8241||c===8251||c===8252||c===8258||c===8263||c===8264||c===8265||c===8273)||Zr["Letterlike Symbols"](c)||Zr["Number Forms"](c)||Zr["Miscellaneous Technical"](c)&&(c>=8960&&c<=8967||c>=8972&&c<=8991||c>=8996&&c<=9e3||c===9003||c>=9085&&c<=9114||c>=9150&&c<=9165||c===9167||c>=9169&&c<=9179||c>=9186&&c<=9215)||Zr["Control Pictures"](c)&&c!==9251||Zr["Optical Character Recognition"](c)||Zr["Enclosed Alphanumerics"](c)||Zr["Geometric Shapes"](c)||Zr["Miscellaneous Symbols"](c)&&!(c>=9754&&c<=9759)||Zr["Miscellaneous Symbols and Arrows"](c)&&(c>=11026&&c<=11055||c>=11088&&c<=11097||c>=11192&&c<=11243)||Zr["CJK Symbols and Punctuation"](c)||Zr.Katakana(c)||Zr["Private Use Area"](c)||Zr["CJK Compatibility Forms"](c)||Zr["Small Form Variants"](c)||Zr["Halfwidth and Fullwidth Forms"](c)||c===8734||c===8756||c===8757||c>=9984&&c<=10087||c>=10102&&c<=10131||c===65532||c===65533)}(h))}const WC=ax(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function cx(h){return WC.test(String.fromCodePoint(h))}function UC(h,c){return!(!c&&cx(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||Zr.Khmer(h))}function qC(h){for(const c of h)if(cx(c.charCodeAt(0)))return!0;return!1}const zo=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(h){this.pluginStatus=h.pluginStatus,this.pluginURL=h.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(h){this.applyArabicShaping=h.applyArabicShaping,this.processBidirectionalText=h.processBidirectionalText,this.processStyledBidirectionalText=h.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class qn{constructor(c,f){this.zoom=c,f?(this.now=f.now,this.fadeDuration=f.fadeDuration,this.zoomHistory=f.zoomHistory,this.transition=f.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new sx,this.transition={})}isSupportedScript(c){return function(f,g){for(const _ of f)if(!UC(_.charCodeAt(0),g))return!1;return!0}(c,zo.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const c=this.zoom,f=c-Math.floor(c),g=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:f+(1-f)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*f}}}class Xh{constructor(c,f){this.property=c,this.value=f,this.expression=function(g,_){if(Rm(g))return new Wh(g,_);if(Fm(g)){const C=U0(g,_);if(C.result==="error")throw new Error(C.value.map(T=>`${T.key}: ${T.message}`).join(", "));return C.value}{let C=g;return _.type==="color"&&typeof g=="string"?C=ln.parse(g):_.type!=="padding"||typeof g!="number"&&!Array.isArray(g)?_.type==="variableAnchorOffsetCollection"&&Array.isArray(g)&&(C=uo.parse(g)):C=Ws.parse(g),{kind:"constant",evaluate:()=>C}}}(f===void 0?c.specification.default:f,c.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(c,f,g){return this.property.possiblyEvaluate(this,c,f,g)}}class Gm{constructor(c){this.property=c,this.value=new Xh(c,void 0)}transitioned(c,f){return new g_(this.property,this.value,f,K({},c.transition,this.transition),c.now)}untransitioned(){return new g_(this.property,this.value,null,{},0)}}class Xm{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues)}getValue(c){return ce(this._values[c].value.value)}setValue(c,f){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new Gm(this._values[c].property)),this._values[c].value=new Xh(this._values[c].property,f===null?void 0:ce(f))}getTransition(c){return ce(this._values[c].transition)}setTransition(c,f){Object.prototype.hasOwnProperty.call(this._values,c)||(this._values[c]=new Gm(this._values[c].property)),this._values[c].transition=ce(f)||void 0}serialize(){const c={};for(const f of Object.keys(this._values)){const g=this.getValue(f);g!==void 0&&(c[f]=g);const _=this.getTransition(f);_!==void 0&&(c[`${f}-transition`]=_)}return c}transitioned(c,f){const g=new qf(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].transitioned(c,f._values[_]);return g}untransitioned(){const c=new qf(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].untransitioned();return c}}class g_{constructor(c,f,g,_,C){this.property=c,this.value=f,this.begin=C+_.delay||0,this.end=this.begin+_.duration||0,c.specification.transition&&(_.delay||_.duration)&&(this.prior=g)}possiblyEvaluate(c,f,g){const _=c.now||0,C=this.value.possiblyEvaluate(c,f,g),T=this.prior;if(T){if(_>this.end)return this.prior=null,C;if(this.value.isDataDriven())return this.prior=null,C;if(_<this.begin)return T.possiblyEvaluate(c,f,g);{const j=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(c,f,g),C,function(z){if(z<=0)return 0;if(z>=1)return 1;const B=z*z,N=B*z;return 4*(z<.5?N:3*(z-B)+N-.75)}(j))}}return C}}class qf{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)}possiblyEvaluate(c,f,g){const _=new Hf(this._properties);for(const C of Object.keys(this._values))_._values[C]=this._values[C].possiblyEvaluate(c,f,g);return _}hasTransition(){for(const c of Object.keys(this._values))if(this._values[c].prior)return!0;return!1}}class Qf{constructor(c){this._properties=c,this._values=Object.create(c.defaultPropertyValues)}hasValue(c){return this._values[c].value!==void 0}getValue(c){return ce(this._values[c].value)}setValue(c,f){this._values[c]=new Xh(this._values[c].property,f===null?void 0:ce(f))}serialize(){const c={};for(const f of Object.keys(this._values)){const g=this.getValue(f);g!==void 0&&(c[f]=g)}return c}possiblyEvaluate(c,f,g){const _=new Hf(this._properties);for(const C of Object.keys(this._values))_._values[C]=this._values[C].possiblyEvaluate(c,f,g);return _}}class fl{constructor(c,f,g){this.property=c,this.value=f,this.parameters=g}isConstant(){return this.value.kind==="constant"}constantOr(c){return this.value.kind==="constant"?this.value.value:c}evaluate(c,f,g,_){return this.property.evaluate(this.value,this.parameters,c,f,g,_)}}class Hf{constructor(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)}get(c){return this._values[c]}}class or{constructor(c){this.specification=c}possiblyEvaluate(c,f){if(c.isDataDriven())throw new Error("Value should not be data driven");return c.expression.evaluate(f)}interpolate(c,f,g){const _=Gi[this.specification.type];return _?_(c,f,g):c}}class _r{constructor(c,f){this.specification=c,this.overrides=f}possiblyEvaluate(c,f,g,_){return new fl(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(f,null,{},g,_)}:c.expression,f)}interpolate(c,f,g){if(c.value.kind!=="constant"||f.value.kind!=="constant")return c;if(c.value.value===void 0||f.value.value===void 0)return new fl(this,{kind:"constant",value:void 0},c.parameters);const _=Gi[this.specification.type];if(_){const C=_(c.value.value,f.value.value,g);return new fl(this,{kind:"constant",value:C},c.parameters)}return c}evaluate(c,f,g,_,C,T){return c.kind==="constant"?c.value:c.evaluate(f,g,_,C,T)}}class Km extends _r{possiblyEvaluate(c,f,g,_){if(c.value===void 0)return new fl(this,{kind:"constant",value:void 0},f);if(c.expression.kind==="constant"){const C=c.expression.evaluate(f,null,{},g,_),T=c.property.specification.type==="resolvedImage"&&typeof C!="string"?C.name:C,j=this._calculate(T,T,T,f);return new fl(this,{kind:"constant",value:j},f)}if(c.expression.kind==="camera"){const C=this._calculate(c.expression.evaluate({zoom:f.zoom-1}),c.expression.evaluate({zoom:f.zoom}),c.expression.evaluate({zoom:f.zoom+1}),f);return new fl(this,{kind:"constant",value:C},f)}return new fl(this,c.expression,f)}evaluate(c,f,g,_,C,T){if(c.kind==="source"){const j=c.evaluate(f,g,_,C,T);return this._calculate(j,j,j,f)}return c.kind==="composite"?this._calculate(c.evaluate({zoom:Math.floor(f.zoom)-1},g,_),c.evaluate({zoom:Math.floor(f.zoom)},g,_),c.evaluate({zoom:Math.floor(f.zoom)+1},g,_),f):c.value}_calculate(c,f,g,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:c,to:f}:{from:g,to:f}}interpolate(c){return c}}class Zm{constructor(c){this.specification=c}possiblyEvaluate(c,f,g,_){if(c.value!==void 0){if(c.expression.kind==="constant"){const C=c.expression.evaluate(f,null,{},g,_);return this._calculate(C,C,C,f)}return this._calculate(c.expression.evaluate(new qn(Math.floor(f.zoom-1),f)),c.expression.evaluate(new qn(Math.floor(f.zoom),f)),c.expression.evaluate(new qn(Math.floor(f.zoom+1),f)),f)}}_calculate(c,f,g,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:c,to:f}:{from:g,to:f}}interpolate(c){return c}}class ux{constructor(c){this.specification=c}possiblyEvaluate(c,f,g,_){return!!c.expression.evaluate(f,null,{},g,_)}interpolate(){return!1}}class k{constructor(c){this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const f in c){const g=c[f];g.specification.overridable&&this.overridableProperties.push(f);const _=this.defaultPropertyValues[f]=new Xh(g,void 0),C=this.defaultTransitionablePropertyValues[f]=new Gm(g);this.defaultTransitioningPropertyValues[f]=C.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=_.possiblyEvaluate({})}}}Kt("DataDrivenProperty",_r),Kt("DataConstantProperty",or),Kt("CrossFadedDataDrivenProperty",Km),Kt("CrossFadedProperty",Zm),Kt("ColorRampProperty",ux);const l="-transition";class p extends rt{constructor(c,f){if(super(),this.id=c.id,this.type=c.type,this._featureFilter={filter:()=>!0,needGeometry:!1},c.type!=="custom"&&(this.metadata=c.metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter),f.layout&&(this._unevaluatedLayout=new Qf(f.layout)),f.paint)){this._transitionablePaint=new Xm(f.paint);for(const g in c.paint)this.setPaintProperty(g,c.paint[g],{validate:!1});for(const g in c.layout)this.setLayoutProperty(g,c.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Hf(f.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)}setLayoutProperty(c,f,g={}){f!=null&&this._validate(d_,`layers.${this.id}.layout.${c}`,c,f,g)||(c!=="visibility"?this._unevaluatedLayout.setValue(c,f):this.visibility=f)}getPaintProperty(c){return c.endsWith(l)?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)}setPaintProperty(c,f,g={}){if(f!=null&&this._validate(h_,`layers.${this.id}.paint.${c}`,c,f,g))return!1;if(c.endsWith(l))return this._transitionablePaint.setTransition(c.slice(0,-11),f||void 0),!1;{const _=this._transitionablePaint._values[c],C=_.property.specification["property-type"]==="cross-faded-data-driven",T=_.value.isDataDriven(),j=_.value;this._transitionablePaint.setValue(c,f),this._handleSpecialPaintPropertyUpdate(c);const z=this._transitionablePaint._values[c].value;return z.isDataDriven()||T||C||this._handleOverridablePaintPropertyUpdate(c,j,z)}}_handleSpecialPaintPropertyUpdate(c){}_handleOverridablePaintPropertyUpdate(c,f,g){return!1}isHidden(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"}updateTransitions(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(c,f){c.getCrossfadeParameters&&(this._crossfadeParameters=c.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,f)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,f)}serialize(){const c={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(c.layout=c.layout||{},c.layout.visibility=this.visibility),oe(c,(f,g)=>!(f===void 0||g==="layout"&&!Object.keys(f).length||g==="paint"&&!Object.keys(f).length))}_validate(c,f,g,_,C={}){return(!C||C.validate!==!1)&&nx(this,c.call(Fu,{key:f,layerType:this.type,objectKey:g,value:_,styleSpec:Te,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const c in this.paint._values){const f=this.paint.get(c);if(f instanceof fl&&Fh(f.property.specification)&&(f.value.kind==="source"||f.value.kind==="composite")&&f.value.isStateDependent)return!0}return!1}}const x={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class b{constructor(c,f){this._structArray=c,this._pos1=f*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class S{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(c,f){return c._trim(),f&&(c.isTransferred=!0,f.push(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}}static deserialize(c){const f=Object.create(this.prototype);return f.arrayBuffer=c.arrayBuffer,f.length=c.length,f.capacity=c.arrayBuffer.byteLength/f.bytesPerElement,f._refreshViews(),f}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(c){this.reserve(c),this.length=c}reserve(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const f=this.uint8;this._refreshViews(),f&&this.uint8.set(f)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function A(h,c=1){let f=0,g=0;return{members:h.map(_=>{const C=x[_.type].BYTES_PER_ELEMENT,T=f=M(f,Math.max(c,C)),j=_.components||1;return g=Math.max(g,C),f+=C*j,{name:_.name,type:_.type,components:j,offset:T}}),size:M(f,Math.max(g,c)),alignment:c}}function M(h,c){return Math.ceil(h/c)*c}class L extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f){const g=this.length;return this.resize(g+1),this.emplace(g,c,f)}emplace(c,f,g){const _=2*c;return this.int16[_+0]=f,this.int16[_+1]=g,c}}L.prototype.bytesPerElement=4,Kt("StructArrayLayout2i4",L);class V extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,g){const _=this.length;return this.resize(_+1),this.emplace(_,c,f,g)}emplace(c,f,g,_){const C=3*c;return this.int16[C+0]=f,this.int16[C+1]=g,this.int16[C+2]=_,c}}V.prototype.bytesPerElement=6,Kt("StructArrayLayout3i6",V);class H extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,g,_){const C=this.length;return this.resize(C+1),this.emplace(C,c,f,g,_)}emplace(c,f,g,_,C){const T=4*c;return this.int16[T+0]=f,this.int16[T+1]=g,this.int16[T+2]=_,this.int16[T+3]=C,c}}H.prototype.bytesPerElement=8,Kt("StructArrayLayout4i8",H);class G extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,g,_,C,T){const j=this.length;return this.resize(j+1),this.emplace(j,c,f,g,_,C,T)}emplace(c,f,g,_,C,T,j){const z=6*c;return this.int16[z+0]=f,this.int16[z+1]=g,this.int16[z+2]=_,this.int16[z+3]=C,this.int16[z+4]=T,this.int16[z+5]=j,c}}G.prototype.bytesPerElement=12,Kt("StructArrayLayout2i4i12",G);class ie extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,g,_,C,T){const j=this.length;return this.resize(j+1),this.emplace(j,c,f,g,_,C,T)}emplace(c,f,g,_,C,T,j){const z=4*c,B=8*c;return this.int16[z+0]=f,this.int16[z+1]=g,this.uint8[B+4]=_,this.uint8[B+5]=C,this.uint8[B+6]=T,this.uint8[B+7]=j,c}}ie.prototype.bytesPerElement=8,Kt("StructArrayLayout2i4ub8",ie);class le extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f){const g=this.length;return this.resize(g+1),this.emplace(g,c,f)}emplace(c,f,g){const _=2*c;return this.float32[_+0]=f,this.float32[_+1]=g,c}}le.prototype.bytesPerElement=8,Kt("StructArrayLayout2f8",le);class he extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,f,g,_,C,T,j,z,B,N){const q=this.length;return this.resize(q+1),this.emplace(q,c,f,g,_,C,T,j,z,B,N)}emplace(c,f,g,_,C,T,j,z,B,N,q){const Z=10*c;return this.uint16[Z+0]=f,this.uint16[Z+1]=g,this.uint16[Z+2]=_,this.uint16[Z+3]=C,this.uint16[Z+4]=T,this.uint16[Z+5]=j,this.uint16[Z+6]=z,this.uint16[Z+7]=B,this.uint16[Z+8]=N,this.uint16[Z+9]=q,c}}he.prototype.bytesPerElement=20,Kt("StructArrayLayout10ui20",he);class xe extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,f,g,_,C,T,j,z,B,N,q,Z){const re=this.length;return this.resize(re+1),this.emplace(re,c,f,g,_,C,T,j,z,B,N,q,Z)}emplace(c,f,g,_,C,T,j,z,B,N,q,Z,re){const se=12*c;return this.int16[se+0]=f,this.int16[se+1]=g,this.int16[se+2]=_,this.int16[se+3]=C,this.uint16[se+4]=T,this.uint16[se+5]=j,this.uint16[se+6]=z,this.uint16[se+7]=B,this.int16[se+8]=N,this.int16[se+9]=q,this.int16[se+10]=Z,this.int16[se+11]=re,c}}xe.prototype.bytesPerElement=24,Kt("StructArrayLayout4i4ui4i24",xe);class Se extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,g){const _=this.length;return this.resize(_+1),this.emplace(_,c,f,g)}emplace(c,f,g,_){const C=3*c;return this.float32[C+0]=f,this.float32[C+1]=g,this.float32[C+2]=_,c}}Se.prototype.bytesPerElement=12,Kt("StructArrayLayout3f12",Se);class Ce extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c){const f=this.length;return this.resize(f+1),this.emplace(f,c)}emplace(c,f){return this.uint32[1*c+0]=f,c}}Ce.prototype.bytesPerElement=4,Kt("StructArrayLayout1ul4",Ce);class je extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,f,g,_,C,T,j,z,B){const N=this.length;return this.resize(N+1),this.emplace(N,c,f,g,_,C,T,j,z,B)}emplace(c,f,g,_,C,T,j,z,B,N){const q=10*c,Z=5*c;return this.int16[q+0]=f,this.int16[q+1]=g,this.int16[q+2]=_,this.int16[q+3]=C,this.int16[q+4]=T,this.int16[q+5]=j,this.uint32[Z+3]=z,this.uint16[q+8]=B,this.uint16[q+9]=N,c}}je.prototype.bytesPerElement=20,Kt("StructArrayLayout6i1ul2ui20",je);class pe extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,g,_,C,T){const j=this.length;return this.resize(j+1),this.emplace(j,c,f,g,_,C,T)}emplace(c,f,g,_,C,T,j){const z=6*c;return this.int16[z+0]=f,this.int16[z+1]=g,this.int16[z+2]=_,this.int16[z+3]=C,this.int16[z+4]=T,this.int16[z+5]=j,c}}pe.prototype.bytesPerElement=12,Kt("StructArrayLayout2i2i2i12",pe);class Fe extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,g,_,C){const T=this.length;return this.resize(T+1),this.emplace(T,c,f,g,_,C)}emplace(c,f,g,_,C,T){const j=4*c,z=8*c;return this.float32[j+0]=f,this.float32[j+1]=g,this.float32[j+2]=_,this.int16[z+6]=C,this.int16[z+7]=T,c}}Fe.prototype.bytesPerElement=16,Kt("StructArrayLayout2f1f2i16",Fe);class Ue extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,f,g,_,C,T){const j=this.length;return this.resize(j+1),this.emplace(j,c,f,g,_,C,T)}emplace(c,f,g,_,C,T,j){const z=16*c,B=4*c,N=8*c;return this.uint8[z+0]=f,this.uint8[z+1]=g,this.float32[B+1]=_,this.float32[B+2]=C,this.int16[N+6]=T,this.int16[N+7]=j,c}}Ue.prototype.bytesPerElement=16,Kt("StructArrayLayout2ub2f2i16",Ue);class Je extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,f,g){const _=this.length;return this.resize(_+1),this.emplace(_,c,f,g)}emplace(c,f,g,_){const C=3*c;return this.uint16[C+0]=f,this.uint16[C+1]=g,this.uint16[C+2]=_,c}}Je.prototype.bytesPerElement=6,Kt("StructArrayLayout3ui6",Je);class ft extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,g,_,C,T,j,z,B,N,q,Z,re,se,ae,me,we){const Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,c,f,g,_,C,T,j,z,B,N,q,Z,re,se,ae,me,we)}emplace(c,f,g,_,C,T,j,z,B,N,q,Z,re,se,ae,me,we,Ze){const Ee=24*c,Qe=12*c,ot=48*c;return this.int16[Ee+0]=f,this.int16[Ee+1]=g,this.uint16[Ee+2]=_,this.uint16[Ee+3]=C,this.uint32[Qe+2]=T,this.uint32[Qe+3]=j,this.uint32[Qe+4]=z,this.uint16[Ee+10]=B,this.uint16[Ee+11]=N,this.uint16[Ee+12]=q,this.float32[Qe+7]=Z,this.float32[Qe+8]=re,this.uint8[ot+36]=se,this.uint8[ot+37]=ae,this.uint8[ot+38]=me,this.uint32[Qe+10]=we,this.int16[Ee+22]=Ze,c}}ft.prototype.bytesPerElement=48,Kt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ft);class kt extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,g,_,C,T,j,z,B,N,q,Z,re,se,ae,me,we,Ze,Ee,Qe,ot,yt,Wt,xr,$t,Rt,dr,er){const Ht=this.length;return this.resize(Ht+1),this.emplace(Ht,c,f,g,_,C,T,j,z,B,N,q,Z,re,se,ae,me,we,Ze,Ee,Qe,ot,yt,Wt,xr,$t,Rt,dr,er)}emplace(c,f,g,_,C,T,j,z,B,N,q,Z,re,se,ae,me,we,Ze,Ee,Qe,ot,yt,Wt,xr,$t,Rt,dr,er,Ht){const ht=32*c,fr=16*c;return this.int16[ht+0]=f,this.int16[ht+1]=g,this.int16[ht+2]=_,this.int16[ht+3]=C,this.int16[ht+4]=T,this.int16[ht+5]=j,this.int16[ht+6]=z,this.int16[ht+7]=B,this.uint16[ht+8]=N,this.uint16[ht+9]=q,this.uint16[ht+10]=Z,this.uint16[ht+11]=re,this.uint16[ht+12]=se,this.uint16[ht+13]=ae,this.uint16[ht+14]=me,this.uint16[ht+15]=we,this.uint16[ht+16]=Ze,this.uint16[ht+17]=Ee,this.uint16[ht+18]=Qe,this.uint16[ht+19]=ot,this.uint16[ht+20]=yt,this.uint16[ht+21]=Wt,this.uint16[ht+22]=xr,this.uint32[fr+12]=$t,this.float32[fr+13]=Rt,this.float32[fr+14]=dr,this.uint16[ht+30]=er,this.uint16[ht+31]=Ht,c}}kt.prototype.bytesPerElement=64,Kt("StructArrayLayout8i15ui1ul2f2ui64",kt);class Lt extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c){const f=this.length;return this.resize(f+1),this.emplace(f,c)}emplace(c,f){return this.float32[1*c+0]=f,c}}Lt.prototype.bytesPerElement=4,Kt("StructArrayLayout1f4",Lt);class qt extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,g){const _=this.length;return this.resize(_+1),this.emplace(_,c,f,g)}emplace(c,f,g,_){const C=3*c;return this.uint16[6*c+0]=f,this.float32[C+1]=g,this.float32[C+2]=_,c}}qt.prototype.bytesPerElement=12,Kt("StructArrayLayout1ui2f12",qt);class zt extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,f,g){const _=this.length;return this.resize(_+1),this.emplace(_,c,f,g)}emplace(c,f,g,_){const C=4*c;return this.uint32[2*c+0]=f,this.uint16[C+2]=g,this.uint16[C+3]=_,c}}zt.prototype.bytesPerElement=8,Kt("StructArrayLayout1ul2ui8",zt);class At extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,f){const g=this.length;return this.resize(g+1),this.emplace(g,c,f)}emplace(c,f,g){const _=2*c;return this.uint16[_+0]=f,this.uint16[_+1]=g,c}}At.prototype.bytesPerElement=4,Kt("StructArrayLayout2ui4",At);class ar extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c){const f=this.length;return this.resize(f+1),this.emplace(f,c)}emplace(c,f){return this.uint16[1*c+0]=f,c}}ar.prototype.bytesPerElement=2,Kt("StructArrayLayout1ui2",ar);class Pr extends S{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,f,g,_){const C=this.length;return this.resize(C+1),this.emplace(C,c,f,g,_)}emplace(c,f,g,_,C){const T=4*c;return this.float32[T+0]=f,this.float32[T+1]=g,this.float32[T+2]=_,this.float32[T+3]=C,c}}Pr.prototype.bytesPerElement=16,Kt("StructArrayLayout4f16",Pr);class It extends b{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new v(this.anchorPointX,this.anchorPointY)}}It.prototype.size=20;class Nt extends je{get(c){return new It(this,c)}}Kt("CollisionBoxArray",Nt);class Tr extends b{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(c){this._structArray.uint8[this._pos1+37]=c}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(c){this._structArray.uint8[this._pos1+38]=c}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(c){this._structArray.uint32[this._pos4+10]=c}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Tr.prototype.size=48;class Qn extends ft{get(c){return new Tr(this,c)}}Kt("PlacedSymbolArray",Qn);class $r extends b{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(c){this._structArray.uint32[this._pos4+12]=c}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}$r.prototype.size=64;class Gr extends kt{get(c){return new $r(this,c)}}Kt("SymbolInstanceArray",Gr);class Hn extends Lt{getoffsetX(c){return this.float32[1*c+0]}}Kt("GlyphOffsetArray",Hn);class As extends V{getx(c){return this.int16[3*c+0]}gety(c){return this.int16[3*c+1]}gettileUnitDistanceFromAnchor(c){return this.int16[3*c+2]}}Kt("SymbolLineVertexArray",As);class La extends b{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}La.prototype.size=12;class Gn extends qt{get(c){return new La(this,c)}}Kt("TextAnchorOffsetArray",Gn);class ho extends b{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ho.prototype.size=8;class qs extends zt{get(c){return new ho(this,c)}}Kt("FeatureIndexArray",qs);class Es extends L{}class Qs extends L{}class pl extends L{}class Kh extends G{}class Ym extends ie{}class Zh extends le{}class sa extends he{}class Jm extends xe{}class hx extends Se{}class oa extends Ce{}class aa extends pe{}class Ic extends Ue{}class Fa extends Je{}class hs extends At{}const zs=A([{name:"a_pos",components:2,type:"Int16"}],4),{members:Mo}=zs;class Yr{constructor(c=[]){this.segments=c}prepareSegment(c,f,g,_){let C=this.segments[this.segments.length-1];return c>Yr.MAX_VERTEX_ARRAY_LENGTH&&Ae(`Max vertices per segment is ${Yr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${c}`),(!C||C.vertexLength+c>Yr.MAX_VERTEX_ARRAY_LENGTH||C.sortKey!==_)&&(C={vertexOffset:f.length,primitiveOffset:g.length,vertexLength:0,primitiveLength:0},_!==void 0&&(C.sortKey=_),this.segments.push(C)),C}get(){return this.segments}destroy(){for(const c of this.segments)for(const f in c.vaos)c.vaos[f].destroy()}static simpleSegment(c,f,g,_){return new Yr([{vertexOffset:c,primitiveOffset:f,vertexLength:g,primitiveLength:_,vaos:{},sortKey:0}])}}function Bu(h,c){return 256*(h=X(Math.floor(h),0,255))+X(Math.floor(c),0,255)}Yr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Kt("SegmentVector",Yr);const Yh=A([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Jh={exports:{}},y_={exports:{}};y_.exports=function(h,c){var f,g,_,C,T,j,z,B;for(g=h.length-(f=3&h.length),_=c,T=3432918353,j=461845907,B=0;B<g;)z=255&h.charCodeAt(B)|(255&h.charCodeAt(++B))<<8|(255&h.charCodeAt(++B))<<16|(255&h.charCodeAt(++B))<<24,++B,_=27492+(65535&(C=5*(65535&(_=(_^=z=(65535&(z=(z=(65535&z)*T+(((z>>>16)*T&65535)<<16)&4294967295)<<15|z>>>17))*j+(((z>>>16)*j&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(z=0,f){case 3:z^=(255&h.charCodeAt(B+2))<<16;case 2:z^=(255&h.charCodeAt(B+1))<<8;case 1:_^=z=(65535&(z=(z=(65535&(z^=255&h.charCodeAt(B)))*T+(((z>>>16)*T&65535)<<16)&4294967295)<<15|z>>>17))*j+(((z>>>16)*j&65535)<<16)&4294967295}return _^=h.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0};var QC=y_.exports,x_={exports:{}};x_.exports=function(h,c){for(var f,g=h.length,_=c^g,C=0;g>=4;)f=1540483477*(65535&(f=255&h.charCodeAt(C)|(255&h.charCodeAt(++C))<<8|(255&h.charCodeAt(++C))<<16|(255&h.charCodeAt(++C))<<24))+((1540483477*(f>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),g-=4,++C;switch(g){case 3:_^=(255&h.charCodeAt(C+2))<<16;case 2:_^=(255&h.charCodeAt(C+1))<<8;case 1:_=1540483477*(65535&(_^=255&h.charCodeAt(C)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0};var Rc=QC,v_=x_.exports;Jh.exports=Rc,Jh.exports.murmur3=Rc,Jh.exports.murmur2=v_;var eg=d(Jh.exports);class Gf{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(c,f,g,_){this.ids.push(tg(c)),this.positions.push(f,g,_)}getPositions(c){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const f=tg(c);let g=0,_=this.ids.length-1;for(;g<_;){const T=g+_>>1;this.ids[T]>=f?_=T:g=T+1}const C=[];for(;this.ids[g]===f;)C.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return C}static serialize(c,f){const g=new Float64Array(c.ids),_=new Uint32Array(c.positions);return rg(g,_,0,g.length-1),f&&f.push(g.buffer,_.buffer),{ids:g,positions:_}}static deserialize(c){const f=new Gf;return f.ids=c.ids,f.positions=c.positions,f.indexed=!0,f}}function tg(h){const c=+h;return!isNaN(c)&&c<=Number.MAX_SAFE_INTEGER?c:eg(String(h))}function rg(h,c,f,g){for(;f<g;){const _=h[f+g>>1];let C=f-1,T=g+1;for(;;){do C++;while(h[C]<_);do T--;while(h[T]>_);if(C>=T)break;ed(h,C,T),ed(c,3*C,3*T),ed(c,3*C+1,3*T+1),ed(c,3*C+2,3*T+2)}T-f<g-T?(rg(h,c,f,T),f=T+1):(rg(h,c,T+1,g),g=T)}}function ed(h,c,f){const g=h[c];h[c]=h[f],h[f]=g}Kt("FeaturePositionMap",Gf);class Xf{constructor(c,f){this.gl=c.gl,this.location=f}}class b_ extends Xf{constructor(c,f){super(c,f),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class CI extends Xf{constructor(c,f){super(c,f),this.current=[0,0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3]))}}class TI extends Xf{constructor(c,f){super(c,f),this.current=ln.transparent}set(c){c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a))}}const $H=new Float32Array(16);function HC(h){return[Bu(255*h.r,255*h.g),Bu(255*h.b,255*h.a)]}class dx{constructor(c,f,g){this.value=c,this.uniformNames=f.map(_=>`u_${_}`),this.type=g}setUniform(c,f,g){c.set(g.constantOr(this.value))}getBinding(c,f,g){return this.type==="color"?new TI(c,f):new b_(c,f)}}class ng{constructor(c,f){this.uniformNames=f.map(g=>`u_${g}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(c,f){this.pixelRatioFrom=f.pixelRatio,this.pixelRatioTo=c.pixelRatio,this.patternFrom=f.tlbr,this.patternTo=c.tlbr}setUniform(c,f,g,_){const C=_==="u_pattern_to"?this.patternTo:_==="u_pattern_from"?this.patternFrom:_==="u_pixel_ratio_to"?this.pixelRatioTo:_==="u_pixel_ratio_from"?this.pixelRatioFrom:null;C&&c.set(C)}getBinding(c,f,g){return g.substr(0,9)==="u_pattern"?new CI(c,f):new b_(c,f)}}class $u{constructor(c,f,g,_){this.expression=c,this.type=g,this.maxValue=0,this.paintVertexAttributes=f.map(C=>({name:`a_${C}`,type:"Float32",components:g==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(c,f,g,_,C){const T=this.paintVertexArray.length,j=this.expression.evaluate(new qn(0),f,{},_,[],C);this.paintVertexArray.resize(c),this._setPaintValue(T,c,j)}updatePaintArray(c,f,g,_){const C=this.expression.evaluate({zoom:0},g,_);this._setPaintValue(c,f,C)}_setPaintValue(c,f,g){if(this.type==="color"){const _=HC(g);for(let C=c;C<f;C++)this.paintVertexArray.emplace(C,_[0],_[1])}else{for(let _=c;_<f;_++)this.paintVertexArray.emplace(_,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ec{constructor(c,f,g,_,C,T){this.expression=c,this.uniformNames=f.map(j=>`u_${j}_t`),this.type=g,this.useIntegerZoom=_,this.zoom=C,this.maxValue=0,this.paintVertexAttributes=f.map(j=>({name:`a_${j}`,type:"Float32",components:g==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(c,f,g,_,C){const T=this.expression.evaluate(new qn(this.zoom),f,{},_,[],C),j=this.expression.evaluate(new qn(this.zoom+1),f,{},_,[],C),z=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(z,c,T,j)}updatePaintArray(c,f,g,_){const C=this.expression.evaluate({zoom:this.zoom},g,_),T=this.expression.evaluate({zoom:this.zoom+1},g,_);this._setPaintValue(c,f,C,T)}_setPaintValue(c,f,g,_){if(this.type==="color"){const C=HC(g),T=HC(_);for(let j=c;j<f;j++)this.paintVertexArray.emplace(j,C[0],C[1],T[0],T[1])}else{for(let C=c;C<f;C++)this.paintVertexArray.emplace(C,g,_);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(_))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(c,f){const g=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,_=X(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);c.set(_)}getBinding(c,f,g){return new b_(c,f)}}class td{constructor(c,f,g,_,C,T){this.expression=c,this.type=f,this.useIntegerZoom=g,this.zoom=_,this.layerId=T,this.zoomInPaintVertexArray=new C,this.zoomOutPaintVertexArray=new C}populatePaintArray(c,f,g){const _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(c),this.zoomOutPaintVertexArray.resize(c),this._setPaintValues(_,c,f.patterns&&f.patterns[this.layerId],g)}updatePaintArray(c,f,g,_,C){this._setPaintValues(c,f,g.patterns&&g.patterns[this.layerId],C)}_setPaintValues(c,f,g,_){if(!_||!g)return;const{min:C,mid:T,max:j}=g,z=_[C],B=_[T],N=_[j];if(z&&B&&N)for(let q=c;q<f;q++)this.zoomInPaintVertexArray.emplace(q,B.tl[0],B.tl[1],B.br[0],B.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],B.pixelRatio,z.pixelRatio),this.zoomOutPaintVertexArray.emplace(q,B.tl[0],B.tl[1],B.br[0],B.br[1],N.tl[0],N.tl[1],N.br[0],N.br[1],B.pixelRatio,N.pixelRatio)}upload(c){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=c.createVertexBuffer(this.zoomInPaintVertexArray,Yh.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=c.createVertexBuffer(this.zoomOutPaintVertexArray,Yh.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class OI{constructor(c,f,g){this.binders={},this._buffers=[];const _=[];for(const C in c.paint._values){if(!g(C))continue;const T=c.paint.get(C);if(!(T instanceof fl&&Fh(T.property.specification)))continue;const j=NH(C,c.type),z=T.value,B=T.property.specification.type,N=T.property.useIntegerZoom,q=T.property.specification["property-type"],Z=q==="cross-faded"||q==="cross-faded-data-driven";if(z.kind==="constant")this.binders[C]=Z?new ng(z.value,j):new dx(z.value,j,B),_.push(`/u_${C}`);else if(z.kind==="source"||Z){const re=jI(C,B,"source");this.binders[C]=Z?new td(z,B,N,f,re,c.id):new $u(z,j,B,re),_.push(`/a_${C}`)}else{const re=jI(C,B,"composite");this.binders[C]=new ec(z,j,B,N,f,re),_.push(`/z_${C}`)}}this.cacheKey=_.sort().join("")}getMaxValue(c){const f=this.binders[c];return f instanceof $u||f instanceof ec?f.maxValue:0}populatePaintArrays(c,f,g,_,C){for(const T in this.binders){const j=this.binders[T];(j instanceof $u||j instanceof ec||j instanceof td)&&j.populatePaintArray(c,f,g,_,C)}}setConstantPatternPositions(c,f){for(const g in this.binders){const _=this.binders[g];_ instanceof ng&&_.setConstantPatternPositions(c,f)}}updatePaintArrays(c,f,g,_,C){let T=!1;for(const j in c){const z=f.getPositions(j);for(const B of z){const N=g.feature(B.index);for(const q in this.binders){const Z=this.binders[q];if((Z instanceof $u||Z instanceof ec||Z instanceof td)&&Z.expression.isStateDependent===!0){const re=_.paint.get(q);Z.expression=re.value,Z.updatePaintArray(B.start,B.end,N,c[j],C),T=!0}}}}return T}defines(){const c=[];for(const f in this.binders){const g=this.binders[f];(g instanceof dx||g instanceof ng)&&c.push(...g.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return c}getBinderAttributes(){const c=[];for(const f in this.binders){const g=this.binders[f];if(g instanceof $u||g instanceof ec)for(let _=0;_<g.paintVertexAttributes.length;_++)c.push(g.paintVertexAttributes[_].name);else if(g instanceof td)for(let _=0;_<Yh.members.length;_++)c.push(Yh.members[_].name)}return c}getBinderUniforms(){const c=[];for(const f in this.binders){const g=this.binders[f];if(g instanceof dx||g instanceof ng||g instanceof ec)for(const _ of g.uniformNames)c.push(_)}return c}getPaintVertexBuffers(){return this._buffers}getUniforms(c,f){const g=[];for(const _ in this.binders){const C=this.binders[_];if(C instanceof dx||C instanceof ng||C instanceof ec){for(const T of C.uniformNames)if(f[T]){const j=C.getBinding(c,f[T],T);g.push({name:T,property:_,binding:j})}}}return g}setUniforms(c,f,g,_){for(const{name:C,property:T,binding:j}of f)this.binders[T].setUniform(j,_,g.get(T),C)}updatePaintBuffers(c){this._buffers=[];for(const f in this.binders){const g=this.binders[f];if(c&&g instanceof td){const _=c.fromScale===2?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(g instanceof $u||g instanceof ec)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}}upload(c){for(const f in this.binders){const g=this.binders[f];(g instanceof $u||g instanceof ec||g instanceof td)&&g.upload(c)}this.updatePaintBuffers()}destroy(){for(const c in this.binders){const f=this.binders[c];(f instanceof $u||f instanceof ec||f instanceof td)&&f.destroy()}}}class Kf{constructor(c,f,g=()=>!0){this.programConfigurations={};for(const _ of c)this.programConfigurations[_.id]=new OI(_,f,g);this.needsUpload=!1,this._featureMap=new Gf,this._bufferOffset=0}populatePaintArrays(c,f,g,_,C,T){for(const j in this.programConfigurations)this.programConfigurations[j].populatePaintArrays(c,f,_,C,T);f.id!==void 0&&this._featureMap.add(f.id,g,this._bufferOffset,c),this._bufferOffset=c,this.needsUpload=!0}updatePaintArrays(c,f,g,_){for(const C of g)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(c,this._featureMap,f,C,_)||this.needsUpload}get(c){return this.programConfigurations[c]}upload(c){if(this.needsUpload){for(const f in this.programConfigurations)this.programConfigurations[f].upload(c);this.needsUpload=!1}}destroy(){for(const c in this.programConfigurations)this.programConfigurations[c].destroy()}}function NH(h,c){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[h]||[h.replace(`${c}-`,"").replace(/-/g,"_")]}function jI(h,c,f){const g={color:{source:le,composite:Pr},number:{source:Lt,composite:le}},_=function(C){return{"line-pattern":{source:sa,composite:sa},"fill-pattern":{source:sa,composite:sa},"fill-extrusion-pattern":{source:sa,composite:sa}}[C]}(h);return _&&_[f]||g[c][f]}Kt("ConstantBinder",dx),Kt("CrossFadedConstantBinder",ng),Kt("SourceExpressionBinder",$u),Kt("CrossFadedCompositeBinder",td),Kt("CompositeExpressionBinder",ec),Kt("ProgramConfiguration",OI,{omit:["_buffers"]}),Kt("ProgramConfigurationSet",Kf);const Ei=8192,GC=Math.pow(2,14)-1,PI=-GC-1;function Zf(h){const c=Ei/h.extent,f=h.loadGeometry();for(let g=0;g<f.length;g++){const _=f[g];for(let C=0;C<_.length;C++){const T=_[C],j=Math.round(T.x*c),z=Math.round(T.y*c);T.x=X(j,PI,GC),T.y=X(z,PI,GC),(j<T.x||j>T.x+1||z<T.y||z>T.y+1)&&Ae("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return f}function Yf(h,c){return{type:h.type,id:h.id,properties:h.properties,geometry:c?Zf(h):[]}}function __(h,c,f,g,_){h.emplaceBack(2*c+(g+1)/2,2*f+(_+1)/2)}class XC{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(f=>f.id),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new Qs,this.indexArray=new Fa,this.segments=new Yr,this.programConfigurations=new Kf(c.layers,c.zoom),this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(c,f,g){const _=this.layers[0],C=[];let T=null,j=!1;_.type==="circle"&&(T=_.layout.get("circle-sort-key"),j=!T.isConstant());for(const{feature:z,id:B,index:N,sourceLayerIndex:q}of c){const Z=this.layers[0]._featureFilter.needGeometry,re=Yf(z,Z);if(!this.layers[0]._featureFilter.filter(new qn(this.zoom),re,g))continue;const se=j?T.evaluate(re,{},g):void 0,ae={id:B,properties:z.properties,type:z.type,sourceLayerIndex:q,index:N,geometry:Z?re.geometry:Zf(z),patterns:{},sortKey:se};C.push(ae)}j&&C.sort((z,B)=>z.sortKey-B.sortKey);for(const z of C){const{geometry:B,index:N,sourceLayerIndex:q}=z,Z=c[N].feature;this.addFeature(z,B,N,g),f.featureIndex.insert(Z,B,N,q,this.index)}}update(c,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,f,this.stateDependentLayers,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Mo),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(c,f,g,_){for(const C of f)for(const T of C){const j=T.x,z=T.y;if(j<0||j>=Ei||z<0||z>=Ei)continue;const B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,c.sortKey),N=B.vertexLength;__(this.layoutVertexArray,j,z,-1,-1),__(this.layoutVertexArray,j,z,1,-1),__(this.layoutVertexArray,j,z,1,1),__(this.layoutVertexArray,j,z,-1,1),this.indexArray.emplaceBack(N,N+1,N+2),this.indexArray.emplaceBack(N,N+3,N+2),B.vertexLength+=4,B.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,{},_)}}function AI(h,c){for(let f=0;f<h.length;f++)if(ig(c,h[f]))return!0;for(let f=0;f<c.length;f++)if(ig(h,c[f]))return!0;return!!KC(h,c)}function VH(h,c,f){return!!ig(h,c)||!!ZC(c,h,f)}function EI(h,c){if(h.length===1)return MI(c,h[0]);for(let f=0;f<c.length;f++){const g=c[f];for(let _=0;_<g.length;_++)if(ig(h,g[_]))return!0}for(let f=0;f<h.length;f++)if(MI(c,h[f]))return!0;for(let f=0;f<c.length;f++)if(KC(h,c[f]))return!0;return!1}function WH(h,c,f){if(h.length>1){if(KC(h,c))return!0;for(let g=0;g<c.length;g++)if(ZC(c[g],h,f))return!0}for(let g=0;g<h.length;g++)if(ZC(h[g],c,f))return!0;return!1}function KC(h,c){if(h.length===0||c.length===0)return!1;for(let f=0;f<h.length-1;f++){const g=h[f],_=h[f+1];for(let C=0;C<c.length-1;C++)if(UH(g,_,c[C],c[C+1]))return!0}return!1}function UH(h,c,f,g){return We(h,f,g)!==We(c,f,g)&&We(h,c,f)!==We(h,c,g)}function ZC(h,c,f){const g=f*f;if(c.length===1)return h.distSqr(c[0])<g;for(let _=1;_<c.length;_++)if(zI(h,c[_-1],c[_])<g)return!0;return!1}function zI(h,c,f){const g=c.distSqr(f);if(g===0)return h.distSqr(c);const _=((h.x-c.x)*(f.x-c.x)+(h.y-c.y)*(f.y-c.y))/g;return h.distSqr(_<0?c:_>1?f:f.sub(c)._mult(_)._add(c))}function MI(h,c){let f,g,_,C=!1;for(let T=0;T<h.length;T++){f=h[T];for(let j=0,z=f.length-1;j<f.length;z=j++)g=f[j],_=f[z],g.y>c.y!=_.y>c.y&&c.x<(_.x-g.x)*(c.y-g.y)/(_.y-g.y)+g.x&&(C=!C)}return C}function ig(h,c){let f=!1;for(let g=0,_=h.length-1;g<h.length;_=g++){const C=h[g],T=h[_];C.y>c.y!=T.y>c.y&&c.x<(T.x-C.x)*(c.y-C.y)/(T.y-C.y)+C.x&&(f=!f)}return f}function qH(h,c,f){const g=f[0],_=f[2];if(h.x<g.x&&c.x<g.x||h.x>_.x&&c.x>_.x||h.y<g.y&&c.y<g.y||h.y>_.y&&c.y>_.y)return!1;const C=We(h,c,f[0]);return C!==We(h,c,f[1])||C!==We(h,c,f[2])||C!==We(h,c,f[3])}function fx(h,c,f){const g=c.paint.get(h).value;return g.kind==="constant"?g.value:f.programConfigurations.get(c.id).getMaxValue(h)}function w_(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function S_(h,c,f,g,_){if(!c[0]&&!c[1])return h;const C=v.convert(c)._mult(_);f==="viewport"&&C._rotate(-g);const T=[];for(let j=0;j<h.length;j++)T.push(h[j].sub(C));return T}let II,RI;Kt("CircleBucket",XC,{omit:["layers"]});var QH={get paint(){return RI=RI||new k({"circle-radius":new _r(Te.paint_circle["circle-radius"]),"circle-color":new _r(Te.paint_circle["circle-color"]),"circle-blur":new _r(Te.paint_circle["circle-blur"]),"circle-opacity":new _r(Te.paint_circle["circle-opacity"]),"circle-translate":new or(Te.paint_circle["circle-translate"]),"circle-translate-anchor":new or(Te.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new or(Te.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new or(Te.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _r(Te.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _r(Te.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _r(Te.paint_circle["circle-stroke-opacity"])})},get layout(){return II=II||new k({"circle-sort-key":new _r(Te.layout_circle["circle-sort-key"])})}},fo=1e-6,sg=typeof Float32Array<"u"?Float32Array:Array;function YC(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function DI(h,c,f){var g=c[0],_=c[1],C=c[2],T=c[3],j=c[4],z=c[5],B=c[6],N=c[7],q=c[8],Z=c[9],re=c[10],se=c[11],ae=c[12],me=c[13],we=c[14],Ze=c[15],Ee=f[0],Qe=f[1],ot=f[2],yt=f[3];return h[0]=Ee*g+Qe*j+ot*q+yt*ae,h[1]=Ee*_+Qe*z+ot*Z+yt*me,h[2]=Ee*C+Qe*B+ot*re+yt*we,h[3]=Ee*T+Qe*N+ot*se+yt*Ze,h[4]=(Ee=f[4])*g+(Qe=f[5])*j+(ot=f[6])*q+(yt=f[7])*ae,h[5]=Ee*_+Qe*z+ot*Z+yt*me,h[6]=Ee*C+Qe*B+ot*re+yt*we,h[7]=Ee*T+Qe*N+ot*se+yt*Ze,h[8]=(Ee=f[8])*g+(Qe=f[9])*j+(ot=f[10])*q+(yt=f[11])*ae,h[9]=Ee*_+Qe*z+ot*Z+yt*me,h[10]=Ee*C+Qe*B+ot*re+yt*we,h[11]=Ee*T+Qe*N+ot*se+yt*Ze,h[12]=(Ee=f[12])*g+(Qe=f[13])*j+(ot=f[14])*q+(yt=f[15])*ae,h[13]=Ee*_+Qe*z+ot*Z+yt*me,h[14]=Ee*C+Qe*B+ot*re+yt*we,h[15]=Ee*T+Qe*N+ot*se+yt*Ze,h}Math.hypot||(Math.hypot=function(){for(var h=0,c=arguments.length;c--;)h+=arguments[c]*arguments[c];return Math.sqrt(h)});var px,HH=DI;function k_(h,c,f){var g=c[0],_=c[1],C=c[2],T=c[3];return h[0]=f[0]*g+f[4]*_+f[8]*C+f[12]*T,h[1]=f[1]*g+f[5]*_+f[9]*C+f[13]*T,h[2]=f[2]*g+f[6]*_+f[10]*C+f[14]*T,h[3]=f[3]*g+f[7]*_+f[11]*C+f[15]*T,h}px=new sg(4),sg!=Float32Array&&(px[0]=0,px[1]=0,px[2]=0,px[3]=0);class GH extends p{constructor(c){super(c,QH)}createBucket(c){return new XC(c)}queryRadius(c){const f=c;return fx("circle-radius",this,f)+fx("circle-stroke-width",this,f)+w_(this.paint.get("circle-translate"))}queryIntersectsFeature(c,f,g,_,C,T,j,z){const B=S_(c,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),T.angle,j),N=this.paint.get("circle-radius").evaluate(f,g)+this.paint.get("circle-stroke-width").evaluate(f,g),q=this.paint.get("circle-pitch-alignment")==="map",Z=q?B:function(se,ae){return se.map(me=>LI(me,ae))}(B,z),re=q?N*j:N;for(const se of _)for(const ae of se){const me=q?ae:LI(ae,z);let we=re;const Ze=k_([],[ae.x,ae.y,0,1],z);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?we*=Ze[3]/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(we*=T.cameraToCenterDistance/Ze[3]),VH(Z,me,we))return!0}return!1}}function LI(h,c){const f=k_([],[h.x,h.y,0,1],c);return new v(f[0]/f[3],f[1]/f[3])}class FI extends XC{}let BI;Kt("HeatmapBucket",FI,{omit:["layers"]});var XH={get paint(){return BI=BI||new k({"heatmap-radius":new _r(Te.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _r(Te.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new or(Te.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ux(Te.paint_heatmap["heatmap-color"]),"heatmap-opacity":new or(Te.paint_heatmap["heatmap-opacity"])})}};function JC(h,{width:c,height:f},g,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==c*f*g)throw new RangeError(`mismatched image size. expected: ${_.length} but got: ${c*f*g}`)}else _=new Uint8Array(c*f*g);return h.width=c,h.height=f,h.data=_,h}function $I(h,{width:c,height:f},g){if(c===h.width&&f===h.height)return;const _=JC({},{width:c,height:f},g);eT(h,_,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,c),height:Math.min(h.height,f)},g),h.width=c,h.height=f,h.data=_.data}function eT(h,c,f,g,_,C){if(_.width===0||_.height===0)return c;if(_.width>h.width||_.height>h.height||f.x>h.width-_.width||f.y>h.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>c.width||_.height>c.height||g.x>c.width-_.width||g.y>c.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const T=h.data,j=c.data;if(T===j)throw new Error("srcData equals dstData, so image is already copied");for(let z=0;z<_.height;z++){const B=((f.y+z)*h.width+f.x)*C,N=((g.y+z)*c.width+g.x)*C;for(let q=0;q<_.width*C;q++)j[N+q]=T[B+q]}return c}class mx{constructor(c,f){JC(this,c,1,f)}resize(c){$I(this,c,1)}clone(){return new mx({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,f,g,_,C){eT(c,f,g,_,C,1)}}class Ba{constructor(c,f){JC(this,c,4,f)}resize(c){$I(this,c,4)}replace(c,f){f?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c}clone(){return new Ba({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,f,g,_,C){eT(c,f,g,_,C,4)}}function NI(h){const c={},f=h.resolution||256,g=h.clips?h.clips.length:1,_=h.image||new Ba({width:f,height:g});if(Math.log(f)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${f}`);const C=(T,j,z)=>{c[h.evaluationKey]=z;const B=h.expression.evaluate(c);_.data[T+j+0]=Math.floor(255*B.r/B.a),_.data[T+j+1]=Math.floor(255*B.g/B.a),_.data[T+j+2]=Math.floor(255*B.b/B.a),_.data[T+j+3]=Math.floor(255*B.a)};if(h.clips)for(let T=0,j=0;T<g;++T,j+=4*f)for(let z=0,B=0;z<f;z++,B+=4){const N=z/(f-1),{start:q,end:Z}=h.clips[T];C(j,B,q*(1-N)+Z*N)}else for(let T=0,j=0;T<f;T++,j+=4)C(0,j,T/(f-1));return _}Kt("AlphaImage",mx),Kt("RGBAImage",Ba);const tT="big-fb";class KH extends p{createBucket(c){return new FI(c)}constructor(c){super(c,XH),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=NI({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(tT)&&this.heatmapFbos.delete(tT)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let VI;var ZH={get paint(){return VI=VI||new k({"hillshade-illumination-direction":new or(Te.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new or(Te.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new or(Te.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new or(Te.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new or(Te.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new or(Te.paint_hillshade["hillshade-accent-color"])})}};class YH extends p{constructor(c){super(c,ZH)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const JH=A([{name:"a_pos",components:2,type:"Int16"}],4),{members:eG}=JH;function WI(h,c,f=2){const g=c&&c.length,_=g?c[0]*f:h.length;let C=UI(h,0,_,f,!0);const T=[];if(!C||C.next===C.prev)return T;let j,z,B;if(g&&(C=function(N,q,Z,re){const se=[];for(let ae=0,me=q.length;ae<me;ae++){const we=UI(N,q[ae]*re,ae<me-1?q[ae+1]*re:N.length,re,!1);we===we.next&&(we.steiner=!0),se.push(lG(we))}se.sort(sG);for(let ae=0;ae<se.length;ae++)Z=oG(se[ae],Z);return Z}(h,c,C,f)),h.length>80*f){j=1/0,z=1/0;let N=-1/0,q=-1/0;for(let Z=f;Z<_;Z+=f){const re=h[Z],se=h[Z+1];re<j&&(j=re),se<z&&(z=se),re>N&&(N=re),se>q&&(q=se)}B=Math.max(N-j,q-z),B=B!==0?32767/B:0}return gx(C,T,f,j,z,B,0),T}function UI(h,c,f,g,_){let C;if(_===function(T,j,z,B){let N=0;for(let q=j,Z=z-B;q<z;q+=B)N+=(T[Z]-T[q])*(T[q+1]+T[Z+1]),Z=q;return N}(h,c,f,g)>0)for(let T=c;T<f;T+=g)C=HI(T/g|0,h[T],h[T+1],C);else for(let T=f-g;T>=c;T-=g)C=HI(T/g|0,h[T],h[T+1],C);return C&&C_(C,C.next)&&(xx(C),C=C.next),C}function Jf(h,c){if(!h)return h;c||(c=h);let f,g=h;do if(f=!1,g.steiner||!C_(g,g.next)&&Si(g.prev,g,g.next)!==0)g=g.next;else{if(xx(g),g=c=g.prev,g===g.next)break;f=!0}while(f||g!==c);return c}function gx(h,c,f,g,_,C,T){if(!h)return;!T&&C&&function(z,B,N,q){let Z=z;do Z.z===0&&(Z.z=rT(Z.x,Z.y,B,N,q)),Z.prevZ=Z.prev,Z.nextZ=Z.next,Z=Z.next;while(Z!==z);Z.prevZ.nextZ=null,Z.prevZ=null,function(re){let se,ae=1;do{let me,we=re;re=null;let Ze=null;for(se=0;we;){se++;let Ee=we,Qe=0;for(let yt=0;yt<ae&&(Qe++,Ee=Ee.nextZ,Ee);yt++);let ot=ae;for(;Qe>0||ot>0&&Ee;)Qe!==0&&(ot===0||!Ee||we.z<=Ee.z)?(me=we,we=we.nextZ,Qe--):(me=Ee,Ee=Ee.nextZ,ot--),Ze?Ze.nextZ=me:re=me,me.prevZ=Ze,Ze=me;we=Ee}Ze.nextZ=null,ae*=2}while(se>1)}(Z)}(h,g,_,C);let j=h;for(;h.prev!==h.next;){const z=h.prev,B=h.next;if(C?rG(h,g,_,C):tG(h))c.push(z.i,h.i,B.i),xx(h),h=B.next,j=B.next;else if((h=B)===j){T?T===1?gx(h=nG(Jf(h),c),c,f,g,_,C,2):T===2&&iG(h,c,f,g,_,C):gx(Jf(h),c,f,g,_,C,1);break}}}function tG(h){const c=h.prev,f=h,g=h.next;if(Si(c,f,g)>=0)return!1;const _=c.x,C=f.x,T=g.x,j=c.y,z=f.y,B=g.y,N=_<C?_<T?_:T:C<T?C:T,q=j<z?j<B?j:B:z<B?z:B,Z=_>C?_>T?_:T:C>T?C:T,re=j>z?j>B?j:B:z>B?z:B;let se=g.next;for(;se!==c;){if(se.x>=N&&se.x<=Z&&se.y>=q&&se.y<=re&&og(_,j,C,z,T,B,se.x,se.y)&&Si(se.prev,se,se.next)>=0)return!1;se=se.next}return!0}function rG(h,c,f,g){const _=h.prev,C=h,T=h.next;if(Si(_,C,T)>=0)return!1;const j=_.x,z=C.x,B=T.x,N=_.y,q=C.y,Z=T.y,re=j<z?j<B?j:B:z<B?z:B,se=N<q?N<Z?N:Z:q<Z?q:Z,ae=j>z?j>B?j:B:z>B?z:B,me=N>q?N>Z?N:Z:q>Z?q:Z,we=rT(re,se,c,f,g),Ze=rT(ae,me,c,f,g);let Ee=h.prevZ,Qe=h.nextZ;for(;Ee&&Ee.z>=we&&Qe&&Qe.z<=Ze;){if(Ee.x>=re&&Ee.x<=ae&&Ee.y>=se&&Ee.y<=me&&Ee!==_&&Ee!==T&&og(j,N,z,q,B,Z,Ee.x,Ee.y)&&Si(Ee.prev,Ee,Ee.next)>=0||(Ee=Ee.prevZ,Qe.x>=re&&Qe.x<=ae&&Qe.y>=se&&Qe.y<=me&&Qe!==_&&Qe!==T&&og(j,N,z,q,B,Z,Qe.x,Qe.y)&&Si(Qe.prev,Qe,Qe.next)>=0))return!1;Qe=Qe.nextZ}for(;Ee&&Ee.z>=we;){if(Ee.x>=re&&Ee.x<=ae&&Ee.y>=se&&Ee.y<=me&&Ee!==_&&Ee!==T&&og(j,N,z,q,B,Z,Ee.x,Ee.y)&&Si(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.prevZ}for(;Qe&&Qe.z<=Ze;){if(Qe.x>=re&&Qe.x<=ae&&Qe.y>=se&&Qe.y<=me&&Qe!==_&&Qe!==T&&og(j,N,z,q,B,Z,Qe.x,Qe.y)&&Si(Qe.prev,Qe,Qe.next)>=0)return!1;Qe=Qe.nextZ}return!0}function nG(h,c){let f=h;do{const g=f.prev,_=f.next.next;!C_(g,_)&&qI(g,f,f.next,_)&&yx(g,_)&&yx(_,g)&&(c.push(g.i,f.i,_.i),xx(f),xx(f.next),f=h=_),f=f.next}while(f!==h);return Jf(f)}function iG(h,c,f,g,_,C){let T=h;do{let j=T.next.next;for(;j!==T.prev;){if(T.i!==j.i&&cG(T,j)){let z=QI(T,j);return T=Jf(T,T.next),z=Jf(z,z.next),gx(T,c,f,g,_,C,0),void gx(z,c,f,g,_,C,0)}j=j.next}T=T.next}while(T!==h)}function sG(h,c){return h.x-c.x}function oG(h,c){const f=function(_,C){let T=C;const j=_.x,z=_.y;let B,N=-1/0;do{if(z<=T.y&&z>=T.next.y&&T.next.y!==T.y){const ae=T.x+(z-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(ae<=j&&ae>N&&(N=ae,B=T.x<T.next.x?T:T.next,ae===j))return B}T=T.next}while(T!==C);if(!B)return null;const q=B,Z=B.x,re=B.y;let se=1/0;T=B;do{if(j>=T.x&&T.x>=Z&&j!==T.x&&og(z<re?j:N,z,Z,re,z<re?N:j,z,T.x,T.y)){const ae=Math.abs(z-T.y)/(j-T.x);yx(T,_)&&(ae<se||ae===se&&(T.x>B.x||T.x===B.x&&aG(B,T)))&&(B=T,se=ae)}T=T.next}while(T!==q);return B}(h,c);if(!f)return c;const g=QI(f,h);return Jf(g,g.next),Jf(f,f.next)}function aG(h,c){return Si(h.prev,h,c.prev)<0&&Si(c.next,h,h.next)<0}function rT(h,c,f,g,_){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-f)*_|0)|h<<8))|h<<4))|h<<2))|h<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-g)*_|0)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function lG(h){let c=h,f=h;do(c.x<f.x||c.x===f.x&&c.y<f.y)&&(f=c),c=c.next;while(c!==h);return f}function og(h,c,f,g,_,C,T,j){return(_-T)*(c-j)>=(h-T)*(C-j)&&(h-T)*(g-j)>=(f-T)*(c-j)&&(f-T)*(C-j)>=(_-T)*(g-j)}function cG(h,c){return h.next.i!==c.i&&h.prev.i!==c.i&&!function(f,g){let _=f;do{if(_.i!==f.i&&_.next.i!==f.i&&_.i!==g.i&&_.next.i!==g.i&&qI(_,_.next,f,g))return!0;_=_.next}while(_!==f);return!1}(h,c)&&(yx(h,c)&&yx(c,h)&&function(f,g){let _=f,C=!1;const T=(f.x+g.x)/2,j=(f.y+g.y)/2;do _.y>j!=_.next.y>j&&_.next.y!==_.y&&T<(_.next.x-_.x)*(j-_.y)/(_.next.y-_.y)+_.x&&(C=!C),_=_.next;while(_!==f);return C}(h,c)&&(Si(h.prev,h,c.prev)||Si(h,c.prev,c))||C_(h,c)&&Si(h.prev,h,h.next)>0&&Si(c.prev,c,c.next)>0)}function Si(h,c,f){return(c.y-h.y)*(f.x-c.x)-(c.x-h.x)*(f.y-c.y)}function C_(h,c){return h.x===c.x&&h.y===c.y}function qI(h,c,f,g){const _=O_(Si(h,c,f)),C=O_(Si(h,c,g)),T=O_(Si(f,g,h)),j=O_(Si(f,g,c));return _!==C&&T!==j||!(_!==0||!T_(h,f,c))||!(C!==0||!T_(h,g,c))||!(T!==0||!T_(f,h,g))||!(j!==0||!T_(f,c,g))}function T_(h,c,f){return c.x<=Math.max(h.x,f.x)&&c.x>=Math.min(h.x,f.x)&&c.y<=Math.max(h.y,f.y)&&c.y>=Math.min(h.y,f.y)}function O_(h){return h>0?1:h<0?-1:0}function yx(h,c){return Si(h.prev,h,h.next)<0?Si(h,c,h.next)>=0&&Si(h,h.prev,c)>=0:Si(h,c,h.prev)<0||Si(h,h.next,c)<0}function QI(h,c){const f=nT(h.i,h.x,h.y),g=nT(c.i,c.x,c.y),_=h.next,C=c.prev;return h.next=c,c.prev=h,f.next=_,_.prev=f,g.next=f,f.prev=g,C.next=g,g.prev=C,g}function HI(h,c,f,g){const _=nT(h,c,f);return g?(_.next=g.next,_.prev=g,g.next.prev=_,g.next=_):(_.prev=_,_.next=_),_}function xx(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function nT(h,c,f){return{i:h,x:c,y:f,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function iT(h,c,f){const g=f.patternDependencies;let _=!1;for(const C of c){const T=C.paint.get(`${h}-pattern`);T.isConstant()||(_=!0);const j=T.constantOr(null);j&&(_=!0,g[j.to]=!0,g[j.from]=!0)}return _}function sT(h,c,f,g,_){const C=_.patternDependencies;for(const T of c){const j=T.paint.get(`${h}-pattern`).value;if(j.kind!=="constant"){let z=j.evaluate({zoom:g-1},f,{},_.availableImages),B=j.evaluate({zoom:g},f,{},_.availableImages),N=j.evaluate({zoom:g+1},f,{},_.availableImages);z=z&&z.name?z.name:z,B=B&&B.name?B.name:B,N=N&&N.name?N.name:N,C[z]=!0,C[B]=!0,C[N]=!0,f.patterns[T.id]={min:z,mid:B,max:N}}}return f}class oT{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(f=>f.id),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pl,this.indexArray=new Fa,this.indexArray2=new hs,this.programConfigurations=new Kf(c.layers,c.zoom),this.segments=new Yr,this.segments2=new Yr,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(c,f,g){this.hasPattern=iT("fill",this.layers,f);const _=this.layers[0].layout.get("fill-sort-key"),C=!_.isConstant(),T=[];for(const{feature:j,id:z,index:B,sourceLayerIndex:N}of c){const q=this.layers[0]._featureFilter.needGeometry,Z=Yf(j,q);if(!this.layers[0]._featureFilter.filter(new qn(this.zoom),Z,g))continue;const re=C?_.evaluate(Z,{},g,f.availableImages):void 0,se={id:z,properties:j.properties,type:j.type,sourceLayerIndex:N,index:B,geometry:q?Z.geometry:Zf(j),patterns:{},sortKey:re};T.push(se)}C&&T.sort((j,z)=>j.sortKey-z.sortKey);for(const j of T){const{geometry:z,index:B,sourceLayerIndex:N}=j;if(this.hasPattern){const q=sT("fill",this.layers,j,this.zoom,f);this.patternFeatures.push(q)}else this.addFeature(j,z,B,g,{});f.featureIndex.insert(c[B].feature,z,B,N,this.index)}}update(c,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,f,this.stateDependentLayers,g)}addFeatures(c,f,g){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,eG),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(c,f,g,_,C){for(const T of Am(f,500)){let j=0;for(const re of T)j+=re.length;const z=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray),B=z.vertexLength,N=[],q=[];for(const re of T){if(re.length===0)continue;re!==T[0]&&q.push(N.length/2);const se=this.segments2.prepareSegment(re.length,this.layoutVertexArray,this.indexArray2),ae=se.vertexLength;this.layoutVertexArray.emplaceBack(re[0].x,re[0].y),this.indexArray2.emplaceBack(ae+re.length-1,ae),N.push(re[0].x),N.push(re[0].y);for(let me=1;me<re.length;me++)this.layoutVertexArray.emplaceBack(re[me].x,re[me].y),this.indexArray2.emplaceBack(ae+me-1,ae+me),N.push(re[me].x),N.push(re[me].y);se.vertexLength+=re.length,se.primitiveLength+=re.length}const Z=WI(N,q);for(let re=0;re<Z.length;re+=3)this.indexArray.emplaceBack(B+Z[re],B+Z[re+1],B+Z[re+2]);z.vertexLength+=j,z.primitiveLength+=Z.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,C,_)}}let GI,XI;Kt("FillBucket",oT,{omit:["layers","patternFeatures"]});var uG={get paint(){return XI=XI||new k({"fill-antialias":new or(Te.paint_fill["fill-antialias"]),"fill-opacity":new _r(Te.paint_fill["fill-opacity"]),"fill-color":new _r(Te.paint_fill["fill-color"]),"fill-outline-color":new _r(Te.paint_fill["fill-outline-color"]),"fill-translate":new or(Te.paint_fill["fill-translate"]),"fill-translate-anchor":new or(Te.paint_fill["fill-translate-anchor"]),"fill-pattern":new Km(Te.paint_fill["fill-pattern"])})},get layout(){return GI=GI||new k({"fill-sort-key":new _r(Te.layout_fill["fill-sort-key"])})}};class hG extends p{constructor(c){super(c,uG)}recalculate(c,f){super.recalculate(c,f);const g=this.paint._values["fill-outline-color"];g.value.kind==="constant"&&g.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new oT(c)}queryRadius(){return w_(this.paint.get("fill-translate"))}queryIntersectsFeature(c,f,g,_,C,T,j){return EI(S_(c,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),T.angle,j),_)}isTileClipped(){return!0}}const dG=A([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),fG=A([{name:"a_centroid",components:2,type:"Int16"}],4),{members:pG}=dG;var rd={},mG=m,KI=ag;function ag(h,c,f,g,_){this.properties={},this.extent=f,this.type=0,this._pbf=h,this._geometry=-1,this._keys=g,this._values=_,h.readFields(gG,this,c)}function gG(h,c,f){h==1?c.id=f.readVarint():h==2?function(g,_){for(var C=g.readVarint()+g.pos;g.pos<C;){var T=_._keys[g.readVarint()],j=_._values[g.readVarint()];_.properties[T]=j}}(f,c):h==3?c.type=f.readVarint():h==4&&(c._geometry=f.pos)}function yG(h){for(var c,f,g=0,_=0,C=h.length,T=C-1;_<C;T=_++)g+=((f=h[T]).x-(c=h[_]).x)*(c.y+f.y);return g}ag.types=["Unknown","Point","LineString","Polygon"],ag.prototype.loadGeometry=function(){var h=this._pbf;h.pos=this._geometry;for(var c,f=h.readVarint()+h.pos,g=1,_=0,C=0,T=0,j=[];h.pos<f;){if(_<=0){var z=h.readVarint();g=7&z,_=z>>3}if(_--,g===1||g===2)C+=h.readSVarint(),T+=h.readSVarint(),g===1&&(c&&j.push(c),c=[]),c.push(new mG(C,T));else{if(g!==7)throw new Error("unknown command "+g);c&&c.push(c[0].clone())}}return c&&j.push(c),j},ag.prototype.bbox=function(){var h=this._pbf;h.pos=this._geometry;for(var c=h.readVarint()+h.pos,f=1,g=0,_=0,C=0,T=1/0,j=-1/0,z=1/0,B=-1/0;h.pos<c;){if(g<=0){var N=h.readVarint();f=7&N,g=N>>3}if(g--,f===1||f===2)(_+=h.readSVarint())<T&&(T=_),_>j&&(j=_),(C+=h.readSVarint())<z&&(z=C),C>B&&(B=C);else if(f!==7)throw new Error("unknown command "+f)}return[T,z,j,B]},ag.prototype.toGeoJSON=function(h,c,f){var g,_,C=this.extent*Math.pow(2,f),T=this.extent*h,j=this.extent*c,z=this.loadGeometry(),B=ag.types[this.type];function N(re){for(var se=0;se<re.length;se++){var ae=re[se];re[se]=[360*(ae.x+T)/C-180,360/Math.PI*Math.atan(Math.exp((180-360*(ae.y+j)/C)*Math.PI/180))-90]}}switch(this.type){case 1:var q=[];for(g=0;g<z.length;g++)q[g]=z[g][0];N(z=q);break;case 2:for(g=0;g<z.length;g++)N(z[g]);break;case 3:for(z=function(re){var se=re.length;if(se<=1)return[re];for(var ae,me,we=[],Ze=0;Ze<se;Ze++){var Ee=yG(re[Ze]);Ee!==0&&(me===void 0&&(me=Ee<0),me===Ee<0?(ae&&we.push(ae),ae=[re[Ze]]):ae.push(re[Ze]))}return ae&&we.push(ae),we}(z),g=0;g<z.length;g++)for(_=0;_<z[g].length;_++)N(z[g][_])}z.length===1?z=z[0]:B="Multi"+B;var Z={type:"Feature",geometry:{type:B,coordinates:z},properties:this.properties};return"id"in this&&(Z.id=this.id),Z};var xG=KI,ZI=YI;function YI(h,c){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields(vG,this,c),this.length=this._features.length}function vG(h,c,f){h===15?c.version=f.readVarint():h===1?c.name=f.readString():h===5?c.extent=f.readVarint():h===2?c._features.push(f.pos):h===3?c._keys.push(f.readString()):h===4&&c._values.push(function(g){for(var _=null,C=g.readVarint()+g.pos;g.pos<C;){var T=g.readVarint()>>3;_=T===1?g.readString():T===2?g.readFloat():T===3?g.readDouble():T===4?g.readVarint64():T===5?g.readVarint():T===6?g.readSVarint():T===7?g.readBoolean():null}return _}(f))}YI.prototype.feature=function(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];var c=this._pbf.readVarint()+this._pbf.pos;return new xG(this._pbf,c,this.extent,this._keys,this._values)};var bG=ZI;function _G(h,c,f){if(h===3){var g=new bG(f,f.readVarint()+f.pos);g.length&&(c[g.name]=g)}}rd.VectorTile=function(h,c){this.layers=h.readFields(_G,{},c)},rd.VectorTileFeature=KI,rd.VectorTileLayer=ZI;const wG=rd.VectorTileFeature.types,aT=Math.pow(2,13);function vx(h,c,f,g,_,C,T,j){h.emplaceBack(c,f,2*Math.floor(g*aT)+T,_*aT*2,C*aT*2,Math.round(j))}class lT{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(f=>f.id),this.index=c.index,this.hasPattern=!1,this.layoutVertexArray=new Kh,this.centroidVertexArray=new Es,this.indexArray=new Fa,this.programConfigurations=new Kf(c.layers,c.zoom),this.segments=new Yr,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(c,f,g){this.features=[],this.hasPattern=iT("fill-extrusion",this.layers,f);for(const{feature:_,id:C,index:T,sourceLayerIndex:j}of c){const z=this.layers[0]._featureFilter.needGeometry,B=Yf(_,z);if(!this.layers[0]._featureFilter.filter(new qn(this.zoom),B,g))continue;const N={id:C,sourceLayerIndex:j,index:T,geometry:z?B.geometry:Zf(_),properties:_.properties,type:_.type,patterns:{}};this.hasPattern?this.features.push(sT("fill-extrusion",this.layers,N,this.zoom,f)):this.addFeature(N,N.geometry,T,g,{}),f.featureIndex.insert(_,N.geometry,T,j,this.index,!0)}}addFeatures(c,f,g){for(const _ of this.features){const{geometry:C}=_;this.addFeature(_,C,_.index,f,g)}}update(c,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,f,this.stateDependentLayers,g)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,pG),this.centroidVertexBuffer=c.createVertexBuffer(this.centroidVertexArray,fG.members,!0),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(c,f,g,_,C){for(const T of Am(f,500)){const j={x:0,y:0,vertexCount:0};let z=0;for(const se of T)z+=se.length;let B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const se of T){if(se.length===0||kG(se))continue;let ae=0;for(let me=0;me<se.length;me++){const we=se[me];if(me>=1){const Ze=se[me-1];if(!SG(we,Ze)){B.vertexLength+4>Yr.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ee=we.sub(Ze)._perp()._unit(),Qe=Ze.dist(we);ae+Qe>32768&&(ae=0),vx(this.layoutVertexArray,we.x,we.y,Ee.x,Ee.y,0,0,ae),vx(this.layoutVertexArray,we.x,we.y,Ee.x,Ee.y,0,1,ae),j.x+=2*we.x,j.y+=2*we.y,j.vertexCount+=2,ae+=Qe,vx(this.layoutVertexArray,Ze.x,Ze.y,Ee.x,Ee.y,0,0,ae),vx(this.layoutVertexArray,Ze.x,Ze.y,Ee.x,Ee.y,0,1,ae),j.x+=2*Ze.x,j.y+=2*Ze.y,j.vertexCount+=2;const ot=B.vertexLength;this.indexArray.emplaceBack(ot,ot+2,ot+1),this.indexArray.emplaceBack(ot+1,ot+2,ot+3),B.vertexLength+=4,B.primitiveLength+=2}}}}if(B.vertexLength+z>Yr.MAX_VERTEX_ARRAY_LENGTH&&(B=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray)),wG[c.type]!=="Polygon")continue;const N=[],q=[],Z=B.vertexLength;for(const se of T)if(se.length!==0){se!==T[0]&&q.push(N.length/2);for(let ae=0;ae<se.length;ae++){const me=se[ae];vx(this.layoutVertexArray,me.x,me.y,0,0,1,1,0),j.x+=me.x,j.y+=me.y,j.vertexCount+=1,N.push(me.x),N.push(me.y)}}const re=WI(N,q);for(let se=0;se<re.length;se+=3)this.indexArray.emplaceBack(Z+re[se],Z+re[se+2],Z+re[se+1]);B.primitiveLength+=re.length/3,B.vertexLength+=z;for(let se=0;se<j.vertexCount;se++){const ae=Math.floor(j.x/j.vertexCount),me=Math.floor(j.y/j.vertexCount);this.centroidVertexArray.emplaceBack(ae,me)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,C,_)}}function SG(h,c){return h.x===c.x&&(h.x<0||h.x>Ei)||h.y===c.y&&(h.y<0||h.y>Ei)}function kG(h){return h.every(c=>c.x<0)||h.every(c=>c.x>Ei)||h.every(c=>c.y<0)||h.every(c=>c.y>Ei)}let JI;Kt("FillExtrusionBucket",lT,{omit:["layers","features"]});var CG={get paint(){return JI=JI||new k({"fill-extrusion-opacity":new or(Te["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _r(Te["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new or(Te["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new or(Te["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Km(Te["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _r(Te["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _r(Te["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new or(Te["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class TG extends p{constructor(c){super(c,CG)}createBucket(c){return new lT(c)}queryRadius(){return w_(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(c,f,g,_,C,T,j,z){const B=S_(c,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),T.angle,j),N=this.paint.get("fill-extrusion-height").evaluate(f,g),q=this.paint.get("fill-extrusion-base").evaluate(f,g),Z=function(se,ae,me,we){const Ze=[];for(const Ee of se){const Qe=[Ee.x,Ee.y,0,1];k_(Qe,Qe,ae),Ze.push(new v(Qe[0]/Qe[3],Qe[1]/Qe[3]))}return Ze}(B,z),re=function(se,ae,me,we){const Ze=[],Ee=[],Qe=we[8]*ae,ot=we[9]*ae,yt=we[10]*ae,Wt=we[11]*ae,xr=we[8]*me,$t=we[9]*me,Rt=we[10]*me,dr=we[11]*me;for(const er of se){const Ht=[],ht=[];for(const fr of er){const cr=fr.x,Or=fr.y,Dn=we[0]*cr+we[4]*Or+we[12],jn=we[1]*cr+we[5]*Or+we[13],Xi=we[2]*cr+we[6]*Or+we[14],ml=we[3]*cr+we[7]*Or+we[15],Is=Xi+yt,Ki=ml+Wt,po=Dn+xr,mo=jn+$t,go=Xi+Rt,yi=ml+dr,Zi=new v((Dn+Qe)/Ki,(jn+ot)/Ki);Zi.z=Is/Ki,Ht.push(Zi);const Hs=new v(po/yi,mo/yi);Hs.z=go/yi,ht.push(Hs)}Ze.push(Ht),Ee.push(ht)}return[Ze,Ee]}(_,q,N,z);return function(se,ae,me){let we=1/0;EI(me,ae)&&(we=eR(me,ae[0]));for(let Ze=0;Ze<ae.length;Ze++){const Ee=ae[Ze],Qe=se[Ze];for(let ot=0;ot<Ee.length-1;ot++){const yt=Ee[ot],Wt=[yt,Ee[ot+1],Qe[ot+1],Qe[ot],yt];AI(me,Wt)&&(we=Math.min(we,eR(me,Wt)))}}return we!==1/0&&we}(re[0],re[1],Z)}}function bx(h,c){return h.x*c.x+h.y*c.y}function eR(h,c){if(h.length===1){let f=0;const g=c[f++];let _;for(;!_||g.equals(_);)if(_=c[f++],!_)return 1/0;for(;f<c.length;f++){const C=c[f],T=h[0],j=_.sub(g),z=C.sub(g),B=T.sub(g),N=bx(j,j),q=bx(j,z),Z=bx(z,z),re=bx(B,j),se=bx(B,z),ae=N*Z-q*q,me=(Z*re-q*se)/ae,we=(N*se-q*re)/ae,Ze=g.z*(1-me-we)+_.z*me+C.z*we;if(isFinite(Ze))return Ze}return 1/0}{let f=1/0;for(const g of c)f=Math.min(f,g.z);return f}}const OG=A([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:jG}=OG,PG=A([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:AG}=PG,EG=rd.VectorTileFeature.types,zG=Math.cos(Math.PI/180*37.5),tR=Math.pow(2,14)/.5;class cT{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(f=>f.id),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(f=>{this.gradients[f.id]={}}),this.layoutVertexArray=new Ym,this.layoutVertexArray2=new Zh,this.indexArray=new Fa,this.programConfigurations=new Kf(c.layers,c.zoom),this.segments=new Yr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(c,f,g){this.hasPattern=iT("line",this.layers,f);const _=this.layers[0].layout.get("line-sort-key"),C=!_.isConstant(),T=[];for(const{feature:j,id:z,index:B,sourceLayerIndex:N}of c){const q=this.layers[0]._featureFilter.needGeometry,Z=Yf(j,q);if(!this.layers[0]._featureFilter.filter(new qn(this.zoom),Z,g))continue;const re=C?_.evaluate(Z,{},g):void 0,se={id:z,properties:j.properties,type:j.type,sourceLayerIndex:N,index:B,geometry:q?Z.geometry:Zf(j),patterns:{},sortKey:re};T.push(se)}C&&T.sort((j,z)=>j.sortKey-z.sortKey);for(const j of T){const{geometry:z,index:B,sourceLayerIndex:N}=j;if(this.hasPattern){const q=sT("line",this.layers,j,this.zoom,f);this.patternFeatures.push(q)}else this.addFeature(j,z,B,g,{});f.featureIndex.insert(c[B].feature,z,B,N,this.index)}}update(c,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(c,f,this.stateDependentLayers,g)}addFeatures(c,f,g){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,AG)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,jG),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(c){if(c.properties&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(c.properties,"mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}}addFeature(c,f,g,_,C){const T=this.layers[0].layout,j=T.get("line-join").evaluate(c,{}),z=T.get("line-cap"),B=T.get("line-miter-limit"),N=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(const q of f)this.addLine(q,c,j,z,B,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,g,C,_)}addLine(c,f,g,_,C,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let we=0;we<c.length-1;we++)this.totalDistance+=c[we].dist(c[we+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const j=EG[f.type]==="Polygon";let z=c.length;for(;z>=2&&c[z-1].equals(c[z-2]);)z--;let B=0;for(;B<z-1&&c[B].equals(c[B+1]);)B++;if(z<(j?3:2))return;g==="bevel"&&(C=1.05);const N=this.overscaling<=16?15*Ei/(512*this.overscaling):0,q=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray);let Z,re,se,ae,me;this.e1=this.e2=-1,j&&(Z=c[z-2],me=c[B].sub(Z)._unit()._perp());for(let we=B;we<z;we++){if(se=we===z-1?j?c[B+1]:void 0:c[we+1],se&&c[we].equals(se))continue;me&&(ae=me),Z&&(re=Z),Z=c[we],me=se?se.sub(Z)._unit()._perp():ae,ae=ae||me;let Ze=ae.add(me);Ze.x===0&&Ze.y===0||Ze._unit();const Ee=ae.x*me.x+ae.y*me.y,Qe=Ze.x*me.x+Ze.y*me.y,ot=Qe!==0?1/Qe:1/0,yt=2*Math.sqrt(2-2*Qe),Wt=Qe<zG&&re&&se,xr=ae.x*me.y-ae.y*me.x>0;if(Wt&&we>B){const dr=Z.dist(re);if(dr>2*N){const er=Z.sub(Z.sub(re)._mult(N/dr)._round());this.updateDistance(re,er),this.addCurrentVertex(er,ae,0,0,q),re=er}}const $t=re&&se;let Rt=$t?g:j?"butt":_;if($t&&Rt==="round"&&(ot<T?Rt="miter":ot<=2&&(Rt="fakeround")),Rt==="miter"&&ot>C&&(Rt="bevel"),Rt==="bevel"&&(ot>2&&(Rt="flipbevel"),ot<C&&(Rt="miter")),re&&this.updateDistance(re,Z),Rt==="miter")Ze._mult(ot),this.addCurrentVertex(Z,Ze,0,0,q);else if(Rt==="flipbevel"){if(ot>100)Ze=me.mult(-1);else{const dr=ot*ae.add(me).mag()/ae.sub(me).mag();Ze._perp()._mult(dr*(xr?-1:1))}this.addCurrentVertex(Z,Ze,0,0,q),this.addCurrentVertex(Z,Ze.mult(-1),0,0,q)}else if(Rt==="bevel"||Rt==="fakeround"){const dr=-Math.sqrt(ot*ot-1),er=xr?dr:0,Ht=xr?0:dr;if(re&&this.addCurrentVertex(Z,ae,er,Ht,q),Rt==="fakeround"){const ht=Math.round(180*yt/Math.PI/20);for(let fr=1;fr<ht;fr++){let cr=fr/ht;if(cr!==.5){const Dn=cr-.5;cr+=cr*Dn*(cr-1)*((1.0904+Ee*(Ee*(3.55645-1.43519*Ee)-3.2452))*Dn*Dn+(.848013+Ee*(.215638*Ee-1.06021)))}const Or=me.sub(ae)._mult(cr)._add(ae)._unit()._mult(xr?-1:1);this.addHalfVertex(Z,Or.x,Or.y,!1,xr,0,q)}}se&&this.addCurrentVertex(Z,me,-er,-Ht,q)}else if(Rt==="butt")this.addCurrentVertex(Z,Ze,0,0,q);else if(Rt==="square"){const dr=re?1:-1;this.addCurrentVertex(Z,Ze,dr,dr,q)}else Rt==="round"&&(re&&(this.addCurrentVertex(Z,ae,0,0,q),this.addCurrentVertex(Z,ae,1,1,q,!0)),se&&(this.addCurrentVertex(Z,me,-1,-1,q,!0),this.addCurrentVertex(Z,me,0,0,q)));if(Wt&&we<z-1){const dr=Z.dist(se);if(dr>2*N){const er=Z.add(se.sub(Z)._mult(N/dr)._round());this.updateDistance(Z,er),this.addCurrentVertex(er,me,0,0,q),Z=er}}}}addCurrentVertex(c,f,g,_,C,T=!1){const j=f.y*_-f.x,z=-f.y-f.x*_;this.addHalfVertex(c,f.x+f.y*g,f.y-f.x*g,T,!1,g,C),this.addHalfVertex(c,j,z,T,!0,-_,C),this.distance>tR/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(c,f,g,_,C,T))}addHalfVertex({x:c,y:f},g,_,C,T,j,z){const B=.5*(this.lineClips?this.scaledDistance*(tR-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((c<<1)+(C?1:0),(f<<1)+(T?1:0),Math.round(63*g)+128,Math.round(63*_)+128,1+(j===0?0:j<0?-1:1)|(63&B)<<2,B>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const N=z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,N),z.primitiveLength++),T?this.e2=N:this.e1=N}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(c,f){this.distance+=c.dist(f),this.updateScaledDistance()}}let rR,nR;Kt("LineBucket",cT,{omit:["layers","patternFeatures"]});var iR={get paint(){return nR=nR||new k({"line-opacity":new _r(Te.paint_line["line-opacity"]),"line-color":new _r(Te.paint_line["line-color"]),"line-translate":new or(Te.paint_line["line-translate"]),"line-translate-anchor":new or(Te.paint_line["line-translate-anchor"]),"line-width":new _r(Te.paint_line["line-width"]),"line-gap-width":new _r(Te.paint_line["line-gap-width"]),"line-offset":new _r(Te.paint_line["line-offset"]),"line-blur":new _r(Te.paint_line["line-blur"]),"line-dasharray":new Zm(Te.paint_line["line-dasharray"]),"line-pattern":new Km(Te.paint_line["line-pattern"]),"line-gradient":new ux(Te.paint_line["line-gradient"])})},get layout(){return rR=rR||new k({"line-cap":new or(Te.layout_line["line-cap"]),"line-join":new _r(Te.layout_line["line-join"]),"line-miter-limit":new or(Te.layout_line["line-miter-limit"]),"line-round-limit":new or(Te.layout_line["line-round-limit"]),"line-sort-key":new _r(Te.layout_line["line-sort-key"])})}};class MG extends _r{possiblyEvaluate(c,f){return f=new qn(Math.floor(f.zoom),{now:f.now,fadeDuration:f.fadeDuration,zoomHistory:f.zoomHistory,transition:f.transition}),super.possiblyEvaluate(c,f)}evaluate(c,f,g,_){return f=K({},f,{zoom:Math.floor(f.zoom)}),super.evaluate(c,f,g,_)}}let j_;class IG extends p{constructor(c){super(c,iR),this.gradientVersion=0,j_||(j_=new MG(iR.paint.properties["line-width"].specification),j_.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const f=this.gradientExpression();this.stepInterpolant=!!function(g){return g._styleExpression!==void 0}(f)&&f._styleExpression.expression instanceof ul,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,f){super.recalculate(c,f),this.paint._values["line-floorwidth"]=j_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new cT(c)}queryRadius(c){const f=c,g=sR(fx("line-width",this,f),fx("line-gap-width",this,f)),_=fx("line-offset",this,f);return g/2+Math.abs(_)+w_(this.paint.get("line-translate"))}queryIntersectsFeature(c,f,g,_,C,T,j){const z=S_(c,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),T.angle,j),B=j/2*sR(this.paint.get("line-width").evaluate(f,g),this.paint.get("line-gap-width").evaluate(f,g)),N=this.paint.get("line-offset").evaluate(f,g);return N&&(_=function(q,Z){const re=[];for(let se=0;se<q.length;se++){const ae=q[se],me=[];for(let we=0;we<ae.length;we++){const Ze=ae[we-1],Ee=ae[we],Qe=ae[we+1],ot=we===0?new v(0,0):Ee.sub(Ze)._unit()._perp(),yt=we===ae.length-1?new v(0,0):Qe.sub(Ee)._unit()._perp(),Wt=ot._add(yt)._unit(),xr=Wt.x*yt.x+Wt.y*yt.y;xr!==0&&Wt._mult(1/xr),me.push(Wt._mult(Z)._add(Ee))}re.push(me)}return re}(_,N*j)),function(q,Z,re){for(let se=0;se<Z.length;se++){const ae=Z[se];if(q.length>=3){for(let me=0;me<ae.length;me++)if(ig(q,ae[me]))return!0}if(WH(q,ae,re))return!0}return!1}(z,_,B)}isTileClipped(){return!0}}function sR(h,c){return c>0?c+2*h:h}const RG=A([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),DG=A([{name:"a_projected_pos",components:3,type:"Float32"}],4);A([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const LG=A([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);A([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const oR=A([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),FG=A([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function BG(h,c,f){return h.sections.forEach(g=>{g.text=function(_,C,T){const j=C.layout.get("text-transform").evaluate(T,{});return j==="uppercase"?_=_.toLocaleUpperCase():j==="lowercase"&&(_=_.toLocaleLowerCase()),zo.applyArabicShaping&&(_=zo.applyArabicShaping(_)),_}(g.text,c,f)}),h}A([{name:"triangle",components:3,type:"Uint16"}]),A([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),A([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),A([{type:"Float32",name:"offsetX"}]),A([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),A([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const _x={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Fi=24,aR=On,lR=function(h,c,f,g,_){var C,T,j=8*_-g-1,z=(1<<j)-1,B=z>>1,N=-7,q=_-1,Z=-1,re=h[c+q];for(q+=Z,C=re&(1<<-N)-1,re>>=-N,N+=j;N>0;C=256*C+h[c+q],q+=Z,N-=8);for(T=C&(1<<-N)-1,C>>=-N,N+=g;N>0;T=256*T+h[c+q],q+=Z,N-=8);if(C===0)C=1-B;else{if(C===z)return T?NaN:1/0*(re?-1:1);T+=Math.pow(2,g),C-=B}return(re?-1:1)*T*Math.pow(2,C-g)},cR=function(h,c,f,g,_,C){var T,j,z,B=8*C-_-1,N=(1<<B)-1,q=N>>1,Z=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,re=0,se=1,ae=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(j=isNaN(c)?1:0,T=N):(T=Math.floor(Math.log(c)/Math.LN2),c*(z=Math.pow(2,-T))<1&&(T--,z*=2),(c+=T+q>=1?Z/z:Z*Math.pow(2,1-q))*z>=2&&(T++,z/=2),T+q>=N?(j=0,T=N):T+q>=1?(j=(c*z-1)*Math.pow(2,_),T+=q):(j=c*Math.pow(2,q-1)*Math.pow(2,_),T=0));_>=8;h[f+re]=255&j,re+=se,j/=256,_-=8);for(T=T<<_|j,B+=_;B>0;h[f+re]=255&T,re+=se,T/=256,B-=8);h[f+re-se]|=128*ae};function On(h){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(h)?h:new Uint8Array(h||0),this.pos=0,this.type=0,this.length=this.buf.length}On.Varint=0,On.Fixed64=1,On.Bytes=2,On.Fixed32=5;var uT=4294967296,uR=1/uT,hR=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Nu(h){return h.type===On.Bytes?h.readVarint()+h.pos:h.pos+1}function lg(h,c,f){return f?4294967296*c+(h>>>0):4294967296*(c>>>0)+(h>>>0)}function dR(h,c,f){var g=c<=16383?1:c<=2097151?2:c<=268435455?3:Math.floor(Math.log(c)/(7*Math.LN2));f.realloc(g);for(var _=f.pos-1;_>=h;_--)f.buf[_+g]=f.buf[_]}function $G(h,c){for(var f=0;f<h.length;f++)c.writeVarint(h[f])}function NG(h,c){for(var f=0;f<h.length;f++)c.writeSVarint(h[f])}function VG(h,c){for(var f=0;f<h.length;f++)c.writeFloat(h[f])}function WG(h,c){for(var f=0;f<h.length;f++)c.writeDouble(h[f])}function UG(h,c){for(var f=0;f<h.length;f++)c.writeBoolean(h[f])}function qG(h,c){for(var f=0;f<h.length;f++)c.writeFixed32(h[f])}function QG(h,c){for(var f=0;f<h.length;f++)c.writeSFixed32(h[f])}function HG(h,c){for(var f=0;f<h.length;f++)c.writeFixed64(h[f])}function GG(h,c){for(var f=0;f<h.length;f++)c.writeSFixed64(h[f])}function P_(h,c){return(h[c]|h[c+1]<<8|h[c+2]<<16)+16777216*h[c+3]}function cg(h,c,f){h[f]=c,h[f+1]=c>>>8,h[f+2]=c>>>16,h[f+3]=c>>>24}function fR(h,c){return(h[c]|h[c+1]<<8|h[c+2]<<16)+(h[c+3]<<24)}On.prototype={destroy:function(){this.buf=null},readFields:function(h,c,f){for(f=f||this.length;this.pos<f;){var g=this.readVarint(),_=g>>3,C=this.pos;this.type=7&g,h(_,c,this),this.pos===C&&this.skip(g)}return c},readMessage:function(h,c){return this.readFields(h,c,this.readVarint()+this.pos)},readFixed32:function(){var h=P_(this.buf,this.pos);return this.pos+=4,h},readSFixed32:function(){var h=fR(this.buf,this.pos);return this.pos+=4,h},readFixed64:function(){var h=P_(this.buf,this.pos)+P_(this.buf,this.pos+4)*uT;return this.pos+=8,h},readSFixed64:function(){var h=P_(this.buf,this.pos)+fR(this.buf,this.pos+4)*uT;return this.pos+=8,h},readFloat:function(){var h=lR(this.buf,this.pos,!0,23,4);return this.pos+=4,h},readDouble:function(){var h=lR(this.buf,this.pos,!0,52,8);return this.pos+=8,h},readVarint:function(h){var c,f,g=this.buf;return c=127&(f=g[this.pos++]),f<128?c:(c|=(127&(f=g[this.pos++]))<<7,f<128?c:(c|=(127&(f=g[this.pos++]))<<14,f<128?c:(c|=(127&(f=g[this.pos++]))<<21,f<128?c:function(_,C,T){var j,z,B=T.buf;if(j=(112&(z=B[T.pos++]))>>4,z<128||(j|=(127&(z=B[T.pos++]))<<3,z<128)||(j|=(127&(z=B[T.pos++]))<<10,z<128)||(j|=(127&(z=B[T.pos++]))<<17,z<128)||(j|=(127&(z=B[T.pos++]))<<24,z<128)||(j|=(1&(z=B[T.pos++]))<<31,z<128))return lg(_,j,C);throw new Error("Expected varint not more than 10 bytes")}(c|=(15&(f=g[this.pos]))<<28,h,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var h=this.readVarint();return h%2==1?(h+1)/-2:h/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var h=this.readVarint()+this.pos,c=this.pos;return this.pos=h,h-c>=12&&hR?function(f,g,_){return hR.decode(f.subarray(g,_))}(this.buf,c,h):function(f,g,_){for(var C="",T=g;T<_;){var j,z,B,N=f[T],q=null,Z=N>239?4:N>223?3:N>191?2:1;if(T+Z>_)break;Z===1?N<128&&(q=N):Z===2?(192&(j=f[T+1]))==128&&(q=(31&N)<<6|63&j)<=127&&(q=null):Z===3?(z=f[T+2],(192&(j=f[T+1]))==128&&(192&z)==128&&((q=(15&N)<<12|(63&j)<<6|63&z)<=2047||q>=55296&&q<=57343)&&(q=null)):Z===4&&(z=f[T+2],B=f[T+3],(192&(j=f[T+1]))==128&&(192&z)==128&&(192&B)==128&&((q=(15&N)<<18|(63&j)<<12|(63&z)<<6|63&B)<=65535||q>=1114112)&&(q=null)),q===null?(q=65533,Z=1):q>65535&&(q-=65536,C+=String.fromCharCode(q>>>10&1023|55296),q=56320|1023&q),C+=String.fromCharCode(q),T+=Z}return C}(this.buf,c,h)},readBytes:function(){var h=this.readVarint()+this.pos,c=this.buf.subarray(this.pos,h);return this.pos=h,c},readPackedVarint:function(h,c){if(this.type!==On.Bytes)return h.push(this.readVarint(c));var f=Nu(this);for(h=h||[];this.pos<f;)h.push(this.readVarint(c));return h},readPackedSVarint:function(h){if(this.type!==On.Bytes)return h.push(this.readSVarint());var c=Nu(this);for(h=h||[];this.pos<c;)h.push(this.readSVarint());return h},readPackedBoolean:function(h){if(this.type!==On.Bytes)return h.push(this.readBoolean());var c=Nu(this);for(h=h||[];this.pos<c;)h.push(this.readBoolean());return h},readPackedFloat:function(h){if(this.type!==On.Bytes)return h.push(this.readFloat());var c=Nu(this);for(h=h||[];this.pos<c;)h.push(this.readFloat());return h},readPackedDouble:function(h){if(this.type!==On.Bytes)return h.push(this.readDouble());var c=Nu(this);for(h=h||[];this.pos<c;)h.push(this.readDouble());return h},readPackedFixed32:function(h){if(this.type!==On.Bytes)return h.push(this.readFixed32());var c=Nu(this);for(h=h||[];this.pos<c;)h.push(this.readFixed32());return h},readPackedSFixed32:function(h){if(this.type!==On.Bytes)return h.push(this.readSFixed32());var c=Nu(this);for(h=h||[];this.pos<c;)h.push(this.readSFixed32());return h},readPackedFixed64:function(h){if(this.type!==On.Bytes)return h.push(this.readFixed64());var c=Nu(this);for(h=h||[];this.pos<c;)h.push(this.readFixed64());return h},readPackedSFixed64:function(h){if(this.type!==On.Bytes)return h.push(this.readSFixed64());var c=Nu(this);for(h=h||[];this.pos<c;)h.push(this.readSFixed64());return h},skip:function(h){var c=7&h;if(c===On.Varint)for(;this.buf[this.pos++]>127;);else if(c===On.Bytes)this.pos=this.readVarint()+this.pos;else if(c===On.Fixed32)this.pos+=4;else{if(c!==On.Fixed64)throw new Error("Unimplemented type: "+c);this.pos+=8}},writeTag:function(h,c){this.writeVarint(h<<3|c)},realloc:function(h){for(var c=this.length||16;c<this.pos+h;)c*=2;if(c!==this.length){var f=new Uint8Array(c);f.set(this.buf),this.buf=f,this.length=c}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(h){this.realloc(4),cg(this.buf,h,this.pos),this.pos+=4},writeSFixed32:function(h){this.realloc(4),cg(this.buf,h,this.pos),this.pos+=4},writeFixed64:function(h){this.realloc(8),cg(this.buf,-1&h,this.pos),cg(this.buf,Math.floor(h*uR),this.pos+4),this.pos+=8},writeSFixed64:function(h){this.realloc(8),cg(this.buf,-1&h,this.pos),cg(this.buf,Math.floor(h*uR),this.pos+4),this.pos+=8},writeVarint:function(h){(h=+h||0)>268435455||h<0?function(c,f){var g,_;if(c>=0?(g=c%4294967296|0,_=c/4294967296|0):(_=~(-c/4294967296),4294967295^(g=~(-c%4294967296))?g=g+1|0:(g=0,_=_+1|0)),c>=18446744073709552e3||c<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");f.realloc(10),function(C,T,j){j.buf[j.pos++]=127&C|128,C>>>=7,j.buf[j.pos++]=127&C|128,C>>>=7,j.buf[j.pos++]=127&C|128,C>>>=7,j.buf[j.pos++]=127&C|128,j.buf[j.pos]=127&(C>>>=7)}(g,0,f),function(C,T){var j=(7&C)<<4;T.buf[T.pos++]|=j|((C>>>=3)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C|((C>>>=7)?128:0),C&&(T.buf[T.pos++]=127&C)))))}(_,f)}(h,this):(this.realloc(4),this.buf[this.pos++]=127&h|(h>127?128:0),h<=127||(this.buf[this.pos++]=127&(h>>>=7)|(h>127?128:0),h<=127||(this.buf[this.pos++]=127&(h>>>=7)|(h>127?128:0),h<=127||(this.buf[this.pos++]=h>>>7&127))))},writeSVarint:function(h){this.writeVarint(h<0?2*-h-1:2*h)},writeBoolean:function(h){this.writeVarint(!!h)},writeString:function(h){h=String(h),this.realloc(4*h.length),this.pos++;var c=this.pos;this.pos=function(g,_,C){for(var T,j,z=0;z<_.length;z++){if((T=_.charCodeAt(z))>55295&&T<57344){if(!j){T>56319||z+1===_.length?(g[C++]=239,g[C++]=191,g[C++]=189):j=T;continue}if(T<56320){g[C++]=239,g[C++]=191,g[C++]=189,j=T;continue}T=j-55296<<10|T-56320|65536,j=null}else j&&(g[C++]=239,g[C++]=191,g[C++]=189,j=null);T<128?g[C++]=T:(T<2048?g[C++]=T>>6|192:(T<65536?g[C++]=T>>12|224:(g[C++]=T>>18|240,g[C++]=T>>12&63|128),g[C++]=T>>6&63|128),g[C++]=63&T|128)}return C}(this.buf,h,this.pos);var f=this.pos-c;f>=128&&dR(c,f,this),this.pos=c-1,this.writeVarint(f),this.pos+=f},writeFloat:function(h){this.realloc(4),cR(this.buf,h,this.pos,!0,23,4),this.pos+=4},writeDouble:function(h){this.realloc(8),cR(this.buf,h,this.pos,!0,52,8),this.pos+=8},writeBytes:function(h){var c=h.length;this.writeVarint(c),this.realloc(c);for(var f=0;f<c;f++)this.buf[this.pos++]=h[f]},writeRawMessage:function(h,c){this.pos++;var f=this.pos;h(c,this);var g=this.pos-f;g>=128&&dR(f,g,this),this.pos=f-1,this.writeVarint(g),this.pos+=g},writeMessage:function(h,c,f){this.writeTag(h,On.Bytes),this.writeRawMessage(c,f)},writePackedVarint:function(h,c){c.length&&this.writeMessage(h,$G,c)},writePackedSVarint:function(h,c){c.length&&this.writeMessage(h,NG,c)},writePackedBoolean:function(h,c){c.length&&this.writeMessage(h,UG,c)},writePackedFloat:function(h,c){c.length&&this.writeMessage(h,VG,c)},writePackedDouble:function(h,c){c.length&&this.writeMessage(h,WG,c)},writePackedFixed32:function(h,c){c.length&&this.writeMessage(h,qG,c)},writePackedSFixed32:function(h,c){c.length&&this.writeMessage(h,QG,c)},writePackedFixed64:function(h,c){c.length&&this.writeMessage(h,HG,c)},writePackedSFixed64:function(h,c){c.length&&this.writeMessage(h,GG,c)},writeBytesField:function(h,c){this.writeTag(h,On.Bytes),this.writeBytes(c)},writeFixed32Field:function(h,c){this.writeTag(h,On.Fixed32),this.writeFixed32(c)},writeSFixed32Field:function(h,c){this.writeTag(h,On.Fixed32),this.writeSFixed32(c)},writeFixed64Field:function(h,c){this.writeTag(h,On.Fixed64),this.writeFixed64(c)},writeSFixed64Field:function(h,c){this.writeTag(h,On.Fixed64),this.writeSFixed64(c)},writeVarintField:function(h,c){this.writeTag(h,On.Varint),this.writeVarint(c)},writeSVarintField:function(h,c){this.writeTag(h,On.Varint),this.writeSVarint(c)},writeStringField:function(h,c){this.writeTag(h,On.Bytes),this.writeString(c)},writeFloatField:function(h,c){this.writeTag(h,On.Fixed32),this.writeFloat(c)},writeDoubleField:function(h,c){this.writeTag(h,On.Fixed64),this.writeDouble(c)},writeBooleanField:function(h,c){this.writeVarintField(h,!!c)}};var hT=d(aR);const dT=3;function XG(h,c,f){h===1&&f.readMessage(KG,c)}function KG(h,c,f){if(h===3){const{id:g,bitmap:_,width:C,height:T,left:j,top:z,advance:B}=f.readMessage(ZG,{});c.push({id:g,bitmap:new mx({width:C+2*dT,height:T+2*dT},_),metrics:{width:C,height:T,left:j,top:z,advance:B}})}}function ZG(h,c,f){h===1?c.id=f.readVarint():h===2?c.bitmap=f.readBytes():h===3?c.width=f.readVarint():h===4?c.height=f.readVarint():h===5?c.left=f.readSVarint():h===6?c.top=f.readSVarint():h===7&&(c.advance=f.readVarint())}const pR=dT;function mR(h){let c=0,f=0;for(const T of h)c+=T.w*T.h,f=Math.max(f,T.w);h.sort((T,j)=>j.h-T.h);const g=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),f),h:1/0}];let _=0,C=0;for(const T of h)for(let j=g.length-1;j>=0;j--){const z=g[j];if(!(T.w>z.w||T.h>z.h)){if(T.x=z.x,T.y=z.y,C=Math.max(C,T.y+T.h),_=Math.max(_,T.x+T.w),T.w===z.w&&T.h===z.h){const B=g.pop();j<g.length&&(g[j]=B)}else T.h===z.h?(z.x+=T.w,z.w-=T.w):T.w===z.w?(z.y+=T.h,z.h-=T.h):(g.push({x:z.x+T.w,y:z.y,w:z.w-T.w,h:T.h}),z.y+=T.h,z.h-=T.h);break}}return{w:_,h:C,fill:c/(_*C)||0}}const Io=1;class fT{constructor(c,{pixelRatio:f,version:g,stretchX:_,stretchY:C,content:T,textFitWidth:j,textFitHeight:z}){this.paddedRect=c,this.pixelRatio=f,this.stretchX=_,this.stretchY=C,this.content=T,this.version=g,this.textFitWidth=j,this.textFitHeight=z}get tl(){return[this.paddedRect.x+Io,this.paddedRect.y+Io]}get br(){return[this.paddedRect.x+this.paddedRect.w-Io,this.paddedRect.y+this.paddedRect.h-Io]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Io)/this.pixelRatio,(this.paddedRect.h-2*Io)/this.pixelRatio]}}class gR{constructor(c,f){const g={},_={};this.haveRenderCallbacks=[];const C=[];this.addImages(c,g,C),this.addImages(f,_,C);const{w:T,h:j}=mR(C),z=new Ba({width:T||1,height:j||1});for(const B in c){const N=c[B],q=g[B].paddedRect;Ba.copy(N.data,z,{x:0,y:0},{x:q.x+Io,y:q.y+Io},N.data)}for(const B in f){const N=f[B],q=_[B].paddedRect,Z=q.x+Io,re=q.y+Io,se=N.data.width,ae=N.data.height;Ba.copy(N.data,z,{x:0,y:0},{x:Z,y:re},N.data),Ba.copy(N.data,z,{x:0,y:ae-1},{x:Z,y:re-1},{width:se,height:1}),Ba.copy(N.data,z,{x:0,y:0},{x:Z,y:re+ae},{width:se,height:1}),Ba.copy(N.data,z,{x:se-1,y:0},{x:Z-1,y:re},{width:1,height:ae}),Ba.copy(N.data,z,{x:0,y:0},{x:Z+se,y:re},{width:1,height:ae})}this.image=z,this.iconPositions=g,this.patternPositions=_}addImages(c,f,g){for(const _ in c){const C=c[_],T={x:0,y:0,w:C.data.width+2*Io,h:C.data.height+2*Io};g.push(T),f[_]=new fT(T,C),C.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(c,f){c.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const g in c.updatedImages)this.patchUpdatedImage(this.iconPositions[g],c.getImage(g),f),this.patchUpdatedImage(this.patternPositions[g],c.getImage(g),f)}patchUpdatedImage(c,f,g){if(!c||!f||c.version===f.version)return;c.version=f.version;const[_,C]=c.tl;g.update(f.data,void 0,{x:_,y:C})}}var nd;Kt("ImagePosition",fT),Kt("ImageAtlas",gR),a.ah=void 0,(nd=a.ah||(a.ah={}))[nd.none=0]="none",nd[nd.horizontal=1]="horizontal",nd[nd.vertical=2]="vertical",nd[nd.horizontalOnly=3]="horizontalOnly";const wx=-17;class Sx{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(c,f){const g=new Sx;return g.scale=c||1,g.fontStack=f,g}static forImage(c){const f=new Sx;return f.imageName=c,f}}class ug{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(c,f){const g=new ug;for(let _=0;_<c.sections.length;_++){const C=c.sections[_];C.image?g.addImageSection(C):g.addTextSection(C,f)}return g}length(){return this.text.length}getSection(c){return this.sections[this.sectionIndex[c]]}getSectionIndex(c){return this.sectionIndex[c]}getCharCode(c){return this.text.charCodeAt(c)}verticalizePunctuation(){this.text=function(c){let f="";for(let g=0;g<c.length;g++){const _=c.charCodeAt(g+1)||null,C=c.charCodeAt(g-1)||null;f+=_&&m_(_)&&!_x[c[g+1]]||C&&m_(C)&&!_x[c[g-1]]||!_x[c[g]]?c[g]:_x[c[g]]}return f}(this.text)}trim(){let c=0;for(let g=0;g<this.text.length&&E_[this.text.charCodeAt(g)];g++)c++;let f=this.text.length;for(let g=this.text.length-1;g>=0&&g>=c&&E_[this.text.charCodeAt(g)];g--)f--;this.text=this.text.substring(c,f),this.sectionIndex=this.sectionIndex.slice(c,f)}substring(c,f){const g=new ug;return g.text=this.text.substring(c,f),g.sectionIndex=this.sectionIndex.slice(c,f),g.sections=this.sections,g}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((c,f)=>Math.max(c,this.sections[f].scale),0)}addTextSection(c,f){this.text+=c.text,this.sections.push(Sx.forText(c.scale,c.fontStack||f));const g=this.sections.length-1;for(let _=0;_<c.text.length;++_)this.sectionIndex.push(g)}addImageSection(c){const f=c.image?c.image.name:"";if(f.length===0)return void Ae("Can't add FormattedSection with an empty image.");const g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(Sx.forImage(f)),this.sectionIndex.push(this.sections.length-1)):Ae("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function A_(h,c,f,g,_,C,T,j,z,B,N,q,Z,re,se){const ae=ug.fromFeature(h,_);let me;q===a.ah.vertical&&ae.verticalizePunctuation();const{processBidirectionalText:we,processStyledBidirectionalText:Ze}=zo;if(we&&ae.sections.length===1){me=[];const ot=we(ae.toString(),pT(ae,B,C,c,g,re));for(const yt of ot){const Wt=new ug;Wt.text=yt,Wt.sections=ae.sections;for(let xr=0;xr<yt.length;xr++)Wt.sectionIndex.push(0);me.push(Wt)}}else if(Ze){me=[];const ot=Ze(ae.text,ae.sectionIndex,pT(ae,B,C,c,g,re));for(const yt of ot){const Wt=new ug;Wt.text=yt[0],Wt.sectionIndex=yt[1],Wt.sections=ae.sections,me.push(Wt)}}else me=function(ot,yt){const Wt=[],xr=ot.text;let $t=0;for(const Rt of yt)Wt.push(ot.substring($t,Rt)),$t=Rt;return $t<xr.length&&Wt.push(ot.substring($t,xr.length)),Wt}(ae,pT(ae,B,C,c,g,re));const Ee=[],Qe={positionedLines:Ee,text:ae.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:q,iconsInText:!1,verticalizable:!1};return function(ot,yt,Wt,xr,$t,Rt,dr,er,Ht,ht,fr,cr){let Or=0,Dn=wx,jn=0,Xi=0;const ml=er==="right"?1:er==="left"?0:.5;let Is=0;for(const yi of $t){yi.trim();const Zi=yi.getMaxScale(),Hs=(Zi-1)*Fi,Rs={positionedGlyphs:[],lineOffset:0};ot.positionedLines[Is]=Rs;const yo=Rs.positionedGlyphs;let Ds=0;if(!yi.length()){Dn+=Rt,++Is;continue}for(let Ro=0;Ro<yi.length();Ro++){const un=yi.getSection(Ro),Nn=yi.getSectionIndex(Ro),Xn=yi.getCharCode(Ro);let la=0,ai=null,pg=null,Lc=null,Fc=Fi;const gl=!(Ht===a.ah.horizontal||!fr&&!lx(Xn)||fr&&(E_[Xn]||(Ki=Xn,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Ki)))));if(un.imageName){const Va=xr[un.imageName];if(!Va)continue;Lc=un.imageName,ot.iconsInText=ot.iconsInText||!0,pg=Va.paddedRect;const ds=Va.displaySize;un.scale=un.scale*Fi/cr,ai={width:ds[0],height:ds[1],left:Io,top:-pR,advance:gl?ds[1]:ds[0]},la=Hs+(Fi-ds[1]*un.scale),Fc=ai.advance;const Vu=gl?ds[0]*un.scale-Fi*Zi:ds[1]*un.scale-Fi*Zi;Vu>0&&Vu>Ds&&(Ds=Vu)}else{const Va=Wt[un.fontStack],ds=Va&&Va[Xn];if(ds&&ds.rect)pg=ds.rect,ai=ds.metrics;else{const Vu=yt[un.fontStack],Px=Vu&&Vu[Xn];if(!Px)continue;ai=Px.metrics}la=(Zi-un.scale)*Fi}gl?(ot.verticalizable=!0,yo.push({glyph:Xn,imageName:Lc,x:Or,y:Dn+la,vertical:gl,scale:un.scale,fontStack:un.fontStack,sectionIndex:Nn,metrics:ai,rect:pg}),Or+=Fc*un.scale+ht):(yo.push({glyph:Xn,imageName:Lc,x:Or,y:Dn+la,vertical:gl,scale:un.scale,fontStack:un.fontStack,sectionIndex:Nn,metrics:ai,rect:pg}),Or+=ai.advance*un.scale+ht)}yo.length!==0&&(jn=Math.max(Or-ht,jn),tX(yo,0,yo.length-1,ml,Ds)),Or=0;const Na=Rt*Zi+Ds;Rs.lineOffset=Math.max(Ds,Hs),Dn+=Na,Xi=Math.max(Na,Xi),++Is}var Ki;const po=Dn-wx,{horizontalAlign:mo,verticalAlign:go}=mT(dr);(function(yi,Zi,Hs,Rs,yo,Ds,Na,Ro,un){const Nn=(Zi-Hs)*yo;let Xn=0;Xn=Ds!==Na?-Ro*Rs-wx:(-Rs*un+.5)*Na;for(const la of yi)for(const ai of la.positionedGlyphs)ai.x+=Nn,ai.y+=Xn})(ot.positionedLines,ml,mo,go,jn,Xi,Rt,po,$t.length),ot.top+=-go*po,ot.bottom=ot.top+po,ot.left+=-mo*jn,ot.right=ot.left+jn}(Qe,c,f,g,me,T,j,z,q,B,Z,se),!function(ot){for(const yt of ot)if(yt.positionedGlyphs.length!==0)return!1;return!0}(Ee)&&Qe}const E_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},YG={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},JG={40:!0};function yR(h,c,f,g,_,C){if(c.imageName){const T=g[c.imageName];return T?T.displaySize[0]*c.scale*Fi/C+_:0}{const T=f[c.fontStack],j=T&&T[h];return j?j.metrics.advance*c.scale+_:0}}function xR(h,c,f,g){const _=Math.pow(h-c,2);return g?h<c?_/2:2*_:_+Math.abs(f)*f}function eX(h,c,f){let g=0;return h===10&&(g-=1e4),f&&(g+=150),h!==40&&h!==65288||(g+=50),c!==41&&c!==65289||(g+=50),g}function vR(h,c,f,g,_,C){let T=null,j=xR(c,f,_,C);for(const z of g){const B=xR(c-z.x,f,_,C)+z.badness;B<=j&&(T=z,j=B)}return{index:h,x:c,priorBreak:T,badness:j}}function bR(h){return h?bR(h.priorBreak).concat(h.index):[]}function pT(h,c,f,g,_,C){if(!h)return[];const T=[],j=function(q,Z,re,se,ae,me){let we=0;for(let Ze=0;Ze<q.length();Ze++){const Ee=q.getSection(Ze);we+=yR(q.getCharCode(Ze),Ee,se,ae,Z,me)}return we/Math.max(1,Math.ceil(we/re))}(h,c,f,g,_,C),z=h.text.indexOf("")>=0;let B=0;for(let q=0;q<h.length();q++){const Z=h.getSection(q),re=h.getCharCode(q);if(E_[re]||(B+=yR(re,Z,g,_,c,C)),q<h.length()-1){const se=!((N=re)<11904)&&(!!Zr["CJK Compatibility Forms"](N)||!!Zr["CJK Compatibility"](N)||!!Zr["CJK Strokes"](N)||!!Zr["CJK Symbols and Punctuation"](N)||!!Zr["Enclosed CJK Letters and Months"](N)||!!Zr["Halfwidth and Fullwidth Forms"](N)||!!Zr["Ideographic Description Characters"](N)||!!Zr["Vertical Forms"](N)||p_.test(String.fromCodePoint(N)));(YG[re]||se||Z.imageName||q!==h.length()-2&&JG[h.getCharCode(q+1)])&&T.push(vR(q+1,B,j,T,eX(re,h.getCharCode(q+1),se&&z),!1))}}var N;return bR(vR(h.length(),B,j,T,0,!0))}function mT(h){let c=.5,f=.5;switch(h){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":f=1;break;case"top":case"top-right":case"top-left":f=0}return{horizontalAlign:c,verticalAlign:f}}function tX(h,c,f,g,_){if(!g&&!_)return;const C=h[f],T=(h[f].x+C.metrics.advance*C.scale)*g;for(let j=c;j<=f;j++)h[j].x-=T,h[j].y+=_}function rX(h,c,f){const{horizontalAlign:g,verticalAlign:_}=mT(f),C=c[0]-h.displaySize[0]*g,T=c[1]-h.displaySize[1]*_;return{image:h,top:T,bottom:T+h.displaySize[1],left:C,right:C+h.displaySize[0]}}function _R(h){var c,f;let g=h.left,_=h.top,C=h.right-g,T=h.bottom-_;const j=(c=h.image.textFitWidth)!==null&&c!==void 0?c:"stretchOrShrink",z=(f=h.image.textFitHeight)!==null&&f!==void 0?f:"stretchOrShrink",B=(h.image.content[2]-h.image.content[0])/(h.image.content[3]-h.image.content[1]);if(z==="proportional"){if(j==="stretchOnly"&&C/T<B||j==="proportional"){const N=Math.ceil(T*B);g*=N/C,C=N}}else if(j==="proportional"&&z==="stretchOnly"&&B!==0&&C/T>B){const N=Math.ceil(C/B);_*=N/T,T=N}return{x1:g,y1:_,x2:g+C,y2:_+T}}function wR(h,c,f,g,_,C){const T=h.image;let j;if(T.content){const me=T.content,we=T.pixelRatio||1;j=[me[0]/we,me[1]/we,T.displaySize[0]-me[2]/we,T.displaySize[1]-me[3]/we]}const z=c.left*C,B=c.right*C;let N,q,Z,re;f==="width"||f==="both"?(re=_[0]+z-g[3],q=_[0]+B+g[1]):(re=_[0]+(z+B-T.displaySize[0])/2,q=re+T.displaySize[0]);const se=c.top*C,ae=c.bottom*C;return f==="height"||f==="both"?(N=_[1]+se-g[0],Z=_[1]+ae+g[2]):(N=_[1]+(se+ae-T.displaySize[1])/2,Z=N+T.displaySize[1]),{image:T,top:N,right:q,bottom:Z,left:re,collisionPadding:j}}const kx=255,Dc=128,id=kx*Dc;function SR(h,c){const{expression:f}=c;if(f.kind==="constant")return{kind:"constant",layoutSize:f.evaluate(new qn(h+1))};if(f.kind==="source")return{kind:"source"};{const{zoomStops:g,interpolationType:_}=f;let C=0;for(;C<g.length&&g[C]<=h;)C++;C=Math.max(0,C-1);let T=C;for(;T<g.length&&g[T]<h+1;)T++;T=Math.min(g.length-1,T);const j=g[C],z=g[T];return f.kind==="composite"?{kind:"composite",minZoom:j,maxZoom:z,interpolationType:_}:{kind:"camera",minZoom:j,maxZoom:z,minSize:f.evaluate(new qn(j)),maxSize:f.evaluate(new qn(z)),interpolationType:_}}}function gT(h,c,f){let g="never";const _=h.get(c);return _?g=_:h.get(f)&&(g="always"),g}const nX=rd.VectorTileFeature.types,iX=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function z_(h,c,f,g,_,C,T,j,z,B,N,q,Z){const re=j?Math.min(id,Math.round(j[0])):0,se=j?Math.min(id,Math.round(j[1])):0;h.emplaceBack(c,f,Math.round(32*g),Math.round(32*_),C,T,(re<<1)+(z?1:0),se,16*B,16*N,256*q,256*Z)}function yT(h,c,f){h.emplaceBack(c.x,c.y,f),h.emplaceBack(c.x,c.y,f),h.emplaceBack(c.x,c.y,f),h.emplaceBack(c.x,c.y,f)}function sX(h){for(const c of h.sections)if(qC(c.text))return!0;return!1}class xT{constructor(c){this.layoutVertexArray=new Jm,this.indexArray=new Fa,this.programConfigurations=c,this.segments=new Yr,this.dynamicLayoutVertexArray=new hx,this.opacityVertexArray=new oa,this.hasVisibleVertices=!1,this.placedSymbolArray=new Qn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(c,f,g,_){this.isEmpty()||(g&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,RG.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,f),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,DG.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,iX,!0),this.opacityVertexBuffer.itemSize=1),(g||_)&&this.programConfigurations.upload(c))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Kt("SymbolBuffers",xT);class vT{constructor(c,f,g){this.layoutVertexArray=new c,this.layoutAttributes=f,this.indexArray=new g,this.segments=new Yr,this.collisionVertexArray=new Ic}upload(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,LG.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Kt("CollisionBuffers",vT);class hg{constructor(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(T=>T.id),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=YC([]),this.placementViewportMatrix=YC([]);const f=this.layers[0]._unevaluatedLayout._values;this.textSizeData=SR(this.zoom,f["text-size"]),this.iconSizeData=SR(this.zoom,f["icon-size"]);const g=this.layers[0].layout,_=g.get("symbol-sort-key"),C=g.get("symbol-z-order");this.canOverlap=gT(g,"text-overlap","text-allow-overlap")!=="never"||gT(g,"icon-overlap","icon-allow-overlap")!=="never"||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey=C!=="viewport-y"&&!_.isConstant(),this.sortFeaturesByY=(C==="viewport-y"||C==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,g.get("symbol-placement")==="point"&&(this.writingModes=g.get("text-writing-mode").map(T=>a.ah[T])),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=c.sourceID}createArrays(){this.text=new xT(new Kf(this.layers,this.zoom,c=>/^text/.test(c))),this.icon=new xT(new Kf(this.layers,this.zoom,c=>/^icon/.test(c))),this.glyphOffsetArray=new Hn,this.lineVertexArray=new As,this.symbolInstances=new Gr,this.textAnchorOffsets=new Gn}calculateGlyphDependencies(c,f,g,_,C){for(let T=0;T<c.length;T++)if(f[c.charCodeAt(T)]=!0,(g||_)&&C){const j=_x[c.charAt(T)];j&&(f[j.charCodeAt(0)]=!0)}}populate(c,f,g){const _=this.layers[0],C=_.layout,T=C.get("text-font"),j=C.get("text-field"),z=C.get("icon-image"),B=(j.value.kind!=="constant"||j.value.value instanceof Cs&&!j.value.value.isEmpty()||j.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),N=z.value.kind!=="constant"||!!z.value.value||Object.keys(z.parameters).length>0,q=C.get("symbol-sort-key");if(this.features=[],!B&&!N)return;const Z=f.iconDependencies,re=f.glyphDependencies,se=f.availableImages,ae=new qn(this.zoom);for(const{feature:me,id:we,index:Ze,sourceLayerIndex:Ee}of c){const Qe=_._featureFilter.needGeometry,ot=Yf(me,Qe);if(!_._featureFilter.filter(ae,ot,g))continue;let yt,Wt;if(Qe||(ot.geometry=Zf(me)),B){const $t=_.getValueAndResolveTokens("text-field",ot,g,se),Rt=Cs.factory($t),dr=this.hasRTLText=this.hasRTLText||sX(Rt);(!dr||zo.getRTLTextPluginStatus()==="unavailable"||dr&&zo.isParsed())&&(yt=BG(Rt,_,ot))}if(N){const $t=_.getValueAndResolveTokens("icon-image",ot,g,se);Wt=$t instanceof Ts?$t:Ts.fromString($t)}if(!yt&&!Wt)continue;const xr=this.sortFeaturesByKey?q.evaluate(ot,{},g):void 0;if(this.features.push({id:we,text:yt,icon:Wt,index:Ze,sourceLayerIndex:Ee,geometry:ot.geometry,properties:me.properties,type:nX[me.type],sortKey:xr}),Wt&&(Z[Wt.name]=!0),yt){const $t=T.evaluate(ot,{},g).join(","),Rt=C.get("text-rotation-alignment")!=="viewport"&&C.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.ah.vertical)>=0;for(const dr of yt.sections)if(dr.image)Z[dr.image.name]=!0;else{const er=ox(yt.toString()),Ht=dr.fontStack||$t,ht=re[Ht]=re[Ht]||{};this.calculateGlyphDependencies(dr.text,ht,Rt,this.allowVerticalPlacement,er)}}}C.get("symbol-placement")==="line"&&(this.features=function(me){const we={},Ze={},Ee=[];let Qe=0;function ot($t){Ee.push(me[$t]),Qe++}function yt($t,Rt,dr){const er=Ze[$t];return delete Ze[$t],Ze[Rt]=er,Ee[er].geometry[0].pop(),Ee[er].geometry[0]=Ee[er].geometry[0].concat(dr[0]),er}function Wt($t,Rt,dr){const er=we[Rt];return delete we[Rt],we[$t]=er,Ee[er].geometry[0].shift(),Ee[er].geometry[0]=dr[0].concat(Ee[er].geometry[0]),er}function xr($t,Rt,dr){const er=dr?Rt[0][Rt[0].length-1]:Rt[0][0];return`${$t}:${er.x}:${er.y}`}for(let $t=0;$t<me.length;$t++){const Rt=me[$t],dr=Rt.geometry,er=Rt.text?Rt.text.toString():null;if(!er){ot($t);continue}const Ht=xr(er,dr),ht=xr(er,dr,!0);if(Ht in Ze&&ht in we&&Ze[Ht]!==we[ht]){const fr=Wt(Ht,ht,dr),cr=yt(Ht,ht,Ee[fr].geometry);delete we[Ht],delete Ze[ht],Ze[xr(er,Ee[cr].geometry,!0)]=cr,Ee[fr].geometry=null}else Ht in Ze?yt(Ht,ht,dr):ht in we?Wt(Ht,ht,dr):(ot($t),we[Ht]=Qe-1,Ze[ht]=Qe-1)}return Ee.filter($t=>$t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((me,we)=>me.sortKey-we.sortKey)}update(c,f,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(c,f,this.layers,g),this.icon.programConfigurations.updatePaintArrays(c,f,this.layers,g))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(c,f){const g=this.lineVertexArray.length;if(c.segment!==void 0){let _=c.dist(f[c.segment+1]),C=c.dist(f[c.segment]);const T={};for(let j=c.segment+1;j<f.length;j++)T[j]={x:f[j].x,y:f[j].y,tileUnitDistanceFromAnchor:_},j<f.length-1&&(_+=f[j+1].dist(f[j]));for(let j=c.segment||0;j>=0;j--)T[j]={x:f[j].x,y:f[j].y,tileUnitDistanceFromAnchor:C},j>0&&(C+=f[j-1].dist(f[j]));for(let j=0;j<f.length;j++){const z=T[j];this.lineVertexArray.emplaceBack(z.x,z.y,z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}}addSymbols(c,f,g,_,C,T,j,z,B,N,q,Z){const re=c.indexArray,se=c.layoutVertexArray,ae=c.segments.prepareSegment(4*f.length,se,re,this.canOverlap?T.sortKey:void 0),me=this.glyphOffsetArray.length,we=ae.vertexLength,Ze=this.allowVerticalPlacement&&j===a.ah.vertical?Math.PI/2:0,Ee=T.text&&T.text.sections;for(let Qe=0;Qe<f.length;Qe++){const{tl:ot,tr:yt,bl:Wt,br:xr,tex:$t,pixelOffsetTL:Rt,pixelOffsetBR:dr,minFontScaleX:er,minFontScaleY:Ht,glyphOffset:ht,isSDF:fr,sectionIndex:cr}=f[Qe],Or=ae.vertexLength,Dn=ht[1];z_(se,z.x,z.y,ot.x,Dn+ot.y,$t.x,$t.y,g,fr,Rt.x,Rt.y,er,Ht),z_(se,z.x,z.y,yt.x,Dn+yt.y,$t.x+$t.w,$t.y,g,fr,dr.x,Rt.y,er,Ht),z_(se,z.x,z.y,Wt.x,Dn+Wt.y,$t.x,$t.y+$t.h,g,fr,Rt.x,dr.y,er,Ht),z_(se,z.x,z.y,xr.x,Dn+xr.y,$t.x+$t.w,$t.y+$t.h,g,fr,dr.x,dr.y,er,Ht),yT(c.dynamicLayoutVertexArray,z,Ze),re.emplaceBack(Or,Or+1,Or+2),re.emplaceBack(Or+1,Or+2,Or+3),ae.vertexLength+=4,ae.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ht[0]),Qe!==f.length-1&&cr===f[Qe+1].sectionIndex||c.programConfigurations.populatePaintArrays(se.length,T,T.index,{},Z,Ee&&Ee[cr])}c.placedSymbolArray.emplaceBack(z.x,z.y,me,this.glyphOffsetArray.length-me,we,B,N,z.segment,g?g[0]:0,g?g[1]:0,_[0],_[1],j,0,!1,0,q)}_addCollisionDebugVertex(c,f,g,_,C,T){return f.emplaceBack(0,0),c.emplaceBack(g.x,g.y,_,C,Math.round(T.x),Math.round(T.y))}addCollisionDebugVertices(c,f,g,_,C,T,j){const z=C.segments.prepareSegment(4,C.layoutVertexArray,C.indexArray),B=z.vertexLength,N=C.layoutVertexArray,q=C.collisionVertexArray,Z=j.anchorX,re=j.anchorY;this._addCollisionDebugVertex(N,q,T,Z,re,new v(c,f)),this._addCollisionDebugVertex(N,q,T,Z,re,new v(g,f)),this._addCollisionDebugVertex(N,q,T,Z,re,new v(g,_)),this._addCollisionDebugVertex(N,q,T,Z,re,new v(c,_)),z.vertexLength+=4;const se=C.indexArray;se.emplaceBack(B,B+1),se.emplaceBack(B+1,B+2),se.emplaceBack(B+2,B+3),se.emplaceBack(B+3,B),z.primitiveLength+=4}addDebugCollisionBoxes(c,f,g,_){for(let C=c;C<f;C++){const T=this.collisionBoxArray.get(C);this.addCollisionDebugVertices(T.x1,T.y1,T.x2,T.y2,_?this.textCollisionBox:this.iconCollisionBox,T.anchorPoint,g)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new vT(aa,oR.members,hs),this.iconCollisionBox=new vT(aa,oR.members,hs);for(let c=0;c<this.symbolInstances.length;c++){const f=this.symbolInstances.get(c);this.addDebugCollisionBoxes(f.textBoxStartIndex,f.textBoxEndIndex,f,!0),this.addDebugCollisionBoxes(f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f,!0),this.addDebugCollisionBoxes(f.iconBoxStartIndex,f.iconBoxEndIndex,f,!1),this.addDebugCollisionBoxes(f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f,!1)}}_deserializeCollisionBoxesForSymbol(c,f,g,_,C,T,j,z,B){const N={};for(let q=f;q<g;q++){const Z=c.get(q);N.textBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},N.textFeatureIndex=Z.featureIndex;break}for(let q=_;q<C;q++){const Z=c.get(q);N.verticalTextBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},N.verticalTextFeatureIndex=Z.featureIndex;break}for(let q=T;q<j;q++){const Z=c.get(q);N.iconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},N.iconFeatureIndex=Z.featureIndex;break}for(let q=z;q<B;q++){const Z=c.get(q);N.verticalIconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},N.verticalIconFeatureIndex=Z.featureIndex;break}return N}deserializeCollisionBoxes(c){this.collisionArrays=[];for(let f=0;f<this.symbolInstances.length;f++){const g=this.symbolInstances.get(f);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(c,f){const g=c.placedSymbolArray.get(f),_=g.vertexStartIndex+4*g.numGlyphs;for(let C=g.vertexStartIndex;C<_;C+=4)c.indexArray.emplaceBack(C,C+1,C+2),c.indexArray.emplaceBack(C+1,C+2,C+3)}getSortedSymbolIndexes(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const f=Math.sin(c),g=Math.cos(c),_=[],C=[],T=[];for(let j=0;j<this.symbolInstances.length;++j){T.push(j);const z=this.symbolInstances.get(j);_.push(0|Math.round(f*z.anchorX+g*z.anchorY)),C.push(z.featureIndex)}return T.sort((j,z)=>_[j]-_[z]||C[z]-C[j]),T}addToSortKeyRanges(c,f){const g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===f?g.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:f,symbolInstanceStart:c,symbolInstanceEnd:c+1})}sortFeatures(c){if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const f of this.symbolInstanceIndexes){const g=this.symbolInstances.get(f);this.featureSortOrder.push(g.featureIndex),[g.rightJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.leftJustifiedTextSymbolIndex].forEach((_,C,T)=>{_>=0&&T.indexOf(_)===C&&this.addIndicesForPlacedSymbol(this.text,_)}),g.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,g.verticalPlacedTextSymbolIndex),g.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.placedIconSymbolIndex),g.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let kR,CR;Kt("SymbolBucket",hg,{omit:["layers","collisionBoxArray","features","compareText"]}),hg.MAX_GLYPHS=65535,hg.addDynamicAttributes=yT;var bT={get paint(){return CR=CR||new k({"icon-opacity":new _r(Te.paint_symbol["icon-opacity"]),"icon-color":new _r(Te.paint_symbol["icon-color"]),"icon-halo-color":new _r(Te.paint_symbol["icon-halo-color"]),"icon-halo-width":new _r(Te.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _r(Te.paint_symbol["icon-halo-blur"]),"icon-translate":new or(Te.paint_symbol["icon-translate"]),"icon-translate-anchor":new or(Te.paint_symbol["icon-translate-anchor"]),"text-opacity":new _r(Te.paint_symbol["text-opacity"]),"text-color":new _r(Te.paint_symbol["text-color"],{runtimeType:Zn,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new _r(Te.paint_symbol["text-halo-color"]),"text-halo-width":new _r(Te.paint_symbol["text-halo-width"]),"text-halo-blur":new _r(Te.paint_symbol["text-halo-blur"]),"text-translate":new or(Te.paint_symbol["text-translate"]),"text-translate-anchor":new or(Te.paint_symbol["text-translate-anchor"])})},get layout(){return kR=kR||new k({"symbol-placement":new or(Te.layout_symbol["symbol-placement"]),"symbol-spacing":new or(Te.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new or(Te.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _r(Te.layout_symbol["symbol-sort-key"]),"symbol-z-order":new or(Te.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new or(Te.layout_symbol["icon-allow-overlap"]),"icon-overlap":new or(Te.layout_symbol["icon-overlap"]),"icon-ignore-placement":new or(Te.layout_symbol["icon-ignore-placement"]),"icon-optional":new or(Te.layout_symbol["icon-optional"]),"icon-rotation-alignment":new or(Te.layout_symbol["icon-rotation-alignment"]),"icon-size":new _r(Te.layout_symbol["icon-size"]),"icon-text-fit":new or(Te.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new or(Te.layout_symbol["icon-text-fit-padding"]),"icon-image":new _r(Te.layout_symbol["icon-image"]),"icon-rotate":new _r(Te.layout_symbol["icon-rotate"]),"icon-padding":new _r(Te.layout_symbol["icon-padding"]),"icon-keep-upright":new or(Te.layout_symbol["icon-keep-upright"]),"icon-offset":new _r(Te.layout_symbol["icon-offset"]),"icon-anchor":new _r(Te.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new or(Te.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new or(Te.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new or(Te.layout_symbol["text-rotation-alignment"]),"text-field":new _r(Te.layout_symbol["text-field"]),"text-font":new _r(Te.layout_symbol["text-font"]),"text-size":new _r(Te.layout_symbol["text-size"]),"text-max-width":new _r(Te.layout_symbol["text-max-width"]),"text-line-height":new or(Te.layout_symbol["text-line-height"]),"text-letter-spacing":new _r(Te.layout_symbol["text-letter-spacing"]),"text-justify":new _r(Te.layout_symbol["text-justify"]),"text-radial-offset":new _r(Te.layout_symbol["text-radial-offset"]),"text-variable-anchor":new or(Te.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new _r(Te.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new _r(Te.layout_symbol["text-anchor"]),"text-max-angle":new or(Te.layout_symbol["text-max-angle"]),"text-writing-mode":new or(Te.layout_symbol["text-writing-mode"]),"text-rotate":new _r(Te.layout_symbol["text-rotate"]),"text-padding":new or(Te.layout_symbol["text-padding"]),"text-keep-upright":new or(Te.layout_symbol["text-keep-upright"]),"text-transform":new _r(Te.layout_symbol["text-transform"]),"text-offset":new _r(Te.layout_symbol["text-offset"]),"text-allow-overlap":new or(Te.layout_symbol["text-allow-overlap"]),"text-overlap":new or(Te.layout_symbol["text-overlap"]),"text-ignore-placement":new or(Te.layout_symbol["text-ignore-placement"]),"text-optional":new or(Te.layout_symbol["text-optional"])})}};class TR{constructor(c){if(c.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=c.property.overrides?c.property.overrides.runtimeType:wn,this.defaultValue=c}evaluate(c){if(c.formattedSection){const f=this.defaultValue.property.overrides;if(f&&f.hasOverride(c.formattedSection))return f.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default}eachChild(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Kt("FormatSectionOverride",TR,{omit:["defaultValue"]});class M_ extends p{constructor(c){super(c,bT)}recalculate(c,f){if(super.recalculate(c,f),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const g=this.layout.get("text-writing-mode");if(g){const _=[];for(const C of g)_.indexOf(C)<0&&_.push(C);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(c,f,g,_){const C=this.layout.get(c).evaluate(f,{},g,_),T=this._unevaluatedLayout._values[c];return T.isDataDriven()||Fm(T.value)||!C?C:function(j,z){return z.replace(/{([^{}]+)}/g,(B,N)=>j&&N in j?String(j[N]):"")}(f.properties,C)}createBucket(c){return new hg(c)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const c of bT.paint.overridableProperties){if(!M_.hasPaintOverride(this.layout,c))continue;const f=this.paint.get(c),g=new TR(f),_=new Lm(g,f.property.specification);let C=null;C=f.value.kind==="constant"||f.value.kind==="source"?new Nh("source",_):new Vh("composite",_,f.value.zoomStops),this.paint._values[c]=new fl(f.property,C,f.parameters)}}_handleOverridablePaintPropertyUpdate(c,f,g){return!(!this.layout||f.isDataDriven()||g.isDataDriven())&&M_.hasPaintOverride(this.layout,c)}static hasPaintOverride(c,f){const g=c.get("text-field"),_=bT.paint.properties[f];let C=!1;const T=j=>{for(const z of j)if(_.overrides&&_.overrides.hasOverride(z))return void(C=!0)};if(g.value.kind==="constant"&&g.value.value instanceof Cs)T(g.value.value.sections);else if(g.value.kind==="source"){const j=B=>{C||(B instanceof jo&&pi(B.value)===ks?T(B.value.sections):B instanceof ye?T(B.sections):B.eachChild(j))},z=g.value;z._styleExpression&&j(z._styleExpression.expression)}return C}}let OR;var oX={get paint(){return OR=OR||new k({"background-color":new or(Te.paint_background["background-color"]),"background-pattern":new Zm(Te.paint_background["background-pattern"]),"background-opacity":new or(Te.paint_background["background-opacity"])})}};class aX extends p{constructor(c){super(c,oX)}}let jR;var lX={get paint(){return jR=jR||new k({"raster-opacity":new or(Te.paint_raster["raster-opacity"]),"raster-hue-rotate":new or(Te.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new or(Te.paint_raster["raster-brightness-min"]),"raster-brightness-max":new or(Te.paint_raster["raster-brightness-max"]),"raster-saturation":new or(Te.paint_raster["raster-saturation"]),"raster-contrast":new or(Te.paint_raster["raster-contrast"]),"raster-resampling":new or(Te.paint_raster["raster-resampling"]),"raster-fade-duration":new or(Te.paint_raster["raster-fade-duration"])})}};class cX extends p{constructor(c){super(c,lX)}}class uX extends p{constructor(c){super(c,{}),this.onAdd=f=>{this.implementation.onAdd&&this.implementation.onAdd(f,f.painter.context.gl)},this.onRemove=f=>{this.implementation.onRemove&&this.implementation.onRemove(f,f.painter.context.gl)},this.implementation=c}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class hX{constructor(c){this._methodToThrottle=c,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const _T=63710088e-1;class sd{constructor(c,f){if(isNaN(c)||isNaN(f))throw new Error(`Invalid LngLat object: (${c}, ${f})`);if(this.lng=+c,this.lat=+f,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new sd(ee(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(c){const f=Math.PI/180,g=this.lat*f,_=c.lat*f,C=Math.sin(g)*Math.sin(_)+Math.cos(g)*Math.cos(_)*Math.cos((c.lng-this.lng)*f);return _T*Math.acos(Math.min(C,1))}static convert(c){if(c instanceof sd)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new sd(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new sd(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const PR=2*Math.PI*_T;function AR(h){return PR*Math.cos(h*Math.PI/180)}function ER(h){return(180+h)/360}function zR(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function MR(h,c){return h/AR(c)}function wT(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}class Cx{constructor(c,f,g=0){this.x=+c,this.y=+f,this.z=+g}static fromLngLat(c,f=0){const g=sd.convert(c);return new Cx(ER(g.lng),zR(g.lat),MR(f,g.lat))}toLngLat(){return new sd(360*this.x-180,wT(this.y))}toAltitude(){return this.z*AR(wT(this.y))}meterInMercatorCoordinateUnits(){return 1/PR*(c=wT(this.y),1/Math.cos(c*Math.PI/180));var c}}function IR(h,c,f){var g=2*Math.PI*6378137/256/Math.pow(2,f);return[h*g-2*Math.PI*6378137/2,c*g-2*Math.PI*6378137/2]}class ST{constructor(c,f,g){if(!function(_,C,T){return!(_<0||_>25||T<0||T>=Math.pow(2,_)||C<0||C>=Math.pow(2,_))}(c,f,g))throw new Error(`x=${f}, y=${g}, z=${c} outside of bounds. 0<=x<${Math.pow(2,c)}, 0<=y<${Math.pow(2,c)} 0<=z<=25 `);this.z=c,this.x=f,this.y=g,this.key=Tx(0,c,c,f,g)}equals(c){return this.z===c.z&&this.x===c.x&&this.y===c.y}url(c,f,g){const _=(T=this.y,j=this.z,z=IR(256*(C=this.x),256*(T=Math.pow(2,j)-T-1),j),B=IR(256*(C+1),256*(T+1),j),z[0]+","+z[1]+","+B[0]+","+B[1]);var C,T,j,z,B;const N=function(q,Z,re){let se,ae="";for(let me=q;me>0;me--)se=1<<me-1,ae+=(Z&se?1:0)+(re&se?2:0);return ae}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(g==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,f>1?"@2x":"").replace(/{quadkey}/g,N).replace(/{bbox-epsg-3857}/g,_)}isChildOf(c){const f=this.z-c.z;return f>0&&c.x===this.x>>f&&c.y===this.y>>f}getTilePoint(c){const f=Math.pow(2,this.z);return new v((c.x*f-this.x)*Ei,(c.y*f-this.y)*Ei)}toString(){return`${this.z}/${this.x}/${this.y}`}}class RR{constructor(c,f){this.wrap=c,this.canonical=f,this.key=Tx(c,f.z,f.z,f.x,f.y)}}class $a{constructor(c,f,g,_,C){if(c<g)throw new Error(`overscaledZ should be >= z; overscaledZ = ${c}; z = ${g}`);this.overscaledZ=c,this.wrap=f,this.canonical=new ST(g,+_,+C),this.key=Tx(f,c,g,_,C)}clone(){return new $a(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)}scaledTo(c){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-c;return c>this.canonical.z?new $a(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $a(c,this.wrap,c,this.canonical.x>>f,this.canonical.y>>f)}calculateScaledKey(c,f){if(c>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${c}; overscaledZ = ${this.overscaledZ}`);const g=this.canonical.z-c;return c>this.canonical.z?Tx(this.wrap*+f,c,this.canonical.z,this.canonical.x,this.canonical.y):Tx(this.wrap*+f,c,c,this.canonical.x>>g,this.canonical.y>>g)}isChildOf(c){if(c.wrap!==this.wrap)return!1;const f=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.x===this.canonical.x>>f&&c.canonical.y===this.canonical.y>>f}children(c){if(this.overscaledZ>=c)return[new $a(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const f=this.canonical.z+1,g=2*this.canonical.x,_=2*this.canonical.y;return[new $a(f,this.wrap,f,g,_),new $a(f,this.wrap,f,g+1,_),new $a(f,this.wrap,f,g,_+1),new $a(f,this.wrap,f,g+1,_+1)]}isLessThan(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))}wrapped(){return new $a(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(c){return new $a(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new RR(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(c){return this.canonical.getTilePoint(new Cx(c.x-this.wrap,c.y))}}function Tx(h,c,f,g,_){(h*=2)<0&&(h=-1*h-1);const C=1<<f;return(C*C*h+C*_+g).toString(36)+f.toString(36)+c.toString(36)}Kt("CanonicalTileID",ST),Kt("OverscaledTileID",$a,{omit:["posMatrix"]});class DR{constructor(c,f,g,_=1,C=1,T=1,j=0){if(this.uid=c,f.height!==f.width)throw new RangeError("DEM tiles must be square");if(g&&!["mapbox","terrarium","custom"].includes(g))return void Ae(`"${g}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=f.height;const z=this.dim=f.height-2;switch(this.data=new Uint32Array(f.data.buffer),g){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=_,this.greenFactor=C,this.blueFactor=T,this.baseShift=j;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let B=0;B<z;B++)this.data[this._idx(-1,B)]=this.data[this._idx(0,B)],this.data[this._idx(z,B)]=this.data[this._idx(z-1,B)],this.data[this._idx(B,-1)]=this.data[this._idx(B,0)],this.data[this._idx(B,z)]=this.data[this._idx(B,z-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(z,-1)]=this.data[this._idx(z-1,0)],this.data[this._idx(-1,z)]=this.data[this._idx(0,z-1)],this.data[this._idx(z,z)]=this.data[this._idx(z-1,z-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let B=0;B<z;B++)for(let N=0;N<z;N++){const q=this.get(B,N);q>this.max&&(this.max=q),q<this.min&&(this.min=q)}}get(c,f){const g=new Uint8Array(this.data.buffer),_=4*this._idx(c,f);return this.unpack(g[_],g[_+1],g[_+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(c,f){if(c<-1||c>=this.dim+1||f<-1||f>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(f+1)*this.stride+(c+1)}unpack(c,f,g){return c*this.redFactor+f*this.greenFactor+g*this.blueFactor-this.baseShift}getPixels(){return new Ba({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(c,f,g){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");let _=f*this.dim,C=f*this.dim+this.dim,T=g*this.dim,j=g*this.dim+this.dim;switch(f){case-1:_=C-1;break;case 1:C=_+1}switch(g){case-1:T=j-1;break;case 1:j=T+1}const z=-f*this.dim,B=-g*this.dim;for(let N=T;N<j;N++)for(let q=_;q<C;q++)this.data[this._idx(q,N)]=c.data[this._idx(q+z,N+B)]}}Kt("DEMData",DR);class LR{constructor(c){this._stringToNumber={},this._numberToString=[];for(let f=0;f<c.length;f++){const g=c[f];this._stringToNumber[g]=f,this._numberToString[f]=g}}encode(c){return this._stringToNumber[c]}decode(c){if(c>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${c} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[c]}}class FR{constructor(c,f,g,_,C){this.type="Feature",this._vectorTileFeature=c,c._z=f,c._x=g,c._y=_,this.properties=c.properties,this.id=C}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(c){this._geometry=c}toJSON(){const c={geometry:this.geometry};for(const f in this)f!=="_geometry"&&f!=="_vectorTileFeature"&&(c[f]=this[f]);return c}}class BR{constructor(c,f){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new qh(Ei,16,0),this.grid3D=new qh(Ei,16,0),this.featureIndexArray=new qs,this.promoteId=f}insert(c,f,g,_,C,T){const j=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,_,C);const z=T?this.grid3D:this.grid;for(let B=0;B<f.length;B++){const N=f[B],q=[1/0,1/0,-1/0,-1/0];for(let Z=0;Z<N.length;Z++){const re=N[Z];q[0]=Math.min(q[0],re.x),q[1]=Math.min(q[1],re.y),q[2]=Math.max(q[2],re.x),q[3]=Math.max(q[3],re.y)}q[0]<Ei&&q[1]<Ei&&q[2]>=0&&q[3]>=0&&z.insert(j,q[0],q[1],q[2],q[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new rd.VectorTile(new hT(this.rawTileData)).layers,this.sourceLayerCoder=new LR(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(c,f,g,_){this.loadVTLayers();const C=c.params||{},T=Ei/c.tileSize/c.scale,j=q0(C.filter),z=c.queryGeometry,B=c.queryPadding*T,N=NR(z),q=this.grid.query(N.minX-B,N.minY-B,N.maxX+B,N.maxY+B),Z=NR(c.cameraQueryGeometry),re=this.grid3D.query(Z.minX-B,Z.minY-B,Z.maxX+B,Z.maxY+B,(me,we,Ze,Ee)=>function(Qe,ot,yt,Wt,xr){for(const Rt of Qe)if(ot<=Rt.x&&yt<=Rt.y&&Wt>=Rt.x&&xr>=Rt.y)return!0;const $t=[new v(ot,yt),new v(ot,xr),new v(Wt,xr),new v(Wt,yt)];if(Qe.length>2){for(const Rt of $t)if(ig(Qe,Rt))return!0}for(let Rt=0;Rt<Qe.length-1;Rt++)if(qH(Qe[Rt],Qe[Rt+1],$t))return!0;return!1}(c.cameraQueryGeometry,me-B,we-B,Ze+B,Ee+B));for(const me of re)q.push(me);q.sort(dX);const se={};let ae;for(let me=0;me<q.length;me++){const we=q[me];if(we===ae)continue;ae=we;const Ze=this.featureIndexArray.get(we);let Ee=null;this.loadMatchingFeature(se,Ze.bucketIndex,Ze.sourceLayerIndex,Ze.featureIndex,j,C.layers,C.availableImages,f,g,_,(Qe,ot,yt)=>(Ee||(Ee=Zf(Qe)),ot.queryIntersectsFeature(z,Qe,yt,Ee,this.z,c.transform,T,c.pixelPosMatrix)))}return se}loadMatchingFeature(c,f,g,_,C,T,j,z,B,N,q){const Z=this.bucketLayerIDs[f];if(T&&!function(me,we){for(let Ze=0;Ze<me.length;Ze++)if(we.indexOf(me[Ze])>=0)return!0;return!1}(T,Z))return;const re=this.sourceLayerCoder.decode(g),se=this.vtLayers[re].feature(_);if(C.needGeometry){const me=Yf(se,!0);if(!C.filter(new qn(this.tileID.overscaledZ),me,this.tileID.canonical))return}else if(!C.filter(new qn(this.tileID.overscaledZ),se))return;const ae=this.getId(se,re);for(let me=0;me<Z.length;me++){const we=Z[me];if(T&&T.indexOf(we)<0)continue;const Ze=z[we];if(!Ze)continue;let Ee={};ae&&N&&(Ee=N.getState(Ze.sourceLayer||"_geojsonTileLayer",ae));const Qe=K({},B[we]);Qe.paint=$R(Qe.paint,Ze.paint,se,Ee,j),Qe.layout=$R(Qe.layout,Ze.layout,se,Ee,j);const ot=!q||q(se,Ze,Ee);if(!ot)continue;const yt=new FR(se,this.z,this.x,this.y,ae);yt.layer=Qe;let Wt=c[we];Wt===void 0&&(Wt=c[we]=[]),Wt.push({featureIndex:_,feature:yt,intersectionZ:ot})}}lookupSymbolFeatures(c,f,g,_,C,T,j,z){const B={};this.loadVTLayers();const N=q0(C);for(const q of c)this.loadMatchingFeature(B,g,_,q,N,T,j,z,f);return B}hasLayer(c){for(const f of this.bucketLayerIDs)for(const g of f)if(c===g)return!0;return!1}getId(c,f){let g=c.id;return this.promoteId&&(g=c.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[f]],typeof g=="boolean"&&(g=Number(g))),g}}function $R(h,c,f,g,_){return ne(h,(C,T)=>{const j=c instanceof Hf?c.get(T):null;return j&&j.evaluate?j.evaluate(f,g,_):j})}function NR(h){let c=1/0,f=1/0,g=-1/0,_=-1/0;for(const C of h)c=Math.min(c,C.x),f=Math.min(f,C.y),g=Math.max(g,C.x),_=Math.max(_,C.y);return{minX:c,minY:f,maxX:g,maxY:_}}function dX(h,c){return c-h}function VR(h,c,f,g,_){const C=[];for(let T=0;T<h.length;T++){const j=h[T];let z;for(let B=0;B<j.length-1;B++){let N=j[B],q=j[B+1];N.x<c&&q.x<c||(N.x<c?N=new v(c,N.y+(c-N.x)/(q.x-N.x)*(q.y-N.y))._round():q.x<c&&(q=new v(c,N.y+(c-N.x)/(q.x-N.x)*(q.y-N.y))._round()),N.y<f&&q.y<f||(N.y<f?N=new v(N.x+(f-N.y)/(q.y-N.y)*(q.x-N.x),f)._round():q.y<f&&(q=new v(N.x+(f-N.y)/(q.y-N.y)*(q.x-N.x),f)._round()),N.x>=g&&q.x>=g||(N.x>=g?N=new v(g,N.y+(g-N.x)/(q.x-N.x)*(q.y-N.y))._round():q.x>=g&&(q=new v(g,N.y+(g-N.x)/(q.x-N.x)*(q.y-N.y))._round()),N.y>=_&&q.y>=_||(N.y>=_?N=new v(N.x+(_-N.y)/(q.y-N.y)*(q.x-N.x),_)._round():q.y>=_&&(q=new v(N.x+(_-N.y)/(q.y-N.y)*(q.x-N.x),_)._round()),z&&N.equals(z[z.length-1])||(z=[N],C.push(z)),z.push(q)))))}}return C}Kt("FeatureIndex",BR,{omit:["rawTileData","sourceLayerCoder"]});class od extends v{constructor(c,f,g,_){super(c,f),this.angle=g,_!==void 0&&(this.segment=_)}clone(){return new od(this.x,this.y,this.angle,this.segment)}}function WR(h,c,f,g,_){if(c.segment===void 0||f===0)return!0;let C=c,T=c.segment+1,j=0;for(;j>-f/2;){if(T--,T<0)return!1;j-=h[T].dist(C),C=h[T]}j+=h[T].dist(h[T+1]),T++;const z=[];let B=0;for(;j<f/2;){const N=h[T],q=h[T+1];if(!q)return!1;let Z=h[T-1].angleTo(N)-N.angleTo(q);for(Z=Math.abs((Z+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:j,angleDelta:Z}),B+=Z;j-z[0].distance>g;)B-=z.shift().angleDelta;if(B>_)return!1;T++,j+=N.dist(q)}return!0}function UR(h){let c=0;for(let f=0;f<h.length-1;f++)c+=h[f].dist(h[f+1]);return c}function qR(h,c,f){return h?.6*c*f:0}function QR(h,c){return Math.max(h?h.right-h.left:0,c?c.right-c.left:0)}function fX(h,c,f,g,_,C){const T=qR(f,_,C),j=QR(f,g)*C;let z=0;const B=UR(h)/2;for(let N=0;N<h.length-1;N++){const q=h[N],Z=h[N+1],re=q.dist(Z);if(z+re>B){const se=(B-z)/re,ae=Gi.number(q.x,Z.x,se),me=Gi.number(q.y,Z.y,se),we=new od(ae,me,Z.angleTo(q),N);return we._round(),!T||WR(h,we,j,T,c)?we:void 0}z+=re}}function pX(h,c,f,g,_,C,T,j,z){const B=qR(g,C,T),N=QR(g,_),q=N*T,Z=h[0].x===0||h[0].x===z||h[0].y===0||h[0].y===z;return c-q<c/4&&(c=q+c/4),HR(h,Z?c/2*j%c:(N/2+2*C)*T*j%c,c,B,f,q,Z,!1,z)}function HR(h,c,f,g,_,C,T,j,z){const B=C/2,N=UR(h);let q=0,Z=c-f,re=[];for(let se=0;se<h.length-1;se++){const ae=h[se],me=h[se+1],we=ae.dist(me),Ze=me.angleTo(ae);for(;Z+f<q+we;){Z+=f;const Ee=(Z-q)/we,Qe=Gi.number(ae.x,me.x,Ee),ot=Gi.number(ae.y,me.y,Ee);if(Qe>=0&&Qe<z&&ot>=0&&ot<z&&Z-B>=0&&Z+B<=N){const yt=new od(Qe,ot,Ze,se);yt._round(),g&&!WR(h,yt,C,g,_)||re.push(yt)}}q+=we}return j||re.length||T||(re=HR(h,q/2,f,g,_,C,T,!0,z)),re}Kt("Anchor",od);const dg=Io;function GR(h,c,f,g){const _=[],C=h.image,T=C.pixelRatio,j=C.paddedRect.w-2*dg,z=C.paddedRect.h-2*dg;let B={x1:h.left,y1:h.top,x2:h.right,y2:h.bottom};const N=C.stretchX||[[0,j]],q=C.stretchY||[[0,z]],Z=(ht,fr)=>ht+fr[1]-fr[0],re=N.reduce(Z,0),se=q.reduce(Z,0),ae=j-re,me=z-se;let we=0,Ze=re,Ee=0,Qe=se,ot=0,yt=ae,Wt=0,xr=me;if(C.content&&g){const ht=C.content,fr=ht[2]-ht[0],cr=ht[3]-ht[1];(C.textFitWidth||C.textFitHeight)&&(B=_R(h)),we=I_(N,0,ht[0]),Ee=I_(q,0,ht[1]),Ze=I_(N,ht[0],ht[2]),Qe=I_(q,ht[1],ht[3]),ot=ht[0]-we,Wt=ht[1]-Ee,yt=fr-Ze,xr=cr-Qe}const $t=B.x1,Rt=B.y1,dr=B.x2-$t,er=B.y2-Rt,Ht=(ht,fr,cr,Or)=>{const Dn=R_(ht.stretch-we,Ze,dr,$t),jn=D_(ht.fixed-ot,yt,ht.stretch,re),Xi=R_(fr.stretch-Ee,Qe,er,Rt),ml=D_(fr.fixed-Wt,xr,fr.stretch,se),Is=R_(cr.stretch-we,Ze,dr,$t),Ki=D_(cr.fixed-ot,yt,cr.stretch,re),po=R_(Or.stretch-Ee,Qe,er,Rt),mo=D_(Or.fixed-Wt,xr,Or.stretch,se),go=new v(Dn,Xi),yi=new v(Is,Xi),Zi=new v(Is,po),Hs=new v(Dn,po),Rs=new v(jn/T,ml/T),yo=new v(Ki/T,mo/T),Ds=c*Math.PI/180;if(Ds){const un=Math.sin(Ds),Nn=Math.cos(Ds),Xn=[Nn,-un,un,Nn];go._matMult(Xn),yi._matMult(Xn),Hs._matMult(Xn),Zi._matMult(Xn)}const Na=ht.stretch+ht.fixed,Ro=fr.stretch+fr.fixed;return{tl:go,tr:yi,bl:Hs,br:Zi,tex:{x:C.paddedRect.x+dg+Na,y:C.paddedRect.y+dg+Ro,w:cr.stretch+cr.fixed-Na,h:Or.stretch+Or.fixed-Ro},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Rs,pixelOffsetBR:yo,minFontScaleX:yt/T/dr,minFontScaleY:xr/T/er,isSDF:f}};if(g&&(C.stretchX||C.stretchY)){const ht=XR(N,ae,re),fr=XR(q,me,se);for(let cr=0;cr<ht.length-1;cr++){const Or=ht[cr],Dn=ht[cr+1];for(let jn=0;jn<fr.length-1;jn++)_.push(Ht(Or,fr[jn],Dn,fr[jn+1]))}}else _.push(Ht({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:j+1},{fixed:0,stretch:z+1}));return _}function I_(h,c,f){let g=0;for(const _ of h)g+=Math.max(c,Math.min(f,_[1]))-Math.max(c,Math.min(f,_[0]));return g}function XR(h,c,f){const g=[{fixed:-dg,stretch:0}];for(const[_,C]of h){const T=g[g.length-1];g.push({fixed:_-T.stretch,stretch:T.stretch}),g.push({fixed:_-T.stretch,stretch:T.stretch+(C-_)})}return g.push({fixed:c+dg,stretch:f}),g}function R_(h,c,f,g){return h/c*f+g}function D_(h,c,f,g){return h-c*f/g}class L_{constructor(c,f,g,_,C,T,j,z,B,N){var q;if(this.boxStartIndex=c.length,B){let Z=T.top,re=T.bottom;const se=T.collisionPadding;se&&(Z-=se[1],re+=se[3]);let ae=re-Z;ae>0&&(ae=Math.max(10,ae),this.circleDiameter=ae)}else{const Z=!((q=T.image)===null||q===void 0)&&q.content&&(T.image.textFitWidth||T.image.textFitHeight)?_R(T):{x1:T.left,y1:T.top,x2:T.right,y2:T.bottom};Z.y1=Z.y1*j-z[0],Z.y2=Z.y2*j+z[2],Z.x1=Z.x1*j-z[3],Z.x2=Z.x2*j+z[1];const re=T.collisionPadding;if(re&&(Z.x1-=re[0]*j,Z.y1-=re[1]*j,Z.x2+=re[2]*j,Z.y2+=re[3]*j),N){const se=new v(Z.x1,Z.y1),ae=new v(Z.x2,Z.y1),me=new v(Z.x1,Z.y2),we=new v(Z.x2,Z.y2),Ze=N*Math.PI/180;se._rotate(Ze),ae._rotate(Ze),me._rotate(Ze),we._rotate(Ze),Z.x1=Math.min(se.x,ae.x,me.x,we.x),Z.x2=Math.max(se.x,ae.x,me.x,we.x),Z.y1=Math.min(se.y,ae.y,me.y,we.y),Z.y2=Math.max(se.y,ae.y,me.y,we.y)}c.emplaceBack(f.x,f.y,Z.x1,Z.y1,Z.x2,Z.y2,g,_,C)}this.boxEndIndex=c.length}}class mX{constructor(c=[],f=(g,_)=>g<_?-1:g>_?1:0){if(this.data=c,this.length=this.data.length,this.compare=f,this.length>0)for(let g=(this.length>>1)-1;g>=0;g--)this._down(g)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;const c=this.data[0],f=this.data.pop();return--this.length>0&&(this.data[0]=f,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:f,compare:g}=this,_=f[c];for(;c>0;){const C=c-1>>1,T=f[C];if(g(_,T)>=0)break;f[c]=T,c=C}f[c]=_}_down(c){const{data:f,compare:g}=this,_=this.length>>1,C=f[c];for(;c<_;){let T=1+(c<<1);const j=T+1;if(j<this.length&&g(f[j],f[T])<0&&(T=j),g(f[T],C)>=0)break;f[c]=f[T],c=T}f[c]=C}}function gX(h,c=1,f=!1){let g=1/0,_=1/0,C=-1/0,T=-1/0;const j=h[0];for(let re=0;re<j.length;re++){const se=j[re];(!re||se.x<g)&&(g=se.x),(!re||se.y<_)&&(_=se.y),(!re||se.x>C)&&(C=se.x),(!re||se.y>T)&&(T=se.y)}const z=Math.min(C-g,T-_);let B=z/2;const N=new mX([],yX);if(z===0)return new v(g,_);for(let re=g;re<C;re+=z)for(let se=_;se<T;se+=z)N.push(new fg(re+B,se+B,B,h));let q=function(re){let se=0,ae=0,me=0;const we=re[0];for(let Ze=0,Ee=we.length,Qe=Ee-1;Ze<Ee;Qe=Ze++){const ot=we[Ze],yt=we[Qe],Wt=ot.x*yt.y-yt.x*ot.y;ae+=(ot.x+yt.x)*Wt,me+=(ot.y+yt.y)*Wt,se+=3*Wt}return new fg(ae/se,me/se,0,re)}(h),Z=N.length;for(;N.length;){const re=N.pop();(re.d>q.d||!q.d)&&(q=re,f&&console.log("found best %d after %d probes",Math.round(1e4*re.d)/1e4,Z)),re.max-q.d<=c||(B=re.h/2,N.push(new fg(re.p.x-B,re.p.y-B,B,h)),N.push(new fg(re.p.x+B,re.p.y-B,B,h)),N.push(new fg(re.p.x-B,re.p.y+B,B,h)),N.push(new fg(re.p.x+B,re.p.y+B,B,h)),Z+=4)}return f&&(console.log(`num probes: ${Z}`),console.log(`best distance: ${q.d}`)),q.p}function yX(h,c){return c.max-h.max}function fg(h,c,f,g){this.p=new v(h,c),this.h=f,this.d=function(_,C){let T=!1,j=1/0;for(let z=0;z<C.length;z++){const B=C[z];for(let N=0,q=B.length,Z=q-1;N<q;Z=N++){const re=B[N],se=B[Z];re.y>_.y!=se.y>_.y&&_.x<(se.x-re.x)*(_.y-re.y)/(se.y-re.y)+re.x&&(T=!T),j=Math.min(j,zI(_,re,se))}}return(T?1:-1)*Math.sqrt(j)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}var Ms;a.aq=void 0,(Ms=a.aq||(a.aq={}))[Ms.center=1]="center",Ms[Ms.left=2]="left",Ms[Ms.right=3]="right",Ms[Ms.top=4]="top",Ms[Ms.bottom=5]="bottom",Ms[Ms["top-left"]=6]="top-left",Ms[Ms["top-right"]=7]="top-right",Ms[Ms["bottom-left"]=8]="bottom-left",Ms[Ms["bottom-right"]=9]="bottom-right";const ad=7,kT=Number.POSITIVE_INFINITY;function KR(h,c){return c[1]!==kT?function(f,g,_){let C=0,T=0;switch(g=Math.abs(g),_=Math.abs(_),f){case"top-right":case"top-left":case"top":T=_-ad;break;case"bottom-right":case"bottom-left":case"bottom":T=-_+ad}switch(f){case"top-right":case"bottom-right":case"right":C=-g;break;case"top-left":case"bottom-left":case"left":C=g}return[C,T]}(h,c[0],c[1]):function(f,g){let _=0,C=0;g<0&&(g=0);const T=g/Math.SQRT2;switch(f){case"top-right":case"top-left":C=T-ad;break;case"bottom-right":case"bottom-left":C=-T+ad;break;case"bottom":C=-g+ad;break;case"top":C=g-ad}switch(f){case"top-right":case"bottom-right":_=-T;break;case"top-left":case"bottom-left":_=T;break;case"left":_=g;break;case"right":_=-g}return[_,C]}(h,c[0])}function ZR(h,c,f){var g;const _=h.layout,C=(g=_.get("text-variable-anchor-offset"))===null||g===void 0?void 0:g.evaluate(c,{},f);if(C){const j=C.values,z=[];for(let B=0;B<j.length;B+=2){const N=z[B]=j[B],q=j[B+1].map(Z=>Z*Fi);N.startsWith("top")?q[1]-=ad:N.startsWith("bottom")&&(q[1]+=ad),z[B+1]=q}return new uo(z)}const T=_.get("text-variable-anchor");if(T){let j;j=h._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[_.get("text-radial-offset").evaluate(c,{},f)*Fi,kT]:_.get("text-offset").evaluate(c,{},f).map(B=>B*Fi);const z=[];for(const B of T)z.push(B,KR(B,j));return new uo(z)}return null}function CT(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function xX(h,c,f,g,_,C,T,j,z,B,N){let q=C.textMaxSize.evaluate(c,{});q===void 0&&(q=T);const Z=h.layers[0].layout,re=Z.get("icon-offset").evaluate(c,{},N),se=JR(f.horizontal),ae=T/24,me=h.tilePixelRatio*ae,we=h.tilePixelRatio*q/24,Ze=h.tilePixelRatio*j,Ee=h.tilePixelRatio*Z.get("symbol-spacing"),Qe=Z.get("text-padding")*h.tilePixelRatio,ot=function(ht,fr,cr,Or=1){const Dn=ht.get("icon-padding").evaluate(fr,{},cr),jn=Dn&&Dn.values;return[jn[0]*Or,jn[1]*Or,jn[2]*Or,jn[3]*Or]}(Z,c,N,h.tilePixelRatio),yt=Z.get("text-max-angle")/180*Math.PI,Wt=Z.get("text-rotation-alignment")!=="viewport"&&Z.get("symbol-placement")!=="point",xr=Z.get("icon-rotation-alignment")==="map"&&Z.get("symbol-placement")!=="point",$t=Z.get("symbol-placement"),Rt=Ee/2,dr=Z.get("icon-text-fit");let er;g&&dr!=="none"&&(h.allowVerticalPlacement&&f.vertical&&(er=wR(g,f.vertical,dr,Z.get("icon-text-fit-padding"),re,ae)),se&&(g=wR(g,se,dr,Z.get("icon-text-fit-padding"),re,ae)));const Ht=(ht,fr)=>{fr.x<0||fr.x>=Ei||fr.y<0||fr.y>=Ei||function(cr,Or,Dn,jn,Xi,ml,Is,Ki,po,mo,go,yi,Zi,Hs,Rs,yo,Ds,Na,Ro,un,Nn,Xn,la,ai,pg){const Lc=cr.addToLineVertexArray(Or,Dn);let Fc,gl,Va,ds,Vu=0,Px=0,nD=0,iD=0,MT=-1,IT=-1;const Wu={};let sD=eg("");if(cr.allowVerticalPlacement&&jn.vertical){const Gs=Ki.layout.get("text-rotate").evaluate(Nn,{},ai)+90;Va=new L_(po,Or,mo,go,yi,jn.vertical,Zi,Hs,Rs,Gs),Is&&(ds=new L_(po,Or,mo,go,yi,Is,Ds,Na,Rs,Gs))}if(Xi){const Gs=Ki.layout.get("icon-rotate").evaluate(Nn,{}),Wa=Ki.layout.get("icon-text-fit")!=="none",ep=GR(Xi,Gs,la,Wa),rc=Is?GR(Is,Gs,la,Wa):void 0;gl=new L_(po,Or,mo,go,yi,Xi,Ds,Na,!1,Gs),Vu=4*ep.length;const tp=cr.iconSizeData;let Bc=null;tp.kind==="source"?(Bc=[Dc*Ki.layout.get("icon-size").evaluate(Nn,{})],Bc[0]>id&&Ae(`${cr.layerIds[0]}: Value for "icon-size" is >= ${kx}. Reduce your "icon-size".`)):tp.kind==="composite"&&(Bc=[Dc*Xn.compositeIconSizes[0].evaluate(Nn,{},ai),Dc*Xn.compositeIconSizes[1].evaluate(Nn,{},ai)],(Bc[0]>id||Bc[1]>id)&&Ae(`${cr.layerIds[0]}: Value for "icon-size" is >= ${kx}. Reduce your "icon-size".`)),cr.addSymbols(cr.icon,ep,Bc,un,Ro,Nn,a.ah.none,Or,Lc.lineStartIndex,Lc.lineLength,-1,ai),MT=cr.icon.placedSymbolArray.length-1,rc&&(Px=4*rc.length,cr.addSymbols(cr.icon,rc,Bc,un,Ro,Nn,a.ah.vertical,Or,Lc.lineStartIndex,Lc.lineLength,-1,ai),IT=cr.icon.placedSymbolArray.length-1)}const oD=Object.keys(jn.horizontal);for(const Gs of oD){const Wa=jn.horizontal[Gs];if(!Fc){sD=eg(Wa.text);const rc=Ki.layout.get("text-rotate").evaluate(Nn,{},ai);Fc=new L_(po,Or,mo,go,yi,Wa,Zi,Hs,Rs,rc)}const ep=Wa.positionedLines.length===1;if(nD+=YR(cr,Or,Wa,ml,Ki,Rs,Nn,yo,Lc,jn.vertical?a.ah.horizontal:a.ah.horizontalOnly,ep?oD:[Gs],Wu,MT,Xn,ai),ep)break}jn.vertical&&(iD+=YR(cr,Or,jn.vertical,ml,Ki,Rs,Nn,yo,Lc,a.ah.vertical,["vertical"],Wu,IT,Xn,ai));const _X=Fc?Fc.boxStartIndex:cr.collisionBoxArray.length,wX=Fc?Fc.boxEndIndex:cr.collisionBoxArray.length,SX=Va?Va.boxStartIndex:cr.collisionBoxArray.length,kX=Va?Va.boxEndIndex:cr.collisionBoxArray.length,CX=gl?gl.boxStartIndex:cr.collisionBoxArray.length,TX=gl?gl.boxEndIndex:cr.collisionBoxArray.length,OX=ds?ds.boxStartIndex:cr.collisionBoxArray.length,jX=ds?ds.boxEndIndex:cr.collisionBoxArray.length;let tc=-1;const B_=(Gs,Wa)=>Gs&&Gs.circleDiameter?Math.max(Gs.circleDiameter,Wa):Wa;tc=B_(Fc,tc),tc=B_(Va,tc),tc=B_(gl,tc),tc=B_(ds,tc);const aD=tc>-1?1:0;aD&&(tc*=pg/Fi),cr.glyphOffsetArray.length>=hg.MAX_GLYPHS&&Ae("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Nn.sortKey!==void 0&&cr.addToSortKeyRanges(cr.symbolInstances.length,Nn.sortKey);const PX=ZR(Ki,Nn,ai),[AX,EX]=function(Gs,Wa){const ep=Gs.length,rc=Wa==null?void 0:Wa.values;if((rc==null?void 0:rc.length)>0)for(let tp=0;tp<rc.length;tp+=2){const Bc=rc[tp+1];Gs.emplaceBack(a.aq[rc[tp]],Bc[0],Bc[1])}return[ep,Gs.length]}(cr.textAnchorOffsets,PX);cr.symbolInstances.emplaceBack(Or.x,Or.y,Wu.right>=0?Wu.right:-1,Wu.center>=0?Wu.center:-1,Wu.left>=0?Wu.left:-1,Wu.vertical||-1,MT,IT,sD,_X,wX,SX,kX,CX,TX,OX,jX,mo,nD,iD,Vu,Px,aD,0,Zi,tc,AX,EX)}(h,fr,ht,f,g,_,er,h.layers[0],h.collisionBoxArray,c.index,c.sourceLayerIndex,h.index,me,[Qe,Qe,Qe,Qe],Wt,z,Ze,ot,xr,re,c,C,B,N,T)};if($t==="line")for(const ht of VR(c.geometry,0,0,Ei,Ei)){const fr=pX(ht,Ee,yt,f.vertical||se,g,24,we,h.overscaling,Ei);for(const cr of fr)se&&vX(h,se.text,Rt,cr)||Ht(ht,cr)}else if($t==="line-center"){for(const ht of c.geometry)if(ht.length>1){const fr=fX(ht,yt,f.vertical||se,g,24,we);fr&&Ht(ht,fr)}}else if(c.type==="Polygon")for(const ht of Am(c.geometry,0)){const fr=gX(ht,16);Ht(ht[0],new od(fr.x,fr.y,0))}else if(c.type==="LineString")for(const ht of c.geometry)Ht(ht,new od(ht[0].x,ht[0].y,0));else if(c.type==="Point")for(const ht of c.geometry)for(const fr of ht)Ht([fr],new od(fr.x,fr.y,0))}function YR(h,c,f,g,_,C,T,j,z,B,N,q,Z,re,se){const ae=function(Ze,Ee,Qe,ot,yt,Wt,xr,$t){const Rt=ot.layout.get("text-rotate").evaluate(Wt,{})*Math.PI/180,dr=[];for(const er of Ee.positionedLines)for(const Ht of er.positionedGlyphs){if(!Ht.rect)continue;const ht=Ht.rect||{};let fr=pR+1,cr=!0,Or=1,Dn=0;const jn=(yt||$t)&&Ht.vertical,Xi=Ht.metrics.advance*Ht.scale/2;if($t&&Ee.verticalizable&&(Dn=er.lineOffset/2-(Ht.imageName?-(Fi-Ht.metrics.width*Ht.scale)/2:(Ht.scale-1)*Fi)),Ht.imageName){const un=xr[Ht.imageName];cr=un.sdf,Or=un.pixelRatio,fr=Io/Or}const ml=yt?[Ht.x+Xi,Ht.y]:[0,0];let Is=yt?[0,0]:[Ht.x+Xi+Qe[0],Ht.y+Qe[1]-Dn],Ki=[0,0];jn&&(Ki=Is,Is=[0,0]);const po=Ht.metrics.isDoubleResolution?2:1,mo=(Ht.metrics.left-fr)*Ht.scale-Xi+Is[0],go=(-Ht.metrics.top-fr)*Ht.scale+Is[1],yi=mo+ht.w/po*Ht.scale/Or,Zi=go+ht.h/po*Ht.scale/Or,Hs=new v(mo,go),Rs=new v(yi,go),yo=new v(mo,Zi),Ds=new v(yi,Zi);if(jn){const un=new v(-Xi,Xi-wx),Nn=-Math.PI/2,Xn=Fi/2-Xi,la=new v(5-wx-Xn,-(Ht.imageName?Xn:0)),ai=new v(...Ki);Hs._rotateAround(Nn,un)._add(la)._add(ai),Rs._rotateAround(Nn,un)._add(la)._add(ai),yo._rotateAround(Nn,un)._add(la)._add(ai),Ds._rotateAround(Nn,un)._add(la)._add(ai)}if(Rt){const un=Math.sin(Rt),Nn=Math.cos(Rt),Xn=[Nn,-un,un,Nn];Hs._matMult(Xn),Rs._matMult(Xn),yo._matMult(Xn),Ds._matMult(Xn)}const Na=new v(0,0),Ro=new v(0,0);dr.push({tl:Hs,tr:Rs,bl:yo,br:Ds,tex:ht,writingMode:Ee.writingMode,glyphOffset:ml,sectionIndex:Ht.sectionIndex,isSDF:cr,pixelOffsetTL:Na,pixelOffsetBR:Ro,minFontScaleX:0,minFontScaleY:0})}return dr}(0,f,j,_,C,T,g,h.allowVerticalPlacement),me=h.textSizeData;let we=null;me.kind==="source"?(we=[Dc*_.layout.get("text-size").evaluate(T,{})],we[0]>id&&Ae(`${h.layerIds[0]}: Value for "text-size" is >= ${kx}. Reduce your "text-size".`)):me.kind==="composite"&&(we=[Dc*re.compositeTextSizes[0].evaluate(T,{},se),Dc*re.compositeTextSizes[1].evaluate(T,{},se)],(we[0]>id||we[1]>id)&&Ae(`${h.layerIds[0]}: Value for "text-size" is >= ${kx}. Reduce your "text-size".`)),h.addSymbols(h.text,ae,we,j,C,T,B,c,z.lineStartIndex,z.lineLength,Z,se);for(const Ze of N)q[Ze]=h.text.placedSymbolArray.length-1;return 4*ae.length}function JR(h){for(const c in h)return h[c];return null}function vX(h,c,f,g){const _=h.compareText;if(c in _){const C=_[c];for(let T=C.length-1;T>=0;T--)if(g.dist(C[T])<f)return!0}else _[c]=[];return _[c].push(g),!1}const eD=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class TT{static from(c){if(!(c instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[f,g]=new Uint8Array(c,0,2);if(f!==219)throw new Error("Data does not appear to be in a KDBush format.");const _=g>>4;if(_!==1)throw new Error(`Got v${_} data when expected v1.`);const C=eD[15&g];if(!C)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(c,2,1),[j]=new Uint32Array(c,4,1);return new TT(j,T,C,c)}constructor(c,f=64,g=Float64Array,_){if(isNaN(c)||c<0)throw new Error(`Unpexpected numItems value: ${c}.`);this.numItems=+c,this.nodeSize=Math.min(Math.max(+f,2),65535),this.ArrayType=g,this.IndexArrayType=c<65536?Uint16Array:Uint32Array;const C=eD.indexOf(this.ArrayType),T=2*c*this.ArrayType.BYTES_PER_ELEMENT,j=c*this.IndexArrayType.BYTES_PER_ELEMENT,z=(8-j%8)%8;if(C<0)throw new Error(`Unexpected typed array class: ${g}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+j+z,2*c),this._pos=2*c,this._finished=!0):(this.data=new ArrayBuffer(8+T+j+z),this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+j+z,2*c),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+C]),new Uint16Array(this.data,2,1)[0]=f,new Uint32Array(this.data,4,1)[0]=c)}add(c,f){const g=this._pos>>1;return this.ids[g]=g,this.coords[this._pos++]=c,this.coords[this._pos++]=f,g}finish(){const c=this._pos>>1;if(c!==this.numItems)throw new Error(`Added ${c} items when expected ${this.numItems}.`);return OT(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(c,f,g,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:C,coords:T,nodeSize:j}=this,z=[0,C.length-1,0],B=[];for(;z.length;){const N=z.pop()||0,q=z.pop()||0,Z=z.pop()||0;if(q-Z<=j){for(let me=Z;me<=q;me++){const we=T[2*me],Ze=T[2*me+1];we>=c&&we<=g&&Ze>=f&&Ze<=_&&B.push(C[me])}continue}const re=Z+q>>1,se=T[2*re],ae=T[2*re+1];se>=c&&se<=g&&ae>=f&&ae<=_&&B.push(C[re]),(N===0?c<=se:f<=ae)&&(z.push(Z),z.push(re-1),z.push(1-N)),(N===0?g>=se:_>=ae)&&(z.push(re+1),z.push(q),z.push(1-N))}return B}within(c,f,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:C,nodeSize:T}=this,j=[0,_.length-1,0],z=[],B=g*g;for(;j.length;){const N=j.pop()||0,q=j.pop()||0,Z=j.pop()||0;if(q-Z<=T){for(let me=Z;me<=q;me++)rD(C[2*me],C[2*me+1],c,f)<=B&&z.push(_[me]);continue}const re=Z+q>>1,se=C[2*re],ae=C[2*re+1];rD(se,ae,c,f)<=B&&z.push(_[re]),(N===0?c-g<=se:f-g<=ae)&&(j.push(Z),j.push(re-1),j.push(1-N)),(N===0?c+g>=se:f+g>=ae)&&(j.push(re+1),j.push(q),j.push(1-N))}return z}}function OT(h,c,f,g,_,C){if(_-g<=f)return;const T=g+_>>1;tD(h,c,T,g,_,C),OT(h,c,f,g,T-1,1-C),OT(h,c,f,T+1,_,1-C)}function tD(h,c,f,g,_,C){for(;_>g;){if(_-g>600){const B=_-g+1,N=f-g+1,q=Math.log(B),Z=.5*Math.exp(2*q/3),re=.5*Math.sqrt(q*Z*(B-Z)/B)*(N-B/2<0?-1:1);tD(h,c,f,Math.max(g,Math.floor(f-N*Z/B+re)),Math.min(_,Math.floor(f+(B-N)*Z/B+re)),C)}const T=c[2*f+C];let j=g,z=_;for(Ox(h,c,g,f),c[2*_+C]>T&&Ox(h,c,g,_);j<z;){for(Ox(h,c,j,z),j++,z--;c[2*j+C]<T;)j++;for(;c[2*z+C]>T;)z--}c[2*g+C]===T?Ox(h,c,g,z):(z++,Ox(h,c,z,_)),z<=f&&(g=z+1),f<=z&&(_=z-1)}}function Ox(h,c,f,g){jT(h,f,g),jT(c,2*f,2*g),jT(c,2*f+1,2*g+1)}function jT(h,c,f){const g=h[c];h[c]=h[f],h[f]=g}function rD(h,c,f,g){const _=h-f,C=c-g;return _*_+C*C}var PT;a.bg=void 0,(PT=a.bg||(a.bg={})).create="create",PT.load="load",PT.fullLoad="fullLoad";let F_=null,jx=[];const AT=1e3/60,ET="loadTime",zT="fullLoadTime",bX={mark(h){performance.mark(h)},frame(h){const c=h;F_!=null&&jx.push(c-F_),F_=c},clearMetrics(){F_=null,jx=[],performance.clearMeasures(ET),performance.clearMeasures(zT);for(const h in a.bg)performance.clearMarks(a.bg[h])},getPerformanceMetrics(){performance.measure(ET,a.bg.create,a.bg.load),performance.measure(zT,a.bg.create,a.bg.fullLoad);const h=performance.getEntriesByName(ET)[0].duration,c=performance.getEntriesByName(zT)[0].duration,f=jx.length,g=1/(jx.reduce((C,T)=>C+T,0)/f/1e3),_=jx.filter(C=>C>AT).reduce((C,T)=>C+(T-AT)/AT,0);return{loadTime:h,fullLoadTime:c,fps:g,percentDroppedFrames:_/(f+_)*100,totalFrames:f}}};a.$=class extends H{},a.A=sg,a.B=$C,a.C=function(h){if(tt==null){const c=h.navigator?h.navigator.userAgent:null;tt=!!h.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return tt},a.D=or,a.E=rt,a.F=class{constructor(h,c){this.target=h,this.mapId=c,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new hX(()=>this.process()),this.subscription=function(f,g,_,C){return f.addEventListener(g,_,!1),{unsubscribe:()=>{f.removeEventListener(g,_,!1)}}}(this.target,"message",f=>this.receive(f)),this.globalScope=Ye(self)?h:window}registerMessageHandler(h,c){this.messageHandlers[h]=c}sendAsync(h,c){return new Promise((f,g)=>{const _=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[_]={resolve:f,reject:g},c&&c.signal.addEventListener("abort",()=>{delete this.resolveRejects[_];const j={id:_,type:"<cancel>",origin:location.origin,targetMapId:h.targetMapId,sourceMapId:this.mapId};this.target.postMessage(j)},{once:!0});const C=[],T=Object.assign(Object.assign({},h),{id:_,sourceMapId:this.mapId,origin:location.origin,data:Qh(h.data,C)});this.target.postMessage(T,{transfer:C})})}receive(h){const c=h.data,f=c.id;if(!(c.origin!=="file://"&&location.origin!=="file://"&&c.origin!=="resource://android"&&location.origin!=="resource://android"&&c.origin!==location.origin||c.targetMapId&&this.mapId!==c.targetMapId)){if(c.type==="<cancel>"){delete this.tasks[f];const g=this.abortControllers[f];return delete this.abortControllers[f],void(g&&g.abort())}if(Ye(self)||c.mustQueue)return this.tasks[f]=c,this.taskQueue.push(f),void this.invoker.trigger();this.processTask(f,c)}}process(){if(this.taskQueue.length===0)return;const h=this.taskQueue.shift(),c=this.tasks[h];delete this.tasks[h],this.taskQueue.length>0&&this.invoker.trigger(),c&&this.processTask(h,c)}processTask(h,c){return o(this,void 0,void 0,function*(){if(c.type==="<response>"){const _=this.resolveRejects[h];return delete this.resolveRejects[h],_?void(c.error?_.reject(Hh(c.error)):_.resolve(Hh(c.data))):void 0}if(!this.messageHandlers[c.type])return void this.completeTask(h,new Error(`Could not find a registered handler for ${c.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const f=Hh(c.data),g=new AbortController;this.abortControllers[h]=g;try{const _=yield this.messageHandlers[c.type](c.sourceMapId,f,g);this.completeTask(h,null,_)}catch(_){this.completeTask(h,_)}})}completeTask(h,c,f){const g=[];delete this.abortControllers[h];const _={id:h,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:c?Qh(c):null,data:Qh(f,g)};this.target.postMessage(_,{transfer:g})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},a.G=it,a.H=function(){var h=new sg(16);return sg!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},a.I=fT,a.J=function(h,c,f){var g,_,C,T,j,z,B,N,q,Z,re,se,ae=f[0],me=f[1],we=f[2];return c===h?(h[12]=c[0]*ae+c[4]*me+c[8]*we+c[12],h[13]=c[1]*ae+c[5]*me+c[9]*we+c[13],h[14]=c[2]*ae+c[6]*me+c[10]*we+c[14],h[15]=c[3]*ae+c[7]*me+c[11]*we+c[15]):(_=c[1],C=c[2],T=c[3],j=c[4],z=c[5],B=c[6],N=c[7],q=c[8],Z=c[9],re=c[10],se=c[11],h[0]=g=c[0],h[1]=_,h[2]=C,h[3]=T,h[4]=j,h[5]=z,h[6]=B,h[7]=N,h[8]=q,h[9]=Z,h[10]=re,h[11]=se,h[12]=g*ae+j*me+q*we+c[12],h[13]=_*ae+z*me+Z*we+c[13],h[14]=C*ae+B*me+re*we+c[14],h[15]=T*ae+N*me+se*we+c[15]),h},a.K=function(h,c,f){var g=f[0],_=f[1],C=f[2];return h[0]=c[0]*g,h[1]=c[1]*g,h[2]=c[2]*g,h[3]=c[3]*g,h[4]=c[4]*_,h[5]=c[5]*_,h[6]=c[6]*_,h[7]=c[7]*_,h[8]=c[8]*C,h[9]=c[9]*C,h[10]=c[10]*C,h[11]=c[11]*C,h[12]=c[12],h[13]=c[13],h[14]=c[14],h[15]=c[15],h},a.L=DI,a.M=function(h,c){const f={};for(let g=0;g<c.length;g++){const _=c[g];_ in h&&(f[_]=h[_])}return f},a.N=sd,a.O=ER,a.P=v,a.Q=zR,a.R=Ba,a.S=$a,a.T=Xm,a.U=R,a.V=F,a.W=Ge,a.X=Ei,a.Y=A,a.Z=Cx,a._=o,a.a=st,a.a$=function(h,c){var f=h[0],g=h[1],_=h[2],C=h[3],T=h[4],j=h[5],z=h[6],B=h[7],N=h[8],q=h[9],Z=h[10],re=h[11],se=h[12],ae=h[13],me=h[14],we=h[15],Ze=c[0],Ee=c[1],Qe=c[2],ot=c[3],yt=c[4],Wt=c[5],xr=c[6],$t=c[7],Rt=c[8],dr=c[9],er=c[10],Ht=c[11],ht=c[12],fr=c[13],cr=c[14],Or=c[15];return Math.abs(f-Ze)<=fo*Math.max(1,Math.abs(f),Math.abs(Ze))&&Math.abs(g-Ee)<=fo*Math.max(1,Math.abs(g),Math.abs(Ee))&&Math.abs(_-Qe)<=fo*Math.max(1,Math.abs(_),Math.abs(Qe))&&Math.abs(C-ot)<=fo*Math.max(1,Math.abs(C),Math.abs(ot))&&Math.abs(T-yt)<=fo*Math.max(1,Math.abs(T),Math.abs(yt))&&Math.abs(j-Wt)<=fo*Math.max(1,Math.abs(j),Math.abs(Wt))&&Math.abs(z-xr)<=fo*Math.max(1,Math.abs(z),Math.abs(xr))&&Math.abs(B-$t)<=fo*Math.max(1,Math.abs(B),Math.abs($t))&&Math.abs(N-Rt)<=fo*Math.max(1,Math.abs(N),Math.abs(Rt))&&Math.abs(q-dr)<=fo*Math.max(1,Math.abs(q),Math.abs(dr))&&Math.abs(Z-er)<=fo*Math.max(1,Math.abs(Z),Math.abs(er))&&Math.abs(re-Ht)<=fo*Math.max(1,Math.abs(re),Math.abs(Ht))&&Math.abs(se-ht)<=fo*Math.max(1,Math.abs(se),Math.abs(ht))&&Math.abs(ae-fr)<=fo*Math.max(1,Math.abs(ae),Math.abs(fr))&&Math.abs(me-cr)<=fo*Math.max(1,Math.abs(me),Math.abs(cr))&&Math.abs(we-Or)<=fo*Math.max(1,Math.abs(we),Math.abs(Or))},a.a0=Yr,a.a1=ST,a.a2=He,a.a3=h=>{const c=window.document.createElement("video");return c.muted=!0,new Promise(f=>{c.onloadstart=()=>{f(c)};for(const g of h){const _=window.document.createElement("source");Et(g)||(c.crossOrigin="Anonymous"),_.src=g,c.appendChild(_)}})},a.a4=function(){return Y++},a.a5=Nt,a.a6=hg,a.a7=q0,a.a8=Yf,a.a9=FR,a.aA=function(h){if(h.type==="custom")return new uX(h);switch(h.type){case"background":return new aX(h);case"circle":return new GH(h);case"fill":return new hG(h);case"fill-extrusion":return new TG(h);case"heatmap":return new KH(h);case"hillshade":return new YH(h);case"line":return new IG(h);case"raster":return new cX(h);case"symbol":return new M_(h)}},a.aB=ce,a.aC=function(h,c){if(!h)return[{command:"setStyle",args:[c]}];let f=[];try{if(!wt(h.version,c.version))return[{command:"setStyle",args:[c]}];wt(h.center,c.center)||f.push({command:"setCenter",args:[c.center]}),wt(h.zoom,c.zoom)||f.push({command:"setZoom",args:[c.zoom]}),wt(h.bearing,c.bearing)||f.push({command:"setBearing",args:[c.bearing]}),wt(h.pitch,c.pitch)||f.push({command:"setPitch",args:[c.pitch]}),wt(h.sprite,c.sprite)||f.push({command:"setSprite",args:[c.sprite]}),wt(h.glyphs,c.glyphs)||f.push({command:"setGlyphs",args:[c.glyphs]}),wt(h.transition,c.transition)||f.push({command:"setTransition",args:[c.transition]}),wt(h.light,c.light)||f.push({command:"setLight",args:[c.light]}),wt(h.terrain,c.terrain)||f.push({command:"setTerrain",args:[c.terrain]}),wt(h.sky,c.sky)||f.push({command:"setSky",args:[c.sky]}),wt(h.projection,c.projection)||f.push({command:"setProjection",args:[c.projection]});const g={},_=[];(function(T,j,z,B){let N;for(N in j=j||{},T=T||{})Object.prototype.hasOwnProperty.call(T,N)&&(Object.prototype.hasOwnProperty.call(j,N)||yn(N,z,B));for(N in j)Object.prototype.hasOwnProperty.call(j,N)&&(Object.prototype.hasOwnProperty.call(T,N)?wt(T[N],j[N])||(T[N].type==="geojson"&&j[N].type==="geojson"&&Cn(T,j,N)?Ft(z,{command:"setGeoJSONSourceData",args:[N,j[N].data]}):an(N,j,z,B)):Kr(N,j,z))})(h.sources,c.sources,_,g);const C=[];h.layers&&h.layers.forEach(T=>{"source"in T&&g[T.source]?f.push({command:"removeLayer",args:[T.id]}):C.push(T)}),f=f.concat(_),function(T,j,z){j=j||[];const B=(T=T||[]).map(di),N=j.map(di),q=T.reduce(Pi,{}),Z=j.reduce(Pi,{}),re=B.slice(),se=Object.create(null);let ae,me,we,Ze,Ee;for(let Qe=0,ot=0;Qe<B.length;Qe++)ae=B[Qe],Object.prototype.hasOwnProperty.call(Z,ae)?ot++:(Ft(z,{command:"removeLayer",args:[ae]}),re.splice(re.indexOf(ae,ot),1));for(let Qe=0,ot=0;Qe<N.length;Qe++)ae=N[N.length-1-Qe],re[re.length-1-Qe]!==ae&&(Object.prototype.hasOwnProperty.call(q,ae)?(Ft(z,{command:"removeLayer",args:[ae]}),re.splice(re.lastIndexOf(ae,re.length-ot),1)):ot++,Ze=re[re.length-Qe],Ft(z,{command:"addLayer",args:[Z[ae],Ze]}),re.splice(re.length-Qe,0,ae),se[ae]=!0);for(let Qe=0;Qe<N.length;Qe++)if(ae=N[Qe],me=q[ae],we=Z[ae],!se[ae]&&!wt(me,we))if(wt(me.source,we.source)&&wt(me["source-layer"],we["source-layer"])&&wt(me.type,we.type)){for(Ee in xn(me.layout,we.layout,z,ae,null,"setLayoutProperty"),xn(me.paint,we.paint,z,ae,null,"setPaintProperty"),wt(me.filter,we.filter)||Ft(z,{command:"setFilter",args:[ae,we.filter]}),wt(me.minzoom,we.minzoom)&&wt(me.maxzoom,we.maxzoom)||Ft(z,{command:"setLayerZoomRange",args:[ae,we.minzoom,we.maxzoom]}),me)Object.prototype.hasOwnProperty.call(me,Ee)&&Ee!=="layout"&&Ee!=="paint"&&Ee!=="filter"&&Ee!=="metadata"&&Ee!=="minzoom"&&Ee!=="maxzoom"&&(Ee.indexOf("paint.")===0?xn(me[Ee],we[Ee],z,ae,Ee.slice(6),"setPaintProperty"):wt(me[Ee],we[Ee])||Ft(z,{command:"setLayerProperty",args:[ae,Ee,we[Ee]]}));for(Ee in we)Object.prototype.hasOwnProperty.call(we,Ee)&&!Object.prototype.hasOwnProperty.call(me,Ee)&&Ee!=="layout"&&Ee!=="paint"&&Ee!=="filter"&&Ee!=="metadata"&&Ee!=="minzoom"&&Ee!=="maxzoom"&&(Ee.indexOf("paint.")===0?xn(me[Ee],we[Ee],z,ae,Ee.slice(6),"setPaintProperty"):wt(me[Ee],we[Ee])||Ft(z,{command:"setLayerProperty",args:[ae,Ee,we[Ee]]}))}else Ft(z,{command:"removeLayer",args:[ae]}),Ze=re[re.lastIndexOf(ae)+1],Ft(z,{command:"addLayer",args:[we,Ze]})}(C,c.layers,f)}catch(g){console.warn("Unable to compute style diff:",g),f=[{command:"setStyle",args:[c]}]}return f},a.aD=function(h){const c=[],f=h.id;return f===void 0&&c.push({message:`layers.${f}: missing required property "id"`}),h.render===void 0&&c.push({message:`layers.${f}: missing required method "render"`}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&c.push({message:`layers.${f}: property "renderingMode" must be either "2d" or "3d"`}),c},a.aE=function h(c,f){if(Array.isArray(c)){if(!Array.isArray(f)||c.length!==f.length)return!1;for(let g=0;g<c.length;g++)if(!h(c[g],f[g]))return!1;return!0}if(typeof c=="object"&&c!==null&&f!==null){if(typeof f!="object"||Object.keys(c).length!==Object.keys(f).length)return!1;for(const g in c)if(!h(c[g],f[g]))return!1;return!0}return c===f},a.aF=ne,a.aG=oe,a.aH=class extends Xf{constructor(h,c){super(h,c),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},a.aI=b_,a.aJ=class extends Xf{constructor(h,c){super(h,c),this.current=$H}set(h){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let c=1;c<16;c++)if(h[c]!==this.current[c]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}},a.aK=CI,a.aL=TI,a.aM=ln,a.aN=class extends Xf{constructor(h,c){super(h,c),this.current=[0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2]))}},a.aO=class extends Xf{constructor(h,c){super(h,c),this.current=[0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1]))}},a.aP=function(h,c,f,g,_,C,T){var j=1/(c-f),z=1/(g-_),B=1/(C-T);return h[0]=-2*j,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*z,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*B,h[11]=0,h[12]=(c+f)*j,h[13]=(_+g)*z,h[14]=(T+C)*B,h[15]=1,h},a.aQ=HH,a.aR=class extends Fe{},a.aS=FG,a.aT=class extends Je{},a.aU=tT,a.aV=function(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},a.aW=NI,a.aX=Es,a.aY=Fa,a.aZ=class extends ar{},a.a_=function(h,c){return h[0]===c[0]&&h[1]===c[1]&&h[2]===c[2]&&h[3]===c[3]&&h[4]===c[4]&&h[5]===c[5]&&h[6]===c[6]&&h[7]===c[7]&&h[8]===c[8]&&h[9]===c[9]&&h[10]===c[10]&&h[11]===c[11]&&h[12]===c[12]&&h[13]===c[13]&&h[14]===c[14]&&h[15]===c[15]},a.aa=function(h){const c={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(f,g,_,C)=>{const T=_||C;return c[g]=!T||T.toLowerCase(),""}),c["max-age"]){const f=parseInt(c["max-age"],10);isNaN(f)?delete c["max-age"]:c["max-age"]=f}return c},a.ab=function(h,c){const f=[];for(const g in h)g in c||f.push(g);return f},a.ac=X,a.ad=function(h,c,f){var g=Math.sin(f),_=Math.cos(f),C=c[0],T=c[1],j=c[2],z=c[3],B=c[4],N=c[5],q=c[6],Z=c[7];return c!==h&&(h[8]=c[8],h[9]=c[9],h[10]=c[10],h[11]=c[11],h[12]=c[12],h[13]=c[13],h[14]=c[14],h[15]=c[15]),h[0]=C*_+B*g,h[1]=T*_+N*g,h[2]=j*_+q*g,h[3]=z*_+Z*g,h[4]=B*_-C*g,h[5]=N*_-T*g,h[6]=q*_-j*g,h[7]=Z*_-z*g,h},a.ae=function(h){var c=new sg(16);return c[0]=h[0],c[1]=h[1],c[2]=h[2],c[3]=h[3],c[4]=h[4],c[5]=h[5],c[6]=h[6],c[7]=h[7],c[8]=h[8],c[9]=h[9],c[10]=h[10],c[11]=h[11],c[12]=h[12],c[13]=h[13],c[14]=h[14],c[15]=h[15],c},a.af=k_,a.ag=function(h,c){let f=0,g=0;if(h.kind==="constant")g=h.layoutSize;else if(h.kind!=="source"){const{interpolationType:_,minZoom:C,maxZoom:T}=h,j=_?X(Os.interpolationFactor(_,c,C,T),0,1):0;h.kind==="camera"?g=Gi.number(h.minSize,h.maxSize,j):f=j}return{uSizeT:f,uSize:g}},a.ai=function(h,{uSize:c,uSizeT:f},{lowerSize:g,upperSize:_}){return h.kind==="source"?g/Dc:h.kind==="composite"?Gi.number(g/Dc,_/Dc,f):c},a.aj=yT,a.ak=function(h,c,f,g){const _=c.y-h.y,C=c.x-h.x,T=g.y-f.y,j=g.x-f.x,z=T*C-j*_;if(z===0)return null;const B=(j*(h.y-f.y)-T*(h.x-f.x))/z;return new v(h.x+B*C,h.y+B*_)},a.al=VR,a.am=AI,a.an=YC,a.ao=function(h){let c=1/0,f=1/0,g=-1/0,_=-1/0;for(const C of h)c=Math.min(c,C.x),f=Math.min(f,C.y),g=Math.max(g,C.x),_=Math.max(_,C.y);return[c,f,g,_]},a.ap=Fi,a.ar=gT,a.as=function(h,c){var f=c[0],g=c[1],_=c[2],C=c[3],T=c[4],j=c[5],z=c[6],B=c[7],N=c[8],q=c[9],Z=c[10],re=c[11],se=c[12],ae=c[13],me=c[14],we=c[15],Ze=f*j-g*T,Ee=f*z-_*T,Qe=f*B-C*T,ot=g*z-_*j,yt=g*B-C*j,Wt=_*B-C*z,xr=N*ae-q*se,$t=N*me-Z*se,Rt=N*we-re*se,dr=q*me-Z*ae,er=q*we-re*ae,Ht=Z*we-re*me,ht=Ze*Ht-Ee*er+Qe*dr+ot*Rt-yt*$t+Wt*xr;return ht?(h[0]=(j*Ht-z*er+B*dr)*(ht=1/ht),h[1]=(_*er-g*Ht-C*dr)*ht,h[2]=(ae*Wt-me*yt+we*ot)*ht,h[3]=(Z*yt-q*Wt-re*ot)*ht,h[4]=(z*Rt-T*Ht-B*$t)*ht,h[5]=(f*Ht-_*Rt+C*$t)*ht,h[6]=(me*Qe-se*Wt-we*Ee)*ht,h[7]=(N*Wt-Z*Qe+re*Ee)*ht,h[8]=(T*er-j*Rt+B*xr)*ht,h[9]=(g*Rt-f*er-C*xr)*ht,h[10]=(se*yt-ae*Qe+we*Ze)*ht,h[11]=(q*Qe-N*yt-re*Ze)*ht,h[12]=(j*$t-T*dr-z*xr)*ht,h[13]=(f*dr-g*$t+_*xr)*ht,h[14]=(ae*Ee-se*ot-me*Ze)*ht,h[15]=(N*ot-q*Ee+Z*Ze)*ht,h):null},a.at=CT,a.au=mT,a.av=TT,a.aw=function(){const h={},c=Te.$version;for(const f in Te.$root){const g=Te.$root[f];if(g.required){let _=null;_=f==="version"?c:g.type==="array"?[]:{},_!=null&&(h[f]=_)}}return h},a.ax=sx,a.ay=St,a.az=function(h){h=h.slice();const c=Object.create(null);for(let f=0;f<h.length;f++)c[h[f].id]=h[f];for(let f=0;f<h.length;f++)"ref"in h[f]&&(h[f]=Vt(h[f],c[h[f].ref]));return h},a.b=Be,a.b0=function(h,c){return h[0]=c[0],h[1]=c[1],h[2]=c[2],h[3]=c[3],h[4]=c[4],h[5]=c[5],h[6]=c[6],h[7]=c[7],h[8]=c[8],h[9]=c[9],h[10]=c[10],h[11]=c[11],h[12]=c[12],h[13]=c[13],h[14]=c[14],h[15]=c[15],h},a.b1=function(h,c,f){return h[0]=c[0]*f[0],h[1]=c[1]*f[1],h[2]=c[2]*f[2],h[3]=c[3]*f[3],h},a.b2=function(h,c){return h[0]*c[0]+h[1]*c[1]+h[2]*c[2]+h[3]*c[3]},a.b3=ee,a.b4=RR,a.b5=MR,a.b6=function(h,c,f,g,_){var C,T=1/Math.tan(c/2);return h[0]=T/f,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=T,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,_!=null&&_!==1/0?(h[10]=(_+g)*(C=1/(g-_)),h[14]=2*_*g*C):(h[10]=-1,h[14]=-2*g),h},a.b7=function(h,c,f){var g=Math.sin(f),_=Math.cos(f),C=c[4],T=c[5],j=c[6],z=c[7],B=c[8],N=c[9],q=c[10],Z=c[11];return c!==h&&(h[0]=c[0],h[1]=c[1],h[2]=c[2],h[3]=c[3],h[12]=c[12],h[13]=c[13],h[14]=c[14],h[15]=c[15]),h[4]=C*_+B*g,h[5]=T*_+N*g,h[6]=j*_+q*g,h[7]=z*_+Z*g,h[8]=B*_-C*g,h[9]=N*_-T*g,h[10]=q*_-j*g,h[11]=Z*_-z*g,h},a.b8=D,a.b9=U,a.bA=aR,a.bB=function(h){return h.message===Oe},a.bC=$h,a.bD=zo,a.ba=function(h){return h*Math.PI/180},a.bb=function(h,c){const{x:f,y:g}=Cx.fromLngLat(c);return!(h<0||h>25||g<0||g>=1||f<0||f>=1)},a.bc=function(h,c){return h[0]=c[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=c[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=c[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},a.bd=class extends V{},a.be=_T,a.bf=bX,a.bh=Ke,a.bi=function(h,c){st.REGISTERED_PROTOCOLS[h]=c},a.bj=function(h){delete st.REGISTERED_PROTOCOLS[h]},a.bk=function(h,c){const f={};for(let _=0;_<h.length;_++){const C=c&&c[h[_].id]||l_(h[_]);c&&(c[h[_].id]=C);let T=f[C];T||(T=f[C]=[]),T.push(h[_])}const g=[];for(const _ in f)g.push(f[_]);return g},a.bl=Kt,a.bm=LR,a.bn=BR,a.bo=gR,a.bp=function(h){h.bucket.createArrays(),h.bucket.tilePixelRatio=Ei/(512*h.bucket.overscaling),h.bucket.compareText={},h.bucket.iconsNeedLinear=!1;const c=h.bucket.layers[0],f=c.layout,g=c._unevaluatedLayout._values,_={layoutIconSize:g["icon-size"].possiblyEvaluate(new qn(h.bucket.zoom+1),h.canonical),layoutTextSize:g["text-size"].possiblyEvaluate(new qn(h.bucket.zoom+1),h.canonical),textMaxSize:g["text-size"].possiblyEvaluate(new qn(18))};if(h.bucket.textSizeData.kind==="composite"){const{minZoom:B,maxZoom:N}=h.bucket.textSizeData;_.compositeTextSizes=[g["text-size"].possiblyEvaluate(new qn(B),h.canonical),g["text-size"].possiblyEvaluate(new qn(N),h.canonical)]}if(h.bucket.iconSizeData.kind==="composite"){const{minZoom:B,maxZoom:N}=h.bucket.iconSizeData;_.compositeIconSizes=[g["icon-size"].possiblyEvaluate(new qn(B),h.canonical),g["icon-size"].possiblyEvaluate(new qn(N),h.canonical)]}const C=f.get("text-line-height")*Fi,T=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point",j=f.get("text-keep-upright"),z=f.get("text-size");for(const B of h.bucket.features){const N=f.get("text-font").evaluate(B,{},h.canonical).join(","),q=z.evaluate(B,{},h.canonical),Z=_.layoutTextSize.evaluate(B,{},h.canonical),re=_.layoutIconSize.evaluate(B,{},h.canonical),se={horizontal:{},vertical:void 0},ae=B.text;let me,we=[0,0];if(ae){const Qe=ae.toString(),ot=f.get("text-letter-spacing").evaluate(B,{},h.canonical)*Fi,yt=NC(Qe)?ot:0,Wt=f.get("text-anchor").evaluate(B,{},h.canonical),xr=ZR(c,B,h.canonical);if(!xr){const er=f.get("text-radial-offset").evaluate(B,{},h.canonical);we=er?KR(Wt,[er*Fi,kT]):f.get("text-offset").evaluate(B,{},h.canonical).map(Ht=>Ht*Fi)}let $t=T?"center":f.get("text-justify").evaluate(B,{},h.canonical);const Rt=f.get("symbol-placement")==="point"?f.get("text-max-width").evaluate(B,{},h.canonical)*Fi:1/0,dr=()=>{h.bucket.allowVerticalPlacement&&ox(Qe)&&(se.vertical=A_(ae,h.glyphMap,h.glyphPositions,h.imagePositions,N,Rt,C,Wt,"left",yt,we,a.ah.vertical,!0,Z,q))};if(!T&&xr){const er=new Set;if($t==="auto")for(let ht=0;ht<xr.values.length;ht+=2)er.add(CT(xr.values[ht]));else er.add($t);let Ht=!1;for(const ht of er)if(!se.horizontal[ht])if(Ht)se.horizontal[ht]=se.horizontal[0];else{const fr=A_(ae,h.glyphMap,h.glyphPositions,h.imagePositions,N,Rt,C,"center",ht,yt,we,a.ah.horizontal,!1,Z,q);fr&&(se.horizontal[ht]=fr,Ht=fr.positionedLines.length===1)}dr()}else{$t==="auto"&&($t=CT(Wt));const er=A_(ae,h.glyphMap,h.glyphPositions,h.imagePositions,N,Rt,C,Wt,$t,yt,we,a.ah.horizontal,!1,Z,q);er&&(se.horizontal[$t]=er),dr(),ox(Qe)&&T&&j&&(se.vertical=A_(ae,h.glyphMap,h.glyphPositions,h.imagePositions,N,Rt,C,Wt,$t,yt,we,a.ah.vertical,!1,Z,q))}}let Ze=!1;if(B.icon&&B.icon.name){const Qe=h.imageMap[B.icon.name];Qe&&(me=rX(h.imagePositions[B.icon.name],f.get("icon-offset").evaluate(B,{},h.canonical),f.get("icon-anchor").evaluate(B,{},h.canonical)),Ze=!!Qe.sdf,h.bucket.sdfIcons===void 0?h.bucket.sdfIcons=Ze:h.bucket.sdfIcons!==Ze&&Ae("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Qe.pixelRatio!==h.bucket.pixelRatio||f.get("icon-rotate").constantOr(1)!==0)&&(h.bucket.iconsNeedLinear=!0))}const Ee=JR(se.horizontal)||se.vertical;h.bucket.iconsInText=!!Ee&&Ee.iconsInText,(Ee||me)&&xX(h.bucket,B,se,me,h.imageMap,_,Z,re,we,Ze,h.canonical)}h.showCollisionBoxes&&h.bucket.generateCollisionDebugBuffers()},a.bq=cT,a.br=oT,a.bs=lT,a.bt=rd,a.bu=hT,a.bv=class{constructor(h){this._marks={start:[h.url,"start"].join("#"),end:[h.url,"end"].join("#"),measure:h.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let h=performance.getEntriesByName(this._marks.measure);return h.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),h=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),h}},a.bw=function(h,c,f,g,_){return o(this,void 0,void 0,function*(){if(F())try{return yield Ge(h,c,f,g,_)}catch{}return function(C,T,j,z,B){const N=C.width,q=C.height;De&&Le||(De=new OffscreenCanvas(N,q),Le=De.getContext("2d",{willReadFrequently:!0})),De.width=N,De.height=q,Le.drawImage(C,0,0,N,q);const Z=Le.getImageData(T,j,z,B);return Le.clearRect(0,0,N,q),Z.data}(h,c,f,g,_)})},a.bx=DR,a.by=d,a.bz=m,a.c=Ie,a.d=h=>o(void 0,void 0,void 0,function*(){if(h.byteLength===0)return createImageBitmap(new ImageData(1,1));const c=new Blob([new Uint8Array(h)],{type:"image/png"});try{return createImageBitmap(c)}catch(f){throw new Error(`Could not load image because of ${f.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),a.e=K,a.f=h=>new Promise((c,f)=>{const g=new Image;g.onload=()=>{c(g),URL.revokeObjectURL(g.src),g.onload=null,window.requestAnimationFrame(()=>{g.src=Me})},g.onerror=()=>f(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _=new Blob([new Uint8Array(h)],{type:"image/png"});g.src=h.byteLength?URL.createObjectURL(_):Me}),a.g=Re,a.h=(h,c)=>Mt(K(h,{type:"json"}),c),a.i=Ye,a.j=_t,a.k=Yt,a.l=(h,c)=>Mt(K(h,{type:"arrayBuffer"}),c),a.m=Mt,a.n=function(h){return new hT(h).readFields(XG,[])},a.o=mx,a.p=mR,a.q=k,a.r=BC,a.s=Et,a.t=nx,a.u=Fu,a.v=Te,a.w=Ae,a.x=function([h,c,f]){return c+=90,c*=Math.PI/180,f*=Math.PI/180,{x:h*Math.cos(c)*Math.sin(f),y:h*Math.sin(c)*Math.sin(f),z:h*Math.cos(f)}},a.y=Gi,a.z=qn}),i("worker",["./shared"],function(a){class o{constructor(W){this.keyCache={},W&&this.replace(W)}replace(W){this._layerConfigs={},this._layers={},this.update(W,[])}update(W,Q){for(const de of W){this._layerConfigs[de.id]=de;const be=this._layers[de.id]=a.aA(de);be._featureFilter=a.a7(be.filter),this.keyCache[de.id]&&delete this.keyCache[de.id]}for(const de of Q)delete this.keyCache[de],delete this._layerConfigs[de],delete this._layers[de];this.familiesBySource={};const te=a.bk(Object.values(this._layerConfigs),this.keyCache);for(const de of te){const be=de.map(ve=>this._layers[ve.id]),ke=be[0];if(ke.visibility==="none")continue;const $e=ke.source||"";let _e=this.familiesBySource[$e];_e||(_e=this.familiesBySource[$e]={});const nt=ke.sourceLayer||"_geojsonTileLayer";let dt=_e[nt];dt||(dt=_e[nt]=[]),dt.push(be)}}}class d{constructor(W){const Q={},te=[];for(const $e in W){const _e=W[$e],nt=Q[$e]={};for(const dt in _e){const ve=_e[+dt];if(!ve||ve.bitmap.width===0||ve.bitmap.height===0)continue;const ut={x:0,y:0,w:ve.bitmap.width+2,h:ve.bitmap.height+2};te.push(ut),nt[dt]={rect:ut,metrics:ve.metrics}}}const{w:de,h:be}=a.p(te),ke=new a.o({width:de||1,height:be||1});for(const $e in W){const _e=W[$e];for(const nt in _e){const dt=_e[+nt];if(!dt||dt.bitmap.width===0||dt.bitmap.height===0)continue;const ve=Q[$e][nt].rect;a.o.copy(dt.bitmap,ke,{x:0,y:0},{x:ve.x+1,y:ve.y+1},dt.bitmap)}}this.image=ke,this.positions=Q}}a.bl("GlyphAtlas",d);class m{constructor(W){this.tileID=new a.S(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId,this.inFlightDependencies=[]}parse(W,Q,te,de){return a._(this,void 0,void 0,function*(){this.status="parsing",this.data=W,this.collisionBoxArray=new a.a5;const be=new a.bm(Object.keys(W.layers).sort()),ke=new a.bn(this.tileID,this.promoteId);ke.bucketLayerIDs=[];const $e={},_e={featureIndex:ke,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:te},nt=Q.familiesBySource[this.source];for(const Br in nt){const mn=W.layers[Br];if(!mn)continue;mn.version===1&&a.w(`Vector tile source "${this.source}" layer "${Br}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Bn=be.encode(Br),Ai=[];for(let wi=0;wi<mn.length;wi++){const us=mn.feature(wi),Ma=ke.getId(us,Br);Ai.push({feature:us,id:Ma,index:wi,sourceLayerIndex:Bn})}for(const wi of nt[Br]){const us=wi[0];us.source!==this.source&&a.w(`layer.source = ${us.source} does not equal this.source = ${this.source}`),us.minzoom&&this.zoom<Math.floor(us.minzoom)||us.maxzoom&&this.zoom>=us.maxzoom||us.visibility!=="none"&&(y(wi,this.zoom,te),($e[us.id]=us.createBucket({index:ke.bucketLayerIDs.length,layers:wi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Bn,sourceID:this.source})).populate(Ai,_e,this.tileID.canonical),ke.bucketLayerIDs.push(wi.map(Ma=>Ma.id)))}}const dt=a.aF(_e.glyphDependencies,Br=>Object.keys(Br).map(Number));this.inFlightDependencies.forEach(Br=>Br==null?void 0:Br.abort()),this.inFlightDependencies=[];let ve=Promise.resolve({});if(Object.keys(dt).length){const Br=new AbortController;this.inFlightDependencies.push(Br),ve=de.sendAsync({type:"GG",data:{stacks:dt,source:this.source,tileID:this.tileID,type:"glyphs"}},Br)}const ut=Object.keys(_e.iconDependencies);let Dt=Promise.resolve({});if(ut.length){const Br=new AbortController;this.inFlightDependencies.push(Br),Dt=de.sendAsync({type:"GI",data:{icons:ut,source:this.source,tileID:this.tileID,type:"icons"}},Br)}const nr=Object.keys(_e.patternDependencies);let Ur=Promise.resolve({});if(nr.length){const Br=new AbortController;this.inFlightDependencies.push(Br),Ur=de.sendAsync({type:"GI",data:{icons:nr,source:this.source,tileID:this.tileID,type:"patterns"}},Br)}const[Ir,en,Fr]=yield Promise.all([ve,Dt,Ur]),fi=new d(Ir),Yn=new a.bo(en,Fr);for(const Br in $e){const mn=$e[Br];mn instanceof a.a6?(y(mn.layers,this.zoom,te),a.bp({bucket:mn,glyphMap:Ir,glyphPositions:fi.positions,imageMap:en,imagePositions:Yn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):mn.hasPattern&&(mn instanceof a.bq||mn instanceof a.br||mn instanceof a.bs)&&(y(mn.layers,this.zoom,te),mn.addFeatures(_e,this.tileID.canonical,Yn.patternPositions))}return this.status="done",{buckets:Object.values($e).filter(Br=>!Br.isEmpty()),featureIndex:ke,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:fi.image,imageAtlas:Yn,glyphMap:this.returnDependencies?Ir:null,iconMap:this.returnDependencies?en:null,glyphPositions:this.returnDependencies?fi.positions:null}})}}function y(ge,W,Q){const te=new a.z(W);for(const de of ge)de.recalculate(te,Q)}class v{constructor(W,Q,te){this.actor=W,this.layerIndex=Q,this.availableImages=te,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(W,Q){return a._(this,void 0,void 0,function*(){const te=yield a.l(W.request,Q);try{return{vectorTile:new a.bt.VectorTile(new a.bu(te.data)),rawData:te.data,cacheControl:te.cacheControl,expires:te.expires}}catch(de){const be=new Uint8Array(te.data);let ke=`Unable to parse the tile at ${W.request.url}, `;throw ke+=be[0]===31&&be[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${de.message}`,new Error(ke)}})}loadTile(W){return a._(this,void 0,void 0,function*(){const Q=W.uid,te=!!(W&&W.request&&W.request.collectResourceTiming)&&new a.bv(W.request),de=new m(W);this.loading[Q]=de;const be=new AbortController;de.abort=be;try{const ke=yield this.loadVectorTile(W,be);if(delete this.loading[Q],!ke)return null;const $e=ke.rawData,_e={};ke.expires&&(_e.expires=ke.expires),ke.cacheControl&&(_e.cacheControl=ke.cacheControl);const nt={};if(te){const ve=te.finish();ve&&(nt.resourceTiming=JSON.parse(JSON.stringify(ve)))}de.vectorTile=ke.vectorTile;const dt=de.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[Q]=de,this.fetching[Q]={rawTileData:$e,cacheControl:_e,resourceTiming:nt};try{const ve=yield dt;return a.e({rawTileData:$e.slice(0)},ve,_e,nt)}finally{delete this.fetching[Q]}}catch(ke){throw delete this.loading[Q],de.status="done",this.loaded[Q]=de,ke}})}reloadTile(W){return a._(this,void 0,void 0,function*(){const Q=W.uid;if(!this.loaded||!this.loaded[Q])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const te=this.loaded[Q];if(te.showCollisionBoxes=W.showCollisionBoxes,te.status==="parsing"){const de=yield te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor);let be;if(this.fetching[Q]){const{rawTileData:ke,cacheControl:$e,resourceTiming:_e}=this.fetching[Q];delete this.fetching[Q],be=a.e({rawTileData:ke.slice(0)},de,$e,_e)}else be=de;return be}if(te.status==="done"&&te.vectorTile)return te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(W){return a._(this,void 0,void 0,function*(){const Q=this.loading,te=W.uid;Q&&Q[te]&&Q[te].abort&&(Q[te].abort.abort(),delete Q[te])})}removeTile(W){return a._(this,void 0,void 0,function*(){this.loaded&&this.loaded[W.uid]&&delete this.loaded[W.uid]})}}class w{constructor(){this.loaded={}}loadTile(W){return a._(this,void 0,void 0,function*(){const{uid:Q,encoding:te,rawImageData:de,redFactor:be,greenFactor:ke,blueFactor:$e,baseShift:_e}=W,nt=de.width+2,dt=de.height+2,ve=a.b(de)?new a.R({width:nt,height:dt},yield a.bw(de,-1,-1,nt,dt)):de,ut=new a.bx(Q,ve,te,be,ke,$e,_e);return this.loaded=this.loaded||{},this.loaded[Q]=ut,ut})}removeTile(W){const Q=this.loaded,te=W.uid;Q&&Q[te]&&delete Q[te]}}function O(ge,W){if(ge.length!==0){P(ge[0],W);for(var Q=1;Q<ge.length;Q++)P(ge[Q],!W)}}function P(ge,W){for(var Q=0,te=0,de=0,be=ge.length,ke=be-1;de<be;ke=de++){var $e=(ge[de][0]-ge[ke][0])*(ge[ke][1]+ge[de][1]),_e=Q+$e;te+=Math.abs(Q)>=Math.abs($e)?Q-_e+$e:$e-_e+Q,Q=_e}Q+te>=0!=!!W&&ge.reverse()}var E=a.by(function ge(W,Q){var te,de=W&&W.type;if(de==="FeatureCollection")for(te=0;te<W.features.length;te++)ge(W.features[te],Q);else if(de==="GeometryCollection")for(te=0;te<W.geometries.length;te++)ge(W.geometries[te],Q);else if(de==="Feature")ge(W.geometry,Q);else if(de==="Polygon")O(W.coordinates,Q);else if(de==="MultiPolygon")for(te=0;te<W.coordinates.length;te++)O(W.coordinates[te],Q);return W});const $=a.bt.VectorTileFeature.prototype.toGeoJSON;var R={exports:{}},F=a.bz,D=a.bt.VectorTileFeature,U=X;function X(ge,W){this.options=W||{},this.features=ge,this.length=ge.length}function ee(ge,W){this.id=typeof ge.id=="number"?ge.id:void 0,this.type=ge.type,this.rawGeometry=ge.type===1?[ge.geometry]:ge.geometry,this.properties=ge.tags,this.extent=W||4096}X.prototype.feature=function(ge){return new ee(this.features[ge],this.options.extent)},ee.prototype.loadGeometry=function(){var ge=this.rawGeometry;this.geometry=[];for(var W=0;W<ge.length;W++){for(var Q=ge[W],te=[],de=0;de<Q.length;de++)te.push(new F(Q[de][0],Q[de][1]));this.geometry.push(te)}return this.geometry},ee.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ge=this.geometry,W=1/0,Q=-1/0,te=1/0,de=-1/0,be=0;be<ge.length;be++)for(var ke=ge[be],$e=0;$e<ke.length;$e++){var _e=ke[$e];W=Math.min(W,_e.x),Q=Math.max(Q,_e.x),te=Math.min(te,_e.y),de=Math.max(de,_e.y)}return[W,te,Q,de]},ee.prototype.toGeoJSON=D.prototype.toGeoJSON;var K=a.bA,Y=U;function ne(ge){var W=new K;return function(Q,te){for(var de in Q.layers)te.writeMessage(3,oe,Q.layers[de])}(ge,W),W.finish()}function oe(ge,W){var Q;W.writeVarintField(15,ge.version||1),W.writeStringField(1,ge.name||""),W.writeVarintField(5,ge.extent||4096);var te={keys:[],values:[],keycache:{},valuecache:{}};for(Q=0;Q<ge.length;Q++)te.feature=ge.feature(Q),W.writeMessage(2,ce,te);var de=te.keys;for(Q=0;Q<de.length;Q++)W.writeStringField(3,de[Q]);var be=te.values;for(Q=0;Q<be.length;Q++)W.writeMessage(4,tt,be[Q])}function ce(ge,W){var Q=ge.feature;Q.id!==void 0&&W.writeVarintField(1,Q.id),W.writeMessage(2,Xe,ge),W.writeVarintField(3,Q.type),W.writeMessage(4,Ye,Q)}function Xe(ge,W){var Q=ge.feature,te=ge.keys,de=ge.values,be=ge.keycache,ke=ge.valuecache;for(var $e in Q.properties){var _e=Q.properties[$e],nt=be[$e];if(_e!==null){nt===void 0&&(te.push($e),be[$e]=nt=te.length-1),W.writeVarint(nt);var dt=typeof _e;dt!=="string"&&dt!=="boolean"&&dt!=="number"&&(_e=JSON.stringify(_e));var ve=dt+":"+_e,ut=ke[ve];ut===void 0&&(de.push(_e),ke[ve]=ut=de.length-1),W.writeVarint(ut)}}}function Ae(ge,W){return(W<<3)+(7&ge)}function We(ge){return ge<<1^ge>>31}function Ye(ge,W){for(var Q=ge.loadGeometry(),te=ge.type,de=0,be=0,ke=Q.length,$e=0;$e<ke;$e++){var _e=Q[$e],nt=1;te===1&&(nt=_e.length),W.writeVarint(Ae(1,nt));for(var dt=te===3?_e.length-1:_e.length,ve=0;ve<dt;ve++){ve===1&&te!==1&&W.writeVarint(Ae(2,dt-1));var ut=_e[ve].x-de,Dt=_e[ve].y-be;W.writeVarint(We(ut)),W.writeVarint(We(Dt)),de+=ut,be+=Dt}te===3&&W.writeVarint(Ae(7,1))}}function tt(ge,W){var Q=typeof ge;Q==="string"?W.writeStringField(1,ge):Q==="boolean"?W.writeBooleanField(7,ge):Q==="number"&&(ge%1!=0?W.writeDoubleField(3,ge):ge<0?W.writeSVarintField(6,ge):W.writeVarintField(5,ge))}R.exports=ne,R.exports.fromVectorTileJs=ne,R.exports.fromGeojsonVt=function(ge,W){W=W||{};var Q={};for(var te in ge)Q[te]=new Y(ge[te].features,W),Q[te].name=te,Q[te].version=W.version,Q[te].extent=W.extent;return ne({layers:Q})},R.exports.GeoJSONWrapper=Y;var Be=a.by(R.exports);const Me={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ge=>ge},Ge=Math.fround||(De=new Float32Array(1),ge=>(De[0]=+ge,De[0]));var De;const Le=3,Oe=5,Ie=6;class st{constructor(W){this.options=Object.assign(Object.create(Me),W),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(W){const{log:Q,minZoom:te,maxZoom:de}=this.options;Q&&console.time("total time");const be=`prepare ${W.length} points`;Q&&console.time(be),this.points=W;const ke=[];for(let _e=0;_e<W.length;_e++){const nt=W[_e];if(!nt.geometry)continue;const[dt,ve]=nt.geometry.coordinates,ut=Ge(Ke(dt)),Dt=Ge(St(ve));ke.push(ut,Dt,1/0,_e,-1,1),this.options.reduce&&ke.push(0)}let $e=this.trees[de+1]=this._createTree(ke);Q&&console.timeEnd(be);for(let _e=de;_e>=te;_e--){const nt=+Date.now();$e=this.trees[_e]=this._createTree(this._cluster($e,_e)),Q&&console.log("z%d: %d clusters in %dms",_e,$e.numItems,+Date.now()-nt)}return Q&&console.timeEnd("total time"),this}getClusters(W,Q){let te=((W[0]+180)%360+360)%360-180;const de=Math.max(-90,Math.min(90,W[1]));let be=W[2]===180?180:((W[2]+180)%360+360)%360-180;const ke=Math.max(-90,Math.min(90,W[3]));if(W[2]-W[0]>=360)te=-180,be=180;else if(te>be){const ve=this.getClusters([te,de,180,ke],Q),ut=this.getClusters([-180,de,be,ke],Q);return ve.concat(ut)}const $e=this.trees[this._limitZoom(Q)],_e=$e.range(Ke(te),St(ke),Ke(be),St(de)),nt=$e.data,dt=[];for(const ve of _e){const ut=this.stride*ve;dt.push(nt[ut+Oe]>1?Re(nt,ut,this.clusterProps):this.points[nt[ut+Le]])}return dt}getChildren(W){const Q=this._getOriginId(W),te=this._getOriginZoom(W),de="No cluster with the specified id.",be=this.trees[te];if(!be)throw new Error(de);const ke=be.data;if(Q*this.stride>=ke.length)throw new Error(de);const $e=this.options.radius/(this.options.extent*Math.pow(2,te-1)),_e=be.within(ke[Q*this.stride],ke[Q*this.stride+1],$e),nt=[];for(const dt of _e){const ve=dt*this.stride;ke[ve+4]===W&&nt.push(ke[ve+Oe]>1?Re(ke,ve,this.clusterProps):this.points[ke[ve+Le]])}if(nt.length===0)throw new Error(de);return nt}getLeaves(W,Q,te){const de=[];return this._appendLeaves(de,W,Q=Q||10,te=te||0,0),de}getTile(W,Q,te){const de=this.trees[this._limitZoom(W)],be=Math.pow(2,W),{extent:ke,radius:$e}=this.options,_e=$e/ke,nt=(te-_e)/be,dt=(te+1+_e)/be,ve={features:[]};return this._addTileFeatures(de.range((Q-_e)/be,nt,(Q+1+_e)/be,dt),de.data,Q,te,be,ve),Q===0&&this._addTileFeatures(de.range(1-_e/be,nt,1,dt),de.data,be,te,be,ve),Q===be-1&&this._addTileFeatures(de.range(0,nt,_e/be,dt),de.data,-1,te,be,ve),ve.features.length?ve:null}getClusterExpansionZoom(W){let Q=this._getOriginZoom(W)-1;for(;Q<=this.options.maxZoom;){const te=this.getChildren(W);if(Q++,te.length!==1)break;W=te[0].properties.cluster_id}return Q}_appendLeaves(W,Q,te,de,be){const ke=this.getChildren(Q);for(const $e of ke){const _e=$e.properties;if(_e&&_e.cluster?be+_e.point_count<=de?be+=_e.point_count:be=this._appendLeaves(W,_e.cluster_id,te,de,be):be<de?be++:W.push($e),W.length===te)break}return be}_createTree(W){const Q=new a.av(W.length/this.stride|0,this.options.nodeSize,Float32Array);for(let te=0;te<W.length;te+=this.stride)Q.add(W[te],W[te+1]);return Q.finish(),Q.data=W,Q}_addTileFeatures(W,Q,te,de,be,ke){for(const $e of W){const _e=$e*this.stride,nt=Q[_e+Oe]>1;let dt,ve,ut;if(nt)dt=it(Q,_e,this.clusterProps),ve=Q[_e],ut=Q[_e+1];else{const Ur=this.points[Q[_e+Le]];dt=Ur.properties;const[Ir,en]=Ur.geometry.coordinates;ve=Ke(Ir),ut=St(en)}const Dt={type:1,geometry:[[Math.round(this.options.extent*(ve*be-te)),Math.round(this.options.extent*(ut*be-de))]],tags:dt};let nr;nr=nt||this.options.generateId?Q[_e+Le]:this.points[Q[_e+Le]].id,nr!==void 0&&(Dt.id=nr),ke.features.push(Dt)}}_limitZoom(W){return Math.max(this.options.minZoom,Math.min(Math.floor(+W),this.options.maxZoom+1))}_cluster(W,Q){const{radius:te,extent:de,reduce:be,minPoints:ke}=this.options,$e=te/(de*Math.pow(2,Q)),_e=W.data,nt=[],dt=this.stride;for(let ve=0;ve<_e.length;ve+=dt){if(_e[ve+2]<=Q)continue;_e[ve+2]=Q;const ut=_e[ve],Dt=_e[ve+1],nr=W.within(_e[ve],_e[ve+1],$e),Ur=_e[ve+Oe];let Ir=Ur;for(const en of nr){const Fr=en*dt;_e[Fr+2]>Q&&(Ir+=_e[Fr+Oe])}if(Ir>Ur&&Ir>=ke){let en,Fr=ut*Ur,fi=Dt*Ur,Yn=-1;const Br=((ve/dt|0)<<5)+(Q+1)+this.points.length;for(const mn of nr){const Bn=mn*dt;if(_e[Bn+2]<=Q)continue;_e[Bn+2]=Q;const Ai=_e[Bn+Oe];Fr+=_e[Bn]*Ai,fi+=_e[Bn+1]*Ai,_e[Bn+4]=Br,be&&(en||(en=this._map(_e,ve,!0),Yn=this.clusterProps.length,this.clusterProps.push(en)),be(en,this._map(_e,Bn)))}_e[ve+4]=Br,nt.push(Fr/Ir,fi/Ir,1/0,Br,-1,Ir),be&&nt.push(Yn)}else{for(let en=0;en<dt;en++)nt.push(_e[ve+en]);if(Ir>1)for(const en of nr){const Fr=en*dt;if(!(_e[Fr+2]<=Q)){_e[Fr+2]=Q;for(let fi=0;fi<dt;fi++)nt.push(_e[Fr+fi])}}}}return nt}_getOriginId(W){return W-this.points.length>>5}_getOriginZoom(W){return(W-this.points.length)%32}_map(W,Q,te){if(W[Q+Oe]>1){const ke=this.clusterProps[W[Q+Ie]];return te?Object.assign({},ke):ke}const de=this.points[W[Q+Le]].properties,be=this.options.map(de);return te&&be===de?Object.assign({},be):be}}function Re(ge,W,Q){return{type:"Feature",id:ge[W+Le],properties:it(ge,W,Q),geometry:{type:"Point",coordinates:[(te=ge[W],360*(te-.5)),Mt(ge[W+1])]}};var te}function it(ge,W,Q){const te=ge[W+Oe],de=te>=1e4?`${Math.round(te/1e3)}k`:te>=1e3?Math.round(te/100)/10+"k":te,be=ge[W+Ie],ke=be===-1?{}:Object.assign({},Q[be]);return Object.assign(ke,{cluster:!0,cluster_id:ge[W+Le],point_count:te,point_count_abbreviated:de})}function Ke(ge){return ge/360+.5}function St(ge){const W=Math.sin(ge*Math.PI/180),Q=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return Q<0?0:Q>1?1:Q}function Mt(ge){const W=(180-360*ge)*Math.PI/180;return 360*Math.atan(Math.exp(W))/Math.PI-90}function Et(ge,W,Q,te){let de=te;const be=W+(Q-W>>1);let ke,$e=Q-W;const _e=ge[W],nt=ge[W+1],dt=ge[Q],ve=ge[Q+1];for(let ut=W+3;ut<Q;ut+=3){const Dt=xt(ge[ut],ge[ut+1],_e,nt,dt,ve);if(Dt>de)ke=ut,de=Dt;else if(Dt===de){const nr=Math.abs(ut-be);nr<$e&&(ke=ut,$e=nr)}}de>te&&(ke-W>3&&Et(ge,W,ke,te),ge[ke+2]=de,Q-ke>3&&Et(ge,ke,Q,te))}function xt(ge,W,Q,te,de,be){let ke=de-Q,$e=be-te;if(ke!==0||$e!==0){const _e=((ge-Q)*ke+(W-te)*$e)/(ke*ke+$e*$e);_e>1?(Q=de,te=be):_e>0&&(Q+=ke*_e,te+=$e*_e)}return ke=ge-Q,$e=W-te,ke*ke+$e*$e}function et(ge,W,Q,te){const de={id:ge??null,type:W,geometry:Q,tags:te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(W==="Point"||W==="MultiPoint"||W==="LineString")Yt(de,Q);else if(W==="Polygon")Yt(de,Q[0]);else if(W==="MultiLineString")for(const be of Q)Yt(de,be);else if(W==="MultiPolygon")for(const be of Q)Yt(de,be[0]);return de}function Yt(ge,W){for(let Q=0;Q<W.length;Q+=3)ge.minX=Math.min(ge.minX,W[Q]),ge.minY=Math.min(ge.minY,W[Q+1]),ge.maxX=Math.max(ge.maxX,W[Q]),ge.maxY=Math.max(ge.maxY,W[Q+1])}function _t(ge,W,Q,te){if(!W.geometry)return;const de=W.geometry.coordinates;if(de&&de.length===0)return;const be=W.geometry.type,ke=Math.pow(Q.tolerance/((1<<Q.maxZoom)*Q.extent),2);let $e=[],_e=W.id;if(Q.promoteId?_e=W.properties[Q.promoteId]:Q.generateId&&(_e=te||0),be==="Point")rt(de,$e);else if(be==="MultiPoint")for(const nt of de)rt(nt,$e);else if(be==="LineString")Te(de,$e,ke,!1);else if(be==="MultiLineString"){if(Q.lineMetrics){for(const nt of de)$e=[],Te(nt,$e,ke,!1),ge.push(et(_e,"LineString",$e,W.properties));return}ct(de,$e,ke,!1)}else if(be==="Polygon")ct(de,$e,ke,!0);else{if(be!=="MultiPolygon"){if(be==="GeometryCollection"){for(const nt of W.geometry.geometries)_t(ge,{id:_e,geometry:nt,properties:W.properties},Q,te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const nt of de){const dt=[];ct(nt,dt,ke,!0),$e.push(dt)}}ge.push(et(_e,be,$e,W.properties))}function rt(ge,W){W.push(Vt(ge[0]),wt(ge[1]),0)}function Te(ge,W,Q,te){let de,be,ke=0;for(let _e=0;_e<ge.length;_e++){const nt=Vt(ge[_e][0]),dt=wt(ge[_e][1]);W.push(nt,dt,0),_e>0&&(ke+=te?(de*dt-nt*be)/2:Math.sqrt(Math.pow(nt-de,2)+Math.pow(dt-be,2))),de=nt,be=dt}const $e=W.length-3;W[2]=1,Et(W,0,$e,Q),W[$e+2]=1,W.size=Math.abs(ke),W.start=0,W.end=W.size}function ct(ge,W,Q,te){for(let de=0;de<ge.length;de++){const be=[];Te(ge[de],be,Q,te),W.push(be)}}function Vt(ge){return ge/360+.5}function wt(ge){const W=Math.sin(ge*Math.PI/180),Q=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return Q<0?0:Q>1?1:Q}function Ft(ge,W,Q,te,de,be,ke,$e){if(te/=W,be>=(Q/=W)&&ke<te)return ge;if(ke<Q||be>=te)return null;const _e=[];for(const nt of ge){const dt=nt.geometry;let ve=nt.type;const ut=de===0?nt.minX:nt.minY,Dt=de===0?nt.maxX:nt.maxY;if(ut>=Q&&Dt<te){_e.push(nt);continue}if(Dt<Q||ut>=te)continue;let nr=[];if(ve==="Point"||ve==="MultiPoint")Kr(dt,nr,Q,te,de);else if(ve==="LineString")yn(dt,nr,Q,te,de,!1,$e.lineMetrics);else if(ve==="MultiLineString")Cn(dt,nr,Q,te,de,!1);else if(ve==="Polygon")Cn(dt,nr,Q,te,de,!0);else if(ve==="MultiPolygon")for(const Ur of dt){const Ir=[];Cn(Ur,Ir,Q,te,de,!0),Ir.length&&nr.push(Ir)}if(nr.length){if($e.lineMetrics&&ve==="LineString"){for(const Ur of nr)_e.push(et(nt.id,ve,Ur,nt.tags));continue}ve!=="LineString"&&ve!=="MultiLineString"||(nr.length===1?(ve="LineString",nr=nr[0]):ve="MultiLineString"),ve!=="Point"&&ve!=="MultiPoint"||(ve=nr.length===3?"Point":"MultiPoint"),_e.push(et(nt.id,ve,nr,nt.tags))}}return _e.length?_e:null}function Kr(ge,W,Q,te,de){for(let be=0;be<ge.length;be+=3){const ke=ge[be+de];ke>=Q&&ke<=te&&xn(W,ge[be],ge[be+1],ge[be+2])}}function yn(ge,W,Q,te,de,be,ke){let $e=an(ge);const _e=de===0?di:Pi;let nt,dt,ve=ge.start;for(let Ir=0;Ir<ge.length-3;Ir+=3){const en=ge[Ir],Fr=ge[Ir+1],fi=ge[Ir+2],Yn=ge[Ir+3],Br=ge[Ir+4],mn=de===0?en:Fr,Bn=de===0?Yn:Br;let Ai=!1;ke&&(nt=Math.sqrt(Math.pow(en-Yn,2)+Math.pow(Fr-Br,2))),mn<Q?Bn>Q&&(dt=_e($e,en,Fr,Yn,Br,Q),ke&&($e.start=ve+nt*dt)):mn>te?Bn<te&&(dt=_e($e,en,Fr,Yn,Br,te),ke&&($e.start=ve+nt*dt)):xn($e,en,Fr,fi),Bn<Q&&mn>=Q&&(dt=_e($e,en,Fr,Yn,Br,Q),Ai=!0),Bn>te&&mn<=te&&(dt=_e($e,en,Fr,Yn,Br,te),Ai=!0),!be&&Ai&&(ke&&($e.end=ve+nt*dt),W.push($e),$e=an(ge)),ke&&(ve+=nt)}let ut=ge.length-3;const Dt=ge[ut],nr=ge[ut+1],Ur=de===0?Dt:nr;Ur>=Q&&Ur<=te&&xn($e,Dt,nr,ge[ut+2]),ut=$e.length-3,be&&ut>=3&&($e[ut]!==$e[0]||$e[ut+1]!==$e[1])&&xn($e,$e[0],$e[1],$e[2]),$e.length&&W.push($e)}function an(ge){const W=[];return W.size=ge.size,W.start=ge.start,W.end=ge.end,W}function Cn(ge,W,Q,te,de,be){for(const ke of ge)yn(ke,W,Q,te,de,be,!1)}function xn(ge,W,Q,te){ge.push(W,Q,te)}function di(ge,W,Q,te,de,be){const ke=(be-W)/(te-W);return xn(ge,be,Q+(de-Q)*ke,1),ke}function Pi(ge,W,Q,te,de,be){const ke=(be-Q)/(de-Q);return xn(ge,W+(te-W)*ke,be,1),ke}function He(ge,W){const Q=[];for(let te=0;te<ge.length;te++){const de=ge[te],be=de.type;let ke;if(be==="Point"||be==="MultiPoint"||be==="LineString")ke=Vr(de.geometry,W);else if(be==="MultiLineString"||be==="Polygon"){ke=[];for(const $e of de.geometry)ke.push(Vr($e,W))}else if(be==="MultiPolygon"){ke=[];for(const $e of de.geometry){const _e=[];for(const nt of $e)_e.push(Vr(nt,W));ke.push(_e)}}Q.push(et(de.id,be,ke,de.tags))}return Q}function Vr(ge,W){const Q=[];Q.size=ge.size,ge.start!==void 0&&(Q.start=ge.start,Q.end=ge.end);for(let te=0;te<ge.length;te+=3)Q.push(ge[te]+W,ge[te+1],ge[te+2]);return Q}function Ct(ge,W){if(ge.transformed)return ge;const Q=1<<ge.z,te=ge.x,de=ge.y;for(const be of ge.features){const ke=be.geometry,$e=be.type;if(be.geometry=[],$e===1)for(let _e=0;_e<ke.length;_e+=2)be.geometry.push(Ut(ke[_e],ke[_e+1],W,Q,te,de));else for(let _e=0;_e<ke.length;_e++){const nt=[];for(let dt=0;dt<ke[_e].length;dt+=2)nt.push(Ut(ke[_e][dt],ke[_e][dt+1],W,Q,te,de));be.geometry.push(nt)}}return ge.transformed=!0,ge}function Ut(ge,W,Q,te,de,be){return[Math.round(Q*(ge*te-de)),Math.round(Q*(W*te-be))]}function wn(ge,W,Q,te,de){const be=W===de.maxZoom?0:de.tolerance/((1<<W)*de.extent),ke={features:[],numPoints:0,numSimplified:0,numFeatures:ge.length,source:null,x:Q,y:te,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const $e of ge)vt(ke,$e,be,de);return ke}function vt(ge,W,Q,te){const de=W.geometry,be=W.type,ke=[];if(ge.minX=Math.min(ge.minX,W.minX),ge.minY=Math.min(ge.minY,W.minY),ge.maxX=Math.max(ge.maxX,W.maxX),ge.maxY=Math.max(ge.maxY,W.maxY),be==="Point"||be==="MultiPoint")for(let $e=0;$e<de.length;$e+=3)ke.push(de[$e],de[$e+1]),ge.numPoints++,ge.numSimplified++;else if(be==="LineString")vr(ke,de,ge,Q,!1,!1);else if(be==="MultiLineString"||be==="Polygon")for(let $e=0;$e<de.length;$e++)vr(ke,de[$e],ge,Q,be==="Polygon",$e===0);else if(be==="MultiPolygon")for(let $e=0;$e<de.length;$e++){const _e=de[$e];for(let nt=0;nt<_e.length;nt++)vr(ke,_e[nt],ge,Q,!0,nt===0)}if(ke.length){let $e=W.tags||null;if(be==="LineString"&&te.lineMetrics){$e={};for(const nt in W.tags)$e[nt]=W.tags[nt];$e.mapbox_clip_start=de.start/de.size,$e.mapbox_clip_end=de.end/de.size}const _e={geometry:ke,type:be==="Polygon"||be==="MultiPolygon"?3:be==="LineString"||be==="MultiLineString"?2:1,tags:$e};W.id!==null&&(_e.id=W.id),ge.features.push(_e)}}function vr(ge,W,Q,te,de,be){const ke=te*te;if(te>0&&W.size<(de?ke:te))return void(Q.numPoints+=W.length/3);const $e=[];for(let _e=0;_e<W.length;_e+=3)(te===0||W[_e+2]>ke)&&(Q.numSimplified++,$e.push(W[_e],W[_e+1])),Q.numPoints++;de&&function(_e,nt){let dt=0;for(let ve=0,ut=_e.length,Dt=ut-2;ve<ut;Dt=ve,ve+=2)dt+=(_e[ve]-_e[Dt])*(_e[ve+1]+_e[Dt+1]);if(dt>0===nt)for(let ve=0,ut=_e.length;ve<ut/2;ve+=2){const Dt=_e[ve],nr=_e[ve+1];_e[ve]=_e[ut-2-ve],_e[ve+1]=_e[ut-1-ve],_e[ut-2-ve]=Dt,_e[ut-1-ve]=nr}}($e,be),ge.push($e)}const tr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Zn{constructor(W,Q){const te=(Q=this.options=function(be,ke){for(const $e in ke)be[$e]=ke[$e];return be}(Object.create(tr),Q)).debug;if(te&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");let de=function(be,ke){const $e=[];if(be.type==="FeatureCollection")for(let _e=0;_e<be.features.length;_e++)_t($e,be.features[_e],ke,_e);else _t($e,be.type==="Feature"?be:{geometry:be},ke);return $e}(W,Q);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),de=function(be,ke){const $e=ke.buffer/ke.extent;let _e=be;const nt=Ft(be,1,-1-$e,$e,0,-1,2,ke),dt=Ft(be,1,1-$e,2+$e,0,-1,2,ke);return(nt||dt)&&(_e=Ft(be,1,-$e,1+$e,0,-1,2,ke)||[],nt&&(_e=He(nt,1).concat(_e)),dt&&(_e=_e.concat(He(dt,-1)))),_e}(de,Q),de.length&&this.splitTile(de,0,0,0),te&&(de.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(W,Q,te,de,be,ke,$e){const _e=[W,Q,te,de],nt=this.options,dt=nt.debug;for(;_e.length;){de=_e.pop(),te=_e.pop(),Q=_e.pop(),W=_e.pop();const ve=1<<Q,ut=_i(Q,te,de);let Dt=this.tiles[ut];if(!Dt&&(dt>1&&console.time("creation"),Dt=this.tiles[ut]=wn(W,Q,te,de,nt),this.tileCoords.push({z:Q,x:te,y:de}),dt)){dt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,te,de,Dt.numFeatures,Dt.numPoints,Dt.numSimplified),console.timeEnd("creation"));const Ai=`z${Q}`;this.stats[Ai]=(this.stats[Ai]||0)+1,this.total++}if(Dt.source=W,be==null){if(Q===nt.indexMaxZoom||Dt.numPoints<=nt.indexMaxPoints)continue}else{if(Q===nt.maxZoom||Q===be)continue;if(be!=null){const Ai=be-Q;if(te!==ke>>Ai||de!==$e>>Ai)continue}}if(Dt.source=null,W.length===0)continue;dt>1&&console.time("clipping");const nr=.5*nt.buffer/nt.extent,Ur=.5-nr,Ir=.5+nr,en=1+nr;let Fr=null,fi=null,Yn=null,Br=null,mn=Ft(W,ve,te-nr,te+Ir,0,Dt.minX,Dt.maxX,nt),Bn=Ft(W,ve,te+Ur,te+en,0,Dt.minX,Dt.maxX,nt);W=null,mn&&(Fr=Ft(mn,ve,de-nr,de+Ir,1,Dt.minY,Dt.maxY,nt),fi=Ft(mn,ve,de+Ur,de+en,1,Dt.minY,Dt.maxY,nt),mn=null),Bn&&(Yn=Ft(Bn,ve,de-nr,de+Ir,1,Dt.minY,Dt.maxY,nt),Br=Ft(Bn,ve,de+Ur,de+en,1,Dt.minY,Dt.maxY,nt),Bn=null),dt>1&&console.timeEnd("clipping"),_e.push(Fr||[],Q+1,2*te,2*de),_e.push(fi||[],Q+1,2*te,2*de+1),_e.push(Yn||[],Q+1,2*te+1,2*de),_e.push(Br||[],Q+1,2*te+1,2*de+1)}}getTile(W,Q,te){W=+W,Q=+Q,te=+te;const de=this.options,{extent:be,debug:ke}=de;if(W<0||W>24)return null;const $e=1<<W,_e=_i(W,Q=Q+$e&$e-1,te);if(this.tiles[_e])return Ct(this.tiles[_e],be);ke>1&&console.log("drilling down to z%d-%d-%d",W,Q,te);let nt,dt=W,ve=Q,ut=te;for(;!nt&&dt>0;)dt--,ve>>=1,ut>>=1,nt=this.tiles[_i(dt,ve,ut)];return nt&&nt.source?(ke>1&&(console.log("found parent tile z%d-%d-%d",dt,ve,ut),console.time("drilling down")),this.splitTile(nt.source,dt,ve,ut,W,Q,te),ke>1&&console.timeEnd("drilling down"),this.tiles[_e]?Ct(this.tiles[_e],be):null):null}}function _i(ge,W,Q){return 32*((1<<ge)*Q+W)+ge}function pr(ge,W){return W?ge.properties[W]:ge.id}function Di(ge,W){if(ge==null)return!0;if(ge.type==="Feature")return pr(ge,W)!=null;if(ge.type==="FeatureCollection"){const Q=new Set;for(const te of ge.features){const de=pr(te,W);if(de==null||Q.has(de))return!1;Q.add(de)}return!0}return!1}function ks(ge,W){const Q=new Map;if(ge!=null)if(ge.type==="Feature")Q.set(pr(ge,W),ge);else for(const te of ge.features)Q.set(pr(te,W),te);return Q}class Li extends v{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(W,Q){return a._(this,void 0,void 0,function*(){const te=W.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const de=this._geoJSONIndex.getTile(te.z,te.x,te.y);if(!de)return null;const be=new class{constructor($e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.X,this.length=$e.length,this._features=$e}feature($e){return new class{constructor(_e){this._feature=_e,this.extent=a.X,this.type=_e.type,this.properties=_e.tags,"id"in _e&&!isNaN(_e.id)&&(this.id=parseInt(_e.id,10))}loadGeometry(){if(this._feature.type===1){const _e=[];for(const nt of this._feature.geometry)_e.push([new a.P(nt[0],nt[1])]);return _e}{const _e=[];for(const nt of this._feature.geometry){const dt=[];for(const ve of nt)dt.push(new a.P(ve[0],ve[1]));_e.push(dt)}return _e}}toGeoJSON(_e,nt,dt){return $.call(this,_e,nt,dt)}}(this._features[$e])}}(de.features);let ke=Be(be);return ke.byteOffset===0&&ke.byteLength===ke.buffer.byteLength||(ke=new Uint8Array(ke)),{vectorTile:be,rawData:ke.buffer}})}loadData(W){return a._(this,void 0,void 0,function*(){var Q;(Q=this._pendingRequest)===null||Q===void 0||Q.abort();const te=!!(W&&W.request&&W.request.collectResourceTiming)&&new a.bv(W.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(W,this._pendingRequest),this._geoJSONIndex=W.cluster?new st(function({superclusterOptions:ke,clusterProperties:$e}){if(!$e||!ke)return ke;const _e={},nt={},dt={accumulated:null,zoom:0},ve={properties:null},ut=Object.keys($e);for(const Dt of ut){const[nr,Ur]=$e[Dt],Ir=a.bC(Ur),en=a.bC(typeof nr=="string"?[nr,["accumulated"],["get",Dt]]:nr);_e[Dt]=Ir.value,nt[Dt]=en.value}return ke.map=Dt=>{ve.properties=Dt;const nr={};for(const Ur of ut)nr[Ur]=_e[Ur].evaluate(dt,ve);return nr},ke.reduce=(Dt,nr)=>{ve.properties=nr;for(const Ur of ut)dt.accumulated=Dt[Ur],Dt[Ur]=nt[Ur].evaluate(dt,ve)},ke}(W)).load((yield this._pendingData).features):(de=yield this._pendingData,new Zn(de,W.geojsonVtOptions)),this.loaded={};const be={};if(te){const ke=te.finish();ke&&(be.resourceTiming={},be.resourceTiming[W.source]=JSON.parse(JSON.stringify(ke)))}return be}catch(be){if(delete this._pendingRequest,a.bB(be))return{abandoned:!0};throw be}var de})}getData(){return a._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(W){const Q=this.loaded;return Q&&Q[W.uid]?super.reloadTile(W):this.loadTile(W)}loadAndProcessGeoJSON(W,Q){return a._(this,void 0,void 0,function*(){let te=yield this.loadGeoJSON(W,Q);if(delete this._pendingRequest,typeof te!="object")throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(E(te,!0),W.filter){const de=a.bC(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(de.result==="error")throw new Error(de.value.map(ke=>`${ke.key}: ${ke.message}`).join(", "));te={type:"FeatureCollection",features:te.features.filter(ke=>de.value.evaluate({zoom:0},ke))}}return te})}loadGeoJSON(W,Q){return a._(this,void 0,void 0,function*(){const{promoteId:te}=W;if(W.request){const de=yield a.h(W.request,Q);return this._dataUpdateable=Di(de.data,te)?ks(de.data,te):void 0,de.data}if(typeof W.data=="string")try{const de=JSON.parse(W.data);return this._dataUpdateable=Di(de,te)?ks(de,te):void 0,de}catch{throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`)}if(!W.dataDiff)throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${W.source}`);return function(de,be,ke){var $e,_e,nt,dt;if(be.removeAll&&de.clear(),be.remove)for(const ve of be.remove)de.delete(ve);if(be.add)for(const ve of be.add){const ut=pr(ve,ke);ut!=null&&de.set(ut,ve)}if(be.update)for(const ve of be.update){let ut=de.get(ve.id);if(ut==null)continue;const Dt=!ve.removeAllProperties&&((($e=ve.removeProperties)===null||$e===void 0?void 0:$e.length)>0||((_e=ve.addOrUpdateProperties)===null||_e===void 0?void 0:_e.length)>0);if((ve.newGeometry||ve.removeAllProperties||Dt)&&(ut=Object.assign({},ut),de.set(ve.id,ut),Dt&&(ut.properties=Object.assign({},ut.properties))),ve.newGeometry&&(ut.geometry=ve.newGeometry),ve.removeAllProperties)ut.properties={};else if(((nt=ve.removeProperties)===null||nt===void 0?void 0:nt.length)>0)for(const nr of ve.removeProperties)Object.prototype.hasOwnProperty.call(ut.properties,nr)&&delete ut.properties[nr];if(((dt=ve.addOrUpdateProperties)===null||dt===void 0?void 0:dt.length)>0)for(const{key:nr,value:Ur}of ve.addOrUpdateProperties)ut.properties[nr]=Ur}}(this._dataUpdateable,W.dataDiff,te),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(W){return a._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(W){return this._geoJSONIndex.getClusterExpansionZoom(W.clusterId)}getClusterChildren(W){return this._geoJSONIndex.getChildren(W.clusterId)}getClusterLeaves(W){return this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset)}}class cs{constructor(W){this.self=W,this.actor=new a.F(W),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(Q,te)=>{if(this.externalWorkerSourceTypes[Q])throw new Error(`Worker source with name "${Q}" already registered.`);this.externalWorkerSourceTypes[Q]=te},this.self.addProtocol=a.bi,this.self.removeProtocol=a.bj,this.self.registerRTLTextPlugin=Q=>{if(a.bD.isParsed())throw new Error("RTL text plugin already registered.");a.bD.setMethods(Q)},this.actor.registerMessageHandler("LDT",(Q,te)=>this._getDEMWorkerSource(Q,te.source).loadTile(te)),this.actor.registerMessageHandler("RDT",(Q,te)=>a._(this,void 0,void 0,function*(){this._getDEMWorkerSource(Q,te.source).removeTile(te)})),this.actor.registerMessageHandler("GCEZ",(Q,te)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(Q,te.type,te.source).getClusterExpansionZoom(te)})),this.actor.registerMessageHandler("GCC",(Q,te)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(Q,te.type,te.source).getClusterChildren(te)})),this.actor.registerMessageHandler("GCL",(Q,te)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(Q,te.type,te.source).getClusterLeaves(te)})),this.actor.registerMessageHandler("LD",(Q,te)=>this._getWorkerSource(Q,te.type,te.source).loadData(te)),this.actor.registerMessageHandler("GD",(Q,te)=>this._getWorkerSource(Q,te.type,te.source).getData()),this.actor.registerMessageHandler("LT",(Q,te)=>this._getWorkerSource(Q,te.type,te.source).loadTile(te)),this.actor.registerMessageHandler("RT",(Q,te)=>this._getWorkerSource(Q,te.type,te.source).reloadTile(te)),this.actor.registerMessageHandler("AT",(Q,te)=>this._getWorkerSource(Q,te.type,te.source).abortTile(te)),this.actor.registerMessageHandler("RMT",(Q,te)=>this._getWorkerSource(Q,te.type,te.source).removeTile(te)),this.actor.registerMessageHandler("RS",(Q,te)=>a._(this,void 0,void 0,function*(){if(!this.workerSources[Q]||!this.workerSources[Q][te.type]||!this.workerSources[Q][te.type][te.source])return;const de=this.workerSources[Q][te.type][te.source];delete this.workerSources[Q][te.type][te.source],de.removeSource!==void 0&&de.removeSource(te)})),this.actor.registerMessageHandler("RM",Q=>a._(this,void 0,void 0,function*(){delete this.layerIndexes[Q],delete this.availableImages[Q],delete this.workerSources[Q],delete this.demWorkerSources[Q]})),this.actor.registerMessageHandler("SR",(Q,te)=>a._(this,void 0,void 0,function*(){this.referrer=te})),this.actor.registerMessageHandler("SRPS",(Q,te)=>this._syncRTLPluginState(Q,te)),this.actor.registerMessageHandler("IS",(Q,te)=>a._(this,void 0,void 0,function*(){this.self.importScripts(te)})),this.actor.registerMessageHandler("SI",(Q,te)=>this._setImages(Q,te)),this.actor.registerMessageHandler("UL",(Q,te)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(Q).update(te.layers,te.removedIds)})),this.actor.registerMessageHandler("SL",(Q,te)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(Q).replace(te)}))}_setImages(W,Q){return a._(this,void 0,void 0,function*(){this.availableImages[W]=Q;for(const te in this.workerSources[W]){const de=this.workerSources[W][te];for(const be in de)de[be].availableImages=Q}})}_syncRTLPluginState(W,Q){return a._(this,void 0,void 0,function*(){if(a.bD.isParsed())return a.bD.getState();if(Q.pluginStatus!=="loading")return a.bD.setState(Q),Q;const te=Q.pluginURL;if(this.self.importScripts(te),a.bD.isParsed()){const de={pluginStatus:"loaded",pluginURL:te};return a.bD.setState(de),de}throw a.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${te}`)})}_getAvailableImages(W){let Q=this.availableImages[W];return Q||(Q=[]),Q}_getLayerIndex(W){let Q=this.layerIndexes[W];return Q||(Q=this.layerIndexes[W]=new o),Q}_getWorkerSource(W,Q,te){if(this.workerSources[W]||(this.workerSources[W]={}),this.workerSources[W][Q]||(this.workerSources[W][Q]={}),!this.workerSources[W][Q][te]){const de={sendAsync:(be,ke)=>(be.targetMapId=W,this.actor.sendAsync(be,ke))};switch(Q){case"vector":this.workerSources[W][Q][te]=new v(de,this._getLayerIndex(W),this._getAvailableImages(W));break;case"geojson":this.workerSources[W][Q][te]=new Li(de,this._getLayerIndex(W),this._getAvailableImages(W));break;default:this.workerSources[W][Q][te]=new this.externalWorkerSourceTypes[Q](de,this._getLayerIndex(W),this._getAvailableImages(W))}}return this.workerSources[W][Q][te]}_getDEMWorkerSource(W,Q){return this.demWorkerSources[W]||(this.demWorkerSources[W]={}),this.demWorkerSources[W][Q]||(this.demWorkerSources[W][Q]=new w),this.demWorkerSources[W][Q]}}return a.i(self)&&(self.worker=new cs(self)),cs}),i("index",["exports","./shared"],function(a,o){var d="4.7.1";let m,y;const v={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:k=>new Promise((l,p)=>{const x=requestAnimationFrame(l);k.signal.addEventListener("abort",()=>{cancelAnimationFrame(x),p(o.c())})}),getImageData(k,l=0){return this.getImageCanvasContext(k).getImageData(-l,-l,k.width+2*l,k.height+2*l)},getImageCanvasContext(k){const l=window.document.createElement("canvas"),p=l.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return l.width=k.width,l.height=k.height,p.drawImage(k,0,0,k.width,k.height),p},resolveURL:k=>(m||(m=document.createElement("a")),m.href=k,m.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(y==null&&(y=matchMedia("(prefers-reduced-motion: reduce)")),y.matches)}};class w{static testProp(l){if(!w.docStyle)return l[0];for(let p=0;p<l.length;p++)if(l[p]in w.docStyle)return l[p];return l[0]}static create(l,p,x){const b=window.document.createElement(l);return p!==void 0&&(b.className=p),x&&x.appendChild(b),b}static createNS(l,p){return window.document.createElementNS(l,p)}static disableDrag(){w.docStyle&&w.selectProp&&(w.userSelect=w.docStyle[w.selectProp],w.docStyle[w.selectProp]="none")}static enableDrag(){w.docStyle&&w.selectProp&&(w.docStyle[w.selectProp]=w.userSelect)}static setTransform(l,p){l.style[w.transformProp]=p}static addEventListener(l,p,x,b={}){l.addEventListener(p,x,"passive"in b?b:b.capture)}static removeEventListener(l,p,x,b={}){l.removeEventListener(p,x,"passive"in b?b:b.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",w.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",w.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",w.suppressClickInternal,!0)},0)}static getScale(l){const p=l.getBoundingClientRect();return{x:p.width/l.offsetWidth||1,y:p.height/l.offsetHeight||1,boundingClientRect:p}}static getPoint(l,p,x){const b=p.boundingClientRect;return new o.P((x.clientX-b.left)/p.x-l.clientLeft,(x.clientY-b.top)/p.y-l.clientTop)}static mousePos(l,p){const x=w.getScale(l);return w.getPoint(l,x,p)}static touchPos(l,p){const x=[],b=w.getScale(l);for(let S=0;S<p.length;S++)x.push(w.getPoint(l,b,p[S]));return x}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}}w.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,w.selectProp=w.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),w.transformProp=w.testProp(["transform","WebkitTransform"]);const O={supported:!1,testSupport:function(k){!$&&E&&(R?F(k):P=k)}};let P,E,$=!1,R=!1;function F(k){const l=k.createTexture();k.bindTexture(k.TEXTURE_2D,l);try{if(k.texImage2D(k.TEXTURE_2D,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,E),k.isContextLost())return;O.supported=!0}catch{}k.deleteTexture(l),$=!0}var D;typeof document<"u"&&(E=document.createElement("img"),E.onload=()=>{P&&F(P),P=null,R=!0},E.onerror=()=>{$=!0,P=null},E.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(k){let l,p,x,b;k.resetRequestQueue=()=>{l=[],p=0,x=0,b={}},k.addThrottleControl=L=>{const V=x++;return b[V]=L,V},k.removeThrottleControl=L=>{delete b[L],A()},k.getImage=(L,V,H=!0)=>new Promise((G,ie)=>{O.supported&&(L.headers||(L.headers={}),L.headers.accept="image/webp,*/*"),o.e(L,{type:"image"}),l.push({abortController:V,requestParameters:L,supportImageRefresh:H,state:"queued",onError:le=>{ie(le)},onSuccess:le=>{G(le)}}),A()});const S=L=>o._(this,void 0,void 0,function*(){L.state="running";const{requestParameters:V,supportImageRefresh:H,onError:G,onSuccess:ie,abortController:le}=L,he=H===!1&&!o.i(self)&&!o.g(V.url)&&(!V.headers||Object.keys(V.headers).reduce((Ce,je)=>Ce&&je==="accept",!0));p++;const xe=he?M(V,le):o.m(V,le);try{const Ce=yield xe;delete L.abortController,L.state="completed",Ce.data instanceof HTMLImageElement||o.b(Ce.data)?ie(Ce):Ce.data&&ie({data:yield(Se=Ce.data,typeof createImageBitmap=="function"?o.d(Se):o.f(Se)),cacheControl:Ce.cacheControl,expires:Ce.expires})}catch(Ce){delete L.abortController,G(Ce)}finally{p--,A()}var Se}),A=()=>{const L=(()=>{for(const V of Object.keys(b))if(b[V]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let V=p;V<L&&l.length>0;V++){const H=l.shift();H.abortController.signal.aborted?V--:S(H)}},M=(L,V)=>new Promise((H,G)=>{const ie=new Image,le=L.url,he=L.credentials;he&&he==="include"?ie.crossOrigin="use-credentials":(he&&he==="same-origin"||!o.s(le))&&(ie.crossOrigin="anonymous"),V.signal.addEventListener("abort",()=>{ie.src="",G(o.c())}),ie.fetchPriority="high",ie.onload=()=>{ie.onerror=ie.onload=null,H({data:ie})},ie.onerror=()=>{ie.onerror=ie.onload=null,V.signal.aborted||G(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ie.src=le})}(D||(D={})),D.resetRequestQueue();class U{constructor(l){this._transformRequestFn=l}transformRequest(l,p){return this._transformRequestFn&&this._transformRequestFn(l,p)||{url:l}}setTransformRequest(l){this._transformRequestFn=l}}function X(k){var l=new o.A(3);return l[0]=k[0],l[1]=k[1],l[2]=k[2],l}var ee,K=function(k,l,p){return k[0]=l[0]-p[0],k[1]=l[1]-p[1],k[2]=l[2]-p[2],k};ee=new o.A(3),o.A!=Float32Array&&(ee[0]=0,ee[1]=0,ee[2]=0);var Y=function(k){var l=k[0],p=k[1];return l*l+p*p};function ne(k){const l=[];if(typeof k=="string")l.push({id:"default",url:k});else if(k&&k.length>0){const p=[];for(const{id:x,url:b}of k){const S=`${x}${b}`;p.indexOf(S)===-1&&(p.push(S),l.push({id:x,url:b}))}}return l}function oe(k,l,p){const x=k.split("?");return x[0]+=`${l}${p}`,x.join("?")}(function(){var k=new o.A(2);o.A!=Float32Array&&(k[0]=0,k[1]=0)})();class ce{constructor(l,p,x,b){this.context=l,this.format=x,this.texture=l.gl.createTexture(),this.update(p,b)}update(l,p,x){const{width:b,height:S}=l,A=!(this.size&&this.size[0]===b&&this.size[1]===S||x),{context:M}=this,{gl:L}=M;if(this.useMipmap=!!(p&&p.useMipmap),L.bindTexture(L.TEXTURE_2D,this.texture),M.pixelStoreUnpackFlipY.set(!1),M.pixelStoreUnpack.set(1),M.pixelStoreUnpackPremultiplyAlpha.set(this.format===L.RGBA&&(!p||p.premultiply!==!1)),A)this.size=[b,S],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||o.b(l)?L.texImage2D(L.TEXTURE_2D,0,this.format,this.format,L.UNSIGNED_BYTE,l):L.texImage2D(L.TEXTURE_2D,0,this.format,b,S,0,this.format,L.UNSIGNED_BYTE,l.data);else{const{x:V,y:H}=x||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||o.b(l)?L.texSubImage2D(L.TEXTURE_2D,0,V,H,L.RGBA,L.UNSIGNED_BYTE,l):L.texSubImage2D(L.TEXTURE_2D,0,V,H,b,S,L.RGBA,L.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&L.generateMipmap(L.TEXTURE_2D)}bind(l,p,x){const{context:b}=this,{gl:S}=b;S.bindTexture(S.TEXTURE_2D,this.texture),x!==S.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(x=S.LINEAR),l!==this.filter&&(S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,l),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,x||l),this.filter=l),p!==this.wrap&&(S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,p),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,p),this.wrap=p)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}function Xe(k){const{userImage:l}=k;return!!(l&&l.render&&l.render())&&(k.data.replace(new Uint8Array(l.data.buffer)),!0)}class Ae extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:p,promiseResolve:x}of this.requestors)x(this._getImagesForIds(p));this.requestors=[]}}getImage(l){const p=this.images[l];if(p&&!p.data&&p.spriteData){const x=p.spriteData;p.data=new o.R({width:x.width,height:x.height},x.context.getImageData(x.x,x.y,x.width,x.height).data),p.spriteData=null}return p}addImage(l,p){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,p)&&(this.images[l]=p)}_validate(l,p){let x=!0;const b=p.data||p.spriteData;return this._validateStretch(p.stretchX,b&&b.width)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "stretchX" value`))),x=!1),this._validateStretch(p.stretchY,b&&b.height)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "stretchY" value`))),x=!1),this._validateContent(p.content,p)||(this.fire(new o.j(new Error(`Image "${l}" has invalid "content" value`))),x=!1),x}_validateStretch(l,p){if(!l)return!0;let x=0;for(const b of l){if(b[0]<x||b[1]<b[0]||p<b[1])return!1;x=b[1]}return!0}_validateContent(l,p){if(!l)return!0;if(l.length!==4)return!1;const x=p.spriteData,b=x&&x.width||p.data.width,S=x&&x.height||p.data.height;return!(l[0]<0||b<l[0]||l[1]<0||S<l[1]||l[2]<0||b<l[2]||l[3]<0||S<l[3]||l[2]<l[0]||l[3]<l[1])}updateImage(l,p,x=!0){const b=this.getImage(l);if(x&&(b.data.width!==p.data.width||b.data.height!==p.data.height))throw new Error(`size mismatch between old image (${b.data.width}x${b.data.height}) and new image (${p.data.width}x${p.data.height}).`);p.version=b.version+1,this.images[l]=p,this.updatedImages[l]=!0}removeImage(l){const p=this.images[l];delete this.images[l],delete this.patterns[l],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l){return new Promise((p,x)=>{let b=!0;if(!this.isLoaded())for(const S of l)this.images[S]||(b=!1);this.isLoaded()||b?p(this._getImagesForIds(l)):this.requestors.push({ids:l,promiseResolve:p})})}_getImagesForIds(l){const p={};for(const x of l){let b=this.getImage(x);b||(this.fire(new o.k("styleimagemissing",{id:x})),b=this.getImage(x)),b?p[x]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,textFitWidth:b.textFitWidth,textFitHeight:b.textFitHeight,hasRenderCallback:!!(b.userImage&&b.userImage.render)}:o.w(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return p}getPixelSize(){const{width:l,height:p}=this.atlasImage;return{width:l,height:p}}getPattern(l){const p=this.patterns[l],x=this.getImage(l);if(!x)return null;if(p&&p.position.version===x.version)return p.position;if(p)p.position.version=x.version;else{const b={w:x.data.width+2,h:x.data.height+2,x:0,y:0},S=new o.I(b,x);this.patterns[l]={bin:b,position:S}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const p=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ce(l,this.atlasImage,p.RGBA),this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const S in this.patterns)l.push(this.patterns[S].bin);const{w:p,h:x}=o.p(l),b=this.atlasImage;b.resize({width:p||1,height:x||1});for(const S in this.patterns){const{bin:A}=this.patterns[S],M=A.x+1,L=A.y+1,V=this.getImage(S).data,H=V.width,G=V.height;o.R.copy(V,b,{x:0,y:0},{x:M,y:L},{width:H,height:G}),o.R.copy(V,b,{x:0,y:G-1},{x:M,y:L-1},{width:H,height:1}),o.R.copy(V,b,{x:0,y:0},{x:M,y:L+G},{width:H,height:1}),o.R.copy(V,b,{x:H-1,y:0},{x:M-1,y:L},{width:1,height:G}),o.R.copy(V,b,{x:0,y:0},{x:M+H,y:L},{width:1,height:G})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const p of l){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const x=this.getImage(p);x||o.w(`Image with ID: "${p}" was not found`),Xe(x)&&this.updateImage(p,x)}}}const We=1e20;function Ye(k,l,p,x,b,S,A,M,L){for(let V=l;V<l+x;V++)tt(k,p*S+V,S,b,A,M,L);for(let V=p;V<p+b;V++)tt(k,V*S+l,1,x,A,M,L)}function tt(k,l,p,x,b,S,A){S[0]=0,A[0]=-We,A[1]=We,b[0]=k[l];for(let M=1,L=0,V=0;M<x;M++){b[M]=k[l+M*p];const H=M*M;do{const G=S[L];V=(b[M]-b[G]+H-G*G)/(M-G)/2}while(V<=A[L]&&--L>-1);L++,S[L]=M,A[L]=V,A[L+1]=We}for(let M=0,L=0;M<x;M++){for(;A[L+1]<M;)L++;const V=S[L],H=M-V;k[l+M*p]=b[V]+H*H}}class Be{constructor(l,p){this.requestManager=l,this.localIdeographFontFamily=p,this.entries={}}setURL(l){this.url=l}getGlyphs(l){return o._(this,void 0,void 0,function*(){const p=[];for(const S in l)for(const A of l[S])p.push(this._getAndCacheGlyphsPromise(S,A));const x=yield Promise.all(p),b={};for(const{stack:S,id:A,glyph:M}of x)b[S]||(b[S]={}),b[S][A]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};return b})}_getAndCacheGlyphsPromise(l,p){return o._(this,void 0,void 0,function*(){let x=this.entries[l];x||(x=this.entries[l]={glyphs:{},requests:{},ranges:{}});let b=x.glyphs[p];if(b!==void 0)return{stack:l,id:p,glyph:b};if(b=this._tinySDF(x,l,p),b)return x.glyphs[p]=b,{stack:l,id:p,glyph:b};const S=Math.floor(p/256);if(256*S>65535)throw new Error("glyphs > 65535 not supported");if(x.ranges[S])return{stack:l,id:p,glyph:b};if(!this.url)throw new Error("glyphsUrl is not set");if(!x.requests[S]){const M=Be.loadGlyphRange(l,S,this.url,this.requestManager);x.requests[S]=M}const A=yield x.requests[S];for(const M in A)this._doesCharSupportLocalGlyph(+M)||(x.glyphs[+M]=A[+M]);return x.ranges[S]=!0,{stack:l,id:p,glyph:A[p]||null}})}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(l))}_tinySDF(l,p,x){const b=this.localIdeographFontFamily;if(!b||!this._doesCharSupportLocalGlyph(x))return;let S=l.tinySDF;if(!S){let M="400";/bold/i.test(p)?M="900":/medium/i.test(p)?M="500":/light/i.test(p)&&(M="200"),S=l.tinySDF=new Be.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:b,fontWeight:M})}const A=S.draw(String.fromCharCode(x));return{id:x,bitmap:new o.o({width:A.width||60,height:A.height||60},A.data),metrics:{width:A.glyphWidth/2||24,height:A.glyphHeight/2||24,left:A.glyphLeft/2+.5||0,top:A.glyphTop/2-27.5||-8,advance:A.glyphAdvance/2||24,isDoubleResolution:!0}}}}Be.loadGlyphRange=function(k,l,p,x){return o._(this,void 0,void 0,function*(){const b=256*l,S=b+255,A=x.transformRequest(p.replace("{fontstack}",k).replace("{range}",`${b}-${S}`),"Glyphs"),M=yield o.l(A,new AbortController);if(!M||!M.data)throw new Error(`Could not load glyph range. range: ${l}, ${b}-${S}`);const L={};for(const V of o.n(M.data))L[V.id]=V;return L})},Be.TinySDF=class{constructor({fontSize:k=24,buffer:l=3,radius:p=8,cutoff:x=.25,fontFamily:b="sans-serif",fontWeight:S="normal",fontStyle:A="normal"}={}){this.buffer=l,this.cutoff=x,this.radius=p;const M=this.size=k+4*l,L=this._createCanvas(M),V=this.ctx=L.getContext("2d",{willReadFrequently:!0});V.font=`${A} ${S} ${k}px ${b}`,V.textBaseline="alphabetic",V.textAlign="left",V.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(k){const l=document.createElement("canvas");return l.width=l.height=k,l}draw(k){const{width:l,actualBoundingBoxAscent:p,actualBoundingBoxDescent:x,actualBoundingBoxLeft:b,actualBoundingBoxRight:S}=this.ctx.measureText(k),A=Math.ceil(p),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(S-b))),L=Math.min(this.size-this.buffer,A+Math.ceil(x)),V=M+2*this.buffer,H=L+2*this.buffer,G=Math.max(V*H,0),ie=new Uint8ClampedArray(G),le={data:ie,width:V,height:H,glyphWidth:M,glyphHeight:L,glyphTop:A,glyphLeft:0,glyphAdvance:l};if(M===0||L===0)return le;const{ctx:he,buffer:xe,gridInner:Se,gridOuter:Ce}=this;he.clearRect(xe,xe,M,L),he.fillText(k,xe,xe+A);const je=he.getImageData(xe,xe,M,L);Ce.fill(We,0,G),Se.fill(0,0,G);for(let pe=0;pe<L;pe++)for(let Fe=0;Fe<M;Fe++){const Ue=je.data[4*(pe*M+Fe)+3]/255;if(Ue===0)continue;const Je=(pe+xe)*V+Fe+xe;if(Ue===1)Ce[Je]=0,Se[Je]=We;else{const ft=.5-Ue;Ce[Je]=ft>0?ft*ft:0,Se[Je]=ft<0?ft*ft:0}}Ye(Ce,0,0,V,H,V,this.f,this.v,this.z),Ye(Se,xe,xe,M,L,V,this.f,this.v,this.z);for(let pe=0;pe<G;pe++){const Fe=Math.sqrt(Ce[pe])-Math.sqrt(Se[pe]);ie[pe]=Math.round(255-255*(Fe/this.radius+this.cutoff))}return le}};class Me{constructor(){this.specification=o.v.light.position}possiblyEvaluate(l,p){return o.x(l.expression.evaluate(p))}interpolate(l,p,x){return{x:o.y.number(l.x,p.x,x),y:o.y.number(l.y,p.y,x),z:o.y.number(l.z,p.z,x)}}}let Ge;class De extends o.E{constructor(l){super(),Ge=Ge||new o.q({anchor:new o.D(o.v.light.anchor),position:new Me,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.T(Ge),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,p={}){if(!this._validate(o.r,l,p))for(const x in l){const b=l[x];x.endsWith("-transition")?this._transitionable.setTransition(x.slice(0,-11),b):this._transitionable.setValue(x,b)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,p,x){return(!x||x.validate!==!1)&&o.t(this,l.call(o.u,{value:p,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}const Le=new o.q({"sky-color":new o.D(o.v.sky["sky-color"]),"horizon-color":new o.D(o.v.sky["horizon-color"]),"fog-color":new o.D(o.v.sky["fog-color"]),"fog-ground-blend":new o.D(o.v.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.v.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.v.sky["atmosphere-blend"])});class Oe extends o.E{constructor(l){super(),this._transitionable=new o.T(Le),this.setSky(l),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.z(0))}setSky(l,p={}){if(!this._validate(o.B,l,p)){l||(l={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const x in l){const b=l[x];x.endsWith("-transition")?this._transitionable.setTransition(x.slice(0,-11),b):this._transitionable.setValue(x,b)}}}getSky(){return this._transitionable.serialize()}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,p,x={}){return(x==null?void 0:x.validate)!==!1&&o.t(this,l.call(o.u,o.e({value:p,style:{glyphs:!0,sprite:!0},styleSpec:o.v})))}calculateFogBlendOpacity(l){return l<60?0:l<70?(l-60)/10:1}}class Ie{constructor(l,p){this.width=l,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,p){const x=l.join(",")+String(p);return this.dashEntry[x]||(this.dashEntry[x]=this.addDash(l,p)),this.dashEntry[x]}getDashRanges(l,p,x){const b=[];let S=l.length%2==1?-l[l.length-1]*x:0,A=l[0]*x,M=!0;b.push({left:S,right:A,isDash:M,zeroLength:l[0]===0});let L=l[0];for(let V=1;V<l.length;V++){M=!M;const H=l[V];S=L*x,L+=H,A=L*x,b.push({left:S,right:A,isDash:M,zeroLength:H===0})}return b}addRoundDash(l,p,x){const b=p/2;for(let S=-x;S<=x;S++){const A=this.width*(this.nextRow+x+S);let M=0,L=l[M];for(let V=0;V<this.width;V++){V/L.right>1&&(L=l[++M]);const H=Math.abs(V-L.left),G=Math.abs(V-L.right),ie=Math.min(H,G);let le;const he=S/x*(b+1);if(L.isDash){const xe=b-Math.abs(he);le=Math.sqrt(ie*ie+xe*xe)}else le=b-Math.sqrt(ie*ie+he*he);this.data[A+V]=Math.max(0,Math.min(255,le+128))}}}addRegularDash(l){for(let M=l.length-1;M>=0;--M){const L=l[M],V=l[M+1];L.zeroLength?l.splice(M,1):V&&V.isDash===L.isDash&&(V.left=L.left,l.splice(M,1))}const p=l[0],x=l[l.length-1];p.isDash===x.isDash&&(p.left=x.left-this.width,x.right=p.right+this.width);const b=this.width*this.nextRow;let S=0,A=l[S];for(let M=0;M<this.width;M++){M/A.right>1&&(A=l[++S]);const L=Math.abs(M-A.left),V=Math.abs(M-A.right),H=Math.min(L,V);this.data[b+M]=Math.max(0,Math.min(255,(A.isDash?H:-H)+128))}}addDash(l,p){const x=p?7:0,b=2*x+1;if(this.nextRow+b>this.height)return o.w("LineAtlas out of space"),null;let S=0;for(let M=0;M<l.length;M++)S+=l[M];if(S!==0){const M=this.width/S,L=this.getDashRanges(l,this.width,M);p?this.addRoundDash(L,M,x):this.addRegularDash(L)}const A={y:(this.nextRow+x+.5)/this.height,height:2*x/this.height,width:S};return this.nextRow+=b,this.dirty=!0,A}bind(l){const p=l.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))}}const st="maplibre_preloaded_worker_pool";class Re{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<Re.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(p=>{p.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[st]}numActive(){return Object.keys(this.active).length}}const it=Math.floor(v.hardwareConcurrency/2);let Ke,St;function Mt(){return Ke||(Ke=new Re),Ke}Re.workerCount=o.C(globalThis)?Math.max(Math.min(it,3),1):1;class Et{constructor(l,p){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=p;const x=this.workerPool.acquire(p);for(let b=0;b<x.length;b++){const S=new o.F(x[b],p);S.name=`Worker ${b}`,this.actors.push(S)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,p){const x=[];for(const b of this.actors)x.push(b.sendAsync({type:l,data:p}));return Promise.all(x)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(l=!0){this.actors.forEach(p=>{p.remove()}),this.actors=[],l&&this.workerPool.release(this.id)}registerMessageHandler(l,p){for(const x of this.actors)x.registerMessageHandler(l,p)}}function xt(){return St||(St=new Et(Mt(),o.G),St.registerMessageHandler("GR",(k,l,p)=>o.m(l,p))),St}function et(k,l){const p=o.H();return o.J(p,p,[1,1,0]),o.K(p,p,[.5*k.width,.5*k.height,1]),o.L(p,p,k.calculatePosMatrix(l.toUnwrapped()))}function Yt(k,l,p,x,b,S){const A=function(G,ie,le){if(G)for(const he of G){const xe=ie[he];if(xe&&xe.source===le&&xe.type==="fill-extrusion")return!0}else for(const he in ie){const xe=ie[he];if(xe.source===le&&xe.type==="fill-extrusion")return!0}return!1}(b&&b.layers,l,k.id),M=S.maxPitchScaleFactor(),L=k.tilesIn(x,M,A);L.sort(_t);const V=[];for(const G of L)V.push({wrappedTileID:G.tileID.wrapped().key,queryResults:G.tile.queryRenderedFeatures(l,p,k._state,G.queryGeometry,G.cameraQueryGeometry,G.scale,b,S,M,et(k.transform,G.tileID))});const H=function(G){const ie={},le={};for(const he of G){const xe=he.queryResults,Se=he.wrappedTileID,Ce=le[Se]=le[Se]||{};for(const je in xe){const pe=xe[je],Fe=Ce[je]=Ce[je]||{},Ue=ie[je]=ie[je]||[];for(const Je of pe)Fe[Je.featureIndex]||(Fe[Je.featureIndex]=!0,Ue.push(Je))}}return ie}(V);for(const G in H)H[G].forEach(ie=>{const le=ie.feature,he=k.getFeatureState(le.layer["source-layer"],le.id);le.source=le.layer.source,le.layer["source-layer"]&&(le.sourceLayer=le.layer["source-layer"]),le.state=he});return H}function _t(k,l){const p=k.tileID,x=l.tileID;return p.overscaledZ-x.overscaledZ||p.canonical.y-x.canonical.y||p.wrap-x.wrap||p.canonical.x-x.canonical.x}function rt(k,l,p){return o._(this,void 0,void 0,function*(){let x=k;if(k.url?x=(yield o.h(l.transformRequest(k.url,"Source"),p)).data:yield v.frameAsync(p),!x)return null;const b=o.M(o.e(x,k),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in x&&x.vector_layers&&(b.vectorLayerIds=x.vector_layers.map(S=>S.id)),b})}class Te{constructor(l,p){l&&(p?this.setSouthWest(l).setNorthEast(p):Array.isArray(l)&&(l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1])))}setNorthEast(l){return this._ne=l instanceof o.N?new o.N(l.lng,l.lat):o.N.convert(l),this}setSouthWest(l){return this._sw=l instanceof o.N?new o.N(l.lng,l.lat):o.N.convert(l),this}extend(l){const p=this._sw,x=this._ne;let b,S;if(l instanceof o.N)b=l,S=l;else{if(!(l instanceof Te))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(Te.convert(l)):this.extend(o.N.convert(l)):l&&("lng"in l||"lon"in l)&&"lat"in l?this.extend(o.N.convert(l)):this;if(b=l._sw,S=l._ne,!b||!S)return this}return p||x?(p.lng=Math.min(b.lng,p.lng),p.lat=Math.min(b.lat,p.lat),x.lng=Math.max(S.lng,x.lng),x.lat=Math.max(S.lat,x.lat)):(this._sw=new o.N(b.lng,b.lat),this._ne=new o.N(S.lng,S.lat)),this}getCenter(){return new o.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.N(this.getWest(),this.getNorth())}getSouthEast(){return new o.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){const{lng:p,lat:x}=o.N.convert(l);let b=this._sw.lng<=p&&p<=this._ne.lng;return this._sw.lng>this._ne.lng&&(b=this._sw.lng>=p&&p>=this._ne.lng),this._sw.lat<=x&&x<=this._ne.lat&&b}static convert(l){return l instanceof Te?l:l&&new Te(l)}static fromLngLat(l,p=0){const x=360*p/40075017,b=x/Math.cos(Math.PI/180*l.lat);return new Te(new o.N(l.lng-b,l.lat-x),new o.N(l.lng+b,l.lat+x))}adjustAntiMeridian(){const l=new o.N(this._sw.lng,this._sw.lat),p=new o.N(this._ne.lng,this._ne.lat);return new Te(l,l.lng>p.lng?new o.N(p.lng+360,p.lat):p)}}class ct{constructor(l,p,x){this.bounds=Te.convert(this.validateBounds(l)),this.minzoom=p||0,this.maxzoom=x||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const p=Math.pow(2,l.z),x=Math.floor(o.O(this.bounds.getWest())*p),b=Math.floor(o.Q(this.bounds.getNorth())*p),S=Math.ceil(o.O(this.bounds.getEast())*p),A=Math.ceil(o.Q(this.bounds.getSouth())*p);return l.x>=x&&l.x<S&&l.y>=b&&l.y<A}}class Vt extends o.E{constructor(l,p,x,b){if(super(),this.id=l,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.M(p,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield rt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l&&(o.e(this,l),l.bounds&&(this.tileBounds=new ct(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new o.j(l))}})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.abort(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(l){return o._(this,void 0,void 0,function*(){const p=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),x={request:this.map._requestManager.transformRequest(p,"Tile"),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};x.request.collectResourceTiming=this._collectResourceTiming;let b="RT";if(l.actor&&l.state!=="expired"){if(l.state==="loading")return new Promise((S,A)=>{l.reloadPromise={resolve:S,reject:A}})}else l.actor=this.dispatcher.getActor(),b="LT";l.abortController=new AbortController;try{const S=yield l.actor.sendAsync({type:b,data:x},l.abortController);if(delete l.abortController,l.aborted)return;this._afterTileLoadWorkerResponse(l,S)}catch(S){if(delete l.abortController,l.aborted)return;if(S&&S.status!==404)throw S;this._afterTileLoadWorkerResponse(l,null)}})}_afterTileLoadWorkerResponse(l,p){if(p&&p.resourceTiming&&(l.resourceTiming=p.resourceTiming),p&&this.map._refreshExpiredTiles&&l.setExpiryData(p),l.loadVectorData(p,this.map.painter),l.reloadPromise){const x=l.reloadPromise;l.reloadPromise=null,this.loadTile(l).then(x.resolve).catch(x.reject)}}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.actor&&(yield l.actor.sendAsync({type:"AT",data:{uid:l.uid,type:this.type,source:this.id}}))})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.unloadVectorData(),l.actor&&(yield l.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class wt extends o.E{constructor(l,p,x,b){super(),this.id=l,this.dispatcher=x,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},p),o.e(this,o.M(p,["url","scheme","tileSize"]))}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const l=yield rt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,l&&(o.e(this,l),l.bounds&&(this.tileBounds=new ct(l.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(l){this._tileJSONRequest=null,this.fire(new o.j(l))}})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(l){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}serialize(){return o.e({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l){return o._(this,void 0,void 0,function*(){const p=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.abortController=new AbortController;try{const x=yield D.getImage(this.map._requestManager.transformRequest(p,"Tile"),l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(x&&x.data){this.map._refreshExpiredTiles&&x.cacheControl&&x.expires&&l.setExpiryData({cacheControl:x.cacheControl,expires:x.expires});const b=this.map.painter.context,S=b.gl,A=x.data;l.texture=this.map.painter.getTileTexture(A.width),l.texture?l.texture.update(A,{useMipmap:!0}):(l.texture=new ce(b,A,S.RGBA,{useMipmap:!0}),l.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST)),l.state="loaded"}}catch(x){if(delete l.abortController,l.aborted)l.state="unloaded";else if(x)throw l.state="errored",x}})}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController)})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.texture&&this.map.painter.saveTileTexture(l.texture)})}hasTransition(){return!1}}class Ft extends wt{constructor(l,p,x,b){super(l,p,x,b),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},p),this.encoding=p.encoding||"mapbox",this.redFactor=p.redFactor,this.greenFactor=p.greenFactor,this.blueFactor=p.blueFactor,this.baseShift=p.baseShift}loadTile(l){return o._(this,void 0,void 0,function*(){const p=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),x=this.map._requestManager.transformRequest(p,"Tile");l.neighboringTiles=this._getNeighboringTiles(l.tileID),l.abortController=new AbortController;try{const b=yield D.getImage(x,l.abortController,this.map._refreshExpiredTiles);if(delete l.abortController,l.aborted)return void(l.state="unloaded");if(b&&b.data){const S=b.data;this.map._refreshExpiredTiles&&b.cacheControl&&b.expires&&l.setExpiryData({cacheControl:b.cacheControl,expires:b.expires});const A=o.b(S)&&o.U()?S:yield this.readImageNow(S),M={type:this.type,uid:l.uid,source:this.id,rawImageData:A,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!l.actor||l.state==="expired"){l.actor=this.dispatcher.getActor();const L=yield l.actor.sendAsync({type:"LDT",data:M});l.dem=L,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded"}}}catch(b){if(delete l.abortController,l.aborted)l.state="unloaded";else if(b)throw l.state="errored",b}})}readImageNow(l){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.V()){const p=l.width+2,x=l.height+2;try{return new o.R({width:p,height:x},yield o.W(l,-1,-1,p,x))}catch{}}return v.getImageData(l,1)})}_getNeighboringTiles(l){const p=l.canonical,x=Math.pow(2,p.z),b=(p.x-1+x)%x,S=p.x===0?l.wrap-1:l.wrap,A=(p.x+1+x)%x,M=p.x+1===x?l.wrap+1:l.wrap,L={};return L[new o.S(l.overscaledZ,S,p.z,b,p.y).key]={backfilled:!1},L[new o.S(l.overscaledZ,M,p.z,A,p.y).key]={backfilled:!1},p.y>0&&(L[new o.S(l.overscaledZ,S,p.z,b,p.y-1).key]={backfilled:!1},L[new o.S(l.overscaledZ,l.wrap,p.z,p.x,p.y-1).key]={backfilled:!1},L[new o.S(l.overscaledZ,M,p.z,A,p.y-1).key]={backfilled:!1}),p.y+1<x&&(L[new o.S(l.overscaledZ,S,p.z,b,p.y+1).key]={backfilled:!1},L[new o.S(l.overscaledZ,l.wrap,p.z,p.x,p.y+1).key]={backfilled:!1},L[new o.S(l.overscaledZ,M,p.z,A,p.y+1).key]={backfilled:!1}),L}unloadTile(l){return o._(this,void 0,void 0,function*(){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&(yield l.actor.sendAsync({type:"RDT",data:{type:this.type,uid:l.uid,source:this.id}}))})}}class Kr extends o.E{constructor(l,p,x,b){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=x.getActor(),this.setEventedParent(b),this._data=p.data,this._options=o.e({},p),this._collectResourceTiming=p.collectResourceTiming,p.maxzoom!==void 0&&(this.maxzoom=p.maxzoom),p.type&&(this.type=p.type),p.attribution&&(this.attribution=p.attribution),this.promoteId=p.promoteId;const S=o.X/this.tileSize;p.clusterMaxZoom!==void 0&&this.maxzoom<=p.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${p.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:p.cluster||!1,geojsonVtOptions:{buffer:(p.buffer!==void 0?p.buffer:128)*S,tolerance:(p.tolerance!==void 0?p.tolerance:.375)*S,extent:o.X,maxZoom:this.maxzoom,lineMetrics:p.lineMetrics||!1,generateId:p.generateId||!1},superclusterOptions:{maxZoom:p.clusterMaxZoom!==void 0?p.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,p.clusterMinPoints||2),extent:o.X,radius:(p.clusterRadius||50)*S,log:!1,generateId:p.generateId||!1},clusterProperties:p.clusterProperties,filter:p.filter},p.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._updateWorkerData(),this}updateData(l){return this._updateWorkerData(l),this}getData(){return o._(this,void 0,void 0,function*(){const l=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:l})})}setClusterOptions(l){return this.workerOptions.cluster=l.cluster,l&&(l.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=l.clusterRadius),l.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=l.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(l){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:l,source:this.id}})}getClusterChildren(l){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:l,source:this.id}})}getClusterLeaves(l,p,x){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:l,limit:p,offset:x}})}_updateWorkerData(l){return o._(this,void 0,void 0,function*(){const p=o.e({type:this.type},this.workerOptions);l?p.dataDiff=l:typeof this._data=="string"?(p.request=this.map._requestManager.transformRequest(v.resolveURL(this._data),"Source"),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.k("dataloading",{dataType:"source"}));try{const x=yield this.actor.sendAsync({type:"LD",data:p});if(this._pendingLoads--,this._removed||x.abandoned)return void this.fire(new o.k("dataabort",{dataType:"source"}));let b=null;x.resourceTiming&&x.resourceTiming[this.id]&&(b=x.resourceTiming[this.id].slice(0));const S={dataType:"source"};this._collectResourceTiming&&b&&b.length>0&&o.e(S,{resourceTiming:b}),this.fire(new o.k("data",Object.assign(Object.assign({},S),{sourceDataType:"metadata"}))),this.fire(new o.k("data",Object.assign(Object.assign({},S),{sourceDataType:"content"})))}catch(x){if(this._pendingLoads--,this._removed)return void this.fire(new o.k("dataabort",{dataType:"source"}));this.fire(new o.j(x))}})}loaded(){return this._pendingLoads===0}loadTile(l){return o._(this,void 0,void 0,function*(){const p=l.actor?"RT":"LT";l.actor=this.actor;const x={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};l.abortController=new AbortController;const b=yield this.actor.sendAsync({type:p,data:x},l.abortController);delete l.abortController,l.unloadVectorData(),l.aborted||l.loadVectorData(b,this.map.painter,p==="RT")})}abortTile(l){return o._(this,void 0,void 0,function*(){l.abortController&&(l.abortController.abort(),delete l.abortController),l.aborted=!0})}unloadTile(l){return o._(this,void 0,void 0,function*(){l.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:l.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var yn=o.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class an extends o.E{constructor(l,p,x,b){super(),this.id=l,this.dispatcher=x,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(b),this.options=p}load(l){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const p=yield D.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,p&&p.data&&(this.image=p.data,l&&(this.coordinates=l),this._finishLoading())}catch(p){this._request=null,this._loaded=!0,this.fire(new o.j(p))}})}loaded(){return this._loaded}updateImage(l){return l.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=l.url,this.load(l.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(l){this.coordinates=l;const p=l.map(o.Z.fromLngLat);this.tileID=function(b){let S=1/0,A=1/0,M=-1/0,L=-1/0;for(const ie of b)S=Math.min(S,ie.x),A=Math.min(A,ie.y),M=Math.max(M,ie.x),L=Math.max(L,ie.y);const V=Math.max(M-S,L-A),H=Math.max(0,Math.floor(-Math.log(V)/Math.LN2)),G=Math.pow(2,H);return new o.a1(H,Math.floor((S+M)/2*G),Math.floor((A+L)/2*G))}(p),this.minzoom=this.maxzoom=this.tileID.z;const x=p.map(b=>this.tileID.getTilePoint(b)._round());return this._boundsArray=new o.$,this._boundsArray.emplaceBack(x[0].x,x[0].y,0,0),this._boundsArray.emplaceBack(x[1].x,x[1].y,o.X,0),this._boundsArray.emplaceBack(x[3].x,x[3].y,0,o.X),this._boundsArray.emplaceBack(x[2].x,x[2].y,o.X,o.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,p=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,yn.members)),this.boundsSegments||(this.boundsSegments=o.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ce(l,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));let x=!1;for(const b in this.tiles){const S=this.tiles[b];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,x=!0)}x&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(l){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={}):l.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Cn extends an{constructor(l,p,x,b){super(l,p,x,b),this.roundZoom=!0,this.type="video",this.options=p}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const l=this.options;this.urls=[];for(const p of l.urls)this.urls.push(this.map._requestManager.transformRequest(p,"Source").url);try{const p=yield o.a3(this.urls);if(this._loaded=!0,!p)return;this.video=p,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(p){this.fire(new o.j(p))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const p=this.video.seekable;l<p.start(0)||l>p.end(0)?this.fire(new o.j(new o.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${p.start(0)} and ${p.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,p=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,yn.members)),this.boundsSegments||(this.boundsSegments=o.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.texSubImage2D(p.TEXTURE_2D,0,0,0,p.RGBA,p.UNSIGNED_BYTE,this.video)):(this.texture=new ce(l,this.video,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));let x=!1;for(const b in this.tiles){const S=this.tiles[b];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,x=!0)}x&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class xn extends an{constructor(l,p,x,b){super(l,p,x,b),p.coordinates?Array.isArray(p.coordinates)&&p.coordinates.length===4&&!p.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(A=>typeof A!="number"))||this.fire(new o.j(new o.a2(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.j(new o.a2(`sources.${l}`,null,'missing required property "coordinates"'))),p.animate&&typeof p.animate!="boolean"&&this.fire(new o.j(new o.a2(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),p.canvas?typeof p.canvas=="string"||p.canvas instanceof HTMLCanvasElement||this.fire(new o.j(new o.a2(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.j(new o.a2(`sources.${l}`,null,'missing required property "canvas"'))),this.options=p,this.animate=p.animate===void 0||p.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const p=this.map.painter.context,x=p.gl;this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,yn.members)),this.boundsSegments||(this.boundsSegments=o.a0.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ce(p,this.canvas,x.RGBA,{premultiply:!0});let b=!1;for(const S in this.tiles){const A=this.tiles[S];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture,b=!0)}b&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const di={},Pi=k=>{switch(k){case"geojson":return Kr;case"image":return an;case"raster":return wt;case"raster-dem":return Ft;case"vector":return Vt;case"video":return Cn;case"canvas":return xn}return di[k]},He="RTLPluginLoaded";class Vr extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=xt()}_syncState(l){return this.status=l,this.dispatcher.broadcast("SRPS",{pluginStatus:l,pluginURL:this.url}).catch(p=>{throw this.status="error",p})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(l){return o._(this,arguments,void 0,function*(p,x=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=v.resolveURL(p),!this.url)throw new Error(`requested url ${p} is invalid`);if(this.status==="unavailable"){if(!x)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.k(He))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ct=null;function Ut(){return Ct||(Ct=new Vr),Ct}class wn{constructor(l,p){this.timeAdded=0,this.fadeEndTime=0,this.tileID=l,this.uid=o.a4(),this.uses=0,this.tileSize=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){const p=l+this.timeAdded;p<this.fadeEndTime||(this.fadeEndTime=p)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(l,p,x){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(b,S){const A={};if(!S)return A;for(const M of b){const L=M.layerIds.map(V=>S.getLayer(V)).filter(Boolean);if(L.length!==0){M.layers=L,M.stateDependentLayerIds&&(M.stateDependentLayers=M.stateDependentLayerIds.map(V=>L.filter(H=>H.id===V)[0]));for(const V of L)A[V.id]=M}}return A}(l.buckets,p.style),this.hasSymbolBuckets=!1;for(const b in this.buckets){const S=this.buckets[b];if(S instanceof o.a6){if(this.hasSymbolBuckets=!0,!x)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const b in this.buckets){const S=this.buckets[b];if(S instanceof o.a6&&S.hasRTLText){this.hasRTLText=!0,Ut().lazyLoad();break}}this.queryPadding=0;for(const b in this.buckets){const S=this.buckets[b];this.queryPadding=Math.max(this.queryPadding,p.style.getLayer(b).queryRadius(S))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new o.a5}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const x in this.buckets){const b=this.buckets[x];b.uploadPending()&&b.upload(l)}const p=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ce(l,this.imageAtlas.image,p.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ce(l,this.glyphAtlasImage,p.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,p,x,b,S,A,M,L,V,H){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:b,cameraQueryGeometry:S,scale:A,tileSize:this.tileSize,pixelPosMatrix:H,transform:L,params:M,queryPadding:this.queryPadding*V},l,p,x):{}}querySourceFeatures(l,p){const x=this.latestFeatureIndex;if(!x||!x.rawTileData)return;const b=x.loadVTLayers(),S=p&&p.sourceLayer?p.sourceLayer:"",A=b._geojsonTileLayer||b[S];if(!A)return;const M=o.a7(p&&p.filter),{z:L,x:V,y:H}=this.tileID.canonical,G={z:L,x:V,y:H};for(let ie=0;ie<A.length;ie++){const le=A.feature(ie);if(M.needGeometry){const Se=o.a8(le,!0);if(!M.filter(new o.z(this.tileID.overscaledZ),Se,this.tileID.canonical))continue}else if(!M.filter(new o.z(this.tileID.overscaledZ),le))continue;const he=x.getId(le,S),xe=new o.a9(le,L,V,H,he);xe.tile=G,l.push(xe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const p=this.expirationTime;if(l.cacheControl){const x=o.aa(l.cacheControl);x["max-age"]&&(this.expirationTime=Date.now()+1e3*x["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const x=Date.now();let b=!1;if(this.expirationTime>x)b=!1;else if(p)if(this.expirationTime<p)b=!0;else{const S=this.expirationTime-p;S?this.expirationTime=x+Math.max(S,3e4):b=!0}else b=!0;b?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,p){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const x=this.latestFeatureIndex.loadVTLayers();for(const b in this.buckets){if(!p.style.hasLayer(b))continue;const S=this.buckets[b],A=S.layers[0].sourceLayer||"_geojsonTileLayer",M=x[A],L=l[A];if(!M||!L||Object.keys(L).length===0)continue;S.update(L,M,this.imageAtlas&&this.imageAtlas.patternPositions||{});const V=p&&p.style&&p.style.getLayer(b);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(S)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<v.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=v.now()+l}setDependencies(l,p){const x={};for(const b of p)x[b]=!0;this.dependencies[l]=x}hasDependency(l,p){for(const x of l){const b=this.dependencies[x];if(b){for(const S of p)if(b[S])return!0}}return!1}}class vt{constructor(l,p){this.max=l,this.onRemove=p,this.reset()}reset(){for(const l in this.data)for(const p of this.data[l])p.timeout&&clearTimeout(p.timeout),this.onRemove(p.value);return this.data={},this.order=[],this}add(l,p,x){const b=l.wrapped().key;this.data[b]===void 0&&(this.data[b]=[]);const S={value:p,timeout:void 0};if(x!==void 0&&(S.timeout=setTimeout(()=>{this.remove(l,S)},x)),this.data[b].push(S),this.order.push(b),this.order.length>this.max){const A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const p=this.data[l].shift();return p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),p.value}getByKey(l){const p=this.data[l];return p?p[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,p){if(!this.has(l))return this;const x=l.wrapped().key,b=p===void 0?0:this.data[x].indexOf(p),S=this.data[x][b];return this.data[x].splice(b,1),S.timeout&&clearTimeout(S.timeout),this.data[x].length===0&&delete this.data[x],this.onRemove(S.value),this.order.splice(this.order.indexOf(x),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}filter(l){const p=[];for(const x in this.data)for(const b of this.data[x])l(b.value)||p.push(b);for(const x of p)this.remove(x.value.tileID,x)}}class vr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,p,x){const b=String(p);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][b]=this.stateChanges[l][b]||{},o.e(this.stateChanges[l][b],x),this.deletedStates[l]===null){this.deletedStates[l]={};for(const S in this.state[l])S!==b&&(this.deletedStates[l][S]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][b]===null){this.deletedStates[l][b]={};for(const S in this.state[l][b])x[S]||(this.deletedStates[l][b][S]=null)}else for(const S in x)this.deletedStates[l]&&this.deletedStates[l][b]&&this.deletedStates[l][b][S]===null&&delete this.deletedStates[l][b][S]}removeFeatureState(l,p,x){if(this.deletedStates[l]===null)return;const b=String(p);if(this.deletedStates[l]=this.deletedStates[l]||{},x&&p!==void 0)this.deletedStates[l][b]!==null&&(this.deletedStates[l][b]=this.deletedStates[l][b]||{},this.deletedStates[l][b][x]=null);else if(p!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][b])for(x in this.deletedStates[l][b]={},this.stateChanges[l][b])this.deletedStates[l][b][x]=null;else this.deletedStates[l][b]=null;else this.deletedStates[l]=null}getState(l,p){const x=String(p),b=o.e({},(this.state[l]||{})[x],(this.stateChanges[l]||{})[x]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const S=this.deletedStates[l][p];if(S===null)return{};for(const A in S)delete b[A]}return b}initializeTileState(l,p){l.setFeatureState(this.state,p)}coalesceChanges(l,p){const x={};for(const b in this.stateChanges){this.state[b]=this.state[b]||{};const S={};for(const A in this.stateChanges[b])this.state[b][A]||(this.state[b][A]={}),o.e(this.state[b][A],this.stateChanges[b][A]),S[A]=this.state[b][A];x[b]=S}for(const b in this.deletedStates){this.state[b]=this.state[b]||{};const S={};if(this.deletedStates[b]===null)for(const A in this.state[b])S[A]={},this.state[b][A]={};else for(const A in this.deletedStates[b]){if(this.deletedStates[b][A]===null)this.state[b][A]={};else for(const M of Object.keys(this.deletedStates[b][A]))delete this.state[b][A][M];S[A]=this.state[b][A]}x[b]=x[b]||{},o.e(x[b],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(x).length!==0)for(const b in l)l[b].setFeatureState(x,p)}}class tr extends o.E{constructor(l,p,x){super(),this.id=l,this.dispatcher=x,this.on("data",b=>this._dataHandler(b)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((b,S,A,M)=>{const L=new(Pi(S.type))(b,S,A,M);if(L.id!==b)throw new Error(`Expected Source id to be ${b} instead of ${L.id}`);return L})(l,p,x,this),this._tiles={},this._cache=new vt(0,b=>this._unloadTile(b)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new vr,this._didEmitContent=!1,this._updated=!1}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._maxTileCacheZoomLevels=l?l._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const l in this._tiles){const p=this._tiles[l];if(p.state!=="loaded"&&p.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,p,x){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(l),this._tileLoaded(l,p,x)}catch(b){l.state="errored",b.status!==404?this._source.fire(new o.j(b,{tile:l})):this.update(this.transform,this.terrain)}})}_unloadTile(l){this._source.unloadTile&&this._source.unloadTile(l)}_abortTile(l){this._source.abortTile&&this._source.abortTile(l),this._source.fire(new o.k("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const p in this._tiles){const x=this._tiles[p];x.upload(l),x.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(l=>l.tileID).sort(Zn).map(l=>l.key)}getRenderableIds(l){const p=[];for(const x in this._tiles)this._isIdRenderable(x,l)&&p.push(this._tiles[x]);return l?p.sort((x,b)=>{const S=x.tileID,A=b.tileID,M=new o.P(S.canonical.x,S.canonical.y)._rotate(this.transform.angle),L=new o.P(A.canonical.x,A.canonical.y)._rotate(this.transform.angle);return S.overscaledZ-A.overscaledZ||L.y-M.y||L.x-M.x}).map(x=>x.tileID.key):p.map(x=>x.tileID).sort(Zn).map(x=>x.key)}hasRenderableParent(l){const p=this.findLoadedParent(l,0);return!!p&&this._isIdRenderable(p.tileID.key)}_isIdRenderable(l,p){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(p||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(l,p){return o._(this,void 0,void 0,function*(){const x=this._tiles[l];x&&(x.state!=="loading"&&(x.state=p),yield this._loadTile(x,l,p))})}_tileLoaded(l,p,x){l.timeAdded=v.now(),x==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(p,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new o.k("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const p=this.getRenderableIds();for(let b=0;b<p.length;b++){const S=p[b];if(l.neighboringTiles&&l.neighboringTiles[S]){const A=this.getTileByID(S);x(l,A),x(A,l)}}function x(b,S){b.needsHillshadePrepare=!0,b.needsTerrainPrepare=!0;let A=S.tileID.canonical.x-b.tileID.canonical.x;const M=S.tileID.canonical.y-b.tileID.canonical.y,L=Math.pow(2,b.tileID.canonical.z),V=S.tileID.key;A===0&&M===0||Math.abs(M)>1||(Math.abs(A)>1&&(Math.abs(A+L)===1?A+=L:Math.abs(A-L)===1&&(A-=L)),S.dem&&b.dem&&(b.dem.backfillBorder(S.dem,A,M),b.neighboringTiles&&b.neighboringTiles[V]&&(b.neighboringTiles[V].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,p,x,b){for(const S in this._tiles){let A=this._tiles[S];if(b[S]||!A.hasData()||A.tileID.overscaledZ<=p||A.tileID.overscaledZ>x)continue;let M=A.tileID;for(;A&&A.tileID.overscaledZ>p+1;){const V=A.tileID.scaledTo(A.tileID.overscaledZ-1);A=this._tiles[V.key],A&&A.hasData()&&(M=V)}let L=M;for(;L.overscaledZ>p;)if(L=L.scaledTo(L.overscaledZ-1),l[L.key]){b[M.key]=M;break}}}findLoadedParent(l,p){if(l.key in this._loadedParentTiles){const x=this._loadedParentTiles[l.key];return x&&x.tileID.overscaledZ>=p?x:null}for(let x=l.overscaledZ-1;x>=p;x--){const b=l.scaledTo(x),S=this._getLoadedTile(b);if(S)return S}}findLoadedSibling(l){return this._getLoadedTile(l)}_getLoadedTile(l){const p=this._tiles[l.key];return p&&p.hasData()?p:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){const p=Math.ceil(l.width/this._source.tileSize)+1,x=Math.ceil(l.height/this._source.tileSize)+1,b=Math.floor(p*x*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(S)}handleWrapJump(l){const p=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,p){const x={};for(const b in this._tiles){const S=this._tiles[b];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+p),x[S.tileID.key]=S}this._tiles=x;for(const b in this._timers)clearTimeout(this._timers[b]),delete this._timers[b];for(const b in this._tiles)this._setTileReloadTimer(b,this._tiles[b])}}_updateCoveredAndRetainedTiles(l,p,x,b,S,A){const M={},L={},V=Object.keys(l),H=v.now();for(const G of V){const ie=l[G],le=this._tiles[G];if(!le||le.fadeEndTime!==0&&le.fadeEndTime<=H)continue;const he=this.findLoadedParent(ie,p),xe=this.findLoadedSibling(ie),Se=he||xe||null;Se&&(this._addTile(Se.tileID),M[Se.tileID.key]=Se.tileID),L[G]=ie}this._retainLoadedChildren(L,b,x,l);for(const G in M)l[G]||(this._coveredTiles[G]=!0,l[G]=M[G]);if(A){const G={},ie={};for(const le of S)this._tiles[le.key].hasData()?G[le.key]=le:ie[le.key]=le;for(const le in ie){const he=ie[le].children(this._source.maxzoom);this._tiles[he[0].key]&&this._tiles[he[1].key]&&this._tiles[he[2].key]&&this._tiles[he[3].key]&&(G[he[0].key]=l[he[0].key]=he[0],G[he[1].key]=l[he[1].key]=he[1],G[he[2].key]=l[he[2].key]=he[2],G[he[3].key]=l[he[3].key]=he[3],delete ie[le])}for(const le in ie){const he=ie[le],xe=this.findLoadedParent(he,this._source.minzoom),Se=this.findLoadedSibling(he),Ce=xe||Se||null;if(Ce){G[Ce.tileID.key]=l[Ce.tileID.key]=Ce.tileID;for(const je in G)G[je].isChildOf(Ce.tileID)&&delete G[je]}}for(const le in this._tiles)G[le]||(this._coveredTiles[le]=!0)}}update(l,p){if(!this._sourceLoaded||this._paused)return;let x;this.transform=l,this.terrain=p,this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?x=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(H=>new o.S(H.canonical.z,H.wrap,H.canonical.z,H.canonical.x,H.canonical.y)):(x=l.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:p}),this._source.hasTile&&(x=x.filter(H=>this._source.hasTile(H)))):x=[];const b=l.coveringZoomLevel(this._source),S=Math.max(b-tr.maxOverzooming,this._source.minzoom),A=Math.max(b+tr.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const H={};for(const G of x)if(G.canonical.z>this._source.minzoom){const ie=G.scaledTo(G.canonical.z-1);H[ie.key]=ie;const le=G.scaledTo(Math.max(this._source.minzoom,Math.min(G.canonical.z,5)));H[le.key]=le}x=x.concat(Object.values(H))}const M=x.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,M&&this.fire(new o.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const L=this._updateRetainedTiles(x,b);_i(this._source.type)&&this._updateCoveredAndRetainedTiles(L,S,A,b,x,p);for(const H in L)this._tiles[H].clearFadeHold();const V=o.ab(this._tiles,L);for(const H of V){const G=this._tiles[H];G.hasSymbolBuckets&&!G.holdingForFade()?G.setHoldDuration(this.map._fadeDuration):G.hasSymbolBuckets&&!G.symbolFadeFinished()||this._removeTile(H)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,p){var x;const b={},S={},A=Math.max(p-tr.maxOverzooming,this._source.minzoom),M=Math.max(p+tr.maxUnderzooming,this._source.minzoom),L={};for(const V of l){const H=this._addTile(V);b[V.key]=V,H.hasData()||p<this._source.maxzoom&&(L[V.key]=V)}this._retainLoadedChildren(L,p,M,b);for(const V of l){let H=this._tiles[V.key];if(H.hasData())continue;if(p+1>this._source.maxzoom){const ie=V.children(this._source.maxzoom)[0],le=this.getTile(ie);if(le&&le.hasData()){b[ie.key]=ie;continue}}else{const ie=V.children(this._source.maxzoom);if(b[ie[0].key]&&b[ie[1].key]&&b[ie[2].key]&&b[ie[3].key])continue}let G=H.wasRequested();for(let ie=V.overscaledZ-1;ie>=A;--ie){const le=V.scaledTo(ie);if(S[le.key])break;if(S[le.key]=!0,H=this.getTile(le),!H&&G&&(H=this._addTile(le)),H){const he=H.hasData();if((he||!(!((x=this.map)===null||x===void 0)&&x.cancelPendingTileRequestsWhileZooming)||G)&&(b[le.key]=le),G=H.wasRequested(),he)break}}}return b}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const p=[];let x,b=this._tiles[l].tileID;for(;b.overscaledZ>0;){if(b.key in this._loadedParentTiles){x=this._loadedParentTiles[b.key];break}p.push(b.key);const S=b.scaledTo(b.overscaledZ-1);if(x=this._getLoadedTile(S),x)break;b=S}for(const S of p)this._loadedParentTiles[S]=x}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const l in this._tiles){const p=this._tiles[l].tileID,x=this._getLoadedTile(p);this._loadedSiblingTiles[p.key]=x}}_addTile(l){let p=this._tiles[l.key];if(p)return p;p=this._cache.getAndRemove(l),p&&(this._setTileReloadTimer(l.key,p),p.tileID=l,this._state.initializeTileState(p,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,p)));const x=p;return p||(p=new wn(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(p,l.key,p.state)),p.uses++,this._tiles[l.key]=p,x||this._source.fire(new o.k("dataloading",{tile:p,coord:p.tileID,dataType:"source"})),p}_setTileReloadTimer(l,p){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const x=p.getExpiryTimeout();x&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},x))}_removeTile(l){const p=this._tiles[l];p&&(p.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),p.uses>0||(p.hasData()&&p.state!=="reloading"?this._cache.add(p.tileID,p,p.getExpiryTimeout()):(p.aborted=!0,this._abortTile(p),this._unloadTile(p))))}_dataHandler(l){const p=l.sourceDataType;l.dataType==="source"&&p==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&l.dataType==="source"&&p==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,p,x){const b=[],S=this.transform;if(!S)return b;const A=x?S.getCameraQueryGeometry(l):l,M=l.map(he=>S.pointCoordinate(he,this.terrain)),L=A.map(he=>S.pointCoordinate(he,this.terrain)),V=this.getIds();let H=1/0,G=1/0,ie=-1/0,le=-1/0;for(const he of L)H=Math.min(H,he.x),G=Math.min(G,he.y),ie=Math.max(ie,he.x),le=Math.max(le,he.y);for(let he=0;he<V.length;he++){const xe=this._tiles[V[he]];if(xe.holdingForFade())continue;const Se=xe.tileID,Ce=Math.pow(2,S.zoom-xe.tileID.overscaledZ),je=p*xe.queryPadding*o.X/xe.tileSize/Ce,pe=[Se.getTilePoint(new o.Z(H,G)),Se.getTilePoint(new o.Z(ie,le))];if(pe[0].x-je<o.X&&pe[0].y-je<o.X&&pe[1].x+je>=0&&pe[1].y+je>=0){const Fe=M.map(Je=>Se.getTilePoint(Je)),Ue=L.map(Je=>Se.getTilePoint(Je));b.push({tile:xe,tileID:Se,queryGeometry:Fe,cameraQueryGeometry:Ue,scale:Ce})}}return b}getVisibleCoordinates(l){const p=this.getRenderableIds(l).map(x=>this._tiles[x].tileID);for(const x of p)x.posMatrix=this.transform.calculatePosMatrix(x.toUnwrapped());return p}hasTransition(){if(this._source.hasTransition())return!0;if(_i(this._source.type)){const l=v.now();for(const p in this._tiles)if(this._tiles[p].fadeEndTime>=l)return!0}return!1}setFeatureState(l,p,x){this._state.updateState(l=l||"_geojsonTileLayer",p,x)}removeFeatureState(l,p,x){this._state.removeFeatureState(l=l||"_geojsonTileLayer",p,x)}getFeatureState(l,p){return this._state.getState(l=l||"_geojsonTileLayer",p)}setDependencies(l,p,x){const b=this._tiles[l];b&&b.setDependencies(p,x)}reloadTilesForDependencies(l,p){for(const x in this._tiles)this._tiles[x].hasDependency(l,p)&&this._reloadTile(x,"reloading");this._cache.filter(x=>!x.hasDependency(l,p))}}function Zn(k,l){const p=Math.abs(2*k.wrap)-+(k.wrap<0),x=Math.abs(2*l.wrap)-+(l.wrap<0);return k.overscaledZ-l.overscaledZ||x-p||l.canonical.y-k.canonical.y||l.canonical.x-k.canonical.x}function _i(k){return k==="raster"||k==="image"||k==="video"}tr.maxOverzooming=10,tr.maxUnderzooming=3;class pr{constructor(l,p){this.reset(l,p)}reset(l,p){this.points=l||[],this._distances=[0];for(let x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=o.ac(l,0,1);let p=1,x=this._distances[p];const b=l*this.paddedLength+this.padding;for(;x<b&&p<this._distances.length;)x=this._distances[++p];const S=p-1,A=this._distances[S],M=x-A,L=M>0?(b-A)/M:0;return this.points[S].mult(1-L).add(this.points[p].mult(L))}}function Di(k,l){let p=!0;return k==="always"||k!=="never"&&l!=="never"||(p=!1),p}class ks{constructor(l,p,x){const b=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(l/x),this.yCellCount=Math.ceil(p/x);for(let A=0;A<this.xCellCount*this.yCellCount;A++)b.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=p,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,p,x,b,S){this._forEachCell(p,x,b,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(p),this.bboxes.push(x),this.bboxes.push(b),this.bboxes.push(S)}insertCircle(l,p,x,b){this._forEachCell(p-b,x-b,p+b,x+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(p),this.circles.push(x),this.circles.push(b)}_insertBoxCell(l,p,x,b,S,A){this.boxCells[S].push(A)}_insertCircleCell(l,p,x,b,S,A){this.circleCells[S].push(A)}_query(l,p,x,b,S,A,M){if(x<0||l>this.width||b<0||p>this.height)return[];const L=[];if(l<=0&&p<=0&&this.width<=x&&this.height<=b){if(S)return[{key:null,x1:l,y1:p,x2:x,y2:b}];for(let V=0;V<this.boxKeys.length;V++)L.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(let V=0;V<this.circleKeys.length;V++){const H=this.circles[3*V],G=this.circles[3*V+1],ie=this.circles[3*V+2];L.push({key:this.circleKeys[V],x1:H-ie,y1:G-ie,x2:H+ie,y2:G+ie})}}else this._forEachCell(l,p,x,b,this._queryCell,L,{hitTest:S,overlapMode:A,seenUids:{box:{},circle:{}}},M);return L}query(l,p,x,b){return this._query(l,p,x,b,!1,null)}hitTest(l,p,x,b,S,A){return this._query(l,p,x,b,!0,S,A).length>0}hitTestCircle(l,p,x,b,S){const A=l-x,M=l+x,L=p-x,V=p+x;if(M<0||A>this.width||V<0||L>this.height)return!1;const H=[];return this._forEachCell(A,L,M,V,this._queryCellCircle,H,{hitTest:!0,overlapMode:b,circle:{x:l,y:p,radius:x},seenUids:{box:{},circle:{}}},S),H.length>0}_queryCell(l,p,x,b,S,A,M,L){const{seenUids:V,hitTest:H,overlapMode:G}=M,ie=this.boxCells[S];if(ie!==null){const he=this.bboxes;for(const xe of ie)if(!V.box[xe]){V.box[xe]=!0;const Se=4*xe,Ce=this.boxKeys[xe];if(l<=he[Se+2]&&p<=he[Se+3]&&x>=he[Se+0]&&b>=he[Se+1]&&(!L||L(Ce))&&(!H||!Di(G,Ce.overlapMode))&&(A.push({key:Ce,x1:he[Se],y1:he[Se+1],x2:he[Se+2],y2:he[Se+3]}),H))return!0}}const le=this.circleCells[S];if(le!==null){const he=this.circles;for(const xe of le)if(!V.circle[xe]){V.circle[xe]=!0;const Se=3*xe,Ce=this.circleKeys[xe];if(this._circleAndRectCollide(he[Se],he[Se+1],he[Se+2],l,p,x,b)&&(!L||L(Ce))&&(!H||!Di(G,Ce.overlapMode))){const je=he[Se],pe=he[Se+1],Fe=he[Se+2];if(A.push({key:Ce,x1:je-Fe,y1:pe-Fe,x2:je+Fe,y2:pe+Fe}),H)return!0}}}return!1}_queryCellCircle(l,p,x,b,S,A,M,L){const{circle:V,seenUids:H,overlapMode:G}=M,ie=this.boxCells[S];if(ie!==null){const he=this.bboxes;for(const xe of ie)if(!H.box[xe]){H.box[xe]=!0;const Se=4*xe,Ce=this.boxKeys[xe];if(this._circleAndRectCollide(V.x,V.y,V.radius,he[Se+0],he[Se+1],he[Se+2],he[Se+3])&&(!L||L(Ce))&&!Di(G,Ce.overlapMode))return A.push(!0),!0}}const le=this.circleCells[S];if(le!==null){const he=this.circles;for(const xe of le)if(!H.circle[xe]){H.circle[xe]=!0;const Se=3*xe,Ce=this.circleKeys[xe];if(this._circlesCollide(he[Se],he[Se+1],he[Se+2],V.x,V.y,V.radius)&&(!L||L(Ce))&&!Di(G,Ce.overlapMode))return A.push(!0),!0}}}_forEachCell(l,p,x,b,S,A,M,L){const V=this._convertToXCellCoord(l),H=this._convertToYCellCoord(p),G=this._convertToXCellCoord(x),ie=this._convertToYCellCoord(b);for(let le=V;le<=G;le++)for(let he=H;he<=ie;he++)if(S.call(this,l,p,x,b,this.xCellCount*he+le,A,M,L))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,p,x,b,S,A){const M=b-l,L=S-p,V=x+A;return V*V>M*M+L*L}_circleAndRectCollide(l,p,x,b,S,A,M){const L=(A-b)/2,V=Math.abs(l-(b+L));if(V>L+x)return!1;const H=(M-S)/2,G=Math.abs(p-(S+H));if(G>H+x)return!1;if(V<=L||G<=H)return!0;const ie=V-L,le=G-H;return ie*ie+le*le<=x*x}}function Li(k,l,p,x,b){const S=o.H();return l?(o.K(S,S,[1/b,1/b,1]),p||o.ad(S,S,x.angle)):o.L(S,x.labelPlaneMatrix,k),S}function cs(k,l,p,x,b){if(l){const S=o.ae(k);return o.K(S,S,[b,b,1]),p||o.ad(S,S,-x.angle),S}return x.glCoordMatrix}function ge(k,l,p,x){let b;x?(b=[k,l,x(k,l),1],o.af(b,b,p)):(b=[k,l,0,1],Ur(b,b,p));const S=b[3];return{point:new o.P(b[0]/S,b[1]/S),signedDistanceFromCamera:S,isOccluded:!1}}function W(k,l){return .5+k/l*.5}function Q(k,l){return k.x>=-l[0]&&k.x<=l[0]&&k.y>=-l[1]&&k.y<=l[1]}function te(k,l,p,x,b,S,A,M,L,V,H,G,ie,le,he){const xe=x?k.textSizeData:k.iconSizeData,Se=o.ag(xe,p.transform.zoom),Ce=[256/p.width*2+1,256/p.height*2+1],je=x?k.text.dynamicLayoutVertexArray:k.icon.dynamicLayoutVertexArray;je.clear();const pe=k.lineVertexArray,Fe=x?k.text.placedSymbolArray:k.icon.placedSymbolArray,Ue=p.transform.width/p.transform.height;let Je=!1;for(let ft=0;ft<Fe.length;ft++){const kt=Fe.get(ft);if(kt.hidden||kt.writingMode===o.ah.vertical&&!Je){nr(kt.numGlyphs,je);continue}Je=!1;const Lt=ge(kt.anchorX,kt.anchorY,l,he);if(!Q(Lt.point,Ce)){nr(kt.numGlyphs,je);continue}const qt=W(p.transform.cameraToCenterDistance,Lt.signedDistanceFromCamera),zt=o.ai(xe,Se,kt),At=A?zt/qt:zt*qt,ar={getElevation:he,labelPlaneMatrix:b,lineVertexArray:pe,pitchWithMap:A,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:V,tileAnchorPoint:new o.P(kt.anchorX,kt.anchorY),unwrappedTileID:H,width:G,height:ie,translation:le},Pr=ke(ar,kt,At,!1,M,l,S,k.glyphOffsetArray,je,Ue,L);Je=Pr.useVertical,(Pr.notEnoughRoom||Je||Pr.needsFlipping&&ke(ar,kt,At,!0,M,l,S,k.glyphOffsetArray,je,Ue,L).notEnoughRoom)&&nr(kt.numGlyphs,je)}x?k.text.dynamicLayoutVertexBuffer.updateData(je):k.icon.dynamicLayoutVertexBuffer.updateData(je)}function de(k,l,p,x,b,S,A,M){const L=S.glyphStartIndex+S.numGlyphs,V=S.lineStartIndex,H=S.lineStartIndex+S.lineLength,G=l.getoffsetX(S.glyphStartIndex),ie=l.getoffsetX(L-1),le=ut(k*G,p,x,b,S.segment,V,H,M,A);if(!le)return null;const he=ut(k*ie,p,x,b,S.segment,V,H,M,A);return he?M.projectionCache.anyProjectionOccluded?null:{first:le,last:he}:null}function be(k,l,p,x){return k===o.ah.horizontal&&Math.abs(p.y-l.y)>Math.abs(p.x-l.x)*x?{useVertical:!0}:(k===o.ah.vertical?l.y<p.y:l.x>p.x)?{needsFlipping:!0}:null}function ke(k,l,p,x,b,S,A,M,L,V,H){const G=p/24,ie=l.lineOffsetX*G,le=l.lineOffsetY*G;let he;if(l.numGlyphs>1){const xe=l.glyphStartIndex+l.numGlyphs,Se=l.lineStartIndex,Ce=l.lineStartIndex+l.lineLength,je=de(G,M,ie,le,x,l,H,k);if(!je)return{notEnoughRoom:!0};const pe=ge(je.first.point.x,je.first.point.y,A,k.getElevation).point,Fe=ge(je.last.point.x,je.last.point.y,A,k.getElevation).point;if(b&&!x){const Ue=be(l.writingMode,pe,Fe,V);if(Ue)return Ue}he=[je.first];for(let Ue=l.glyphStartIndex+1;Ue<xe-1;Ue++)he.push(ut(G*M.getoffsetX(Ue),ie,le,x,l.segment,Se,Ce,k,H));he.push(je.last)}else{if(b&&!x){const Se=ge(k.tileAnchorPoint.x,k.tileAnchorPoint.y,S,k.getElevation).point,Ce=l.lineStartIndex+l.segment+1,je=new o.P(k.lineVertexArray.getx(Ce),k.lineVertexArray.gety(Ce)),pe=ge(je.x,je.y,S,k.getElevation),Fe=pe.signedDistanceFromCamera>0?pe.point:function(Je,ft,kt,Lt,qt,zt){return $e(Je,ft,kt,1,qt,zt)}(k.tileAnchorPoint,je,Se,0,S,k),Ue=be(l.writingMode,Se,Fe,V);if(Ue)return Ue}const xe=ut(G*M.getoffsetX(l.glyphStartIndex),ie,le,x,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,k,H);if(!xe||k.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};he=[xe]}for(const xe of he)o.aj(L,xe.point,xe.angle);return{}}function $e(k,l,p,x,b,S){const A=k.add(k.sub(l)._unit()),M=b!==void 0?ge(A.x,A.y,b,S.getElevation).point:nt(A.x,A.y,S).point,L=p.sub(M);return p.add(L._mult(x/L.mag()))}function _e(k,l,p){const x=l.projectionCache;if(x.projections[k])return x.projections[k];const b=new o.P(l.lineVertexArray.getx(k),l.lineVertexArray.gety(k)),S=nt(b.x,b.y,l);if(S.signedDistanceFromCamera>0)return x.projections[k]=S.point,x.anyProjectionOccluded=x.anyProjectionOccluded||S.isOccluded,S.point;const A=k-p.direction;return function(M,L,V,H,G){return $e(M,L,V,H,void 0,G)}(p.distanceFromAnchor===0?l.tileAnchorPoint:new o.P(l.lineVertexArray.getx(A),l.lineVertexArray.gety(A)),b,p.previousVertex,p.absOffsetX-p.distanceFromAnchor+1,l)}function nt(k,l,p){const x=k+p.translation[0],b=l+p.translation[1];let S;return!p.pitchWithMap&&p.projection.useSpecialProjectionForSymbols?(S=p.projection.projectTileCoordinates(x,b,p.unwrappedTileID,p.getElevation),S.point.x=(.5*S.point.x+.5)*p.width,S.point.y=(.5*-S.point.y+.5)*p.height):(S=ge(x,b,p.labelPlaneMatrix,p.getElevation),S.isOccluded=!1),S}function dt(k,l,p){return k._unit()._perp()._mult(l*p)}function ve(k,l,p,x,b,S,A,M,L){if(M.projectionCache.offsets[k])return M.projectionCache.offsets[k];const V=p.add(l);if(k+L.direction<x||k+L.direction>=b)return M.projectionCache.offsets[k]=V,V;const H=_e(k+L.direction,M,L),G=dt(H.sub(p),A,L.direction),ie=p.add(G),le=H.add(G);return M.projectionCache.offsets[k]=o.ak(S,V,ie,le)||V,M.projectionCache.offsets[k]}function ut(k,l,p,x,b,S,A,M,L){const V=x?k-l:k+l;let H=V>0?1:-1,G=0;x&&(H*=-1,G=Math.PI),H<0&&(G+=Math.PI);let ie,le=H>0?S+b:S+b+1;M.projectionCache.cachedAnchorPoint?ie=M.projectionCache.cachedAnchorPoint:(ie=nt(M.tileAnchorPoint.x,M.tileAnchorPoint.y,M).point,M.projectionCache.cachedAnchorPoint=ie);let he,xe,Se=ie,Ce=ie,je=0,pe=0;const Fe=Math.abs(V),Ue=[];let Je;for(;je+pe<=Fe;){if(le+=H,le<S||le>=A)return null;je+=pe,Ce=Se,xe=he;const Lt={absOffsetX:Fe,direction:H,distanceFromAnchor:je,previousVertex:Ce};if(Se=_e(le,M,Lt),p===0)Ue.push(Ce),Je=Se.sub(Ce);else{let qt;const zt=Se.sub(Ce);qt=zt.mag()===0?dt(_e(le+H,M,Lt).sub(Se),p,H):dt(zt,p,H),xe||(xe=Ce.add(qt)),he=ve(le,qt,Se,S,A,xe,p,M,Lt),Ue.push(xe),Je=he.sub(xe)}pe=Je.mag()}const ft=Je._mult((Fe-je)/pe)._add(xe||Ce),kt=G+Math.atan2(Se.y-Ce.y,Se.x-Ce.x);return Ue.push(ft),{point:ft,angle:L?kt:0,path:Ue}}const Dt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function nr(k,l){for(let p=0;p<k;p++){const x=l.length;l.resize(x+4),l.float32.set(Dt,3*x)}}function Ur(k,l,p){const x=l[0],b=l[1];return k[0]=p[0]*x+p[4]*b+p[12],k[1]=p[1]*x+p[5]*b+p[13],k[3]=p[3]*x+p[7]*b+p[15],k}const Ir=100;class en{constructor(l,p,x=new ks(l.width+200,l.height+200,25),b=new ks(l.width+200,l.height+200,25)){this.transform=l,this.mapProjection=p,this.grid=x,this.ignoredGrid=b,this.pitchFactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Ir,this.screenBottomBoundary=l.height+Ir,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,p,x,b,S,A,M,L,V,H,G){const ie=l.anchorPointX+L[0],le=l.anchorPointY+L[1],he=this.projectAndGetPerspectiveRatio(b,ie,le,S,H),xe=x*he.perspectiveRatio;let Se;if(A||M)Se=this._projectCollisionBox(l,xe,b,S,A,M,L,he,H,G);else{const Ue=he.point.x+(G?G.x*xe:0),Je=he.point.y+(G?G.y*xe:0);Se={allPointsOccluded:!1,box:[Ue+l.x1*xe,Je+l.y1*xe,Ue+l.x2*xe,Je+l.y2*xe]}}const[Ce,je,pe,Fe]=Se.box;return this.mapProjection.useSpecialProjectionForSymbols&&(A?Se.allPointsOccluded:this.mapProjection.isOccluded(ie,le,S))||he.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(Ce,je,pe,Fe)||p!=="always"&&this.grid.hitTest(Ce,je,pe,Fe,p,V)?{box:[Ce,je,pe,Fe],placeable:!1,offscreen:!1}:{box:[Ce,je,pe,Fe],placeable:!0,offscreen:this.isOffscreen(Ce,je,pe,Fe)}}placeCollisionCircles(l,p,x,b,S,A,M,L,V,H,G,ie,le,he,xe,Se){const Ce=[],je=new o.P(p.anchorX,p.anchorY),pe=this.getPerspectiveRatio(A,je.x,je.y,M,Se),Fe=(G?S/pe:S*pe)/o.ap,Ue={getElevation:Se,labelPlaneMatrix:L,lineVertexArray:x,pitchWithMap:G,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:je,unwrappedTileID:M,width:this.transform.width,height:this.transform.height,translation:xe},Je=de(Fe,b,p.lineOffsetX*Fe,p.lineOffsetY*Fe,!1,p,!1,Ue);let ft=!1,kt=!1,Lt=!0;if(Je){const qt=.5*le*pe+he,zt=new o.P(-100,-100),At=new o.P(this.screenRightBoundary,this.screenBottomBoundary),ar=new pr,Pr=Je.first,It=Je.last;let Nt=[];for(let $r=Pr.path.length-1;$r>=1;$r--)Nt.push(Pr.path[$r]);for(let $r=1;$r<It.path.length;$r++)Nt.push(It.path[$r]);const Tr=2.5*qt;if(V){const $r=this.projectPathToScreenSpace(Nt,Ue,V);Nt=$r.some(Gr=>Gr.signedDistanceFromCamera<=0)?[]:$r.map(Gr=>Gr.point)}let Qn=[];if(Nt.length>0){const $r=Nt[0].clone(),Gr=Nt[0].clone();for(let Hn=1;Hn<Nt.length;Hn++)$r.x=Math.min($r.x,Nt[Hn].x),$r.y=Math.min($r.y,Nt[Hn].y),Gr.x=Math.max(Gr.x,Nt[Hn].x),Gr.y=Math.max(Gr.y,Nt[Hn].y);Qn=$r.x>=zt.x&&Gr.x<=At.x&&$r.y>=zt.y&&Gr.y<=At.y?[Nt]:Gr.x<zt.x||$r.x>At.x||Gr.y<zt.y||$r.y>At.y?[]:o.al([Nt],zt.x,zt.y,At.x,At.y)}for(const $r of Qn){ar.reset($r,.25*qt);let Gr=0;Gr=ar.length<=.5*qt?1:Math.ceil(ar.paddedLength/Tr)+1;for(let Hn=0;Hn<Gr;Hn++){const As=Hn/Math.max(Gr-1,1),La=ar.lerp(As),Gn=La.x+Ir,ho=La.y+Ir;Ce.push(Gn,ho,qt,0);const qs=Gn-qt,Es=ho-qt,Qs=Gn+qt,pl=ho+qt;if(Lt=Lt&&this.isOffscreen(qs,Es,Qs,pl),kt=kt||this.isInsideGrid(qs,Es,Qs,pl),l!=="always"&&this.grid.hitTestCircle(Gn,ho,qt,l,ie)&&(ft=!0,!H))return{circles:[],offscreen:!1,collisionDetected:ft}}}}return{circles:!H&&ft||!kt||pe<this.perspectiveRatioCutoff?[]:Ce,offscreen:Lt,collisionDetected:ft}}projectPathToScreenSpace(l,p,x){return l.map(b=>ge(b.x,b.y,x,p.getElevation))}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const p=[];let x=1/0,b=1/0,S=-1/0,A=-1/0;for(const H of l){const G=new o.P(H.x+Ir,H.y+Ir);x=Math.min(x,G.x),b=Math.min(b,G.y),S=Math.max(S,G.x),A=Math.max(A,G.y),p.push(G)}const M=this.grid.query(x,b,S,A).concat(this.ignoredGrid.query(x,b,S,A)),L={},V={};for(const H of M){const G=H.key;if(L[G.bucketInstanceId]===void 0&&(L[G.bucketInstanceId]={}),L[G.bucketInstanceId][G.featureIndex])continue;const ie=[new o.P(H.x1,H.y1),new o.P(H.x2,H.y1),new o.P(H.x2,H.y2),new o.P(H.x1,H.y2)];o.am(p,ie)&&(L[G.bucketInstanceId][G.featureIndex]=!0,V[G.bucketInstanceId]===void 0&&(V[G.bucketInstanceId]=[]),V[G.bucketInstanceId].push(G.featureIndex))}return V}insertCollisionBox(l,p,x,b,S,A){(x?this.ignoredGrid:this.grid).insert({bucketInstanceId:b,featureIndex:S,collisionGroupID:A,overlapMode:p},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,p,x,b,S,A){const M=x?this.ignoredGrid:this.grid,L={bucketInstanceId:b,featureIndex:S,collisionGroupID:A,overlapMode:p};for(let V=0;V<l.length;V+=4)M.insertCircle(L,l[V],l[V+1],l[V+2])}projectAndGetPerspectiveRatio(l,p,x,b,S){let A;S?(A=[p,x,S(p,x),1],o.af(A,A,l)):(A=[p,x,0,1],Ur(A,A,l));const M=A[3];return{point:new o.P((A[0]/M+1)/2*this.transform.width+Ir,(-A[1]/M+1)/2*this.transform.height+Ir),perspectiveRatio:.5+this.transform.cameraToCenterDistance/M*.5,isOccluded:!1,signedDistanceFromCamera:M}}getPerspectiveRatio(l,p,x,b,S){const A=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(p,x,b,S):ge(p,x,l,S);return .5+this.transform.cameraToCenterDistance/A.signedDistanceFromCamera*.5}isOffscreen(l,p,x,b){return x<Ir||l>=this.screenRightBoundary||b<Ir||p>this.screenBottomBoundary}isInsideGrid(l,p,x,b){return x>=0&&l<this.gridRightBoundary&&b>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const l=o.an([]);return o.J(l,l,[-100,-100,0]),l}_projectCollisionBox(l,p,x,b,S,A,M,L,V,H){let G=new o.P(1,0),ie=new o.P(0,1);const le=new o.P(l.anchorPointX+M[0],l.anchorPointY+M[1]);if(A&&!S){const Lt=this.projectAndGetPerspectiveRatio(x,le.x+1,le.y,b,V).point.sub(L.point).unit(),qt=Math.atan(Lt.y/Lt.x)+(Lt.x<0?Math.PI:0),zt=Math.sin(qt),At=Math.cos(qt);G=new o.P(At,zt),ie=new o.P(-zt,At)}else if(!A&&S){const Lt=-this.transform.angle,qt=Math.sin(Lt),zt=Math.cos(Lt);G=new o.P(zt,qt),ie=new o.P(-qt,zt)}let he=L.point,xe=p;if(S){he=le;const Lt=this.transform.zoom-Math.floor(this.transform.zoom);xe=Math.pow(2,-Lt),xe*=this.mapProjection.getPitchedTextCorrection(this.transform,le,b),H||(xe*=o.ac(.5+L.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}H&&(he=he.add(G.mult(H.x*xe)).add(ie.mult(H.y*xe)));const Se=l.x1*xe,Ce=l.x2*xe,je=(Se+Ce)/2,pe=l.y1*xe,Fe=l.y2*xe,Ue=(pe+Fe)/2,Je=[{offsetX:Se,offsetY:pe},{offsetX:je,offsetY:pe},{offsetX:Ce,offsetY:pe},{offsetX:Ce,offsetY:Ue},{offsetX:Ce,offsetY:Fe},{offsetX:je,offsetY:Fe},{offsetX:Se,offsetY:Fe},{offsetX:Se,offsetY:Ue}];let ft=[];for(const{offsetX:Lt,offsetY:qt}of Je)ft.push(new o.P(he.x+G.x*Lt+ie.x*qt,he.y+G.y*Lt+ie.y*qt));let kt=!1;if(S){const Lt=ft.map(qt=>this.projectAndGetPerspectiveRatio(x,qt.x,qt.y,b,V));kt=Lt.some(qt=>!qt.isOccluded),ft=Lt.map(qt=>qt.point)}else kt=!0;return{box:o.ao(ft),allPointsOccluded:!kt}}}function Fr(k,l,p){return l*(o.X/(k.tileSize*Math.pow(2,p-k.tileID.overscaledZ)))}class fi{constructor(l,p,x,b){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?p:-p))):b&&x?1:0,this.placed=x}isHidden(){return this.opacity===0&&!this.placed}}class Yn{constructor(l,p,x,b,S){this.text=new fi(l?l.text:null,p,x,S),this.icon=new fi(l?l.icon:null,p,b,S)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Br{constructor(l,p,x){this.text=l,this.icon=p,this.skipFade=x}}class mn{constructor(){this.invProjMatrix=o.H(),this.viewportMatrix=o.H(),this.circles=[]}}class Bn{constructor(l,p,x,b,S){this.bucketInstanceId=l,this.featureIndex=p,this.sourceLayerIndex=x,this.bucketIndex=b,this.tileID=S}}class Ai{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const p=++this.maxGroupID;this.collisionGroups[l]={ID:p,predicate:x=>x.collisionGroupID===p}}return this.collisionGroups[l]}}function wi(k,l,p,x,b){const{horizontalAlign:S,verticalAlign:A}=o.au(k);return new o.P(-(S-.5)*l+x[0]*b,-(A-.5)*p+x[1]*b)}class us{constructor(l,p,x,b,S,A){this.transform=l.clone(),this.terrain=x,this.collisionIndex=new en(this.transform,p),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=b,this.retainedQueryData={},this.collisionGroups=new Ai(S),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=A,A&&(A.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(l){const p=this.terrain;return p?(x,b)=>p.getElevation(l,x,b):null}getBucketParts(l,p,x,b){const S=x.getBucket(p),A=x.latestFeatureIndex;if(!S||!A||p.id!==S.layerIds[0])return;const M=x.collisionBoxArray,L=S.layers[0].layout,V=S.layers[0].paint,H=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),G=x.tileSize/o.X,ie=x.tileID.toUnwrapped(),le=this.transform.calculatePosMatrix(ie),he=L.get("text-pitch-alignment")==="map",xe=L.get("text-rotation-alignment")==="map",Se=Fr(x,1,this.transform.zoom),Ce=this.collisionIndex.mapProjection.translatePosition(this.transform,x,V.get("text-translate"),V.get("text-translate-anchor")),je=this.collisionIndex.mapProjection.translatePosition(this.transform,x,V.get("icon-translate"),V.get("icon-translate-anchor")),pe=Li(le,he,xe,this.transform,Se);let Fe=null;if(he){const Je=cs(le,he,xe,this.transform,Se);Fe=o.L([],this.transform.labelPlaneMatrix,Je)}this.retainedQueryData[S.bucketInstanceId]=new Bn(S.bucketInstanceId,A,S.sourceLayerIndex,S.index,x.tileID);const Ue={bucket:S,layout:L,translationText:Ce,translationIcon:je,posMatrix:le,unwrappedTileID:ie,textLabelPlaneMatrix:pe,labelToScreenMatrix:Fe,scale:H,textPixelRatio:G,holdingForFade:x.holdingForFade(),collisionBoxArray:M,partiallyEvaluatedTextSize:o.ag(S.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(b)for(const Je of S.sortKeyRanges){const{sortKey:ft,symbolInstanceStart:kt,symbolInstanceEnd:Lt}=Je;l.push({sortKey:ft,symbolInstanceStart:kt,symbolInstanceEnd:Lt,parameters:Ue})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:Ue})}attemptAnchorPlacement(l,p,x,b,S,A,M,L,V,H,G,ie,le,he,xe,Se,Ce,je,pe){const Fe=o.aq[l.textAnchor],Ue=[l.textOffset0,l.textOffset1],Je=wi(Fe,x,b,Ue,S),ft=this.collisionIndex.placeCollisionBox(p,ie,L,V,H,M,A,Se,G.predicate,pe,Je);if((!je||this.collisionIndex.placeCollisionBox(je,ie,L,V,H,M,A,Ce,G.predicate,pe,Je).placeable)&&ft.placeable){let kt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[le.crossTileID]&&this.prevPlacement.placements[le.crossTileID]&&this.prevPlacement.placements[le.crossTileID].text&&(kt=this.prevPlacement.variableOffsets[le.crossTileID].anchor),le.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[le.crossTileID]={textOffset:Ue,width:x,height:b,anchor:Fe,textBoxScale:S,prevAnchor:kt},this.markUsedJustification(he,Fe,le,xe),he.allowVerticalPlacement&&(this.markUsedOrientation(he,xe,le),this.placedOrientations[le.crossTileID]=xe),{shift:Je,placedGlyphBoxes:ft}}}placeLayerBucketPart(l,p,x){const{bucket:b,layout:S,translationText:A,translationIcon:M,posMatrix:L,unwrappedTileID:V,textLabelPlaneMatrix:H,labelToScreenMatrix:G,textPixelRatio:ie,holdingForFade:le,collisionBoxArray:he,partiallyEvaluatedTextSize:xe,collisionGroup:Se}=l.parameters,Ce=S.get("text-optional"),je=S.get("icon-optional"),pe=o.ar(S,"text-overlap","text-allow-overlap"),Fe=pe==="always",Ue=o.ar(S,"icon-overlap","icon-allow-overlap"),Je=Ue==="always",ft=S.get("text-rotation-alignment")==="map",kt=S.get("text-pitch-alignment")==="map",Lt=S.get("icon-text-fit")!=="none",qt=S.get("symbol-z-order")==="viewport-y",zt=Fe&&(Je||!b.hasIconData()||je),At=Je&&(Fe||!b.hasTextData()||Ce);!b.collisionArrays&&he&&b.deserializeCollisionBoxes(he);const ar=this._getTerrainElevationFunc(this.retainedQueryData[b.bucketInstanceId].tileID),Pr=(It,Nt,Tr)=>{var Qn,$r;if(p[It.crossTileID])return;if(le)return void(this.placements[It.crossTileID]=new Br(!1,!1,!1));let Gr=!1,Hn=!1,As=!0,La=null,Gn={box:null,placeable:!1,offscreen:null},ho={placeable:!1},qs=null,Es=null,Qs=null,pl=0,Kh=0,Ym=0;Nt.textFeatureIndex?pl=Nt.textFeatureIndex:It.useRuntimeCollisionCircles&&(pl=It.featureIndex),Nt.verticalTextFeatureIndex&&(Kh=Nt.verticalTextFeatureIndex);const Zh=Nt.textBox;if(Zh){const oa=hs=>{let zs=o.ah.horizontal;if(b.allowVerticalPlacement&&!hs&&this.prevPlacement){const Mo=this.prevPlacement.placedOrientations[It.crossTileID];Mo&&(this.placedOrientations[It.crossTileID]=Mo,zs=Mo,this.markUsedOrientation(b,zs,It))}return zs},aa=(hs,zs)=>{if(b.allowVerticalPlacement&&It.numVerticalGlyphVertices>0&&Nt.verticalTextBox){for(const Mo of b.writingModes)if(Mo===o.ah.vertical?(Gn=zs(),ho=Gn):Gn=hs(),Gn&&Gn.placeable)break}else Gn=hs()},Ic=It.textAnchorOffsetStartIndex,Fa=It.textAnchorOffsetEndIndex;if(Fa===Ic){const hs=(zs,Mo)=>{const Yr=this.collisionIndex.placeCollisionBox(zs,pe,ie,L,V,kt,ft,A,Se.predicate,ar);return Yr&&Yr.placeable&&(this.markUsedOrientation(b,Mo,It),this.placedOrientations[It.crossTileID]=Mo),Yr};aa(()=>hs(Zh,o.ah.horizontal),()=>{const zs=Nt.verticalTextBox;return b.allowVerticalPlacement&&It.numVerticalGlyphVertices>0&&zs?hs(zs,o.ah.vertical):{box:null,offscreen:null}}),oa(Gn&&Gn.placeable)}else{let hs=o.aq[($r=(Qn=this.prevPlacement)===null||Qn===void 0?void 0:Qn.variableOffsets[It.crossTileID])===null||$r===void 0?void 0:$r.anchor];const zs=(Yr,Bu,Yh)=>{const Jh=Yr.x2-Yr.x1,y_=Yr.y2-Yr.y1,QC=It.textBoxScale,x_=Lt&&Ue==="never"?Bu:null;let Rc=null,v_=pe==="never"?1:2,eg="never";hs&&v_++;for(let Gf=0;Gf<v_;Gf++){for(let tg=Ic;tg<Fa;tg++){const rg=b.textAnchorOffsets.get(tg);if(hs&&rg.textAnchor!==hs)continue;const ed=this.attemptAnchorPlacement(rg,Yr,Jh,y_,QC,ft,kt,ie,L,V,Se,eg,It,b,Yh,A,M,x_,ar);if(ed&&(Rc=ed.placedGlyphBoxes,Rc&&Rc.placeable))return Gr=!0,La=ed.shift,Rc}hs?hs=null:eg=pe}return x&&!Rc&&(Rc={box:this.collisionIndex.placeCollisionBox(Zh,"always",ie,L,V,kt,ft,A,Se.predicate,ar,new o.P(0,0)).box,offscreen:!1,placeable:!1}),Rc};aa(()=>zs(Zh,Nt.iconBox,o.ah.horizontal),()=>{const Yr=Nt.verticalTextBox;return b.allowVerticalPlacement&&(!Gn||!Gn.placeable)&&It.numVerticalGlyphVertices>0&&Yr?zs(Yr,Nt.verticalIconBox,o.ah.vertical):{box:null,occluded:!0,offscreen:null}}),Gn&&(Gr=Gn.placeable,As=Gn.offscreen);const Mo=oa(Gn&&Gn.placeable);if(!Gr&&this.prevPlacement){const Yr=this.prevPlacement.variableOffsets[It.crossTileID];Yr&&(this.variableOffsets[It.crossTileID]=Yr,this.markUsedJustification(b,Yr.anchor,It,Mo))}}}if(qs=Gn,Gr=qs&&qs.placeable,As=qs&&qs.offscreen,It.useRuntimeCollisionCircles){const oa=b.text.placedSymbolArray.get(It.centerJustifiedTextSymbolIndex),aa=o.ai(b.textSizeData,xe,oa),Ic=S.get("text-padding");Es=this.collisionIndex.placeCollisionCircles(pe,oa,b.lineVertexArray,b.glyphOffsetArray,aa,L,V,H,G,x,kt,Se.predicate,It.collisionCircleDiameter,Ic,A,ar),Es.circles.length&&Es.collisionDetected&&!x&&o.w("Collisions detected, but collision boxes are not shown"),Gr=Fe||Es.circles.length>0&&!Es.collisionDetected,As=As&&Es.offscreen}if(Nt.iconFeatureIndex&&(Ym=Nt.iconFeatureIndex),Nt.iconBox){const oa=aa=>this.collisionIndex.placeCollisionBox(aa,Ue,ie,L,V,kt,ft,M,Se.predicate,ar,Lt&&La?La:void 0);ho&&ho.placeable&&Nt.verticalIconBox?(Qs=oa(Nt.verticalIconBox),Hn=Qs.placeable):(Qs=oa(Nt.iconBox),Hn=Qs.placeable),As=As&&Qs.offscreen}const sa=Ce||It.numHorizontalGlyphVertices===0&&It.numVerticalGlyphVertices===0,Jm=je||It.numIconVertices===0;sa||Jm?Jm?sa||(Hn=Hn&&Gr):Gr=Hn&&Gr:Hn=Gr=Hn&&Gr;const hx=Hn&&Qs.placeable;if(Gr&&qs.placeable&&this.collisionIndex.insertCollisionBox(qs.box,pe,S.get("text-ignore-placement"),b.bucketInstanceId,ho&&ho.placeable&&Kh?Kh:pl,Se.ID),hx&&this.collisionIndex.insertCollisionBox(Qs.box,Ue,S.get("icon-ignore-placement"),b.bucketInstanceId,Ym,Se.ID),Es&&Gr&&this.collisionIndex.insertCollisionCircles(Es.circles,pe,S.get("text-ignore-placement"),b.bucketInstanceId,pl,Se.ID),x&&this.storeCollisionData(b.bucketInstanceId,Tr,Nt,qs,Qs,Es),It.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(b.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[It.crossTileID]=new Br(Gr||zt,Hn||At,As||b.justReloaded),p[It.crossTileID]=!0};if(qt){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const It=b.getSortedSymbolIndexes(this.transform.angle);for(let Nt=It.length-1;Nt>=0;--Nt){const Tr=It[Nt];Pr(b.symbolInstances.get(Tr),b.collisionArrays[Tr],Tr)}}else for(let It=l.symbolInstanceStart;It<l.symbolInstanceEnd;It++)Pr(b.symbolInstances.get(It),b.collisionArrays[It],It);if(x&&b.bucketInstanceId in this.collisionCircleArrays){const It=this.collisionCircleArrays[b.bucketInstanceId];o.as(It.invProjMatrix,L),It.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}storeCollisionData(l,p,x,b,S,A){if(x.textBox||x.iconBox){let M,L;this.collisionBoxArrays.has(l)?M=this.collisionBoxArrays.get(l):(M=new Map,this.collisionBoxArrays.set(l,M)),M.has(p)?L=M.get(p):(L={text:null,icon:null},M.set(p,L)),x.textBox&&(L.text=b.box),x.iconBox&&(L.icon=S.box)}if(A){let M=this.collisionCircleArrays[l];M===void 0&&(M=this.collisionCircleArrays[l]=new mn);for(let L=0;L<A.circles.length;L+=4)M.circles.push(A.circles[L+0]),M.circles.push(A.circles[L+1]),M.circles.push(A.circles[L+2]),M.circles.push(A.collisionDetected?1:0)}}markUsedJustification(l,p,x,b){let S;S=b===o.ah.vertical?x.verticalPlacedTextSymbolIndex:{left:x.leftJustifiedTextSymbolIndex,center:x.centerJustifiedTextSymbolIndex,right:x.rightJustifiedTextSymbolIndex}[o.at(p)];const A=[x.leftJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.rightJustifiedTextSymbolIndex,x.verticalPlacedTextSymbolIndex];for(const M of A)M>=0&&(l.text.placedSymbolArray.get(M).crossTileID=S>=0&&M!==S?0:x.crossTileID)}markUsedOrientation(l,p,x){const b=p===o.ah.horizontal||p===o.ah.horizontalOnly?p:0,S=p===o.ah.vertical?p:0,A=[x.leftJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.rightJustifiedTextSymbolIndex];for(const M of A)l.text.placedSymbolArray.get(M).placedOrientation=b;x.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(x.verticalPlacedTextSymbolIndex).placedOrientation=S)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let x=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const b=p?p.symbolFadeChange(l):1,S=p?p.opacities:{},A=p?p.variableOffsets:{},M=p?p.placedOrientations:{};for(const L in this.placements){const V=this.placements[L],H=S[L];H?(this.opacities[L]=new Yn(H,b,V.text,V.icon),x=x||V.text!==H.text.placed||V.icon!==H.icon.placed):(this.opacities[L]=new Yn(null,b,V.text,V.icon,V.skipFade),x=x||V.text||V.icon)}for(const L in S){const V=S[L];if(!this.opacities[L]){const H=new Yn(V,b,!1,!1);H.isHidden()||(this.opacities[L]=H,x=x||V.text.placed||V.icon.placed)}}for(const L in A)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=A[L]);for(const L in M)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=M[L]);if(p&&p.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");x?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:l)}updateLayerOpacities(l,p){const x={};for(const b of p){const S=b.getBucket(l);S&&b.latestFeatureIndex&&l.id===S.layerIds[0]&&this.updateBucketOpacities(S,b.tileID,x,b.collisionBoxArray)}}updateBucketOpacities(l,p,x,b){l.hasTextData()&&(l.text.opacityVertexArray.clear(),l.text.hasVisibleVertices=!1),l.hasIconData()&&(l.icon.opacityVertexArray.clear(),l.icon.hasVisibleVertices=!1),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const S=l.layers[0],A=S.layout,M=new Yn(null,0,!1,!1,!0),L=A.get("text-allow-overlap"),V=A.get("icon-allow-overlap"),H=S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"),G=A.get("text-rotation-alignment")==="map",ie=A.get("text-pitch-alignment")==="map",le=A.get("icon-text-fit")!=="none",he=new Yn(null,0,L&&(V||!l.hasIconData()||A.get("icon-optional")),V&&(L||!l.hasTextData()||A.get("text-optional")),!0);!l.collisionArrays&&b&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(b);const xe=(Ce,je,pe)=>{for(let Fe=0;Fe<je/4;Fe++)Ce.opacityVertexArray.emplaceBack(pe);Ce.hasVisibleVertices=Ce.hasVisibleVertices||pe!==Pc},Se=this.collisionBoxArrays.get(l.bucketInstanceId);for(let Ce=0;Ce<l.symbolInstances.length;Ce++){const je=l.symbolInstances.get(Ce),{numHorizontalGlyphVertices:pe,numVerticalGlyphVertices:Fe,crossTileID:Ue}=je;let Je=this.opacities[Ue];x[Ue]?Je=M:Je||(Je=he,this.opacities[Ue]=Je),x[Ue]=!0;const ft=je.numIconVertices>0,kt=this.placedOrientations[je.crossTileID],Lt=kt===o.ah.vertical,qt=kt===o.ah.horizontal||kt===o.ah.horizontalOnly;if(pe>0||Fe>0){const At=Ts(Je.text);xe(l.text,pe,Lt?Pc:At),xe(l.text,Fe,qt?Pc:At);const ar=Je.text.isHidden();[je.rightJustifiedTextSymbolIndex,je.centerJustifiedTextSymbolIndex,je.leftJustifiedTextSymbolIndex].forEach(Nt=>{Nt>=0&&(l.text.placedSymbolArray.get(Nt).hidden=ar||Lt?1:0)}),je.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(je.verticalPlacedTextSymbolIndex).hidden=ar||qt?1:0);const Pr=this.variableOffsets[je.crossTileID];Pr&&this.markUsedJustification(l,Pr.anchor,je,kt);const It=this.placedOrientations[je.crossTileID];It&&(this.markUsedJustification(l,"left",je,It),this.markUsedOrientation(l,It,je))}if(ft){const At=Ts(Je.icon),ar=!(le&&je.verticalPlacedIconSymbolIndex&&Lt);je.placedIconSymbolIndex>=0&&(xe(l.icon,je.numIconVertices,ar?At:Pc),l.icon.placedSymbolArray.get(je.placedIconSymbolIndex).hidden=Je.icon.isHidden()),je.verticalPlacedIconSymbolIndex>=0&&(xe(l.icon,je.numVerticalIconVertices,ar?Pc:At),l.icon.placedSymbolArray.get(je.verticalPlacedIconSymbolIndex).hidden=Je.icon.isHidden())}const zt=Se&&Se.has(Ce)?Se.get(Ce):{text:null,icon:null};if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const At=l.collisionArrays[Ce];if(At){let ar=new o.P(0,0);if(At.textBox||At.verticalTextBox){let Pr=!0;if(H){const It=this.variableOffsets[Ue];It?(ar=wi(It.anchor,It.width,It.height,It.textOffset,It.textBoxScale),G&&ar._rotate(ie?this.transform.angle:-this.transform.angle)):Pr=!1}if(At.textBox||At.verticalTextBox){let It;At.textBox&&(It=Lt),At.verticalTextBox&&(It=qt),Ma(l.textCollisionBox.collisionVertexArray,Je.text.placed,!Pr||It,zt.text,ar.x,ar.y)}}if(At.iconBox||At.verticalIconBox){const Pr=!!(!qt&&At.verticalIconBox);let It;At.iconBox&&(It=Pr),At.verticalIconBox&&(It=!Pr),Ma(l.iconCollisionBox.collisionVertexArray,Je.icon.placed,It,zt.icon,le?ar.x:0,le?ar.y:0)}}}}if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);if(l.bucketInstanceId in this.collisionCircleArrays){const Ce=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=Ce.invProjMatrix,l.placementViewportMatrix=Ce.viewportMatrix,l.collisionCircleArray=Ce.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,p){const x=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*x>l}setStale(){this.stale=!0}}function Ma(k,l,p,x,b,S){x&&x.length!==0||(x=[0,0,0,0]);const A=x[0]-Ir,M=x[1]-Ir,L=x[2]-Ir,V=x[3]-Ir;k.emplaceBack(l?1:0,p?1:0,b||0,S||0,A,M),k.emplaceBack(l?1:0,p?1:0,b||0,S||0,L,M),k.emplaceBack(l?1:0,p?1:0,b||0,S||0,L,V),k.emplaceBack(l?1:0,p?1:0,b||0,S||0,A,V)}const ln=Math.pow(2,25),Tf=Math.pow(2,24),jc=Math.pow(2,17),Cs=Math.pow(2,16),Ws=Math.pow(2,9),j0=Math.pow(2,8),uo=Math.pow(2,1);function Ts(k){if(k.opacity===0&&!k.placed)return 0;if(k.opacity===1&&k.placed)return 4294967295;const l=k.placed?1:0,p=Math.floor(127*k.opacity);return p*ln+l*Tf+p*jc+l*Cs+p*Ws+l*j0+p*uo+l}const Pc=0;function Xl(){return{isOccluded:(k,l,p)=>!1,getPitchedTextCorrection:(k,l,p)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(k,l,p,x){throw new Error("Not implemented.")},translatePosition:(k,l,p,x)=>function(b,S,A,M,L=!1){if(!A[0]&&!A[1])return[0,0];const V=L?M==="map"?b.angle:0:M==="viewport"?-b.angle:0;if(V){const H=Math.sin(V),G=Math.cos(V);A=[A[0]*G-A[1]*H,A[0]*H+A[1]*G]}return[L?A[0]:Fr(S,A[0],b.zoom),L?A[1]:Fr(S,A[1],b.zoom)]}(k,l,p,x),getCircleRadiusCorrection:k=>1}}class pi{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,p,x,b,S){const A=this._bucketParts;for(;this._currentTileIndex<l.length;)if(p.getBucketParts(A,b,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,A.sort((M,L)=>M.sortKey-L.sortKey));this._currentPartIndex<A.length;)if(p.placeLayerBucketPart(A[this._currentPartIndex],this._seenCrossTileIDs,x),this._currentPartIndex++,S())return!0;return!1}}class Ou{constructor(l,p,x,b,S,A,M,L){this.placement=new us(l,Xl(),p,A,M,L),this._currentPlacementIndex=x.length-1,this._forceFullPlacement=b,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(l,p,x){const b=v.now(),S=()=>!this._forceFullPlacement&&v.now()-b>2;for(;this._currentPlacementIndex>=0;){const A=p[l[this._currentPlacementIndex]],M=this.placement.collisionIndex.transform.zoom;if(A.type==="symbol"&&(!A.minzoom||A.minzoom<=M)&&(!A.maxzoom||A.maxzoom>M)){if(this._inProgressLayer||(this._inProgressLayer=new pi(A)),this._inProgressLayer.continuePlacement(x[A.source],this.placement,this._showCollisionBoxes,A,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const jo=512/o.X/2;class oi{constructor(l,p,x){this.tileID=l,this.bucketInstanceId=x,this._symbolsByKey={};const b=new Map;for(let S=0;S<p.length;S++){const A=p.get(S),M=A.key,L=b.get(M);L?L.push(A):b.set(M,[A])}for(const[S,A]of b){const M={positions:A.map(L=>({x:Math.floor(L.anchorX*jo),y:Math.floor(L.anchorY*jo)})),crossTileIDs:A.map(L=>L.crossTileID)};if(M.positions.length>128){const L=new o.av(M.positions.length,16,Uint16Array);for(const{x:V,y:H}of M.positions)L.add(V,H);L.finish(),delete M.positions,M.index=L}this._symbolsByKey[S]=M}}getScaledCoordinates(l,p){const{x,y:b,z:S}=this.tileID.canonical,{x:A,y:M,z:L}=p.canonical,V=jo/Math.pow(2,L-S),H=(M*o.X+l.anchorY)*V,G=b*o.X*jo;return{x:Math.floor((A*o.X+l.anchorX)*V-x*o.X*jo),y:Math.floor(H-G)}}findMatches(l,p,x){const b=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z);for(let S=0;S<l.length;S++){const A=l.get(S);if(A.crossTileID)continue;const M=this._symbolsByKey[A.key];if(!M)continue;const L=this.getScaledCoordinates(A,p);if(M.index){const V=M.index.range(L.x-b,L.y-b,L.x+b,L.y+b).sort();for(const H of V){const G=M.crossTileIDs[H];if(!x[G]){x[G]=!0,A.crossTileID=G;break}}}else if(M.positions)for(let V=0;V<M.positions.length;V++){const H=M.positions[V],G=M.crossTileIDs[V];if(Math.abs(H.x-L.x)<=b&&Math.abs(H.y-L.y)<=b&&!x[G]){x[G]=!0,A.crossTileID=G;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:l})=>l)}}class jh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Po{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const p=Math.round((l-this.lng)/360);if(p!==0)for(const x in this.indexes){const b=this.indexes[x],S={};for(const A in b){const M=b[A];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+p),S[M.tileID.key]=M}this.indexes[x]=S}this.lng=l}addBucket(l,p,x){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let S=0;S<p.symbolInstances.length;S++)p.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const b=this.usedCrossTileIDs[l.overscaledZ];for(const S in this.indexes){const A=this.indexes[S];if(Number(S)>l.overscaledZ)for(const M in A){const L=A[M];L.tileID.isChildOf(l)&&L.findMatches(p.symbolInstances,l,b)}else{const M=A[l.scaledTo(Number(S)).key];M&&M.findMatches(p.symbolInstances,l,b)}}for(let S=0;S<p.symbolInstances.length;S++){const A=p.symbolInstances.get(S);A.crossTileID||(A.crossTileID=x.generate(),b[A.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new oi(l,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(l,p){for(const x of p.getCrossTileIDsLists())for(const b of x)delete this.usedCrossTileIDs[l][b]}removeStaleBuckets(l){let p=!1;for(const x in this.indexes){const b=this.indexes[x];for(const S in b)l[b[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,b[S]),delete b[S],p=!0)}return p}}class Of{constructor(){this.layerIndexes={},this.crossTileIDs=new jh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,p,x){let b=this.layerIndexes[l.id];b===void 0&&(b=this.layerIndexes[l.id]=new Po);let S=!1;const A={};b.handleWrapJump(x);for(const M of p){const L=M.getBucket(l);L&&l.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(M.tileID,L,this.crossTileIDs)&&(S=!0),A[L.bucketInstanceId]=!0)}return b.removeStaleBuckets(A)&&(S=!0),S}pruneUnusedLayers(l){const p={};l.forEach(x=>{p[x]=!0});for(const x in this.layerIndexes)p[x]||delete this.layerIndexes[x]}}const Ao=(k,l)=>o.t(k,l&&l.filter(p=>p.identifier!=="source.canvas")),Ph=o.aw();class Ac extends o.E{constructor(l,p={}){super(),this._rtlPluginLoaded=()=>{for(const x in this.sourceCaches){const b=this.sourceCaches[x].getSource().type;b!=="vector"&&b!=="geojson"||this.sourceCaches[x].reload()}},this.map=l,this.dispatcher=new Et(Mt(),l._getMapId()),this.dispatcher.registerMessageHandler("GG",(x,b)=>this.getGlyphs(x,b)),this.dispatcher.registerMessageHandler("GI",(x,b)=>this.getImages(x,b)),this.imageManager=new Ae,this.imageManager.setEventedParent(this),this.glyphManager=new Be(l._requestManager,p.localIdeographFontFamily),this.lineAtlas=new Ie(256,512),this.crossTileSymbolIndex=new Of,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",o.ay()),Ut().on(He,this._rtlPluginLoaded),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const b=this.sourceCaches[x.sourceId];if(!b)return;const S=b.getSource();if(S&&S.vectorLayerIds)for(const A in this._layers){const M=this._layers[A];M.source===S.id&&this._validateLayer(M)}})}loadURL(l,p={},x){this.fire(new o.k("dataloading",{dataType:"style"})),p.validate=typeof p.validate!="boolean"||p.validate;const b=this.map._requestManager.transformRequest(l,"Style");this._loadStyleRequest=new AbortController;const S=this._loadStyleRequest;o.h(b,this._loadStyleRequest).then(A=>{this._loadStyleRequest=null,this._load(A.data,p,x)}).catch(A=>{this._loadStyleRequest=null,A&&!S.signal.aborted&&this.fire(new o.j(A))})}loadJSON(l,p={},x){this.fire(new o.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,v.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,p.validate=p.validate!==!1,this._load(l,p,x)}).catch(()=>{})}loadEmpty(){this.fire(new o.k("dataloading",{dataType:"style"})),this._load(Ph,{validate:!1})}_load(l,p,x){var b;const S=p.transformStyle?p.transformStyle(x,l):l;if(!p.validate||!Ao(this,o.u(S))){this._loaded=!0,this.stylesheet=S;for(const A in S.sources)this.addSource(A,S.sources[A],{validate:!1});S.sprite?this._loadSprite(S.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(S.glyphs),this._createLayers(),this.light=new De(this.stylesheet.light),this.sky=new Oe(this.stylesheet.sky),this.map.setTerrain((b=this.stylesheet.terrain)!==null&&b!==void 0?b:null),this.fire(new o.k("data",{dataType:"style"})),this.fire(new o.k("style.load"))}}_createLayers(){const l=o.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",l),this._order=l.map(p=>p.id),this._layers={},this._serializedLayers=null;for(const p of l){const x=o.aA(p);x.setEventedParent(this,{layer:{id:p.id}}),this._layers[p.id]=x}}_loadSprite(l,p=!1,x=void 0){let b;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(S,A,M,L){return o._(this,void 0,void 0,function*(){const V=ne(S),H=M>1?"@2x":"",G={},ie={};for(const{id:le,url:he}of V){const xe=A.transformRequest(oe(he,H,".json"),"SpriteJSON");G[le]=o.h(xe,L);const Se=A.transformRequest(oe(he,H,".png"),"SpriteImage");ie[le]=D.getImage(Se,L)}return yield Promise.all([...Object.values(G),...Object.values(ie)]),function(le,he){return o._(this,void 0,void 0,function*(){const xe={};for(const Se in le){xe[Se]={};const Ce=v.getImageCanvasContext((yield he[Se]).data),je=(yield le[Se]).data;for(const pe in je){const{width:Fe,height:Ue,x:Je,y:ft,sdf:kt,pixelRatio:Lt,stretchX:qt,stretchY:zt,content:At,textFitWidth:ar,textFitHeight:Pr}=je[pe];xe[Se][pe]={data:null,pixelRatio:Lt,sdf:kt,stretchX:qt,stretchY:zt,content:At,textFitWidth:ar,textFitHeight:Pr,spriteData:{width:Fe,height:Ue,x:Je,y:ft,context:Ce}}}}return xe})}(G,ie)})}(l,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(S=>{if(this._spriteRequest=null,S)for(const A in S){this._spritesImagesIds[A]=[];const M=this._spritesImagesIds[A]?this._spritesImagesIds[A].filter(L=>!(L in S)):[];for(const L of M)this.imageManager.removeImage(L),this._changedImages[L]=!0;for(const L in S[A]){const V=A==="default"?L:`${A}:${L}`;this._spritesImagesIds[A].push(V),V in this.imageManager.images?this.imageManager.updateImage(V,S[A][L],!1):this.imageManager.addImage(V,S[A][L]),p&&(this._changedImages[V]=!0)}}}).catch(S=>{this._spriteRequest=null,b=S,this.fire(new o.j(b))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),p&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"})),x&&x(b)})}_unloadSprite(){for(const l of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(l),this._changedImages[l]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}_validateLayer(l){const p=this.sourceCaches[l.source];if(!p)return;const x=l.sourceLayer;if(!x)return;const b=p.getSource();(b.type==="geojson"||b.vectorLayerIds&&b.vectorLayerIds.indexOf(x)===-1)&&this.fire(new o.j(new Error(`Source layer "${x}" does not exist on source "${b.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(l,p=!1){const x=this._serializedAllLayers();if(!l||l.length===0)return Object.values(p?o.aB(x):x);const b=[];for(const S of l)if(x[S]){const A=p?o.aB(x[S]):x[S];b.push(A)}return b}_serializedAllLayers(){let l=this._serializedLayers;if(l)return l;l=this._serializedLayers={};const p=Object.keys(this._layers);for(const x of p){const b=this._layers[x];b.type!=="custom"&&(l[x]=b.serialize())}return l}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const p=this._changed;if(p){const b=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(b.length||S.length)&&this._updateWorkerLayers(b,S);for(const A in this._updatedSources){const M=this._updatedSources[A];if(M==="reload")this._reloadSource(A);else{if(M!=="clear")throw new Error(`Invalid action ${M}`);this._clearSource(A)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const A in this._updatedPaintProps)this._layers[A].updateTransitions(l);this.light.updateTransitions(l),this.sky.updateTransitions(l),this._resetUpdates()}const x={};for(const b in this.sourceCaches){const S=this.sourceCaches[b];x[b]=S.used,S.used=!1}for(const b of this._order){const S=this._layers[b];S.recalculate(l,this._availableImages),!S.isHidden(l.zoom)&&S.source&&(this.sourceCaches[S.source].used=!0)}for(const b in x){const S=this.sourceCaches[b];!!x[b]!=!!S.used&&S.fire(new o.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:b}))}this.light.recalculate(l),this.sky.recalculate(l),this.z=l.zoom,p&&this.fire(new o.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const p in this.sourceCaches)this.sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(l,p){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(l,!1),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(l,p={}){var x;this._checkLoaded();const b=this.serialize();if(l=p.transformStyle?p.transformStyle(b,l):l,((x=p.validate)===null||x===void 0||x)&&Ao(this,o.u(l)))return!1;(l=o.aB(l)).layers=o.az(l.layers);const S=o.aC(b,l),A=this._getOperationsToPerform(S);if(A.unimplemented.length>0)throw new Error(`Unimplemented: ${A.unimplemented.join(", ")}.`);if(A.operations.length===0)return!1;for(const M of A.operations)M();return this.stylesheet=l,this._serializedLayers=null,!0}_getOperationsToPerform(l){const p=[],x=[];for(const b of l)switch(b.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":p.push(()=>this.addLayer.apply(this,b.args));break;case"removeLayer":p.push(()=>this.removeLayer.apply(this,b.args));break;case"setPaintProperty":p.push(()=>this.setPaintProperty.apply(this,b.args));break;case"setLayoutProperty":p.push(()=>this.setLayoutProperty.apply(this,b.args));break;case"setFilter":p.push(()=>this.setFilter.apply(this,b.args));break;case"addSource":p.push(()=>this.addSource.apply(this,b.args));break;case"removeSource":p.push(()=>this.removeSource.apply(this,b.args));break;case"setLayerZoomRange":p.push(()=>this.setLayerZoomRange.apply(this,b.args));break;case"setLight":p.push(()=>this.setLight.apply(this,b.args));break;case"setGeoJSONSourceData":p.push(()=>this.setGeoJSONSourceData.apply(this,b.args));break;case"setGlyphs":p.push(()=>this.setGlyphs.apply(this,b.args));break;case"setSprite":p.push(()=>this.setSprite.apply(this,b.args));break;case"setSky":p.push(()=>this.setSky.apply(this,b.args));break;case"setTerrain":p.push(()=>this.map.setTerrain.apply(this,b.args));break;case"setTransition":p.push(()=>{});break;default:x.push(b.command)}return{operations:p,unimplemented:x}}addImage(l,p){if(this.getImage(l))return this.fire(new o.j(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,p),this._afterImageUpdated(l)}updateImage(l,p){this.imageManager.updateImage(l,p)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new o.j(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,p,x={}){if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(o.u.source,`sources.${l}`,p,null,x))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const b=this.sourceCaches[l]=new tr(l,p,this.dispatcher);b.style=this,b.setEventedParent(this,()=>({isSourceLoaded:b.loaded(),source:b.serialize(),sourceId:l})),b.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===l)return this.fire(new o.j(new Error(`Source "${l}" cannot be removed while layer "${x}" is using it.`)));const p=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],p.fire(new o.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),p.setEventedParent(null),p.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,p){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const x=this.sourceCaches[l].getSource();if(x.type!=="geojson")throw new Error(`geojsonSource.type is ${x.type}, which is !== 'geojson`);x.setData(p),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,p,x={}){this._checkLoaded();const b=l.id;if(this.getLayer(b))return void this.fire(new o.j(new Error(`Layer "${b}" already exists on this map.`)));let S;if(l.type==="custom"){if(Ao(this,o.aD(l)))return;S=o.aA(l)}else{if("source"in l&&typeof l.source=="object"&&(this.addSource(b,l.source),l=o.aB(l),l=o.e(l,{source:b})),this._validate(o.u.layer,`layers.${b}`,l,{arrayIndex:-1},x))return;S=o.aA(l),this._validateLayer(S),S.setEventedParent(this,{layer:{id:b}})}const A=p?this._order.indexOf(p):this._order.length;if(p&&A===-1)this.fire(new o.j(new Error(`Cannot add layer "${b}" before non-existing layer "${p}".`)));else{if(this._order.splice(A,0,b),this._layerOrderChanged=!0,this._layers[b]=S,this._removedLayers[b]&&S.source&&S.type!=="custom"){const M=this._removedLayers[b];delete this._removedLayers[b],M.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}moveLayer(l,p){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new o.j(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===p)return;const x=this._order.indexOf(l);this._order.splice(x,1);const b=p?this._order.indexOf(p):this._order.length;p&&b===-1?this.fire(new o.j(new Error(`Cannot move layer "${l}" before non-existing layer "${p}".`))):(this._order.splice(b,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const p=this._layers[l];if(!p)return void this.fire(new o.j(new Error(`Cannot remove non-existing layer "${l}".`)));p.setEventedParent(null);const x=this._order.indexOf(l);this._order.splice(x,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=p,delete this._layers[l],this._serializedLayers&&delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],p.onRemove&&p.onRemove(this.map)}getLayer(l){return this._layers[l]}getLayersOrder(){return[...this._order]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,p,x){this._checkLoaded();const b=this.getLayer(l);b?b.minzoom===p&&b.maxzoom===x||(p!=null&&(b.minzoom=p),x!=null&&(b.maxzoom=x),this._updateLayer(b)):this.fire(new o.j(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,p,x={}){this._checkLoaded();const b=this.getLayer(l);if(b){if(!o.aE(b.filter,p))return p==null?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(o.u.filter,`layers.${b.id}.filter`,p,null,x)||(b.filter=o.aB(p),this._updateLayer(b)))}else this.fire(new o.j(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return o.aB(this.getLayer(l).filter)}setLayoutProperty(l,p,x,b={}){this._checkLoaded();const S=this.getLayer(l);S?o.aE(S.getLayoutProperty(p),x)||(S.setLayoutProperty(p,x,b),this._updateLayer(S)):this.fire(new o.j(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,p){const x=this.getLayer(l);if(x)return x.getLayoutProperty(p);this.fire(new o.j(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,p,x,b={}){this._checkLoaded();const S=this.getLayer(l);S?o.aE(S.getPaintProperty(p),x)||(S.setPaintProperty(p,x,b)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[l]=!0,this._serializedLayers=null):this.fire(new o.j(new Error(`Cannot style non-existing layer "${l}".`)))}getPaintProperty(l,p){return this.getLayer(l).getPaintProperty(p)}setFeatureState(l,p){this._checkLoaded();const x=l.source,b=l.sourceLayer,S=this.sourceCaches[x];if(S===void 0)return void this.fire(new o.j(new Error(`The source '${x}' does not exist in the map's style.`)));const A=S.getSource().type;A==="geojson"&&b?this.fire(new o.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):A!=="vector"||b?(l.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),S.setFeatureState(b,l.id,p)):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,p){this._checkLoaded();const x=l.source,b=this.sourceCaches[x];if(b===void 0)return void this.fire(new o.j(new Error(`The source '${x}' does not exist in the map's style.`)));const S=b.getSource().type,A=S==="vector"?l.sourceLayer:void 0;S!=="vector"||A?p&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new o.j(new Error("A feature id is required to remove its specific state property."))):b.removeFeatureState(A,l.id,p):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const p=l.source,x=l.sourceLayer,b=this.sourceCaches[p];if(b!==void 0)return b.getSource().type!=="vector"||x?(l.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),b.getFeatureState(x,l.id)):void this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.j(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const l=o.aF(this.sourceCaches,S=>S.serialize()),p=this._serializeByIds(this._order,!0),x=this.map.getTerrain()||void 0,b=this.stylesheet;return o.aG({version:b.version,name:b.name,metadata:b.metadata,light:b.light,sky:b.sky,center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch,sprite:b.sprite,glyphs:b.glyphs,transition:b.transition,sources:l,layers:p,terrain:x},S=>S!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(l){const p=A=>this._layers[A].type==="fill-extrusion",x={},b=[];for(let A=this._order.length-1;A>=0;A--){const M=this._order[A];if(p(M)){x[M]=A;for(const L of l){const V=L[M];if(V)for(const H of V)b.push(H)}}}b.sort((A,M)=>M.intersectionZ-A.intersectionZ);const S=[];for(let A=this._order.length-1;A>=0;A--){const M=this._order[A];if(p(M))for(let L=b.length-1;L>=0;L--){const V=b[L].feature;if(x[V.layer.id]<A)break;S.push(V),b.pop()}else for(const L of l){const V=L[M];if(V)for(const H of V)S.push(H.feature)}}return S}queryRenderedFeatures(l,p,x){p&&p.filter&&this._validate(o.u.filter,"queryRenderedFeatures.filter",p.filter,null,p);const b={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new o.j(new Error("parameters.layers must be an Array."))),[];for(const M of p.layers){const L=this._layers[M];if(!L)return this.fire(new o.j(new Error(`The layer '${M}' does not exist in the map's style and cannot be queried for features.`))),[];b[L.source]=!0}}const S=[];p.availableImages=this._availableImages;const A=this._serializedAllLayers();for(const M in this.sourceCaches)p.layers&&!b[M]||S.push(Yt(this.sourceCaches[M],this._layers,A,l,p,x));return this.placement&&S.push(function(M,L,V,H,G,ie,le){const he={},xe=ie.queryRenderedSymbols(H),Se=[];for(const Ce of Object.keys(xe).map(Number))Se.push(le[Ce]);Se.sort(_t);for(const Ce of Se){const je=Ce.featureIndex.lookupSymbolFeatures(xe[Ce.bucketInstanceId],L,Ce.bucketIndex,Ce.sourceLayerIndex,G.filter,G.layers,G.availableImages,M);for(const pe in je){const Fe=he[pe]=he[pe]||[],Ue=je[pe];Ue.sort((Je,ft)=>{const kt=Ce.featureSortOrder;if(kt){const Lt=kt.indexOf(Je.featureIndex);return kt.indexOf(ft.featureIndex)-Lt}return ft.featureIndex-Je.featureIndex});for(const Je of Ue)Fe.push(Je)}}for(const Ce in he)he[Ce].forEach(je=>{const pe=je.feature,Fe=V[M[Ce].source].getFeatureState(pe.layer["source-layer"],pe.id);pe.source=pe.layer.source,pe.layer["source-layer"]&&(pe.sourceLayer=pe.layer["source-layer"]),pe.state=Fe});return he}(this._layers,A,this.sourceCaches,l,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(l,p){p&&p.filter&&this._validate(o.u.filter,"querySourceFeatures.filter",p.filter,null,p);const x=this.sourceCaches[l];return x?function(b,S){const A=b.getRenderableIds().map(V=>b.getTileByID(V)),M=[],L={};for(let V=0;V<A.length;V++){const H=A[V],G=H.tileID.canonical.key;L[G]||(L[G]=!0,H.querySourceFeatures(M,S))}return M}(x,p):[]}getLight(){return this.light.getLight()}setLight(l,p={}){this._checkLoaded();const x=this.light.getLight();let b=!1;for(const A in l)if(!o.aE(l[A],x[A])){b=!0;break}if(!b)return;const S={now:v.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,p),this.light.updateTransitions(S)}getSky(){var l;return(l=this.stylesheet)===null||l===void 0?void 0:l.sky}setSky(l,p={}){const x=this.getSky();let b=!1;if(!l&&!x)return;if(l&&!x)b=!0;else if(!l&&x)b=!0;else for(const A in l)if(!o.aE(l[A],x[A])){b=!0;break}if(!b)return;const S={now:v.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=l,this.sky.setSky(l,p),this.sky.updateTransitions(S)}_validate(l,p,x,b,S={}){return(!S||S.validate!==!1)&&Ao(this,l.call(o.u,o.e({key:p,style:this.serialize(),value:x,styleSpec:o.v},b)))}_remove(l=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ut().off(He,this._rtlPluginLoaded);for(const p in this._layers)this._layers[p].setEventedParent(null);for(const p in this.sourceCaches){const x=this.sourceCaches[p];x.setEventedParent(null),x.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),l&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(l)}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(const p in this.sourceCaches)this.sourceCaches[p].update(l,this.map.terrain)}_generateCollisionBoxes(){for(const l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,p,x,b,S=!1){let A=!1,M=!1;const L={};for(const V of this._order){const H=this._layers[V];if(H.type!=="symbol")continue;if(!L[H.source]){const ie=this.sourceCaches[H.source];L[H.source]=ie.getRenderableIds(!0).map(le=>ie.getTileByID(le)).sort((le,he)=>he.tileID.overscaledZ-le.tileID.overscaledZ||(le.tileID.isLessThan(he.tileID)?-1:1))}const G=this.crossTileSymbolIndex.addLayer(H,L[H.source],l.center.lng);A=A||G}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||x===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(v.now(),l.zoom))&&(this.pauseablePlacement=new Ou(l,this.map.terrain,this._order,S,p,x,b,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(v.now()),M=!0),A&&this.pauseablePlacement.placement.setStale()),M||A)for(const V of this._order){const H=this._layers[V];H.type==="symbol"&&this.placement.updateLayerOpacities(H,L[H.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(v.now())}_releaseSymbolFadeTiles(){for(const l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,p){return o._(this,void 0,void 0,function*(){const x=yield this.imageManager.getImages(p.icons);this._updateTilesForChangedImages();const b=this.sourceCaches[p.source];return b&&b.setDependencies(p.tileID.key,p.type,p.icons),x})}getGlyphs(l,p){return o._(this,void 0,void 0,function*(){const x=yield this.glyphManager.getGlyphs(p.stacks),b=this.sourceCaches[p.source];return b&&b.setDependencies(p.tileID.key,p.type,[""]),x})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(l,p={}){this._checkLoaded(),l&&this._validate(o.u.glyphs,"glyphs",l,null,p)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=l,this.glyphManager.entries={},this.glyphManager.setURL(l))}addSprite(l,p,x={},b){this._checkLoaded();const S=[{id:l,url:p}],A=[...ne(this.stylesheet.sprite),...S];this._validate(o.u.sprite,"sprite",A,null,x)||(this.stylesheet.sprite=A,this._loadSprite(S,!0,b))}removeSprite(l){this._checkLoaded();const p=ne(this.stylesheet.sprite);if(p.find(x=>x.id===l)){if(this._spritesImagesIds[l])for(const x of this._spritesImagesIds[l])this.imageManager.removeImage(x),this._changedImages[x]=!0;p.splice(p.findIndex(x=>x.id===l),1),this.stylesheet.sprite=p.length>0?p:void 0,delete this._spritesImagesIds[l],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}else this.fire(new o.j(new Error(`Sprite "${l}" doesn't exists on this map.`)))}getSprite(){return ne(this.stylesheet.sprite)}setSprite(l,p={},x){this._checkLoaded(),l&&this._validate(o.u.sprite,"sprite",l,null,p)||(this.stylesheet.sprite=l,l?this._loadSprite(l,!0,x):(this._unloadSprite(),x&&x(null)))}}var Kl=o.Y([{name:"a_pos",type:"Int16",components:2}]);const cl={prelude:tn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:tn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:tn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:tn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:tn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:tn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:tn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:tn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:tn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:tn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:tn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:tn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:tn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:tn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:tn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:tn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:tn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:tn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:tn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:tn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:tn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:tn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:tn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:tn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:tn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:tn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:tn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:tn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:tn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:tn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function tn(k,l){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=l.match(/attribute ([\w]+) ([\w]+)/g),b=k.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),A=S?S.concat(b):b,M={};return{fragmentSource:k=k.replace(p,(L,V,H,G,ie)=>(M[ie]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
varying ${H} ${G} ${ie};
#else
uniform ${H} ${G} u_${ie};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ie}
    ${H} ${G} ${ie} = u_${ie};
#endif
`)),vertexSource:l=l.replace(p,(L,V,H,G,ie)=>{const le=G==="float"?"vec2":"vec4",he=ie.match(/color/)?"color":le;return M[ie]?V==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
uniform lowp float u_${ie}_t;
attribute ${H} ${le} a_${ie};
varying ${H} ${G} ${ie};
#else
uniform ${H} ${G} u_${ie};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${ie}
    ${ie} = a_${ie};
#else
    ${H} ${G} ${ie} = u_${ie};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ie}
    ${ie} = unpack_mix_${he}(a_${ie}, u_${ie}_t);
#else
    ${H} ${G} ${ie} = u_${ie};
#endif
`:V==="define"?`
#ifndef HAS_UNIFORM_u_${ie}
uniform lowp float u_${ie}_t;
attribute ${H} ${le} a_${ie};
#else
uniform ${H} ${G} u_${ie};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${ie}
    ${H} ${G} ${ie} = a_${ie};
#else
    ${H} ${G} ${ie} = u_${ie};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ie}
    ${H} ${G} ${ie} = unpack_mix_${he}(a_${ie}, u_${ie}_t);
#else
    ${H} ${G} ${ie} = u_${ie};
#endif
`}),staticAttributes:x,staticUniforms:A}}class jf{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,p,x,b,S,A,M,L,V){this.context=l;let H=this.boundPaintVertexBuffers.length!==b.length;for(let G=0;!H&&G<b.length;G++)this.boundPaintVertexBuffers[G]!==b[G]&&(H=!0);!this.vao||this.boundProgram!==p||this.boundLayoutVertexBuffer!==x||H||this.boundIndexBuffer!==S||this.boundVertexOffset!==A||this.boundDynamicVertexBuffer!==M||this.boundDynamicVertexBuffer2!==L||this.boundDynamicVertexBuffer3!==V?this.freshBind(p,x,b,S,A,M,L,V):(l.bindVertexArray.set(this.vao),M&&M.bind(),S&&S.dynamicDraw&&S.bind(),L&&L.bind(),V&&V.bind())}freshBind(l,p,x,b,S,A,M,L){const V=l.numAttributes,H=this.context,G=H.gl;this.vao&&this.destroy(),this.vao=H.createVertexArray(),H.bindVertexArray.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=b,this.boundVertexOffset=S,this.boundDynamicVertexBuffer=A,this.boundDynamicVertexBuffer2=M,this.boundDynamicVertexBuffer3=L,p.enableAttributes(G,l);for(const ie of x)ie.enableAttributes(G,l);A&&A.enableAttributes(G,l),M&&M.enableAttributes(G,l),L&&L.enableAttributes(G,l),p.bind(),p.setVertexAttribPointers(G,l,S);for(const ie of x)ie.bind(),ie.setVertexAttribPointers(G,l,S);A&&(A.bind(),A.setVertexAttribPointers(G,l,S)),b&&b.bind(),M&&(M.bind(),M.setVertexAttribPointers(G,l,S)),L&&(L.bind(),L.setVertexAttribPointers(G,l,S)),H.currentNumAttributes=V}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Pf=(k,l,p,x,b)=>({u_matrix:k,u_texture:0,u_ele_delta:l,u_fog_matrix:p,u_fog_color:x?x.properties.get("fog-color"):o.aM.white,u_fog_ground_blend:x?x.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:x?x.calculateFogBlendOpacity(b):0,u_horizon_color:x?x.properties.get("horizon-color"):o.aM.white,u_horizon_fog_blend:x?x.properties.get("horizon-fog-blend"):1});function Ec(k){const l=[];for(let p=0;p<k.length;p++){if(k[p]===null)continue;const x=k[p].split(" ");l.push(x.pop())}return l}class Ah{constructor(l,p,x,b,S,A){const M=l.gl;this.program=M.createProgram();const L=Ec(p.staticAttributes),V=x?x.getBinderAttributes():[],H=L.concat(V),G=cl.prelude.staticUniforms?Ec(cl.prelude.staticUniforms):[],ie=p.staticUniforms?Ec(p.staticUniforms):[],le=x?x.getBinderUniforms():[],he=G.concat(ie).concat(le),xe=[];for(const Je of he)xe.indexOf(Je)<0&&xe.push(Je);const Se=x?x.defines():[];S&&Se.push("#define OVERDRAW_INSPECTOR;"),A&&Se.push("#define TERRAIN3D;");const Ce=Se.concat(cl.prelude.fragmentSource,p.fragmentSource).join(`
`),je=Se.concat(cl.prelude.vertexSource,p.vertexSource).join(`
`),pe=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);if(M.shaderSource(pe,Ce),M.compileShader(pe),!M.getShaderParameter(pe,M.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${M.getShaderInfoLog(pe)}`);M.attachShader(this.program,pe);const Fe=M.createShader(M.VERTEX_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);if(M.shaderSource(Fe,je),M.compileShader(Fe),!M.getShaderParameter(Fe,M.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${M.getShaderInfoLog(Fe)}`);M.attachShader(this.program,Fe),this.attributes={};const Ue={};this.numAttributes=H.length;for(let Je=0;Je<this.numAttributes;Je++)H[Je]&&(M.bindAttribLocation(this.program,Je,H[Je]),this.attributes[H[Je]]=Je);if(M.linkProgram(this.program),!M.getProgramParameter(this.program,M.LINK_STATUS))throw new Error(`Program failed to link: ${M.getProgramInfoLog(this.program)}`);M.deleteShader(Fe),M.deleteShader(pe);for(let Je=0;Je<xe.length;Je++){const ft=xe[Je];if(ft&&!Ue[ft]){const kt=M.getUniformLocation(this.program,ft);kt&&(Ue[ft]=kt)}}this.fixedUniforms=b(l,Ue),this.terrainUniforms=((Je,ft)=>({u_depth:new o.aH(Je,ft.u_depth),u_terrain:new o.aH(Je,ft.u_terrain),u_terrain_dim:new o.aI(Je,ft.u_terrain_dim),u_terrain_matrix:new o.aJ(Je,ft.u_terrain_matrix),u_terrain_unpack:new o.aK(Je,ft.u_terrain_unpack),u_terrain_exaggeration:new o.aI(Je,ft.u_terrain_exaggeration)}))(l,Ue),this.binderUniforms=x?x.getUniforms(l,Ue):[]}draw(l,p,x,b,S,A,M,L,V,H,G,ie,le,he,xe,Se,Ce,je){const pe=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(x),l.setStencilMode(b),l.setColorMode(S),l.setCullFace(A),L){l.activeTexture.set(pe.TEXTURE2),pe.bindTexture(pe.TEXTURE_2D,L.depthTexture),l.activeTexture.set(pe.TEXTURE3),pe.bindTexture(pe.TEXTURE_2D,L.texture);for(const Ue in this.terrainUniforms)this.terrainUniforms[Ue].set(L[Ue])}for(const Ue in this.fixedUniforms)this.fixedUniforms[Ue].set(M[Ue]);xe&&xe.setUniforms(l,this.binderUniforms,le,{zoom:he});let Fe=0;switch(p){case pe.LINES:Fe=2;break;case pe.TRIANGLES:Fe=3;break;case pe.LINE_STRIP:Fe=1}for(const Ue of ie.get()){const Je=Ue.vaos||(Ue.vaos={});(Je[V]||(Je[V]=new jf)).bind(l,this,H,xe?xe.getPaintVertexBuffers():[],G,Ue.vertexOffset,Se,Ce,je),pe.drawElements(p,Ue.primitiveLength*Fe,pe.UNSIGNED_SHORT,Ue.primitiveOffset*Fe*2)}}}function Eh(k,l,p){const x=1/Fr(p,1,l.transform.tileZoom),b=Math.pow(2,p.tileID.overscaledZ),S=p.tileSize*Math.pow(2,l.transform.tileZoom)/b,A=S*(p.tileID.canonical.x+p.tileID.wrap*b),M=S*p.tileID.canonical.y;return{u_image:0,u_texsize:p.imageAtlasTexture.size,u_scale:[x,k.fromScale,k.toScale],u_fade:k.t,u_pixel_coord_upper:[A>>16,M>>16],u_pixel_coord_lower:[65535&A,65535&M]}}const ju=(k,l,p,x)=>{const b=l.style.light,S=b.properties.get("position"),A=[S.x,S.y,S.z],M=function(){var V=new o.A(9);return o.A!=Float32Array&&(V[1]=0,V[2]=0,V[3]=0,V[5]=0,V[6]=0,V[7]=0),V[0]=1,V[4]=1,V[8]=1,V}();b.properties.get("anchor")==="viewport"&&function(V,H){var G=Math.sin(H),ie=Math.cos(H);V[0]=ie,V[1]=G,V[2]=0,V[3]=-G,V[4]=ie,V[5]=0,V[6]=0,V[7]=0,V[8]=1}(M,-l.transform.angle),function(V,H,G){var ie=H[0],le=H[1],he=H[2];V[0]=ie*G[0]+le*G[3]+he*G[6],V[1]=ie*G[1]+le*G[4]+he*G[7],V[2]=ie*G[2]+le*G[5]+he*G[8]}(A,A,M);const L=b.properties.get("color");return{u_matrix:k,u_lightpos:A,u_lightintensity:b.properties.get("intensity"),u_lightcolor:[L.r,L.g,L.b],u_vertical_gradient:+p,u_opacity:x}},zh=(k,l,p,x,b,S,A)=>o.e(ju(k,l,p,x),Eh(S,l,A),{u_height_factor:-Math.pow(2,b.overscaledZ)/A.tileSize/8}),ul=k=>({u_matrix:k}),km=(k,l,p,x)=>o.e(ul(k),Eh(p,l,x)),P0=(k,l)=>({u_matrix:k,u_world:l}),Cm=(k,l,p,x,b)=>o.e(km(k,l,p,x),{u_world:b}),Mh=(k,l,p,x)=>{const b=k.transform;let S,A;if(x.paint.get("circle-pitch-alignment")==="map"){const M=Fr(p,1,b.zoom);S=!0,A=[M,M]}else S=!1,A=b.pixelsToGLUnits;return{u_camera_to_center_distance:b.cameraToCenterDistance,u_scale_with_map:+(x.paint.get("circle-pitch-scale")==="map"),u_matrix:k.translatePosMatrix(l.posMatrix,p,x.paint.get("circle-translate"),x.paint.get("circle-translate-anchor")),u_pitch_with_map:+S,u_device_pixel_ratio:k.pixelRatio,u_extrude_scale:A}},Ia=(k,l,p)=>({u_matrix:k,u_inv_matrix:l,u_camera_to_center_distance:p.cameraToCenterDistance,u_viewport_size:[p.width,p.height]}),Zl=(k,l,p=1)=>({u_matrix:k,u_color:l,u_overlay:0,u_overlay_scale:p}),Gi=k=>({u_matrix:k}),Os=(k,l,p,x)=>({u_matrix:k,u_extrude_scale:Fr(l,1,p),u_intensity:x}),Pu=(k,l,p,x)=>{const b=o.H();o.aP(b,0,k.width,k.height,0,0,1);const S=k.context.gl;return{u_matrix:b,u_world:[S.drawingBufferWidth,S.drawingBufferHeight],u_image:p,u_color_ramp:x,u_opacity:l.paint.get("heatmap-opacity")}};function zc(k,l){const p=Math.pow(2,l.canonical.z),x=l.canonical.y;return[new o.Z(0,x/p).toLngLat().lat,new o.Z(0,(x+1)/p).toLngLat().lat]}const Au=(k,l,p,x)=>{const b=k.transform;return{u_matrix:Tm(k,l,p,x),u_ratio:1/Fr(l,1,b.zoom),u_device_pixel_ratio:k.pixelRatio,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},hl=(k,l,p,x,b)=>o.e(Au(k,l,p,b),{u_image:0,u_image_height:x}),ea=(k,l,p,x,b)=>{const S=k.transform,A=Af(l,S);return{u_matrix:Tm(k,l,p,b),u_texsize:l.imageAtlasTexture.size,u_ratio:1/Fr(l,1,S.zoom),u_device_pixel_ratio:k.pixelRatio,u_image:0,u_scale:[A,x.fromScale,x.toScale],u_fade:x.t,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},A0=(k,l,p,x,b,S)=>{const A=k.lineAtlas,M=Af(l,k.transform),L=p.layout.get("line-cap")==="round",V=A.getDash(x.from,L),H=A.getDash(x.to,L),G=V.width*b.fromScale,ie=H.width*b.toScale;return o.e(Au(k,l,p,S),{u_patternscale_a:[M/G,-V.height/2],u_patternscale_b:[M/ie,-H.height/2],u_sdfgamma:A.width/(256*Math.min(G,ie)*k.pixelRatio)/2,u_image:0,u_tex_y_a:V.y,u_tex_y_b:H.y,u_mix:b.t})};function Af(k,l){return 1/Fr(k,1,l.tileZoom)}function Tm(k,l,p,x){return k.translatePosMatrix(x?x.posMatrix:l.tileID.posMatrix,l,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}const Om=(k,l,p,x,b)=>{return{u_matrix:k,u_tl_parent:l,u_scale_parent:p,u_buffer_scale:1,u_fade_t:x.mix,u_opacity:x.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(A=b.paint.get("raster-saturation"),A>0?1-1/(1.001-A):-A),u_contrast_factor:(S=b.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:E0(b.paint.get("raster-hue-rotate"))};var S,A};function E0(k){k*=Math.PI/180;const l=Math.sin(k),p=Math.cos(k);return[(2*p+1)/3,(-Math.sqrt(3)*l-p+1)/3,(Math.sqrt(3)*l-p+1)/3]}const jm=(k,l,p,x,b,S,A,M,L,V,H,G,ie,le)=>{const he=A.transform;return{u_is_size_zoom_constant:+(k==="constant"||k==="source"),u_is_size_feature_constant:+(k==="constant"||k==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:he.cameraToCenterDistance,u_pitch:he.pitch/360*2*Math.PI,u_rotate_symbol:+p,u_aspect_ratio:he.width/he.height,u_fade_change:A.options.fadeDuration?A.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:L,u_coord_matrix:V,u_is_text:+G,u_pitch_with_map:+x,u_is_along_line:b,u_is_variable_anchor:S,u_texsize:ie,u_texture:0,u_translation:H,u_pitched_scale:le}},Mc=(k,l,p,x,b,S,A,M,L,V,H,G,ie,le,he)=>{const xe=A.transform;return o.e(jm(k,l,p,x,b,S,A,M,L,V,H,G,ie,he),{u_gamma_scale:x?Math.cos(xe._pitch)*xe.cameraToCenterDistance:1,u_device_pixel_ratio:A.pixelRatio,u_is_halo:1})},Ef=(k,l,p,x,b,S,A,M,L,V,H,G,ie,le)=>o.e(Mc(k,l,p,x,b,S,A,M,L,V,H,!0,G,!0,le),{u_texsize_icon:ie,u_texture_icon:1}),ye=(k,l,p)=>({u_matrix:k,u_opacity:l,u_color:p}),Ne=(k,l,p,x,b,S)=>o.e(function(A,M,L,V){const H=L.imageManager.getPattern(A.from.toString()),G=L.imageManager.getPattern(A.to.toString()),{width:ie,height:le}=L.imageManager.getPixelSize(),he=Math.pow(2,V.tileID.overscaledZ),xe=V.tileSize*Math.pow(2,L.transform.tileZoom)/he,Se=xe*(V.tileID.canonical.x+V.tileID.wrap*he),Ce=xe*V.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:H.tl,u_pattern_br_a:H.br,u_pattern_tl_b:G.tl,u_pattern_br_b:G.br,u_texsize:[ie,le],u_mix:M.t,u_pattern_size_a:H.displaySize,u_pattern_size_b:G.displaySize,u_scale_a:M.fromScale,u_scale_b:M.toScale,u_tile_units_to_pixels:1/Fr(V,1,L.transform.tileZoom),u_pixel_coord_upper:[Se>>16,Ce>>16],u_pixel_coord_lower:[65535&Se,65535&Ce]}}(x,S,p,b),{u_matrix:k,u_opacity:l}),at={fillExtrusion:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_lightpos:new o.aN(k,l.u_lightpos),u_lightintensity:new o.aI(k,l.u_lightintensity),u_lightcolor:new o.aN(k,l.u_lightcolor),u_vertical_gradient:new o.aI(k,l.u_vertical_gradient),u_opacity:new o.aI(k,l.u_opacity)}),fillExtrusionPattern:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_lightpos:new o.aN(k,l.u_lightpos),u_lightintensity:new o.aI(k,l.u_lightintensity),u_lightcolor:new o.aN(k,l.u_lightcolor),u_vertical_gradient:new o.aI(k,l.u_vertical_gradient),u_height_factor:new o.aI(k,l.u_height_factor),u_image:new o.aH(k,l.u_image),u_texsize:new o.aO(k,l.u_texsize),u_pixel_coord_upper:new o.aO(k,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aO(k,l.u_pixel_coord_lower),u_scale:new o.aN(k,l.u_scale),u_fade:new o.aI(k,l.u_fade),u_opacity:new o.aI(k,l.u_opacity)}),fill:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix)}),fillPattern:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_image:new o.aH(k,l.u_image),u_texsize:new o.aO(k,l.u_texsize),u_pixel_coord_upper:new o.aO(k,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aO(k,l.u_pixel_coord_lower),u_scale:new o.aN(k,l.u_scale),u_fade:new o.aI(k,l.u_fade)}),fillOutline:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_world:new o.aO(k,l.u_world)}),fillOutlinePattern:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_world:new o.aO(k,l.u_world),u_image:new o.aH(k,l.u_image),u_texsize:new o.aO(k,l.u_texsize),u_pixel_coord_upper:new o.aO(k,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aO(k,l.u_pixel_coord_lower),u_scale:new o.aN(k,l.u_scale),u_fade:new o.aI(k,l.u_fade)}),circle:(k,l)=>({u_camera_to_center_distance:new o.aI(k,l.u_camera_to_center_distance),u_scale_with_map:new o.aH(k,l.u_scale_with_map),u_pitch_with_map:new o.aH(k,l.u_pitch_with_map),u_extrude_scale:new o.aO(k,l.u_extrude_scale),u_device_pixel_ratio:new o.aI(k,l.u_device_pixel_ratio),u_matrix:new o.aJ(k,l.u_matrix)}),collisionBox:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_pixel_extrude_scale:new o.aO(k,l.u_pixel_extrude_scale)}),collisionCircle:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_inv_matrix:new o.aJ(k,l.u_inv_matrix),u_camera_to_center_distance:new o.aI(k,l.u_camera_to_center_distance),u_viewport_size:new o.aO(k,l.u_viewport_size)}),debug:(k,l)=>({u_color:new o.aL(k,l.u_color),u_matrix:new o.aJ(k,l.u_matrix),u_overlay:new o.aH(k,l.u_overlay),u_overlay_scale:new o.aI(k,l.u_overlay_scale)}),clippingMask:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix)}),heatmap:(k,l)=>({u_extrude_scale:new o.aI(k,l.u_extrude_scale),u_intensity:new o.aI(k,l.u_intensity),u_matrix:new o.aJ(k,l.u_matrix)}),heatmapTexture:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_world:new o.aO(k,l.u_world),u_image:new o.aH(k,l.u_image),u_color_ramp:new o.aH(k,l.u_color_ramp),u_opacity:new o.aI(k,l.u_opacity)}),hillshade:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_image:new o.aH(k,l.u_image),u_latrange:new o.aO(k,l.u_latrange),u_light:new o.aO(k,l.u_light),u_shadow:new o.aL(k,l.u_shadow),u_highlight:new o.aL(k,l.u_highlight),u_accent:new o.aL(k,l.u_accent)}),hillshadePrepare:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_image:new o.aH(k,l.u_image),u_dimension:new o.aO(k,l.u_dimension),u_zoom:new o.aI(k,l.u_zoom),u_unpack:new o.aK(k,l.u_unpack)}),line:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_ratio:new o.aI(k,l.u_ratio),u_device_pixel_ratio:new o.aI(k,l.u_device_pixel_ratio),u_units_to_pixels:new o.aO(k,l.u_units_to_pixels)}),lineGradient:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_ratio:new o.aI(k,l.u_ratio),u_device_pixel_ratio:new o.aI(k,l.u_device_pixel_ratio),u_units_to_pixels:new o.aO(k,l.u_units_to_pixels),u_image:new o.aH(k,l.u_image),u_image_height:new o.aI(k,l.u_image_height)}),linePattern:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_texsize:new o.aO(k,l.u_texsize),u_ratio:new o.aI(k,l.u_ratio),u_device_pixel_ratio:new o.aI(k,l.u_device_pixel_ratio),u_image:new o.aH(k,l.u_image),u_units_to_pixels:new o.aO(k,l.u_units_to_pixels),u_scale:new o.aN(k,l.u_scale),u_fade:new o.aI(k,l.u_fade)}),lineSDF:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_ratio:new o.aI(k,l.u_ratio),u_device_pixel_ratio:new o.aI(k,l.u_device_pixel_ratio),u_units_to_pixels:new o.aO(k,l.u_units_to_pixels),u_patternscale_a:new o.aO(k,l.u_patternscale_a),u_patternscale_b:new o.aO(k,l.u_patternscale_b),u_sdfgamma:new o.aI(k,l.u_sdfgamma),u_image:new o.aH(k,l.u_image),u_tex_y_a:new o.aI(k,l.u_tex_y_a),u_tex_y_b:new o.aI(k,l.u_tex_y_b),u_mix:new o.aI(k,l.u_mix)}),raster:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_tl_parent:new o.aO(k,l.u_tl_parent),u_scale_parent:new o.aI(k,l.u_scale_parent),u_buffer_scale:new o.aI(k,l.u_buffer_scale),u_fade_t:new o.aI(k,l.u_fade_t),u_opacity:new o.aI(k,l.u_opacity),u_image0:new o.aH(k,l.u_image0),u_image1:new o.aH(k,l.u_image1),u_brightness_low:new o.aI(k,l.u_brightness_low),u_brightness_high:new o.aI(k,l.u_brightness_high),u_saturation_factor:new o.aI(k,l.u_saturation_factor),u_contrast_factor:new o.aI(k,l.u_contrast_factor),u_spin_weights:new o.aN(k,l.u_spin_weights)}),symbolIcon:(k,l)=>({u_is_size_zoom_constant:new o.aH(k,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aH(k,l.u_is_size_feature_constant),u_size_t:new o.aI(k,l.u_size_t),u_size:new o.aI(k,l.u_size),u_camera_to_center_distance:new o.aI(k,l.u_camera_to_center_distance),u_pitch:new o.aI(k,l.u_pitch),u_rotate_symbol:new o.aH(k,l.u_rotate_symbol),u_aspect_ratio:new o.aI(k,l.u_aspect_ratio),u_fade_change:new o.aI(k,l.u_fade_change),u_matrix:new o.aJ(k,l.u_matrix),u_label_plane_matrix:new o.aJ(k,l.u_label_plane_matrix),u_coord_matrix:new o.aJ(k,l.u_coord_matrix),u_is_text:new o.aH(k,l.u_is_text),u_pitch_with_map:new o.aH(k,l.u_pitch_with_map),u_is_along_line:new o.aH(k,l.u_is_along_line),u_is_variable_anchor:new o.aH(k,l.u_is_variable_anchor),u_texsize:new o.aO(k,l.u_texsize),u_texture:new o.aH(k,l.u_texture),u_translation:new o.aO(k,l.u_translation),u_pitched_scale:new o.aI(k,l.u_pitched_scale)}),symbolSDF:(k,l)=>({u_is_size_zoom_constant:new o.aH(k,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aH(k,l.u_is_size_feature_constant),u_size_t:new o.aI(k,l.u_size_t),u_size:new o.aI(k,l.u_size),u_camera_to_center_distance:new o.aI(k,l.u_camera_to_center_distance),u_pitch:new o.aI(k,l.u_pitch),u_rotate_symbol:new o.aH(k,l.u_rotate_symbol),u_aspect_ratio:new o.aI(k,l.u_aspect_ratio),u_fade_change:new o.aI(k,l.u_fade_change),u_matrix:new o.aJ(k,l.u_matrix),u_label_plane_matrix:new o.aJ(k,l.u_label_plane_matrix),u_coord_matrix:new o.aJ(k,l.u_coord_matrix),u_is_text:new o.aH(k,l.u_is_text),u_pitch_with_map:new o.aH(k,l.u_pitch_with_map),u_is_along_line:new o.aH(k,l.u_is_along_line),u_is_variable_anchor:new o.aH(k,l.u_is_variable_anchor),u_texsize:new o.aO(k,l.u_texsize),u_texture:new o.aH(k,l.u_texture),u_gamma_scale:new o.aI(k,l.u_gamma_scale),u_device_pixel_ratio:new o.aI(k,l.u_device_pixel_ratio),u_is_halo:new o.aH(k,l.u_is_halo),u_translation:new o.aO(k,l.u_translation),u_pitched_scale:new o.aI(k,l.u_pitched_scale)}),symbolTextAndIcon:(k,l)=>({u_is_size_zoom_constant:new o.aH(k,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aH(k,l.u_is_size_feature_constant),u_size_t:new o.aI(k,l.u_size_t),u_size:new o.aI(k,l.u_size),u_camera_to_center_distance:new o.aI(k,l.u_camera_to_center_distance),u_pitch:new o.aI(k,l.u_pitch),u_rotate_symbol:new o.aH(k,l.u_rotate_symbol),u_aspect_ratio:new o.aI(k,l.u_aspect_ratio),u_fade_change:new o.aI(k,l.u_fade_change),u_matrix:new o.aJ(k,l.u_matrix),u_label_plane_matrix:new o.aJ(k,l.u_label_plane_matrix),u_coord_matrix:new o.aJ(k,l.u_coord_matrix),u_is_text:new o.aH(k,l.u_is_text),u_pitch_with_map:new o.aH(k,l.u_pitch_with_map),u_is_along_line:new o.aH(k,l.u_is_along_line),u_is_variable_anchor:new o.aH(k,l.u_is_variable_anchor),u_texsize:new o.aO(k,l.u_texsize),u_texsize_icon:new o.aO(k,l.u_texsize_icon),u_texture:new o.aH(k,l.u_texture),u_texture_icon:new o.aH(k,l.u_texture_icon),u_gamma_scale:new o.aI(k,l.u_gamma_scale),u_device_pixel_ratio:new o.aI(k,l.u_device_pixel_ratio),u_is_halo:new o.aH(k,l.u_is_halo),u_translation:new o.aO(k,l.u_translation),u_pitched_scale:new o.aI(k,l.u_pitched_scale)}),background:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_opacity:new o.aI(k,l.u_opacity),u_color:new o.aL(k,l.u_color)}),backgroundPattern:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_opacity:new o.aI(k,l.u_opacity),u_image:new o.aH(k,l.u_image),u_pattern_tl_a:new o.aO(k,l.u_pattern_tl_a),u_pattern_br_a:new o.aO(k,l.u_pattern_br_a),u_pattern_tl_b:new o.aO(k,l.u_pattern_tl_b),u_pattern_br_b:new o.aO(k,l.u_pattern_br_b),u_texsize:new o.aO(k,l.u_texsize),u_mix:new o.aI(k,l.u_mix),u_pattern_size_a:new o.aO(k,l.u_pattern_size_a),u_pattern_size_b:new o.aO(k,l.u_pattern_size_b),u_scale_a:new o.aI(k,l.u_scale_a),u_scale_b:new o.aI(k,l.u_scale_b),u_pixel_coord_upper:new o.aO(k,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.aO(k,l.u_pixel_coord_lower),u_tile_units_to_pixels:new o.aI(k,l.u_tile_units_to_pixels)}),terrain:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_texture:new o.aH(k,l.u_texture),u_ele_delta:new o.aI(k,l.u_ele_delta),u_fog_matrix:new o.aJ(k,l.u_fog_matrix),u_fog_color:new o.aL(k,l.u_fog_color),u_fog_ground_blend:new o.aI(k,l.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.aI(k,l.u_fog_ground_blend_opacity),u_horizon_color:new o.aL(k,l.u_horizon_color),u_horizon_fog_blend:new o.aI(k,l.u_horizon_fog_blend)}),terrainDepth:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_ele_delta:new o.aI(k,l.u_ele_delta)}),terrainCoords:(k,l)=>({u_matrix:new o.aJ(k,l.u_matrix),u_texture:new o.aH(k,l.u_texture),u_terrain_coords_id:new o.aI(k,l.u_terrain_coords_id),u_ele_delta:new o.aI(k,l.u_ele_delta)}),sky:(k,l)=>({u_sky_color:new o.aL(k,l.u_sky_color),u_horizon_color:new o.aL(k,l.u_horizon_color),u_horizon:new o.aI(k,l.u_horizon),u_sky_horizon_blend:new o.aI(k,l.u_sky_horizon_blend)})};class Jt{constructor(l,p,x){this.context=l;const b=l.gl;this.buffer=b.createBuffer(),this.dynamicDraw=!!x,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const p=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const rn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class vn{constructor(l,p,x,b){this.length=p.length,this.attributes=x,this.itemSize=p.bytesPerElement,this.dynamicDraw=b,this.context=l;const S=l.gl;this.buffer=S.createBuffer(),l.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,p){for(let x=0;x<this.attributes.length;x++){const b=p.attributes[this.attributes[x].name];b!==void 0&&l.enableVertexAttribArray(b)}}setVertexAttribPointers(l,p,x){for(let b=0;b<this.attributes.length;b++){const S=this.attributes[b],A=p.attributes[S.name];A!==void 0&&l.vertexAttribPointer(A,S.components,l[rn[S.type]],!1,this.itemSize,S.offset+this.itemSize*(x||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const gn=new WeakMap;function Hr(k){var l;if(gn.has(k))return gn.get(k);{const p=(l=k.getParameter(k.VERSION))===null||l===void 0?void 0:l.startsWith("WebGL 2.0");return gn.set(k,p),p}}class br{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class js extends br{getDefault(){return o.aM.transparent}set(l){const p=this.current;(l.r!==p.r||l.g!==p.g||l.b!==p.b||l.a!==p.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Us extends br{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class ta extends br{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class zf extends br{getDefault(){return[!0,!0,!0,!0]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||l[3]!==p[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Ih extends br{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class Pm extends br{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class q1 extends br{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const p=this.current;(l.func!==p.func||l.ref!==p.ref||l.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class z0 extends br{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class Q1 extends br{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=l,this.dirty=!1}}class H1 extends br{getDefault(){return[0,1]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class G1 extends br{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=l,this.dirty=!1}}class X1 extends br{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class Eu extends br{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.BLEND):p.disable(p.BLEND),this.current=l,this.dirty=!1}}class K1 extends br{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class EC extends br{getDefault(){return o.aM.transparent}set(l){const p=this.current;(l.r!==p.r||l.g!==p.g||l.b!==p.b||l.a!==p.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Z1 extends br{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class Mf extends br{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;l?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=l,this.dirty=!1}}class zC extends br{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class Am extends br{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class MC extends br{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class IC extends br{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class Y1 extends br{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const p=this.current;(l[0]!==p[0]||l[1]!==p[1]||l[2]!==p[2]||l[3]!==p[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class J1 extends br{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class e_ extends br{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class M0 extends br{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class t_ extends br{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Em extends br{getDefault(){return null}set(l){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Yl extends br{getDefault(){return null}set(l){var p;if(l===this.current&&!this.dirty)return;const x=this.gl;Hr(x)?x.bindVertexArray(l):(p=x.getExtension("OES_vertex_array_object"))===null||p===void 0||p.bindVertexArrayOES(l),this.current=l,this.dirty=!1}}class I0 extends br{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class R0 extends br{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class D0 extends br{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class zm extends br{constructor(l,p){super(l),this.context=l,this.parent=p}getDefault(){return null}}class L0 extends zm{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class zu extends zm{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class F0 extends zm{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_STENCIL_ATTACHMENT,p.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class RC{constructor(l,p,x,b,S){this.context=l,this.width=p,this.height=x;const A=l.gl,M=this.framebuffer=A.createFramebuffer();if(this.colorAttachment=new L0(l,M),b)this.depthAttachment=S?new F0(l,M):new zu(l,M);else if(S)throw new Error("Stencil cannot be set without depth");if(A.checkFramebufferStatus(A.FRAMEBUFFER)!==A.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const l=this.context.gl,p=this.colorAttachment.get();if(p&&l.deleteTexture(p),this.depthAttachment){const x=this.depthAttachment.get();x&&l.deleteRenderbuffer(x)}l.deleteFramebuffer(this.framebuffer)}}class mi{constructor(l,p,x){this.blendFunction=l,this.blendColor=p,this.mask=x}}mi.Replace=[1,0],mi.disabled=new mi(mi.Replace,o.aM.transparent,[!1,!1,!1,!1]),mi.unblended=new mi(mi.Replace,o.aM.transparent,[!0,!0,!0,!0]),mi.alphaBlended=new mi([1,771],o.aM.transparent,[!0,!0,!0,!0]);class DC{constructor(l){var p,x;if(this.gl=l,this.clearColor=new js(this),this.clearDepth=new Us(this),this.clearStencil=new ta(this),this.colorMask=new zf(this),this.depthMask=new Ih(this),this.stencilMask=new Pm(this),this.stencilFunc=new q1(this),this.stencilOp=new z0(this),this.stencilTest=new Q1(this),this.depthRange=new H1(this),this.depthTest=new G1(this),this.depthFunc=new X1(this),this.blend=new Eu(this),this.blendFunc=new K1(this),this.blendColor=new EC(this),this.blendEquation=new Z1(this),this.cullFace=new Mf(this),this.cullFaceSide=new zC(this),this.frontFace=new Am(this),this.program=new MC(this),this.activeTexture=new IC(this),this.viewport=new Y1(this),this.bindFramebuffer=new J1(this),this.bindRenderbuffer=new e_(this),this.bindTexture=new M0(this),this.bindVertexBuffer=new t_(this),this.bindElementBuffer=new Em(this),this.bindVertexArray=new Yl(this),this.pixelStoreUnpack=new I0(this),this.pixelStoreUnpackPremultiplyAlpha=new R0(this),this.pixelStoreUnpackFlipY=new D0(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),Hr(l)){this.HALF_FLOAT=l.HALF_FLOAT;const b=l.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(p=l.RGBA16F)!==null&&p!==void 0?p:b==null?void 0:b.RGBA16F_EXT,this.RGB16F=(x=l.RGB16F)!==null&&x!==void 0?x:b==null?void 0:b.RGB16F_EXT,l.getExtension("EXT_color_buffer_float")}else{l.getExtension("EXT_color_buffer_half_float"),l.getExtension("OES_texture_half_float_linear");const b=l.getExtension("OES_texture_half_float");this.HALF_FLOAT=b==null?void 0:b.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,p){return new Jt(this,l,p)}createVertexBuffer(l,p,x){return new vn(this,l,p,x)}createRenderbuffer(l,p,x){const b=this.gl,S=b.createRenderbuffer();return this.bindRenderbuffer.set(S),b.renderbufferStorage(b.RENDERBUFFER,l,p,x),this.bindRenderbuffer.set(null),S}createFramebuffer(l,p,x,b){return new RC(this,l,p,x,b)}clear({color:l,depth:p,stencil:x}){const b=this.gl;let S=0;l&&(S|=b.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(S|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),x!==void 0&&(S|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(x),this.stencilMask.set(255)),b.clear(S)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){o.aE(l.blendFunction,mi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}createVertexArray(){var l;return Hr(this.gl)?this.gl.createVertexArray():(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.createVertexArrayOES()}deleteVertexArray(l){var p;return Hr(this.gl)?this.gl.deleteVertexArray(l):(p=this.gl.getExtension("OES_vertex_array_object"))===null||p===void 0?void 0:p.deleteVertexArrayOES(l)}unbindVAO(){this.bindVertexArray.set(null)}}class qr{constructor(l,p,x){this.func=l,this.mask=p,this.range=x}}qr.ReadOnly=!1,qr.ReadWrite=!0,qr.disabled=new qr(519,qr.ReadOnly,[0,1]);const Mm=7680;class $n{constructor(l,p,x,b,S,A){this.test=l,this.ref=p,this.mask=x,this.fail=b,this.depthFail=S,this.pass=A}}$n.disabled=new $n({func:519,mask:0},0,0,Mm,Mm,Mm);class Tn{constructor(l,p,x){this.enable=l,this.mode=p,this.frontFace=x}}let Mu;function If(k,l,p,x,b){const S=k.context,A=S.gl,M=k.useProgram("collisionBox"),L=[];let V=0,H=0;for(let Ce=0;Ce<x.length;Ce++){const je=x[Ce],pe=l.getTile(je).getBucket(p);if(!pe)continue;const Fe=b?pe.textCollisionBox:pe.iconCollisionBox,Ue=pe.collisionCircleArray;if(Ue.length>0){const Je=o.H();o.aQ(Je,pe.placementInvProjMatrix,k.transform.glCoordMatrix),o.aQ(Je,Je,pe.placementViewportMatrix),L.push({circleArray:Ue,circleOffset:H,transform:je.posMatrix,invTransform:Je,coord:je}),V+=Ue.length/4,H=V}Fe&&M.draw(S,A.LINES,qr.disabled,$n.disabled,k.colorModeForRenderPass(),Tn.disabled,{u_matrix:je.posMatrix,u_pixel_extrude_scale:[1/(G=k.transform).width,1/G.height]},k.style.map.terrain&&k.style.map.terrain.getTerrainData(je),p.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,null,k.transform.zoom,null,null,Fe.collisionVertexBuffer)}var G;if(!b||!L.length)return;const ie=k.useProgram("collisionCircle"),le=new o.aR;le.resize(4*V),le._trim();let he=0;for(const Ce of L)for(let je=0;je<Ce.circleArray.length/4;je++){const pe=4*je,Fe=Ce.circleArray[pe+0],Ue=Ce.circleArray[pe+1],Je=Ce.circleArray[pe+2],ft=Ce.circleArray[pe+3];le.emplace(he++,Fe,Ue,Je,ft,0),le.emplace(he++,Fe,Ue,Je,ft,1),le.emplace(he++,Fe,Ue,Je,ft,2),le.emplace(he++,Fe,Ue,Je,ft,3)}(!Mu||Mu.length<2*V)&&(Mu=function(Ce){const je=2*Ce,pe=new o.aT;pe.resize(je),pe._trim();for(let Fe=0;Fe<je;Fe++){const Ue=6*Fe;pe.uint16[Ue+0]=4*Fe+0,pe.uint16[Ue+1]=4*Fe+1,pe.uint16[Ue+2]=4*Fe+2,pe.uint16[Ue+3]=4*Fe+2,pe.uint16[Ue+4]=4*Fe+3,pe.uint16[Ue+5]=4*Fe+0}return pe}(V));const xe=S.createIndexBuffer(Mu,!0),Se=S.createVertexBuffer(le,o.aS.members,!0);for(const Ce of L){const je=Ia(Ce.transform,Ce.invTransform,k.transform);ie.draw(S,A.TRIANGLES,qr.disabled,$n.disabled,k.colorModeForRenderPass(),Tn.disabled,je,k.style.map.terrain&&k.style.map.terrain.getTerrainData(Ce.coord),p.id,Se,xe,o.a0.simpleSegment(0,2*Ce.circleOffset,Ce.circleArray.length,Ce.circleArray.length/2),null,k.transform.zoom,null,null,null)}Se.destroy(),xe.destroy()}Tn.disabled=new Tn(!1,1029,2305),Tn.backCCW=new Tn(!0,1029,2305);const Rf=o.an(new Float32Array(16));function B0(k,l,p,x,b,S){const{horizontalAlign:A,verticalAlign:M}=o.au(k);return new o.P((-(A-.5)*l/b+x[0])*S,(-(M-.5)*p/b+x[1])*S)}function Iu(k,l,p,x,b,S){const A=l.tileAnchorPoint.add(new o.P(l.translation[0],l.translation[1]));if(l.pitchWithMap){let M=x.mult(S);p||(M=M.rotate(-b));const L=A.add(M);return ge(L.x,L.y,l.labelPlaneMatrix,l.getElevation).point}if(p){const M=nt(l.tileAnchorPoint.x+1,l.tileAnchorPoint.y,l).point.sub(k),L=Math.atan(M.y/M.x)+(M.x<0?Math.PI:0);return k.add(x.rotate(L))}return k.add(x)}function Rh(k,l,p,x,b,S,A,M,L,V,H,G,ie,le){const he=k.text.placedSymbolArray,xe=k.text.dynamicLayoutVertexArray,Se=k.icon.dynamicLayoutVertexArray,Ce={};xe.clear();for(let je=0;je<he.length;je++){const pe=he.get(je),Fe=pe.hidden||!pe.crossTileID||k.allowVerticalPlacement&&!pe.placedOrientation?null:x[pe.crossTileID];if(Fe){const Ue=new o.P(pe.anchorX,pe.anchorY),Je={getElevation:le,width:b.width,height:b.height,labelPlaneMatrix:S,pitchWithMap:p,projection:H,tileAnchorPoint:Ue,translation:G,unwrappedTileID:ie},ft=p?ge(Ue.x,Ue.y,A,le):nt(Ue.x,Ue.y,Je),kt=W(b.cameraToCenterDistance,ft.signedDistanceFromCamera);let Lt=o.ai(k.textSizeData,L,pe)*kt/o.ap;p&&(Lt*=k.tilePixelRatio/M);const{width:qt,height:zt,anchor:At,textOffset:ar,textBoxScale:Pr}=Fe,It=B0(At,qt,zt,ar,Pr,Lt),Nt=H.getPitchedTextCorrection(b,Ue.add(new o.P(G[0],G[1])),ie),Tr=Iu(ft.point,Je,l,It,b.angle,Nt),Qn=k.allowVerticalPlacement&&pe.placedOrientation===o.ah.vertical?Math.PI/2:0;for(let $r=0;$r<pe.numGlyphs;$r++)o.aj(xe,Tr,Qn);V&&pe.associatedIconIndex>=0&&(Ce[pe.associatedIconIndex]={shiftedAnchor:Tr,angle:Qn})}else nr(pe.numGlyphs,xe)}if(V){Se.clear();const je=k.icon.placedSymbolArray;for(let pe=0;pe<je.length;pe++){const Fe=je.get(pe);if(Fe.hidden)nr(Fe.numGlyphs,Se);else{const Ue=Ce[pe];if(Ue)for(let Je=0;Je<Fe.numGlyphs;Je++)o.aj(Se,Ue.shiftedAnchor,Ue.angle);else nr(Fe.numGlyphs,Se)}}k.icon.dynamicLayoutVertexBuffer.updateData(Se)}k.text.dynamicLayoutVertexBuffer.updateData(xe)}function ra(k,l,p){return p.iconsInText&&l?"symbolTextAndIcon":k?"symbolSDF":"symbolIcon"}function $0(k,l,p,x,b,S,A,M,L,V,H,G){const ie=k.context,le=ie.gl,he=k.transform,xe=Xl(),Se=M==="map",Ce=L==="map",je=M!=="viewport"&&p.layout.get("symbol-placement")!=="point",pe=Se&&!Ce&&!je,Fe=!Ce&&je,Ue=!p.layout.get("symbol-sort-key").isConstant();let Je=!1;const ft=k.depthModeForSublayer(0,qr.ReadOnly),kt=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Lt=[],qt=xe.getCircleRadiusCorrection(he);for(const zt of x){const At=l.getTile(zt),ar=At.getBucket(p);if(!ar)continue;const Pr=b?ar.text:ar.icon;if(!Pr||!Pr.segments.get().length||!Pr.hasVisibleVertices)continue;const It=Pr.programConfigurations.get(p.id),Nt=b||ar.sdfIcons,Tr=b?ar.textSizeData:ar.iconSizeData,Qn=Ce||he.pitch!==0,$r=k.useProgram(ra(Nt,b,ar),It),Gr=o.ag(Tr,he.zoom),Hn=k.style.map.terrain&&k.style.map.terrain.getTerrainData(zt);let As,La,Gn,ho,qs=[0,0],Es=null;if(b)La=At.glyphAtlasTexture,Gn=le.LINEAR,As=At.glyphAtlasTexture.size,ar.iconsInText&&(qs=At.imageAtlasTexture.size,Es=At.imageAtlasTexture,ho=Qn||k.options.rotating||k.options.zooming||Tr.kind==="composite"||Tr.kind==="camera"?le.LINEAR:le.NEAREST);else{const Yr=p.layout.get("icon-size").constantOr(0)!==1||ar.iconsNeedLinear;La=At.imageAtlasTexture,Gn=Nt||k.options.rotating||k.options.zooming||Yr||Qn?le.LINEAR:le.NEAREST,As=At.imageAtlasTexture.size}const Qs=Fr(At,1,k.transform.zoom),pl=Fe?zt.posMatrix:Rf,Kh=Li(pl,Ce,Se,k.transform,Qs),Ym=cs(pl,Ce,Se,k.transform,Qs),Zh=cs(zt.posMatrix,Ce,Se,k.transform,Qs),sa=xe.translatePosition(k.transform,At,S,A),Jm=kt&&ar.hasTextData(),hx=p.layout.get("icon-text-fit")!=="none"&&Jm&&ar.hasIconData();if(je){const Yr=k.style.map.terrain?(Yh,Jh)=>k.style.map.terrain.getElevation(zt,Yh,Jh):null,Bu=p.layout.get("text-rotation-alignment")==="map";te(ar,zt.posMatrix,k,b,Kh,Zh,Ce,V,Bu,xe,zt.toUnwrapped(),he.width,he.height,sa,Yr)}const oa=zt.posMatrix,aa=b&&kt||hx,Ic=je||aa?Rf:Kh,Fa=Ym,hs=Nt&&p.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let zs;zs=Nt?ar.iconsInText?Ef(Tr.kind,Gr,pe,Ce,je,aa,k,oa,Ic,Fa,sa,As,qs,qt):Mc(Tr.kind,Gr,pe,Ce,je,aa,k,oa,Ic,Fa,sa,b,As,!0,qt):jm(Tr.kind,Gr,pe,Ce,je,aa,k,oa,Ic,Fa,sa,b,As,qt);const Mo={program:$r,buffers:Pr,uniformValues:zs,atlasTexture:La,atlasTextureIcon:Es,atlasInterpolation:Gn,atlasInterpolationIcon:ho,isSDF:Nt,hasHalo:hs};if(Ue&&ar.canOverlap){Je=!0;const Yr=Pr.segments.get();for(const Bu of Yr)Lt.push({segments:new o.a0([Bu]),sortKey:Bu.sortKey,state:Mo,terrainData:Hn})}else Lt.push({segments:Pr.segments,sortKey:0,state:Mo,terrainData:Hn})}Je&&Lt.sort((zt,At)=>zt.sortKey-At.sortKey);for(const zt of Lt){const At=zt.state;if(ie.activeTexture.set(le.TEXTURE0),At.atlasTexture.bind(At.atlasInterpolation,le.CLAMP_TO_EDGE),At.atlasTextureIcon&&(ie.activeTexture.set(le.TEXTURE1),At.atlasTextureIcon&&At.atlasTextureIcon.bind(At.atlasInterpolationIcon,le.CLAMP_TO_EDGE)),At.isSDF){const ar=At.uniformValues;At.hasHalo&&(ar.u_is_halo=1,N0(At.buffers,zt.segments,p,k,At.program,ft,H,G,ar,zt.terrainData)),ar.u_is_halo=0}N0(At.buffers,zt.segments,p,k,At.program,ft,H,G,At.uniformValues,zt.terrainData)}}function N0(k,l,p,x,b,S,A,M,L,V){const H=x.context;b.draw(H,H.gl.TRIANGLES,S,A,M,Tn.disabled,L,V,p.id,k.layoutVertexBuffer,k.indexBuffer,l,p.paint,x.transform.zoom,k.programConfigurations.get(p.id),k.dynamicLayoutVertexBuffer,k.opacityVertexBuffer)}function V0(k,l,p,x){const b=k.context,S=b.gl,A=$n.disabled,M=new mi([S.ONE,S.ONE],o.aM.transparent,[!0,!0,!0,!0]),L=l.getBucket(p);if(!L)return;const V=x.key;let H=p.heatmapFbos.get(V);H||(H=Df(b,l.tileSize,l.tileSize),p.heatmapFbos.set(V,H)),b.bindFramebuffer.set(H.framebuffer),b.viewport.set([0,0,l.tileSize,l.tileSize]),b.clear({color:o.aM.transparent});const G=L.programConfigurations.get(p.id),ie=k.useProgram("heatmap",G),le=k.style.map.terrain.getTerrainData(x);ie.draw(b,S.TRIANGLES,qr.disabled,A,M,Tn.disabled,Os(x.posMatrix,l,k.transform.zoom,p.paint.get("heatmap-intensity")),le,p.id,L.layoutVertexBuffer,L.indexBuffer,L.segments,p.paint,k.transform.zoom,G)}function Ru(k,l,p){const x=k.context,b=x.gl;x.setColorMode(k.colorModeForRenderPass());const S=Lf(x,l),A=p.key,M=l.heatmapFbos.get(A);M&&(x.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,M.colorAttachment.get()),x.activeTexture.set(b.TEXTURE1),S.bind(b.LINEAR,b.CLAMP_TO_EDGE),k.useProgram("heatmapTexture").draw(x,b.TRIANGLES,qr.disabled,$n.disabled,k.colorModeForRenderPass(),Tn.disabled,Pu(k,l,0,1),null,l.id,k.rasterBoundsBuffer,k.quadTriangleIndexBuffer,k.rasterBoundsSegments,l.paint,k.transform.zoom),M.destroy(),l.heatmapFbos.delete(A))}function Df(k,l,p){var x,b;const S=k.gl,A=S.createTexture();S.bindTexture(S.TEXTURE_2D,A),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,S.LINEAR),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,S.LINEAR);const M=(x=k.HALF_FLOAT)!==null&&x!==void 0?x:S.UNSIGNED_BYTE,L=(b=k.RGBA16F)!==null&&b!==void 0?b:S.RGBA;S.texImage2D(S.TEXTURE_2D,0,L,l,p,0,S.RGBA,M,null);const V=k.createFramebuffer(l,p,!1,!1);return V.colorAttachment.set(A),V}function Lf(k,l){return l.colorRampTexture||(l.colorRampTexture=new ce(k,l.colorRamp,k.gl.RGBA)),l.colorRampTexture}function Dh(k,l,p,x,b){if(!p||!x||!x.imageAtlas)return;const S=x.imageAtlas.patternPositions;let A=S[p.to.toString()],M=S[p.from.toString()];if(!A&&M&&(A=M),!M&&A&&(M=A),!A||!M){const L=b.getPaintProperty(l);A=S[L],M=S[L]}A&&M&&k.setConstantPatternPositions(A,M)}function Ff(k,l,p,x,b,S,A){const M=k.context.gl,L="fill-pattern",V=p.paint.get(L),H=V&&V.constantOr(1),G=p.getCrossfadeParameters();let ie,le,he,xe,Se;A?(le=H&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ie=M.LINES):(le=H?"fillPattern":"fill",ie=M.TRIANGLES);const Ce=V.constantOr(null);for(const je of x){const pe=l.getTile(je);if(H&&!pe.patternsLoaded())continue;const Fe=pe.getBucket(p);if(!Fe)continue;const Ue=Fe.programConfigurations.get(p.id),Je=k.useProgram(le,Ue),ft=k.style.map.terrain&&k.style.map.terrain.getTerrainData(je);H&&(k.context.activeTexture.set(M.TEXTURE0),pe.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),Ue.updatePaintBuffers(G)),Dh(Ue,L,Ce,pe,p);const kt=ft?je:null,Lt=k.translatePosMatrix(kt?kt.posMatrix:je.posMatrix,pe,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(A){xe=Fe.indexBuffer2,Se=Fe.segments2;const qt=[M.drawingBufferWidth,M.drawingBufferHeight];he=le==="fillOutlinePattern"&&H?Cm(Lt,k,G,pe,qt):P0(Lt,qt)}else xe=Fe.indexBuffer,Se=Fe.segments,he=H?km(Lt,k,G,pe):ul(Lt);Je.draw(k.context,ie,b,k.stencilModeForClipping(je),S,Tn.disabled,he,ft,p.id,Fe.layoutVertexBuffer,xe,Se,p.paint,k.transform.zoom,Ue)}}function Im(k,l,p,x,b,S,A){const M=k.context,L=M.gl,V="fill-extrusion-pattern",H=p.paint.get(V),G=H.constantOr(1),ie=p.getCrossfadeParameters(),le=p.paint.get("fill-extrusion-opacity"),he=H.constantOr(null);for(const xe of x){const Se=l.getTile(xe),Ce=Se.getBucket(p);if(!Ce)continue;const je=k.style.map.terrain&&k.style.map.terrain.getTerrainData(xe),pe=Ce.programConfigurations.get(p.id),Fe=k.useProgram(G?"fillExtrusionPattern":"fillExtrusion",pe);G&&(k.context.activeTexture.set(L.TEXTURE0),Se.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),pe.updatePaintBuffers(ie)),Dh(pe,V,he,Se,p);const Ue=k.translatePosMatrix(xe.posMatrix,Se,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),Je=p.paint.get("fill-extrusion-vertical-gradient"),ft=G?zh(Ue,k,Je,le,xe,ie,Se):ju(Ue,k,Je,le);Fe.draw(M,M.gl.TRIANGLES,b,S,A,Tn.backCCW,ft,je,p.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,p.paint,k.transform.zoom,pe,k.style.map.terrain&&Ce.centroidVertexBuffer)}}function Lh(k,l,p,x,b,S,A){const M=k.context,L=M.gl,V=p.fbo;if(!V)return;const H=k.useProgram("hillshade"),G=k.style.map.terrain&&k.style.map.terrain.getTerrainData(l);M.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,V.colorAttachment.get()),H.draw(M,L.TRIANGLES,b,S,A,Tn.disabled,((ie,le,he,xe)=>{const Se=he.paint.get("hillshade-shadow-color"),Ce=he.paint.get("hillshade-highlight-color"),je=he.paint.get("hillshade-accent-color");let pe=he.paint.get("hillshade-illumination-direction")*(Math.PI/180);he.paint.get("hillshade-illumination-anchor")==="viewport"&&(pe-=ie.transform.angle);const Fe=!ie.options.moving;return{u_matrix:xe?xe.posMatrix:ie.transform.calculatePosMatrix(le.tileID.toUnwrapped(),Fe),u_image:0,u_latrange:zc(0,le.tileID),u_light:[he.paint.get("hillshade-exaggeration"),pe],u_shadow:Se,u_highlight:Ce,u_accent:je}})(k,p,x,G?l:null),G,x.id,k.rasterBoundsBuffer,k.quadTriangleIndexBuffer,k.rasterBoundsSegments)}function Fh(k,l,p,x,b,S){const A=k.context,M=A.gl,L=l.dem;if(L&&L.data){const V=L.dim,H=L.stride,G=L.getPixels();if(A.activeTexture.set(M.TEXTURE1),A.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||k.getTileTexture(H),l.demTexture){const le=l.demTexture;le.update(G,{premultiply:!1}),le.bind(M.NEAREST,M.CLAMP_TO_EDGE)}else l.demTexture=new ce(A,G,M.RGBA,{premultiply:!1}),l.demTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE);A.activeTexture.set(M.TEXTURE0);let ie=l.fbo;if(!ie){const le=new ce(A,{width:V,height:V,data:null},M.RGBA);le.bind(M.LINEAR,M.CLAMP_TO_EDGE),ie=l.fbo=A.createFramebuffer(V,V,!0,!1),ie.colorAttachment.set(le.texture)}A.bindFramebuffer.set(ie.framebuffer),A.viewport.set([0,0,V,V]),k.useProgram("hillshadePrepare").draw(A,M.TRIANGLES,x,b,S,Tn.disabled,((le,he)=>{const xe=he.stride,Se=o.H();return o.aP(Se,0,o.X,-o.X,0,0,1),o.J(Se,Se,[0,-o.X,0]),{u_matrix:Se,u_image:1,u_dimension:[xe,xe],u_zoom:le.overscaledZ,u_unpack:he.getUnpackVector()}})(l.tileID,L),null,p.id,k.rasterBoundsBuffer,k.quadTriangleIndexBuffer,k.rasterBoundsSegments),l.needsHillshadePrepare=!1}}function r_(k,l,p,x,b,S){const A=x.paint.get("raster-fade-duration");if(!S&&A>0){const M=v.now(),L=(M-k.timeAdded)/A,V=l?(M-l.timeAdded)/A:-1,H=p.getSource(),G=b.coveringZoomLevel({tileSize:H.tileSize,roundZoom:H.roundZoom}),ie=!l||Math.abs(l.tileID.overscaledZ-G)>Math.abs(k.tileID.overscaledZ-G),le=ie&&k.refreshedUponExpiration?1:o.ac(ie?L:1-V,0,1);return k.refreshedUponExpiration&&L>=1&&(k.refreshedUponExpiration=!1),l?{opacity:1,mix:1-le}:{opacity:le,mix:0}}return{opacity:1,mix:0}}const W0=new o.aM(1,0,0,1),cn=new o.aM(0,1,0,1),Rm=new o.aM(0,0,1,1),LC=new o.aM(1,0,1,1),n_=new o.aM(0,1,1,1);function Bh(k,l,p,x){Dm(k,0,l+p/2,k.transform.width,p,x)}function i_(k,l,p,x){Dm(k,l-p/2,0,p,k.transform.height,x)}function Dm(k,l,p,x,b,S){const A=k.context,M=A.gl;M.enable(M.SCISSOR_TEST),M.scissor(l*k.pixelRatio,p*k.pixelRatio,x*k.pixelRatio,b*k.pixelRatio),A.clear({color:S}),M.disable(M.SCISSOR_TEST)}function s_(k,l,p){const x=k.context,b=x.gl,S=p.posMatrix,A=k.useProgram("debug"),M=qr.disabled,L=$n.disabled,V=k.colorModeForRenderPass(),H="$debug",G=k.style.map.terrain&&k.style.map.terrain.getTerrainData(p);x.activeTexture.set(b.TEXTURE0);const ie=l.getTileByID(p.key).latestRawTileData,le=Math.floor((ie&&ie.byteLength||0)/1024),he=l.getTile(p).tileSize,xe=512/Math.min(he,512)*(p.overscaledZ/k.transform.zoom)*.5;let Se=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(Se+=` => ${p.overscaledZ}`),function(Ce,je){Ce.initDebugOverlayCanvas();const pe=Ce.debugOverlayCanvas,Fe=Ce.context.gl,Ue=Ce.debugOverlayCanvas.getContext("2d");Ue.clearRect(0,0,pe.width,pe.height),Ue.shadowColor="white",Ue.shadowBlur=2,Ue.lineWidth=1.5,Ue.strokeStyle="white",Ue.textBaseline="top",Ue.font="bold 36px Open Sans, sans-serif",Ue.fillText(je,5,5),Ue.strokeText(je,5,5),Ce.debugOverlayTexture.update(pe),Ce.debugOverlayTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE)}(k,`${Se} ${le}kB`),A.draw(x,b.TRIANGLES,M,L,mi.alphaBlended,Tn.disabled,Zl(S,o.aM.transparent,xe),null,H,k.debugBuffer,k.quadTriangleIndexBuffer,k.debugSegments),A.draw(x,b.LINE_STRIP,M,L,V,Tn.disabled,Zl(S,o.aM.red),G,H,k.debugBuffer,k.tileBorderIndexBuffer,k.debugSegments)}function o_(k,l,p){const x=k.context,b=x.gl,S=k.colorModeForRenderPass(),A=new qr(b.LEQUAL,qr.ReadWrite,k.depthRangeFor3D),M=k.useProgram("terrain"),L=l.getTerrainMesh();x.bindFramebuffer.set(null),x.viewport.set([0,0,k.width,k.height]);for(const V of p){const H=k.renderToTexture.getTexture(V),G=l.getTerrainData(V.tileID);x.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,H.texture);const ie=k.transform.calculatePosMatrix(V.tileID.toUnwrapped()),le=l.getMeshFrameDelta(k.transform.zoom),he=k.transform.calculateFogMatrix(V.tileID.toUnwrapped()),xe=Pf(ie,le,he,k.style.sky,k.transform.pitch);M.draw(x,b.TRIANGLES,A,$n.disabled,S,Tn.backCCW,xe,G,"terrain",L.vertexBuffer,L.indexBuffer,L.segments)}}class Lm{constructor(l,p,x){this.vertexBuffer=l,this.indexBuffer=p,this.segments=x}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class Fm{constructor(l,p){this.context=new DC(l),this.transform=p,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=tr.maxUnderzooming+tr.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Of}resize(l,p,x){if(this.width=Math.floor(l*x),this.height=Math.floor(p*x),this.pixelRatio=x,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const b of this.style._order)this.style._layers[b].resize()}setup(){const l=this.context,p=new o.aX;p.emplaceBack(0,0),p.emplaceBack(o.X,0),p.emplaceBack(0,o.X),p.emplaceBack(o.X,o.X),this.tileExtentBuffer=l.createVertexBuffer(p,Kl.members),this.tileExtentSegments=o.a0.simpleSegment(0,0,4,2);const x=new o.aX;x.emplaceBack(0,0),x.emplaceBack(o.X,0),x.emplaceBack(0,o.X),x.emplaceBack(o.X,o.X),this.debugBuffer=l.createVertexBuffer(x,Kl.members),this.debugSegments=o.a0.simpleSegment(0,0,4,5);const b=new o.$;b.emplaceBack(0,0,0,0),b.emplaceBack(o.X,0,o.X,0),b.emplaceBack(0,o.X,0,o.X),b.emplaceBack(o.X,o.X,o.X,o.X),this.rasterBoundsBuffer=l.createVertexBuffer(b,yn.members),this.rasterBoundsSegments=o.a0.simpleSegment(0,0,4,2);const S=new o.aX;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(S,Kl.members),this.viewportSegments=o.a0.simpleSegment(0,0,4,2);const A=new o.aZ;A.emplaceBack(0),A.emplaceBack(1),A.emplaceBack(3),A.emplaceBack(2),A.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(A);const M=new o.aY;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(M);const L=this.context.gl;this.stencilClearMode=new $n({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO)}clearStencil(){const l=this.context,p=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const x=o.H();o.aP(x,0,this.width,this.height,0,0,1),o.K(x,x,[p.drawingBufferWidth,p.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,p.TRIANGLES,qr.disabled,this.stencilClearMode,mi.disabled,Tn.disabled,Gi(x),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,p){if(this.currentStencilSource===l.source||!l.isTileClipped()||!p||!p.length)return;this.currentStencilSource=l.source;const x=this.context,b=x.gl;this.nextStencilID+p.length>256&&this.clearStencil(),x.setColorMode(mi.disabled),x.setDepthMode(qr.disabled);const S=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const A of p){const M=this._tileClippingMaskIDs[A.key]=this.nextStencilID++,L=this.style.map.terrain&&this.style.map.terrain.getTerrainData(A);S.draw(x,b.TRIANGLES,qr.disabled,new $n({func:b.ALWAYS,mask:0},M,255,b.KEEP,b.KEEP,b.REPLACE),mi.disabled,Tn.disabled,Gi(A.posMatrix),L,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,p=this.context.gl;return new $n({func:p.NOTEQUAL,mask:255},l,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(l){const p=this.context.gl;return new $n({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,p.KEEP,p.KEEP,p.REPLACE)}stencilConfigForOverlap(l){const p=this.context.gl,x=l.sort((A,M)=>M.overscaledZ-A.overscaledZ),b=x[x.length-1].overscaledZ,S=x[0].overscaledZ-b+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const A={};for(let M=0;M<S;M++)A[M+b]=new $n({func:p.GEQUAL,mask:255},M+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=S,[A,x]}return[{[b]:$n.disabled},x]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new mi([l.CONSTANT_COLOR,l.ONE],new o.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?mi.unblended:mi.alphaBlended}depthModeForSublayer(l,p,x){if(!this.opaquePassEnabledForLayer())return qr.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new qr(x||this.context.gl.LEQUAL,p,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,p){this.style=l,this.options=p,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(v.now()),this.imageManager.beginFrame();const x=this.style._order,b=this.style.sourceCaches,S={},A={},M={};for(const L in b){const V=b[L];V.used&&V.prepare(this.context),S[L]=V.getVisibleCoordinates(),A[L]=S[L].slice().reverse(),M[L]=V.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let L=0;L<x.length;L++)if(this.style._layers[x[L]].is3D()){this.opaquePassCutoff=L;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const L of x){const V=this.style._layers[L];if(!V.hasOffscreenPass()||V.isHidden(this.transform.zoom))continue;const H=A[V.source];(V.type==="custom"||H.length)&&this.renderLayer(this,b[V.source],V,H)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?o.aM.black:o.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(L,V){const H=L.context,G=H.gl,ie=((Ce,je,pe)=>({u_sky_color:Ce.properties.get("sky-color"),u_horizon_color:Ce.properties.get("horizon-color"),u_horizon:(je.height/2+je.getHorizon())*pe,u_sky_horizon_blend:Ce.properties.get("sky-horizon-blend")*je.height/2*pe}))(V,L.style.map.transform,L.pixelRatio),le=new qr(G.LEQUAL,qr.ReadWrite,[0,1]),he=$n.disabled,xe=L.colorModeForRenderPass(),Se=L.useProgram("sky");if(!V.mesh){const Ce=new o.aX;Ce.emplaceBack(-1,-1),Ce.emplaceBack(1,-1),Ce.emplaceBack(1,1),Ce.emplaceBack(-1,1);const je=new o.aY;je.emplaceBack(0,1,2),je.emplaceBack(0,2,3),V.mesh=new Lm(H.createVertexBuffer(Ce,Kl.members),H.createIndexBuffer(je),o.a0.simpleSegment(0,0,Ce.length,je.length))}Se.draw(H,G.TRIANGLES,le,he,xe,Tn.disabled,ie,void 0,"sky",V.mesh.vertexBuffer,V.mesh.indexBuffer,V.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const L=this.style._layers[x[this.currentLayer]],V=b[L.source],H=S[L.source];this._renderTileClippingMasks(L,H),this.renderLayer(this,V,L,H)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const L=this.style._layers[x[this.currentLayer]],V=b[L.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(L))continue;const H=(L.type==="symbol"?M:A)[L.source];this._renderTileClippingMasks(L,S[L.source]),this.renderLayer(this,V,L,H)}if(this.options.showTileBoundaries){const L=function(V,H){let G=null;const ie=Object.values(V._layers).flatMap(Se=>Se.source&&!Se.isHidden(H)?[V.sourceCaches[Se.source]]:[]),le=ie.filter(Se=>Se.getSource().type==="vector"),he=ie.filter(Se=>Se.getSource().type!=="vector"),xe=Se=>{(!G||G.getSource().maxzoom<Se.getSource().maxzoom)&&(G=Se)};return le.forEach(Se=>xe(Se)),G||he.forEach(Se=>xe(Se)),G}(this.style,this.transform.zoom);L&&function(V,H,G){for(let ie=0;ie<G.length;ie++)s_(V,H,G[ie])}(this,L,L.getVisibleCoordinates())}this.options.showPadding&&function(L){const V=L.transform.padding;Bh(L,L.transform.height-(V.top||0),3,W0),Bh(L,V.bottom||0,3,cn),i_(L,V.left||0,3,Rm),i_(L,L.transform.width-(V.right||0),3,LC);const H=L.transform.centerPoint;(function(G,ie,le,he){Dm(G,ie-1,le-10,2,20,he),Dm(G,ie-10,le-1,20,2,he)})(L,H.x,L.transform.height-H.y,n_)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(l){if(!this.style||!this.style.map||!this.style.map.terrain)return;const p=this.terrainFacilitator.matrix,x=this.transform.modelViewProjectionMatrix;let b=this.terrainFacilitator.dirty;b||(b=l?!o.a_(p,x):!o.a$(p,x)),b||(b=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),b&&(o.b0(p,x),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(S,A){const M=S.context,L=M.gl,V=mi.unblended,H=new qr(L.LEQUAL,qr.ReadWrite,[0,1]),G=A.getTerrainMesh(),ie=A.sourceCache.getRenderableTiles(),le=S.useProgram("terrainDepth");M.bindFramebuffer.set(A.getFramebuffer("depth").framebuffer),M.viewport.set([0,0,S.width/devicePixelRatio,S.height/devicePixelRatio]),M.clear({color:o.aM.transparent,depth:1});for(const he of ie){const xe=A.getTerrainData(he.tileID),Se={u_matrix:S.transform.calculatePosMatrix(he.tileID.toUnwrapped()),u_ele_delta:A.getMeshFrameDelta(S.transform.zoom)};le.draw(M,L.TRIANGLES,H,$n.disabled,V,Tn.backCCW,Se,xe,"terrain",G.vertexBuffer,G.indexBuffer,G.segments)}M.bindFramebuffer.set(null),M.viewport.set([0,0,S.width,S.height])}(this,this.style.map.terrain),function(S,A){const M=S.context,L=M.gl,V=mi.unblended,H=new qr(L.LEQUAL,qr.ReadWrite,[0,1]),G=A.getTerrainMesh(),ie=A.getCoordsTexture(),le=A.sourceCache.getRenderableTiles(),he=S.useProgram("terrainCoords");M.bindFramebuffer.set(A.getFramebuffer("coords").framebuffer),M.viewport.set([0,0,S.width/devicePixelRatio,S.height/devicePixelRatio]),M.clear({color:o.aM.transparent,depth:1}),A.coordsIndex=[];for(const xe of le){const Se=A.getTerrainData(xe.tileID);M.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,ie.texture);const Ce={u_matrix:S.transform.calculatePosMatrix(xe.tileID.toUnwrapped()),u_terrain_coords_id:(255-A.coordsIndex.length)/255,u_texture:0,u_ele_delta:A.getMeshFrameDelta(S.transform.zoom)};he.draw(M,L.TRIANGLES,H,$n.disabled,V,Tn.backCCW,Ce,Se,"terrain",G.vertexBuffer,G.indexBuffer,G.segments),A.coordsIndex.push(xe.tileID.key)}M.bindFramebuffer.set(null),M.viewport.set([0,0,S.width,S.height])}(this,this.style.map.terrain))}renderLayer(l,p,x,b){if(!x.isHidden(this.transform.zoom)&&(x.type==="background"||x.type==="custom"||(b||[]).length))switch(this.id=x.id,x.type){case"symbol":(function(S,A,M,L,V){if(S.renderPass!=="translucent")return;const H=$n.disabled,G=S.colorModeForRenderPass();(M._unevaluatedLayout.hasValue("text-variable-anchor")||M._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ie,le,he,xe,Se,Ce,je,pe,Fe){const Ue=le.transform,Je=Xl(),ft=Se==="map",kt=Ce==="map";for(const Lt of ie){const qt=xe.getTile(Lt),zt=qt.getBucket(he);if(!zt||!zt.text||!zt.text.segments.get().length)continue;const At=o.ag(zt.textSizeData,Ue.zoom),ar=Fr(qt,1,le.transform.zoom),Pr=Li(Lt.posMatrix,kt,ft,le.transform,ar),It=he.layout.get("icon-text-fit")!=="none"&&zt.hasIconData();if(At){const Nt=Math.pow(2,Ue.zoom-qt.tileID.overscaledZ),Tr=le.style.map.terrain?($r,Gr)=>le.style.map.terrain.getElevation(Lt,$r,Gr):null,Qn=Je.translatePosition(Ue,qt,je,pe);Rh(zt,ft,kt,Fe,Ue,Pr,Lt.posMatrix,Nt,At,It,Je,Qn,Lt.toUnwrapped(),Tr)}}}(L,S,M,A,M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),V),M.paint.get("icon-opacity").constantOr(1)!==0&&$0(S,A,M,L,!1,M.paint.get("icon-translate"),M.paint.get("icon-translate-anchor"),M.layout.get("icon-rotation-alignment"),M.layout.get("icon-pitch-alignment"),M.layout.get("icon-keep-upright"),H,G),M.paint.get("text-opacity").constantOr(1)!==0&&$0(S,A,M,L,!0,M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.layout.get("text-keep-upright"),H,G),A.map.showCollisionBoxes&&(If(S,A,M,L,!0),If(S,A,M,L,!1))})(l,p,x,b,this.style.placement.variableOffsets);break;case"circle":(function(S,A,M,L){if(S.renderPass!=="translucent")return;const V=M.paint.get("circle-opacity"),H=M.paint.get("circle-stroke-width"),G=M.paint.get("circle-stroke-opacity"),ie=!M.layout.get("circle-sort-key").isConstant();if(V.constantOr(1)===0&&(H.constantOr(1)===0||G.constantOr(1)===0))return;const le=S.context,he=le.gl,xe=S.depthModeForSublayer(0,qr.ReadOnly),Se=$n.disabled,Ce=S.colorModeForRenderPass(),je=[];for(let pe=0;pe<L.length;pe++){const Fe=L[pe],Ue=A.getTile(Fe),Je=Ue.getBucket(M);if(!Je)continue;const ft=Je.programConfigurations.get(M.id),kt=S.useProgram("circle",ft),Lt=Je.layoutVertexBuffer,qt=Je.indexBuffer,zt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Fe),At={programConfiguration:ft,program:kt,layoutVertexBuffer:Lt,indexBuffer:qt,uniformValues:Mh(S,Fe,Ue,M),terrainData:zt};if(ie){const ar=Je.segments.get();for(const Pr of ar)je.push({segments:new o.a0([Pr]),sortKey:Pr.sortKey,state:At})}else je.push({segments:Je.segments,sortKey:0,state:At})}ie&&je.sort((pe,Fe)=>pe.sortKey-Fe.sortKey);for(const pe of je){const{programConfiguration:Fe,program:Ue,layoutVertexBuffer:Je,indexBuffer:ft,uniformValues:kt,terrainData:Lt}=pe.state;Ue.draw(le,he.TRIANGLES,xe,Se,Ce,Tn.disabled,kt,Lt,M.id,Je,ft,pe.segments,M.paint,S.transform.zoom,Fe)}})(l,p,x,b);break;case"heatmap":(function(S,A,M,L){if(M.paint.get("heatmap-opacity")===0)return;const V=S.context;if(S.style.map.terrain){for(const H of L){const G=A.getTile(H);A.hasRenderableParent(H)||(S.renderPass==="offscreen"?V0(S,G,M,H):S.renderPass==="translucent"&&Ru(S,M,H))}V.viewport.set([0,0,S.width,S.height])}else S.renderPass==="offscreen"?function(H,G,ie,le){const he=H.context,xe=he.gl,Se=$n.disabled,Ce=new mi([xe.ONE,xe.ONE],o.aM.transparent,[!0,!0,!0,!0]);(function(je,pe,Fe){const Ue=je.gl;je.activeTexture.set(Ue.TEXTURE1),je.viewport.set([0,0,pe.width/4,pe.height/4]);let Je=Fe.heatmapFbos.get(o.aU);Je?(Ue.bindTexture(Ue.TEXTURE_2D,Je.colorAttachment.get()),je.bindFramebuffer.set(Je.framebuffer)):(Je=Df(je,pe.width/4,pe.height/4),Fe.heatmapFbos.set(o.aU,Je))})(he,H,ie),he.clear({color:o.aM.transparent});for(let je=0;je<le.length;je++){const pe=le[je];if(G.hasRenderableParent(pe))continue;const Fe=G.getTile(pe),Ue=Fe.getBucket(ie);if(!Ue)continue;const Je=Ue.programConfigurations.get(ie.id),ft=H.useProgram("heatmap",Je),{zoom:kt}=H.transform;ft.draw(he,xe.TRIANGLES,qr.disabled,Se,Ce,Tn.disabled,Os(pe.posMatrix,Fe,kt,ie.paint.get("heatmap-intensity")),null,ie.id,Ue.layoutVertexBuffer,Ue.indexBuffer,Ue.segments,ie.paint,H.transform.zoom,Je)}he.viewport.set([0,0,H.width,H.height])}(S,A,M,L):S.renderPass==="translucent"&&function(H,G){const ie=H.context,le=ie.gl;ie.setColorMode(H.colorModeForRenderPass());const he=G.heatmapFbos.get(o.aU);he&&(ie.activeTexture.set(le.TEXTURE0),le.bindTexture(le.TEXTURE_2D,he.colorAttachment.get()),ie.activeTexture.set(le.TEXTURE1),Lf(ie,G).bind(le.LINEAR,le.CLAMP_TO_EDGE),H.useProgram("heatmapTexture").draw(ie,le.TRIANGLES,qr.disabled,$n.disabled,H.colorModeForRenderPass(),Tn.disabled,Pu(H,G,0,1),null,G.id,H.viewportBuffer,H.quadTriangleIndexBuffer,H.viewportSegments,G.paint,H.transform.zoom))}(S,M)})(l,p,x,b);break;case"line":(function(S,A,M,L){if(S.renderPass!=="translucent")return;const V=M.paint.get("line-opacity"),H=M.paint.get("line-width");if(V.constantOr(1)===0||H.constantOr(1)===0)return;const G=S.depthModeForSublayer(0,qr.ReadOnly),ie=S.colorModeForRenderPass(),le=M.paint.get("line-dasharray"),he=M.paint.get("line-pattern"),xe=he.constantOr(1),Se=M.paint.get("line-gradient"),Ce=M.getCrossfadeParameters(),je=xe?"linePattern":le?"lineSDF":Se?"lineGradient":"line",pe=S.context,Fe=pe.gl;let Ue=!0;for(const Je of L){const ft=A.getTile(Je);if(xe&&!ft.patternsLoaded())continue;const kt=ft.getBucket(M);if(!kt)continue;const Lt=kt.programConfigurations.get(M.id),qt=S.context.program.get(),zt=S.useProgram(je,Lt),At=Ue||zt.program!==qt,ar=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Je),Pr=he.constantOr(null);if(Pr&&ft.imageAtlas){const Tr=ft.imageAtlas,Qn=Tr.patternPositions[Pr.to.toString()],$r=Tr.patternPositions[Pr.from.toString()];Qn&&$r&&Lt.setConstantPatternPositions(Qn,$r)}const It=ar?Je:null,Nt=xe?ea(S,ft,M,Ce,It):le?A0(S,ft,M,le,Ce,It):Se?hl(S,ft,M,kt.lineClipsArray.length,It):Au(S,ft,M,It);if(xe)pe.activeTexture.set(Fe.TEXTURE0),ft.imageAtlasTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE),Lt.updatePaintBuffers(Ce);else if(le&&(At||S.lineAtlas.dirty))pe.activeTexture.set(Fe.TEXTURE0),S.lineAtlas.bind(pe);else if(Se){const Tr=kt.gradients[M.id];let Qn=Tr.texture;if(M.gradientVersion!==Tr.version){let $r=256;if(M.stepInterpolant){const Gr=A.getSource().maxzoom,Hn=Je.canonical.z===Gr?Math.ceil(1<<S.transform.maxZoom-Je.canonical.z):1;$r=o.ac(o.aV(kt.maxLineLength/o.X*1024*Hn),256,pe.maxTextureSize)}Tr.gradient=o.aW({expression:M.gradientExpression(),evaluationKey:"lineProgress",resolution:$r,image:Tr.gradient||void 0,clips:kt.lineClipsArray}),Tr.texture?Tr.texture.update(Tr.gradient):Tr.texture=new ce(pe,Tr.gradient,Fe.RGBA),Tr.version=M.gradientVersion,Qn=Tr.texture}pe.activeTexture.set(Fe.TEXTURE0),Qn.bind(M.stepInterpolant?Fe.NEAREST:Fe.LINEAR,Fe.CLAMP_TO_EDGE)}zt.draw(pe,Fe.TRIANGLES,G,S.stencilModeForClipping(Je),ie,Tn.disabled,Nt,ar,M.id,kt.layoutVertexBuffer,kt.indexBuffer,kt.segments,M.paint,S.transform.zoom,Lt,kt.layoutVertexBuffer2),Ue=!1}})(l,p,x,b);break;case"fill":(function(S,A,M,L){const V=M.paint.get("fill-color"),H=M.paint.get("fill-opacity");if(H.constantOr(1)===0)return;const G=S.colorModeForRenderPass(),ie=M.paint.get("fill-pattern"),le=S.opaquePassEnabledForLayer()&&!ie.constantOr(1)&&V.constantOr(o.aM.transparent).a===1&&H.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===le){const he=S.depthModeForSublayer(1,S.renderPass==="opaque"?qr.ReadWrite:qr.ReadOnly);Ff(S,A,M,L,he,G,!1)}if(S.renderPass==="translucent"&&M.paint.get("fill-antialias")){const he=S.depthModeForSublayer(M.getPaintProperty("fill-outline-color")?2:0,qr.ReadOnly);Ff(S,A,M,L,he,G,!0)}})(l,p,x,b);break;case"fill-extrusion":(function(S,A,M,L){const V=M.paint.get("fill-extrusion-opacity");if(V!==0&&S.renderPass==="translucent"){const H=new qr(S.context.gl.LEQUAL,qr.ReadWrite,S.depthRangeFor3D);if(V!==1||M.paint.get("fill-extrusion-pattern").constantOr(1))Im(S,A,M,L,H,$n.disabled,mi.disabled),Im(S,A,M,L,H,S.stencilModeFor3D(),S.colorModeForRenderPass());else{const G=S.colorModeForRenderPass();Im(S,A,M,L,H,$n.disabled,G)}}})(l,p,x,b);break;case"hillshade":(function(S,A,M,L){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const V=S.context,H=S.depthModeForSublayer(0,qr.ReadOnly),G=S.colorModeForRenderPass(),[ie,le]=S.renderPass==="translucent"?S.stencilConfigForOverlap(L):[{},L];for(const he of le){const xe=A.getTile(he);xe.needsHillshadePrepare!==void 0&&xe.needsHillshadePrepare&&S.renderPass==="offscreen"?Fh(S,xe,M,H,$n.disabled,G):S.renderPass==="translucent"&&Lh(S,he,xe,M,H,ie[he.overscaledZ],G)}V.viewport.set([0,0,S.width,S.height])})(l,p,x,b);break;case"raster":(function(S,A,M,L){if(S.renderPass!=="translucent"||M.paint.get("raster-opacity")===0||!L.length)return;const V=S.context,H=V.gl,G=A.getSource(),ie=S.useProgram("raster"),le=S.colorModeForRenderPass(),[he,xe]=G instanceof an?[{},L]:S.stencilConfigForOverlap(L),Se=xe[xe.length-1].overscaledZ,Ce=!S.options.moving;for(const je of xe){const pe=S.depthModeForSublayer(je.overscaledZ-Se,M.paint.get("raster-opacity")===1?qr.ReadWrite:qr.ReadOnly,H.LESS),Fe=A.getTile(je);Fe.registerFadeDuration(M.paint.get("raster-fade-duration"));const Ue=A.findLoadedParent(je,0),Je=A.findLoadedSibling(je),ft=r_(Fe,Ue||Je||null,A,M,S.transform,S.style.map.terrain);let kt,Lt;const qt=M.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;V.activeTexture.set(H.TEXTURE0),Fe.texture.bind(qt,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),V.activeTexture.set(H.TEXTURE1),Ue?(Ue.texture.bind(qt,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),kt=Math.pow(2,Ue.tileID.overscaledZ-Fe.tileID.overscaledZ),Lt=[Fe.tileID.canonical.x*kt%1,Fe.tileID.canonical.y*kt%1]):Fe.texture.bind(qt,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),Fe.texture.useMipmap&&V.extTextureFilterAnisotropic&&S.transform.pitch>20&&H.texParameterf(H.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax);const zt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(je),At=zt?je:null,ar=At?At.posMatrix:S.transform.calculatePosMatrix(je.toUnwrapped(),Ce),Pr=Om(ar,Lt||[0,0],kt||1,ft,M);G instanceof an?ie.draw(V,H.TRIANGLES,pe,$n.disabled,le,Tn.disabled,Pr,zt,M.id,G.boundsBuffer,S.quadTriangleIndexBuffer,G.boundsSegments):ie.draw(V,H.TRIANGLES,pe,he[je.overscaledZ],le,Tn.disabled,Pr,zt,M.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments)}})(l,p,x,b);break;case"background":(function(S,A,M,L){const V=M.paint.get("background-color"),H=M.paint.get("background-opacity");if(H===0)return;const G=S.context,ie=G.gl,le=S.transform,he=le.tileSize,xe=M.paint.get("background-pattern");if(S.isPatternMissing(xe))return;const Se=!xe&&V.a===1&&H===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==Se)return;const Ce=$n.disabled,je=S.depthModeForSublayer(0,Se==="opaque"?qr.ReadWrite:qr.ReadOnly),pe=S.colorModeForRenderPass(),Fe=S.useProgram(xe?"backgroundPattern":"background"),Ue=L||le.coveringTiles({tileSize:he,terrain:S.style.map.terrain});xe&&(G.activeTexture.set(ie.TEXTURE0),S.imageManager.bind(S.context));const Je=M.getCrossfadeParameters();for(const ft of Ue){const kt=L?ft.posMatrix:S.transform.calculatePosMatrix(ft.toUnwrapped()),Lt=xe?Ne(kt,H,S,xe,{tileID:ft,tileSize:he},Je):ye(kt,H,V),qt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(ft);Fe.draw(G,ie.TRIANGLES,je,Ce,pe,Tn.disabled,Lt,qt,M.id,S.tileExtentBuffer,S.quadTriangleIndexBuffer,S.tileExtentSegments)}})(l,0,x,b);break;case"custom":(function(S,A,M){const L=S.context,V=M.implementation;if(S.renderPass==="offscreen"){const H=V.prerender;H&&(S.setCustomLayerDefaults(),L.setColorMode(S.colorModeForRenderPass()),H.call(V,L.gl,S.transform.customLayerMatrix()),L.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),L.setColorMode(S.colorModeForRenderPass()),L.setStencilMode($n.disabled);const H=V.renderingMode==="3d"?new qr(S.context.gl.LEQUAL,qr.ReadWrite,S.depthRangeFor3D):S.depthModeForSublayer(0,qr.ReadOnly);L.setDepthMode(H),V.render(L.gl,S.transform.customLayerMatrix(),{farZ:S.transform.farZ,nearZ:S.transform.nearZ,fov:S.transform._fov,modelViewProjectionMatrix:S.transform.modelViewProjectionMatrix,projectionMatrix:S.transform.projectionMatrix}),L.setDirty(),S.setBaseState(),L.bindFramebuffer.set(null)}})(l,0,x)}}translatePosMatrix(l,p,x,b,S){if(!x[0]&&!x[1])return l;const A=S?b==="map"?this.transform.angle:0:b==="viewport"?-this.transform.angle:0;if(A){const V=Math.sin(A),H=Math.cos(A);x=[x[0]*H-x[1]*V,x[0]*V+x[1]*H]}const M=[S?x[0]:Fr(p,x[0],this.transform.zoom),S?x[1]:Fr(p,x[1],this.transform.zoom),0],L=new Float32Array(16);return o.J(L,l,M),L}saveTileTexture(l){const p=this._tileTextures[l.size[0]];p?p.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const p=this._tileTextures[l];return p&&p.length>0?p.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const p=this.imageManager.getPattern(l.from.toString()),x=this.imageManager.getPattern(l.to.toString());return!p||!x}useProgram(l,p){this.cache=this.cache||{};const x=l+(p?p.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[x]||(this.cache[x]=new Ah(this.context,cl[l],p,at[l],this._showOverdrawInspector,this.style.map.terrain)),this.cache[x]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ce(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:l,drawingBufferHeight:p}=this.context.gl;return this.width!==l||this.height!==p}}class $h{constructor(l,p){this.points=l,this.planes=p}static fromInvProjectionMatrix(l,p,x){const b=Math.pow(2,x),S=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(M=>{const L=1/(M=o.af([],M,l))[3]/p*b;return o.b1(M,M,[L,L,1/M[3],L])}),A=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(M=>{const L=function(ie,le){var he=le[0],xe=le[1],Se=le[2],Ce=he*he+xe*xe+Se*Se;return Ce>0&&(Ce=1/Math.sqrt(Ce)),ie[0]=le[0]*Ce,ie[1]=le[1]*Ce,ie[2]=le[2]*Ce,ie}([],function(ie,le,he){var xe=le[0],Se=le[1],Ce=le[2],je=he[0],pe=he[1],Fe=he[2];return ie[0]=Se*Fe-Ce*pe,ie[1]=Ce*je-xe*Fe,ie[2]=xe*pe-Se*je,ie}([],K([],S[M[0]],S[M[1]]),K([],S[M[2]],S[M[1]]))),V=-((H=L)[0]*(G=S[M[1]])[0]+H[1]*G[1]+H[2]*G[2]);var H,G;return L.concat(V)});return new $h(S,A)}}class Nh{constructor(l,p){this.min=l,this.max=p,this.center=function(x,b,S){return x[0]=.5*b[0],x[1]=.5*b[1],x[2]=.5*b[2],x}([],function(x,b,S){return x[0]=b[0]+S[0],x[1]=b[1]+S[1],x[2]=b[2]+S[2],x}([],this.min,this.max))}quadrant(l){const p=[l%2==0,l<2],x=X(this.min),b=X(this.max);for(let S=0;S<p.length;S++)x[S]=p[S]?this.min[S]:this.center[S],b[S]=p[S]?this.center[S]:this.max[S];return b[2]=this.max[2],new Nh(x,b)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersects(l){const p=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let x=!0;for(let b=0;b<l.planes.length;b++){const S=l.planes[b];let A=0;for(let M=0;M<p.length;M++)o.b2(S,p[M])>=0&&A++;if(A===0)return 0;A!==p.length&&(x=!1)}if(x)return 2;for(let b=0;b<3;b++){let S=Number.MAX_VALUE,A=-Number.MAX_VALUE;for(let M=0;M<l.points.length;M++){const L=l.points[M][b]-this.min[b];S=Math.min(S,L),A=Math.max(A,L)}if(A<0||S>this.max[b]-this.min[b])return 0}return 1}}class Vh{constructor(l=0,p=0,x=0,b=0){if(isNaN(l)||l<0||isNaN(p)||p<0||isNaN(x)||x<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=p,this.left=x,this.right=b}interpolate(l,p,x){return p.top!=null&&l.top!=null&&(this.top=o.y.number(l.top,p.top,x)),p.bottom!=null&&l.bottom!=null&&(this.bottom=o.y.number(l.bottom,p.bottom,x)),p.left!=null&&l.left!=null&&(this.left=o.y.number(l.left,p.left,x)),p.right!=null&&l.right!=null&&(this.right=o.y.number(l.right,p.right,x)),this}getCenter(l,p){const x=o.ac((this.left+l-this.right)/2,0,l),b=o.ac((this.top+p-this.bottom)/2,0,p);return new o.P(x,b)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Vh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const U0=85.051129;class Wh{constructor(l,p,x,b,S){this.tileSize=512,this._renderWorldCopies=S===void 0||!!S,this._minZoom=l||0,this._maxZoom=p||22,this._minPitch=x??0,this._maxPitch=b??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Vh,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const l=new Wh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.apply(this),l}apply(l){this.tileSize=l.tileSize,this.latRange=l.latRange,this.lngRange=l.lngRange,this.width=l.width,this.height=l.height,this._center=l._center,this._elevation=l._elevation,this.minElevationForCurrentTile=l.minElevationForCurrentTile,this.zoom=l.zoom,this.angle=l.angle,this._fov=l._fov,this._pitch=l._pitch,this._unmodified=l._unmodified,this._edgeInsets=l._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(l){const p=-o.b3(l,-180,180)*Math.PI/180;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=function(){var x=new o.A(4);return o.A!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x}(),function(x,b,S){var A=b[0],M=b[1],L=b[2],V=b[3],H=Math.sin(S),G=Math.cos(S);x[0]=A*G+L*H,x[1]=M*G+V*H,x[2]=A*-H+L*G,x[3]=M*-H+V*G}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const p=o.ac(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(l){const p=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this.tileZoom=Math.max(0,Math.floor(p)),this.scale=this.zoomScale(p),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,p,x){this._unmodified=!1,this._edgeInsets.interpolate(l,p,x),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const p=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,p)}getVisibleUnwrappedCoordinates(l){const p=[new o.b4(0,l)];if(this._renderWorldCopies){const x=this.pointCoordinate(new o.P(0,0)),b=this.pointCoordinate(new o.P(this.width,0)),S=this.pointCoordinate(new o.P(this.width,this.height)),A=this.pointCoordinate(new o.P(0,this.height)),M=Math.floor(Math.min(x.x,b.x,S.x,A.x)),L=Math.floor(Math.max(x.x,b.x,S.x,A.x)),V=1;for(let H=M-V;H<=L+V;H++)H!==0&&p.push(new o.b4(H,l))}return p}coveringTiles(l){var p,x;let b=this.coveringZoomLevel(l);const S=b;if(l.minzoom!==void 0&&b<l.minzoom)return[];l.maxzoom!==void 0&&b>l.maxzoom&&(b=l.maxzoom);const A=this.pointCoordinate(this.getCameraPoint()),M=o.Z.fromLngLat(this.center),L=Math.pow(2,b),V=[L*A.x,L*A.y,0],H=[L*M.x,L*M.y,0],G=$h.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,b);let ie=l.minzoom||0;!l.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ie=b);const le=l.terrain?2/Math.min(this.tileSize,l.tileSize)*this.tileSize:3,he=pe=>({aabb:new Nh([pe*L,0,0],[(pe+1)*L,L,0]),zoom:0,x:0,y:0,wrap:pe,fullyVisible:!1}),xe=[],Se=[],Ce=b,je=l.reparseOverscaled?S:b;if(this._renderWorldCopies)for(let pe=1;pe<=3;pe++)xe.push(he(-pe)),xe.push(he(pe));for(xe.push(he(0));xe.length>0;){const pe=xe.pop(),Fe=pe.x,Ue=pe.y;let Je=pe.fullyVisible;if(!Je){const zt=pe.aabb.intersects(G);if(zt===0)continue;Je=zt===2}const ft=l.terrain?V:H,kt=pe.aabb.distanceX(ft),Lt=pe.aabb.distanceY(ft),qt=Math.max(Math.abs(kt),Math.abs(Lt));if(pe.zoom===Ce||qt>le+(1<<Ce-pe.zoom)-2&&pe.zoom>=ie){const zt=Ce-pe.zoom,At=V[0]-.5-(Fe<<zt),ar=V[1]-.5-(Ue<<zt);Se.push({tileID:new o.S(pe.zoom===Ce?je:pe.zoom,pe.wrap,pe.zoom,Fe,Ue),distanceSq:Y([H[0]-.5-Fe,H[1]-.5-Ue]),tileDistanceToCamera:Math.sqrt(At*At+ar*ar)})}else for(let zt=0;zt<4;zt++){const At=(Fe<<1)+zt%2,ar=(Ue<<1)+(zt>>1),Pr=pe.zoom+1;let It=pe.aabb.quadrant(zt);if(l.terrain){const Nt=new o.S(Pr,pe.wrap,Pr,At,ar),Tr=l.terrain.getMinMaxElevation(Nt),Qn=(p=Tr.minElevation)!==null&&p!==void 0?p:this.elevation,$r=(x=Tr.maxElevation)!==null&&x!==void 0?x:this.elevation;It=new Nh([It.min[0],It.min[1],Qn],[It.max[0],It.max[1],$r])}xe.push({aabb:It,zoom:Pr,x:At,y:ar,wrap:pe.wrap,fullyVisible:Je})}}return Se.sort((pe,Fe)=>pe.distanceSq-Fe.distanceSq).map(pe=>pe.tileID)}resize(l,p){this.width=l,this.height=p,this.pixelsToGLUnits=[2/l,-2/p],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const p=o.ac(l.lat,-85.051129,U0);return new o.P(o.O(l.lng)*this.worldSize,o.Q(p)*this.worldSize)}unproject(l){return new o.Z(l.x/this.worldSize,l.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(l){const p=this.elevation,x=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,b=this.pointLocation(this.centerPoint,l),S=l.getElevationForLngLatZoom(b,this.tileZoom);if(!(this.elevation-S))return;const A=x+p-S,M=Math.cos(this._pitch)*this.cameraToCenterDistance/A/o.b5(1,b.lat),L=this.scaleZoom(M/this.tileSize);this._elevation=S,this._center=b,this.zoom=L}setLocationAtPoint(l,p){const x=this.pointCoordinate(p),b=this.pointCoordinate(this.centerPoint),S=this.locationCoordinate(l),A=new o.Z(S.x-(x.x-b.x),S.y-(x.y-b.y));this.center=this.coordinateLocation(A),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(l,p){return p?this.coordinatePoint(this.locationCoordinate(l),p.getElevationForLngLatZoom(l,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(l))}pointLocation(l,p){return this.coordinateLocation(this.pointCoordinate(l,p))}locationCoordinate(l){return o.Z.fromLngLat(l)}coordinateLocation(l){return l&&l.toLngLat()}pointCoordinate(l,p){if(p){const ie=p.pointCoordinate(l);if(ie!=null)return ie}const x=[l.x,l.y,0,1],b=[l.x,l.y,1,1];o.af(x,x,this.pixelMatrixInverse),o.af(b,b,this.pixelMatrixInverse);const S=x[3],A=b[3],M=x[1]/S,L=b[1]/A,V=x[2]/S,H=b[2]/A,G=V===H?0:(0-V)/(H-V);return new o.Z(o.y.number(x[0]/S,b[0]/A,G)/this.worldSize,o.y.number(M,L,G)/this.worldSize)}coordinatePoint(l,p=0,x=this.pixelMatrix){const b=[l.x*this.worldSize,l.y*this.worldSize,p,1];return o.af(b,b,x),new o.P(b[0]/b[3],b[1]/b[3])}getBounds(){const l=Math.max(0,this.height/2-this.getHorizon());return new Te().extend(this.pointLocation(new o.P(0,l))).extend(this.pointLocation(new o.P(this.width,l))).extend(this.pointLocation(new o.P(this.width,this.height))).extend(this.pointLocation(new o.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Te([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,U0])}calculateTileMatrix(l){const p=l.canonical,x=this.worldSize/this.zoomScale(p.z),b=p.x+Math.pow(2,p.z)*l.wrap,S=o.an(new Float64Array(16));return o.J(S,S,[b*x,p.y*x,0]),o.K(S,S,[x/o.X,x/o.X,1]),S}calculatePosMatrix(l,p=!1){const x=l.key,b=p?this._alignedPosMatrixCache:this._posMatrixCache;if(b[x])return b[x];const S=this.calculateTileMatrix(l);return o.L(S,p?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,S),b[x]=new Float32Array(S),b[x]}calculateFogMatrix(l){const p=l.key,x=this._fogMatrixCache;if(x[p])return x[p];const b=this.calculateTileMatrix(l);return o.L(b,this.fogMatrix,b),x[p]=new Float32Array(b),x[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(l,p){p=o.ac(+p,this.minZoom,this.maxZoom);const x={center:new o.N(l.lng,l.lat),zoom:p};let b=this.lngRange;if(!this._renderWorldCopies&&b===null){const pe=179.9999999999;b=[-pe,pe]}const S=this.tileSize*this.zoomScale(x.zoom);let A=0,M=S,L=0,V=S,H=0,G=0;const{x:ie,y:le}=this.size;if(this.latRange){const pe=this.latRange;A=o.Q(pe[1])*S,M=o.Q(pe[0])*S,M-A<le&&(H=le/(M-A))}b&&(L=o.b3(o.O(b[0])*S,0,S),V=o.b3(o.O(b[1])*S,0,S),V<L&&(V+=S),V-L<ie&&(G=ie/(V-L)));const{x:he,y:xe}=this.project.call({worldSize:S},l);let Se,Ce;const je=Math.max(G||0,H||0);if(je){const pe=new o.P(G?(V+L)/2:he,H?(M+A)/2:xe);return x.center=this.unproject.call({worldSize:S},pe).wrap(),x.zoom+=this.scaleZoom(je),x}if(this.latRange){const pe=le/2;xe-pe<A&&(Ce=A+pe),xe+pe>M&&(Ce=M-pe)}if(b){const pe=(L+V)/2;let Fe=he;this._renderWorldCopies&&(Fe=o.b3(he,pe-S/2,pe+S/2));const Ue=ie/2;Fe-Ue<L&&(Se=L+Ue),Fe+Ue>V&&(Se=V-Ue)}if(Se!==void 0||Ce!==void 0){const pe=new o.P(Se??he,Ce??xe);x.center=this.unproject.call({worldSize:S},pe).wrap()}return x}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l=this._unmodified,{center:p,zoom:x}=this.getConstrained(this.center,this.zoom);this.center=p,this.zoom=x,this._unmodified=l,this._constraining=!1}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,p=this.point.x,x=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.b5(1,this.center.lat)*this.worldSize;let b=o.an(new Float64Array(16));o.K(b,b,[this.width/2,-this.height/2,1]),o.J(b,b,[1,-1,0]),this.labelPlaneMatrix=b,b=o.an(new Float64Array(16)),o.K(b,b,[1,-1,1]),o.J(b,b,[-1,-1,0]),o.K(b,b,[2/this.width,2/this.height,1]),this.glCoordMatrix=b;const S=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),A=Math.min(this.elevation,this.minElevationForCurrentTile),M=S-A*this._pixelPerMeter/Math.cos(this._pitch),L=A<0?M:S,V=Math.PI/2+this._pitch,H=this._fov*(.5+l.y/this.height),G=Math.sin(H)*L/Math.sin(o.ac(Math.PI-V-H,.01,Math.PI-.01)),ie=this.getHorizon(),le=2*Math.atan(ie/this.cameraToCenterDistance)*(.5+l.y/(2*ie)),he=Math.sin(le)*L/Math.sin(o.ac(Math.PI-V-le,.01,Math.PI-.01)),xe=Math.min(G,he);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*xe+L),this.nearZ=this.height/50,b=new Float64Array(16),o.b6(b,this._fov,this.width/this.height,this.nearZ,this.farZ),b[8]=2*-l.x/this.width,b[9]=2*l.y/this.height,this.projectionMatrix=o.ae(b),o.K(b,b,[1,-1,1]),o.J(b,b,[0,0,-this.cameraToCenterDistance]),o.b7(b,b,this._pitch),o.ad(b,b,this.angle),o.J(b,b,[-p,-x,0]),this.mercatorMatrix=o.K([],b,[this.worldSize,this.worldSize,this.worldSize]),o.K(b,b,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.L(new Float64Array(16),this.labelPlaneMatrix,b),o.J(b,b,[0,0,-this.elevation]),this.modelViewProjectionMatrix=b,this.invModelViewProjectionMatrix=o.as([],b),this.fogMatrix=new Float64Array(16),o.b6(this.fogMatrix,this._fov,this.width/this.height,S,this.farZ),this.fogMatrix[8]=2*-l.x/this.width,this.fogMatrix[9]=2*l.y/this.height,o.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),o.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),o.b7(this.fogMatrix,this.fogMatrix,this._pitch),o.ad(this.fogMatrix,this.fogMatrix,this.angle),o.J(this.fogMatrix,this.fogMatrix,[-p,-x,0]),o.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),o.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=o.L(new Float64Array(16),this.labelPlaneMatrix,b);const Se=this.width%2/2,Ce=this.height%2/2,je=Math.cos(this.angle),pe=Math.sin(this.angle),Fe=p-Math.round(p)+je*Se+pe*Ce,Ue=x-Math.round(x)+je*Ce+pe*Se,Je=new Float64Array(b);if(o.J(Je,Je,[Fe>.5?Fe-1:Fe,Ue>.5?Ue-1:Ue,0]),this.alignedModelViewProjectionMatrix=Je,b=o.as(new Float64Array(16),this.pixelMatrix),!b)throw new Error("failed to invert matrix");this.pixelMatrixInverse=b,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const l=this.pointCoordinate(new o.P(0,0)),p=[l.x*this.worldSize,l.y*this.worldSize,0,1];return o.af(p,p,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,l))}getCameraQueryGeometry(l){const p=this.getCameraPoint();if(l.length===1)return[l[0],p];{let x=p.x,b=p.y,S=p.x,A=p.y;for(const M of l)x=Math.min(x,M.x),b=Math.min(b,M.y),S=Math.max(S,M.x),A=Math.max(A,M.y);return[new o.P(x,b),new o.P(S,b),new o.P(S,A),new o.P(x,A),new o.P(x,b)]}}lngLatToCameraDepth(l,p){const x=this.locationCoordinate(l),b=[x.x*this.worldSize,x.y*this.worldSize,p,1];return o.af(b,b,this.modelViewProjectionMatrix),b[2]/b[3]}}function Bf(k,l){let p,x=!1,b=null,S=null;const A=()=>{b=null,x&&(k.apply(S,p),b=setTimeout(A,l),x=!1)};return(...M)=>(x=!0,S=this,p=M,b||A(),b)}class Bm{constructor(l){this._getCurrentHash=()=>{const p=window.location.hash.replace("#","");if(this._hashName){let x;return p.split("&").map(b=>b.split("=")).forEach(b=>{b[0]===this._hashName&&(x=b)}),(x&&x[1]||"").split("/")}return p.split("/")},this._onHashChange=()=>{const p=this._getCurrentHash();if(p.length>=3&&!p.some(x=>isNaN(x))){const x=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(p[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:x,pitch:+(p[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const p=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,p)},this._removeHash=()=>{const p=this._getCurrentHash();if(p.length===0)return;const x=p.join("/");let b=x;b.split("&").length>0&&(b=b.split("&")[0]),this._hashName&&(b=`${this._hashName}=${x}`);let S=window.location.hash.replace(b,"");S.startsWith("#&")?S=S.slice(0,1)+S.slice(2):S==="#"&&(S="");let A=window.location.href.replace(/(#.+)?$/,S);A=A.replace("&&","&"),window.history.replaceState(window.history.state,null,A)},this._updateHash=Bf(this._updateHashUnthrottled,300),this._hashName=l&&encodeURIComponent(l)}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(l){const p=this._map.getCenter(),x=Math.round(100*this._map.getZoom())/100,b=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,b),A=Math.round(p.lng*S)/S,M=Math.round(p.lat*S)/S,L=this._map.getBearing(),V=this._map.getPitch();let H="";if(H+=l?`/${A}/${M}/${x}`:`${x}/${M}/${A}`,(L||V)&&(H+="/"+Math.round(10*L)/10),V&&(H+=`/${Math.round(V)}`),this._hashName){const G=this._hashName;let ie=!1;const le=window.location.hash.slice(1).split("&").map(he=>{const xe=he.split("=")[0];return xe===G?(ie=!0,`${xe}=${H}`):he}).filter(he=>he);return ie||le.push(`${G}=${H}`),`#${le.join("&")}`}return`#${H}`}}const $m={linearity:.3,easing:o.b8(0,0,.3,1)},q0=o.e({deceleration:2500,maxSpeed:1400},$m),FC=o.e({deceleration:20,maxSpeed:1400},$m),a_=o.e({deceleration:1e3,maxSpeed:360},$m),Nm=o.e({deceleration:1e3,maxSpeed:90},$m);class Q0{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:v.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,p=v.now();for(;l.length>0&&p-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const p={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)p.zoom+=S.zoomDelta||0,p.bearing+=S.bearingDelta||0,p.pitch+=S.pitchDelta||0,S.panDelta&&p.pan._add(S.panDelta),S.around&&(p.around=S.around),S.pinchAround&&(p.pinchAround=S.pinchAround);const x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(p.pan.mag()){const S=Nf(p.pan.mag(),x,o.e({},q0,l||{}));b.offset=p.pan.mult(S.amount/p.pan.mag()),b.center=this._map.transform.center,$f(b,S)}if(p.zoom){const S=Nf(p.zoom,x,FC);b.zoom=this._map.transform.zoom+S.amount,$f(b,S)}if(p.bearing){const S=Nf(p.bearing,x,a_);b.bearing=this._map.transform.bearing+o.ac(S.amount,-179,179),$f(b,S)}if(p.pitch){const S=Nf(p.pitch,x,Nm);b.pitch=this._map.transform.pitch+S.amount,$f(b,S)}if(b.zoom||b.bearing){const S=p.pinchAround===void 0?p.around:p.pinchAround;b.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),o.e(b,{noMoveStart:!0})}}function $f(k,l){(!k.duration||k.duration<l.duration)&&(k.duration=l.duration,k.easing=l.easing)}function Nf(k,l,p){const{maxSpeed:x,linearity:b,deceleration:S}=p,A=o.ac(k*b/(l/1e3),-x,x),M=Math.abs(A)/(S*b);return{easing:p.easing,duration:1e3*M,amount:A*(M/2)}}class Ps extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,p,x,b={}){const S=w.mousePos(p.getCanvas(),x),A=p.unproject(S);super(l,o.e({point:S,lngLat:A,originalEvent:x},b)),this._defaultPrevented=!1,this.target=p}}class Du extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,p,x){const b=l==="touchend"?x.changedTouches:x.touches,S=w.touchPos(p.getCanvasContainer(),b),A=S.map(L=>p.unproject(L)),M=S.reduce((L,V,H,G)=>L.add(V.div(G.length)),new o.P(0,0));super(l,{points:S,point:M,lngLats:A,lngLat:p.unproject(M),originalEvent:x}),this._defaultPrevented=!1}}class l_ extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,p,x){super(l,{originalEvent:x}),this._defaultPrevented=!1}}class c_{constructor(l,p){this._map=l,this._clickTolerance=p.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new l_(l.type,this._map,l))}mousedown(l,p){return this._mousedownPos=p,this._firePreventable(new Ps(l.type,this._map,l))}mouseup(l){this._map.fire(new Ps(l.type,this._map,l))}click(l,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new Ps(l.type,this._map,l))}dblclick(l){return this._firePreventable(new Ps(l.type,this._map,l))}mouseover(l){this._map.fire(new Ps(l.type,this._map,l))}mouseout(l){this._map.fire(new Ps(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Du(l.type,this._map,l))}touchmove(l){this._map.fire(new Du(l.type,this._map,l))}touchend(l){this._map.fire(new Du(l.type,this._map,l))}touchcancel(l){this._map.fire(new Du(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class gi{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new Ps(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ps("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new Ps(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ra{constructor(l){this._map=l}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(l){return this.transform.pointLocation(o.P.convert(l),this._map.terrain)}}class Eo{constructor(l,p){this._map=l,this._tr=new Ra(l),this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,p){this.isEnabled()&&l.shiftKey&&l.button===0&&(w.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(l,p){if(!this._active)return;const x=p;if(this._lastPos.equals(x)||!this._box&&x.dist(this._startPos)<this._clickTolerance)return;const b=this._startPos;this._lastPos=x,this._box||(this._box=w.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",l));const S=Math.min(b.x,x.x),A=Math.max(b.x,x.x),M=Math.min(b.y,x.y),L=Math.max(b.y,x.y);w.setTransform(this._box,`translate(${S}px,${M}px)`),this._box.style.width=A-S+"px",this._box.style.height=L-M+"px"}mouseupWindow(l,p){if(!this._active||l.button!==0)return;const x=this._startPos,b=p;if(this.reset(),w.suppressClick(),x.x!==b.x||x.y!==b.y)return this._map.fire(new o.k("boxzoomend",{originalEvent:l})),{cameraAnimation:S=>S.fitScreenCoordinates(x,b,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(w.remove(this._box),this._box=null),w.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,p){return this._map.fire(new o.k(l,{originalEvent:p}))}}function Vf(k,l){if(k.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${k.length}, points ${l.length}`);const p={};for(let x=0;x<k.length;x++)p[k[x].identifier]=l[x];return p}class H0{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,p,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),x.length===this.numTouches&&(this.centroid=function(b){const S=new o.P(0,0);for(const A of b)S._add(A);return S.div(b.length)}(p),this.touches=Vf(x,p)))}touchmove(l,p,x){if(this.aborted||!this.centroid)return;const b=Vf(x,p);for(const S in this.touches){const A=b[S];(!A||A.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(l,p,x){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),x.length===0){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class Vm{constructor(l){this.singleTap=new H0(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,p,x){this.singleTap.touchstart(l,p,x)}touchmove(l,p,x){this.singleTap.touchmove(l,p,x)}touchend(l,p,x){const b=this.singleTap.touchend(l,p,x);if(b){const S=l.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(b)<30;if(S&&A||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class Uh{constructor(l){this._tr=new Ra(l),this._zoomIn=new Vm({numTouches:1,numTaps:2}),this._zoomOut=new Vm({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,p,x){this._zoomIn.touchstart(l,p,x),this._zoomOut.touchstart(l,p,x)}touchmove(l,p,x){this._zoomIn.touchmove(l,p,x),this._zoomOut.touchmove(l,p,x)}touchend(l,p,x){const b=this._zoomIn.touchend(l,p,x),S=this._zoomOut.touchend(l,p,x),A=this._tr;return b?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:A.zoom+1,around:A.unproject(b)},{originalEvent:l})}):S?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:A.zoom-1,around:A.unproject(S)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jl{constructor(l){this._enabled=!!l.enable,this._moveStateManager=l.moveStateManager,this._clickTolerance=l.clickTolerance||1,this._moveFunction=l.move,this._activateOnStart=!!l.activateOnStart,l.assignEvents(this),this.reset()}reset(l){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(l)}_move(...l){const p=this._moveFunction(...l);if(p.bearingDelta||p.pitchDelta||p.around||p.panDelta)return this._active=!0,p}dragStart(l,p){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(l)&&(this._moveStateManager.startMove(l),this._lastPoint=p.length?p[0]:p,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(l,p){if(!this.isEnabled())return;const x=this._lastPoint;if(!x)return;if(l.preventDefault(),!this._moveStateManager.isValidMoveEvent(l))return void this.reset(l);const b=p.length?p[0]:p;return!this._moved&&b.dist(x)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=b,this._move(x,b))}dragEnd(l){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(l)&&(this._moved&&w.suppressClick(),this.reset(l))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const G0={0:1,2:2};class Wm{constructor(l){this._correctEvent=l.checkCorrectEvent}startMove(l){const p=w.mouseButton(l);this._eventButton=p}endMove(l){delete this._eventButton}isValidStartEvent(l){return this._correctEvent(l)}isValidMoveEvent(l){return!function(p,x){const b=G0[x];return p.buttons===void 0||(p.buttons&b)!==b}(l,this._eventButton)}isValidEndEvent(l){return w.mouseButton(l)===this._eventButton}}class X0{constructor(){this._firstTouch=void 0}_isOneFingerTouch(l){return l.targetTouches.length===1}_isSameTouchEvent(l){return l.targetTouches[0].identifier===this._firstTouch}startMove(l){this._firstTouch=l.targetTouches[0].identifier}endMove(l){delete this._firstTouch}isValidStartEvent(l){return this._isOneFingerTouch(l)}isValidMoveEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}isValidEndEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}}const Um=k=>{k.mousedown=k.dragStart,k.mousemoveWindow=k.dragMove,k.mouseup=k.dragEnd,k.contextmenu=l=>{l.preventDefault()}},K0=({enable:k,clickTolerance:l,bearingDegreesPerPixelMoved:p=.8})=>{const x=new Wm({checkCorrectEvent:b=>w.mouseButton(b)===0&&b.ctrlKey||w.mouseButton(b)===2});return new Jl({clickTolerance:l,move:(b,S)=>({bearingDelta:(S.x-b.x)*p}),moveStateManager:x,enable:k,assignEvents:Um})},Z0=({enable:k,clickTolerance:l,pitchDegreesPerPixelMoved:p=-.5})=>{const x=new Wm({checkCorrectEvent:b=>w.mouseButton(b)===0&&b.ctrlKey||w.mouseButton(b)===2});return new Jl({clickTolerance:l,move:(b,S)=>({pitchDelta:(S.y-b.y)*p}),moveStateManager:x,enable:k,assignEvents:Um})};class Lu{constructor(l,p){this._clickTolerance=l.clickTolerance||1,this._map=p,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(l){return l<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(l,p,x){return this._calculateTransform(l,p,x)}touchmove(l,p,x){if(this._active){if(!this._shouldBePrevented(x.length))return l.preventDefault(),this._calculateTransform(l,p,x);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",l)}}touchend(l,p,x){this._calculateTransform(l,p,x),this._active&&this._shouldBePrevented(x.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,p,x){x.length>0&&(this._active=!0);const b=Vf(x,p),S=new o.P(0,0),A=new o.P(0,0);let M=0;for(const V in b){const H=b[V],G=this._touches[V];G&&(S._add(H),A._add(H.sub(G)),M++,b[V]=H)}if(this._touches=b,this._shouldBePrevented(M)||!A.mag())return;const L=A.div(M);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(M),panDelta:L}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qm{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(l,p,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([p[0],p[1]]))}touchmove(l,p,x){if(!this._firstTwoTouches)return;l.preventDefault();const[b,S]=this._firstTwoTouches,A=Wf(x,p,b),M=Wf(x,p,S);if(!A||!M)return;const L=this._aroundCenter?null:A.add(M).div(2);return this._move([A,M],L,l)}touchend(l,p,x){if(!this._firstTwoTouches)return;const[b,S]=this._firstTwoTouches,A=Wf(x,p,b),M=Wf(x,p,S);A&&M||(this._active&&w.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Wf(k,l,p){for(let x=0;x<k.length;x++)if(k[x].identifier===p)return l[x]}function Y0(k,l){return Math.log(k/l)/Math.LN2}class J0 extends qm{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,p){const x=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(Y0(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Y0(this._distance,x),pinchAround:p}}}function ex(k,l){return 180*k.angleWith(l)/Math.PI}class tx extends qm{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,p,x){const b=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ex(this._vector,b),pinchAround:p}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const p=25/(Math.PI*this._minDiameter)*360,x=ex(l,this._startVector);return Math.abs(x)<p}}function Qm(k){return Math.abs(k.y)>Math.abs(k.x)}class Uf extends qm{constructor(l){super(),this._currentTouchCount=0,this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,p,x){super.touchstart(l,p,x),this._currentTouchCount=x.length}_start(l){this._lastPoints=l,Qm(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,p,x){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const b=l[0].sub(this._lastPoints[0]),S=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(b,S,x.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(b.y+S.y)/2*-.5}):void 0}gestureBeginsVertically(l,p,x){if(this._valid!==void 0)return this._valid;const b=l.mag()>=2,S=p.mag()>=2;if(!b&&!S)return;if(!b||!S)return this._firstMove===void 0&&(this._firstMove=x),x-this._firstMove<100&&void 0;const A=l.y>0==p.y>0;return Qm(l)&&Qm(p)&&A}}const u_={panStep:100,bearingStep:15,pitchStep:10};class na{constructor(l){this._tr=new Ra(l);const p=u_;this._panStep=p.panStep,this._bearingStep=p.bearingStep,this._pitchStep=p.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let p=0,x=0,b=0,S=0,A=0;switch(l.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:l.shiftKey?x=-1:(l.preventDefault(),S=-1);break;case 39:l.shiftKey?x=1:(l.preventDefault(),S=1);break;case 38:l.shiftKey?b=1:(l.preventDefault(),A=-1);break;case 40:l.shiftKey?b=-1:(l.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(x=0,b=0),{cameraAnimation:M=>{const L=this._tr;M.easeTo({duration:300,easeId:"keyboardHandler",easing:dl,zoom:p?Math.round(L.zoom)+p*(l.shiftKey?2:1):L.zoom,bearing:L.bearing+x*this._bearingStep,pitch:L.pitch+b*this._pitchStep,offset:[-S*this._panStep,-A*this._panStep],center:L.center},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function dl(k){return k*(2-k)}const rx=4.000244140625;class Da{constructor(l,p){this._onTimeout=x=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(x)},this._map=l,this._tr=new Ra(l),this._triggerRenderFrame=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(l){return!!this._map.cooperativeGestures.isEnabled()&&!(l.ctrlKey||this._map.cooperativeGestures.isBypassed(l))}wheel(l){if(!this.isEnabled())return;if(this._shouldBePrevented(l))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",l);let p=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const x=v.now(),b=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,p!==0&&p%rx==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(b*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),l.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=l,this._delta-=p,this._active||this._start(l)),l.preventDefault()}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=w.mousePos(this._map.getCanvas(),l),x=this._tr;this._around=p.y>x.transform.height/2-x.transform.getHorizon()?o.N.convert(this._aroundCenter?x.center:x.unproject(p)):o.N.convert(x.center),this._aroundPoint=x.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._tr.transform;if(this._delta!==0){const L=this._type==="wheel"&&Math.abs(this._delta)>rx?this._wheelZoomRate:this._defaultZoomRate;let V=2/(1+Math.exp(-Math.abs(this._delta*L)));this._delta<0&&V!==0&&(V=1/V);const H=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):l.scale;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(H*V))),this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:l.zoom,x=this._startZoom,b=this._easing;let S,A=!1;const M=v.now()-this._lastWheelEventTime;if(this._type==="wheel"&&x&&b&&M){const L=Math.min(M/200,1),V=b(L);S=o.y.number(x,p,V),L<1?this._frameId||(this._frameId=!0):A=!0}else S=p,A=!0;return this._active=!0,A&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!A,zoomDelta:S-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let p=o.b9;if(this._prevEase){const x=this._prevEase,b=(v.now()-x.start)/x.duration,S=x.easing(b+.01)-x.easing(b),A=.27/Math.sqrt(S*S+1e-4)*.01,M=Math.sqrt(.0729-A*A);p=o.b8(A,M,.25,1)}return this._prevEase={start:v.now(),duration:l,easing:p},p}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Fu{constructor(l,p){this._clickZoom=l,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class BC{constructor(l){this._tr=new Ra(l),this.reset()}reset(){this._active=!1}dblclick(l,p){return l.preventDefault(),{cameraAnimation:x=>{x.easeTo({duration:300,zoom:this._tr.zoom+(l.shiftKey?-1:1),around:this._tr.unproject(p)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $C{constructor(){this._tap=new Vm({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(l,p,x){if(!this._swipePoint)if(this._tapTime){const b=p[0],S=l.timeStamp-this._tapTime<500,A=this._tapPoint.dist(b)<30;S&&A?x.length>0&&(this._swipePoint=b,this._swipeTouch=x[0].identifier):this.reset()}else this._tap.touchstart(l,p,x)}touchmove(l,p,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;const b=p[0],S=b.y-this._swipePoint.y;return this._swipePoint=b,l.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(l,p,x)}touchend(l,p,x){if(this._tapTime)this._swipePoint&&x.length===0&&this.reset();else{const b=this._tap.touchend(l,p,x);b&&(this._tapTime=l.timeStamp,this._tapPoint=b)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class h_{constructor(l,p,x){this._el=l,this._mousePan=p,this._touchPan=x}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class d_{constructor(l,p,x){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=p,this._mousePitch=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class nx{constructor(l,p,x,b){this._el=l,this._touchZoom=p,this._touchRotate=x,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class qh{constructor(l,p){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=l,this._options=p,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const l=this._map.getCanvasContainer();l.classList.add("maplibregl-cooperative-gestures"),this._container=w.create("div","maplibregl-cooperative-gesture-screen",l);let p=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(p=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const x=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),b=document.createElement("div");b.className="maplibregl-desktop-message",b.textContent=p,this._container.appendChild(b);const S=document.createElement("div");S.className="maplibregl-mobile-message",S.textContent=x,this._container.appendChild(S),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(w.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(l){return l[this._bypassKey]}notifyGestureBlocked(l,p){this._enabled&&(this._map.fire(new o.k("cooperativegestureprevented",{gestureType:l,originalEvent:p})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const ia=k=>k.zoom||k.drag||k.pitch||k.rotate;class Kt extends o.k{}function Hm(k){return k.panDelta&&k.panDelta.mag()||k.zoomDelta||k.bearingDelta||k.pitchDelta}class ix{constructor(l,p){this.handleWindowEvent=b=>{this.handleEvent(b,`${b.type}Window`)},this.handleEvent=(b,S)=>{if(b.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const A=b.type==="renderFrame"?void 0:b,M={needsRenderFrame:!1},L={},V={},H=b.touches,G=H?this._getMapTouches(H):void 0,ie=G?w.touchPos(this._map.getCanvas(),G):w.mousePos(this._map.getCanvas(),b);for(const{handlerName:xe,handler:Se,allowed:Ce}of this._handlers){if(!Se.isEnabled())continue;let je;this._blockedByActive(V,Ce,xe)?Se.reset():Se[S||b.type]&&(je=Se[S||b.type](b,ie,G),this.mergeHandlerResult(M,L,je,xe,A),je&&je.needsRenderFrame&&this._triggerRenderFrame()),(je||Se.isActive())&&(V[xe]=Se)}const le={};for(const xe in this._previousActiveHandlers)V[xe]||(le[xe]=A);this._previousActiveHandlers=V,(Object.keys(le).length||Hm(M))&&(this._changes.push([M,L,le]),this._triggerRenderFrame()),(Object.keys(V).length||Hm(M))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:he}=M;he&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],he(this._map))},this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Q0(l),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p);const x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[window,"blur",void 0]];for(const[b,S,A]of this._listeners)w.addEventListener(b,S,b===document?this.handleWindowEvent:this.handleEvent,A)}destroy(){for(const[l,p,x]of this._listeners)w.removeEventListener(l,p,l===document?this.handleWindowEvent:this.handleEvent,x)}_addDefaultHandlers(l){const p=this._map,x=p.getCanvasContainer();this._add("mapEvent",new c_(p,l));const b=p.boxZoom=new Eo(p,l);this._add("boxZoom",b),l.interactive&&l.boxZoom&&b.enable();const S=p.cooperativeGestures=new qh(p,l.cooperativeGestures);this._add("cooperativeGestures",S),l.cooperativeGestures&&S.enable();const A=new Uh(p),M=new BC(p);p.doubleClickZoom=new Fu(M,A),this._add("tapZoom",A),this._add("clickZoom",M),l.interactive&&l.doubleClickZoom&&p.doubleClickZoom.enable();const L=new $C;this._add("tapDragZoom",L);const V=p.touchPitch=new Uf(p);this._add("touchPitch",V),l.interactive&&l.touchPitch&&p.touchPitch.enable(l.touchPitch);const H=K0(l),G=Z0(l);p.dragRotate=new d_(l,H,G),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",G,["mouseRotate"]),l.interactive&&l.dragRotate&&p.dragRotate.enable();const ie=(({enable:je,clickTolerance:pe})=>{const Fe=new Wm({checkCorrectEvent:Ue=>w.mouseButton(Ue)===0&&!Ue.ctrlKey});return new Jl({clickTolerance:pe,move:(Ue,Je)=>({around:Je,panDelta:Je.sub(Ue)}),activateOnStart:!0,moveStateManager:Fe,enable:je,assignEvents:Um})})(l),le=new Lu(l,p);p.dragPan=new h_(x,ie,le),this._add("mousePan",ie),this._add("touchPan",le,["touchZoom","touchRotate"]),l.interactive&&l.dragPan&&p.dragPan.enable(l.dragPan);const he=new tx,xe=new J0;p.touchZoomRotate=new nx(x,xe,he,L),this._add("touchRotate",he,["touchPan","touchZoom"]),this._add("touchZoom",xe,["touchPan","touchRotate"]),l.interactive&&l.touchZoomRotate&&p.touchZoomRotate.enable(l.touchZoomRotate);const Se=p.scrollZoom=new Da(p,()=>this._triggerRenderFrame());this._add("scrollZoom",Se,["mousePan"]),l.interactive&&l.scrollZoom&&p.scrollZoom.enable(l.scrollZoom);const Ce=p.keyboard=new na(p);this._add("keyboard",Ce),l.interactive&&l.keyboard&&p.keyboard.enable(),this._add("blockableMapEvent",new gi(p))}_add(l,p,x){this._handlers.push({handlerName:l,handler:p,allowed:x}),this._handlersById[l]=p}stop(l){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ia(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,p,x){for(const b in l)if(b!==x&&(!p||p.indexOf(b)<0))return!0;return!1}_getMapTouches(l){const p=[];for(const x of l)this._el.contains(x.target)&&p.push(x);return p}mergeHandlerResult(l,p,x,b,S){if(!x)return;o.e(l,x);const A={handlerName:b,originalEvent:x.originalEvent||S};x.zoomDelta!==void 0&&(p.zoom=A),x.panDelta!==void 0&&(p.drag=A),x.pitchDelta!==void 0&&(p.pitch=A),x.bearingDelta!==void 0&&(p.rotate=A)}_applyChanges(){const l={},p={},x={};for(const[b,S,A]of this._changes)b.panDelta&&(l.panDelta=(l.panDelta||new o.P(0,0))._add(b.panDelta)),b.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+b.pitchDelta),b.around!==void 0&&(l.around=b.around),b.pinchAround!==void 0&&(l.pinchAround=b.pinchAround),b.noInertia&&(l.noInertia=b.noInertia),o.e(p,S),o.e(x,A);this._updateMapTransform(l,p,x),this._changes=[]}_updateMapTransform(l,p,x){const b=this._map,S=b._getTransformForUpdate(),A=b.terrain;if(!(Hm(l)||A&&this._terrainMovement))return this._fireEvents(p,x,!0);let{panDelta:M,zoomDelta:L,bearingDelta:V,pitchDelta:H,around:G,pinchAround:ie}=l;ie!==void 0&&(G=ie),b._stop(!0),G=G||b.transform.centerPoint;const le=S.pointLocation(M?G.sub(M):G);V&&(S.bearing+=V),H&&(S.pitch+=H),L&&(S.zoom+=L),A?this._terrainMovement||!p.drag&&!p.zoom?p.drag&&this._terrainMovement?S.center=S.pointLocation(S.centerPoint.sub(M)):S.setLocationAtPoint(le,G):(this._terrainMovement=!0,this._map._elevationFreeze=!0,S.setLocationAtPoint(le,G)):S.setLocationAtPoint(le,G),b._applyUpdatedTransform(S),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(p,x,!0)}_fireEvents(l,p,x){const b=ia(this._eventsInProgress),S=ia(l),A={};for(const G in l){const{originalEvent:ie}=l[G];this._eventsInProgress[G]||(A[`${G}start`]=ie),this._eventsInProgress[G]=l[G]}!b&&S&&this._fireEvent("movestart",S.originalEvent);for(const G in A)this._fireEvent(G,A[G]);S&&this._fireEvent("move",S.originalEvent);for(const G in l){const{originalEvent:ie}=l[G];this._fireEvent(G,ie)}const M={};let L;for(const G in this._eventsInProgress){const{handlerName:ie,originalEvent:le}=this._eventsInProgress[G];this._handlersById[ie].isActive()||(delete this._eventsInProgress[G],L=p[ie]||le,M[`${G}end`]=L)}for(const G in M)this._fireEvent(G,M[G]);const V=ia(this._eventsInProgress),H=(b||S)&&!V;if(H&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const G=this._map._getTransformForUpdate();G.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(G)}if(x&&H){this._updatingCamera=!0;const G=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ie=le=>le!==0&&-this._bearingSnap<le&&le<this._bearingSnap;!G||!G.essential&&v.prefersReducedMotion?(this._map.fire(new o.k("moveend",{originalEvent:L})),ie(this._map.getBearing())&&this._map.resetNorth()):(ie(G.bearing||this._map.getBearing())&&(G.bearing=0),G.freezeElevation=!0,this._map.easeTo(G,{originalEvent:L})),this._updatingCamera=!1}}_fireEvent(l,p){this._map.fire(new o.k(l,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new Kt("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class f_ extends o.E{constructor(l,p){super(),this._renderFrameCallback=()=>{const x=Math.min((v.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(x)),x<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=p.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new o.N(this.transform.center.lng,this.transform.center.lat)}setCenter(l,p){return this.jumpTo({center:l},p)}panBy(l,p,x){return l=o.P.convert(l).mult(-1),this.panTo(this.transform.center,o.e({offset:l},p),x)}panTo(l,p,x){return this.easeTo(o.e({center:l},p),x)}getZoom(){return this.transform.zoom}setZoom(l,p){return this.jumpTo({zoom:l},p),this}zoomTo(l,p,x){return this.easeTo(o.e({zoom:l},p),x)}zoomIn(l,p){return this.zoomTo(this.getZoom()+1,l,p),this}zoomOut(l,p){return this.zoomTo(this.getZoom()-1,l,p),this}getBearing(){return this.transform.bearing}setBearing(l,p){return this.jumpTo({bearing:l},p),this}getPadding(){return this.transform.padding}setPadding(l,p){return this.jumpTo({padding:l},p),this}rotateTo(l,p,x){return this.easeTo(o.e({bearing:l},p),x)}resetNorth(l,p){return this.rotateTo(0,o.e({duration:1e3},l),p),this}resetNorthPitch(l,p){return this.easeTo(o.e({bearing:0,pitch:0,duration:1e3},l),p),this}snapToNorth(l,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,p):this}getPitch(){return this.transform.pitch}setPitch(l,p){return this.jumpTo({pitch:l},p),this}cameraForBounds(l,p){l=Te.convert(l).adjustAntiMeridian();const x=p&&p.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),x,p)}_cameraForBoxAndBearing(l,p,x,b){const S={top:0,bottom:0,right:0,left:0};if(typeof(b=o.e({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},b)).padding=="number"){const zt=b.padding;b.padding={top:zt,bottom:zt,right:zt,left:zt}}b.padding=o.e(S,b.padding);const A=this.transform,M=A.padding,L=new Te(l,p),V=A.project(L.getNorthWest()),H=A.project(L.getNorthEast()),G=A.project(L.getSouthEast()),ie=A.project(L.getSouthWest()),le=o.ba(-x),he=V.rotate(le),xe=H.rotate(le),Se=G.rotate(le),Ce=ie.rotate(le),je=new o.P(Math.max(he.x,xe.x,Ce.x,Se.x),Math.max(he.y,xe.y,Ce.y,Se.y)),pe=new o.P(Math.min(he.x,xe.x,Ce.x,Se.x),Math.min(he.y,xe.y,Ce.y,Se.y)),Fe=je.sub(pe),Ue=(A.width-(M.left+M.right+b.padding.left+b.padding.right))/Fe.x,Je=(A.height-(M.top+M.bottom+b.padding.top+b.padding.bottom))/Fe.y;if(Je<0||Ue<0)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ft=Math.min(A.scaleZoom(A.scale*Math.min(Ue,Je)),b.maxZoom),kt=o.P.convert(b.offset),Lt=new o.P((b.padding.left-b.padding.right)/2,(b.padding.top-b.padding.bottom)/2).rotate(o.ba(x)),qt=kt.add(Lt).mult(A.scale/A.zoomScale(ft));return{center:A.unproject(V.add(G).div(2).sub(qt)),zoom:ft,bearing:x}}fitBounds(l,p,x){return this._fitInternal(this.cameraForBounds(l,p),p,x)}fitScreenCoordinates(l,p,x,b,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.P.convert(l)),this.transform.pointLocation(o.P.convert(p)),x,b),b,S)}_fitInternal(l,p,x){return l?(delete(p=o.e(l,p)).padding,p.linear?this.easeTo(p,x):this.flyTo(p,x)):this}jumpTo(l,p){this.stop();const x=this._getTransformForUpdate();let b=!1,S=!1,A=!1;return"zoom"in l&&x.zoom!==+l.zoom&&(b=!0,x.zoom=+l.zoom),l.center!==void 0&&(x.center=o.N.convert(l.center)),"bearing"in l&&x.bearing!==+l.bearing&&(S=!0,x.bearing=+l.bearing),"pitch"in l&&x.pitch!==+l.pitch&&(A=!0,x.pitch=+l.pitch),l.padding==null||x.isPaddingEqual(l.padding)||(x.padding=l.padding),this._applyUpdatedTransform(x),this.fire(new o.k("movestart",p)).fire(new o.k("move",p)),b&&this.fire(new o.k("zoomstart",p)).fire(new o.k("zoom",p)).fire(new o.k("zoomend",p)),S&&this.fire(new o.k("rotatestart",p)).fire(new o.k("rotate",p)).fire(new o.k("rotateend",p)),A&&this.fire(new o.k("pitchstart",p)).fire(new o.k("pitch",p)).fire(new o.k("pitchend",p)),this.fire(new o.k("moveend",p))}calculateCameraOptionsFromTo(l,p,x,b=0){const S=o.Z.fromLngLat(l,p),A=o.Z.fromLngLat(x,b),M=A.x-S.x,L=A.y-S.y,V=A.z-S.z,H=Math.hypot(M,L,V);if(H===0)throw new Error("Can't calculate camera options with same From and To");const G=Math.hypot(M,L),ie=this.transform.scaleZoom(this.transform.cameraToCenterDistance/H/this.transform.tileSize),le=180*Math.atan2(M,-L)/Math.PI;let he=180*Math.acos(G/H)/Math.PI;return he=V<0?90-he:90+he,{center:A.toLngLat(),zoom:ie,pitch:he,bearing:le}}easeTo(l,p){var x;this._stop(!1,l.easeId),((l=o.e({offset:[0,0],duration:500,easing:o.b9},l)).animate===!1||!l.essential&&v.prefersReducedMotion)&&(l.duration=0);const b=this._getTransformForUpdate(),S=b.zoom,A=b.bearing,M=b.pitch,L=b.padding,V="bearing"in l?this._normalizeBearing(l.bearing,A):A,H="pitch"in l?+l.pitch:M,G="padding"in l?l.padding:b.padding,ie=o.P.convert(l.offset);let le=b.centerPoint.add(ie);const he=b.pointLocation(le),{center:xe,zoom:Se}=b.getConstrained(o.N.convert(l.center||he),(x=l.zoom)!==null&&x!==void 0?x:S);this._normalizeCenter(xe,b);const Ce=b.project(he),je=b.project(xe).sub(Ce),pe=b.zoomScale(Se-S);let Fe,Ue;l.around&&(Fe=o.N.convert(l.around),Ue=b.locationPoint(Fe));const Je={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Se!==S,this._rotating=this._rotating||A!==V,this._pitching=this._pitching||H!==M,this._padding=!b.isPaddingEqual(G),this._easeId=l.easeId,this._prepareEase(p,l.noMoveStart,Je),this.terrain&&this._prepareElevation(xe),this._ease(ft=>{if(this._zooming&&(b.zoom=o.y.number(S,Se,ft)),this._rotating&&(b.bearing=o.y.number(A,V,ft)),this._pitching&&(b.pitch=o.y.number(M,H,ft)),this._padding&&(b.interpolatePadding(L,G,ft),le=b.centerPoint.add(ie)),this.terrain&&!l.freezeElevation&&this._updateElevation(ft),Fe)b.setLocationAtPoint(Fe,Ue);else{const kt=b.zoomScale(b.zoom-S),Lt=Se>S?Math.min(2,pe):Math.max(.5,pe),qt=Math.pow(Lt,1-ft),zt=b.unproject(Ce.add(je.mult(ft*qt)).mult(kt));b.setLocationAtPoint(b.renderWorldCopies?zt.wrap():zt,le)}this._applyUpdatedTransform(b),this._fireMoveEvents(p)},ft=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(p,ft)},l),this}_prepareEase(l,p,x={}){this._moving=!0,p||x.moving||this.fire(new o.k("movestart",l)),this._zooming&&!x.zooming&&this.fire(new o.k("zoomstart",l)),this._rotating&&!x.rotating&&this.fire(new o.k("rotatestart",l)),this._pitching&&!x.pitching&&this.fire(new o.k("pitchstart",l))}_prepareElevation(l){this._elevationCenter=l,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(l){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const p=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(l<1&&p!==this._elevationTarget){const x=this._elevationTarget-this._elevationStart;this._elevationStart+=l*(x-(p-(x*l+this._elevationStart))/(1-l)),this._elevationTarget=p}this.transform.elevation=o.y.number(this._elevationStart,this._elevationTarget,l)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(l){const p=l.getCameraPosition(),x=this.terrain.getElevationForLngLatZoom(p.lngLat,l.zoom);if(p.altitude<x){const b=this.calculateCameraOptionsFromTo(p.lngLat,x,l.center,l.elevation);return{pitch:b.pitch,zoom:b.zoom}}return{}}_applyUpdatedTransform(l){const p=[];if(this.terrain&&p.push(b=>this._elevateCameraIfInsideTerrain(b)),this.transformCameraUpdate&&p.push(b=>this.transformCameraUpdate(b)),!p.length)return;const x=l.clone();for(const b of p){const S=x.clone(),{center:A,zoom:M,pitch:L,bearing:V,elevation:H}=b(S);A&&(S.center=A),M!==void 0&&(S.zoom=M),L!==void 0&&(S.pitch=L),V!==void 0&&(S.bearing=V),H!==void 0&&(S.elevation=H),x.apply(S)}this.transform.apply(x)}_fireMoveEvents(l){this.fire(new o.k("move",l)),this._zooming&&this.fire(new o.k("zoom",l)),this._rotating&&this.fire(new o.k("rotate",l)),this._pitching&&this.fire(new o.k("pitch",l))}_afterEase(l,p){if(this._easeId&&p&&this._easeId===p)return;delete this._easeId;const x=this._zooming,b=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,x&&this.fire(new o.k("zoomend",l)),b&&this.fire(new o.k("rotateend",l)),S&&this.fire(new o.k("pitchend",l)),this.fire(new o.k("moveend",l))}flyTo(l,p){var x;if(!l.essential&&v.prefersReducedMotion){const Nt=o.M(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Nt,p)}this.stop(),l=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.b9},l);const b=this._getTransformForUpdate(),S=b.zoom,A=b.bearing,M=b.pitch,L=b.padding,V="bearing"in l?this._normalizeBearing(l.bearing,A):A,H="pitch"in l?+l.pitch:M,G="padding"in l?l.padding:b.padding,ie=o.P.convert(l.offset);let le=b.centerPoint.add(ie);const he=b.pointLocation(le),{center:xe,zoom:Se}=b.getConstrained(o.N.convert(l.center||he),(x=l.zoom)!==null&&x!==void 0?x:S);this._normalizeCenter(xe,b);const Ce=b.zoomScale(Se-S),je=b.project(he),pe=b.project(xe).sub(je);let Fe=l.curve;const Ue=Math.max(b.width,b.height),Je=Ue/Ce,ft=pe.mag();if("minZoom"in l){const Nt=o.ac(Math.min(l.minZoom,S,Se),b.minZoom,b.maxZoom),Tr=Ue/b.zoomScale(Nt-S);Fe=Math.sqrt(Tr/ft*2)}const kt=Fe*Fe;function Lt(Nt){const Tr=(Je*Je-Ue*Ue+(Nt?-1:1)*kt*kt*ft*ft)/(2*(Nt?Je:Ue)*kt*ft);return Math.log(Math.sqrt(Tr*Tr+1)-Tr)}function qt(Nt){return(Math.exp(Nt)-Math.exp(-Nt))/2}function zt(Nt){return(Math.exp(Nt)+Math.exp(-Nt))/2}const At=Lt(!1);let ar=function(Nt){return zt(At)/zt(At+Fe*Nt)},Pr=function(Nt){return Ue*((zt(At)*(qt(Tr=At+Fe*Nt)/zt(Tr))-qt(At))/kt)/ft;var Tr},It=(Lt(!0)-At)/Fe;if(Math.abs(ft)<1e-6||!isFinite(It)){if(Math.abs(Ue-Je)<1e-6)return this.easeTo(l,p);const Nt=Je<Ue?-1:1;It=Math.abs(Math.log(Je/Ue))/Fe,Pr=()=>0,ar=Tr=>Math.exp(Nt*Fe*Tr)}return l.duration="duration"in l?+l.duration:1e3*It/("screenSpeed"in l?+l.screenSpeed/Fe:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=A!==V,this._pitching=H!==M,this._padding=!b.isPaddingEqual(G),this._prepareEase(p,!1),this.terrain&&this._prepareElevation(xe),this._ease(Nt=>{const Tr=Nt*It,Qn=1/ar(Tr);b.zoom=Nt===1?Se:S+b.scaleZoom(Qn),this._rotating&&(b.bearing=o.y.number(A,V,Nt)),this._pitching&&(b.pitch=o.y.number(M,H,Nt)),this._padding&&(b.interpolatePadding(L,G,Nt),le=b.centerPoint.add(ie)),this.terrain&&!l.freezeElevation&&this._updateElevation(Nt);const $r=Nt===1?xe:b.unproject(je.add(pe.mult(Pr(Tr))).mult(Qn));b.setLocationAtPoint(b.renderWorldCopies?$r.wrap():$r,le),this._applyUpdatedTransform(b),this._fireMoveEvents(p)},()=>{this.terrain&&l.freezeElevation&&this._finalizeElevation(),this._afterEase(p)},l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,p){var x;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const b=this._onEaseEnd;delete this._onEaseEnd,b.call(this,p)}return l||(x=this.handlers)===null||x===void 0||x.stop(!1),this}_ease(l,p,x){x.animate===!1||x.duration===0?(l(1),p()):(this._easeStart=v.now(),this._easeOptions=x,this._onEaseFrame=l,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(l,p){l=o.b3(l,-180,180);const x=Math.abs(l-p);return Math.abs(l-360-p)<x&&(l-=360),Math.abs(l+360-p)<x&&(l+=360),l}_normalizeCenter(l,p){if(!p.renderWorldCopies||p.lngRange)return;const x=l.lng-p.center.lng;l.lng+=x>180?-360:x<-180?360:0}queryTerrainElevation(l){return this.terrain?this.terrain.getElevationForLngLatZoom(o.N.convert(l),this.transform.tileZoom)-this.transform.elevation:null}}const Qh={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Hh{constructor(l=Qh){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=p=>{!p||p.sourceDataType!=="metadata"&&p.sourceDataType!=="visibility"&&p.dataType!=="style"&&p.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=l}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options.compact,this._container=w.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=w.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=w.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){w.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,p){const x=this._map._getUIString(`AttributionControl.${p}`);l.title=x,l.setAttribute("aria-label",x)}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(b=>typeof b!="string"?"":b)):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const p=this._map.style.sourceCaches;for(const b in p){const S=p[b];if(S.used||S.usedForTerrain){const A=S.getSource();A.attribution&&l.indexOf(A.attribution)<0&&l.push(A.attribution)}}l=l.filter(b=>String(b).trim()),l.sort((b,S)=>b.length-S.length),l=l.filter((b,S)=>{for(let A=S+1;A<l.length;A++)if(l[A].indexOf(b)>=0)return!1;return!0});const x=l.join(" | ");x!==this._attribHTML&&(this._attribHTML=x,l.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class sx{constructor(l={}){this._updateCompact=()=>{const p=this._container.children;if(p.length){const x=p[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&x.classList.add("maplibregl-compact"):x.classList.remove("maplibregl-compact")}},this.options=l}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=w.create("div","maplibregl-ctrl");const p=w.create("a","maplibregl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://maplibre.org/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){w.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Zr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const p=++this._id;return this._queue.push({callback:l,id:p,cancelled:!1}),p}remove(l){const p=this._currentlyRunning,x=p?this._queue.concat(p):this._queue;for(const b of x)if(b.id===l)return void(b.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const p=this._currentlyRunning=this._queue;this._queue=[];for(const x of p)if(!x.cancelled&&(x.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ox=o.Y([{name:"a_pos3d",type:"Int16",components:3}]);class NC extends o.E{constructor(l){super(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,l.usedForTerrain=!0,l.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(l,p){this.sourceCache.update(l,p),this._renderableTilesKeys=[];const x={};for(const b of l.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:p}))x[b.key]=!0,this._renderableTilesKeys.push(b.key),this._tiles[b.key]||(b.posMatrix=new Float64Array(16),o.aP(b.posMatrix,0,o.X,0,o.X,0,1),this._tiles[b.key]=new wn(b,this.tileSize));for(const b in this._tiles)x[b]||delete this._tiles[b]}freeRtt(l){for(const p in this._tiles){const x=this._tiles[p];(!l||x.tileID.equals(l)||x.tileID.isChildOf(l)||l.isChildOf(x.tileID))&&(x.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(l=>this.getTileByID(l))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l){const p={};for(const x of this._renderableTilesKeys){const b=this._tiles[x].tileID;if(b.canonical.equals(l.canonical)){const S=l.clone();S.posMatrix=new Float64Array(16),o.aP(S.posMatrix,0,o.X,0,o.X,0,1),p[x]=S}else if(b.canonical.isChildOf(l.canonical)){const S=l.clone();S.posMatrix=new Float64Array(16);const A=b.canonical.z-l.canonical.z,M=b.canonical.x-(b.canonical.x>>A<<A),L=b.canonical.y-(b.canonical.y>>A<<A),V=o.X>>A;o.aP(S.posMatrix,0,V,0,V,0,1),o.J(S.posMatrix,S.posMatrix,[-M*V,-L*V,0]),p[x]=S}else if(l.canonical.isChildOf(b.canonical)){const S=l.clone();S.posMatrix=new Float64Array(16);const A=l.canonical.z-b.canonical.z,M=l.canonical.x-(l.canonical.x>>A<<A),L=l.canonical.y-(l.canonical.y>>A<<A),V=o.X>>A;o.aP(S.posMatrix,0,o.X,0,o.X,0,1),o.J(S.posMatrix,S.posMatrix,[M*V,L*V,0]),o.K(S.posMatrix,S.posMatrix,[1/2**A,1/2**A,0]),p[x]=S}}return p}getSourceTile(l,p){const x=this.sourceCache._source;let b=l.overscaledZ-this.deltaZoom;if(b>x.maxzoom&&(b=x.maxzoom),b<x.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(b).key);let S=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!S||!S.dem)&&p)for(;b>=x.minzoom&&(!S||!S.dem);)S=this.sourceCache.getTileByID(l.scaledTo(b--).key);return S}tilesAfterTime(l=Date.now()){return Object.values(this._tiles).filter(p=>p.timeAdded>=l)}}class ax{constructor(l,p,x){this.painter=l,this.sourceCache=new NC(p),this.options=x,this.exaggeration=typeof x.exaggeration=="number"?x.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(l,p,x,b=o.X){var S;if(!(p>=0&&p<b&&x>=0&&x<b))return 0;const A=this.getTerrainData(l),M=(S=A.tile)===null||S===void 0?void 0:S.dem;if(!M)return 0;const L=function(he,xe,Se){var Ce=xe[0],je=xe[1];return he[0]=Se[0]*Ce+Se[4]*je+Se[12],he[1]=Se[1]*Ce+Se[5]*je+Se[13],he}([],[p/b*o.X,x/b*o.X],A.u_terrain_matrix),V=[L[0]*M.dim,L[1]*M.dim],H=Math.floor(V[0]),G=Math.floor(V[1]),ie=V[0]-H,le=V[1]-G;return M.get(H,G)*(1-ie)*(1-le)+M.get(H+1,G)*ie*(1-le)+M.get(H,G+1)*(1-ie)*le+M.get(H+1,G+1)*ie*le}getElevationForLngLatZoom(l,p){if(!o.bb(p,l.wrap()))return 0;const{tileID:x,mercatorX:b,mercatorY:S}=this._getOverscaledTileIDFromLngLatZoom(l,p);return this.getElevation(x,b%o.X,S%o.X,o.X)}getElevation(l,p,x,b=o.X){return this.getDEMElevation(l,p,x,b)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const b=this.painter.context,S=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ce(b,S,b.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ce(b,new o.R({width:1,height:1}),b.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(b.gl.NEAREST,b.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.an([])}const p=this.sourceCache.getSourceTile(l,!0);if(p&&p.dem&&(!p.demTexture||p.needsTerrainPrepare)){const b=this.painter.context;p.demTexture=this.painter.getTileTexture(p.dem.stride),p.demTexture?p.demTexture.update(p.dem.getPixels(),{premultiply:!1}):p.demTexture=new ce(b,p.dem.getPixels(),b.gl.RGBA,{premultiply:!1}),p.demTexture.bind(b.gl.NEAREST,b.gl.CLAMP_TO_EDGE),p.needsTerrainPrepare=!1}const x=p&&p+p.tileID.key+l.key;if(x&&!this._demMatrixCache[x]){const b=this.sourceCache.sourceCache._source.maxzoom;let S=l.canonical.z-p.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=b?S=l.canonical.z-b:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const A=l.canonical.x-(l.canonical.x>>S<<S),M=l.canonical.y-(l.canonical.y>>S<<S),L=o.bc(new Float64Array(16),[1/(o.X<<S),1/(o.X<<S),0]);o.J(L,L,[A*o.X,M*o.X,0]),this._demMatrixCache[l.key]={matrix:L,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:p&&p.dem&&p.dem.dim||1,u_terrain_matrix:x?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:p&&p.dem&&p.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(p&&p.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:p}}getFramebuffer(l){const p=this.painter,x=p.width/devicePixelRatio,b=p.height/devicePixelRatio;return!this._fbo||this._fbo.width===x&&this._fbo.height===b||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ce(p.context,{width:x,height:b,data:null},p.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(p.context.gl.NEAREST,p.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ce(p.context,{width:x,height:b,data:null},p.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(p.context.gl.NEAREST,p.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=p.context.createFramebuffer(x,b,!0,!1),this._fbo.depthAttachment.set(p.context.createRenderbuffer(p.context.gl.DEPTH_COMPONENT16,x,b))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const p=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let S=0,A=0;S<this._coordsTextureSize;S++)for(let M=0;M<this._coordsTextureSize;M++,A+=4)p[A+0]=255&M,p[A+1]=255&S,p[A+2]=M>>8<<4|S>>8,p[A+3]=0;const x=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(p.buffer)),b=new ce(l,x,l.gl.RGBA,{premultiply:!1});return b.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=b,b}pointCoordinate(l){this.painter.maybeDrawDepthAndCoords(!0);const p=new Uint8Array(4),x=this.painter.context,b=x.gl,S=Math.round(l.x*this.painter.pixelRatio/devicePixelRatio),A=Math.round(l.y*this.painter.pixelRatio/devicePixelRatio),M=Math.round(this.painter.height/devicePixelRatio);x.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),b.readPixels(S,M-A-1,1,1,b.RGBA,b.UNSIGNED_BYTE,p),x.bindFramebuffer.set(null);const L=p[0]+(p[2]>>4<<8),V=p[1]+((15&p[2])<<8),H=this.coordsIndex[255-p[3]],G=H&&this.sourceCache.getTileByID(H);if(!G)return null;const ie=this._coordsTextureSize,le=(1<<G.tileID.canonical.z)*ie;return new o.Z((G.tileID.canonical.x*ie+L)/le+G.tileID.wrap,(G.tileID.canonical.y*ie+V)/le,this.getElevation(G.tileID,L,V,ie))}depthAtPoint(l){const p=new Uint8Array(4),x=this.painter.context,b=x.gl;return x.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),b.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,b.RGBA,b.UNSIGNED_BYTE,p),x.bindFramebuffer.set(null),(p[0]/16777216+p[1]/65536+p[2]/256+p[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const l=this.painter.context,p=new o.bd,x=new o.aY,b=this.meshSize,S=o.X/b,A=b*b;for(let G=0;G<=b;G++)for(let ie=0;ie<=b;ie++)p.emplaceBack(ie*S,G*S,0);for(let G=0;G<A;G+=b+1)for(let ie=0;ie<b;ie++)x.emplaceBack(ie+G,b+ie+G+1,b+ie+G+2),x.emplaceBack(ie+G,b+ie+G+2,ie+G+1);const M=p.length,L=M+2*(b+1);for(const G of[0,1])for(let ie=0;ie<=b;ie++)for(const le of[0,1])p.emplaceBack(ie*S,G*o.X,le);for(let G=0;G<2*b;G+=2)x.emplaceBack(L+G,L+G+1,L+G+3),x.emplaceBack(L+G,L+G+3,L+G+2),x.emplaceBack(M+G,M+G+3,M+G+1),x.emplaceBack(M+G,M+G+2,M+G+3);const V=p.length,H=V+2*(b+1);for(const G of[0,1])for(let ie=0;ie<=b;ie++)for(const le of[0,1])p.emplaceBack(G*o.X,ie*S,le);for(let G=0;G<2*b;G+=2)x.emplaceBack(V+G,V+G+1,V+G+3),x.emplaceBack(V+G,V+G+3,V+G+2),x.emplaceBack(H+G,H+G+3,H+G+1),x.emplaceBack(H+G,H+G+2,H+G+3);return this._mesh=new Lm(l.createVertexBuffer(p,ox.members),l.createIndexBuffer(x),o.a0.simpleSegment(0,0,p.length,x.length)),this._mesh}getMeshFrameDelta(l){return 2*Math.PI*o.be/Math.pow(2,l)/5}getMinTileElevationForLngLatZoom(l,p){var x;const{tileID:b}=this._getOverscaledTileIDFromLngLatZoom(l,p);return(x=this.getMinMaxElevation(b).minElevation)!==null&&x!==void 0?x:0}getMinMaxElevation(l){const p=this.getTerrainData(l).tile,x={minElevation:null,maxElevation:null};return p&&p.dem&&(x.minElevation=p.dem.min*this.exaggeration,x.maxElevation=p.dem.max*this.exaggeration),x}_getOverscaledTileIDFromLngLatZoom(l,p){const x=o.Z.fromLngLat(l.wrap()),b=(1<<p)*o.X,S=x.x*b,A=x.y*b,M=Math.floor(S/o.X),L=Math.floor(A/o.X);return{tileID:new o.S(p,0,p,M,L),mercatorX:S,mercatorY:A}}}class VC{constructor(l,p,x){this._context=l,this._size=p,this._tileSize=x,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const l of this._objects)l.texture.destroy(),l.fbo.destroy()}_createObject(l){const p=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),x=new ce(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return x.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),p.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),p.colorAttachment.set(x.texture),{id:l,fbo:p,texture:x,stamp:-1,inUse:!1}}getObjectForId(l){return this._objects[l]}useObject(l){l.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(p=>l.id!==p),this._recentlyUsed.push(l.id)}stampObject(l){l.stamp=++this._stamp}getOrCreateFreeObject(){for(const p of this._recentlyUsed)if(!this._objects[p].inUse)return this._objects[p];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const l=this._createObject(this._objects.length);return this._objects.push(l),l}freeObject(l){l.inUse=!1}freeAllObjects(){for(const l of this._objects)this.freeObject(l)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(l=>!l.inUse)===!1}}const Gh={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class p_{constructor(l,p){this.painter=l,this.terrain=p,this.pool=new VC(l.context,30,p.sourceCache.tileSize*p.qualityFactor)}destruct(){this.pool.destruct()}getTexture(l){return this.pool.getObjectForId(l.rtt[this._stacks.length-1].id).texture}prepareForRender(l,p){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=l._order.filter(x=>!l._layers[x].isHidden(p)),this._coordsDescendingInv={};for(const x in l.sourceCaches){this._coordsDescendingInv[x]={};const b=l.sourceCaches[x].getVisibleCoordinates();for(const S of b){const A=this.terrain.sourceCache.getTerrainCoords(S);for(const M in A)this._coordsDescendingInv[x][M]||(this._coordsDescendingInv[x][M]=[]),this._coordsDescendingInv[x][M].push(A[M])}}this._coordsDescendingInvStr={};for(const x of l._order){const b=l._layers[x],S=b.source;if(Gh[b.type]&&!this._coordsDescendingInvStr[S]){this._coordsDescendingInvStr[S]={};for(const A in this._coordsDescendingInv[S])this._coordsDescendingInvStr[S][A]=this._coordsDescendingInv[S][A].map(M=>M.key).sort().join()}}for(const x of this._renderableTiles)for(const b in this._coordsDescendingInvStr){const S=this._coordsDescendingInvStr[b][x.tileID.key];S&&S!==x.rttCoords[b]&&(x.rtt=[])}}renderLayer(l){if(l.isHidden(this.painter.transform.zoom))return!1;const p=l.type,x=this.painter,b=this._renderableLayerIds[this._renderableLayerIds.length-1]===l.id;if(Gh[p]&&(this._prevType&&Gh[this._prevType]||this._stacks.push([]),this._prevType=p,this._stacks[this._stacks.length-1].push(l.id),!b))return!0;if(Gh[this._prevType]||Gh[p]&&b){this._prevType=p;const S=this._stacks.length-1,A=this._stacks[S]||[];for(const M of this._renderableTiles){if(this.pool.isFull()&&(o_(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(M),M.rtt[S]){const V=this.pool.getObjectForId(M.rtt[S].id);if(V.stamp===M.rtt[S].stamp){this.pool.useObject(V);continue}}const L=this.pool.getOrCreateFreeObject();this.pool.useObject(L),this.pool.stampObject(L),M.rtt[S]={id:L.id,stamp:L.stamp},x.context.bindFramebuffer.set(L.fbo.framebuffer),x.context.clear({color:o.aM.transparent,stencil:0}),x.currentStencilSource=void 0;for(let V=0;V<A.length;V++){const H=x.style._layers[A[V]],G=H.source?this._coordsDescendingInv[H.source][M.tileID.key]:[M.tileID];x.context.viewport.set([0,0,L.fbo.width,L.fbo.height]),x._renderTileClippingMasks(H,G),x.renderLayer(x,x.style.sourceCaches[H.source],H,G),H.source&&(M.rttCoords[H.source]=this._coordsDescendingInvStr[H.source][M.tileID.key])}}return o_(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Gh[p]}return!1}}const lx={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},m_=d,WC={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Qh,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},cx=k=>{k.touchstart=k.dragStart,k.touchmoveWindow=k.dragMove,k.touchend=k.dragEnd},UC={showCompass:!0,showZoom:!0,visualizePitch:!1};class qC{constructor(l,p,x=!1){this.mousedown=A=>{this.startMouse(o.e({},A,{ctrlKey:!0,preventDefault:()=>A.preventDefault()}),w.mousePos(this.element,A)),w.addEventListener(window,"mousemove",this.mousemove),w.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=A=>{this.moveMouse(A,w.mousePos(this.element,A))},this.mouseup=A=>{this.mouseRotate.dragEnd(A),this.mousePitch&&this.mousePitch.dragEnd(A),this.offTemp()},this.touchstart=A=>{A.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=w.touchPos(this.element,A.targetTouches)[0],this.startTouch(A,this._startPos),w.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),w.addEventListener(window,"touchend",this.touchend))},this.touchmove=A=>{A.targetTouches.length!==1?this.reset():(this._lastPos=w.touchPos(this.element,A.targetTouches)[0],this.moveTouch(A,this._lastPos))},this.touchend=A=>{A.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const b=l.dragRotate._mouseRotate.getClickTolerance(),S=l.dragRotate._mousePitch.getClickTolerance();this.element=p,this.mouseRotate=K0({clickTolerance:b,enable:!0}),this.touchRotate=(({enable:A,clickTolerance:M,bearingDegreesPerPixelMoved:L=.8})=>{const V=new X0;return new Jl({clickTolerance:M,move:(H,G)=>({bearingDelta:(G.x-H.x)*L}),moveStateManager:V,enable:A,assignEvents:cx})})({clickTolerance:b,enable:!0}),this.map=l,x&&(this.mousePitch=Z0({clickTolerance:S,enable:!0}),this.touchPitch=(({enable:A,clickTolerance:M,pitchDegreesPerPixelMoved:L=-.5})=>{const V=new X0;return new Jl({clickTolerance:M,move:(H,G)=>({pitchDelta:(G.y-H.y)*L}),moveStateManager:V,enable:A,assignEvents:cx})})({clickTolerance:S,enable:!0})),w.addEventListener(p,"mousedown",this.mousedown),w.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),w.addEventListener(p,"touchcancel",this.reset)}startMouse(l,p){this.mouseRotate.dragStart(l,p),this.mousePitch&&this.mousePitch.dragStart(l,p),w.disableDrag()}startTouch(l,p){this.touchRotate.dragStart(l,p),this.touchPitch&&this.touchPitch.dragStart(l,p),w.disableDrag()}moveMouse(l,p){const x=this.map,{bearingDelta:b}=this.mouseRotate.dragMove(l,p)||{};if(b&&x.setBearing(x.getBearing()+b),this.mousePitch){const{pitchDelta:S}=this.mousePitch.dragMove(l,p)||{};S&&x.setPitch(x.getPitch()+S)}}moveTouch(l,p){const x=this.map,{bearingDelta:b}=this.touchRotate.dragMove(l,p)||{};if(b&&x.setBearing(x.getBearing()+b),this.touchPitch){const{pitchDelta:S}=this.touchPitch.dragMove(l,p)||{};S&&x.setPitch(x.getPitch()+S)}}off(){const l=this.element;w.removeEventListener(l,"mousedown",this.mousedown),w.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),w.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),w.removeEventListener(window,"touchend",this.touchend),w.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){w.enableDrag(),w.removeEventListener(window,"mousemove",this.mousemove),w.removeEventListener(window,"mouseup",this.mouseup),w.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),w.removeEventListener(window,"touchend",this.touchend)}}let zo;function qn(k,l,p){const x=new o.N(k.lng,k.lat);if(k=new o.N(k.lng,k.lat),l){const b=new o.N(k.lng-360,k.lat),S=new o.N(k.lng+360,k.lat),A=p.locationPoint(k).distSqr(l);p.locationPoint(b).distSqr(l)<A?k=b:p.locationPoint(S).distSqr(l)<A&&(k=S)}for(;Math.abs(k.lng-p.center.lng)>180;){const b=p.locationPoint(k);if(b.x>=0&&b.y>=0&&b.x<=p.width&&b.y<=p.height)break;k.lng>p.center.lng?k.lng-=360:k.lng+=360}return k.lng!==x.lng&&p.locationPoint(k).y>p.height/2-p.getHorizon()?k:x}const Xh={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Gm(k,l,p){const x=k.classList;for(const b in Xh)x.remove(`maplibregl-${p}-anchor-${b}`);x.add(`maplibregl-${p}-anchor-${l}`)}class Xm extends o.E{constructor(l){if(super(),this._onKeyPress=p=>{const x=p.code,b=p.charCode||p.keyCode;x!=="Space"&&x!=="Enter"&&b!==32&&b!==13||this.togglePopup()},this._onMapClick=p=>{const x=p.originalEvent.target,b=this._element;this._popup&&(x===b||b.contains(x))&&this.togglePopup()},this._update=p=>{var x;if(!this._map)return;const b=this._map.loaded()&&!this._map.isMoving();((p==null?void 0:p.type)==="terrain"||(p==null?void 0:p.type)==="render"&&!b)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?qn(this._lngLat,this._flatPos,this._map.transform):(x=this._lngLat)===null||x===void 0?void 0:x.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let S="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?S=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(S=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let A="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?A="rotateX(0deg)":this._pitchAlignment==="map"&&(A=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||p&&p.type!=="moveend"||(this._pos=this._pos.round()),w.setTransform(this._element,`${Xh[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${A} ${S}`),v.frameAsync(new AbortController).then(()=>{this._updateOpacity(p&&p.type==="moveend")}).catch(()=>{})},this._onMove=p=>{if(!this._isDragging){const x=this._clickTolerance||this._map._clickTolerance;this._isDragging=p.point.dist(this._pointerdownPos)>=x}this._isDragging&&(this._pos=p.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.k("dragstart"))),this.fire(new o.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.k("dragend")),this._state="inactive"},this._addDragHandler=p=>{this._element.contains(p.originalEvent.target)&&(p.preventDefault(),this._positionDelta=p.point.sub(this._pos).add(this._offset),this._pointerdownPos=p.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._subpixelPositioning=l&&l.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(l==null?void 0:l.opacity,l==null?void 0:l.opacityWhenCovered),l&&l.element)this._element=l.element,this._offset=o.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=w.create("div");const p=w.createNS("http://www.w3.org/2000/svg","svg"),x=41,b=27;p.setAttributeNS(null,"display","block"),p.setAttributeNS(null,"height",`${x}px`),p.setAttributeNS(null,"width",`${b}px`),p.setAttributeNS(null,"viewBox",`0 0 ${b} ${x}`);const S=w.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"stroke","none"),S.setAttributeNS(null,"stroke-width","1"),S.setAttributeNS(null,"fill","none"),S.setAttributeNS(null,"fill-rule","evenodd");const A=w.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill-rule","nonzero");const M=w.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"transform","translate(3.0, 29.0)"),M.setAttributeNS(null,"fill","#000000");const L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ce of L){const je=w.createNS("http://www.w3.org/2000/svg","ellipse");je.setAttributeNS(null,"opacity","0.04"),je.setAttributeNS(null,"cx","10.5"),je.setAttributeNS(null,"cy","5.80029008"),je.setAttributeNS(null,"rx",Ce.rx),je.setAttributeNS(null,"ry",Ce.ry),M.appendChild(je)}const V=w.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"fill",this._color);const H=w.createNS("http://www.w3.org/2000/svg","path");H.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),V.appendChild(H);const G=w.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"opacity","0.25"),G.setAttributeNS(null,"fill","#000000");const ie=w.createNS("http://www.w3.org/2000/svg","path");ie.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),G.appendChild(ie);const le=w.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(6.0, 7.0)"),le.setAttributeNS(null,"fill","#FFFFFF");const he=w.createNS("http://www.w3.org/2000/svg","g");he.setAttributeNS(null,"transform","translate(8.0, 8.0)");const xe=w.createNS("http://www.w3.org/2000/svg","circle");xe.setAttributeNS(null,"fill","#000000"),xe.setAttributeNS(null,"opacity","0.25"),xe.setAttributeNS(null,"cx","5.5"),xe.setAttributeNS(null,"cy","5.5"),xe.setAttributeNS(null,"r","5.4999962");const Se=w.createNS("http://www.w3.org/2000/svg","circle");Se.setAttributeNS(null,"fill","#FFFFFF"),Se.setAttributeNS(null,"cx","5.5"),Se.setAttributeNS(null,"cy","5.5"),Se.setAttributeNS(null,"r","5.4999962"),he.appendChild(xe),he.appendChild(Se),A.appendChild(M),A.appendChild(V),A.appendChild(G),A.appendChild(le),A.appendChild(he),p.appendChild(A),p.setAttributeNS(null,"height",x*this._scale+"px"),p.setAttributeNS(null,"width",b*this._scale+"px"),this._element.appendChild(p),this._offset=o.P.convert(l&&l.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",p=>{p.preventDefault()}),this._element.addEventListener("mousedown",p=>{p.preventDefault()}),Gm(this._element,this._anchor,"marker"),l&&l.className)for(const p of l.className.split(" "))this._element.classList.add(p);this._popup=null}addTo(l){return this.remove(),this._map=l,this._element.setAttribute("aria-label",l._getUIString("Marker.Title")),l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),l.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),w.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=o.N.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const b=Math.abs(13.5)/Math.SQRT2;l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(38.1-13.5+b)],"bottom-right":[-b,-1*(38.1-13.5+b)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(l){return this._subpixelPositioning=l,this}getPopup(){return this._popup}togglePopup(){const l=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:l?(l.isOpen()?l.remove():(l.setLngLat(this._lngLat),l.addTo(this._map)),this):this}_updateOpacity(l=!1){var p,x;if(!(!((p=this._map)===null||p===void 0)&&p.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(l)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const b=this._map,S=b.terrain.depthAtPoint(this._pos),A=b.terrain.getElevationForLngLatZoom(this._lngLat,b.transform.tileZoom);if(b.transform.lngLatToCameraDepth(this._lngLat,A)-S<.006)return void(this._element.style.opacity=this._opacity);const M=-this._offset.y/b.transform._pixelPerMeter,L=Math.sin(b.getPitch()*Math.PI/180)*M,V=b.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),H=b.transform.lngLatToCameraDepth(this._lngLat,A+L)-V>.006;!((x=this._popup)===null||x===void 0)&&x.isOpen()&&H&&this._popup.remove(),this._element.style.opacity=H?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(l){return this._offset=o.P.convert(l),this._update(),this}addClassName(l){this._element.classList.add(l)}removeClassName(l){this._element.classList.remove(l)}toggleClassName(l){return this._element.classList.toggle(l)}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(l,p){return l===void 0&&p===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),l!==void 0&&(this._opacity=l),p!==void 0&&(this._opacityWhenCovered=p),this._map&&this._updateOpacity(!0),this}}const g_={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let qf=0,Qf=!1;const fl={maxWidth:100,unit:"metric"};function Hf(k,l,p){const x=p&&p.maxWidth||100,b=k._container.clientHeight/2,S=k.unproject([0,b]),A=k.unproject([x,b]),M=S.distanceTo(A);if(p&&p.unit==="imperial"){const L=3.2808*M;L>5280?or(l,x,L/5280,k._getUIString("ScaleControl.Miles")):or(l,x,L,k._getUIString("ScaleControl.Feet"))}else p&&p.unit==="nautical"?or(l,x,M/1852,k._getUIString("ScaleControl.NauticalMiles")):M>=1e3?or(l,x,M/1e3,k._getUIString("ScaleControl.Kilometers")):or(l,x,M,k._getUIString("ScaleControl.Meters"))}function or(k,l,p,x){const b=function(S){const A=Math.pow(10,`${Math.floor(S)}`.length-1);let M=S/A;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:function(L){const V=Math.pow(10,Math.ceil(-Math.log(L)/Math.LN10));return Math.round(L*V)/V}(M),A*M}(p);k.style.width=l*(b/p)+"px",k.innerHTML=`${b}&nbsp;${x}`}const _r={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Km=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Zm(k){if(k){if(typeof k=="number"){const l=Math.round(Math.abs(k)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,k),"top-left":new o.P(l,l),"top-right":new o.P(-l,l),bottom:new o.P(0,-k),"bottom-left":new o.P(l,-l),"bottom-right":new o.P(-l,-l),left:new o.P(k,0),right:new o.P(-k,0)}}if(k instanceof o.P||Array.isArray(k)){const l=o.P.convert(k);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:o.P.convert(k.center||[0,0]),top:o.P.convert(k.top||[0,0]),"top-left":o.P.convert(k["top-left"]||[0,0]),"top-right":o.P.convert(k["top-right"]||[0,0]),bottom:o.P.convert(k.bottom||[0,0]),"bottom-left":o.P.convert(k["bottom-left"]||[0,0]),"bottom-right":o.P.convert(k["bottom-right"]||[0,0]),left:o.P.convert(k.left||[0,0]),right:o.P.convert(k.right||[0,0])}}return Zm(new o.P(0,0))}const ux=d;a.AJAXError=o.bh,a.Evented=o.E,a.LngLat=o.N,a.MercatorCoordinate=o.Z,a.Point=o.P,a.addProtocol=o.bi,a.config=o.a,a.removeProtocol=o.bj,a.AttributionControl=Hh,a.BoxZoomHandler=Eo,a.CanvasSource=xn,a.CooperativeGesturesHandler=qh,a.DoubleClickZoomHandler=Fu,a.DragPanHandler=h_,a.DragRotateHandler=d_,a.EdgeInsets=Vh,a.FullscreenControl=class extends o.E{constructor(k={}){super(),this._onFullscreenChange=()=>{var l;let p=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((l=p==null?void 0:p.shadowRoot)===null||l===void 0)&&l.fullscreenElement;)p=p.shadowRoot.fullscreenElement;p===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,k&&k.container&&(k.container instanceof HTMLElement?this._container=k.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(k){return this._map=k,this._container||(this._container=this._map.getContainer()),this._controlContainer=w.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){w.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const k=this._fullscreenButton=w.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);w.create("span","maplibregl-ctrl-icon",k).setAttribute("aria-hidden","true"),k.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const k=this._getTitle();this._fullscreenButton.setAttribute("aria-label",k),this._fullscreenButton.title=k}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},a.GeoJSONSource=Kr,a.GeolocateControl=class extends o.E{constructor(k){super(),this._onSuccess=l=>{if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new o.k("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.k("geolocate",l)),this._finish()}},this._updateCamera=l=>{const p=new o.N(l.coords.longitude,l.coords.latitude),x=l.coords.accuracy,b=this._map.getBearing(),S=o.e({bearing:b},this.options.fitBoundsOptions),A=Te.fromLngLat(p,x);this._map.fitBounds(A,S,{geolocateSource:!0})},this._updateMarker=l=>{if(l){const p=new o.N(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(p).addTo(this._map),this._userLocationDotMarker.setLngLat(p).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=l=>{if(this._map){if(this.options.trackUserLocation)if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&Qf)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.k("error",l)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=w.create("button","maplibregl-ctrl-geolocate",this._container),w.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=l=>{if(this._map){if(l===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}else{const p=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=w.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Xm({element:this._dotElement}),this._circleElement=w.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Xm({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",p=>{p.geolocateSource||this._watchState!=="ACTIVE_LOCK"||p.originalEvent&&p.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.k("trackuserlocationend")),this.fire(new o.k("userlocationlostfocus")))})}},this.options=o.e({},g_,k)}onAdd(k){return this._map=k,this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return o._(this,arguments,void 0,function*(l=!1){if(zo!==void 0&&!l)return zo;if(window.navigator.permissions===void 0)return zo=!!window.navigator.geolocation,zo;try{zo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{zo=!!window.navigator.geolocation}return zo})}().then(l=>this._finishSetupUI(l)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),w.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,qf=0,Qf=!1}_isOutOfMapMaxBounds(k){const l=this._map.getMaxBounds(),p=k.coords;return l&&(p.longitude<l.getWest()||p.longitude>l.getEast()||p.latitude<l.getSouth()||p.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const k=this._map.getBounds(),l=k.getSouthEast(),p=k.getNorthEast(),x=l.distanceTo(p),b=Math.ceil(this._accuracy/(x/this._map._container.clientHeight)*2);this._circleElement.style.width=`${b}px`,this._circleElement.style.height=`${b}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":qf--,Qf=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.k("trackuserlocationstart")),this.fire(new o.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let k;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),qf++,qf>1?(k={maximumAge:6e5,timeout:0},Qf=!0):(k=this.options.positionOptions,Qf=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,k)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},a.Hash=Bm,a.ImageSource=an,a.KeyboardHandler=na,a.LngLatBounds=Te,a.LogoControl=sx,a.Map=class extends f_{constructor(k){o.bf.mark(o.bg.create);const l=Object.assign(Object.assign({},WC),k);if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Wh(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies),{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Zr,this._controls=[],this._mapId=o.a4(),this._contextLost=p=>{p.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.k("webglcontextlost",{originalEvent:p}))},this._contextRestored=p=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.k("webglcontextrestored",{originalEvent:p}))},this._onMapScroll=p=>{if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=l.preserveDrawingBuffer===!0,this._antialias=l.antialias===!0,this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},lx),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=D.addThrottleControl(()=>this.isMoving()),this._requestManager=new U(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let p=!1;const x=Bf(b=>{this._trackResize&&!this._removed&&(this.resize(b),this.redraw())},50);this._resizeObserver=new ResizeObserver(b=>{p?x(b):p=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ix(this,l),this._hash=l.hash&&new Bm(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,o.e({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new Hh(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new sx,l.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",p=>{this._update(p.dataType==="style"),this.fire(new o.k(`${p.dataType}data`,p))}),this.on("dataloading",p=>{this.fire(new o.k(`${p.dataType}dataloading`,p))}),this.on("dataabort",p=>{this.fire(new o.k("sourcedataabort",p))})}_getMapId(){return this._mapId}addControl(k,l){if(l===void 0&&(l=k.getDefaultPosition?k.getDefaultPosition():"top-right"),!k||!k.onAdd)return this.fire(new o.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=k.onAdd(this);this._controls.push(k);const x=this._controlPositions[l];return l.indexOf("bottom")!==-1?x.insertBefore(p,x.firstChild):x.appendChild(p),this}removeControl(k){if(!k||!k.onRemove)return this.fire(new o.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(k);return l>-1&&this._controls.splice(l,1),k.onRemove(this),this}hasControl(k){return this._controls.indexOf(k)>-1}calculateCameraOptionsFromTo(k,l,p,x){return x==null&&this.terrain&&(x=this.terrain.getElevationForLngLatZoom(p,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(k,l,p,x)}resize(k){var l;const p=this._containerDimensions(),x=p[0],b=p[1],S=this._getClampedPixelRatio(x,b);if(this._resizeCanvas(x,b,S),this.painter.resize(x,b,S),this.painter.overLimit()){const M=this.painter.context.gl;this._maxCanvasSize=[M.drawingBufferWidth,M.drawingBufferHeight];const L=this._getClampedPixelRatio(x,b);this._resizeCanvas(x,b,L),this.painter.resize(x,b,L)}this.transform.resize(x,b),(l=this._requestedCameraState)===null||l===void 0||l.resize(x,b);const A=!this._moving;return A&&(this.stop(),this.fire(new o.k("movestart",k)).fire(new o.k("move",k))),this.fire(new o.k("resize",k)),A&&this.fire(new o.k("moveend",k)),this}_getClampedPixelRatio(k,l){const{0:p,1:x}=this._maxCanvasSize,b=this.getPixelRatio(),S=k*b,A=l*b;return Math.min(S>p?p/S:1,A>x?x/A:1)*b}getPixelRatio(){var k;return(k=this._overridePixelRatio)!==null&&k!==void 0?k:devicePixelRatio}setPixelRatio(k){this._overridePixelRatio=k,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(k){return this.transform.setMaxBounds(Te.convert(k)),this._update()}setMinZoom(k){if((k=k??-2)>=-2&&k<=this.transform.maxZoom)return this.transform.minZoom=k,this._update(),this.getZoom()<k&&this.setZoom(k),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(k){if((k=k??22)>=this.transform.minZoom)return this.transform.maxZoom=k,this._update(),this.getZoom()>k&&this.setZoom(k),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(k){if((k=k??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(k>=0&&k<=this.transform.maxPitch)return this.transform.minPitch=k,this._update(),this.getPitch()<k&&this.setPitch(k),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(k){if((k=k??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(k>=this.transform.minPitch)return this.transform.maxPitch=k,this._update(),this.getPitch()>k&&this.setPitch(k),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(k){return this.transform.renderWorldCopies=k,this._update()}project(k){return this.transform.locationPoint(o.N.convert(k),this.style&&this.terrain)}unproject(k){return this.transform.pointLocation(o.P.convert(k),this.terrain)}isMoving(){var k;return this._moving||((k=this.handlers)===null||k===void 0?void 0:k.isMoving())}isZooming(){var k;return this._zooming||((k=this.handlers)===null||k===void 0?void 0:k.isZooming())}isRotating(){var k;return this._rotating||((k=this.handlers)===null||k===void 0?void 0:k.isRotating())}_createDelegatedListener(k,l,p){if(k==="mouseenter"||k==="mouseover"){let x=!1;return{layers:l,listener:p,delegates:{mousemove:S=>{const A=l.filter(L=>this.getLayer(L)),M=A.length!==0?this.queryRenderedFeatures(S.point,{layers:A}):[];M.length?x||(x=!0,p.call(this,new Ps(k,this,S.originalEvent,{features:M}))):x=!1},mouseout:()=>{x=!1}}}}if(k==="mouseleave"||k==="mouseout"){let x=!1;return{layers:l,listener:p,delegates:{mousemove:A=>{const M=l.filter(L=>this.getLayer(L));(M.length!==0?this.queryRenderedFeatures(A.point,{layers:M}):[]).length?x=!0:x&&(x=!1,p.call(this,new Ps(k,this,A.originalEvent)))},mouseout:A=>{x&&(x=!1,p.call(this,new Ps(k,this,A.originalEvent)))}}}}{const x=b=>{const S=l.filter(M=>this.getLayer(M)),A=S.length!==0?this.queryRenderedFeatures(b.point,{layers:S}):[];A.length&&(b.features=A,p.call(this,b),delete b.features)};return{layers:l,listener:p,delegates:{[k]:x}}}}_saveDelegatedListener(k,l){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[k]=this._delegatedListeners[k]||[],this._delegatedListeners[k].push(l)}_removeDelegatedListener(k,l,p){if(!this._delegatedListeners||!this._delegatedListeners[k])return;const x=this._delegatedListeners[k];for(let b=0;b<x.length;b++){const S=x[b];if(S.listener===p&&S.layers.length===l.length&&S.layers.every(A=>l.includes(A))){for(const A in S.delegates)this.off(A,S.delegates[A]);return void x.splice(b,1)}}}on(k,l,p){if(p===void 0)return super.on(k,l);const x=this._createDelegatedListener(k,typeof l=="string"?[l]:l,p);this._saveDelegatedListener(k,x);for(const b in x.delegates)this.on(b,x.delegates[b]);return this}once(k,l,p){if(p===void 0)return super.once(k,l);const x=typeof l=="string"?[l]:l,b=this._createDelegatedListener(k,x,p);for(const S in b.delegates){const A=b.delegates[S];b.delegates[S]=(...M)=>{this._removeDelegatedListener(k,x,p),A(...M)}}this._saveDelegatedListener(k,b);for(const S in b.delegates)this.once(S,b.delegates[S]);return this}off(k,l,p){return p===void 0?super.off(k,l):(this._removeDelegatedListener(k,typeof l=="string"?[l]:l,p),this)}queryRenderedFeatures(k,l){if(!this.style)return[];let p;const x=k instanceof o.P||Array.isArray(k),b=x?k:[[0,0],[this.transform.width,this.transform.height]];if(l=l||(x?{}:k)||{},b instanceof o.P||typeof b[0]=="number")p=[o.P.convert(b)];else{const S=o.P.convert(b[0]),A=o.P.convert(b[1]);p=[S,new o.P(A.x,S.y),A,new o.P(S.x,A.y),S]}return this.style.queryRenderedFeatures(p,l,this.transform)}querySourceFeatures(k,l){return this.style.querySourceFeatures(k,l)}setStyle(k,l){return(l=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&k?(this._diffStyle(k,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(k,l))}setTransformRequest(k){return this._requestManager.setTransformRequest(k),this}_getUIString(k){const l=this._locale[k];if(l==null)throw new Error(`Missing UI string '${k}'`);return l}_updateStyle(k,l){if(l.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(k,l));const p=this.style&&l.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!k)),k?(this.style=new Ac(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof k=="string"?this.style.loadURL(k,l,p):this.style.loadJSON(k,l,p),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ac(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(k,l){if(typeof k=="string"){const p=this._requestManager.transformRequest(k,"Style");o.h(p,new AbortController).then(x=>{this._updateDiff(x.data,l)}).catch(x=>{x&&this.fire(new o.j(x))})}else typeof k=="object"&&this._updateDiff(k,l)}_updateDiff(k,l){try{this.style.setState(k,l)&&this._update(!0)}catch(p){o.w(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(k,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(k,l){return this._lazyInitEmptyStyle(),this.style.addSource(k,l),this._update(!0)}isSourceLoaded(k){const l=this.style&&this.style.sourceCaches[k];if(l!==void 0)return l.loaded();this.fire(new o.j(new Error(`There is no source with ID '${k}'`)))}setTerrain(k){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),k){const l=this.style.sourceCaches[k.source];if(!l)throw new Error(`cannot load terrain, because there exists no source with ID: ${k.source}`);this.terrain===null&&l.reload();for(const p in this.style._layers){const x=this.style._layers[p];x.type==="hillshade"&&x.source===k.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ax(this.painter,l,k),this.painter.renderToTexture=new p_(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=p=>{p.dataType==="style"?this.terrain.sourceCache.freeRtt():p.dataType==="source"&&p.tile&&(p.sourceId!==k.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(p.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new o.k("terrain",{terrain:k})),this}getTerrain(){var k,l;return(l=(k=this.terrain)===null||k===void 0?void 0:k.options)!==null&&l!==void 0?l:null}areTilesLoaded(){const k=this.style&&this.style.sourceCaches;for(const l in k){const p=k[l]._tiles;for(const x in p){const b=p[x];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}removeSource(k){return this.style.removeSource(k),this._update(!0)}getSource(k){return this.style.getSource(k)}addImage(k,l,p={}){const{pixelRatio:x=1,sdf:b=!1,stretchX:S,stretchY:A,content:M,textFitWidth:L,textFitHeight:V}=p;if(this._lazyInitEmptyStyle(),!(l instanceof HTMLImageElement||o.b(l))){if(l.width===void 0||l.height===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:H,height:G,data:ie}=l,le=l;return this.style.addImage(k,{data:new o.R({width:H,height:G},new Uint8Array(ie)),pixelRatio:x,stretchX:S,stretchY:A,content:M,textFitWidth:L,textFitHeight:V,sdf:b,version:0,userImage:le}),le.onAdd&&le.onAdd(this,k),this}}{const{width:H,height:G,data:ie}=v.getImageData(l);this.style.addImage(k,{data:new o.R({width:H,height:G},ie),pixelRatio:x,stretchX:S,stretchY:A,content:M,textFitWidth:L,textFitHeight:V,sdf:b,version:0})}}updateImage(k,l){const p=this.style.getImage(k);if(!p)return this.fire(new o.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=l instanceof HTMLImageElement||o.b(l)?v.getImageData(l):l,{width:b,height:S,data:A}=x;if(b===void 0||S===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==p.data.width||S!==p.data.height)return this.fire(new o.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const M=!(l instanceof HTMLImageElement||o.b(l));return p.data.replace(A,M),this.style.updateImage(k,p),this}getImage(k){return this.style.getImage(k)}hasImage(k){return k?!!this.style.getImage(k):(this.fire(new o.j(new Error("Missing required image id"))),!1)}removeImage(k){this.style.removeImage(k)}loadImage(k){return D.getImage(this._requestManager.transformRequest(k,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(k,l){return this._lazyInitEmptyStyle(),this.style.addLayer(k,l),this._update(!0)}moveLayer(k,l){return this.style.moveLayer(k,l),this._update(!0)}removeLayer(k){return this.style.removeLayer(k),this._update(!0)}getLayer(k){return this.style.getLayer(k)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(k,l,p){return this.style.setLayerZoomRange(k,l,p),this._update(!0)}setFilter(k,l,p={}){return this.style.setFilter(k,l,p),this._update(!0)}getFilter(k){return this.style.getFilter(k)}setPaintProperty(k,l,p,x={}){return this.style.setPaintProperty(k,l,p,x),this._update(!0)}getPaintProperty(k,l){return this.style.getPaintProperty(k,l)}setLayoutProperty(k,l,p,x={}){return this.style.setLayoutProperty(k,l,p,x),this._update(!0)}getLayoutProperty(k,l){return this.style.getLayoutProperty(k,l)}setGlyphs(k,l={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(k,l),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(k,l,p={}){return this._lazyInitEmptyStyle(),this.style.addSprite(k,l,p,x=>{x||this._update(!0)}),this}removeSprite(k){return this._lazyInitEmptyStyle(),this.style.removeSprite(k),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(k,l={}){return this._lazyInitEmptyStyle(),this.style.setSprite(k,l,p=>{p||this._update(!0)}),this}setLight(k,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(k,l),this._update(!0)}getLight(){return this.style.getLight()}setSky(k){return this._lazyInitEmptyStyle(),this.style.setSky(k),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(k,l){return this.style.setFeatureState(k,l),this._update()}removeFeatureState(k,l){return this.style.removeFeatureState(k,l),this._update()}getFeatureState(k){return this.style.getFeatureState(k)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let k=0,l=0;return this._container&&(k=this._container.clientWidth||400,l=this._container.clientHeight||300),[k,l]}_setupContainer(){const k=this._container;k.classList.add("maplibregl-map");const l=this._canvasContainer=w.create("div","maplibregl-canvas-container",k);this._interactive&&l.classList.add("maplibregl-interactive"),this._canvas=w.create("canvas","maplibregl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const p=this._containerDimensions(),x=this._getClampedPixelRatio(p[0],p[1]);this._resizeCanvas(p[0],p[1],x);const b=this._controlContainer=w.create("div","maplibregl-control-container",k),S=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(A=>{S[A]=w.create("div",`maplibregl-ctrl-${A} `,b)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(k,l,p){this._canvas.width=Math.floor(p*k),this._canvas.height=Math.floor(p*l),this._canvas.style.width=`${k}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const k={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let l=null;this._canvas.addEventListener("webglcontextcreationerror",x=>{l={requestedAttributes:k},x&&(l.statusMessage=x.statusMessage,l.type=x.type)},{once:!0});const p=this._canvas.getContext("webgl2",k)||this._canvas.getContext("webgl",k);if(!p){const x="Failed to initialize WebGL";throw l?(l.message=x,new Error(JSON.stringify(l))):new Error(x)}this.painter=new Fm(p,this.transform),O.testSupport(p)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(k){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||k,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(k){return this._update(),this._renderTaskQueue.add(k)}_cancelRenderFrame(k){this._renderTaskQueue.remove(k)}_render(k){const l=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(k),this._removed)return;let p=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const b=this.transform.zoom,S=v.now();this.style.zoomHistory.update(b,S);const A=new o.z(b,{now:S,fadeDuration:l,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),M=A.crossFadingFactor();M===1&&M===this._crossFadingFactor||(p=!0,this._crossFadingFactor=M),this.style.update(A)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,l,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:l,showPadding:this.showPadding}),this.fire(new o.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.bf.mark(o.bg.load),this.fire(new o.k("load"))),this.style&&(this.style.hasTransitions()||p)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const x=this._sourcesDirty||this._styleDirty||this._placementDirty;return x||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.k("idle")),!this._loaded||this._fullyLoaded||x||(this._fullyLoaded=!0,o.bf.mark(o.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var k;this._hash&&this._hash.remove();for(const p of this._controls)p.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),D.removeThrottleControl(this._imageQueueHandle),(k=this._resizeObserver)===null||k===void 0||k.disconnect();const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l!=null&&l.loseContext&&l.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),w.remove(this._canvasContainer),w.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),o.bf.clearMetrics(),this._removed=!0,this.fire(new o.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,v.frameAsync(this._frameRequest).then(k=>{o.bf.frame(k),this._frameRequest=null,this._render(k)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(k){this._showTileBoundaries!==k&&(this._showTileBoundaries=k,this._update())}get showPadding(){return!!this._showPadding}set showPadding(k){this._showPadding!==k&&(this._showPadding=k,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(k){this._showCollisionBoxes!==k&&(this._showCollisionBoxes=k,k?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(k){this._showOverdrawInspector!==k&&(this._showOverdrawInspector=k,this._update())}get repaint(){return!!this._repaint}set repaint(k){this._repaint!==k&&(this._repaint=k,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(k){this._vertices=k,this._update()}get version(){return m_}getCameraTargetElevation(){return this.transform.elevation}},a.MapMouseEvent=Ps,a.MapTouchEvent=Du,a.MapWheelEvent=l_,a.Marker=Xm,a.NavigationControl=class{constructor(k){this._updateZoomButtons=()=>{const l=this._map.getZoom(),p=l===this._map.getMaxZoom(),x=l===this._map.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())},this._rotateCompassArrow=()=>{const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=l},this._setButtonTitle=(l,p)=>{const x=this._map._getUIString(`NavigationControl.${p}`);l.title=x,l.setAttribute("aria-label",x)},this.options=o.e({},UC,k),this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),w.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),w.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=w.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(k){return this._map=k,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qC(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){w.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(k,l){const p=w.create("button",k,this._container);return p.type="button",p.addEventListener("click",l),p}},a.Popup=class extends o.E{constructor(k){super(),this.remove=()=>(this._content&&w.remove(this._content),this._container&&(w.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.k("close"))),this),this._onMouseUp=l=>{this._update(l.point)},this._onMouseMove=l=>{this._update(l.point)},this._onDrag=l=>{this._update(l.point)},this._update=l=>{var p;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=w.create("div","maplibregl-popup",this._map.getContainer()),this._tip=w.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const M of this.options.className.split(" "))this._container.classList.add(M);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?qn(this._lngLat,this._flatPos,this._map.transform):(p=this._lngLat)===null||p===void 0?void 0:p.wrap(),this._trackPointer&&!l)return;const x=this._flatPos=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&l?l:this._map.transform.locationPoint(this._lngLat));let b=this.options.anchor;const S=Zm(this.options.offset);if(!b){const M=this._container.offsetWidth,L=this._container.offsetHeight;let V;V=x.y+S.bottom.y<L?["top"]:x.y>this._map.transform.height-L?["bottom"]:[],x.x<M/2?V.push("left"):x.x>this._map.transform.width-M/2&&V.push("right"),b=V.length===0?"bottom":V.join("-")}let A=x.add(S[b]);this.options.subpixelPositioning||(A=A.round()),w.setTransform(this._container,`${Xh[b]} translate(${A.x}px,${A.y}px)`),Gm(this._container,b,"popup")},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(_r),k)}addTo(k){return this._map&&this.remove(),this._map=k,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(k){return this._lngLat=o.N.convert(k),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(k){return this.setDOMContent(document.createTextNode(k))}setHTML(k){const l=document.createDocumentFragment(),p=document.createElement("body");let x;for(p.innerHTML=k;x=p.firstChild,x;)l.appendChild(x);return this.setDOMContent(l)}getMaxWidth(){var k;return(k=this._container)===null||k===void 0?void 0:k.style.maxWidth}setMaxWidth(k){return this.options.maxWidth=k,this._update(),this}setDOMContent(k){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=w.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(k),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(k){return this._container&&this._container.classList.add(k),this}removeClassName(k){return this._container&&this._container.classList.remove(k),this}setOffset(k){return this.options.offset=k,this._update(),this}toggleClassName(k){if(this._container)return this._container.classList.toggle(k)}setSubpixelPositioning(k){this.options.subpixelPositioning=k}_createCloseButton(){this.options.closeButton&&(this._closeButton=w.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const k=this._container.querySelector(Km);k&&k.focus()}},a.RasterDEMTileSource=Ft,a.RasterTileSource=wt,a.ScaleControl=class{constructor(k){this._onMove=()=>{Hf(this._map,this._container,this.options)},this.setUnit=l=>{this.options.unit=l,Hf(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},fl),k)}getDefaultPosition(){return"bottom-left"}onAdd(k){return this._map=k,this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-scale",k.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){w.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},a.ScrollZoomHandler=Da,a.Style=Ac,a.TerrainControl=class{constructor(k){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=k}onAdd(k){return this._map=k,this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=w.create("button","maplibregl-ctrl-terrain",this._container),w.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){w.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},a.TwoFingersTouchPitchHandler=Uf,a.TwoFingersTouchRotateHandler=tx,a.TwoFingersTouchZoomHandler=J0,a.TwoFingersTouchZoomRotateHandler=nx,a.VectorTileSource=Vt,a.VideoSource=Cn,a.addSourceType=(k,l)=>o._(void 0,void 0,void 0,function*(){if(Pi(k))throw new Error(`A source type called "${k}" already exists.`);((p,x)=>{di[p]=x})(k,l)}),a.clearPrewarmedResources=function(){const k=Ke;k&&(k.isPreloaded()&&k.numActive()===1?(k.release(st),Ke=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},a.getRTLTextPluginStatus=function(){return Ut().getRTLTextPluginStatus()},a.getVersion=function(){return ux},a.getWorkerCount=function(){return Re.workerCount},a.getWorkerUrl=function(){return o.a.WORKER_URL},a.importScriptInWorkers=function(k){return xt().broadcast("IS",k)},a.prewarm=function(){Mt().acquire(st)},a.setMaxParallelImageRequests=function(k){o.a.MAX_PARALLEL_IMAGE_REQUESTS=k},a.setRTLTextPlugin=function(k,l){return Ut().setRTLTextPlugin(k,l)},a.setWorkerCount=function(k){Re.workerCount=k},a.setWorkerUrl=function(k){o.a.WORKER_URL=k}});var s=r;return s})})(CU);var g1e=CU.exports;const nj=s1(g1e);function y1e({geoserverUrl:t,workspace:e,layerName:r,styleName:n,size:i=20}){const[s,a]=I.useState(!1),o=`${t}/${e}/wms?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetLegendGraphic&LAYER=${e}:${r}&STYLE=${n}&FORMAT=image/png&WIDTH=${i}&HEIGHT=${i}&LEGEND_OPTIONS=forceLabels:off;fontAntiAliasing:true`;return s?u.jsx(ze,{as:Wo,color:"pink.500",boxSize:`${i}px`}):u.jsx(ue,{as:"img",src:o,alt:n,w:`${i}px`,h:`${i}px`,minW:`${i}px`,minH:`${i}px`,borderRadius:"sm",objectFit:"contain",bg:"white",border:"1px solid",borderColor:"gray.200",onError:()=>a(!0)})}function x1e({previewUrl:t,layerName:e,workspace:r,storeName:n,storeType:i,layerType:s,connectionId:a,onClose:o}){const d=I.useRef(null),m=I.useRef(null),y=I.useRef(null),[v,w]=I.useState(!1),[O,P]=I.useState(null),[E,$]=I.useState(null),[R,F]=I.useState(!1),[D,U]=I.useState(!1),[X,ee]=I.useState("2d"),[K,Y]=I.useState([]),[ne,oe]=I.useState(""),[ce,Xe]=I.useState(""),Ae=Bt("white","gray.800"),We=Bt("gray.200","gray.600"),Ye=Bt("gray.50","gray.700"),tt=bt(Oe=>Oe.setPreviewMode);I.useEffect(()=>{t&&(console.log("[MapPreview] Fetching layer info from:",`${t}/api/layer`),fetch(`${t}/api/layer`).then(Oe=>Oe.json()).then(Oe=>{console.log("[MapPreview] Received layer info:",Oe),$(Oe)}).catch(Oe=>{console.error("[MapPreview] Failed to fetch layer info:",Oe)}))},[t]),I.useEffect(()=>{t&&(console.log("[MapPreview] Fetching metadata from:",`${t}/api/metadata`),F(!0),fetch(`${t}/api/metadata`).then(Oe=>Oe.json()).then(Oe=>{console.log("[MapPreview] Received metadata:",Oe),P(Oe),F(!1)}).catch(Oe=>{console.error("[MapPreview] Failed to fetch metadata:",Oe),F(!1)}))},[t]),I.useEffect(()=>{a&&r&&e&&pU(a,r,e).then(Oe=>{const Ie=[Oe.defaultStyle,...Oe.additionalStyles||[]];Y(Ie.filter(Boolean)),Xe(Oe.defaultStyle||""),oe(Oe.defaultStyle||"")}).catch(Oe=>{console.error("Failed to fetch layer styles:",Oe)})},[a,r,e]);const Be=(Oe,Ie)=>!(Oe[2]<Ie[0]||Ie[2]<Oe[0]||Oe[3]<Ie[1]||Ie[3]<Oe[1]),Me=Oe=>{if(!m.current)return!1;const Ie=m.current.getBounds(),st=[Ie.getWest(),Ie.getSouth(),Ie.getEast(),Ie.getNorth()];return Be(st,Oe)},Ge=(Oe,Ie)=>{const st=`${Oe.workspace}:${Oe.name}`;if(Oe.use_cache){const Ke=Oe.grid_set||"EPSG:900913",St=Oe.tile_format||"image/png";return`${Oe.geoserver_url}/gwc/service/wmts/rest/${encodeURIComponent(st)}/${Ke}/${encodeURIComponent(St)}/{z}/{y}/{x}`}const Re=`${Oe.geoserver_url}/${Oe.workspace}/wms`,it=new URLSearchParams({SERVICE:"WMS",VERSION:"1.1.1",REQUEST:"GetMap",LAYERS:st,FORMAT:"image/png",TRANSPARENT:"true",SRS:"EPSG:3857",WIDTH:"256",HEIGHT:"256"});return Ie&&it.set("STYLES",Ie),`${Re}?${it.toString()}&BBOX={bbox-epsg-3857}`};I.useEffect(()=>{if(!d.current||!E)return;const Oe=O!=null&&O.latlon_bbox?[O.latlon_bbox.minx,O.latlon_bbox.miny,O.latlon_bbox.maxx,O.latlon_bbox.maxy]:[-180,-85,180,85],Ie=[(Oe[0]+Oe[2])/2,(Oe[1]+Oe[3])/2];return m.current=new nj.Map({container:d.current,style:{version:8,sources:{osm:{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:" OpenStreetMap contributors"}},layers:[{id:"osm-tiles",type:"raster",source:"osm",minzoom:0,maxzoom:19}]},center:Ie,zoom:2}),m.current.addControl(new nj.NavigationControl,"top-right"),m.current.addControl(new nj.ScaleControl,"bottom-left"),m.current.on("load",()=>{U(!0)}),()=>{m.current&&(m.current.remove(),m.current=null,U(!1))}},[E]),I.useEffect(()=>{if(!m.current||!D||!E)return;const Oe=Ge(E,ne);if(console.log("[MapPreview] Layer info:",{workspace:E.workspace,name:E.name,geoserver_url:E.geoserver_url,store_type:E.store_type,type:E.type,use_cache:E.use_cache}),console.log("[MapPreview] WMS tile URL template:",Oe),console.log("[MapPreview] Current style:",ne||"(default)"),m.current.getLayer("wms-layer")&&m.current.removeLayer("wms-layer"),m.current.getSource("wms-layer")&&m.current.removeSource("wms-layer"),m.current.addSource("wms-layer",{type:"raster",tiles:[Oe],tileSize:256}),m.current.addLayer({id:"wms-layer",type:"raster",source:"wms-layer",paint:{"raster-opacity":1}}),O!=null&&O.latlon_bbox){const Ie=[O.latlon_bbox.minx,O.latlon_bbox.miny,O.latlon_bbox.maxx,O.latlon_bbox.maxy];console.log("[MapPreview] Layer bounds (lat/lon):",Ie);const st=!Me(Ie);console.log("[MapPreview] Should fit to bounds:",st),st&&m.current.fitBounds(Ie,{padding:50,maxZoom:15}),y.current=Ie}else console.log("[MapPreview] No bounds available in metadata")},[D,E,ne,O==null?void 0:O.latlon_bbox]),I.useEffect(()=>{if(!(!m.current||!D))switch(X){case"2d":m.current.easeTo({pitch:0,bearing:0,duration:500}),m.current.setMaxPitch(0);break;case"3d":m.current.setMaxPitch(85),m.current.easeTo({pitch:45,duration:500});break}},[X,D]);const De=()=>{if(!m.current||!D||!E)return;const Oe=Ge(E,ne);m.current.getLayer("wms-layer")&&m.current.removeLayer("wms-layer"),m.current.getSource("wms-layer")&&m.current.removeSource("wms-layer");const Ie=`&_t=${Date.now()}`;m.current.addSource("wms-layer",{type:"raster",tiles:[Oe+Ie],tileSize:256}),m.current.addLayer({id:"wms-layer",type:"raster",source:"wms-layer",paint:{"raster-opacity":1}})},Le=Oe=>{oe(Oe)};return t?u.jsxs(Rr,{bg:Ae,overflow:"hidden",h:"100%",display:"flex",flexDirection:"column",children:[u.jsx(ue,{bg:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",color:"white",px:4,py:3,children:u.jsxs(fe,{justify:"space-between",children:[u.jsxs(lt,{align:"start",spacing:0,children:[u.jsxs(fe,{children:[u.jsx(pn,{size:"sm",color:"white",children:"Layer Preview"}),u.jsx(Qt,{colorScheme:"whiteAlpha",variant:"solid",fontSize:"xs",children:s==="raster"?"Raster":"Vector"})]}),u.jsxs(J,{fontSize:"xs",color:"whiteAlpha.800",children:[r,":",e]})]}),u.jsxs(fe,{spacing:2,children:[K.length>0&&u.jsxs(sf,{children:[u.jsx(of,{as:gt,size:"sm",variant:"solid",bg:"whiteAlpha.200",color:"white",_hover:{bg:"whiteAlpha.300"},_active:{bg:"whiteAlpha.400"},rightIcon:u.jsx(Ul,{}),leftIcon:u.jsx(Wo,{}),maxW:"180px",children:u.jsx(J,{isTruncated:!0,fontSize:"xs",children:ne||"Default Style"})}),u.jsx(af,{color:"gray.800",zIndex:1e3,children:K.map(Oe=>u.jsx(xa,{onClick:()=>Le(Oe),fontWeight:ne===Oe?"bold":"normal",bg:ne===Oe?"kartoza.50":void 0,children:u.jsxs(fe,{children:[E!=null&&E.geoserver_url?u.jsx(y1e,{geoserverUrl:E.geoserver_url,workspace:r,layerName:e,styleName:Oe,size:20}):u.jsx(ze,{as:Wo,color:"pink.500"}),u.jsx(J,{children:Oe}),Oe===ce&&u.jsx(Qt,{colorScheme:"kartoza",size:"sm",ml:2,children:"Default"})]})},Oe))})]}),u.jsxs(Yk,{size:"sm",isAttached:!0,variant:"ghost",children:[u.jsx(wr,{label:"2D View",children:u.jsx(gr,{"aria-label":"2D",icon:u.jsx(Sc,{}),color:"white",bg:X==="2d"?"whiteAlpha.300":void 0,_hover:{bg:"whiteAlpha.200"},onClick:()=>ee("2d")})}),u.jsx(wr,{label:"3D View (tilt)",children:u.jsx(gr,{"aria-label":"3D",icon:u.jsx(PM,{}),color:"white",bg:X==="3d"?"whiteAlpha.300":void 0,_hover:{bg:"whiteAlpha.200"},onClick:()=>ee("3d")})})]}),u.jsx(wr,{label:"3D Globe (Cesium)",children:u.jsx(gr,{"aria-label":"3D Globe",icon:u.jsx(xs,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:()=>tt("3d")})}),u.jsx(Nr,{orientation:"vertical",h:"24px",borderColor:"whiteAlpha.400"}),u.jsx(wr,{label:"Refresh",children:u.jsx(gr,{"aria-label":"Refresh",icon:u.jsx(Su,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:De})}),u.jsx(wr,{label:"Layer Info",children:u.jsx(gr,{"aria-label":"Layer Info",icon:u.jsx(I1,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:()=>w(!v),bg:v?"whiteAlpha.200":void 0})}),o&&u.jsx(wr,{label:"Close Preview",children:u.jsx(gr,{"aria-label":"Close",icon:u.jsx(hf,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:o})})]})]})}),ne&&K.length>1&&u.jsx(ue,{px:4,py:2,bg:"kartoza.50",borderBottom:"1px solid",borderColor:We,children:u.jsxs(fe,{fontSize:"sm",children:[u.jsx(ze,{as:Wo,color:"pink.500"}),u.jsxs(J,{color:"gray.600",children:["Style: ",u.jsx(J,{as:"span",fontWeight:"600",children:ne}),ne===ce&&u.jsx(Qt,{ml:2,colorScheme:"kartoza",size:"sm",children:"Default"})]}),K.length>1&&u.jsxs(sf,{children:[u.jsx(of,{as:gt,size:"xs",variant:"ghost",rightIcon:u.jsx(Ul,{}),ml:"auto",children:"Change"}),u.jsx(af,{children:K.map(Oe=>u.jsx(xa,{onClick:()=>Le(Oe),fontWeight:ne===Oe?"bold":"normal",children:u.jsxs(fe,{children:[u.jsx(ze,{as:Wo,color:"pink.500"}),u.jsx(J,{children:Oe}),Oe===ce&&u.jsx(Qt,{colorScheme:"kartoza",size:"sm",children:"Default"})]})},Oe))})]})]})}),u.jsx(bc,{in:v,animateOpacity:!0,children:u.jsx(ue,{bg:Ye,p:4,borderBottom:"1px solid",borderColor:We,children:R?u.jsxs(fe,{justify:"center",py:4,children:[u.jsx(kn,{size:"sm",color:"kartoza.500"}),u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Loading metadata..."})]}):O?u.jsxs(Wr,{columns:{base:1,md:2,lg:3},spacing:4,children:[O.layer_title&&u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",fontWeight:"500",children:"Title"}),u.jsx(J,{fontSize:"sm",children:O.layer_title})]}),O.layer_srs&&u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",fontWeight:"500",children:"SRS"}),u.jsx(J,{fontSize:"sm",fontFamily:"mono",children:O.layer_srs})]}),O.store_format&&u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",fontWeight:"500",children:"Format"}),u.jsx(J,{fontSize:"sm",children:O.store_format})]}),O.latlon_bbox&&u.jsxs(ue,{gridColumn:{md:"span 2",lg:"span 3"},children:[u.jsx(J,{fontSize:"xs",color:"gray.500",fontWeight:"500",children:"Bounding Box (WGS84)"}),u.jsxs(J,{fontSize:"sm",fontFamily:"mono",children:["[",O.latlon_bbox.minx.toFixed(4),", ",O.latlon_bbox.miny.toFixed(4),"] - [",O.latlon_bbox.maxx.toFixed(4),", ",O.latlon_bbox.maxy.toFixed(4),"]"]})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",fontWeight:"500",children:"Status"}),u.jsxs(fe,{spacing:2,mt:1,children:[O.layer_enabled!==void 0&&u.jsx(Qt,{colorScheme:O.layer_enabled?"green":"gray",size:"sm",children:O.layer_enabled?"Enabled":"Disabled"}),O.layer_queryable!==void 0&&O.layer_queryable&&u.jsx(Qt,{colorScheme:"blue",size:"sm",children:"Queryable"}),O.layer_advertised!==void 0&&O.layer_advertised&&u.jsx(Qt,{colorScheme:"purple",size:"sm",children:"Advertised"})]})]}),O.layer_abstract&&u.jsxs(ue,{gridColumn:{md:"span 2",lg:"span 3"},children:[u.jsx(J,{fontSize:"xs",color:"gray.500",fontWeight:"500",children:"Abstract"}),u.jsx(J,{fontSize:"sm",noOfLines:3,children:O.layer_abstract})]})]}):u.jsx(J,{fontSize:"sm",color:"gray.500",children:"No metadata available"})})}),u.jsxs(ue,{flex:"1",minH:"300px",position:"relative",bg:"gray.100",children:[u.jsx(ue,{ref:d,position:"absolute",top:0,left:0,right:0,bottom:0}),!D&&u.jsxs(ue,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",children:[u.jsx(kn,{size:"xl",color:"kartoza.500"}),u.jsx(J,{mt:2,color:"gray.600",children:"Loading map..."})]})]}),u.jsx(ue,{px:4,py:2,bg:Ye,borderTop:"1px solid",borderColor:We,children:u.jsxs(fe,{justify:"space-between",fontSize:"xs",color:"gray.500",children:[u.jsxs(J,{children:["Store: ",n||"N/A"," (",i||"unknown",")"]}),u.jsxs(fe,{spacing:4,children:[u.jsxs(Qt,{colorScheme:X==="2d"?"blue":X==="3d"?"purple":"green",children:[X.toUpperCase()," Mode"]}),u.jsxs(J,{children:["Zoom with scroll, drag to pan",X!=="2d"&&", Ctrl+drag to rotate"]})]})]})})]}):null}Cesium.Ion.defaultAccessToken="";function v1e({connectionId:t,workspace:e,layerName:r,nodeType:n="layer",onClose:i}){const s=I.useRef(null),a=I.useRef(null),[o,d]=I.useState(!0),[m,y]=I.useState("3d"),[v,w]=I.useState([]),[O,P]=I.useState(null),[E,$]=I.useState(!1),[R,F]=I.useState(0),D=Bt("white","gray.800"),U=Bt("gray.200","gray.600"),X=Bt("gray.50","gray.700"),ee=bt(Ae=>Ae.setPreviewMode),K=bt(Ae=>Ae.setPreview),Y=async()=>{try{const Ae=n==="layergroup"?"group":"vector",{url:We}=await il({connId:t,workspace:e,layerName:r,layerType:Ae});K({url:We,layerName:r,workspace:e,connectionId:t,layerType:Ae,nodeType:n}),ee("2d")}catch(Ae){bt.getState().setError(Ae.message)}},ne=I.useCallback(()=>!t||!e?null:n==="layergroup"?`/api/terria/story/${t}/${e}/${r}`:`/api/terria/layer/${t}/${e}/${r}`,[t,e,r,n]);I.useEffect(()=>{F(Ae=>Ae+1)},[t,e,r]),I.useEffect(()=>{if(!s.current)return;if(a.current){try{a.current.destroy()}catch(Ye){console.warn("[Globe3D] Error destroying previous viewer:",Ye)}a.current=null}d(!0),P(null);let Ae=!0;const We=setTimeout(async()=>{if(!(!Ae||!s.current))try{console.log("[Globe3D] Initializing Cesium viewer...");const Ye=new Cesium.Viewer(s.current,{baseLayerPicker:!1,geocoder:!1,homeButton:!1,sceneModePicker:!1,selectionIndicator:!1,timeline:!1,animation:!1,navigationHelpButton:!1,fullscreenButton:!1,vrButton:!1,infoBox:!1,creditContainer:document.createElement("div")});Ye.imageryLayers.removeAll(),Ye.terrainProvider=new Cesium.EllipsoidTerrainProvider,console.log("[Globe3D] Viewer created, adding base layer..."),Ye.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider({url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"],credit:new Cesium.Credit("Map tiles by CartoDB, under CC BY 3.0. Data by OpenStreetMap, under ODbL.")})),console.log("[Globe3D] CartoDB base layer added"),a.current=Ye;const tt=ne();if(tt){const Be=await fetch(tt);if(!Be.ok)throw new Error(`Failed to fetch catalog: ${Be.status}`);const Me=await Be.json(),Ge=[],De=Le=>{if(Le.type==="wms")try{const Oe=new Cesium.WebMapServiceImageryProvider({url:Le.url,layers:Le.layers||Le.name,parameters:{transparent:!0,format:"image/png"}}),Ie=Ye.imageryLayers.addImageryProvider(Oe);if(Ie.alpha=Le.opacity||1,Ge.push({name:Le.name,layer:Ie,visible:!0,opacity:Ie.alpha}),Le.rectangle){const st=Le.rectangle;Ye.camera.flyTo({destination:Cesium.Rectangle.fromDegrees(st.west,st.south,st.east,st.north),duration:1.5})}}catch(Oe){console.error("Failed to add WMS layer:",Le.name,Oe)}else Le.type==="group"&&Array.isArray(Le.members)&&Le.members.forEach(Oe=>De(Oe))};Me.catalog?Me.catalog.forEach(Le=>De(Le)):(Me.type==="wms"||Me.type==="group")&&De(Me),Ae&&w(Ge)}Ae&&d(!1)}catch(Ye){console.error("Failed to initialize Cesium viewer:",Ye),Ae&&(P(Ye instanceof Error?Ye.message:"Failed to initialize viewer"),d(!1))}},200);return()=>{if(Ae=!1,clearTimeout(We),a.current){try{a.current.destroy()}catch(Ye){console.warn("[Globe3D] Error destroying viewer:",Ye)}a.current=null}w([])}},[ne,R]),I.useEffect(()=>{if(a.current)switch(m){case"3d":a.current.scene.mode=Cesium.SceneMode.SCENE3D;break;case"2d":a.current.scene.mode=Cesium.SceneMode.SCENE2D;break;case"columbus":a.current.scene.mode=Cesium.SceneMode.COLUMBUS_VIEW;break}},[m]);const oe=(Ae,We)=>{v[Ae]&&(v[Ae].layer.show=We,w(Ye=>Ye.map((tt,Be)=>Be===Ae?{...tt,visible:We}:tt)))},ce=(Ae,We)=>{v[Ae]&&(v[Ae].layer.alpha=We,w(Ye=>Ye.map((tt,Be)=>Be===Ae?{...tt,opacity:We}:tt)))},Xe=()=>{if(!a.current)return;const We=a.current.imageryLayers;for(let Ye=0;Ye<We.length;Ye++){const tt=We.get(Ye),Be=tt.show;tt.show=!1,setTimeout(()=>{tt.show=Be},100)}};return u.jsxs(Rr,{bg:D,overflow:"hidden",h:"100%",display:"flex",flexDirection:"column",children:[u.jsx(ue,{bg:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",color:"white",px:4,py:3,children:u.jsxs(fe,{justify:"space-between",children:[u.jsxs(lt,{align:"start",spacing:0,children:[u.jsxs(fe,{children:[u.jsx(pn,{size:"sm",color:"white",children:"3D Globe Preview"}),u.jsx(Qt,{colorScheme:"whiteAlpha",variant:"solid",fontSize:"xs",children:n==="layergroup"?"Layer Group":"Layer"})]}),u.jsxs(J,{fontSize:"xs",color:"whiteAlpha.800",children:[e,":",r]})]}),u.jsxs(fe,{spacing:2,children:[v.length>0&&u.jsxs(sf,{children:[u.jsx(of,{as:gt,size:"sm",variant:"solid",bg:"whiteAlpha.200",color:"white",_hover:{bg:"whiteAlpha.300"},_active:{bg:"whiteAlpha.400"},rightIcon:u.jsx(Ul,{}),leftIcon:u.jsx(hi,{}),maxW:"180px",children:u.jsxs(J,{isTruncated:!0,fontSize:"xs",children:[v.length," Layer",v.length!==1?"s":""]})}),u.jsx(af,{color:"gray.800",zIndex:1e3,maxH:"300px",overflowY:"auto",children:v.map((Ae,We)=>u.jsx(xa,{onClick:()=>oe(We,!Ae.visible),closeOnSelect:!1,children:u.jsxs(fe,{justify:"space-between",w:"100%",children:[u.jsxs(fe,{children:[u.jsx(ze,{as:Ae.visible?Ri:cf,color:Ae.visible?"green.500":"gray.400"}),u.jsx(J,{fontSize:"sm",children:Ae.name})]}),u.jsxs(Qt,{colorScheme:Ae.visible?"green":"gray",size:"sm",children:[Math.round(Ae.opacity*100),"%"]})]})},We))})]}),u.jsx(wr,{label:"2D Map (MapLibre)",children:u.jsx(gr,{"aria-label":"2D Map",icon:u.jsx(Sc,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:Y})}),u.jsxs(Yk,{size:"sm",isAttached:!0,variant:"ghost",children:[u.jsx(wr,{label:"3D Globe",children:u.jsx(gr,{"aria-label":"3D Globe",icon:u.jsx(xs,{}),color:"white",bg:m==="3d"?"whiteAlpha.300":void 0,_hover:{bg:"whiteAlpha.200"},onClick:()=>y("3d")})}),u.jsx(wr,{label:"Columbus View",children:u.jsx(gr,{"aria-label":"Columbus View",icon:u.jsx(PM,{}),color:"white",bg:m==="columbus"?"whiteAlpha.300":void 0,_hover:{bg:"whiteAlpha.200"},onClick:()=>y("columbus")})})]}),u.jsx(Nr,{orientation:"vertical",h:"24px",borderColor:"whiteAlpha.400"}),u.jsx(wr,{label:"Refresh",children:u.jsx(gr,{"aria-label":"Refresh",icon:u.jsx(Su,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:Xe})}),u.jsx(wr,{label:"Layer Controls",children:u.jsx(gr,{"aria-label":"Layer Controls",icon:u.jsx(I1,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:()=>$(!E),bg:E?"whiteAlpha.200":void 0})}),i&&u.jsx(wr,{label:"Close Preview",children:u.jsx(gr,{"aria-label":"Close",icon:u.jsx(hf,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:i})})]})]})}),u.jsx(bc,{in:E,animateOpacity:!0,children:u.jsx(ue,{bg:X,p:4,borderBottom:"1px solid",borderColor:U,children:o?u.jsxs(fe,{justify:"center",py:4,children:[u.jsx(kn,{size:"sm",color:"kartoza.500"}),u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Loading layers..."})]}):v.length>0?u.jsx(Wr,{columns:{base:1,md:2,lg:3},spacing:4,children:v.map((Ae,We)=>u.jsxs(ue,{bg:D,p:3,borderRadius:"md",border:"1px solid",borderColor:U,children:[u.jsx(fe,{justify:"space-between",mb:2,children:u.jsxs(fe,{children:[u.jsx(gr,{"aria-label":"Toggle visibility",icon:Ae.visible?u.jsx(Ri,{}):u.jsx(cf,{}),size:"xs",variant:"ghost",colorScheme:Ae.visible?"green":"gray",onClick:()=>oe(We,!Ae.visible)}),u.jsx(J,{fontSize:"sm",fontWeight:"500",noOfLines:1,children:Ae.name})]})}),u.jsxs(fe,{spacing:2,children:[u.jsx(J,{fontSize:"xs",color:"gray.500",minW:"50px",children:"Opacity"}),u.jsxs(Tl,{value:Ae.opacity*100,onChange:Ye=>ce(We,Ye/100),min:0,max:100,size:"sm",children:[u.jsx(jl,{bg:"gray.200",children:u.jsx(Pl,{bg:"kartoza.500"})}),u.jsx(Ol,{boxSize:3})]}),u.jsxs(J,{fontSize:"xs",color:"gray.500",minW:"30px",children:[Math.round(Ae.opacity*100),"%"]})]})]},We))}):u.jsx(J,{fontSize:"sm",color:"gray.500",children:"No layers loaded"})})}),u.jsxs(ue,{flex:"1",minH:"300px",position:"relative",bg:"gray.900",children:[u.jsx(ue,{ref:s,position:"absolute",top:0,left:0,right:0,bottom:0},`cesium-container-${R}`),o&&u.jsxs(ue,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",bg:"blackAlpha.700",p:6,borderRadius:"lg",children:[u.jsx(kn,{size:"xl",color:"kartoza.400",thickness:"4px"}),u.jsx(J,{mt:3,color:"white",children:"Loading 3D viewer..."})]}),O&&u.jsxs(ue,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",bg:"red.600",color:"white",p:6,borderRadius:"lg",maxW:"400px",children:[u.jsx(J,{fontWeight:"bold",mb:2,children:"Error"}),u.jsx(J,{fontSize:"sm",children:O})]})]}),u.jsx(ue,{px:4,py:2,bg:X,borderTop:"1px solid",borderColor:U,children:u.jsxs(fe,{justify:"space-between",fontSize:"xs",color:"gray.500",children:[u.jsxs(J,{children:["Connection: ",t==null?void 0:t.slice(0,8),"..."]}),u.jsxs(fe,{spacing:4,children:[u.jsx(Qt,{colorScheme:m==="3d"?"green":m==="2d"?"blue":"purple",children:m==="3d"?"3D Globe":m==="2d"?"2D Map":"Columbus View"}),u.jsx(J,{children:"Scroll to zoom, drag to pan, right-drag to rotate"})]})]})})]})}function b1e({isOpen:t,onClose:e,connectionId:r,connectionName:n}){const i=Yo(),s=Jo(),[a,o]=I.useState({}),{data:d,isLoading:m}=Xr({queryKey:["contact",r],queryFn:()=>jbe(r),enabled:t&&!!r});I.useEffect(()=>{d&&o(d)},[d]);const y=su({mutationFn:O=>Pbe(r,O),onSuccess:()=>{s.invalidateQueries({queryKey:["contact",r]}),i({title:"Settings saved",description:"Service metadata has been updated successfully.",status:"success",duration:3e3}),e()},onError:O=>{i({title:"Error saving settings",description:O.message,status:"error",duration:5e3})}}),v=(O,P)=>{o(E=>({...E,[O]:P}))},w=()=>{y.mutate(a)};return u.jsxs(ss,{isOpen:t,onClose:e,size:"4xl",scrollBehavior:"inside",children:[u.jsx(as,{backdropFilter:"blur(4px)"}),u.jsxs(os,{maxH:"90vh",children:[u.jsxs(P1,{bg:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",color:"white",borderTopRadius:"md",children:[u.jsxs(fe,{children:[u.jsx(ze,{as:nF}),u.jsx(J,{children:"Service Metadata"})]}),u.jsx(J,{fontSize:"sm",fontWeight:"normal",opacity:.9,children:n})]}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:6,children:m?u.jsxs(lt,{py:10,children:[u.jsx(kn,{size:"xl",color:"kartoza.500"}),u.jsx(J,{color:"gray.500",children:"Loading settings..."})]}):u.jsxs(w0,{colorScheme:"kartoza",variant:"enclosed",children:[u.jsxs(S0,{children:[u.jsx(to,{children:u.jsxs(fe,{children:[u.jsx(ze,{as:oF}),u.jsx(J,{children:"Contact"})]})}),u.jsx(to,{children:u.jsxs(fe,{children:[u.jsx(ze,{as:P2}),u.jsx(J,{children:"Address"})]})}),u.jsx(to,{children:u.jsxs(fe,{children:[u.jsx(ze,{as:xs}),u.jsx(J,{children:"Service"})]})})]}),u.jsxs(z1,{children:[u.jsx(_a,{children:u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"bold",color:"gray.600",mb:3,children:"Contact Person"}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,children:[u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Name"}),u.jsxs(da,{children:[u.jsx(wl,{pointerEvents:"none",children:u.jsx(ze,{as:oF,color:"gray.400"})}),u.jsx(Ar,{placeholder:"John Smith",value:a.contactPerson||"",onChange:O=>v("contactPerson",O.target.value)})]})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Position"}),u.jsxs(da,{children:[u.jsx(wl,{pointerEvents:"none",children:u.jsx(ze,{as:nF,color:"gray.400"})}),u.jsx(Ar,{placeholder:"GIS Administrator",value:a.contactPosition||"",onChange:O=>v("contactPosition",O.target.value)})]})]})]})]}),u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"bold",color:"gray.600",mb:3,children:"Organization"}),u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Organization Name"}),u.jsxs(da,{children:[u.jsx(wl,{pointerEvents:"none",children:u.jsx(ze,{as:pve,color:"gray.400"})}),u.jsx(Ar,{placeholder:"Kartoza (Pty) Ltd",value:a.contactOrganization||"",onChange:O=>v("contactOrganization",O.target.value)})]})]})]}),u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"bold",color:"gray.600",mb:3,children:"Contact Details"}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,children:[u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Email"}),u.jsxs(da,{children:[u.jsx(wl,{pointerEvents:"none",children:u.jsx(ze,{as:gve,color:"gray.400"})}),u.jsx(Ar,{type:"email",placeholder:"info@example.com",value:a.contactEmail||"",onChange:O=>v("contactEmail",O.target.value)})]})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Phone"}),u.jsxs(da,{children:[u.jsx(wl,{pointerEvents:"none",children:u.jsx(ze,{as:sF,color:"gray.400"})}),u.jsx(Ar,{placeholder:"+27 21 123 4567",value:a.contactVoice||"",onChange:O=>v("contactVoice",O.target.value)})]})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Fax"}),u.jsxs(da,{children:[u.jsx(wl,{pointerEvents:"none",children:u.jsx(ze,{as:sF,color:"gray.400"})}),u.jsx(Ar,{placeholder:"+27 21 123 4568",value:a.contactFacsimile||"",onChange:O=>v("contactFacsimile",O.target.value)})]})]})]})]})]})}),u.jsx(_a,{children:u.jsx(lt,{spacing:6,align:"stretch",children:u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"bold",color:"gray.600",mb:3,children:"Location"}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,children:[u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Address Type"}),u.jsx(Ar,{placeholder:"Work",value:a.addressType||"",onChange:O=>v("addressType",O.target.value)})]}),u.jsxs(Ot,{gridColumn:{md:"span 2"},children:[u.jsx(jt,{fontSize:"sm",children:"Street Address"}),u.jsxs(da,{children:[u.jsx(wl,{pointerEvents:"none",children:u.jsx(ze,{as:P2,color:"gray.400"})}),u.jsx(Ar,{placeholder:"123 Main Street",value:a.address||"",onChange:O=>v("address",O.target.value)})]})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"City"}),u.jsx(Ar,{placeholder:"Cape Town",value:a.addressCity||"",onChange:O=>v("addressCity",O.target.value)})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"State / Province"}),u.jsx(Ar,{placeholder:"Western Cape",value:a.addressState||"",onChange:O=>v("addressState",O.target.value)})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Postal Code"}),u.jsx(Ar,{placeholder:"8001",value:a.addressPostalCode||"",onChange:O=>v("addressPostalCode",O.target.value)})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Country"}),u.jsx(Ar,{placeholder:"South Africa",value:a.addressCountry||"",onChange:O=>v("addressCountry",O.target.value)})]})]})]})})}),u.jsx(_a,{children:u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"bold",color:"gray.600",mb:3,children:"Online Presence"}),u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Online Resource (Website)"}),u.jsxs(da,{children:[u.jsx(wl,{pointerEvents:"none",children:u.jsx(ze,{as:xs,color:"gray.400"})}),u.jsx(Ar,{type:"url",placeholder:"https://www.example.com",value:a.onlineResource||"",onChange:O=>v("onlineResource",O.target.value)})]})]})]}),u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"bold",color:"gray.600",mb:3,children:"Welcome Message"}),u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Service Welcome Message"}),u.jsx(da,{children:u.jsx(lC,{placeholder:"Welcome to our GeoServer instance. This service provides access to...",value:a.welcome||"",onChange:O=>v("welcome",O.target.value),rows:6})}),u.jsx(J,{fontSize:"xs",color:"gray.500",mt:1,children:"This message will be displayed on the GeoServer welcome page"})]})]})]})})]})]})}),u.jsx(To,{borderTop:"1px",borderColor:"gray.200",children:u.jsxs(fe,{spacing:3,children:[u.jsx(gt,{variant:"ghost",onClick:e,children:"Cancel"}),u.jsx(gt,{colorScheme:"kartoza",onClick:w,isLoading:y.isPending,loadingText:"Saving...",children:"Save Changes"})]})})]})]})}const _1e=lo`
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
`,w1e=lo`
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
`;function hF(t){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB","TB"],n=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,n)).toFixed(1))+" "+r[n]}function S1e({data:t,width:e=80,height:r=20,color:n="#38B2AC"}){if(t.length<2)return null;const i=Math.min(...t),a=Math.max(...t)-i||1,o=t.map((d,m)=>{const y=m/(t.length-1)*e,v=r-(d-i)/a*(r-4)-2;return`${y},${v}`}).join(" ");return u.jsx("svg",{width:e,height:r,style:{display:"inline-block",marginLeft:"4px"},children:u.jsx("polyline",{points:o,fill:"none",stroke:n,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}const GA=new Map,k1e=30;function C1e(t,e){const r=GA.get(t)||[];r.push(e),r.length>k1e&&r.shift(),GA.set(t,r)}function T1e(t){return GA.get(t)||[]}const jS=new Map,O1e=6e4;function j1e({service:t,onParse:e,isParsing:r,onToggleHidden:n,isTogglingHidden:i}){const[s,a]=I.useState(null),[o,d]=I.useState(!1);I.useEffect(()=>{const P=jS.get(t.name),E=Date.now();if(P&&E-P.lastChecked<O1e){a(P.online);return}if(t.hidden){a(null);return}(async()=>{d(!0);try{const R=await vU(t.name);a(R.success),jS.set(t.name,{online:R.success,lastChecked:E})}catch{a(!1),jS.set(t.name,{online:!1,lastChecked:E})}finally{d(!1)}})()},[t.name,t.hidden]);const m=t.hidden?"gray.100":t.is_parsed?"white":"gray.50",y=t.hidden?"gray.400":s===!0?"green.400":s===!1?"red.400":t.is_parsed?"blue.400":"gray.300",v=()=>t.hidden?cf:s===!0?lf:s===!1?uC:t.is_parsed?lf:Wn,w=()=>t.hidden?"gray.500":s===!0?"green.500":s===!1?"red.500":t.is_parsed?"blue.500":"gray.400",O=()=>t.hidden?"Hidden (disabled)":o?"Checking...":s===!0?"Online":s===!1?"Offline":t.is_parsed?"Schema Parsed":"Not Parsed";return u.jsxs(ue,{bg:m,borderRadius:"xl",border:"2px solid",borderColor:y,p:4,minH:"220px",position:"relative",transition:"all 0.3s ease",opacity:t.hidden?.7:1,_hover:{transform:"translateY(-2px)",boxShadow:"lg"},children:[u.jsxs(fe,{position:"absolute",top:3,right:3,spacing:2,children:[u.jsx(wr,{label:t.hidden?"Show service":"Hide service",children:u.jsx(gr,{"aria-label":t.hidden?"Show":"Hide",icon:u.jsx(ze,{as:t.hidden?Ri:cf}),size:"xs",variant:"ghost",colorScheme:t.hidden?"blue":"gray",onClick:()=>n(!t.hidden),isLoading:i})}),u.jsx(wr,{label:O(),children:u.jsx("span",{children:o?u.jsx(kn,{size:"sm",color:"blue.500"}):u.jsx(ze,{as:v(),color:w(),boxSize:5})})})]}),u.jsxs(lt,{align:"start",spacing:3,children:[u.jsxs(fe,{children:[u.jsx(ze,{as:fm,color:t.hidden?"gray.400":"blue.600",boxSize:6}),u.jsxs(lt,{align:"start",spacing:0,children:[u.jsx(J,{fontWeight:"bold",fontSize:"lg",noOfLines:1,color:t.hidden?"gray.500":void 0,children:t.name}),u.jsx(J,{fontSize:"xs",color:"gray.500",noOfLines:1,children:t.host?`${t.host}:${t.port||"5432"}`:"pg_service.conf entry"})]})]}),t.dbname&&u.jsxs(Qt,{colorScheme:t.hidden?"gray":"blue",fontSize:"xs",children:["Database: ",t.dbname]}),t.hidden?u.jsxs(io,{status:"info",variant:"subtle",borderRadius:"md",py:2,children:[u.jsx(so,{boxSize:4}),u.jsx(J,{fontSize:"sm",children:"This service is hidden"})]}):t.is_parsed?u.jsxs(Wr,{columns:2,spacing:2,w:"100%",children:[u.jsxs(ts,{size:"sm",children:[u.jsx(rs,{fontSize:"xs",color:"gray.500",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:Vo,boxSize:3}),u.jsx(J,{children:"Status"})]})}),u.jsx(ns,{fontSize:"md",color:s===!0?"green.600":s===!1?"red.600":"blue.600",children:s===!0?"Online":s===!1?"Offline":"Parsed"})]}),u.jsxs(ts,{size:"sm",children:[u.jsx(rs,{fontSize:"xs",color:"gray.500",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:Wn,boxSize:3}),u.jsx(J,{children:"User"})]})}),u.jsx(ns,{fontSize:"md",color:"gray.600",noOfLines:1,children:t.user||"N/A"})]})]}):u.jsx(gt,{size:"sm",colorScheme:"blue",variant:"outline",leftIcon:u.jsx(Wn,{}),onClick:e,isLoading:r,loadingText:"Parsing...",w:"100%",children:"Parse Schema"}),t.sslmode&&u.jsx(fe,{spacing:2,fontSize:"xs",color:"gray.500",w:"100%",children:u.jsxs(J,{children:["SSL: ",t.sslmode]})})]})]})}function dF({server:t,isAlert:e=!1}){const r=t.online?"green.400":"red.400",n=e?"red.50":t.online?"white":"gray.50",i=t.online?lf:uC,s=t.online?"green.500":"red.500",a=T1e(t.connectionId);return u.jsxs(ue,{bg:n,borderRadius:"xl",border:"2px solid",borderColor:r,p:4,minH:"220px",position:"relative",transition:"all 0.3s ease",_hover:{transform:"translateY(-2px)",boxShadow:"lg"},css:t.online?void 0:yc`animation: ${_1e} 2s ease-in-out infinite;`,children:[u.jsx(ue,{position:"absolute",top:3,right:3,children:u.jsx(wr,{label:t.online?"Online":t.error||"Offline",children:u.jsx("span",{children:u.jsx(ze,{as:i,color:s,boxSize:5})})})}),u.jsxs(lt,{align:"start",spacing:3,children:[u.jsxs(fe,{children:[u.jsx(ze,{as:ql,color:"kartoza.500",boxSize:6}),u.jsxs(lt,{align:"start",spacing:0,children:[u.jsx(J,{fontWeight:"bold",fontSize:"lg",noOfLines:1,children:t.connectionName}),u.jsx(J,{fontSize:"xs",color:"gray.500",noOfLines:1,children:t.url})]})]}),t.online?u.jsxs(u.Fragment,{children:[t.geoserverVersion&&u.jsxs(Qt,{colorScheme:"blue",fontSize:"xs",children:["GeoServer ",t.geoserverVersion]}),u.jsxs(Wr,{columns:2,spacing:2,w:"100%",children:[u.jsxs(ts,{size:"sm",children:[u.jsx(rs,{fontSize:"xs",color:"gray.500",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:hi,boxSize:3}),u.jsx(J,{children:"Layers"})]})}),u.jsx(ns,{fontSize:"xl",color:"purple.600",children:t.layerCount})]}),u.jsxs(ts,{size:"sm",children:[u.jsx(rs,{fontSize:"xs",color:"gray.500",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:Wn,boxSize:3}),u.jsx(J,{children:"Stores"})]})}),u.jsx(ns,{fontSize:"xl",color:"blue.600",children:t.dataStoreCount+t.coverageCount})]})]}),t.memoryTotal>0&&u.jsxs(ue,{w:"100%",children:[u.jsxs(fe,{justify:"space-between",mb:1,children:[u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:yy,boxSize:3,color:"gray.500"}),u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Memory"})]}),u.jsxs(J,{fontSize:"xs",color:"gray.600",children:[hF(t.memoryUsed)," / ",hF(t.memoryTotal)]})]}),u.jsx(Sf,{value:t.memoryUsedPct,size:"sm",colorScheme:t.memoryUsedPct>80?"red":t.memoryUsedPct>60?"yellow":"green",borderRadius:"full"})]}),u.jsxs(fe,{spacing:2,fontSize:"xs",color:"gray.500",w:"100%",children:[u.jsx(ze,{as:cC,boxSize:3}),u.jsxs(J,{children:["Response: ",t.responseTimeMs,"ms"]}),a.length>=2&&u.jsx(S1e,{data:a,width:60,height:16,color:"#38B2AC"})]})]}):u.jsx(ue,{w:"100%",children:u.jsxs(io,{status:"error",variant:"subtle",borderRadius:"md",py:2,children:[u.jsx(so,{boxSize:4}),u.jsx(J,{fontSize:"sm",noOfLines:2,children:t.error||"Server is offline"})]})})]})]})}function fF(){const t=I.useRef(30),e=Jo(),[r,n]=I.useState(null),[i,s]=I.useState(null),a=bt(oe=>oe.settings.showHiddenPGServices),o=bt(oe=>oe.openDialog),d=Er(oe=>oe.selectedNode),y=(()=>{if(!d)return"all";const oe=d.type;return oe==="geoserver"||oe==="connection"||oe==="workspace"||oe==="datastores"||oe==="coveragestores"||oe==="datastore"||oe==="coveragestore"||oe==="layers"||oe==="layer"||oe==="styles"||oe==="style"||oe==="layergroups"||oe==="layergroup"?"geoserver":oe==="postgresql"||oe==="pgservice"||oe==="pgschema"||oe==="pgtable"||oe==="pgview"||oe==="pgcolumn"?"postgresql":"all"})(),{data:v,isLoading:w,error:O,refetch:P,isFetching:E}=Xr({queryKey:["dashboard"],queryFn:Lbe,refetchInterval:()=>t.current*1e3}),{data:$}=Xr({queryKey:["pgservices"],queryFn:DM,staleTime:3e4}),R=$==null?void 0:$.filter(oe=>a||!oe.hidden),F=async oe=>{n(oe);try{await bU(oe),e.invalidateQueries({queryKey:["pgservices"]})}catch(ce){console.error("Failed to parse service:",ce)}finally{n(null)}},D=async(oe,ce)=>{s(oe);try{await Ube(oe,ce),jS.delete(oe),e.invalidateQueries({queryKey:["pgservices"]})}catch(Xe){console.error("Failed to toggle hidden state:",Xe)}finally{s(null)}};if(I.useEffect(()=>{if(v!=null&&v.servers){for(const oe of v.servers)oe.online&&C1e(oe.connectionId,oe.responseTimeMs);v.pingIntervalSecs&&v.pingIntervalSecs>0&&(t.current=v.pingIntervalSecs)}},[v]),w)return u.jsx(yr,{h:"100%",align:"center",justify:"center",children:u.jsxs(lt,{spacing:4,children:[u.jsx(kn,{size:"xl",color:"kartoza.500",thickness:"4px"}),u.jsx(J,{color:"gray.500",children:"Loading server status..."})]})});if(O)return u.jsx(yr,{h:"100%",align:"center",justify:"center",p:8,children:u.jsxs(io,{status:"error",borderRadius:"lg",children:[u.jsx(so,{}),u.jsx(_1,{children:"Failed to load dashboard"}),u.jsx(Ky,{children:O.message})]})});const U=v&&v.servers.length>0,X=R&&R.length>0,ee=(y==="all"||y==="geoserver")&&U,K=(y==="all"||y==="postgresql")&&X;if(!U&&!X)return u.jsx(yr,{h:"100%",align:"center",justify:"center",p:8,children:u.jsxs(lt,{spacing:4,textAlign:"center",children:[u.jsx(ze,{as:ql,boxSize:16,color:"gray.300"}),u.jsx(J,{color:"gray.500",fontSize:"lg",children:"No servers configured"}),u.jsx(J,{color:"gray.400",fontSize:"sm",children:"Add a GeoServer connection or PostgreSQL service to get started"})]})});const Y=(v==null?void 0:v.servers.filter(oe=>oe.online))||[],ne=(v==null?void 0:v.servers.filter(oe=>!oe.online))||[];return u.jsxs(yr,{h:"100%",direction:"column",children:[u.jsxs(yr,{justify:"space-between",align:"center",p:4,borderBottom:"1px solid",borderColor:"gray.200",bg:"white",flexShrink:0,children:[u.jsxs(fe,{spacing:3,children:[u.jsx(ze,{as:M1,boxSize:6,color:"kartoza.500"}),u.jsx(J,{fontSize:"xl",fontWeight:"bold",children:"Server Dashboard"})]}),u.jsxs(fe,{spacing:4,children:[u.jsxs(fe,{spacing:6,display:{base:"none",md:"flex"},children:[u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:lf,color:"green.500"}),u.jsx(J,{fontWeight:"bold",color:"green.600",children:(v==null?void 0:v.onlineCount)||0}),u.jsx(J,{color:"gray.500",children:"Online"})]}),((v==null?void 0:v.offlineCount)||0)>0&&u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:uC,color:"red.500"}),u.jsx(J,{fontWeight:"bold",color:"red.600",children:(v==null?void 0:v.offlineCount)||0}),u.jsx(J,{color:"gray.500",children:"Offline"})]}),u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:hi,color:"purple.500"}),u.jsx(J,{fontWeight:"bold",color:"purple.600",children:(v==null?void 0:v.totalLayers)||0}),u.jsx(J,{color:"gray.500",children:"Layers"})]}),X&&u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:fm,color:"blue.600"}),u.jsx(J,{fontWeight:"bold",color:"blue.600",children:(R==null?void 0:R.length)||0}),u.jsx(J,{color:"gray.500",children:"PG Services"})]}),u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:cC,color:"gray.500"}),u.jsxs(J,{color:"gray.500",children:[(v==null?void 0:v.pingIntervalSecs)||60,"s"]})]})]}),u.jsx(wr,{label:"Settings",children:u.jsx(gr,{"aria-label":"Settings",icon:u.jsx(R1,{}),variant:"ghost",colorScheme:"gray",onClick:()=>o("settings")})}),u.jsx(wr,{label:"Refresh status",children:u.jsx(gr,{"aria-label":"Refresh",icon:u.jsx(Su,{}),variant:"ghost",colorScheme:"kartoza",onClick:()=>P(),css:E?yc`animation: ${w1e} 1s linear infinite;`:void 0})})]})]}),u.jsx(yr,{flex:1,overflowY:"auto",p:6,justify:"center",align:((v==null?void 0:v.servers.length)||0)+((R==null?void 0:R.length)||0)<=3?"center":"flex-start",children:u.jsxs(lt,{spacing:6,maxW:"1400px",w:"100%",children:[ee&&u.jsxs(ue,{w:"100%",children:[u.jsxs(fe,{spacing:2,mb:3,justify:"center",children:[u.jsx(ze,{as:ql,color:"kartoza.500"}),u.jsxs(J,{fontWeight:"bold",color:"gray.700",children:["GeoServer Connections (",(v==null?void 0:v.servers.length)||0,")"]})]}),ne.length>0&&u.jsxs(ue,{mb:4,children:[u.jsxs(fe,{spacing:2,mb:2,justify:"center",children:[u.jsx(ze,{as:G7,color:"red.500",boxSize:4}),u.jsxs(J,{fontSize:"sm",fontWeight:"medium",color:"red.600",children:["Requires Attention (",ne.length,")"]})]}),u.jsx(yr,{wrap:"wrap",gap:4,justify:"center",children:ne.map(oe=>u.jsx(ue,{w:{base:"100%",md:"340px"},children:u.jsx(dF,{server:oe,isAlert:!0})},oe.connectionId))})]}),Y.length>0&&u.jsx(yr,{wrap:"wrap",gap:4,justify:"center",children:Y.map(oe=>u.jsx(ue,{w:{base:"100%",md:"340px"},children:u.jsx(dF,{server:oe})},oe.connectionId))})]}),K&&u.jsxs(ue,{w:"100%",children:[u.jsxs(fe,{spacing:2,mb:3,justify:"center",children:[u.jsx(ze,{as:fm,color:"blue.600"}),u.jsxs(J,{fontWeight:"bold",color:"gray.700",children:["PostgreSQL Services (",(R==null?void 0:R.length)||0,")"]})]}),u.jsx(yr,{wrap:"wrap",gap:4,justify:"center",children:R==null?void 0:R.map(oe=>u.jsx(ue,{w:{base:"100%",md:"340px"},children:u.jsx(j1e,{service:oe,onParse:()=>F(oe.name),isParsing:r===oe.name,onToggleHidden:ce=>D(oe.name,ce),isTogglingHidden:i===oe.name})},oe.name))})]})]})})]})}function P1e(){const t=Er(s=>s.selectedNode),e=bt(s=>s.activePreview),r=bt(s=>s.previewMode),n=bt(s=>s.setPreview),i=I.useRef(t);if(I.useEffect(()=>{const s=i.current;if(i.current=t,!e||!t||(s==null?void 0:s.id)===t.id||!["layer","layergroup","datastore","coveragestore"].includes(t.type))return;(async()=>{try{const d=t.type==="coveragestore"?"raster":t.type==="layergroup"?"group":"vector",{url:m}=await il({connId:t.connectionId,workspace:t.workspace,layerName:t.name,storeName:t.type==="datastore"||t.type==="coveragestore"?t.name:void 0,storeType:t.type==="datastore"||t.type==="coveragestore"?t.type:void 0,layerType:d});n({url:m,layerName:t.name,workspace:t.workspace,connectionId:t.connectionId,storeName:t.type==="datastore"||t.type==="coveragestore"?t.name:void 0,storeType:t.type==="datastore"||t.type==="coveragestore"?t.type:void 0,layerType:d})}catch(d){bt.getState().setError(d.message)}})()},[t,e,n]),e)return u.jsx(ue,{flex:"1",display:"flex",flexDirection:"column",minH:"0",children:r==="3d"?u.jsx(v1e,{connectionId:e.connectionId,workspace:e.workspace,layerName:e.layerName,nodeType:e.nodeType||(e.layerType==="group"?"layergroup":"layer"),onClose:()=>n(null)},`3d-${e.workspace}:${e.layerName}`):u.jsx(x1e,{previewUrl:e.url,layerName:e.layerName,workspace:e.workspace,connectionId:e.connectionId,storeName:e.storeName,storeType:e.storeType,layerType:e.layerType,onClose:()=>n(null)},`2d-${e.workspace}:${e.layerName}:${e.url}`)});if(!t)return u.jsx(fF,{});switch(t.type){case"connection":return u.jsx(L1e,{connectionId:t.connectionId});case"workspace":return u.jsx(F1e,{connectionId:t.connectionId,workspace:t.workspace});case"datastores":return u.jsx(A1e,{connectionId:t.connectionId,workspace:t.workspace});case"coveragestores":return u.jsx(E1e,{connectionId:t.connectionId,workspace:t.workspace});case"layers":return u.jsx(z1e,{connectionId:t.connectionId,workspace:t.workspace});case"styles":return u.jsx(I1e,{connectionId:t.connectionId,workspace:t.workspace});case"layergroups":return u.jsx(R1e,{connectionId:t.connectionId,workspace:t.workspace});case"datastore":case"coveragestore":return u.jsx(B1e,{connectionId:t.connectionId,workspace:t.workspace,storeName:t.name,storeType:t.type});case"layer":return u.jsx($1e,{connectionId:t.connectionId,workspace:t.workspace,layerName:t.name});case"style":return u.jsx(V1e,{connectionId:t.connectionId,workspace:t.workspace,styleName:t.name});case"layergroup":return u.jsx(N1e,{connectionId:t.connectionId,workspace:t.workspace,groupName:t.name});case"pgservice":return u.jsx(H1e,{serviceName:t.serviceName});case"pgschema":return u.jsx(G1e,{serviceName:t.serviceName,schemaName:t.schemaName});default:return u.jsx(fF,{})}}function A1e({connectionId:t,workspace:e}){const r=bt(s=>s.openDialog),n=Bt("white","gray.800"),{data:i}=Xr({queryKey:["datastores",t,e],queryFn:()=>MM(t,e)});return u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:Wn,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:0,children:[u.jsx(pn,{size:"lg",children:"Data Stores"}),u.jsxs(J,{opacity:.9,children:["Workspace: ",e]})]})]}),u.jsx(Zo,{}),u.jsx(lt,{align:"end",spacing:2,children:u.jsxs(ts,{textAlign:"right",children:[u.jsx(ns,{fontSize:"3xl",children:(i==null?void 0:i.length)??0}),u.jsx(rs,{color:"whiteAlpha.800",children:"Total Stores"})]})})]})})}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,children:[u.jsx(gt,{size:"lg",variant:"accent",leftIcon:u.jsx(vs,{}),onClick:()=>r("datastore",{mode:"create",data:{connectionId:t,workspace:e}}),py:8,children:"Create New Data Store"}),u.jsx(gt,{size:"lg",variant:"outline",leftIcon:u.jsx(Hl,{}),onClick:()=>r("upload",{mode:"create",data:{connectionId:t,workspace:e}}),py:8,children:"Upload Shapefile / GeoPackage"})]}),i&&i.length>0&&u.jsx(Rr,{bg:n,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"stretch",spacing:4,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Existing Data Stores"}),u.jsx(Nr,{}),u.jsx(Wr,{columns:{base:1,md:2,lg:3},spacing:4,children:i.map(s=>u.jsx(OU,{name:s.name,type:s.type||"Unknown",enabled:s.enabled,icon:Wn,connectionId:t,workspace:e,storeType:"datastore"},s.name))})]})})})]})}function E1e({connectionId:t,workspace:e}){const r=bt(s=>s.openDialog),n=Bt("white","gray.800"),{data:i}=Xr({queryKey:["coveragestores",t,e],queryFn:()=>IM(t,e)});return u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:"linear-gradient(135deg, #D4922A 0%, #E8A331 50%, #F0B84D 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:wc,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:0,children:[u.jsx(pn,{size:"lg",children:"Coverage Stores"}),u.jsxs(J,{opacity:.9,children:["Workspace: ",e]})]})]}),u.jsx(Zo,{}),u.jsx(lt,{align:"end",spacing:2,children:u.jsxs(ts,{textAlign:"right",children:[u.jsx(ns,{fontSize:"3xl",children:(i==null?void 0:i.length)??0}),u.jsx(rs,{color:"whiteAlpha.800",children:"Total Stores"})]})})]})})}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,children:[u.jsx(gt,{size:"lg",variant:"accent",leftIcon:u.jsx(vs,{}),onClick:()=>r("coveragestore",{mode:"create",data:{connectionId:t,workspace:e}}),py:8,children:"Create New Coverage Store"}),u.jsx(gt,{size:"lg",variant:"outline",leftIcon:u.jsx(Hl,{}),onClick:()=>r("upload",{mode:"create",data:{connectionId:t,workspace:e}}),py:8,children:"Upload GeoTIFF"})]}),i&&i.length>0&&u.jsx(Rr,{bg:n,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"stretch",spacing:4,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Existing Coverage Stores"}),u.jsx(Nr,{}),u.jsx(Wr,{columns:{base:1,md:2,lg:3},spacing:4,children:i.map(s=>u.jsx(OU,{name:s.name,type:s.type||"GeoTIFF",enabled:s.enabled,icon:wc,connectionId:t,workspace:e,storeType:"coveragestore"},s.name))})]})})})]})}function z1e({connectionId:t,workspace:e}){const r=bt(s=>s.openDialog),n=Bt("white","gray.800"),{data:i}=Xr({queryKey:["layers",t,e],queryFn:()=>D1(t,e)});return u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:hi,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:0,children:[u.jsx(pn,{size:"lg",children:"Layers"}),u.jsxs(J,{opacity:.9,children:["Workspace: ",e]})]})]}),u.jsx(Zo,{}),u.jsx(lt,{align:"end",spacing:2,children:u.jsxs(ts,{textAlign:"right",children:[u.jsx(ns,{fontSize:"3xl",children:(i==null?void 0:i.length)??0}),u.jsx(rs,{color:"whiteAlpha.800",children:"Published Layers"})]})})]})})}),u.jsx(gt,{size:"lg",variant:"accent",leftIcon:u.jsx(Hl,{}),onClick:()=>r("upload",{mode:"create",data:{connectionId:t,workspace:e}}),py:8,children:"Upload New Layer Data"}),i&&i.length>0&&u.jsx(Rr,{bg:n,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"stretch",spacing:4,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Published Layers"}),u.jsx(Nr,{}),u.jsx(Wr,{columns:{base:1,md:2,lg:3},spacing:4,children:i.map(s=>u.jsx(D1e,{name:s.name,connectionId:t,workspace:e,enabled:s.enabled},s.name))})]})})})]})}function M1e({connectionId:t,workspace:e,styleName:r,size:n=24}){const[i,s]=I.useState(!1),o=Js(w=>w.connections).find(w=>w.id===t),{data:d}=Xr({queryKey:["layers",t,e],queryFn:()=>D1(t,e),staleTime:6e4}),m=d==null?void 0:d.find(w=>w.defaultStyle===r);if(!o||i||!m)return u.jsx(ze,{as:Wo,color:"pink.500",boxSize:`${n}px`});const v=`${o.url.replace(/\/rest\/?$/,"")}/${e}/wms?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetLegendGraphic&LAYER=${e}:${m.name}&STYLE=${r}&FORMAT=image/png&WIDTH=${n}&HEIGHT=${n}&LEGEND_OPTIONS=forceLabels:off;fontAntiAliasing:true`;return u.jsx(ue,{as:"img",src:v,alt:r,w:`${n}px`,h:`${n}px`,minW:`${n}px`,minH:`${n}px`,borderRadius:"sm",objectFit:"contain",bg:"white",border:"1px solid",borderColor:"gray.200",onError:()=>s(!0)})}function I1e({connectionId:t,workspace:e}){const r=bt(s=>s.openDialog),n=Bt("white","gray.800"),{data:i}=Xr({queryKey:["styles",t,e],queryFn:()=>RM(t,e)});return u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:"linear-gradient(135deg, #5BB5E8 0%, #3B9DD9 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:_c,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:0,children:[u.jsx(pn,{size:"lg",children:"Styles"}),u.jsxs(J,{opacity:.9,children:["Workspace: ",e]})]})]}),u.jsx(Zo,{}),u.jsx(lt,{align:"end",spacing:2,children:u.jsxs(ts,{textAlign:"right",children:[u.jsx(ns,{fontSize:"3xl",children:(i==null?void 0:i.length)??0}),u.jsx(rs,{color:"whiteAlpha.800",children:"Total Styles"})]})})]})})}),u.jsxs(fe,{spacing:4,children:[u.jsx(gt,{size:"lg",variant:"accent",leftIcon:u.jsx(vs,{}),onClick:()=>r("style",{mode:"create",data:{connectionId:t,workspace:e}}),py:8,flex:1,children:"Create Style"}),u.jsx(gt,{size:"lg",variant:"outline",leftIcon:u.jsx(Hl,{}),onClick:()=>r("upload",{mode:"create",data:{connectionId:t,workspace:e}}),py:8,flex:1,children:"Upload SLD / CSS"})]}),i&&i.length>0&&u.jsx(Rr,{bg:n,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"stretch",spacing:4,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Existing Styles"}),u.jsx(Nr,{}),u.jsx(Wr,{columns:{base:1,md:2,lg:3},spacing:4,children:i.map(s=>u.jsx(Rr,{variant:"outline",size:"sm",cursor:"pointer",_hover:{shadow:"md",borderColor:"kartoza.300"},transition:"all 0.2s",onClick:()=>r("style",{mode:"edit",data:{connectionId:t,workspace:e,name:s.name}}),children:u.jsx(Lr,{py:3,px:4,children:u.jsxs(fe,{children:[u.jsx(M1e,{connectionId:t,workspace:e,styleName:s.name,size:24}),u.jsx(J,{fontWeight:"medium",children:s.name}),s.format&&u.jsx(Qt,{colorScheme:"blue",size:"sm",children:s.format})]})})},s.name))})]})})})]})}function R1e({connectionId:t,workspace:e}){const r=Bt("white","gray.800"),n=bt(s=>s.openDialog),{data:i}=Xr({queryKey:["layergroups",t,e],queryFn:()=>gU(t,e)});return u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:"linear-gradient(135deg, #1B6B9B 0%, #155a84 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:uf,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:0,children:[u.jsx(pn,{size:"lg",children:"Layer Groups"}),u.jsxs(J,{opacity:.9,children:["Workspace: ",e]})]})]}),u.jsx(Zo,{}),u.jsx(lt,{align:"end",spacing:2,children:u.jsxs(ts,{textAlign:"right",children:[u.jsx(ns,{fontSize:"3xl",children:(i==null?void 0:i.length)??0}),u.jsx(rs,{color:"whiteAlpha.800",children:"Total Groups"})]})})]})})}),u.jsx(gt,{size:"lg",variant:"accent",leftIcon:u.jsx(vs,{}),py:8,onClick:()=>n("layergroup",{mode:"create",data:{connectionId:t,workspace:e}}),children:"Create Layer Group"}),i&&i.length>0&&u.jsx(Rr,{bg:r,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"stretch",spacing:4,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Existing Layer Groups"}),u.jsx(Nr,{}),u.jsx(Wr,{columns:{base:1,md:2,lg:3},spacing:4,children:i.map(s=>u.jsx(Rr,{variant:"outline",size:"sm",children:u.jsx(Lr,{py:3,px:4,children:u.jsxs(fe,{children:[u.jsx(ze,{as:uf,color:"kartoza.500"}),u.jsx(J,{fontWeight:"medium",children:s.name}),s.mode&&u.jsx(Qt,{colorScheme:"purple",size:"sm",children:s.mode})]})})},s.name))})]})})})]})}function OU({name:t,type:e,enabled:r,icon:n,connectionId:i,workspace:s,storeType:a}){const o=bt(m=>m.setPreview),d=async()=>{try{const{url:m}=await il({connId:i,workspace:s,layerName:t,storeName:t,storeType:a,layerType:a==="coveragestore"?"raster":"vector"});o({url:m,layerName:t,workspace:s,connectionId:i,storeName:t,storeType:a,layerType:a==="coveragestore"?"raster":"vector"})}catch(m){bt.getState().setError(m.message)}};return u.jsx(Rr,{variant:"outline",size:"sm",_hover:{shadow:"md"},transition:"all 0.2s",children:u.jsx(Lr,{py:4,px:4,children:u.jsxs(lt,{align:"stretch",spacing:3,children:[u.jsxs(fe,{justify:"space-between",children:[u.jsxs(fe,{children:[u.jsx(ze,{as:n,color:"kartoza.500",boxSize:5}),u.jsx(J,{fontWeight:"medium",noOfLines:1,children:t})]}),u.jsx(Qt,{colorScheme:r?"green":"gray",size:"sm",children:r?"Enabled":"Disabled"})]}),u.jsx(J,{fontSize:"xs",color:"gray.500",children:e}),u.jsx(gt,{size:"sm",variant:"outline",leftIcon:u.jsx(Ri,{}),onClick:d,children:"Preview"})]})})})}function D1e({name:t,connectionId:e,workspace:r,enabled:n}){const i=bt(o=>o.setPreview),{data:s}=Xr({queryKey:["layer",e,r,t],queryFn:()=>fU(e,r,t)}),a=async()=>{try{const{url:o}=await il({connId:e,workspace:r,layerName:t,storeName:s==null?void 0:s.store,storeType:s==null?void 0:s.storeType,layerType:(s==null?void 0:s.storeType)==="coveragestore"?"raster":"vector"});i({url:o,layerName:t,workspace:r,connectionId:e,storeName:s==null?void 0:s.store,storeType:s==null?void 0:s.storeType,layerType:(s==null?void 0:s.storeType)==="coveragestore"?"raster":"vector"})}catch(o){bt.getState().setError(o.message)}};return u.jsx(Rr,{variant:"outline",size:"sm",_hover:{shadow:"md"},transition:"all 0.2s",children:u.jsx(Lr,{py:4,px:4,children:u.jsxs(lt,{align:"stretch",spacing:3,children:[u.jsxs(fe,{justify:"space-between",children:[u.jsxs(fe,{children:[u.jsx(ze,{as:hi,color:"kartoza.500",boxSize:5}),u.jsx(J,{fontWeight:"medium",noOfLines:1,children:t})]}),u.jsx(Qt,{colorScheme:n?"green":"gray",size:"sm",children:n?"Enabled":"Disabled"})]}),(s==null?void 0:s.defaultStyle)&&u.jsxs(J,{fontSize:"xs",color:"gray.500",children:["Style: ",s.defaultStyle]}),u.jsx(gt,{size:"sm",colorScheme:"kartoza",leftIcon:u.jsx(Sc,{}),onClick:a,children:"Preview on Map"})]})})})}function L1e({connectionId:t}){const r=Js(d=>d.connections).find(d=>d.id===t),n=bt(d=>d.openDialog),i=Bt("white","gray.800"),s=rm(),{data:a}=Xr({queryKey:["serverInfo",t],queryFn:()=>rbe(t)}),{data:o}=Xr({queryKey:["workspaces",t],queryFn:()=>aU(t)});return r?u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:ql,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:0,children:[u.jsx(pn,{size:"lg",children:r.name}),u.jsx(J,{opacity:.9,children:r.url})]})]}),u.jsx(Zo,{}),u.jsxs(fe,{children:[u.jsx(gt,{variant:"outline",color:"white",borderColor:"whiteAlpha.400",_hover:{bg:"whiteAlpha.200"},leftIcon:u.jsx(R1,{}),onClick:s.onOpen,children:"Service Metadata"}),u.jsx(Qt,{colorScheme:"green",fontSize:"md",px:4,py:2,children:"Connected"})]})]})})}),u.jsx(b1e,{isOpen:s.isOpen,onClose:s.onClose,connectionId:t,connectionName:r.name}),u.jsxs(Wr,{columns:{base:1,md:3},spacing:4,children:[u.jsx(Rr,{bg:i,children:u.jsx(Lr,{children:u.jsxs(ts,{children:[u.jsx(rs,{children:"Workspaces"}),u.jsx(ns,{color:"kartoza.700",children:(o==null?void 0:o.length)??0}),u.jsx(Hd,{children:"Total workspaces"})]})})}),a&&u.jsxs(u.Fragment,{children:[u.jsx(Rr,{bg:i,children:u.jsx(Lr,{children:u.jsxs(ts,{children:[u.jsx(rs,{children:"GeoServer"}),u.jsx(ns,{color:"kartoza.700",fontSize:"xl",children:a.GeoServerVersion}),u.jsx(Hd,{children:"Version"})]})})}),u.jsx(Rr,{bg:i,children:u.jsx(Lr,{children:u.jsxs(ts,{children:[u.jsx(rs,{children:"GeoTools"}),u.jsx(ns,{color:"kartoza.700",fontSize:"xl",children:a.GeoToolsVersion}),u.jsx(Hd,{children:"Version"})]})})})]})]}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,children:[u.jsx(gt,{size:"lg",variant:"accent",leftIcon:u.jsx(vs,{}),onClick:()=>n("workspace",{mode:"create",data:{connectionId:t}}),py:8,children:"Create New Workspace"}),u.jsx(gt,{size:"lg",variant:"outline",leftIcon:u.jsx(Hl,{}),onClick:()=>n("upload",{mode:"create"}),py:8,children:"Upload Data"})]})]}):null}function F1e({connectionId:t,workspace:e}){const r=Bt("white","gray.800"),n=bt(d=>d.openDialog),{data:i}=Xr({queryKey:["workspace",t,e],queryFn:()=>lU(t,e)}),{data:s}=Xr({queryKey:["datastores",t,e],queryFn:()=>MM(t,e)}),{data:a}=Xr({queryKey:["coveragestores",t,e],queryFn:()=>IM(t,e)}),{data:o}=Xr({queryKey:["layers",t,e],queryFn:()=>D1(t,e)});return u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:mh,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:1,children:[u.jsx(pn,{size:"lg",children:e}),u.jsxs(fe,{children:[(i==null?void 0:i.default)&&u.jsx(Qt,{colorScheme:"blue",children:"Default"}),(i==null?void 0:i.isolated)&&u.jsx(Qt,{colorScheme:"purple",children:"Isolated"}),(i==null?void 0:i.enabled)&&u.jsx(Qt,{colorScheme:"green",children:"Enabled"})]})]})]}),u.jsx(Zo,{}),u.jsx(gt,{variant:"outline",color:"white",borderColor:"whiteAlpha.400",_hover:{bg:"whiteAlpha.200"},onClick:()=>n("workspace",{mode:"edit",data:{connectionId:t,workspace:e}}),children:"Edit Workspace"})]})})}),u.jsxs(Wr,{columns:{base:1,md:3},spacing:4,children:[u.jsx(Rr,{bg:r,variant:"elevated",cursor:"pointer",children:u.jsx(Lr,{children:u.jsxs(ts,{children:[u.jsxs(fe,{children:[u.jsx(ze,{as:Wn,color:"kartoza.500",boxSize:6}),u.jsx(rs,{children:"Data Stores"})]}),u.jsx(ns,{color:"kartoza.700",children:(s==null?void 0:s.length)??0})]})})}),u.jsx(Rr,{bg:r,variant:"elevated",cursor:"pointer",children:u.jsx(Lr,{children:u.jsxs(ts,{children:[u.jsxs(fe,{children:[u.jsx(ze,{as:wc,color:"accent.400",boxSize:6}),u.jsx(rs,{children:"Coverage Stores"})]}),u.jsx(ns,{color:"kartoza.700",children:(a==null?void 0:a.length)??0})]})})}),u.jsx(Rr,{bg:r,variant:"elevated",cursor:"pointer",children:u.jsx(Lr,{children:u.jsxs(ts,{children:[u.jsxs(fe,{children:[u.jsx(ze,{as:hi,color:"kartoza.500",boxSize:6}),u.jsx(rs,{children:"Layers"})]}),u.jsx(ns,{color:"kartoza.700",children:(o==null?void 0:o.length)??0})]})})})]}),u.jsx(Rr,{bg:r,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"stretch",spacing:4,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Quick Actions"}),u.jsx(Nr,{}),u.jsxs(Wr,{columns:{base:1,md:3},spacing:4,children:[u.jsx(gt,{variant:"accent",leftIcon:u.jsx(Hl,{}),onClick:()=>n("upload",{mode:"create",data:{connectionId:t,workspace:e}}),children:"Upload Data"}),u.jsx(gt,{variant:"outline",leftIcon:u.jsx(vs,{}),onClick:()=>n("datastore",{mode:"create",data:{connectionId:t,workspace:e}}),children:"New Data Store"}),u.jsx(gt,{variant:"outline",leftIcon:u.jsx(vs,{}),onClick:()=>n("coveragestore",{mode:"create",data:{connectionId:t,workspace:e}}),children:"New Coverage Store"})]})]})})}),i&&u.jsx(Rr,{bg:r,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"start",spacing:3,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"OGC Services"}),u.jsx(Nr,{}),u.jsxs(fe,{wrap:"wrap",gap:2,children:[u.jsx(Qt,{colorScheme:i.wmsEnabled?"green":"gray",px:3,py:1,children:"WMS"}),u.jsx(Qt,{colorScheme:i.wfsEnabled?"green":"gray",px:3,py:1,children:"WFS"}),u.jsx(Qt,{colorScheme:i.wcsEnabled?"green":"gray",px:3,py:1,children:"WCS"}),u.jsx(Qt,{colorScheme:i.wmtsEnabled?"green":"gray",px:3,py:1,children:"WMTS"}),u.jsx(Qt,{colorScheme:i.wpsEnabled?"green":"gray",px:3,py:1,children:"WPS"})]})]})})})]})}function B1e({connectionId:t,workspace:e,storeName:r,storeType:n}){const i=Bt("white","gray.800"),s=bt(y=>y.setPreview),a=bt(y=>y.openDialog),o=n==="datastore",{data:d}=Xr({queryKey:[n+"s",t,e,r],queryFn:()=>o?cU(t,e,r):dU(t,e,r)}),m=async()=>{try{const{url:y}=await il({connId:t,workspace:e,layerName:r,storeName:r,storeType:n,layerType:o?"vector":"raster"});s({url:y,layerName:r,workspace:e,connectionId:t,storeName:r,storeType:n,layerType:o?"vector":"raster"})}catch(y){bt.getState().setError(y.message)}};return u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:o?"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)":"linear-gradient(135deg, #D4922A 0%, #E8A331 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:o?Wn:wc,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:1,children:[u.jsx(pn,{size:"lg",children:r}),u.jsxs(fe,{children:[u.jsx(Qt,{colorScheme:o?"blue":"orange",children:o?"Data Store":"Coverage Store"}),(d==null?void 0:d.enabled)&&u.jsx(Qt,{colorScheme:"green",children:"Enabled"})]})]})]}),u.jsx(Zo,{}),u.jsxs(fe,{wrap:"wrap",gap:2,children:[u.jsx(gt,{variant:"solid",bg:"whiteAlpha.200",color:"white",_hover:{bg:"whiteAlpha.300"},leftIcon:u.jsx(Sc,{}),onClick:m,children:"Preview on Map"}),u.jsx(gt,{variant:"outline",color:"white",borderColor:"whiteAlpha.400",_hover:{bg:"whiteAlpha.200"},leftIcon:u.jsx(_c,{}),onClick:()=>a(n,{mode:"edit",data:{connectionId:t,workspace:e,storeName:r}}),children:"Edit Store"})]})]})})}),u.jsx(Rr,{bg:i,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"start",spacing:3,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Store Details"}),u.jsx(Nr,{}),u.jsxs(Wr,{columns:2,spacing:4,w:"100%",children:[u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Workspace"}),u.jsx(J,{fontWeight:"medium",children:e})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Type"}),u.jsx(J,{fontWeight:"medium",children:(d==null?void 0:d.type)||"Unknown"})]})]})]})})})]})}function $1e({connectionId:t,workspace:e,layerName:r}){const n=Bt("white","gray.800"),i=bt(y=>y.setPreview),s=bt(y=>y.openDialog),{data:a}=Xr({queryKey:["layer",t,e,r],queryFn:()=>fU(t,e,r)}),o=async()=>{try{const{url:y}=await il({connId:t,workspace:e,layerName:r,storeName:a==null?void 0:a.store,storeType:a==null?void 0:a.storeType,layerType:(a==null?void 0:a.storeType)==="coveragestore"?"raster":"vector"});i({url:y,layerName:r,workspace:e,connectionId:t,storeName:a==null?void 0:a.store,storeType:a==null?void 0:a.storeType,layerType:(a==null?void 0:a.storeType)==="coveragestore"?"raster":"vector"})}catch(y){bt.getState().setError(y.message)}},d=()=>{s("info",{mode:"view",title:"Tile Cache",data:{connectionId:t,workspace:e,layerName:r}})},m=async()=>{try{const{url:y}=await il({connId:t,workspace:e,layerName:r,storeName:a==null?void 0:a.store,storeType:a==null?void 0:a.storeType,layerType:(a==null?void 0:a.storeType)==="coveragestore"?"raster":"vector",useCache:!0,gridSet:"EPSG:900913",tileFormat:"image/png"});i({url:y,layerName:r,workspace:e,connectionId:t,storeName:a==null?void 0:a.store,storeType:a==null?void 0:a.storeType,layerType:(a==null?void 0:a.storeType)==="coveragestore"?"raster":"vector"})}catch(y){bt.getState().setError(y.message)}};return u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:hi,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:1,children:[u.jsx(pn,{size:"lg",children:r}),u.jsxs(fe,{children:[u.jsx(Qt,{colorScheme:"teal",children:"Layer"}),(a==null?void 0:a.enabled)&&u.jsx(Qt,{colorScheme:"green",children:"Enabled"}),(a==null?void 0:a.advertised)&&u.jsx(Qt,{colorScheme:"blue",children:"Advertised"})]})]})]}),u.jsx(Zo,{}),u.jsxs(fe,{wrap:"wrap",gap:2,children:[u.jsx(gt,{size:"lg",variant:"accent",leftIcon:u.jsx(Sc,{}),onClick:o,children:"Preview (WMS)"}),u.jsx(gt,{size:"lg",variant:"outline",color:"white",borderColor:"whiteAlpha.400",_hover:{bg:"whiteAlpha.200"},leftIcon:u.jsx(Sc,{}),onClick:m,children:"Preview Cache"}),u.jsx(gt,{size:"lg",variant:"outline",color:"white",borderColor:"whiteAlpha.400",_hover:{bg:"whiteAlpha.200"},leftIcon:u.jsx(Wn,{}),onClick:d,children:"Manage Cache"}),u.jsx(gt,{size:"lg",variant:"outline",color:"white",borderColor:"whiteAlpha.400",_hover:{bg:"whiteAlpha.200"},leftIcon:u.jsx(_c,{}),onClick:()=>s("layer",{mode:"edit",data:{connectionId:t,workspace:e,layerName:r}}),children:"Edit Layer"})]})]})})}),a&&u.jsx(Rr,{bg:n,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"start",spacing:3,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Layer Configuration"}),u.jsx(Nr,{}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,w:"100%",children:[u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Workspace"}),u.jsx(J,{fontWeight:"medium",children:e})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Store"}),u.jsx(J,{fontWeight:"medium",children:a.store||"Unknown"})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Store Type"}),u.jsx(J,{fontWeight:"medium",children:a.storeType||"Unknown"})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Default Style"}),u.jsx(J,{fontWeight:"medium",children:a.defaultStyle||"None"})]})]})]})})}),u.jsx(Rr,{bg:n,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"stretch",spacing:4,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Tile Cache"}),u.jsx(Nr,{}),u.jsx(J,{fontSize:"sm",color:"gray.600",children:"Manage tile cache for this layer. Seed tiles for faster map viewing, or truncate the cache to regenerate tiles."}),u.jsx(Wr,{columns:{base:1,md:2},spacing:4,children:u.jsx(gt,{colorScheme:"kartoza",leftIcon:u.jsx(Wn,{}),onClick:d,children:"Seed / Truncate Cache"})})]})})})]})}function N1e({connectionId:t,workspace:e,groupName:r}){const n=Bt("white","gray.800"),i=bt(v=>v.setPreview),s=bt(v=>v.openDialog),{data:a}=Xr({queryKey:["layergroup",t,e,r],queryFn:()=>yU(t,e,r)}),o=async()=>{try{const{url:v}=await il({connId:t,workspace:e,layerName:r,layerType:"group"});i({url:v,layerName:r,workspace:e,connectionId:t,layerType:"group"})}catch(v){bt.getState().setError(v.message)}},d=()=>{s("info",{mode:"view",title:"Tile Cache",data:{connectionId:t,workspace:e,layerName:r}})},m=async()=>{try{const{url:v}=await il({connId:t,workspace:e,layerName:r,layerType:"group",useCache:!0,gridSet:"EPSG:900913",tileFormat:"image/png"});i({url:v,layerName:r,workspace:e,connectionId:t,layerType:"group"})}catch(v){bt.getState().setError(v.message)}},y=()=>{s("layergroup",{mode:"edit",data:{connectionId:t,workspace:e,name:r,layers:(a==null?void 0:a.layers.map(v=>v.name))||[],mode:a==null?void 0:a.mode,title:a==null?void 0:a.title}})};return u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:"linear-gradient(135deg, #1B6B9B 0%, #155a84 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:uf,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:1,children:[u.jsx(pn,{size:"lg",children:r}),u.jsxs(fe,{children:[u.jsx(Qt,{colorScheme:"purple",children:"Layer Group"}),(a==null?void 0:a.mode)&&u.jsx(Qt,{colorScheme:"blue",children:a.mode}),(a==null?void 0:a.enabled)&&u.jsx(Qt,{colorScheme:"green",children:"Enabled"})]})]})]}),u.jsx(Zo,{}),u.jsxs(fe,{wrap:"wrap",gap:2,children:[u.jsx(gt,{size:"lg",variant:"accent",leftIcon:u.jsx(Sc,{}),onClick:o,children:"Preview (WMS)"}),u.jsx(gt,{size:"lg",variant:"outline",color:"white",borderColor:"whiteAlpha.400",_hover:{bg:"whiteAlpha.200"},leftIcon:u.jsx(Sc,{}),onClick:m,children:"Preview Cache"}),u.jsx(gt,{size:"lg",variant:"outline",color:"white",borderColor:"whiteAlpha.400",_hover:{bg:"whiteAlpha.200"},leftIcon:u.jsx(Wn,{}),onClick:d,children:"Manage Cache"}),u.jsx(gt,{size:"lg",variant:"outline",color:"white",borderColor:"whiteAlpha.400",_hover:{bg:"whiteAlpha.200"},leftIcon:u.jsx(_c,{}),onClick:y,children:"Edit Layers"})]})]})})}),a&&u.jsxs(u.Fragment,{children:[u.jsx(Rr,{bg:n,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"start",spacing:3,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Group Configuration"}),u.jsx(Nr,{}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,w:"100%",children:[u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Workspace"}),u.jsx(J,{fontWeight:"medium",children:e})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Mode"}),u.jsx(J,{fontWeight:"medium",children:a.mode||"SINGLE"})]}),a.title&&u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Title"}),u.jsx(J,{fontWeight:"medium",children:a.title})]}),a.bounds&&u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Bounds"}),u.jsxs(J,{fontWeight:"medium",fontSize:"xs",children:["[",a.bounds.minX.toFixed(2),", ",a.bounds.minY.toFixed(2),", ",a.bounds.maxX.toFixed(2),", ",a.bounds.maxY.toFixed(2),"]"]})]})]})]})})}),u.jsx(Rr,{bg:n,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"stretch",spacing:3,children:[u.jsxs(pn,{size:"sm",color:"gray.600",children:["Layers in Group (",a.layers.length,")"]}),u.jsx(Nr,{}),u.jsx(lt,{align:"stretch",spacing:2,children:a.layers.map((v,w)=>u.jsxs(fe,{p:2,bg:"gray.50",borderRadius:"md",_dark:{bg:"gray.700"},children:[u.jsx(Qt,{colorScheme:v.type==="layer"?"teal":"purple",children:v.type}),u.jsx(J,{fontWeight:"medium",children:v.name}),v.styleName&&u.jsxs(J,{fontSize:"sm",color:"gray.500",children:["(Style: ",v.styleName,")"]})]},w))})]})})}),u.jsx(Rr,{bg:n,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"stretch",spacing:4,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Tile Cache"}),u.jsx(Nr,{}),u.jsx(J,{fontSize:"sm",color:"gray.600",children:"Manage tile cache for this layer group. Seed tiles for faster map viewing, or truncate the cache to regenerate tiles."}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,children:[u.jsx(gt,{colorScheme:"kartoza",leftIcon:u.jsx(Wn,{}),onClick:d,children:"Seed / Truncate Cache"}),u.jsx(gt,{variant:"outline",leftIcon:u.jsx(_c,{}),onClick:y,children:"Modify Layers"})]})]})})})]})]})}function V1e({connectionId:t,workspace:e,styleName:r}){var a;const n=Bt("white","gray.800"),i=bt(o=>o.openDialog),{data:s}=Xr({queryKey:["style",t,e,r],queryFn:()=>mU(t,e,r)});return u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:"linear-gradient(135deg, #3d9970 0%, #2d7a5a 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:_c,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:1,children:[u.jsx(pn,{size:"lg",children:r}),u.jsxs(fe,{children:[u.jsx(Qt,{colorScheme:"pink",children:"Style"}),(s==null?void 0:s.format)&&u.jsx(Qt,{colorScheme:"blue",children:s.format.toUpperCase()})]})]})]}),u.jsx(Zo,{}),u.jsx(gt,{size:"lg",variant:"accent",leftIcon:u.jsx(_c,{}),onClick:()=>i("style",{mode:"edit",data:{connectionId:t,workspace:e,name:r}}),children:"Edit Style"})]})})}),u.jsx(Rr,{bg:n,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"start",spacing:3,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Style Details"}),u.jsx(Nr,{}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,w:"100%",children:[u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Workspace"}),u.jsx(J,{fontWeight:"medium",children:e})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Format"}),u.jsx(J,{fontWeight:"medium",children:((a=s==null?void 0:s.format)==null?void 0:a.toUpperCase())||"Unknown"})]})]})]})})}),(s==null?void 0:s.content)&&u.jsx(Rr,{bg:n,children:u.jsx(Lr,{children:u.jsxs(lt,{align:"stretch",spacing:3,children:[u.jsx(pn,{size:"sm",color:"gray.600",children:"Style Content Preview"}),u.jsx(Nr,{}),u.jsxs(ue,{bg:"gray.50",_dark:{bg:"gray.900"},p:4,borderRadius:"md",maxH:"400px",overflowY:"auto",fontFamily:"mono",fontSize:"sm",whiteSpace:"pre-wrap",wordBreak:"break-all",children:[s.content.slice(0,2e3),s.content.length>2e3&&`...
[Content truncated - click Edit Style to see full content]`]})]})})})]})}const pF=lo`
  0% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(2);
    opacity: 0.5;
  }
  100% {
    transform: scale(3);
    opacity: 0;
  }
`,W1e=`
  M 115 95 Q 120 80 140 75 Q 160 70 180 78 Q 200 85 210 95 Q 220 105 215 120
  Q 210 135 195 145 Q 180 155 160 160 Q 140 165 125 155 Q 110 145 105 130
  Q 100 115 115 95 Z
  M 125 170 Q 135 165 145 170 Q 155 175 160 190 Q 165 205 158 225
  Q 150 245 140 255 Q 130 265 120 260 Q 110 255 108 240 Q 105 225 110 205
  Q 115 185 125 170 Z
  M 440 70 Q 460 65 480 72 Q 500 80 510 95 Q 520 110 515 125
  Q 510 140 495 145 Q 480 150 460 145 Q 440 140 430 125 Q 420 110 425 90 Q 430 75 440 70 Z
  M 455 155 Q 475 150 495 158 Q 515 165 525 185 Q 535 205 530 230
  Q 525 255 510 270 Q 495 285 475 282 Q 455 280 445 265 Q 435 250 438 225
  Q 440 200 445 180 Q 450 160 455 155 Z
  M 550 60 Q 590 50 640 55 Q 690 60 730 80 Q 770 100 790 130
  Q 810 160 800 195 Q 790 230 760 250 Q 730 270 690 275 Q 650 280 610 270
  Q 570 260 545 235 Q 520 210 520 175 Q 520 140 530 110 Q 540 80 550 60 Z
  M 770 280 Q 790 275 810 285 Q 830 295 835 315 Q 840 335 830 350
  Q 820 365 800 368 Q 780 370 765 360 Q 750 350 752 330 Q 755 310 760 295 Q 765 285 770 280 Z
`;function U1e(t){return!t||t==="localhost"||t==="127.0.0.1"?"Local development server on this machine":t.startsWith("192.168.")||t.startsWith("10.")||t.startsWith("172.")?"Server on local network (private IP address)":t.includes("kartoza.com")?"Kartoza cloud infrastructure, Cape Town, South Africa":t.includes("digitalocean.com")||t.includes(".do.")?"DigitalOcean cloud infrastructure":t.includes("aws.")||t.includes("amazonaws.com")?"Amazon Web Services (AWS) cloud":t.includes("azure.")||t.includes("microsoft.com")?"Microsoft Azure cloud":t.includes("gcp.")||t.includes("google")?"Google Cloud Platform":t.split(".").length>=2?`Remote server at ${t}`:`Server: ${t}`}function q1e(t){return!t||t==="localhost"||t==="127.0.0.1"||t.startsWith("192.168.")||t.startsWith("10.")||t.startsWith("172.")?{x:"48%",y:"35%"}:t.includes("kartoza.com")?{x:"53%",y:"72%"}:{x:"50%",y:"45%"}}function Q1e({host:t}){const e=Bt("blue.50","blue.900"),r=Bt("#94a3b8","#475569"),n=Bt("red.500","red.400"),i=Bt("red.300","red.600"),s=Bt("gray.100","gray.700"),a=Bt("gray.700","gray.200"),o=q1e(t),d=U1e(t);return u.jsxs(lt,{spacing:3,align:"stretch",children:[u.jsxs(ue,{position:"relative",bg:e,borderRadius:"xl",overflow:"hidden",h:"180px",w:"100%",children:[u.jsxs("svg",{viewBox:"0 0 900 400",style:{width:"100%",height:"100%"},preserveAspectRatio:"xMidYMid meet",children:[u.jsx("defs",{children:u.jsx("pattern",{id:"grid",width:"40",height:"40",patternUnits:"userSpaceOnUse",children:u.jsx("path",{d:"M 40 0 L 0 0 0 40",fill:"none",stroke:"currentColor",strokeWidth:"0.5",opacity:"0.1"})})}),u.jsx("rect",{width:"100%",height:"100%",fill:"url(#grid)"}),u.jsx("path",{d:W1e,fill:r,stroke:r,strokeWidth:"2",opacity:"0.6"})]}),u.jsxs(ue,{position:"absolute",left:o.x,top:o.y,transform:"translate(-50%, -50%)",children:[u.jsx(ue,{position:"absolute",w:"24px",h:"24px",borderRadius:"full",bg:i,animation:`${pF} 2s ease-out infinite`,transform:"translate(-50%, -50%)",left:"50%",top:"50%"}),u.jsx(ue,{position:"absolute",w:"24px",h:"24px",borderRadius:"full",bg:i,animation:`${pF} 2s ease-out infinite 0.6s`,transform:"translate(-50%, -50%)",left:"50%",top:"50%"}),u.jsx(ue,{w:"14px",h:"14px",borderRadius:"full",bg:n,shadow:"lg",position:"relative",zIndex:1,border:"2px solid white"})]}),u.jsx(ue,{position:"absolute",bottom:3,left:3,bg:"blackAlpha.700",px:3,py:1.5,borderRadius:"lg",children:u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:P2,color:"red.300",boxSize:4}),u.jsx(J,{fontSize:"sm",color:"white",fontWeight:"semibold",children:t||"localhost"})]})})]}),u.jsx(ue,{bg:s,px:4,py:2,borderRadius:"lg",children:u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:ql,color:"blue.500",boxSize:4}),u.jsx(J,{fontSize:"sm",color:a,children:d})]})})]})}function Jn({label:t,value:e,helpText:r,icon:n,colorScheme:i="blue"}){const s=Bt("white","gray.700"),a=Bt("gray.200","gray.600");return u.jsxs(ue,{bg:s,p:4,borderRadius:"xl",borderWidth:1,borderColor:a,shadow:"sm",transition:"all 0.2s",_hover:{shadow:"md",borderColor:`${i}.300`},children:[u.jsxs(fe,{spacing:3,mb:2,children:[u.jsx(ue,{p:2,borderRadius:"lg",bg:`${i}.50`,color:`${i}.500`,children:u.jsx(ze,{as:n,boxSize:5})}),u.jsx(J,{fontSize:"sm",fontWeight:"medium",color:"gray.500",children:t})]}),u.jsx(J,{fontSize:"2xl",fontWeight:"bold",children:e}),r&&u.jsx(J,{fontSize:"xs",color:"gray.400",mt:1,children:r})]})}function H1e({serviceName:t}){var y;const[e,r]=I.useState(null),[n,i]=I.useState(!0),[s,a]=I.useState(null),o=bt(v=>v.openDialog),d=Bt("white","gray.800");I.useEffect(()=>{i(!0),a(null),_U(t).then(r).catch(v=>a(v.message)).finally(()=>i(!1))},[t]);const m=I.useMemo(()=>{if(!(e!=null&&e.version))return"Unknown";const v=e.version.match(/PostgreSQL (\d+\.\d+)/);return v?`PostgreSQL ${v[1]}`:"PostgreSQL"},[e==null?void 0:e.version]);return n?u.jsx(im,{h:"400px",children:u.jsxs(lt,{spacing:4,children:[u.jsx(kn,{size:"xl",color:"blue.500",thickness:"4px"}),u.jsx(J,{color:"gray.500",children:"Loading server statistics..."})]})}):s?u.jsx(im,{h:"400px",children:u.jsxs(lt,{spacing:4,children:[u.jsx(ze,{as:Gp,boxSize:12,color:"red.500"}),u.jsx(J,{color:"red.500",fontWeight:"medium",children:s})]})}):e?u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:"linear-gradient(135deg, #336791 0%, #1a4e6d 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:fm,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:1,children:[u.jsxs(fe,{spacing:3,children:[u.jsx(pn,{size:"lg",children:t}),u.jsx(Qt,{colorScheme:"green",variant:"solid",fontSize:"xs",px:2,py:1,borderRadius:"full",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:lf,boxSize:3}),u.jsx(J,{children:"Connected"})]})})]}),u.jsxs(fe,{spacing:3,opacity:.9,children:[u.jsx(J,{fontSize:"sm",children:e.database_name}),u.jsx(J,{fontSize:"sm",children:"|"}),u.jsx(J,{fontSize:"sm",children:m}),e.has_postgis&&u.jsxs(u.Fragment,{children:[u.jsx(J,{fontSize:"sm",children:"|"}),u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:xs,boxSize:4}),u.jsx(J,{fontSize:"sm",children:"PostGIS"})]})]})]})]})]}),u.jsx(Zo,{}),u.jsxs(fe,{wrap:"wrap",gap:2,children:[u.jsx(gt,{variant:"solid",bg:"whiteAlpha.200",color:"white",_hover:{bg:"whiteAlpha.300"},leftIcon:u.jsx(Ml,{}),onClick:()=>o("query",{mode:"create",data:{serviceName:t}}),children:"SQL Query"}),u.jsx(gt,{variant:"outline",color:"white",borderColor:"whiteAlpha.400",_hover:{bg:"whiteAlpha.200"},leftIcon:u.jsx(Hl,{}),onClick:()=>o("pgupload",{mode:"create",data:{serviceName:t}}),children:"Import Data"})]})]})})}),u.jsx(Q1e,{host:e.host}),u.jsx(Rr,{bg:d,children:u.jsxs(Lr,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:A2,color:"purple.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"Connections"})]}),u.jsxs(Wr,{columns:{base:2,md:4},spacing:4,children:[u.jsx(Jn,{label:"Current",value:e.current_connections,helpText:`of ${e.max_connections} max`,icon:A2,colorScheme:"purple"}),u.jsx(Jn,{label:"Active",value:e.active_connections,helpText:"executing queries",icon:M1,colorScheme:"green"}),u.jsx(Jn,{label:"Idle",value:e.idle_connections,helpText:"waiting for work",icon:cC,colorScheme:"blue"}),u.jsx(Jn,{label:"Waiting",value:e.waiting_connections,helpText:"blocked on locks",icon:vu,colorScheme:"orange"})]}),u.jsxs(ue,{mt:4,children:[u.jsxs(fe,{justify:"space-between",mb:2,children:[u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Connection Pool Usage"}),u.jsxs(J,{fontSize:"sm",fontWeight:"bold",children:[e.connection_percent,"%"]})]}),u.jsx(Sf,{value:e.connection_percent,colorScheme:e.connection_percent>80?"red":e.connection_percent>60?"orange":"green",borderRadius:"full",size:"lg"})]})]})}),u.jsx(Rr,{bg:d,children:u.jsxs(Lr,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:Wn,color:"blue.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"Database"})]}),u.jsxs(Wr,{columns:{base:2,md:4},spacing:4,children:[u.jsx(Jn,{label:"Size",value:e.database_size,icon:yy,colorScheme:"blue"}),u.jsx(Jn,{label:"Cache Hit Ratio",value:e.cache_hit_ratio,helpText:"higher is better",icon:vu,colorScheme:"green"}),u.jsx(Jn,{label:"Live Tuples",value:e.live_tuples.toLocaleString(),icon:Vo,colorScheme:"purple"}),u.jsx(Jn,{label:"Dead Tuples",value:e.dead_tuples.toLocaleString(),helpText:"needs vacuum",icon:Gp,colorScheme:e.dead_tuples>1e4?"red":"gray"})]})]})}),u.jsx(Rr,{bg:d,children:u.jsxs(Lr,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:hi,color:"teal.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"Objects"})]}),u.jsxs(Wr,{columns:{base:3,md:5},spacing:4,children:[u.jsx(Jn,{label:"Schemas",value:e.schema_count,icon:hi,colorScheme:"teal"}),u.jsx(Jn,{label:"Tables",value:e.table_count,icon:Vo,colorScheme:"blue"}),u.jsx(Jn,{label:"Views",value:e.view_count,icon:Ri,colorScheme:"purple"}),u.jsx(Jn,{label:"Indexes",value:e.index_count,icon:vu,colorScheme:"orange"}),u.jsx(Jn,{label:"Functions",value:e.function_count,icon:Ml,colorScheme:"pink"})]})]})}),e.has_postgis&&u.jsx(Rr,{bg:d,children:u.jsxs(Lr,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:xs,color:"green.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"PostGIS"})]}),u.jsxs(Wr,{columns:{base:2,md:3},spacing:4,children:[u.jsx(Jn,{label:"Geometry Columns",value:e.geometry_columns||0,icon:xs,colorScheme:"green"}),u.jsx(Jn,{label:"Raster Columns",value:e.raster_columns||0,icon:hi,colorScheme:"blue"})]}),e.postgis_version&&u.jsx(ue,{mt:4,p:3,bg:"green.50",borderRadius:"lg",_dark:{bg:"green.900"},children:u.jsx(J,{fontSize:"xs",color:"green.700",fontFamily:"mono",noOfLines:2,_dark:{color:"green.200"},children:e.postgis_version})})]})}),u.jsx(Rr,{bg:d,children:u.jsxs(Lr,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:ql,color:"gray.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"Server Info"})]}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,children:[u.jsxs(ts,{children:[u.jsx(rs,{children:"Uptime"}),u.jsx(ns,{fontSize:"lg",children:e.uptime||"N/A"}),u.jsxs(Hd,{children:["Since ",(y=e.server_start_time)==null?void 0:y.split(" ")[0]]})]}),u.jsxs(ts,{children:[u.jsx(rs,{children:"Transactions"}),u.jsx(ns,{fontSize:"lg",children:e.xact_commit.toLocaleString()}),u.jsxs(Hd,{children:[e.xact_rollback.toLocaleString()," rollbacks"]})]})]}),u.jsx(ue,{mt:4,p:3,bg:"gray.100",borderRadius:"lg",_dark:{bg:"gray.700"},children:u.jsx(J,{fontSize:"xs",color:"gray.600",fontFamily:"mono",noOfLines:2,_dark:{color:"gray.300"},children:e.version})})]})}),e.installed_extensions&&e.installed_extensions.length>0&&u.jsx(Rr,{bg:d,children:u.jsxs(Lr,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:Ml,color:"indigo.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"Extensions"})]}),u.jsx(n0,{spacing:2,children:e.installed_extensions.map(v=>u.jsx(um,{children:u.jsx(wr,{label:v,fontSize:"xs",children:u.jsx(cm,{size:"md",colorScheme:v==="postgis"?"green":v==="plpgsql"?"blue":"gray",borderRadius:"full",children:v})})},v))})]})})]}):null}function G1e({serviceName:t,schemaName:e}){const[r,n]=I.useState(null),[i,s]=I.useState(!0),[a,o]=I.useState(null),d=bt(w=>w.openDialog),m=Bt("white","gray.800"),y=Bt("gray.50","gray.700"),v=Bt("gray.200","gray.600");return I.useEffect(()=>{s(!0),o(null),qbe(t,e).then(n).catch(w=>o(w.message)).finally(()=>s(!1))},[t,e]),i?u.jsx(im,{h:"400px",children:u.jsxs(lt,{spacing:4,children:[u.jsx(kn,{size:"xl",color:"teal.500",thickness:"4px"}),u.jsx(J,{color:"gray.500",children:"Loading schema statistics..."})]})}):a?u.jsx(im,{h:"400px",children:u.jsxs(lt,{spacing:4,children:[u.jsx(ze,{as:Gp,boxSize:12,color:"red.500"}),u.jsx(J,{color:"red.500",fontWeight:"medium",children:a})]})}):r?u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Rr,{bg:"linear-gradient(135deg, #0d9488 0%, #14b8a6 100%)",color:"white",children:u.jsx(Lr,{py:8,px:6,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:4,children:[u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:3,borderRadius:"lg",children:u.jsx(ze,{as:hi,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:1,children:[u.jsx(fe,{spacing:3,children:u.jsx(pn,{size:"lg",children:e})}),u.jsxs(fe,{spacing:3,opacity:.9,children:[u.jsx(J,{fontSize:"sm",children:r.database_name}),u.jsx(J,{fontSize:"sm",children:"|"}),u.jsxs(J,{fontSize:"sm",children:["Owner: ",r.owner]}),r.has_postgis&&u.jsxs(u.Fragment,{children:[u.jsx(J,{fontSize:"sm",children:"|"}),u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:xs,boxSize:4}),u.jsx(J,{fontSize:"sm",children:"PostGIS"})]})]})]})]})]}),u.jsx(Zo,{}),u.jsxs(fe,{wrap:"wrap",gap:2,children:[u.jsx(gt,{variant:"solid",bg:"whiteAlpha.200",color:"white",_hover:{bg:"whiteAlpha.300"},leftIcon:u.jsx(Ml,{}),onClick:()=>d("query",{mode:"create",data:{serviceName:t,schemaName:e}}),children:"SQL Query"}),u.jsx(gt,{variant:"outline",color:"white",borderColor:"whiteAlpha.400",_hover:{bg:"whiteAlpha.200"},leftIcon:u.jsx(Hl,{}),onClick:()=>d("pgupload",{mode:"create",data:{serviceName:t,schemaName:e}}),children:"Import Data"})]})]})})}),u.jsx(Rr,{bg:m,children:u.jsxs(Lr,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:yy,color:"teal.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"Schema Size"})]}),u.jsxs(Wr,{columns:{base:2,md:4},spacing:4,children:[u.jsx(Jn,{label:"Total Size",value:r.total_size||"0 bytes",icon:yy,colorScheme:"teal"}),u.jsx(Jn,{label:"Total Rows",value:r.total_rows.toLocaleString(),icon:Vo,colorScheme:"blue"}),u.jsx(Jn,{label:"Dead Tuples",value:r.dead_tuples.toLocaleString(),helpText:r.dead_tuples>1e3?"Consider VACUUM":"",icon:Gp,colorScheme:r.dead_tuples>1e3?"orange":"gray"}),u.jsx(Jn,{label:"Tables",value:r.table_count,icon:Vo,colorScheme:"purple"})]})]})}),u.jsx(Rr,{bg:m,children:u.jsxs(Lr,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:hi,color:"purple.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"Objects"})]}),u.jsxs(Wr,{columns:{base:3,md:6},spacing:4,children:[u.jsx(Jn,{label:"Tables",value:r.table_count,icon:Vo,colorScheme:"blue"}),u.jsx(Jn,{label:"Views",value:r.view_count,icon:Ri,colorScheme:"purple"}),u.jsx(Jn,{label:"Indexes",value:r.index_count,icon:vu,colorScheme:"orange"}),u.jsx(Jn,{label:"Functions",value:r.function_count,icon:Ml,colorScheme:"pink"}),u.jsx(Jn,{label:"Sequences",value:r.sequence_count,icon:M1,colorScheme:"cyan"}),u.jsx(Jn,{label:"Triggers",value:r.trigger_count,icon:vu,colorScheme:"red"})]})]})}),r.has_postgis&&(r.geometry_columns>0||r.raster_columns>0)&&u.jsx(Rr,{bg:m,children:u.jsxs(Lr,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:xs,color:"green.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"PostGIS"})]}),u.jsxs(Wr,{columns:{base:2,md:2},spacing:4,children:[u.jsx(Jn,{label:"Geometry Columns",value:r.geometry_columns,icon:xs,colorScheme:"green"}),u.jsx(Jn,{label:"Raster Columns",value:r.raster_columns,icon:wc,colorScheme:"blue"})]})]})}),r.tables&&r.tables.length>0&&u.jsx(Rr,{bg:m,children:u.jsxs(Lr,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:Vo,color:"blue.500"}),u.jsxs(J,{fontWeight:"semibold",fontSize:"lg",children:["Tables (",r.tables.length,")"]})]}),u.jsx(lt,{align:"stretch",spacing:2,children:r.tables.map(w=>u.jsx(ue,{p:3,bg:y,borderRadius:"lg",borderWidth:1,borderColor:v,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:2,children:[u.jsxs(fe,{flex:"1",minW:"200px",children:[u.jsx(ze,{as:w.has_geometry?xs:Vo,color:w.has_geometry?"green.500":"blue.500",boxSize:4}),u.jsx(J,{fontWeight:"medium",children:w.name}),w.has_primary_key&&u.jsx(wr,{label:"Has Primary Key",children:u.jsx(Qt,{colorScheme:"blue",size:"sm",variant:"subtle",children:"PK"})}),w.has_geometry&&u.jsx(wr,{label:`${w.geometry_type} (SRID: ${w.srid})`,children:u.jsx(Qt,{colorScheme:"green",size:"sm",variant:"subtle",children:w.geometry_type})})]}),u.jsxs(fe,{spacing:4,fontSize:"sm",color:"gray.500",children:[u.jsx(wr,{label:"Row count",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:Vo,boxSize:3}),u.jsxs(J,{children:[w.row_count.toLocaleString()," rows"]})]})}),u.jsx(wr,{label:"Table size",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:yy,boxSize:3}),u.jsx(J,{children:w.size})]})}),u.jsx(wr,{label:"Index count",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:vu,boxSize:3}),u.jsxs(J,{children:[w.index_count," idx"]})]})}),w.dead_tuples>0&&u.jsx(wr,{label:"Dead tuples - consider VACUUM",children:u.jsxs(fe,{spacing:1,color:w.dead_tuples>100?"orange.500":"gray.500",children:[u.jsx(ze,{as:Gp,boxSize:3}),u.jsxs(J,{children:[w.dead_tuples," dead"]})]})})]}),u.jsxs(fe,{spacing:2,children:[u.jsx(wr,{label:"View data",children:u.jsx(gt,{size:"xs",variant:"ghost",colorScheme:"blue",onClick:()=>d("dataviewer",{mode:"view",data:{serviceName:t,schemaName:e,tableName:w.name}}),children:u.jsx(ze,{as:Ri})})}),u.jsx(wr,{label:"Query",children:u.jsx(gt,{size:"xs",variant:"ghost",colorScheme:"teal",onClick:()=>d("query",{mode:"view",data:{serviceName:t,schemaName:e,tableName:w.name,initialSQL:`SELECT * FROM "${e}"."${w.name}" LIMIT 100`}}),children:u.jsx(ze,{as:Ml})})})]})]})},w.name))})]})}),r.views&&r.views.length>0&&u.jsx(Rr,{bg:m,children:u.jsxs(Lr,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:Ri,color:"purple.500"}),u.jsxs(J,{fontWeight:"semibold",fontSize:"lg",children:["Views (",r.views.length,")"]})]}),u.jsx(lt,{align:"stretch",spacing:2,children:r.views.map(w=>u.jsx(ue,{p:3,bg:y,borderRadius:"lg",borderWidth:1,borderColor:v,children:u.jsxs(yr,{align:"center",wrap:"wrap",gap:2,children:[u.jsxs(fe,{flex:"1",children:[u.jsx(ze,{as:Ri,color:"purple.500",boxSize:4}),u.jsx(J,{fontWeight:"medium",children:w.name}),w.is_materialized&&u.jsx(Qt,{colorScheme:"orange",size:"sm",variant:"subtle",children:"Materialized"})]}),u.jsxs(fe,{spacing:2,children:[u.jsx(wr,{label:"View data",children:u.jsx(gt,{size:"xs",variant:"ghost",colorScheme:"purple",onClick:()=>d("dataviewer",{mode:"view",data:{serviceName:t,schemaName:e,tableName:w.name,isView:!0}}),children:u.jsx(ze,{as:Ri})})}),u.jsx(wr,{label:"Query",children:u.jsx(gt,{size:"xs",variant:"ghost",colorScheme:"teal",onClick:()=>d("query",{mode:"view",data:{serviceName:t,schemaName:e,tableName:w.name,initialSQL:`SELECT * FROM "${e}"."${w.name}" LIMIT 100`}}),children:u.jsx(ze,{as:Ml})})})]})]})},w.name))})]})})]}):null}const cu={default:{type:"spring",stiffness:300,damping:24,mass:1},snappy:{type:"spring",stiffness:400,damping:28,mass:.8},bouncy:{type:"spring",stiffness:500,damping:15,mass:1}},mF={hidden:{opacity:0,x:20,height:0},visible:{opacity:1,x:0,height:"auto",transition:{...cu.snappy,staggerChildren:.05}},exit:{opacity:0,x:-20,height:0,transition:{duration:.2}}},Wc={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:cu.snappy},exit:{opacity:0,y:-10,transition:{duration:.1}}};function X1e(){var Te;const t=bt(ct=>ct.activeDialog),e=bt(ct=>ct.dialogData),r=bt(ct=>ct.closeDialog),n=Js(ct=>ct.addConnection),i=Js(ct=>ct.updateConnection),s=Js(ct=>ct.testConnection),a=Js(ct=>ct.connections),o=Js(ct=>ct.refreshPGServices),[d,m]=I.useState("geoserver"),[y,v]=I.useState(""),[w,O]=I.useState(""),[P,E]=I.useState(""),[$,R]=I.useState(""),[F,D]=I.useState(!1),[U,X]=I.useState(""),[ee,K]=I.useState("localhost"),[Y,ne]=I.useState("5432"),[oe,ce]=I.useState(""),[Xe,Ae]=I.useState(""),[We,Ye]=I.useState(""),[tt,Be]=I.useState("prefer"),[Me,Ge]=I.useState(!1),[De,Le]=I.useState(!1),[Oe,Ie]=I.useState(!1),[st,Re]=I.useState(null),it=Yo(),Ke=t==="connection",St=(e==null?void 0:e.mode)==="edit",Mt=(Te=e==null?void 0:e.data)==null?void 0:Te.connectionId;I.useEffect(()=>{if(Ke&&St&&Mt){const ct=a.find(Vt=>Vt.id===Mt);ct&&(m("geoserver"),v(ct.name),O(ct.url),E(ct.username),R(ct.password||""),D(!1))}else Ke&&!St&&(m("geoserver"),v(""),O(""),E(""),R(""),D(!1),X(""),K("localhost"),ne("5432"),ce(""),Ae(""),Ye(""),Be("prefer"),Ge(!1));Re(null)},[Ke,St,Mt,a]);const Et=async()=>{Ie(!0),Re(null);try{if(d==="geoserver"){if(!Mt&&!w){it({title:"URL required",description:"Please enter a GeoServer URL first",status:"warning",duration:3e3}),Ie(!1);return}if(Mt){const ct=await s(Mt);Re(ct)}else{const ct=await n({name:y||"Test",url:w,username:P,password:$}),Vt=await s(ct.id);Vt.success||await Js.getState().removeConnection(ct.id),Re(Vt)}}else{if(!U){it({title:"Service name required",description:"Please enter a service name first",status:"warning",duration:3e3}),Ie(!1);return}await uF({name:U,host:ee,port:Y,dbname:oe,user:Xe,password:We,sslmode:tt});const Vt=await vU(U);Re(Vt)}}catch(ct){Re({success:!1,message:ct.message})}finally{Ie(!1)}},xt=async()=>{Le(!0);try{if(d==="geoserver"){if(!y||!w){it({title:"Required fields",description:"Name and URL are required",status:"warning",duration:3e3}),Le(!1);return}St&&Mt?(await i(Mt,{name:y,url:w,username:P,password:$||void 0}),it({title:"Connection updated",status:"success",duration:2e3})):(await n({name:y,url:w,username:P,password:$}),it({title:"Connection added",status:"success",duration:2e3}))}else{if(!U||!ee||!oe){it({title:"Required fields",description:"Service name, host, and database are required",status:"warning",duration:3e3}),Le(!1);return}await uF({name:U,host:ee,port:Y,dbname:oe,user:Xe,password:We,sslmode:tt}),await(o==null?void 0:o()),it({title:"PostgreSQL service added",description:`Service "${U}" saved to pg_service.conf`,status:"success",duration:3e3})}r()}catch(ct){it({title:"Error",description:ct.message,status:"error",duration:5e3})}finally{Le(!1)}},et=()=>d==="geoserver"?"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)":"linear-gradient(135deg, #336791 0%, #5B93C5 100%)",Yt=()=>d==="geoserver"?ql:Wn,_t=()=>St?"Edit Connection":d==="geoserver"?"Add GeoServer":"Add PostgreSQL",rt=()=>St?"Update your connection settings":d==="geoserver"?"Connect to a GeoServer instance":"Add a PostgreSQL service to pg_service.conf";return u.jsxs(ss,{isOpen:Ke,onClose:r,size:"lg",isCentered:!0,children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{borderRadius:"xl",overflow:"hidden",children:[u.jsx(Ln.div,{animate:{background:et()},transition:{duration:.3},style:{padding:"16px 24px"},children:u.jsxs(fe,{spacing:3,children:[u.jsx(Ln.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:cu.bouncy,children:u.jsx(ue,{bg:"whiteAlpha.200",p:2,borderRadius:"lg",children:u.jsx(ze,{as:Yt(),boxSize:5,color:"white"})})},d),u.jsxs(ue,{children:[u.jsx(Ln.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:cu.snappy,children:u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:_t()})},`title-${d}`),u.jsx(Ln.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{...cu.snappy,delay:.1},children:u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:rt()})},`subtitle-${d}`)]})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:6,children:u.jsxs(lt,{spacing:4,children:[!St&&u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Connection Type"}),u.jsxs(fe,{spacing:3,children:[u.jsx(Ln.div,{style:{flex:1},whileHover:{scale:1.02},whileTap:{scale:.98},children:u.jsx(ue,{as:"button",type:"button",onClick:()=>m("geoserver"),w:"100%",p:4,borderRadius:"lg",border:"2px solid",borderColor:d==="geoserver"?"blue.500":"gray.200",bg:d==="geoserver"?"blue.50":"white",transition:"all 0.2s",_hover:{borderColor:"blue.300"},children:u.jsxs(lt,{spacing:1,children:[u.jsx(ze,{as:ql,boxSize:6,color:d==="geoserver"?"blue.500":"gray.400"}),u.jsx(J,{fontWeight:"500",color:d==="geoserver"?"blue.700":"gray.600",children:"GeoServer"}),u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Web map server"})]})})}),u.jsx(Ln.div,{style:{flex:1},whileHover:{scale:1.02},whileTap:{scale:.98},children:u.jsx(ue,{as:"button",type:"button",onClick:()=>m("postgresql"),w:"100%",p:4,borderRadius:"lg",border:"2px solid",borderColor:d==="postgresql"?"blue.500":"gray.200",bg:d==="postgresql"?"blue.50":"white",transition:"all 0.2s",_hover:{borderColor:"blue.300"},children:u.jsxs(lt,{spacing:1,children:[u.jsx(ze,{as:Wn,boxSize:6,color:d==="postgresql"?"blue.500":"gray.400"}),u.jsx(J,{fontWeight:"500",color:d==="postgresql"?"blue.700":"gray.600",children:"PostgreSQL"}),u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Database service"})]})})})]})]}),u.jsx(Nr,{}),u.jsxs(vc,{mode:"wait",children:[d==="geoserver"&&u.jsx(Ln.div,{variants:mF,initial:"hidden",animate:"visible",exit:"exit",style:{width:"100%"},children:u.jsxs(lt,{spacing:4,w:"100%",children:[u.jsx(Ln.div,{variants:Wc,style:{width:"100%"},children:u.jsxs(Ot,{isRequired:!0,children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Name"}),u.jsx(Ar,{value:y,onChange:ct=>v(ct.target.value),placeholder:"My GeoServer",size:"lg",borderRadius:"lg"})]})}),u.jsx(Ln.div,{variants:Wc,style:{width:"100%"},children:u.jsxs(Ot,{isRequired:!0,children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"URL"}),u.jsx(Ar,{value:w,onChange:ct=>O(ct.target.value),placeholder:"http://localhost:8080/geoserver",size:"lg",borderRadius:"lg"})]})}),u.jsx(Ln.div,{variants:Wc,style:{width:"100%"},children:u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Username"}),u.jsx(Ar,{value:P,onChange:ct=>E(ct.target.value),placeholder:"admin",size:"lg",borderRadius:"lg"})]})}),u.jsx(Ln.div,{variants:Wc,style:{width:"100%"},children:u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Password"}),u.jsxs(da,{size:"lg",children:[u.jsx(Ar,{type:F?"text":"password",value:$,onChange:ct=>R(ct.target.value),placeholder:St?"(unchanged)":"password",borderRadius:"lg"}),u.jsx(Pb,{h:"full",children:u.jsx(gr,{"aria-label":F?"Hide password":"Show password",icon:F?u.jsx(cf,{}):u.jsx(Ri,{}),variant:"ghost",size:"md",onClick:()=>D(!F)})})]})]})})]})},"geoserver-form"),d==="postgresql"&&u.jsx(Ln.div,{variants:mF,initial:"hidden",animate:"visible",exit:"exit",style:{width:"100%"},children:u.jsxs(lt,{spacing:4,w:"100%",children:[u.jsx(Ln.div,{variants:Wc,style:{width:"100%"},children:u.jsxs(Ot,{isRequired:!0,children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Service Name"}),u.jsx(Ar,{value:U,onChange:ct=>X(ct.target.value),placeholder:"my_database",size:"lg",borderRadius:"lg"}),u.jsx(J,{fontSize:"xs",color:"gray.500",mt:1,children:"This will be saved to ~/.pg_service.conf"})]})}),u.jsx(Ln.div,{variants:Wc,style:{width:"100%"},children:u.jsxs(fe,{spacing:4,children:[u.jsxs(Ot,{isRequired:!0,flex:2,children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Host"}),u.jsx(Ar,{value:ee,onChange:ct=>K(ct.target.value),placeholder:"localhost",size:"lg",borderRadius:"lg"})]}),u.jsxs(Ot,{flex:1,children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Port"}),u.jsx(Ar,{value:Y,onChange:ct=>ne(ct.target.value),placeholder:"5432",size:"lg",borderRadius:"lg"})]})]})}),u.jsx(Ln.div,{variants:Wc,style:{width:"100%"},children:u.jsxs(Ot,{isRequired:!0,children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Database"}),u.jsx(Ar,{value:oe,onChange:ct=>ce(ct.target.value),placeholder:"postgres",size:"lg",borderRadius:"lg"})]})}),u.jsx(Ln.div,{variants:Wc,style:{width:"100%"},children:u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Username"}),u.jsx(Ar,{value:Xe,onChange:ct=>Ae(ct.target.value),placeholder:"postgres",size:"lg",borderRadius:"lg"})]})}),u.jsx(Ln.div,{variants:Wc,style:{width:"100%"},children:u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Password"}),u.jsxs(da,{size:"lg",children:[u.jsx(Ar,{type:Me?"text":"password",value:We,onChange:ct=>Ye(ct.target.value),placeholder:"password",borderRadius:"lg"}),u.jsx(Pb,{h:"full",children:u.jsx(gr,{"aria-label":Me?"Hide password":"Show password",icon:Me?u.jsx(cf,{}):u.jsx(Ri,{}),variant:"ghost",size:"md",onClick:()=>Ge(!Me)})})]})]})}),u.jsx(Ln.div,{variants:Wc,style:{width:"100%"},children:u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"SSL Mode"}),u.jsxs(zn,{value:tt,onChange:ct=>Be(ct.target.value),size:"lg",borderRadius:"lg",children:[u.jsx("option",{value:"disable",children:"disable"}),u.jsx("option",{value:"allow",children:"allow"}),u.jsx("option",{value:"prefer",children:"prefer"}),u.jsx("option",{value:"require",children:"require"}),u.jsx("option",{value:"verify-ca",children:"verify-ca"}),u.jsx("option",{value:"verify-full",children:"verify-full"})]})]})})]})},"postgresql-form")]}),u.jsx(vc,{children:st&&u.jsx(Ln.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,scale:.95},transition:cu.snappy,style:{width:"100%"},children:u.jsxs(io,{status:st.success?"success":"error",borderRadius:"lg",variant:"subtle",children:[u.jsx(so,{}),u.jsx(J,{fontSize:"sm",children:st.message})]})})})]})}),u.jsxs(To,{gap:3,borderTop:"1px solid",borderTopColor:"gray.100",bg:"gray.50",children:[u.jsx(gt,{variant:"outline",onClick:Et,isLoading:Oe,loadingText:"Testing...",leftIcon:u.jsx(AM,{}),borderRadius:"lg",flexShrink:0,children:"Test Connection"}),u.jsx(gt,{variant:"ghost",onClick:r,borderRadius:"lg",children:"Cancel"}),u.jsx(Ln.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:u.jsx(gt,{colorScheme:d==="geoserver"?"blue":"purple",onClick:xt,isLoading:De,borderRadius:"lg",px:6,children:St?"Save Changes":"Add Connection"})})]})]})]})}const gF={name:"",isolated:!1,default:!1,enabled:!0,wmtsEnabled:!1,wmsEnabled:!0,wcsEnabled:!0,wpsEnabled:!1,wfsEnabled:!0};function K1e(){var F,D;const t=bt(U=>U.activeDialog),e=bt(U=>U.dialogData),r=bt(U=>U.closeDialog),n=Er(U=>U.selectedNode),i=Js(U=>U.activeConnectionId),s=Jo(),a=Yo(),[o,d]=I.useState(gF),[m,y]=I.useState(!1),v=t==="workspace",w=(e==null?void 0:e.mode)==="edit",O=((F=e==null?void 0:e.data)==null?void 0:F.connectionId)||(n==null?void 0:n.connectionId)||i,P=(D=e==null?void 0:e.data)==null?void 0:D.workspace,{data:E}=Xr({queryKey:["workspace",O,P],queryFn:()=>lU(O,P),enabled:v&&w&&!!O&&!!P});I.useEffect(()=>{v&&d(w&&E?E:gF)},[v,w,E]);const $=(U,X)=>{d(ee=>({...ee,[U]:X}))},R=async()=>{if(!O){a({title:"No connection selected",description:"Please select a connection first",status:"warning",duration:3e3});return}if(!o.name){a({title:"Name required",description:"Please enter a workspace name",status:"warning",duration:3e3});return}y(!0);try{w&&P?(await ibe(O,P,o),a({title:"Workspace updated",status:"success",duration:2e3})):(await nbe(O,o),a({title:"Workspace created",status:"success",duration:2e3})),s.invalidateQueries({queryKey:["workspaces",O]}),r()}catch(U){a({title:"Error",description:U.message,status:"error",duration:5e3})}finally{y(!1)}};return u.jsxs(ss,{isOpen:v,onClose:r,size:"lg",isCentered:!0,children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{borderRadius:"xl",overflow:"hidden",children:[u.jsx(ue,{bg:"linear-gradient(135deg, #E8A331 0%, #F0B84D 100%)",px:6,py:4,children:u.jsxs(fe,{spacing:3,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:2,borderRadius:"lg",children:u.jsx(ze,{as:mh,boxSize:5,color:"white"})}),u.jsxs(ue,{children:[u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:w?"Edit Workspace":"Create Workspace"}),u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:w?"Update workspace settings":"Create a new GeoServer workspace"})]})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:6,children:u.jsxs(lt,{spacing:5,align:"stretch",children:[u.jsxs(Ot,{isRequired:!0,children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Workspace Name"}),u.jsx(Ar,{value:o.name,onChange:U=>$("name",U.target.value),placeholder:"my_workspace",isDisabled:w,size:"lg",borderRadius:"lg"})]}),u.jsxs(ue,{p:4,bg:"gray.50",borderRadius:"lg",children:[u.jsx(pn,{size:"sm",mb:3,color:"gray.700",children:"Workspace Settings"}),u.jsxs(Wr,{columns:3,spacing:4,children:[u.jsxs(Ot,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[u.jsx(jt,{mb:0,fontWeight:"normal",children:"Isolated"}),u.jsx(fa,{isChecked:o.isolated,onChange:U=>$("isolated",U.target.checked),colorScheme:"kartoza"})]}),u.jsxs(Ot,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[u.jsx(jt,{mb:0,fontWeight:"normal",children:"Default"}),u.jsx(fa,{isChecked:o.default,onChange:U=>$("default",U.target.checked),colorScheme:"kartoza"})]}),u.jsxs(Ot,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[u.jsx(jt,{mb:0,fontWeight:"normal",children:"Enabled"}),u.jsx(fa,{isChecked:o.enabled,onChange:U=>$("enabled",U.target.checked),colorScheme:"kartoza"})]})]})]}),u.jsxs(ue,{p:4,bg:"gray.50",borderRadius:"lg",children:[u.jsx(pn,{size:"sm",mb:3,color:"gray.700",children:"OGC Services"}),u.jsxs(Wr,{columns:5,spacing:4,children:[u.jsxs(Ot,{display:"flex",alignItems:"center",flexDirection:"column",gap:1,children:[u.jsx(jt,{mb:0,fontSize:"sm",fontWeight:"500",color:"gray.600",children:"WMS"}),u.jsx(fa,{isChecked:o.wmsEnabled,onChange:U=>$("wmsEnabled",U.target.checked),colorScheme:"kartoza",size:"md"})]}),u.jsxs(Ot,{display:"flex",alignItems:"center",flexDirection:"column",gap:1,children:[u.jsx(jt,{mb:0,fontSize:"sm",fontWeight:"500",color:"gray.600",children:"WFS"}),u.jsx(fa,{isChecked:o.wfsEnabled,onChange:U=>$("wfsEnabled",U.target.checked),colorScheme:"kartoza",size:"md"})]}),u.jsxs(Ot,{display:"flex",alignItems:"center",flexDirection:"column",gap:1,children:[u.jsx(jt,{mb:0,fontSize:"sm",fontWeight:"500",color:"gray.600",children:"WCS"}),u.jsx(fa,{isChecked:o.wcsEnabled,onChange:U=>$("wcsEnabled",U.target.checked),colorScheme:"kartoza",size:"md"})]}),u.jsxs(Ot,{display:"flex",alignItems:"center",flexDirection:"column",gap:1,children:[u.jsx(jt,{mb:0,fontSize:"sm",fontWeight:"500",color:"gray.600",children:"WMTS"}),u.jsx(fa,{isChecked:o.wmtsEnabled,onChange:U=>$("wmtsEnabled",U.target.checked),colorScheme:"kartoza",size:"md"})]}),u.jsxs(Ot,{display:"flex",alignItems:"center",flexDirection:"column",gap:1,children:[u.jsx(jt,{mb:0,fontSize:"sm",fontWeight:"500",color:"gray.600",children:"WPS"}),u.jsx(fa,{isChecked:o.wpsEnabled,onChange:U=>$("wpsEnabled",U.target.checked),colorScheme:"kartoza",size:"md"})]})]})]})]})}),u.jsxs(To,{gap:3,borderTop:"1px solid",borderTopColor:"gray.100",bg:"gray.50",children:[u.jsx(gt,{variant:"ghost",onClick:r,borderRadius:"lg",children:"Cancel"}),u.jsx(gt,{colorScheme:"kartoza",onClick:R,isLoading:m,borderRadius:"lg",px:6,children:w?"Save Changes":"Create Workspace"})]})]})]})}function Z1e(){const t=bt(O=>O.activeDialog),e=bt(O=>O.dialogData),r=bt(O=>O.closeDialog),n=Js(O=>O.removeConnection),i=Jo(),s=Yo(),[a,o]=I.useState(!1),d=t==="confirm",m=(e==null?void 0:e.title)||"Confirm",y=(e==null?void 0:e.message)||"Are you sure?",v=e==null?void 0:e.data,w=async()=>{o(!0);try{if(v!=null&&v.pgServiceName)await Wbe(v.pgServiceName),i.invalidateQueries({queryKey:["pgservices"]}),s({title:"PostgreSQL service deleted",status:"success",duration:2e3});else if(v!=null&&v.connectionId&&!(v!=null&&v.workspace))await n(v.connectionId),i.invalidateQueries({queryKey:["dashboard"]}),s({title:"Connection deleted",status:"success",duration:2e3});else if(v!=null&&v.connectionId&&(v!=null&&v.workspace)&&!(v!=null&&v.name))await sbe(v.connectionId,v.workspace,!0),i.invalidateQueries({queryKey:["workspaces",v.connectionId]}),s({title:"Workspace deleted",status:"success",duration:2e3});else if(v!=null&&v.connectionId&&(v!=null&&v.workspace)&&(v!=null&&v.name)&&(v!=null&&v.type)){const O=v.connectionId,P=v.workspace,E=v.name,$=v.type;switch($){case"datastore":await obe(O,P,E,!0),i.invalidateQueries({queryKey:["datastores",O,P]});break;case"coveragestore":await abe(O,P,E,!0),i.invalidateQueries({queryKey:["coveragestores",O,P]});break;case"layer":await lbe(O,P,E),i.invalidateQueries({queryKey:["layers",O,P]});break;case"style":await dbe(O,P,E,!0),i.invalidateQueries({queryKey:["styles",O,P]});break;case"layergroup":await xbe(O,P,E),i.invalidateQueries({queryKey:["layergroups",O,P]});break}s({title:`${$} deleted`,status:"success",duration:2e3})}e!=null&&e.onConfirm&&await e.onConfirm(),r()}catch(O){s({title:"Error",description:O.message,status:"error",duration:5e3})}finally{o(!1)}};return u.jsxs(ss,{isOpen:d,onClose:r,size:"md",isCentered:!0,children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{borderRadius:"xl",overflow:"hidden",children:[u.jsx(ue,{bg:"linear-gradient(135deg, #E55B3C 0%, #F0B84D 100%)",px:6,py:4,children:u.jsxs(fe,{spacing:3,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:2,borderRadius:"lg",children:u.jsx(ze,{as:G7,boxSize:5,color:"white"})}),u.jsxs(ue,{children:[u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:m}),u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:"This action cannot be undone"})]})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:6,children:u.jsx(J,{color:"gray.700",fontSize:"md",children:y})}),u.jsxs(To,{gap:3,borderTop:"1px solid",borderTopColor:"gray.100",bg:"gray.50",children:[u.jsx(gt,{variant:"ghost",onClick:r,borderRadius:"lg",children:"Cancel"}),u.jsx(gt,{colorScheme:"red",onClick:w,isLoading:a,borderRadius:"lg",px:6,children:"Delete"})]})]})]})}function Y1e(){const t=bt(Re=>Re.activeDialog),e=bt(Re=>Re.closeDialog),r=Er(Re=>Re.selectedNode),n=Js(Re=>Re.activeConnectionId),i=Jo(),s=Yo(),[a,o]=I.useState([]),[d,m]=I.useState(!1),[y,v]=I.useState(!1),[w,O]=I.useState([]),[P,E]=I.useState(!1),[$,R]=I.useState(!1),[F,D]=I.useState(null),U=I.useRef(null),X=Bt("gray.50","gray.700"),ee=Bt("gray.300","gray.600"),K=t==="upload",Y=(r==null?void 0:r.connectionId)||n,ne=r==null?void 0:r.workspace;I.useEffect(()=>{K&&(o([]),v(!1),O([]),D(null))},[K]);const oe=I.useCallback(Re=>{Re.preventDefault();const it=Array.from(Re.dataTransfer.files);Xe(it)},[]),ce=Re=>{if(Re.target.files){const it=Array.from(Re.target.files);Xe(it)}},Xe=Re=>{const it=[".shp",".zip",".gpkg",".tif",".tiff",".sld",".css"],Ke=Re.filter(St=>it.some(Mt=>St.name.toLowerCase().endsWith(Mt)));Ke.length<Re.length&&s({title:"Some files skipped",description:"Only shapefiles, GeoPackages, GeoTIFFs, and styles are supported",status:"warning",duration:3e3}),o(St=>[...St,...Ke.map(Mt=>({file:Mt,progress:0,status:"pending"}))]),v(!1),O([])},Ae=Re=>{o(it=>it.filter((Ke,St)=>St!==Re))},We=async()=>{if(!Y||!ne){s({title:"No workspace selected",description:"Please select a workspace in the tree first",status:"warning",duration:3e3});return}if(a.length===0){s({title:"No files selected",description:"Please select files to upload",status:"warning",duration:3e3});return}m(!0);let Re=null;for(let Ke=0;Ke<a.length;Ke++)if(a[Ke].status==="pending"){o(St=>St.map((Mt,Et)=>Et===Ke?{...Mt,status:"uploading"}:Mt));try{const St=await wbe(Y,ne,a[Ke].file,Mt=>{o(Et=>Et.map((xt,et)=>et===Ke?{...xt,progress:Mt}:xt))});o(Mt=>Mt.map((Et,xt)=>xt===Ke?{...Et,status:"success",progress:100,storeName:St.storeName,storeType:St.storeType}:Et)),a[Ke].file.name.toLowerCase().endsWith(".gpkg")&&St.storeName&&(Re={name:St.storeName,type:St.storeType||"datastore"})}catch(St){o(Mt=>Mt.map((Et,xt)=>xt===Ke?{...Et,status:"error",error:St.message}:Et))}}m(!1),v(!0),i.invalidateQueries({queryKey:["datastores",Y,ne]}),i.invalidateQueries({queryKey:["coveragestores",Y,ne]}),i.invalidateQueries({queryKey:["styles",Y,ne]}),i.invalidateQueries({queryKey:["layers",Y,ne]});const it=a.filter(Ke=>Ke.status==="success").length;it>0&&s({title:"Upload complete",description:`${it} file(s) uploaded successfully`,status:"success",duration:3e3}),Re&&Re.type==="datastore"&&(D(Re),await Ye(Re.name))},Ye=async Re=>{if(!(!Y||!ne)){E(!0);try{const it=await uU(Y,ne,Re);it.length>0&&O(it.map(Ke=>({name:Ke,selected:!0})))}catch(it){console.error("Failed to load available layers:",it)}finally{E(!1)}}},tt=Re=>{O(it=>it.map((Ke,St)=>St===Re?{...Ke,selected:!Ke.selected}:Ke))},Be=()=>{O(Re=>Re.map(it=>({...it,selected:!0})))},Me=()=>{O(Re=>Re.map(it=>({...it,selected:!1})))},Ge=async()=>{if(!Y||!ne||!F)return;const Re=w.filter(it=>it.selected).map(it=>it.name);if(Re.length===0){s({title:"No layers selected",description:"Please select at least one layer to publish",status:"warning",duration:3e3});return}R(!0);try{const it=await hU(Y,ne,F.name,Re);it.published.length>0&&(s({title:"Layers published",description:`${it.published.length} layer(s) published successfully`,status:"success",duration:3e3}),O(Ke=>Ke.filter(St=>!it.published.includes(St.name))),i.invalidateQueries({queryKey:["layers",Y,ne]})),it.errors.length>0&&s({title:"Some layers failed",description:it.errors.join(", "),status:"error",duration:5e3})}catch(it){s({title:"Publish failed",description:it.message,status:"error",duration:5e3})}finally{R(!1)}},De=()=>{o([]),v(!1),O([]),D(null),e()},Le=Re=>{switch(Re){case"success":return AM;case"error":return hf;default:return Y7}},Oe=Re=>{switch(Re){case"success":return"green.500";case"error":return"red.500";default:return"gray.500"}},Ie=a.some(Re=>Re.status==="pending"),st=w.filter(Re=>Re.selected).length;return u.jsxs(ss,{isOpen:K,onClose:De,size:"lg",isCentered:!0,children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{borderRadius:"xl",overflow:"hidden",maxH:"85vh",children:[u.jsx(ue,{bg:"linear-gradient(135deg, #3B9DD9 0%, #5BB5E8 100%)",px:6,py:4,children:u.jsxs(fe,{spacing:3,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:2,borderRadius:"lg",children:u.jsx(ze,{as:Vv,boxSize:5,color:"white"})}),u.jsxs(ue,{flex:"1",children:[u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:"Upload Files"}),u.jsxs(fe,{spacing:2,children:[u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:"Target:"}),ne?u.jsx(Qt,{bg:"whiteAlpha.200",color:"white",fontSize:"xs",children:ne}):u.jsx(J,{color:"whiteAlpha.600",fontSize:"sm",fontStyle:"italic",children:"No workspace selected"})]})]})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:6,overflowY:"auto",children:u.jsxs(lt,{spacing:4,children:[!y&&u.jsxs(ue,{w:"100%",p:8,bg:X,border:"2px dashed",borderColor:ee,borderRadius:"xl",textAlign:"center",cursor:"pointer",onClick:()=>{var Re;return(Re=U.current)==null?void 0:Re.click()},onDrop:oe,onDragOver:Re=>Re.preventDefault(),_hover:{borderColor:"kartoza.500",bg:"kartoza.50"},transition:"all 0.2s",children:[u.jsxs(lt,{spacing:3,children:[u.jsx(ue,{bg:"kartoza.50",p:4,borderRadius:"full",children:u.jsx(ze,{as:Vv,boxSize:10,color:"kartoza.500"})}),u.jsxs(lt,{spacing:1,children:[u.jsx(J,{fontWeight:"600",color:"gray.700",children:"Drop files here or click to browse"}),u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Shapefile (.zip), GeoPackage (.gpkg), GeoTIFF (.tif), SLD, CSS"})]})]}),u.jsx("input",{ref:U,type:"file",multiple:!0,accept:".zip,.shp,.gpkg,.tif,.tiff,.sld,.css",style:{display:"none"},onChange:ce})]}),a.length>0&&u.jsx(k1,{spacing:2,w:"100%",children:a.map((Re,it)=>u.jsx(hM,{p:3,bg:X,borderRadius:"lg",border:"1px solid",borderColor:Re.status==="success"?"green.200":Re.status==="error"?"red.200":"gray.200",children:u.jsxs(lt,{align:"stretch",spacing:2,children:[u.jsxs(ue,{display:"flex",alignItems:"center",gap:2,children:[u.jsx(dM,{as:Le(Re.status),color:Oe(Re.status),boxSize:5}),u.jsx(J,{flex:"1",fontSize:"sm",noOfLines:1,fontWeight:"500",children:Re.file.name}),Re.status==="pending"&&u.jsx(gt,{size:"xs",variant:"ghost",colorScheme:"red",onClick:()=>Ae(it),borderRadius:"md",children:"Remove"}),Re.status==="success"&&u.jsx(Qt,{colorScheme:"green",borderRadius:"md",children:"Complete"})]}),Re.status==="uploading"&&u.jsx(Sf,{value:Re.progress,size:"sm",colorScheme:"kartoza",borderRadius:"full"}),Re.status==="error"&&u.jsx(J,{fontSize:"xs",color:"red.500",children:Re.error})]})},it))}),y&&w.length>0&&u.jsxs(u.Fragment,{children:[u.jsx(Nr,{}),u.jsxs(ue,{w:"100%",children:[u.jsxs(fe,{justify:"space-between",mb:3,children:[u.jsxs(fe,{children:[u.jsx(ze,{as:hi,color:"kartoza.500"}),u.jsxs(J,{fontWeight:"600",children:["Available Layers in ",F==null?void 0:F.name]})]}),u.jsxs(fe,{spacing:2,children:[u.jsx(gt,{size:"xs",variant:"ghost",onClick:Be,children:"Select All"}),u.jsx(gt,{size:"xs",variant:"ghost",onClick:Me,children:"Deselect All"})]})]}),u.jsx(J,{fontSize:"sm",color:"gray.500",mb:3,children:"The GeoPackage contains multiple layers. Select which layers to publish:"}),u.jsx(lt,{align:"stretch",spacing:2,maxH:"200px",overflowY:"auto",children:w.map((Re,it)=>u.jsx(ue,{p:2,bg:X,borderRadius:"md",border:"1px solid",borderColor:Re.selected?"kartoza.200":"gray.200",children:u.jsx(Ga,{isChecked:Re.selected,onChange:()=>tt(it),colorScheme:"kartoza",children:u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:Wn,color:"gray.500",boxSize:4}),u.jsx(J,{fontSize:"sm",children:Re.name})]})})},Re.name))})]})]}),P&&u.jsxs(fe,{spacing:2,color:"gray.500",children:[u.jsx(kn,{size:"sm"}),u.jsx(J,{fontSize:"sm",children:"Checking for available layers..."})]})]})}),u.jsxs(To,{gap:3,borderTop:"1px solid",borderTopColor:"gray.100",bg:"gray.50",children:[u.jsx(gt,{variant:"ghost",onClick:De,borderRadius:"lg",children:y?"Close":"Cancel"}),y&&w.length>0&&u.jsxs(gt,{colorScheme:"green",onClick:Ge,isLoading:$,loadingText:"Publishing...",isDisabled:st===0,leftIcon:u.jsx(hi,{}),borderRadius:"lg",px:6,children:["Publish ",st>0&&`(${st})`]}),(!y||Ie)&&u.jsxs(gt,{colorScheme:"kartoza",onClick:We,isLoading:d,loadingText:"Uploading...",isDisabled:a.length===0||!ne||!Ie,leftIcon:u.jsx(Vv,{}),borderRadius:"lg",px:6,children:["Upload ",a.filter(Re=>Re.status==="pending").length>0&&`(${a.filter(Re=>Re.status==="pending").length})`]})]})]})]})}function J1e(){var ne,oe;const t=bt(ce=>ce.activeDialog),e=bt(ce=>ce.dialogData),r=bt(ce=>ce.closeDialog),n=Er(ce=>ce.selectedNode),[i,s]=I.useState(""),[a,o]=I.useState(""),[d,m]=I.useState("SINGLE"),[y,v]=I.useState([]),[w,O]=I.useState(!1),P=Yo(),E=Jo(),$=t==="layergroup",R=(e==null?void 0:e.mode)==="edit",F=((ne=e==null?void 0:e.data)==null?void 0:ne.connectionId)||(n==null?void 0:n.connectionId)||"",D=((oe=e==null?void 0:e.data)==null?void 0:oe.workspace)||(n==null?void 0:n.workspace)||"",{data:U,isLoading:X}=Xr({queryKey:["layers",F,D],queryFn:()=>D1(F,D),enabled:$&&!!F&&!!D});I.useEffect(()=>{$&&(R&&(e!=null&&e.data)?(s(e.data.name||""),o(e.data.title||""),m(e.data.mode||"SINGLE"),v(e.data.layers||[])):(s(""),o(""),m("SINGLE"),v([])))},[$,R,e]);const ee=async()=>{if(!i.trim()){P({title:"Name is required",status:"error",duration:3e3});return}if(y.length===0){P({title:"Select at least one layer",status:"error",duration:3e3});return}O(!0);try{const ce=y.map(Xe=>`${D}:${Xe}`);R?(await ybe(F,D,i,{title:a.trim()||void 0,mode:d,layers:ce,enabled:!0}),P({title:`Layer group "${i}" updated successfully`,status:"success",duration:3e3})):(await gbe(F,D,{name:i.trim(),title:a.trim()||void 0,mode:d,layers:ce}),P({title:`Layer group "${i}" created successfully`,status:"success",duration:3e3})),E.invalidateQueries({queryKey:["layergroups",F,D]}),r()}catch(ce){P({title:R?"Failed to update layer group":"Failed to create layer group",description:ce instanceof Error?ce.message:"Unknown error",status:"error",duration:5e3})}finally{O(!1)}},K=ce=>{v(Xe=>Xe.includes(ce)?Xe.filter(Ae=>Ae!==ce):[...Xe,ce])},Y=()=>{U&&(y.length===U.length?v([]):v(U.map(ce=>ce.name)))};return $?u.jsxs(ss,{isOpen:$,onClose:r,size:"lg",isCentered:!0,children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{borderRadius:"xl",overflow:"hidden",maxH:"85vh",children:[u.jsx(ue,{bg:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",px:6,py:4,children:u.jsxs(fe,{spacing:3,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:2,borderRadius:"lg",children:u.jsx(ze,{as:uf,boxSize:5,color:"white"})}),u.jsxs(ue,{children:[u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:R?"Edit Layer Group":"Create Layer Group"}),u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:D?`Workspace: ${D}`:"Select layers to group together"})]})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:6,overflowY:"auto",children:u.jsxs(lt,{spacing:5,align:"stretch",children:[u.jsxs(Ot,{isRequired:!0,children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Group Name"}),u.jsx(Ar,{value:i,onChange:ce=>s(ce.target.value),placeholder:"my_layer_group",size:"lg",borderRadius:"lg",isDisabled:R})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Title (Optional)"}),u.jsx(Ar,{value:a,onChange:ce=>o(ce.target.value),placeholder:"My Layer Group",size:"lg",borderRadius:"lg"})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Mode"}),u.jsxs(zn,{value:d,onChange:ce=>m(ce.target.value),size:"lg",borderRadius:"lg",children:[u.jsx("option",{value:"SINGLE",children:"Single (merged into one layer)"}),u.jsx("option",{value:"NAMED",children:"Named (layers visible separately)"}),u.jsx("option",{value:"CONTAINER",children:"Container (organizational only)"}),u.jsx("option",{value:"EO",children:"EO (Earth Observation)"})]})]}),u.jsxs(Ot,{isRequired:!0,children:[u.jsxs(fe,{justify:"space-between",mb:2,children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",mb:0,children:"Select Layers"}),u.jsxs(fe,{children:[u.jsxs(Qt,{colorScheme:"kartoza",borderRadius:"md",px:2,children:[y.length," selected"]}),u.jsx(gt,{size:"xs",variant:"ghost",colorScheme:"kartoza",onClick:Y,children:U&&y.length===U.length?"Deselect All":"Select All"})]})]}),u.jsx(ue,{border:"1px solid",borderColor:"gray.200",borderRadius:"lg",maxH:"250px",overflowY:"auto",p:3,children:X?u.jsxs(fe,{justify:"center",py:6,children:[u.jsx(kn,{size:"sm",color:"kartoza.500"}),u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Loading layers..."})]}):U&&U.length>0?u.jsx(A1,{spacing:2,children:U.map(ce=>u.jsx(ue,{p:2,borderRadius:"md",bg:y.includes(ce.name)?"kartoza.50":"transparent",_hover:{bg:"gray.50"},transition:"background 0.15s",children:u.jsx(Ga,{isChecked:y.includes(ce.name),onChange:()=>K(ce.name),colorScheme:"kartoza",children:u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:hi,color:"blue.500"}),u.jsx(J,{fontSize:"sm",fontWeight:y.includes(ce.name)?"500":"normal",children:ce.name}),ce.storeType&&u.jsx(Qt,{size:"sm",colorScheme:ce.storeType==="coverage"?"purple":"green",fontSize:"xs",children:ce.storeType==="coverage"?"Raster":"Vector"})]})})},ce.name))}):u.jsxs(io,{status:"info",borderRadius:"md",children:[u.jsx(so,{}),u.jsx(J,{fontSize:"sm",children:"No layers available in this workspace"})]})})]})]})}),u.jsxs(To,{gap:3,borderTop:"1px solid",borderTopColor:"gray.100",bg:"gray.50",children:[u.jsx(gt,{variant:"ghost",onClick:r,borderRadius:"lg",children:"Cancel"}),u.jsx(gt,{colorScheme:"kartoza",onClick:ee,isLoading:w,isDisabled:!i.trim()||y.length===0,borderRadius:"lg",px:6,children:R?"Save Changes":"Create Layer Group"})]})]})]}):null}function e_e(){var De,Le,Oe,Ie,st,Re,it;const t=bt(Ke=>Ke.activeDialog),e=bt(Ke=>Ke.dialogData),r=bt(Ke=>Ke.closeDialog),n=Er(Ke=>Ke.selectedNode),[i,s]=I.useState(0),[a,o]=I.useState(""),[d,m]=I.useState("image/png"),[y,v]=I.useState(0),[w,O]=I.useState(10),[P,E]=I.useState(2),[$,R]=I.useState("seed"),[F,D]=I.useState(!1),U=Yo(),X=Jo(),ee=t==="info"&&(e==null?void 0:e.title)==="Tile Cache",K=((De=e==null?void 0:e.data)==null?void 0:De.layerName)||"",Y=((Le=e==null?void 0:e.data)==null?void 0:Le.connectionId)||(n==null?void 0:n.connectionId)||"",ne=((Oe=e==null?void 0:e.data)==null?void 0:Oe.workspace)||(n==null?void 0:n.workspace)||"",oe=ne?`${ne}:${K}`:K,{data:ce,isLoading:Xe}=Xr({queryKey:["gwc-layer",Y,oe],queryFn:()=>Sbe(Y,oe),enabled:ee&&!!Y&&!!oe}),{data:Ae,refetch:We}=Xr({queryKey:["gwc-seed-status",Y,oe],queryFn:()=>kbe(Y,oe),enabled:ee&&!!Y&&!!oe,refetchInterval:i===1?2e3:!1});I.useEffect(()=>{var Ke,St;(Ke=ce==null?void 0:ce.gridSubsets)!=null&&Ke[0]&&!a&&o(ce.gridSubsets[0]),(St=ce==null?void 0:ce.mimeFormats)!=null&&St[0]&&d==="image/png"&&!ce.mimeFormats.includes("image/png")&&ce.mimeFormats[0]&&m(ce.mimeFormats[0])},[ce,a,d]);const Ye=async()=>{if(!a||!d){U({title:"Select grid set and format",status:"error",duration:3e3});return}D(!0);try{await Cbe(Y,oe,{gridSetId:a,format:d,zoomStart:y,zoomStop:w,type:$,threadCount:P}),U({title:`${$==="seed"?"Seeding":"Reseeding"} started`,description:`Layer: ${K}`,status:"success",duration:3e3}),s(1),We()}catch(Ke){U({title:"Failed to start seeding",description:Ke instanceof Error?Ke.message:"Unknown error",status:"error",duration:5e3})}finally{D(!1)}},tt=async()=>{D(!0);try{await Obe(Y,oe,{gridSetId:a||void 0,format:d||void 0,zoomStart:y,zoomStop:w}),U({title:"Cache truncated",description:`Layer: ${K}`,status:"success",duration:3e3}),X.invalidateQueries({queryKey:["gwc-layer",Y,oe]})}catch(Ke){U({title:"Failed to truncate cache",description:Ke instanceof Error?Ke.message:"Unknown error",status:"error",duration:5e3})}finally{D(!1)}},Be=async()=>{try{await Tbe(Y,oe),U({title:"Seed tasks terminated",status:"success",duration:3e3}),We()}catch(Ke){U({title:"Failed to terminate tasks",description:Ke instanceof Error?Ke.message:"Unknown error",status:"error",duration:5e3})}},Me=Ke=>Ke<0?"Unknown":Ke<60?`${Ke}s`:Ke<3600?`${Math.floor(Ke/60)}m ${Ke%60}s`:`${Math.floor(Ke/3600)}h ${Math.floor(Ke%3600/60)}m`,Ge=Ke=>{switch(Ke){case"Running":return"blue";case"Pending":return"yellow";case"Done":return"green";case"Aborted":return"red";default:return"gray"}};return ee?u.jsxs(ss,{isOpen:ee,onClose:r,size:"xl",isCentered:!0,children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{borderRadius:"xl",overflow:"hidden",maxH:"85vh",children:[u.jsx(ue,{bg:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",px:6,py:4,children:u.jsxs(fe,{spacing:3,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:2,borderRadius:"lg",children:u.jsx(ze,{as:Wn,boxSize:5,color:"white"})}),u.jsxs(ue,{children:[u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:"Tile Cache Management"}),u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:oe})]})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:4,overflowY:"auto",children:Xe?u.jsxs(fe,{justify:"center",py:6,children:[u.jsx(kn,{size:"sm",color:"kartoza.500"}),u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Loading cache info..."})]}):ce?u.jsxs(w0,{index:i,onChange:s,colorScheme:"kartoza",children:[u.jsxs(S0,{children:[u.jsx(to,{children:"Seed / Truncate"}),u.jsxs(to,{children:["Progress",Ae&&Ae.length>0&&u.jsx(Qt,{ml:2,colorScheme:"blue",borderRadius:"full",children:Ae.length})]}),u.jsx(to,{children:"Info"})]}),u.jsxs(z1,{children:[u.jsx(_a,{px:0,children:u.jsxs(lt,{spacing:4,align:"stretch",children:[u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Grid Set"}),u.jsx(zn,{value:a,onChange:Ke=>o(Ke.target.value),borderRadius:"lg",children:(Ie=ce.gridSubsets)==null?void 0:Ie.map(Ke=>u.jsx("option",{value:Ke,children:Ke},Ke))})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Format"}),u.jsx(zn,{value:d,onChange:Ke=>m(Ke.target.value),borderRadius:"lg",children:(st=ce.mimeFormats)==null?void 0:st.map(Ke=>u.jsx("option",{value:Ke,children:Ke},Ke))})]}),u.jsxs(fe,{spacing:4,children:[u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Zoom Start"}),u.jsxs(Wp,{value:y,onChange:(Ke,St)=>v(St||0),min:0,max:w,children:[u.jsx(qp,{borderRadius:"lg"}),u.jsxs(Up,{children:[u.jsx(Hp,{}),u.jsx(Qp,{})]})]})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Zoom Stop"}),u.jsxs(Wp,{value:w,onChange:(Ke,St)=>O(St||10),min:y,max:25,children:[u.jsx(qp,{borderRadius:"lg"}),u.jsxs(Up,{children:[u.jsx(Hp,{}),u.jsx(Qp,{})]})]})]})]}),u.jsxs(fe,{spacing:4,children:[u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Operation"}),u.jsxs(zn,{value:$,onChange:Ke=>R(Ke.target.value),borderRadius:"lg",children:[u.jsx("option",{value:"seed",children:"Seed (generate new tiles)"}),u.jsx("option",{value:"reseed",children:"Reseed (regenerate all tiles)"})]})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",color:"gray.700",children:"Threads"}),u.jsxs(Wp,{value:P,onChange:(Ke,St)=>E(St||1),min:1,max:16,children:[u.jsx(qp,{borderRadius:"lg"}),u.jsxs(Up,{children:[u.jsx(Hp,{}),u.jsx(Qp,{})]})]})]})]}),u.jsxs(fe,{spacing:3,pt:4,children:[u.jsx(gt,{leftIcon:u.jsx(ze,{as:EM}),colorScheme:"kartoza",onClick:Ye,isLoading:F,flex:1,borderRadius:"lg",children:$==="seed"?"Seed Tiles":"Reseed Tiles"}),u.jsx(gt,{leftIcon:u.jsx(ze,{as:Xd}),colorScheme:"red",variant:"outline",onClick:tt,isLoading:F,flex:1,borderRadius:"lg",children:"Truncate Cache"})]})]})}),u.jsx(_a,{px:0,children:u.jsxs(lt,{spacing:4,align:"stretch",children:[u.jsxs(fe,{justify:"space-between",children:[u.jsx(J,{fontWeight:"500",color:"gray.700",children:"Running Tasks"}),u.jsxs(fe,{children:[u.jsx(wr,{label:"Refresh status",children:u.jsx(gr,{"aria-label":"Refresh",icon:u.jsx(ze,{as:Su}),size:"sm",variant:"ghost",onClick:()=>We()})}),Ae&&Ae.length>0&&u.jsx(gt,{leftIcon:u.jsx(ze,{as:wve}),size:"sm",colorScheme:"red",variant:"outline",onClick:Be,children:"Stop All"})]})]}),!Ae||Ae.length===0?u.jsxs(io,{status:"info",borderRadius:"md",children:[u.jsx(so,{}),u.jsx(J,{fontSize:"sm",children:"No active seeding tasks"})]}):u.jsx(ue,{border:"1px solid",borderColor:"gray.200",borderRadius:"lg",overflow:"hidden",children:u.jsxs(sC,{size:"sm",children:[u.jsx(SM,{bg:"gray.50",children:u.jsxs(r0,{children:[u.jsx(Dd,{children:"Status"}),u.jsx(Dd,{children:"Progress"}),u.jsx(Dd,{children:"Tiles"}),u.jsx(Dd,{children:"ETA"})]})}),u.jsx(wM,{children:Ae.map(Ke=>u.jsxs(r0,{children:[u.jsx(Rd,{children:u.jsx(Qt,{colorScheme:Ge(Ke.status),children:Ke.status})}),u.jsx(Rd,{children:u.jsxs(lt,{spacing:1,align:"stretch",children:[u.jsx(Sf,{value:Ke.progress,size:"sm",colorScheme:"kartoza",borderRadius:"full"}),u.jsxs(J,{fontSize:"xs",color:"gray.500",children:[Ke.progress.toFixed(1),"%"]})]})}),u.jsx(Rd,{children:u.jsxs(J,{fontSize:"sm",children:[Ke.tilesDone.toLocaleString()," / ",Ke.tilesTotal.toLocaleString()]})}),u.jsx(Rd,{children:u.jsx(J,{fontSize:"sm",children:Me(Ke.timeRemaining)})})]},Ke.id))})]})})]})}),u.jsx(_a,{px:0,children:u.jsxs(lt,{spacing:3,align:"stretch",children:[u.jsxs(ue,{p:4,bg:"gray.50",borderRadius:"lg",children:[u.jsx(J,{fontWeight:"500",mb:2,children:"Cache Status"}),u.jsx(fe,{children:u.jsx(Qt,{colorScheme:ce.enabled?"green":"red",children:ce.enabled?"Enabled":"Disabled"})})]}),u.jsxs(ue,{p:4,bg:"gray.50",borderRadius:"lg",children:[u.jsx(J,{fontWeight:"500",mb:2,children:"Available Grid Sets"}),u.jsx(fe,{flexWrap:"wrap",gap:2,children:(Re=ce.gridSubsets)==null?void 0:Re.map(Ke=>u.jsx(Qt,{colorScheme:"blue",variant:"subtle",children:Ke},Ke))})]}),u.jsxs(ue,{p:4,bg:"gray.50",borderRadius:"lg",children:[u.jsx(J,{fontWeight:"500",mb:2,children:"Supported Formats"}),u.jsx(fe,{flexWrap:"wrap",gap:2,children:(it=ce.mimeFormats)==null?void 0:it.map(Ke=>u.jsx(Qt,{colorScheme:"purple",variant:"subtle",children:Ke},Ke))})]})]})})]})]}):u.jsxs(io,{status:"warning",borderRadius:"md",children:[u.jsx(so,{}),u.jsx(J,{fontSize:"sm",children:"No cache configuration found for this layer"})]})}),u.jsx(To,{gap:3,borderTop:"1px solid",borderTopColor:"gray.100",bg:"gray.50",children:u.jsx(gt,{variant:"ghost",onClick:r,borderRadius:"lg",children:"Close"})})]})]}):null}function t_e(){var St,Mt,Et,xt;const t=bt(et=>et.activeDialog),e=bt(et=>et.dialogData),r=bt(et=>et.closeDialog),n=bt(et=>et.openDialog),i=Er(et=>et.selectedNode),s=Jo(),a=Yo(),[o,d]=I.useState({enabled:!0,advertised:!0,queryable:!0}),[m,y]=I.useState(""),[v,w]=I.useState([]),[O,P]=I.useState({type:"text/html",metadataType:"TC211",content:""}),[E,$]=I.useState(""),[R,F]=I.useState([]),[D,U]=I.useState(!1),X=t==="layer",ee=((St=e==null?void 0:e.data)==null?void 0:St.connectionId)||(i==null?void 0:i.connectionId)||"",K=((Mt=e==null?void 0:e.data)==null?void 0:Mt.workspace)||(i==null?void 0:i.workspace)||"",Y=((Et=e==null?void 0:e.data)==null?void 0:Et.layerName)||(i==null?void 0:i.name)||"",{data:ne,isLoading:oe}=Xr({queryKey:["layerMetadata",ee,K,Y],queryFn:()=>cbe(ee,K,Y),enabled:X&&!!ee&&!!K&&!!Y}),{data:ce}=Xr({queryKey:["styles",ee,K],queryFn:()=>RM(ee,K),enabled:X&&!!ee&&!!K}),{data:Xe,isLoading:Ae}=Xr({queryKey:["layerStyles",ee,K,Y],queryFn:()=>pU(ee,K,Y),enabled:X&&!!ee&&!!K&&!!Y});I.useEffect(()=>{ne&&(d({title:ne.title||"",abstract:ne.abstract||"",keywords:ne.keywords||[],srs:ne.srs||"",enabled:ne.enabled,advertised:ne.advertised,queryable:ne.queryable,attributionTitle:ne.attributionTitle||"",attributionHref:ne.attributionHref||""}),w(ne.metadataLinks||[]))},[ne]),I.useEffect(()=>{Xe&&($(Xe.defaultStyle||""),F(Xe.additionalStyles||[]),U(!1))},[Xe]);const We=su({mutationFn:et=>hbe(ee,K,Y,{...et,metadataLinks:v}),onSuccess:()=>{s.invalidateQueries({queryKey:["layerMetadata",ee,K,Y]}),s.invalidateQueries({queryKey:["layer",ee,K,Y]}),s.invalidateQueries({queryKey:["layers",ee,K]}),a({title:"Layer updated",description:"Layer metadata has been updated successfully.",status:"success",duration:3e3}),r()},onError:et=>{a({title:"Error updating layer",description:et.message,status:"error",duration:5e3})}}),Ye=su({mutationFn:()=>fbe(ee,K,Y,E,R),onSuccess:()=>{s.invalidateQueries({queryKey:["layerStyles",ee,K,Y]}),s.invalidateQueries({queryKey:["layer",ee,K,Y]}),U(!1),a({title:"Styles updated",description:"Layer styles have been updated successfully.",status:"success",duration:3e3})},onError:et=>{a({title:"Error updating styles",description:et.message,status:"error",duration:5e3})}}),tt=(et,Yt)=>{d(_t=>({..._t,[et]:Yt}))},Be=()=>{var et;m.trim()&&!((et=o.keywords)!=null&&et.includes(m.trim()))&&(d(Yt=>({...Yt,keywords:[...Yt.keywords||[],m.trim()]})),y(""))},Me=et=>{d(Yt=>{var _t;return{...Yt,keywords:((_t=Yt.keywords)==null?void 0:_t.filter(rt=>rt!==et))||[]}})},Ge=()=>{O.content.trim()&&(w(et=>[...et,{...O}]),P({type:"text/html",metadataType:"TC211",content:""}))},De=et=>{w(Yt=>Yt.filter((_t,rt)=>rt!==et))},Le=()=>{We.mutate(o)},Oe=()=>{Ye.mutate()},Ie=et=>{U(!0),R.includes(et)?F(R.filter(Yt=>Yt!==et)):F([...R,et])},st=et=>{U(!0),$(et),R.includes(et)&&F(R.filter(Yt=>Yt!==et))},Re=()=>{r(),n("style",{mode:"create",data:{connectionId:ee,workspace:K,forLayer:Y}})},it=et=>{r(),n("style",{mode:"edit",data:{connectionId:ee,workspace:K,name:et}})},Ke=()=>{s.invalidateQueries({queryKey:["styles",ee,K]}),s.invalidateQueries({queryKey:["layerStyles",ee,K,Y]}),a({title:"Styles refreshed",status:"info",duration:2e3})};return X?u.jsxs(ss,{isOpen:X,onClose:r,size:"2xl",isCentered:!0,scrollBehavior:"inside",children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{borderRadius:"xl",overflow:"hidden",maxH:"85vh",children:[u.jsx(ue,{bg:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",px:6,py:4,children:u.jsxs(fe,{spacing:3,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:2,borderRadius:"lg",children:u.jsx(ze,{as:hi,boxSize:5,color:"white"})}),u.jsxs(ue,{children:[u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:"Edit Layer Metadata"}),u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:Y})]}),ne&&u.jsx(Qt,{ml:"auto",colorScheme:ne.storeType==="coveragestore"?"orange":"blue",px:2,py:1,borderRadius:"md",children:ne.storeType==="coveragestore"?"Raster":"Vector"})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:4,overflowY:"auto",children:oe?u.jsxs(lt,{py:10,children:[u.jsx(kn,{size:"xl",color:"kartoza.500"}),u.jsx(J,{color:"gray.500",children:"Loading layer metadata..."})]}):u.jsxs(w0,{variant:"enclosed",colorScheme:"kartoza",children:[u.jsxs(S0,{children:[u.jsx(to,{children:u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:I1}),u.jsx(J,{children:"Basic Info"})]})}),u.jsx(to,{children:u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:Wo}),u.jsx(J,{children:"Styles"})]})}),u.jsx(to,{children:u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:xs}),u.jsx(J,{children:"Description"})]})}),u.jsx(to,{children:u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:mve}),u.jsx(J,{children:"Attribution"})]})})]}),u.jsxs(z1,{children:[u.jsx(_a,{px:0,py:4,children:u.jsxs(lt,{spacing:4,align:"stretch",children:[u.jsxs(Ot,{display:"flex",alignItems:"center",justifyContent:"space-between",p:3,bg:"gray.50",borderRadius:"lg",children:[u.jsxs(fe,{children:[u.jsx(ze,{as:hi,color:"green.500"}),u.jsxs(ue,{children:[u.jsx(jt,{mb:0,fontWeight:"500",children:"Enabled"}),u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Layer is available for use in GeoServer"})]})]}),u.jsx(fa,{colorScheme:"green",size:"lg",isChecked:o.enabled,onChange:et=>tt("enabled",et.target.checked)})]}),u.jsxs(Ot,{display:"flex",alignItems:"center",justifyContent:"space-between",p:3,bg:"gray.50",borderRadius:"lg",children:[u.jsxs(fe,{children:[u.jsx(ze,{as:Ri,color:"blue.500"}),u.jsxs(ue,{children:[u.jsx(jt,{mb:0,fontWeight:"500",children:"Advertised"}),u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Layer appears in GetCapabilities responses"})]})]}),u.jsx(fa,{colorScheme:"blue",size:"lg",isChecked:o.advertised,onChange:et=>tt("advertised",et.target.checked)})]}),u.jsxs(Ot,{display:"flex",alignItems:"center",justifyContent:"space-between",p:3,bg:"gray.50",borderRadius:"lg",children:[u.jsxs(fe,{children:[u.jsx(ze,{as:Ib,color:"purple.500"}),u.jsxs(ue,{children:[u.jsx(jt,{mb:0,fontWeight:"500",children:"Queryable"}),u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Layer supports GetFeatureInfo requests"})]})]}),u.jsx(fa,{colorScheme:"purple",size:"lg",isChecked:o.queryable,onChange:et=>tt("queryable",et.target.checked)})]}),u.jsx(Nr,{}),u.jsx(U5,{allowToggle:!0,children:u.jsxs(H5,{border:"none",children:[u.jsxs(q5,{bg:"gray.50",borderRadius:"lg",_hover:{bg:"gray.100"},children:[u.jsx(ue,{flex:"1",textAlign:"left",children:u.jsx(J,{fontWeight:"500",color:"gray.600",children:"Data Information"})}),u.jsx(Q5,{})]}),u.jsxs(G5,{pb:4,children:[u.jsxs(Wr,{columns:2,spacing:4,children:[u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Workspace"}),u.jsx(J,{fontWeight:"medium",children:K})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Store"}),u.jsx(J,{fontWeight:"medium",children:(ne==null?void 0:ne.store)||"Unknown"})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Native Name"}),u.jsx(nh,{fontSize:"sm",children:(ne==null?void 0:ne.nativeName)||(ne==null?void 0:ne.name)})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Default Style"}),u.jsx(J,{fontWeight:"medium",children:(ne==null?void 0:ne.defaultStyle)||"None"})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Native CRS"}),u.jsx(nh,{fontSize:"sm",children:(ne==null?void 0:ne.nativeCRS)||"Unknown"})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Declared SRS"}),u.jsx(nh,{fontSize:"sm",children:(ne==null?void 0:ne.srs)||"Unknown"})]})]}),(ne==null?void 0:ne.nativeBoundingBox)&&u.jsxs(ue,{mt:4,children:[u.jsx(J,{fontSize:"xs",color:"gray.500",mb:2,children:"Native Bounding Box"}),u.jsxs(nh,{display:"block",p:2,borderRadius:"md",fontSize:"xs",children:["(",ne.nativeBoundingBox.minx.toFixed(4),", ",ne.nativeBoundingBox.miny.toFixed(4),") - (",ne.nativeBoundingBox.maxx.toFixed(4),", ",ne.nativeBoundingBox.maxy.toFixed(4),")"]})]}),(ne==null?void 0:ne.latLonBoundingBox)&&u.jsxs(ue,{mt:4,children:[u.jsx(J,{fontSize:"xs",color:"gray.500",mb:2,children:"Lat/Lon Bounding Box"}),u.jsxs(nh,{display:"block",p:2,borderRadius:"md",fontSize:"xs",children:["(",ne.latLonBoundingBox.minx.toFixed(4),", ",ne.latLonBoundingBox.miny.toFixed(4),") - (",ne.latLonBoundingBox.maxx.toFixed(4),", ",ne.latLonBoundingBox.maxy.toFixed(4),")"]})]})]})]})})]})}),u.jsx(_a,{px:0,py:4,children:u.jsxs(lt,{spacing:4,align:"stretch",children:[u.jsx(ue,{p:4,bg:"blue.50",borderRadius:"lg",borderLeft:"4px solid",borderLeftColor:"blue.400",children:u.jsxs(J,{fontSize:"sm",color:"blue.700",children:[u.jsx("strong",{children:"Styles"})," control how your layer is rendered on the map. Select a default style and optionally add additional styles that users can choose from."]})}),u.jsxs(fe,{spacing:2,children:[u.jsx(gt,{size:"sm",colorScheme:"kartoza",leftIcon:u.jsx(ze,{as:vs}),onClick:Re,children:"Create New Style"}),u.jsx(gr,{"aria-label":"Refresh styles",icon:u.jsx(Su,{}),size:"sm",variant:"outline",onClick:Ke})]}),Ae?u.jsxs(lt,{py:6,children:[u.jsx(kn,{size:"md",color:"kartoza.500"}),u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Loading styles..."})]}):u.jsx(u.Fragment,{children:!ce||ce.length===0?u.jsxs(ue,{p:6,bg:"orange.50",borderRadius:"lg",border:"2px dashed",borderColor:"orange.200",textAlign:"center",children:[u.jsx(ze,{as:Wo,boxSize:8,color:"orange.400",mb:3}),u.jsx(J,{fontWeight:"600",color:"orange.700",mb:2,children:"No Styles Available"}),u.jsx(J,{fontSize:"sm",color:"orange.600",mb:4,children:"This workspace doesn't have any styles yet. Create a new style to customize how your layer appears on the map."}),u.jsx(gt,{colorScheme:"orange",leftIcon:u.jsx(ze,{as:vs}),onClick:Re,children:"Create Your First Style"})]}):u.jsxs(u.Fragment,{children:[u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"600",mb:3,children:"Default Style"}),u.jsx(J,{fontSize:"xs",color:"gray.500",mb:3,children:"The style used when no specific style is requested"}),u.jsx(C7,{value:E,onChange:st,children:u.jsx(A1,{spacing:2,children:ce==null?void 0:ce.map(et=>u.jsx(ue,{p:3,bg:E===et.name?"kartoza.50":"gray.50",borderRadius:"lg",border:"2px solid",borderColor:E===et.name?"kartoza.500":"transparent",_hover:{borderColor:"kartoza.300"},transition:"all 0.15s",children:u.jsxs(fe,{justify:"space-between",children:[u.jsx(T7,{value:et.name,colorScheme:"kartoza",flex:"1",children:u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:Wo,color:"pink.500"}),u.jsx(J,{fontWeight:E===et.name?"600":"normal",children:et.name})]})}),u.jsxs(fe,{spacing:2,children:[E===et.name&&u.jsx(Qt,{colorScheme:"kartoza",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:_ve,boxSize:3}),u.jsx(J,{children:"Default"})]})}),u.jsx(gr,{"aria-label":"Edit style",icon:u.jsx(_c,{}),size:"xs",variant:"ghost",colorScheme:"blue",onClick:Yt=>{Yt.stopPropagation(),it(et.name)}})]})]})},et.name))})})]}),u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"600",mb:3,children:"Additional Styles"}),u.jsx(J,{fontSize:"xs",color:"gray.500",mb:3,children:"Additional styles that users can choose from when viewing this layer"}),u.jsx(lt,{align:"stretch",spacing:2,children:ce==null?void 0:ce.filter(et=>et.name!==E).map(et=>u.jsx(ue,{p:3,bg:R.includes(et.name)?"green.50":"gray.50",borderRadius:"lg",border:"2px solid",borderColor:R.includes(et.name)?"green.500":"transparent",_hover:{borderColor:"green.300"},transition:"all 0.15s",children:u.jsxs(fe,{justify:"space-between",children:[u.jsx(Ga,{isChecked:R.includes(et.name),onChange:()=>Ie(et.name),colorScheme:"green",flex:"1",children:u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:Wo,color:"pink.500"}),u.jsx(J,{children:et.name})]})}),u.jsx(gr,{"aria-label":"Edit style",icon:u.jsx(_c,{}),size:"xs",variant:"ghost",colorScheme:"blue",onClick:Yt=>{Yt.stopPropagation(),it(et.name)}})]})},et.name))}),(ce==null?void 0:ce.filter(et=>et.name!==E).length)===0&&u.jsx(J,{fontSize:"sm",color:"gray.500",fontStyle:"italic",mt:2,children:"All available styles are either set as default or not yet created"})]}),D&&u.jsx(gt,{colorScheme:"kartoza",onClick:Oe,isLoading:Ye.isPending,leftIcon:u.jsx(ze,{as:Wo}),children:"Save Style Changes"})]})})]})}),u.jsx(_a,{px:0,py:4,children:u.jsxs(lt,{spacing:4,align:"stretch",children:[u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",children:"Title"}),u.jsx(Ar,{value:o.title||"",onChange:et=>tt("title",et.target.value),placeholder:"Human-readable layer title",bg:"gray.50",borderRadius:"lg"}),u.jsx(J,{fontSize:"xs",color:"gray.500",mt:1,children:"A short descriptive name for the layer"})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",children:"Abstract / Description"}),u.jsx(lC,{value:o.abstract||"",onChange:et=>tt("abstract",et.target.value),placeholder:"Detailed description of the layer content, purpose, and data source...",bg:"gray.50",borderRadius:"lg",rows:4}),u.jsx(J,{fontSize:"xs",color:"gray.500",mt:1,children:"A longer description of the layer for metadata and documentation"})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",children:"Keywords"}),u.jsxs(fe,{children:[u.jsx(Ar,{value:m,onChange:et=>y(et.target.value),placeholder:"Add a keyword...",bg:"gray.50",borderRadius:"lg",onKeyPress:et=>et.key==="Enter"&&Be()}),u.jsx(gr,{"aria-label":"Add keyword",icon:u.jsx(vs,{}),colorScheme:"kartoza",onClick:Be,borderRadius:"lg"})]}),u.jsx(n0,{mt:2,spacing:2,children:(xt=o.keywords)==null?void 0:xt.map(et=>u.jsx(um,{children:u.jsxs(cm,{size:"md",colorScheme:"blue",borderRadius:"full",children:[u.jsx(zb,{children:et}),u.jsx(I7,{onClick:()=>Me(et)})]})},et))}),u.jsx(J,{fontSize:"xs",color:"gray.500",mt:1,children:"Keywords help users find this layer in searches"})]})]})}),u.jsx(_a,{px:0,py:4,children:u.jsxs(lt,{spacing:4,align:"stretch",children:[u.jsx(ue,{p:4,bg:"blue.50",borderRadius:"lg",borderLeft:"4px solid",borderLeftColor:"blue.400",children:u.jsxs(J,{fontSize:"sm",color:"blue.700",children:[u.jsx("strong",{children:"Attribution"})," provides credit to the data source and is displayed in WMS GetCapabilities and map clients."]})}),u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",children:"Attribution Title"}),u.jsx(Ar,{value:o.attributionTitle||"",onChange:et=>tt("attributionTitle",et.target.value),placeholder:"e.g., Data provided by...",bg:"gray.50",borderRadius:"lg"})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontWeight:"500",children:"Attribution Link (URL)"}),u.jsx(Ar,{value:o.attributionHref||"",onChange:et=>tt("attributionHref",et.target.value),placeholder:"https://example.com/data-source",bg:"gray.50",borderRadius:"lg"})]}),u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"500",mb:3,children:"Metadata Links"}),u.jsx(J,{fontSize:"xs",color:"gray.500",mb:3,children:"Links to external metadata documents (ISO 19115, FGDC, etc.)"}),v.length>0&&u.jsx(lt,{spacing:2,mb:4,align:"stretch",children:v.map((et,Yt)=>u.jsxs(fe,{p:3,bg:"gray.50",borderRadius:"lg",justify:"space-between",children:[u.jsxs(lt,{align:"start",spacing:0,children:[u.jsxs(fe,{children:[u.jsx(Qt,{colorScheme:"purple",children:et.metadataType}),u.jsx(Qt,{colorScheme:"gray",children:et.type})]}),u.jsx(J,{fontSize:"sm",color:"gray.600",isTruncated:!0,maxW:"300px",children:et.content})]}),u.jsx(gr,{"aria-label":"Remove link",icon:u.jsx(Xd,{}),size:"sm",colorScheme:"red",variant:"ghost",onClick:()=>De(Yt)})]},Yt))}),u.jsxs(ue,{p:4,bg:"gray.50",borderRadius:"lg",children:[u.jsx(J,{fontWeight:"500",fontSize:"sm",mb:3,children:"Add Metadata Link"}),u.jsxs(lt,{spacing:3,children:[u.jsxs(fe,{w:"100%",children:[u.jsxs(Ot,{flex:1,children:[u.jsx(jt,{fontSize:"xs",children:"Type"}),u.jsx(Ar,{size:"sm",value:O.type,onChange:et=>P({...O,type:et.target.value}),placeholder:"text/html"})]}),u.jsxs(Ot,{flex:1,children:[u.jsx(jt,{fontSize:"xs",children:"Metadata Type"}),u.jsx(Ar,{size:"sm",value:O.metadataType,onChange:et=>P({...O,metadataType:et.target.value}),placeholder:"TC211"})]})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"xs",children:"URL"}),u.jsxs(fe,{children:[u.jsx(Ar,{size:"sm",value:O.content,onChange:et=>P({...O,content:et.target.value}),placeholder:"https://example.com/metadata.xml"}),u.jsx(gr,{"aria-label":"Add link",icon:u.jsx(vs,{}),size:"sm",colorScheme:"kartoza",onClick:Ge})]})]})]})]})]})]})})]})]})}),u.jsxs(To,{gap:3,borderTop:"1px solid",borderTopColor:"gray.100",bg:"gray.50",children:[u.jsx(gt,{variant:"ghost",onClick:r,borderRadius:"lg",children:"Cancel"}),u.jsx(gt,{colorScheme:"kartoza",onClick:Le,isLoading:We.isPending,borderRadius:"lg",px:6,children:"Save Changes"})]})]})]}):null}function r_e(){var w,O,P;const t=bt(E=>E.activeDialog),e=bt(E=>E.dialogData),r=bt(E=>E.closeDialog),n=Er(E=>E.selectedNode),i=t==="datastore"||t==="coveragestore",s=t==="datastore",a=(e==null?void 0:e.mode)==="edit",o=((w=e==null?void 0:e.data)==null?void 0:w.connectionId)||(n==null?void 0:n.connectionId)||"",d=((O=e==null?void 0:e.data)==null?void 0:O.workspace)||(n==null?void 0:n.workspace)||"",m=((P=e==null?void 0:e.data)==null?void 0:P.storeName)||(n==null?void 0:n.name)||"",{data:y,isLoading:v}=Xr({queryKey:[s?"datastores":"coveragestores",o,d,m],queryFn:()=>s?cU(o,d,m):dU(o,d,m),enabled:i&&a&&!!o&&!!d&&!!m});return i?u.jsxs(ss,{isOpen:i,onClose:r,size:"xl",isCentered:!0,children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{borderRadius:"xl",overflow:"hidden",maxH:"85vh",children:[u.jsx(ue,{bg:s?"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)":"linear-gradient(135deg, #D4922A 0%, #E8A331 100%)",px:6,py:4,children:u.jsxs(fe,{spacing:3,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:2,borderRadius:"lg",children:u.jsx(ze,{as:s?Wn:wc,boxSize:5,color:"white"})}),u.jsxs(ue,{children:[u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:s?"Data Store Details":"Coverage Store Details"}),u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:m})]})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:6,overflowY:"auto",children:v?u.jsxs(lt,{py:10,children:[u.jsx(kn,{size:"xl",color:"kartoza.500"}),u.jsx(J,{color:"gray.500",children:"Loading store details..."})]}):y?u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsxs(ue,{p:4,bg:"gray.50",borderRadius:"lg",children:[u.jsxs(fe,{mb:3,children:[u.jsx(ze,{as:I1,color:"kartoza.500"}),u.jsx(J,{fontWeight:"bold",color:"gray.600",children:"Store Information"})]}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,children:[u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Name"}),u.jsx(J,{fontWeight:"medium",children:y.name})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Type"}),u.jsxs(fe,{children:[u.jsx(J,{fontWeight:"medium",children:y.type||"Unknown"}),u.jsx(Qt,{colorScheme:s?"blue":"orange",children:s?"Vector":"Raster"})]})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Workspace"}),u.jsxs(fe,{children:[u.jsx(ze,{as:mh,color:"gray.400",boxSize:4}),u.jsx(J,{fontWeight:"medium",children:d})]})]}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Status"}),u.jsx(Qt,{colorScheme:y.enabled?"green":"gray",fontSize:"sm",children:y.enabled?"Enabled":"Disabled"})]})]})]}),!s&&y.description&&u.jsxs(u.Fragment,{children:[u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"bold",color:"gray.600",mb:2,children:"Description"}),u.jsx(J,{color:"gray.600",children:y.description})]})]}),u.jsx(U5,{allowToggle:!0,children:u.jsxs(H5,{border:"none",children:[u.jsxs(q5,{bg:"gray.50",borderRadius:"lg",_hover:{bg:"gray.100"},children:[u.jsx(ue,{flex:"1",textAlign:"left",children:u.jsx(J,{fontWeight:"500",color:"gray.600",children:"Technical Details"})}),u.jsx(Q5,{})]}),u.jsx(G5,{pb:4,children:u.jsxs(lt,{align:"stretch",spacing:2,children:[u.jsxs(fe,{justify:"space-between",children:[u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Store Type:"}),u.jsx(nh,{fontSize:"sm",children:y.type||"Unknown"})]}),u.jsxs(fe,{justify:"space-between",children:[u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Workspace:"}),u.jsx(nh,{fontSize:"sm",children:d})]}),u.jsxs(fe,{justify:"space-between",children:[u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Enabled:"}),u.jsx(nh,{fontSize:"sm",children:y.enabled?"true":"false"})]})]})})]})}),u.jsx(ue,{p:4,bg:"blue.50",borderRadius:"lg",borderLeft:"4px solid",borderLeftColor:"blue.400",children:u.jsxs(J,{fontSize:"sm",color:"blue.700",children:[u.jsx("strong",{children:"Note:"})," Store configuration (connection parameters, file paths, etc.) can be modified through the GeoServer admin interface. This view shows the current store metadata."]})})]}):u.jsx(lt,{py:10,children:u.jsx(J,{color:"gray.500",children:"Store not found"})})}),u.jsx(To,{gap:3,borderTop:"1px solid",borderTopColor:"gray.100",bg:"gray.50",children:u.jsx(gt,{colorScheme:"kartoza",onClick:r,borderRadius:"lg",px:6,children:"Close"})})]})]}):null}function n_e(){const t=bt(s=>s.activeDialog),e=bt(s=>s.closeDialog),r=bt(s=>s.settings),n=bt(s=>s.setShowHiddenPGServices),i=t==="settings";return u.jsxs(ss,{isOpen:i,onClose:e,size:"md",isCentered:!0,children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{borderRadius:"xl",overflow:"hidden",children:[u.jsx(ue,{bg:"linear-gradient(135deg, #4A5568 0%, #2D3748 100%)",px:6,py:4,children:u.jsxs(fe,{spacing:3,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:2,borderRadius:"lg",children:u.jsx(ze,{as:R1,boxSize:5,color:"white"})}),u.jsxs(ue,{children:[u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:"Settings"}),u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:"Configure application preferences"})]})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:6,children:u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsxs(ue,{children:[u.jsxs(fe,{spacing:2,mb:4,children:[u.jsx(ze,{as:fm,color:"blue.600"}),u.jsx(J,{fontWeight:"600",color:"gray.700",children:"PostgreSQL Services"})]}),u.jsxs(Ot,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[u.jsxs(fe,{spacing:3,children:[u.jsx(ze,{as:Ri,color:"gray.500"}),u.jsxs(ue,{children:[u.jsx(jt,{htmlFor:"show-hidden-pg",mb:0,cursor:"pointer",children:"Show hidden services"}),u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Display hidden PostgreSQL services in tree and dashboard"})]})]}),u.jsx(fa,{id:"show-hidden-pg",colorScheme:"blue",isChecked:r.showHiddenPGServices,onChange:s=>n(s.target.checked)})]})]}),u.jsx(Nr,{}),u.jsx(ue,{children:u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Hidden services are commented out in your pg_service.conf file. They won't be used by applications but can be restored later."})})]})}),u.jsx(To,{borderTop:"1px solid",borderTopColor:"gray.100",bg:"gray.50",children:u.jsx(gt,{onClick:e,colorScheme:"blue",borderRadius:"lg",children:"Done"})})]})]})}let XA=[],jU=[];(()=>{let t="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,r=0;e<t.length;e++)(e%2?jU:XA).push(r=r+t[e])})();function i_e(t){if(t<768)return!1;for(let e=0,r=XA.length;;){let n=e+r>>1;if(t<XA[n])r=n;else if(t>=jU[n])e=n+1;else return!0;if(e==r)return!1}}function yF(t){return t>=127462&&t<=127487}const xF=8205;function s_e(t,e,r=!0,n=!0){return(r?PU:o_e)(t,e,n)}function PU(t,e,r){if(e==t.length)return e;e&&AU(t.charCodeAt(e))&&EU(t.charCodeAt(e-1))&&e--;let n=ij(t,e);for(e+=vF(n);e<t.length;){let i=ij(t,e);if(n==xF||i==xF||r&&i_e(i))e+=vF(i),n=i;else if(yF(i)){let s=0,a=e-2;for(;a>=0&&yF(ij(t,a));)s++,a-=2;if(s%2==0)break;e+=2}else break}return e}function o_e(t,e,r){for(;e>0;){let n=PU(t,e-2,r);if(n<e)return n;e--}return 0}function ij(t,e){let r=t.charCodeAt(e);if(!EU(r)||e+1==t.length)return r;let n=t.charCodeAt(e+1);return AU(n)?(r-55296<<10)+(n-56320)+65536:r}function AU(t){return t>=56320&&t<57344}function EU(t){return t>=55296&&t<56320}function vF(t){return t<65536?1:2}class Sn{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,r,n){[e,r]=o0(this,e,r);let i=[];return this.decompose(0,e,i,2),n.length&&n.decompose(0,n.length,i,3),this.decompose(r,this.length,i,1),ou.from(i,this.length-(r-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,r=this.length){[e,r]=o0(this,e,r);let n=[];return this.decompose(e,r,n,0),ou.from(n,r-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let r=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),i=new Wv(this),s=new Wv(e);for(let a=r,o=r;;){if(i.next(a),s.next(a),a=0,i.lineBreak!=s.lineBreak||i.done!=s.done||i.value!=s.value)return!1;if(o+=i.value.length,i.done||o>=n)return!0}}iter(e=1){return new Wv(this,e)}iterRange(e,r=this.length){return new zU(this,e,r)}iterLines(e,r){let n;if(e==null)n=this.iter();else{r==null&&(r=this.lines+1);let i=this.line(e).from;n=this.iterRange(i,Math.max(i,r==this.lines+1?this.length:r<=1?0:this.line(r-1).to))}return new MU(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Sn.empty:e.length<=32?new Bi(e):ou.from(Bi.split(e,[]))}}class Bi extends Sn{constructor(e,r=a_e(e)){super(),this.text=e,this.length=r}get lines(){return this.text.length}get children(){return null}lineInner(e,r,n,i){for(let s=0;;s++){let a=this.text[s],o=i+a.length;if((r?n:o)>=e)return new l_e(i,o,n,a);i=o+1,n++}}decompose(e,r,n,i){let s=e<=0&&r>=this.length?this:new Bi(bF(this.text,e,r),Math.min(r,this.length)-Math.max(0,e));if(i&1){let a=n.pop(),o=PS(s.text,a.text.slice(),0,s.length);if(o.length<=32)n.push(new Bi(o,a.length+s.length));else{let d=o.length>>1;n.push(new Bi(o.slice(0,d)),new Bi(o.slice(d)))}}else n.push(s)}replace(e,r,n){if(!(n instanceof Bi))return super.replace(e,r,n);[e,r]=o0(this,e,r);let i=PS(this.text,PS(n.text,bF(this.text,0,e)),r),s=this.length+n.length-(r-e);return i.length<=32?new Bi(i,s):ou.from(Bi.split(i,[]),s)}sliceString(e,r=this.length,n=`
`){[e,r]=o0(this,e,r);let i="";for(let s=0,a=0;s<=r&&a<this.text.length;a++){let o=this.text[a],d=s+o.length;s>e&&a&&(i+=n),e<d&&r>s&&(i+=o.slice(Math.max(0,e-s),r-s)),s=d+1}return i}flatten(e){for(let r of this.text)e.push(r)}scanIdentical(){return 0}static split(e,r){let n=[],i=-1;for(let s of e)n.push(s),i+=s.length+1,n.length==32&&(r.push(new Bi(n,i)),n=[],i=-1);return i>-1&&r.push(new Bi(n,i)),r}}class ou extends Sn{constructor(e,r){super(),this.children=e,this.length=r,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,r,n,i){for(let s=0;;s++){let a=this.children[s],o=i+a.length,d=n+a.lines-1;if((r?d:o)>=e)return a.lineInner(e,r,n,i);i=o+1,n=d+1}}decompose(e,r,n,i){for(let s=0,a=0;a<=r&&s<this.children.length;s++){let o=this.children[s],d=a+o.length;if(e<=d&&r>=a){let m=i&((a<=e?1:0)|(d>=r?2:0));a>=e&&d<=r&&!m?n.push(o):o.decompose(e-a,r-a,n,m)}a=d+1}}replace(e,r,n){if([e,r]=o0(this,e,r),n.lines<this.lines)for(let i=0,s=0;i<this.children.length;i++){let a=this.children[i],o=s+a.length;if(e>=s&&r<=o){let d=a.replace(e-s,r-s,n),m=this.lines-a.lines+d.lines;if(d.lines<m>>4&&d.lines>m>>6){let y=this.children.slice();return y[i]=d,new ou(y,this.length-(r-e)+n.length)}return super.replace(s,o,d)}s=o+1}return super.replace(e,r,n)}sliceString(e,r=this.length,n=`
`){[e,r]=o0(this,e,r);let i="";for(let s=0,a=0;s<this.children.length&&a<=r;s++){let o=this.children[s],d=a+o.length;a>e&&s&&(i+=n),e<d&&r>a&&(i+=o.sliceString(e-a,r-a,n)),a=d+1}return i}flatten(e){for(let r of this.children)r.flatten(e)}scanIdentical(e,r){if(!(e instanceof ou))return 0;let n=0,[i,s,a,o]=r>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=r,s+=r){if(i==a||s==o)return n;let d=this.children[i],m=e.children[s];if(d!=m)return n+d.scanIdentical(m,r);n+=d.length+1}}static from(e,r=e.reduce((n,i)=>n+i.length+1,-1)){let n=0;for(let O of e)n+=O.lines;if(n<32){let O=[];for(let P of e)P.flatten(O);return new Bi(O,r)}let i=Math.max(32,n>>5),s=i<<1,a=i>>1,o=[],d=0,m=-1,y=[];function v(O){let P;if(O.lines>s&&O instanceof ou)for(let E of O.children)v(E);else O.lines>a&&(d>a||!d)?(w(),o.push(O)):O instanceof Bi&&d&&(P=y[y.length-1])instanceof Bi&&O.lines+P.lines<=32?(d+=O.lines,m+=O.length+1,y[y.length-1]=new Bi(P.text.concat(O.text),P.length+1+O.length)):(d+O.lines>i&&w(),d+=O.lines,m+=O.length+1,y.push(O))}function w(){d!=0&&(o.push(y.length==1?y[0]:ou.from(y,m)),m=-1,d=y.length=0)}for(let O of e)v(O);return w(),o.length==1?o[0]:new ou(o,r)}}Sn.empty=new Bi([""],0);function a_e(t){let e=-1;for(let r of t)e+=r.length+1;return e}function PS(t,e,r=0,n=1e9){for(let i=0,s=0,a=!0;s<t.length&&i<=n;s++){let o=t[s],d=i+o.length;d>=r&&(d>n&&(o=o.slice(0,n-i)),i<r&&(o=o.slice(r-i)),a?(e[e.length-1]+=o,a=!1):e.push(o)),i=d+1}return e}function bF(t,e,r){return PS(t,[""],e,r)}class Wv{constructor(e,r=1){this.dir=r,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[r>0?1:(e instanceof Bi?e.text.length:e.children.length)<<1]}nextInner(e,r){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,i=this.nodes[n],s=this.offsets[n],a=s>>1,o=i instanceof Bi?i.text.length:i.children.length;if(a==(r>0?o:0)){if(n==0)return this.done=!0,this.value="",this;r>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(r>0?0:1)){if(this.offsets[n]+=r,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(i instanceof Bi){let d=i.text[a+(r<0?-1:0)];if(this.offsets[n]+=r,d.length>Math.max(0,e))return this.value=e==0?d:r>0?d.slice(e):d.slice(0,d.length-e),this;e-=d.length}else{let d=i.children[a+(r<0?-1:0)];e>d.length?(e-=d.length,this.offsets[n]+=r):(r<0&&this.offsets[n]--,this.nodes.push(d),this.offsets.push(r>0?1:(d instanceof Bi?d.text.length:d.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class zU{constructor(e,r,n){this.value="",this.done=!1,this.cursor=new Wv(e,r>n?-1:1),this.pos=r>n?e.length:0,this.from=Math.min(r,n),this.to=Math.max(r,n)}nextInner(e,r){if(r<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,r<0?this.pos-this.to:this.from-this.pos);let n=r<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*r,this.value=i.length<=n?i:r<0?i.slice(i.length-n):i.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class MU{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:r,lineBreak:n,value:i}=this.inner.next(e);return r&&this.afterBreak?(this.value="",this.afterBreak=!1):r?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Sn.prototype[Symbol.iterator]=function(){return this.iter()},Wv.prototype[Symbol.iterator]=zU.prototype[Symbol.iterator]=MU.prototype[Symbol.iterator]=function(){return this});class l_e{constructor(e,r,n,i){this.from=e,this.to=r,this.number=n,this.text=i}get length(){return this.to-this.from}}function o0(t,e,r){return e=Math.max(0,Math.min(t.length,e)),[e,Math.max(e,Math.min(t.length,r))]}function bs(t,e,r=!0,n=!0){return s_e(t,e,r,n)}function c_e(t){return t>=56320&&t<57344}function u_e(t){return t>=55296&&t<56320}function ma(t,e){let r=t.charCodeAt(e);if(!u_e(r)||e+1==t.length)return r;let n=t.charCodeAt(e+1);return c_e(n)?(r-55296<<10)+(n-56320)+65536:r}function LM(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}function au(t){return t<65536?1:2}const KA=/\r\n?|\n/;var Uo=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(Uo||(Uo={}));class bu{constructor(e){this.sections=e}get length(){let e=0;for(let r=0;r<this.sections.length;r+=2)e+=this.sections[r];return e}get newLength(){let e=0;for(let r=0;r<this.sections.length;r+=2){let n=this.sections[r+1];e+=n<0?this.sections[r]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let r=0,n=0,i=0;r<this.sections.length;){let s=this.sections[r++],a=this.sections[r++];a<0?(e(n,i,s),i+=s):i+=a,n+=s}}iterChangedRanges(e,r=!1){ZA(this,e,r)}get invertedDesc(){let e=[];for(let r=0;r<this.sections.length;){let n=this.sections[r++],i=this.sections[r++];i<0?e.push(n,i):e.push(i,n)}return new bu(e)}composeDesc(e){return this.empty?e:e.empty?this:IU(this,e)}mapDesc(e,r=!1){return e.empty?this:YA(this,e,r)}mapPos(e,r=-1,n=Uo.Simple){let i=0,s=0;for(let a=0;a<this.sections.length;){let o=this.sections[a++],d=this.sections[a++],m=i+o;if(d<0){if(m>e)return s+(e-i);s+=o}else{if(n!=Uo.Simple&&m>=e&&(n==Uo.TrackDel&&i<e&&m>e||n==Uo.TrackBefore&&i<e||n==Uo.TrackAfter&&m>e))return null;if(m>e||m==e&&r<0&&!o)return e==i||r<0?s:s+d;s+=d}i=m}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return s}touchesRange(e,r=e){for(let n=0,i=0;n<this.sections.length&&i<=r;){let s=this.sections[n++],a=this.sections[n++],o=i+s;if(a>=0&&i<=r&&o>=e)return i<e&&o>r?"cover":!0;i=o}return!1}toString(){let e="";for(let r=0;r<this.sections.length;){let n=this.sections[r++],i=this.sections[r++];e+=(e?" ":"")+n+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(r=>typeof r!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new bu(e)}static create(e){return new bu(e)}}class ms extends bu{constructor(e,r){super(e),this.inserted=r}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return ZA(this,(r,n,i,s,a)=>e=e.replace(i,i+(n-r),a),!1),e}mapDesc(e,r=!1){return YA(this,e,r,!0)}invert(e){let r=this.sections.slice(),n=[];for(let i=0,s=0;i<r.length;i+=2){let a=r[i],o=r[i+1];if(o>=0){r[i]=o,r[i+1]=a;let d=i>>1;for(;n.length<d;)n.push(Sn.empty);n.push(a?e.slice(s,s+a):Sn.empty)}s+=a}return new ms(r,n)}compose(e){return this.empty?e:e.empty?this:IU(this,e,!0)}map(e,r=!1){return e.empty?this:YA(this,e,r,!0)}iterChanges(e,r=!1){ZA(this,e,r)}get desc(){return bu.create(this.sections)}filter(e){let r=[],n=[],i=[],s=new Rb(this);e:for(let a=0,o=0;;){let d=a==e.length?1e9:e[a++];for(;o<d||o==d&&s.len==0;){if(s.done)break e;let y=Math.min(s.len,d-o);So(i,y,-1);let v=s.ins==-1?-1:s.off==0?s.ins:0;So(r,y,v),v>0&&Ld(n,r,s.text),s.forward(y),o+=y}let m=e[a++];for(;o<m;){if(s.done)break e;let y=Math.min(s.len,m-o);So(r,y,-1),So(i,y,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(y),o+=y}}return{changes:new ms(r,n),filtered:bu.create(i)}}toJSON(){let e=[];for(let r=0;r<this.sections.length;r+=2){let n=this.sections[r],i=this.sections[r+1];i<0?e.push(n):i==0?e.push([n]):e.push([n].concat(this.inserted[r>>1].toJSON()))}return e}static of(e,r,n){let i=[],s=[],a=0,o=null;function d(y=!1){if(!y&&!i.length)return;a<r&&So(i,r-a,-1);let v=new ms(i,s);o=o?o.compose(v.map(o)):v,i=[],s=[],a=0}function m(y){if(Array.isArray(y))for(let v of y)m(v);else if(y instanceof ms){if(y.length!=r)throw new RangeError(`Mismatched change set length (got ${y.length}, expected ${r})`);d(),o=o?o.compose(y.map(o)):y}else{let{from:v,to:w=v,insert:O}=y;if(v>w||v<0||w>r)throw new RangeError(`Invalid change range ${v} to ${w} (in doc of length ${r})`);let P=O?typeof O=="string"?Sn.of(O.split(n||KA)):O:Sn.empty,E=P.length;if(v==w&&E==0)return;v<a&&d(),v>a&&So(i,v-a,-1),So(i,w-v,E),Ld(s,i,P),a=w}}return m(e),d(!o),o}static empty(e){return new ms(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let r=[],n=[];for(let i=0;i<e.length;i++){let s=e[i];if(typeof s=="number")r.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((a,o)=>o&&typeof a!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)r.push(s[0],0);else{for(;n.length<i;)n.push(Sn.empty);n[i]=Sn.of(s.slice(1)),r.push(s[0],n[i].length)}}}return new ms(r,n)}static createSet(e,r){return new ms(e,r)}}function So(t,e,r,n=!1){if(e==0&&r<=0)return;let i=t.length-2;i>=0&&r<=0&&r==t[i+1]?t[i]+=e:i>=0&&e==0&&t[i]==0?t[i+1]+=r:n?(t[i]+=e,t[i+1]+=r):t.push(e,r)}function Ld(t,e,r){if(r.length==0)return;let n=e.length-2>>1;if(n<t.length)t[t.length-1]=t[t.length-1].append(r);else{for(;t.length<n;)t.push(Sn.empty);t.push(r)}}function ZA(t,e,r){let n=t.inserted;for(let i=0,s=0,a=0;a<t.sections.length;){let o=t.sections[a++],d=t.sections[a++];if(d<0)i+=o,s+=o;else{let m=i,y=s,v=Sn.empty;for(;m+=o,y+=d,d&&n&&(v=v.append(n[a-2>>1])),!(r||a==t.sections.length||t.sections[a+1]<0);)o=t.sections[a++],d=t.sections[a++];e(i,m,s,y,v),i=m,s=y}}}function YA(t,e,r,n=!1){let i=[],s=n?[]:null,a=new Rb(t),o=new Rb(e);for(let d=-1;;){if(a.done&&o.len||o.done&&a.len)throw new Error("Mismatched change set lengths");if(a.ins==-1&&o.ins==-1){let m=Math.min(a.len,o.len);So(i,m,-1),a.forward(m),o.forward(m)}else if(o.ins>=0&&(a.ins<0||d==a.i||a.off==0&&(o.len<a.len||o.len==a.len&&!r))){let m=o.len;for(So(i,o.ins,-1);m;){let y=Math.min(a.len,m);a.ins>=0&&d<a.i&&a.len<=y&&(So(i,0,a.ins),s&&Ld(s,i,a.text),d=a.i),a.forward(y),m-=y}o.next()}else if(a.ins>=0){let m=0,y=a.len;for(;y;)if(o.ins==-1){let v=Math.min(y,o.len);m+=v,y-=v,o.forward(v)}else if(o.ins==0&&o.len<y)y-=o.len,o.next();else break;So(i,m,d<a.i?a.ins:0),s&&d<a.i&&Ld(s,i,a.text),d=a.i,a.forward(a.len-y)}else{if(a.done&&o.done)return s?ms.createSet(i,s):bu.create(i);throw new Error("Mismatched change set lengths")}}}function IU(t,e,r=!1){let n=[],i=r?[]:null,s=new Rb(t),a=new Rb(e);for(let o=!1;;){if(s.done&&a.done)return i?ms.createSet(n,i):bu.create(n);if(s.ins==0)So(n,s.len,0,o),s.next();else if(a.len==0&&!a.done)So(n,0,a.ins,o),i&&Ld(i,n,a.text),a.next();else{if(s.done||a.done)throw new Error("Mismatched change set lengths");{let d=Math.min(s.len2,a.len),m=n.length;if(s.ins==-1){let y=a.ins==-1?-1:a.off?0:a.ins;So(n,d,y,o),i&&y&&Ld(i,n,a.text)}else a.ins==-1?(So(n,s.off?0:s.len,d,o),i&&Ld(i,n,s.textBit(d))):(So(n,s.off?0:s.len,a.off?0:a.ins,o),i&&!a.off&&Ld(i,n,a.text));o=(s.ins>d||a.ins>=0&&a.len>d)&&(o||n.length>m),s.forward2(d),a.forward(d)}}}}class Rb{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,r=this.i-2>>1;return r>=e.length?Sn.empty:e[r]}textBit(e){let{inserted:r}=this.set,n=this.i-2>>1;return n>=r.length&&!e?Sn.empty:r[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class _p{constructor(e,r,n){this.from=e,this.to=r,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,r=-1){let n,i;return this.empty?n=i=e.mapPos(this.from,r):(n=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),n==this.from&&i==this.to?this:new _p(n,i,this.flags)}extend(e,r=e){if(e<=this.anchor&&r>=this.anchor)return pt.range(e,r);let n=Math.abs(e-this.anchor)>Math.abs(r-this.anchor)?e:r;return pt.range(this.anchor,n)}eq(e,r=!1){return this.anchor==e.anchor&&this.head==e.head&&this.goalColumn==e.goalColumn&&(!r||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return pt.range(e.anchor,e.head)}static create(e,r,n){return new _p(e,r,n)}}class pt{constructor(e,r){this.ranges=e,this.mainIndex=r}map(e,r=-1){return e.empty?this:pt.create(this.ranges.map(n=>n.map(e,r)),this.mainIndex)}eq(e,r=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],r))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new pt([this.main],0)}addRange(e,r=!0){return pt.create([e].concat(this.ranges),r?0:this.mainIndex+1)}replaceRange(e,r=this.mainIndex){let n=this.ranges.slice();return n[r]=e,pt.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new pt(e.ranges.map(r=>_p.fromJSON(r)),e.main)}static single(e,r=e){return new pt([pt.range(e,r)],0)}static create(e,r=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,i=0;i<e.length;i++){let s=e[i];if(s.empty?s.from<=n:s.from<n)return pt.normalized(e.slice(),r);n=s.to}return new pt(e,r)}static cursor(e,r=0,n,i){return _p.create(e,e,(r==0?0:r<0?8:16)|(n==null?7:Math.min(6,n))|(i??16777215)<<6)}static range(e,r,n,i){let s=(n??16777215)<<6|(i==null?7:Math.min(6,i));return r<e?_p.create(r,e,48|s):_p.create(e,r,(r>e?8:0)|s)}static normalized(e,r=0){let n=e[r];e.sort((i,s)=>i.from-s.from),r=e.indexOf(n);for(let i=1;i<e.length;i++){let s=e[i],a=e[i-1];if(s.empty?s.from<=a.to:s.from<a.to){let o=a.from,d=Math.max(s.to,a.to);i<=r&&r--,e.splice(--i,2,s.anchor>s.head?pt.range(d,o):pt.range(o,d))}}return new pt(e,r)}}function RU(t,e){for(let r of t.ranges)if(r.to>e)throw new RangeError("Selection points outside of document")}let FM=0;class hr{constructor(e,r,n,i,s){this.combine=e,this.compareInput=r,this.compare=n,this.isStatic=i,this.id=FM++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new hr(e.combine||(r=>r),e.compareInput||((r,n)=>r===n),e.compare||(e.combine?(r,n)=>r===n:BM),!!e.static,e.enables)}of(e){return new AS([],this,0,e)}compute(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new AS(e,this,1,r)}computeN(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new AS(e,this,2,r)}from(e,r){return r||(r=n=>n),this.compute([e],n=>r(n.field(e)))}}function BM(t,e){return t==e||t.length==e.length&&t.every((r,n)=>r===e[n])}class AS{constructor(e,r,n,i){this.dependencies=e,this.facet=r,this.type=n,this.value=i,this.id=FM++}dynamicSlot(e){var r;let n=this.value,i=this.facet.compareInput,s=this.id,a=e[s]>>1,o=this.type==2,d=!1,m=!1,y=[];for(let v of this.dependencies)v=="doc"?d=!0:v=="selection"?m=!0:((r=e[v.id])!==null&&r!==void 0?r:1)&1||y.push(e[v.id]);return{create(v){return v.values[a]=n(v),1},update(v,w){if(d&&w.docChanged||m&&(w.docChanged||w.selection)||JA(v,y)){let O=n(v);if(o?!_F(O,v.values[a],i):!i(O,v.values[a]))return v.values[a]=O,1}return 0},reconfigure:(v,w)=>{let O,P=w.config.address[s];if(P!=null){let E=z2(w,P);if(this.dependencies.every($=>$ instanceof hr?w.facet($)===v.facet($):$ instanceof co?w.field($,!1)==v.field($,!1):!0)||(o?_F(O=n(v),E,i):i(O=n(v),E)))return v.values[a]=E,0}else O=n(v);return v.values[a]=O,1}}}}function _F(t,e,r){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!r(t[n],e[n]))return!1;return!0}function JA(t,e){let r=!1;for(let n of e)Uv(t,n)&1&&(r=!0);return r}function h_e(t,e,r){let n=r.map(d=>t[d.id]),i=r.map(d=>d.type),s=n.filter(d=>!(d&1)),a=t[e.id]>>1;function o(d){let m=[];for(let y=0;y<n.length;y++){let v=z2(d,n[y]);if(i[y]==2)for(let w of v)m.push(w);else m.push(v)}return e.combine(m)}return{create(d){for(let m of n)Uv(d,m);return d.values[a]=o(d),1},update(d,m){if(!JA(d,s))return 0;let y=o(d);return e.compare(y,d.values[a])?0:(d.values[a]=y,1)},reconfigure(d,m){let y=JA(d,n),v=m.config.facets[e.id],w=m.facet(e);if(v&&!y&&BM(r,v))return d.values[a]=w,0;let O=o(d);return e.compare(O,w)?(d.values[a]=w,0):(d.values[a]=O,1)}}}const Sw=hr.define({static:!0});class co{constructor(e,r,n,i,s){this.id=e,this.createF=r,this.updateF=n,this.compareF=i,this.spec=s,this.provides=void 0}static define(e){let r=new co(FM++,e.create,e.update,e.compare||((n,i)=>n===i),e);return e.provide&&(r.provides=e.provide(r)),r}create(e){let r=e.facet(Sw).find(n=>n.field==this);return((r==null?void 0:r.create)||this.createF)(e)}slot(e){let r=e[this.id]>>1;return{create:n=>(n.values[r]=this.create(n),1),update:(n,i)=>{let s=n.values[r],a=this.updateF(s,i);return this.compareF(s,a)?0:(n.values[r]=a,1)},reconfigure:(n,i)=>{let s=n.facet(Sw),a=i.facet(Sw),o;return(o=s.find(d=>d.field==this))&&o!=a.find(d=>d.field==this)?(n.values[r]=o.create(n),1):i.config.address[this.id]!=null?(n.values[r]=i.field(this),0):(n.values[r]=this.create(n),1)}}}init(e){return[this,Sw.of({field:this,create:e})]}get extension(){return this}}const fp={lowest:4,low:3,default:2,high:1,highest:0};function Hx(t){return e=>new DU(e,t)}const wm={highest:Hx(fp.highest),high:Hx(fp.high),default:Hx(fp.default),low:Hx(fp.low),lowest:Hx(fp.lowest)};class DU{constructor(e,r){this.inner=e,this.prec=r}}class dC{of(e){return new eE(this,e)}reconfigure(e){return dC.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class eE{constructor(e,r){this.compartment=e,this.inner=r}}class E2{constructor(e,r,n,i,s,a){for(this.base=e,this.compartments=r,this.dynamicSlots=n,this.address=i,this.staticValues=s,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let r=this.address[e.id];return r==null?e.default:this.staticValues[r>>1]}static resolve(e,r,n){let i=[],s=Object.create(null),a=new Map;for(let w of d_e(e,r,a))w instanceof co?i.push(w):(s[w.facet.id]||(s[w.facet.id]=[])).push(w);let o=Object.create(null),d=[],m=[];for(let w of i)o[w.id]=m.length<<1,m.push(O=>w.slot(O));let y=n==null?void 0:n.config.facets;for(let w in s){let O=s[w],P=O[0].facet,E=y&&y[w]||[];if(O.every($=>$.type==0))if(o[P.id]=d.length<<1|1,BM(E,O))d.push(n.facet(P));else{let $=P.combine(O.map(R=>R.value));d.push(n&&P.compare($,n.facet(P))?n.facet(P):$)}else{for(let $ of O)$.type==0?(o[$.id]=d.length<<1|1,d.push($.value)):(o[$.id]=m.length<<1,m.push(R=>$.dynamicSlot(R)));o[P.id]=m.length<<1,m.push($=>h_e($,P,O))}}let v=m.map(w=>w(o));return new E2(e,a,v,o,d,s)}}function d_e(t,e,r){let n=[[],[],[],[],[]],i=new Map;function s(a,o){let d=i.get(a);if(d!=null){if(d<=o)return;let m=n[d].indexOf(a);m>-1&&n[d].splice(m,1),a instanceof eE&&r.delete(a.compartment)}if(i.set(a,o),Array.isArray(a))for(let m of a)s(m,o);else if(a instanceof eE){if(r.has(a.compartment))throw new RangeError("Duplicate use of compartment in extensions");let m=e.get(a.compartment)||a.inner;r.set(a.compartment,m),s(m,o)}else if(a instanceof DU)s(a.inner,a.prec);else if(a instanceof co)n[o].push(a),a.provides&&s(a.provides,o);else if(a instanceof AS)n[o].push(a),a.facet.extensions&&s(a.facet.extensions,fp.default);else{let m=a.extension;if(!m)throw new Error(`Unrecognized extension value in extension set (${a}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(m,o)}}return s(t,fp.default),n.reduce((a,o)=>a.concat(o))}function Uv(t,e){if(e&1)return 2;let r=e>>1,n=t.status[r];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;t.status[r]=4;let i=t.computeSlot(t,t.config.dynamicSlots[r]);return t.status[r]=2|i}function z2(t,e){return e&1?t.config.staticValues[e>>1]:t.values[e>>1]}const LU=hr.define(),tE=hr.define({combine:t=>t.some(e=>e),static:!0}),FU=hr.define({combine:t=>t.length?t[0]:void 0,static:!0}),BU=hr.define(),$U=hr.define(),NU=hr.define(),VU=hr.define({combine:t=>t.length?t[0]:!1});class ku{constructor(e,r){this.type=e,this.value=r}static define(){return new f_e}}class f_e{of(e){return new ku(this,e)}}class p_e{constructor(e){this.map=e}of(e){return new Qr(this,e)}}class Qr{constructor(e,r){this.type=e,this.value=r}map(e){let r=this.type.map(this.value,e);return r===void 0?void 0:r==this.value?this:new Qr(this.type,r)}is(e){return this.type==e}static define(e={}){return new p_e(e.map||(r=>r))}static mapEffects(e,r){if(!e.length)return e;let n=[];for(let i of e){let s=i.map(r);s&&n.push(s)}return n}}Qr.reconfigure=Qr.define();Qr.appendConfig=Qr.define();class _s{constructor(e,r,n,i,s,a){this.startState=e,this.changes=r,this.selection=n,this.effects=i,this.annotations=s,this.scrollIntoView=a,this._doc=null,this._state=null,n&&RU(n,r.newLength),s.some(o=>o.type==_s.time)||(this.annotations=s.concat(_s.time.of(Date.now())))}static create(e,r,n,i,s,a){return new _s(e,r,n,i,s,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let r of this.annotations)if(r.type==e)return r.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let r=this.annotation(_s.userEvent);return!!(r&&(r==e||r.length>e.length&&r.slice(0,e.length)==e&&r[e.length]=="."))}}_s.time=ku.define();_s.userEvent=ku.define();_s.addToHistory=ku.define();_s.remote=ku.define();function m_e(t,e){let r=[];for(let n=0,i=0;;){let s,a;if(n<t.length&&(i==e.length||e[i]>=t[n]))s=t[n++],a=t[n++];else if(i<e.length)s=e[i++],a=e[i++];else return r;!r.length||r[r.length-1]<s?r.push(s,a):r[r.length-1]<a&&(r[r.length-1]=a)}}function WU(t,e,r){var n;let i,s,a;return r?(i=e.changes,s=ms.empty(e.changes.length),a=t.changes.compose(e.changes)):(i=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),a=t.changes.compose(i)),{changes:a,selection:e.selection?e.selection.map(s):(n=t.selection)===null||n===void 0?void 0:n.map(i),effects:Qr.mapEffects(t.effects,i).concat(Qr.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function rE(t,e,r){let n=e.selection,i=xy(e.annotations);return e.userEvent&&(i=i.concat(_s.userEvent.of(e.userEvent))),{changes:e.changes instanceof ms?e.changes:ms.of(e.changes||[],r,t.facet(FU)),selection:n&&(n instanceof pt?n:pt.single(n.anchor,n.head)),effects:xy(e.effects),annotations:i,scrollIntoView:!!e.scrollIntoView}}function UU(t,e,r){let n=rE(t,e.length?e[0]:{},t.doc.length);e.length&&e[0].filter===!1&&(r=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(r=!1);let a=!!e[s].sequential;n=WU(n,rE(t,e[s],a?n.changes.newLength:t.doc.length),a)}let i=_s.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return y_e(r?g_e(i):i)}function g_e(t){let e=t.startState,r=!0;for(let i of e.facet(BU)){let s=i(t);if(s===!1){r=!1;break}Array.isArray(s)&&(r=r===!0?s:m_e(r,s))}if(r!==!0){let i,s;if(r===!1)s=t.changes.invertedDesc,i=ms.empty(e.doc.length);else{let a=t.changes.filter(r);i=a.changes,s=a.filtered.mapDesc(a.changes).invertedDesc}t=_s.create(e,i,t.selection&&t.selection.map(s),Qr.mapEffects(t.effects,s),t.annotations,t.scrollIntoView)}let n=e.facet($U);for(let i=n.length-1;i>=0;i--){let s=n[i](t);s instanceof _s?t=s:Array.isArray(s)&&s.length==1&&s[0]instanceof _s?t=s[0]:t=UU(e,xy(s),!1)}return t}function y_e(t){let e=t.startState,r=e.facet(NU),n=t;for(let i=r.length-1;i>=0;i--){let s=r[i](t);s&&Object.keys(s).length&&(n=WU(n,rE(e,s,t.changes.newLength),!0))}return n==t?t:_s.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}const x_e=[];function xy(t){return t==null?x_e:Array.isArray(t)?t:[t]}var vi=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(vi||(vi={}));const v_e=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let nE;try{nE=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function b_e(t){if(nE)return nE.test(t);for(let e=0;e<t.length;e++){let r=t[e];if(/\w/.test(r)||r>""&&(r.toUpperCase()!=r.toLowerCase()||v_e.test(r)))return!0}return!1}function __e(t){return e=>{if(!/\S/.test(e))return vi.Space;if(b_e(e))return vi.Word;for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>-1)return vi.Word;return vi.Other}}class fn{constructor(e,r,n,i,s,a){this.config=e,this.doc=r,this.selection=n,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=s,a&&(a._state=this);for(let o=0;o<this.config.dynamicSlots.length;o++)Uv(this,o<<1);this.computeSlot=null}field(e,r=!0){let n=this.config.address[e.id];if(n==null){if(r)throw new RangeError("Field is not present in this state");return}return Uv(this,n),z2(this,n)}update(...e){return UU(this,e,!0)}applyTransaction(e){let r=this.config,{base:n,compartments:i}=r;for(let o of e.effects)o.is(dC.reconfigure)?(r&&(i=new Map,r.compartments.forEach((d,m)=>i.set(m,d)),r=null),i.set(o.value.compartment,o.value.extension)):o.is(Qr.reconfigure)?(r=null,n=o.value):o.is(Qr.appendConfig)&&(r=null,n=xy(n).concat(o.value));let s;r?s=e.startState.values.slice():(r=E2.resolve(n,i,this),s=new fn(r,this.doc,this.selection,r.dynamicSlots.map(()=>null),(d,m)=>m.reconfigure(d,this),null).values);let a=e.startState.facet(tE)?e.newSelection:e.newSelection.asSingle();new fn(r,e.newDoc,a,s,(o,d)=>d.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:e},range:pt.cursor(r.from+e.length)}))}changeByRange(e){let r=this.selection,n=e(r.ranges[0]),i=this.changes(n.changes),s=[n.range],a=xy(n.effects);for(let o=1;o<r.ranges.length;o++){let d=e(r.ranges[o]),m=this.changes(d.changes),y=m.map(i);for(let w=0;w<o;w++)s[w]=s[w].map(y);let v=i.mapDesc(m,!0);s.push(d.range.map(v)),i=i.compose(y),a=Qr.mapEffects(a,y).concat(Qr.mapEffects(xy(d.effects),v))}return{changes:i,selection:pt.create(s,r.mainIndex),effects:a}}changes(e=[]){return e instanceof ms?e:ms.of(e,this.doc.length,this.facet(fn.lineSeparator))}toText(e){return Sn.of(e.split(this.facet(fn.lineSeparator)||KA))}sliceDoc(e=0,r=this.doc.length){return this.doc.sliceString(e,r,this.lineBreak)}facet(e){let r=this.config.address[e.id];return r==null?e.default:(Uv(this,r),z2(this,r))}toJSON(e){let r={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let i=e[n];i instanceof co&&this.config.address[i.id]!=null&&(r[n]=i.spec.toJSON(this.field(e[n]),this))}return r}static fromJSON(e,r={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(n){for(let s in n)if(Object.prototype.hasOwnProperty.call(e,s)){let a=n[s],o=e[s];i.push(a.init(d=>a.spec.fromJSON(o,d)))}}return fn.create({doc:e.doc,selection:pt.fromJSON(e.selection),extensions:r.extensions?i.concat([r.extensions]):i})}static create(e={}){let r=E2.resolve(e.extensions||[],new Map),n=e.doc instanceof Sn?e.doc:Sn.of((e.doc||"").split(r.staticFacet(fn.lineSeparator)||KA)),i=e.selection?e.selection instanceof pt?e.selection:pt.single(e.selection.anchor,e.selection.head):pt.single(0);return RU(i,n.length),r.staticFacet(tE)||(i=i.asSingle()),new fn(r,n,i,r.dynamicSlots.map(()=>null),(s,a)=>a.create(s),null)}get tabSize(){return this.facet(fn.tabSize)}get lineBreak(){return this.facet(fn.lineSeparator)||`
`}get readOnly(){return this.facet(VU)}phrase(e,...r){for(let n of this.facet(fn.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return r.length&&(e=e.replace(/\$(\$|\d*)/g,(n,i)=>{if(i=="$")return"$";let s=+(i||1);return!s||s>r.length?n:r[s-1]})),e}languageDataAt(e,r,n=-1){let i=[];for(let s of this.facet(LU))for(let a of s(this,r,n))Object.prototype.hasOwnProperty.call(a,e)&&i.push(a[e]);return i}charCategorizer(e){let r=this.languageDataAt("wordChars",e);return __e(r.length?r[0]:"")}wordAt(e){let{text:r,from:n,length:i}=this.doc.lineAt(e),s=this.charCategorizer(e),a=e-n,o=e-n;for(;a>0;){let d=bs(r,a,!1);if(s(r.slice(d,a))!=vi.Word)break;a=d}for(;o<i;){let d=bs(r,o);if(s(r.slice(o,d))!=vi.Word)break;o=d}return a==o?null:pt.range(a+n,o+n)}}fn.allowMultipleSelections=tE;fn.tabSize=hr.define({combine:t=>t.length?t[0]:4});fn.lineSeparator=FU;fn.readOnly=VU;fn.phrases=hr.define({compare(t,e){let r=Object.keys(t),n=Object.keys(e);return r.length==n.length&&r.every(i=>t[i]==e[i])}});fn.languageData=LU;fn.changeFilter=BU;fn.transactionFilter=$U;fn.transactionExtender=NU;dC.reconfigure=Qr.define();function Cu(t,e,r={}){let n={};for(let i of t)for(let s of Object.keys(i)){let a=i[s],o=n[s];if(o===void 0)n[s]=a;else if(!(o===a||a===void 0))if(Object.hasOwnProperty.call(r,s))n[s]=r[s](o,a);else throw new Error("Config merge conflict for field "+s)}for(let i in e)n[i]===void 0&&(n[i]=e[i]);return n}class df{eq(e){return this==e}range(e,r=e){return iE.create(e,r,this)}}df.prototype.startSide=df.prototype.endSide=0;df.prototype.point=!1;df.prototype.mapMode=Uo.TrackDel;function $M(t,e){return t==e||t.constructor==e.constructor&&t.eq(e)}let iE=class qU{constructor(e,r,n){this.from=e,this.to=r,this.value=n}static create(e,r,n){return new qU(e,r,n)}};function sE(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class NM{constructor(e,r,n,i){this.from=e,this.to=r,this.value=n,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,r,n,i=0){let s=n?this.to:this.from;for(let a=i,o=s.length;;){if(a==o)return a;let d=a+o>>1,m=s[d]-e||(n?this.value[d].endSide:this.value[d].startSide)-r;if(d==a)return m>=0?a:o;m>=0?o=d:a=d+1}}between(e,r,n,i){for(let s=this.findIndex(r,-1e9,!0),a=this.findIndex(n,1e9,!1,s);s<a;s++)if(i(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,r){let n=[],i=[],s=[],a=-1,o=-1;for(let d=0;d<this.value.length;d++){let m=this.value[d],y=this.from[d]+e,v=this.to[d]+e,w,O;if(y==v){let P=r.mapPos(y,m.startSide,m.mapMode);if(P==null||(w=O=P,m.startSide!=m.endSide&&(O=r.mapPos(y,m.endSide),O<w)))continue}else if(w=r.mapPos(y,m.startSide),O=r.mapPos(v,m.endSide),w>O||w==O&&m.startSide>0&&m.endSide<=0)continue;(O-w||m.endSide-m.startSide)<0||(a<0&&(a=w),m.point&&(o=Math.max(o,O-w)),n.push(m),i.push(w-a),s.push(O-a))}return{mapped:n.length?new NM(i,s,n,o):null,pos:a}}}class sn{constructor(e,r,n,i){this.chunkPos=e,this.chunk=r,this.nextLayer=n,this.maxPoint=i}static create(e,r,n,i){return new sn(e,r,n,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let r of this.chunk)e+=r.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:r=[],sort:n=!1,filterFrom:i=0,filterTo:s=this.length}=e,a=e.filter;if(r.length==0&&!a)return this;if(n&&(r=r.slice().sort(sE)),this.isEmpty)return r.length?sn.of(r):this;let o=new QU(this,null,-1).goto(0),d=0,m=[],y=new kh;for(;o.value||d<r.length;)if(d<r.length&&(o.from-r[d].from||o.startSide-r[d].value.startSide)>=0){let v=r[d++];y.addInner(v.from,v.to,v.value)||m.push(v)}else o.rangeIndex==1&&o.chunkIndex<this.chunk.length&&(d==r.length||this.chunkEnd(o.chunkIndex)<r[d].from)&&(!a||i>this.chunkEnd(o.chunkIndex)||s<this.chunkPos[o.chunkIndex])&&y.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!a||i>o.to||s<o.from||a(o.from,o.to,o.value))&&(y.addInner(o.from,o.to,o.value)||m.push(iE.create(o.from,o.to,o.value))),o.next());return y.finishInner(this.nextLayer.isEmpty&&!m.length?sn.empty:this.nextLayer.update({add:m,filter:a,filterFrom:i,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let r=[],n=[],i=-1;for(let a=0;a<this.chunk.length;a++){let o=this.chunkPos[a],d=this.chunk[a],m=e.touchesRange(o,o+d.length);if(m===!1)i=Math.max(i,d.maxPoint),r.push(d),n.push(e.mapPos(o));else if(m===!0){let{mapped:y,pos:v}=d.map(o,e);y&&(i=Math.max(i,y.maxPoint),r.push(y),n.push(v))}}let s=this.nextLayer.map(e);return r.length==0?s:new sn(n,r,s||sn.empty,i)}between(e,r,n){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let s=this.chunkPos[i],a=this.chunk[i];if(r>=s&&e<=s+a.length&&a.between(s,e-s,r-s,n)===!1)return}this.nextLayer.between(e,r,n)}}iter(e=0){return Db.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,r=0){return Db.from(e).goto(r)}static compare(e,r,n,i,s=-1){let a=e.filter(v=>v.maxPoint>0||!v.isEmpty&&v.maxPoint>=s),o=r.filter(v=>v.maxPoint>0||!v.isEmpty&&v.maxPoint>=s),d=wF(a,o,n),m=new Gx(a,d,s),y=new Gx(o,d,s);n.iterGaps((v,w,O)=>SF(m,v,y,w,O,i)),n.empty&&n.length==0&&SF(m,0,y,0,0,i)}static eq(e,r,n=0,i){i==null&&(i=999999999);let s=e.filter(y=>!y.isEmpty&&r.indexOf(y)<0),a=r.filter(y=>!y.isEmpty&&e.indexOf(y)<0);if(s.length!=a.length)return!1;if(!s.length)return!0;let o=wF(s,a),d=new Gx(s,o,0).goto(n),m=new Gx(a,o,0).goto(n);for(;;){if(d.to!=m.to||!oE(d.active,m.active)||d.point&&(!m.point||!$M(d.point,m.point)))return!1;if(d.to>i)return!0;d.next(),m.next()}}static spans(e,r,n,i,s=-1){let a=new Gx(e,null,s).goto(r),o=r,d=a.openStart;for(;;){let m=Math.min(a.to,n);if(a.point){let y=a.activeForPoint(a.to),v=a.pointFrom<r?y.length+1:a.point.startSide<0?y.length:Math.min(y.length,d);i.point(o,m,a.point,y,v,a.pointRank),d=Math.min(a.openEnd(m),y.length)}else m>o&&(i.span(o,m,a.active,d),d=a.openEnd(m));if(a.to>n)return d+(a.point&&a.to>n?1:0);o=a.to,a.next()}}static of(e,r=!1){let n=new kh;for(let i of e instanceof iE?[e]:r?w_e(e):e)n.add(i.from,i.to,i.value);return n.finish()}static join(e){if(!e.length)return sn.empty;let r=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let i=e[n];i!=sn.empty;i=i.nextLayer)r=new sn(i.chunkPos,i.chunk,r,Math.max(i.maxPoint,r.maxPoint));return r}}sn.empty=new sn([],[],null,-1);function w_e(t){if(t.length>1)for(let e=t[0],r=1;r<t.length;r++){let n=t[r];if(sE(e,n)>0)return t.slice().sort(sE);e=n}return t}sn.empty.nextLayer=sn.empty;class kh{finishChunk(e){this.chunks.push(new NM(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,r,n){this.addInner(e,r,n)||(this.nextLayer||(this.nextLayer=new kh)).add(e,r,n)}addInner(e,r,n){let i=e-this.lastTo||n.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return i<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(r-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=r,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,r-e)),!0)}addChunk(e,r){if((e-this.lastTo||r.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,r.maxPoint),this.chunks.push(r),this.chunkPos.push(e);let n=r.value.length-1;return this.last=r.value[n],this.lastFrom=r.from[n]+e,this.lastTo=r.to[n]+e,!0}finish(){return this.finishInner(sn.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let r=sn.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,r}}function wF(t,e,r){let n=new Map;for(let s of t)for(let a=0;a<s.chunk.length;a++)s.chunk[a].maxPoint<=0&&n.set(s.chunk[a],s.chunkPos[a]);let i=new Set;for(let s of e)for(let a=0;a<s.chunk.length;a++){let o=n.get(s.chunk[a]);o!=null&&(r?r.mapPos(o):o)==s.chunkPos[a]&&!(r!=null&&r.touchesRange(o,o+s.chunk[a].length))&&i.add(s.chunk[a])}return i}class QU{constructor(e,r,n,i=0){this.layer=e,this.skip=r,this.minPoint=n,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,r=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,r,!1),this}gotoInner(e,r,n){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<e||i.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],r,!0);(!n||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,r){(this.to-e||this.endSide-r)<0&&this.gotoInner(e,r,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],r=this.layer.chunk[this.chunkIndex],n=e+r.from[this.rangeIndex];if(this.from=n,this.to=e+r.to[this.rangeIndex],this.value=r.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Db{constructor(e){this.heap=e}static from(e,r=null,n=-1){let i=[];for(let s=0;s<e.length;s++)for(let a=e[s];!a.isEmpty;a=a.nextLayer)a.maxPoint>=n&&i.push(new QU(a,r,n,s));return i.length==1?i[0]:new Db(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,r=-1e9){for(let n of this.heap)n.goto(e,r);for(let n=this.heap.length>>1;n>=0;n--)sj(this.heap,n);return this.next(),this}forward(e,r){for(let n of this.heap)n.forward(e,r);for(let n=this.heap.length>>1;n>=0;n--)sj(this.heap,n);(this.to-e||this.value.endSide-r)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),sj(this.heap,0)}}}function sj(t,e){for(let r=t[e];;){let n=(e<<1)+1;if(n>=t.length)break;let i=t[n];if(n+1<t.length&&i.compare(t[n+1])>=0&&(i=t[n+1],n++),r.compare(i)<0)break;t[n]=r,t[e]=i,e=n}}class Gx{constructor(e,r,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Db.from(e,r,n)}goto(e,r=-1e9){return this.cursor.goto(e,r),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=r,this.openStart=-1,this.next(),this}forward(e,r){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-r)<0;)this.removeActive(this.minActive);this.cursor.forward(e,r)}removeActive(e){kw(this.active,e),kw(this.activeTo,e),kw(this.activeRank,e),this.minActive=kF(this.active,this.activeTo)}addActive(e){let r=0,{value:n,to:i,rank:s}=this.cursor;for(;r<this.activeRank.length&&(s-this.activeRank[r]||i-this.activeTo[r])>0;)r++;Cw(this.active,r,n),Cw(this.activeTo,r,i),Cw(this.activeRank,r,s),e&&Cw(e,r,this.cursor.from),this.minActive=kF(this.active,this.activeTo)}next(){let e=this.to,r=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),n&&kw(n,i)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(n),this.cursor.next();else if(r&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let i=n.length-1;i>=0&&n[i]<e;i--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let r=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&r.push(this.active[n]);return r.reverse()}openEnd(e){let r=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)r++;return r}}function SF(t,e,r,n,i,s){t.goto(e),r.goto(n);let a=n+i,o=n,d=n-e,m=!!s.boundChange;for(let y=!1;;){let v=t.to+d-r.to,w=v||t.endSide-r.endSide,O=w<0?t.to+d:r.to,P=Math.min(O,a);if(t.point||r.point?(t.point&&r.point&&$M(t.point,r.point)&&oE(t.activeForPoint(t.to),r.activeForPoint(r.to))||s.comparePoint(o,P,t.point,r.point),y=!1):(y&&s.boundChange(o),P>o&&!oE(t.active,r.active)&&s.compareRange(o,P,t.active,r.active),m&&P<a&&(v||t.openEnd(O)!=r.openEnd(O))&&(y=!0)),O>a)break;o=O,w<=0&&t.next(),w>=0&&r.next()}}function oE(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!=e[r]&&!$M(t[r],e[r]))return!1;return!0}function kw(t,e){for(let r=e,n=t.length-1;r<n;r++)t[r]=t[r+1];t.pop()}function Cw(t,e,r){for(let n=t.length-1;n>=e;n--)t[n+1]=t[n];t[e]=r}function kF(t,e){let r=-1,n=1e9;for(let i=0;i<e.length;i++)(e[i]-n||t[i].endSide-t[r].endSide)<0&&(r=i,n=e[i]);return r}function C0(t,e,r=t.length){let n=0;for(let i=0;i<r&&i<t.length;)t.charCodeAt(i)==9?(n+=e-n%e,i++):(n++,i=bs(t,i));return n}function aE(t,e,r,n){for(let i=0,s=0;;){if(s>=e)return i;if(i==t.length)break;s+=t.charCodeAt(i)==9?r-s%r:1,i=bs(t,i)}return n===!0?-1:t.length}const lE="",CF=typeof Symbol>"u"?"__"+lE:Symbol.for(lE),cE=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),TF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class ff{constructor(e,r){this.rules=[];let{finish:n}=r||{};function i(a){return/^@/.test(a)?[a]:a.split(/,\s*/)}function s(a,o,d,m){let y=[],v=/^@(\w+)\b/.exec(a[0]),w=v&&v[1]=="keyframes";if(v&&o==null)return d.push(a[0]+";");for(let O in o){let P=o[O];if(/&/.test(O))s(O.split(/,\s*/).map(E=>a.map($=>E.replace(/&/,$))).reduce((E,$)=>E.concat($)),P,d);else if(P&&typeof P=="object"){if(!v)throw new RangeError("The value of a property ("+O+") should be a primitive value.");s(i(O),P,y,w)}else P!=null&&y.push(O.replace(/_.*/,"").replace(/[A-Z]/g,E=>"-"+E.toLowerCase())+": "+P+";")}(y.length||w)&&d.push((n&&!v&&!m?a.map(n):a).join(", ")+" {"+y.join(" ")+"}")}for(let a in e)s(i(a),e[a],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=TF[CF]||1;return TF[CF]=e+1,lE+e.toString(36)}static mount(e,r,n){let i=e[cE],s=n&&n.nonce;i?s&&i.setNonce(s):i=new S_e(e,s),i.mount(Array.isArray(r)?r:[r],e)}}let OF=new Map;class S_e{constructor(e,r){let n=e.ownerDocument||e,i=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){let s=OF.get(n);if(s)return e[cE]=s;this.sheet=new i.CSSStyleSheet,OF.set(n,this)}else this.styleTag=n.createElement("style"),r&&this.styleTag.setAttribute("nonce",r);this.modules=[],e[cE]=this}mount(e,r){let n=this.sheet,i=0,s=0;for(let a=0;a<e.length;a++){let o=e[a],d=this.modules.indexOf(o);if(d<s&&d>-1&&(this.modules.splice(d,1),s--,d=-1),d==-1){if(this.modules.splice(s++,0,o),n)for(let m=0;m<o.rules.length;m++)n.insertRule(o.rules[m],i++)}else{for(;s<d;)i+=this.modules[s++].rules.length;i+=o.rules.length,s++}}if(n)r.adoptedStyleSheets.indexOf(this.sheet)<0&&(r.adoptedStyleSheets=[this.sheet,...r.adoptedStyleSheets]);else{let a="";for(let d=0;d<this.modules.length;d++)a+=this.modules[d].getRules()+`
`;this.styleTag.textContent=a;let o=r.head||r;this.styleTag.parentNode!=o&&o.insertBefore(this.styleTag,o.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var pf={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Lb={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},k_e=typeof navigator<"u"&&/Mac/.test(navigator.platform),C_e=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var eo=0;eo<10;eo++)pf[48+eo]=pf[96+eo]=String(eo);for(var eo=1;eo<=24;eo++)pf[eo+111]="F"+eo;for(var eo=65;eo<=90;eo++)pf[eo]=String.fromCharCode(eo+32),Lb[eo]=String.fromCharCode(eo);for(var oj in pf)Lb.hasOwnProperty(oj)||(Lb[oj]=pf[oj]);function T_e(t){var e=k_e&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||C_e&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!e&&t.key||(t.shiftKey?Lb:pf)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}function Kn(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,r=arguments[1];if(r&&typeof r=="object"&&r.nodeType==null&&!Array.isArray(r)){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var i=r[n];typeof i=="string"?t.setAttribute(n,i):i!=null&&(t[n]=i)}e++}for(;e<arguments.length;e++)HU(t,arguments[e]);return t}function HU(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var r=0;r<e.length;r++)HU(t,e[r]);else throw new RangeError("Unsupported child node: "+e)}let No=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},uE=typeof document<"u"?document:{documentElement:{style:{}}};const hE=/Edge\/(\d+)/.exec(No.userAgent),GU=/MSIE \d/.test(No.userAgent),dE=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(No.userAgent),fC=!!(GU||dE||hE),jF=!fC&&/gecko\/(\d+)/i.test(No.userAgent),aj=!fC&&/Chrome\/(\d+)/.exec(No.userAgent),O_e="webkitFontSmoothing"in uE.documentElement.style,fE=!fC&&/Apple Computer/.test(No.vendor),PF=fE&&(/Mobile\/\w+/.test(No.userAgent)||No.maxTouchPoints>2);var ur={mac:PF||/Mac/.test(No.platform),windows:/Win/.test(No.platform),linux:/Linux|X11/.test(No.platform),ie:fC,ie_version:GU?uE.documentMode||6:dE?+dE[1]:hE?+hE[1]:0,gecko:jF,gecko_version:jF?+(/Firefox\/(\d+)/.exec(No.userAgent)||[0,0])[1]:0,chrome:!!aj,chrome_version:aj?+aj[1]:0,ios:PF,android:/Android\b/.test(No.userAgent),webkit_version:O_e?+(/\bAppleWebKit\/(\d+)/.exec(No.userAgent)||[0,0])[1]:0,safari:fE,safari_version:fE?+(/\bVersion\/(\d+(\.\d+)?)/.exec(No.userAgent)||[0,0])[1]:0,tabSize:uE.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function VM(t,e){for(let r in t)r=="class"&&e.class?e.class+=" "+t.class:r=="style"&&e.style?e.style+=";"+t.style:e[r]=t[r];return e}const M2=Object.create(null);function WM(t,e,r){if(t==e)return!0;t||(t=M2),e||(e=M2);let n=Object.keys(t),i=Object.keys(e);if(n.length-0!=i.length-0)return!1;for(let s of n)if(s!=r&&(i.indexOf(s)==-1||t[s]!==e[s]))return!1;return!0}function j_e(t,e){for(let r=t.attributes.length-1;r>=0;r--){let n=t.attributes[r].name;e[n]==null&&t.removeAttribute(n)}for(let r in e){let n=e[r];r=="style"?t.style.cssText=n:t.getAttribute(r)!=n&&t.setAttribute(r,n)}}function AF(t,e,r){let n=!1;if(e)for(let i in e)r&&i in r||(n=!0,i=="style"?t.style.cssText="":t.removeAttribute(i));if(r)for(let i in r)e&&e[i]==r[i]||(n=!0,i=="style"?t.style.cssText=r[i]:t.setAttribute(i,r[i]));return n}function P_e(t){let e=Object.create(null);for(let r=0;r<t.attributes.length;r++){let n=t.attributes[r];e[n.name]=n.value}return e}class Tu{eq(e){return!1}updateDOM(e,r){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,r,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var oo=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(oo||(oo={}));class jr extends df{constructor(e,r,n,i){super(),this.startSide=e,this.endSide=r,this.widget=n,this.spec=i}get heightRelevant(){return!1}static mark(e){return new L1(e)}static widget(e){let r=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return r+=n&&!e.inlineOrder?r>0?3e8:-4e8:r>0?1e8:-1e8,new pm(e,r,r,n,e.widget||null,!1)}static replace(e){let r=!!e.block,n,i;if(e.isBlockGap)n=-5e8,i=4e8;else{let{start:s,end:a}=XU(e,r);n=(s?r?-3e8:-1:5e8)-1,i=(a?r?2e8:1:-6e8)+1}return new pm(e,n,i,r,e.widget||null,!0)}static line(e){return new F1(e)}static set(e,r=!1){return sn.of(e,r)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}jr.none=sn.empty;class L1 extends jr{constructor(e){let{start:r,end:n}=XU(e);super(r?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.attrs=e.class&&e.attributes?VM(e.attributes,{class:e.class}):e.class?{class:e.class}:e.attributes||M2}eq(e){return this==e||e instanceof L1&&this.tagName==e.tagName&&WM(this.attrs,e.attrs)}range(e,r=e){if(e>=r)throw new RangeError("Mark decorations may not be empty");return super.range(e,r)}}L1.prototype.point=!1;class F1 extends jr{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof F1&&this.spec.class==e.spec.class&&WM(this.spec.attributes,e.spec.attributes)}range(e,r=e){if(r!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,r)}}F1.prototype.mapMode=Uo.TrackBefore;F1.prototype.point=!0;class pm extends jr{constructor(e,r,n,i,s,a){super(r,n,s,e),this.block=i,this.isReplace=a,this.mapMode=i?r<=0?Uo.TrackBefore:Uo.TrackAfter:Uo.TrackDel}get type(){return this.startSide!=this.endSide?oo.WidgetRange:this.startSide<=0?oo.WidgetBefore:oo.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof pm&&A_e(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,r=e){if(this.isReplace&&(e>r||e==r&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&r!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,r)}}pm.prototype.point=!0;function XU(t,e=!1){let{inclusiveStart:r,inclusiveEnd:n}=t;return r==null&&(r=t.inclusive),n==null&&(n=t.inclusive),{start:r??e,end:n??e}}function A_e(t,e){return t==e||!!(t&&e&&t.compare(e))}function vy(t,e,r,n=0){let i=r.length-1;i>=0&&r[i]+n>=t?r[i]=Math.max(r[i],e):r.push(t,e)}class Fb extends df{constructor(e,r){super(),this.tagName=e,this.attributes=r}eq(e){return e==this||e instanceof Fb&&this.tagName==e.tagName&&WM(this.attributes,e.attributes)}static create(e){return new Fb(e.tagName,e.attributes||M2)}static set(e,r=!1){return sn.of(e,r)}}Fb.prototype.startSide=Fb.prototype.endSide=-1;function a0(t){let e;return t.nodeType==11?e=t.getSelection?t:t.ownerDocument:e=t,e.getSelection()}function pE(t,e){return e?t==e||t.contains(e.nodeType!=1?e.parentNode:e):!1}function qv(t,e){if(!e.anchorNode)return!1;try{return pE(t,e.anchorNode)}catch{return!1}}function Qv(t){return t.nodeType==3?$b(t,0,t.nodeValue.length).getClientRects():t.nodeType==1?t.getClientRects():[]}function Hv(t,e,r,n){return r?EF(t,e,r,n,-1)||EF(t,e,r,n,1):!1}function mf(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e}function I2(t){return t.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function EF(t,e,r,n,i){for(;;){if(t==r&&e==n)return!0;if(e==(i<0?0:Ch(t))){if(t.nodeName=="DIV")return!1;let s=t.parentNode;if(!s||s.nodeType!=1)return!1;e=mf(t)+(i<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(i<0?-1:0)],t.nodeType==1&&t.contentEditable=="false")return!1;e=i<0?Ch(t):0}else return!1}}function Ch(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Bb(t,e){let r=e?t.left:t.right;return{left:r,right:r,top:t.top,bottom:t.bottom}}function E_e(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function KU(t,e){let r=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(r>.995&&r<1.005||!isFinite(r)||Math.abs(e.width-t.offsetWidth)<1)&&(r=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:r,scaleY:n}}function z_e(t,e,r,n,i,s,a,o){let d=t.ownerDocument,m=d.defaultView||window;for(let y=t,v=!1;y&&!v;)if(y.nodeType==1){let w,O=y==d.body,P=1,E=1;if(O)w=E_e(m);else{if(/^(fixed|sticky)$/.test(getComputedStyle(y).position)&&(v=!0),y.scrollHeight<=y.clientHeight&&y.scrollWidth<=y.clientWidth){y=y.assignedSlot||y.parentNode;continue}let F=y.getBoundingClientRect();({scaleX:P,scaleY:E}=KU(y,F)),w={left:F.left,right:F.left+y.clientWidth*P,top:F.top,bottom:F.top+y.clientHeight*E}}let $=0,R=0;if(i=="nearest")e.top<w.top?(R=e.top-(w.top+a),r>0&&e.bottom>w.bottom+R&&(R=e.bottom-w.bottom+a)):e.bottom>w.bottom&&(R=e.bottom-w.bottom+a,r<0&&e.top-R<w.top&&(R=e.top-(w.top+a)));else{let F=e.bottom-e.top,D=w.bottom-w.top;R=(i=="center"&&F<=D?e.top+F/2-D/2:i=="start"||i=="center"&&r<0?e.top-a:e.bottom-D+a)-w.top}if(n=="nearest"?e.left<w.left?($=e.left-(w.left+s),r>0&&e.right>w.right+$&&($=e.right-w.right+s)):e.right>w.right&&($=e.right-w.right+s,r<0&&e.left<w.left+$&&($=e.left-(w.left+s))):$=(n=="center"?e.left+(e.right-e.left)/2-(w.right-w.left)/2:n=="start"==o?e.left-s:e.right-(w.right-w.left)+s)-w.left,$||R)if(O)m.scrollBy($,R);else{let F=0,D=0;if(R){let U=y.scrollTop;y.scrollTop+=R/E,D=(y.scrollTop-U)*E}if($){let U=y.scrollLeft;y.scrollLeft+=$/P,F=(y.scrollLeft-U)*P}e={left:e.left-F,top:e.top-D,right:e.right-F,bottom:e.bottom-D},F&&Math.abs(F-$)<1&&(n="nearest"),D&&Math.abs(D-R)<1&&(i="nearest")}if(O)break;(e.top<w.top||e.bottom>w.bottom||e.left<w.left||e.right>w.right)&&(e={left:Math.max(e.left,w.left),right:Math.min(e.right,w.right),top:Math.max(e.top,w.top),bottom:Math.min(e.bottom,w.bottom)}),y=y.assignedSlot||y.parentNode}else if(y.nodeType==11)y=y.host;else break}function M_e(t){let e=t.ownerDocument,r,n;for(let i=t.parentNode;i&&!(i==e.body||r&&n);)if(i.nodeType==1)!n&&i.scrollHeight>i.clientHeight&&(n=i),!r&&i.scrollWidth>i.clientWidth&&(r=i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;return{x:r,y:n}}class I_e{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:r,focusNode:n}=e;this.set(r,Math.min(e.anchorOffset,r?Ch(r):0),n,Math.min(e.focusOffset,n?Ch(n):0))}set(e,r,n,i){this.anchorNode=e,this.anchorOffset=r,this.focusNode=n,this.focusOffset=i}}let up=null;ur.safari&&ur.safari_version>=26&&(up=!1);function ZU(t){if(t.setActive)return t.setActive();if(up)return t.focus(up);let e=[];for(let r=t;r&&(e.push(r,r.scrollTop,r.scrollLeft),r!=r.ownerDocument);r=r.parentNode);if(t.focus(up==null?{get preventScroll(){return up={preventScroll:!0},!0}}:void 0),!up){up=!1;for(let r=0;r<e.length;){let n=e[r++],i=e[r++],s=e[r++];n.scrollTop!=i&&(n.scrollTop=i),n.scrollLeft!=s&&(n.scrollLeft=s)}}}let zF;function $b(t,e,r=e){let n=zF||(zF=document.createRange());return n.setEnd(t,r),n.setStart(t,e),n}function by(t,e,r,n){let i={key:e,code:e,keyCode:r,which:r,cancelable:!0};n&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=n);let s=new KeyboardEvent("keydown",i);s.synthetic=!0,t.dispatchEvent(s);let a=new KeyboardEvent("keyup",i);return a.synthetic=!0,t.dispatchEvent(a),s.defaultPrevented||a.defaultPrevented}function R_e(t){for(;t;){if(t&&(t.nodeType==9||t.nodeType==11&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function D_e(t,e){let r=e.focusNode,n=e.focusOffset;if(!r||e.anchorNode!=r||e.anchorOffset!=n)return!1;for(n=Math.min(n,Ch(r));;)if(n){if(r.nodeType!=1)return!1;let i=r.childNodes[n-1];i.contentEditable=="false"?n--:(r=i,n=Ch(r))}else{if(r==t)return!0;n=mf(r),r=r.parentNode}}function YU(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function JU(t,e){for(let r=t,n=e;;){if(r.nodeType==3&&n>0)return{node:r,offset:n};if(r.nodeType==1&&n>0){if(r.contentEditable=="false")return null;r=r.childNodes[n-1],n=Ch(r)}else if(r.parentNode&&!I2(r))n=mf(r),r=r.parentNode;else return null}}function eq(t,e){for(let r=t,n=e;;){if(r.nodeType==3&&n<r.nodeValue.length)return{node:r,offset:n};if(r.nodeType==1&&n<r.childNodes.length){if(r.contentEditable=="false")return null;r=r.childNodes[n],n=0}else if(r.parentNode&&!I2(r))n=mf(r)+1,r=r.parentNode;else return null}}class fc{constructor(e,r,n=!0){this.node=e,this.offset=r,this.precise=n}static before(e,r){return new fc(e.parentNode,mf(e),r)}static after(e,r){return new fc(e.parentNode,mf(e)+1,r)}}var ti=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(ti||(ti={}));const mm=ti.LTR,UM=ti.RTL;function tq(t){let e=[];for(let r=0;r<t.length;r++)e.push(1<<+t[r]);return e}const L_e=tq("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),F_e=tq("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),mE=Object.create(null),Uc=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),r=t.charCodeAt(1);mE[e]=r,mE[r]=-e}function rq(t){return t<=247?L_e[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?F_e[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const B_e=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class ch{get dir(){return this.level%2?UM:mm}constructor(e,r,n){this.from=e,this.to=r,this.level=n}side(e,r){return this.dir==r==e?this.to:this.from}forward(e,r){return e==(this.dir==r)}static find(e,r,n,i){let s=-1;for(let a=0;a<e.length;a++){let o=e[a];if(o.from<=r&&o.to>=r){if(o.level==n)return a;(s<0||(i!=0?i<0?o.from<r:o.to>r:e[s].level>o.level))&&(s=a)}}if(s<0)throw new RangeError("Index out of range");return s}}function nq(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++){let n=t[r],i=e[r];if(n.from!=i.from||n.to!=i.to||n.direction!=i.direction||!nq(n.inner,i.inner))return!1}return!0}const ei=[];function $_e(t,e,r,n,i){for(let s=0;s<=n.length;s++){let a=s?n[s-1].to:e,o=s<n.length?n[s].from:r,d=s?256:i;for(let m=a,y=d,v=d;m<o;m++){let w=rq(t.charCodeAt(m));w==512?w=y:w==8&&v==4&&(w=16),ei[m]=w==4?2:w,w&7&&(v=w),y=w}for(let m=a,y=d,v=d;m<o;m++){let w=ei[m];if(w==128)m<o-1&&y==ei[m+1]&&y&24?w=ei[m]=y:ei[m]=256;else if(w==64){let O=m+1;for(;O<o&&ei[O]==64;)O++;let P=m&&y==8||O<r&&ei[O]==8?v==1?1:8:256;for(let E=m;E<O;E++)ei[E]=P;m=O-1}else w==8&&v==1&&(ei[m]=1);y=w,w&7&&(v=w)}}}function N_e(t,e,r,n,i){let s=i==1?2:1;for(let a=0,o=0,d=0;a<=n.length;a++){let m=a?n[a-1].to:e,y=a<n.length?n[a].from:r;for(let v=m,w,O,P;v<y;v++)if(O=mE[w=t.charCodeAt(v)])if(O<0){for(let E=o-3;E>=0;E-=3)if(Uc[E+1]==-O){let $=Uc[E+2],R=$&2?i:$&4?$&1?s:i:0;R&&(ei[v]=ei[Uc[E]]=R),o=E;break}}else{if(Uc.length==189)break;Uc[o++]=v,Uc[o++]=w,Uc[o++]=d}else if((P=ei[v])==2||P==1){let E=P==i;d=E?0:1;for(let $=o-3;$>=0;$-=3){let R=Uc[$+2];if(R&2)break;if(E)Uc[$+2]|=2;else{if(R&4)break;Uc[$+2]|=4}}}}}function V_e(t,e,r,n){for(let i=0,s=n;i<=r.length;i++){let a=i?r[i-1].to:t,o=i<r.length?r[i].from:e;for(let d=a;d<o;){let m=ei[d];if(m==256){let y=d+1;for(;;)if(y==o){if(i==r.length)break;y=r[i++].to,o=i<r.length?r[i].from:e}else if(ei[y]==256)y++;else break;let v=s==1,w=(y<e?ei[y]:n)==1,O=v==w?v?1:2:n;for(let P=y,E=i,$=E?r[E-1].to:t;P>d;)P==$&&(P=r[--E].from,$=E?r[E-1].to:t),ei[--P]=O;d=y}else s=m,d++}}}function gE(t,e,r,n,i,s,a){let o=n%2?2:1;if(n%2==i%2)for(let d=e,m=0;d<r;){let y=!0,v=!1;if(m==s.length||d<s[m].from){let E=ei[d];E!=o&&(y=!1,v=E==16)}let w=!y&&o==1?[]:null,O=y?n:n+1,P=d;e:for(;;)if(m<s.length&&P==s[m].from){if(v)break e;let E=s[m];if(!y)for(let $=E.to,R=m+1;;){if($==r)break e;if(R<s.length&&s[R].from==$)$=s[R++].to;else{if(ei[$]==o)break e;break}}if(m++,w)w.push(E);else{E.from>d&&a.push(new ch(d,E.from,O));let $=E.direction==mm!=!(O%2);yE(t,$?n+1:n,i,E.inner,E.from,E.to,a),d=E.to}P=E.to}else{if(P==r||(y?ei[P]!=o:ei[P]==o))break;P++}w?gE(t,d,P,n+1,i,w,a):d<P&&a.push(new ch(d,P,O)),d=P}else for(let d=r,m=s.length;d>e;){let y=!0,v=!1;if(!m||d>s[m-1].to){let E=ei[d-1];E!=o&&(y=!1,v=E==16)}let w=!y&&o==1?[]:null,O=y?n:n+1,P=d;e:for(;;)if(m&&P==s[m-1].to){if(v)break e;let E=s[--m];if(!y)for(let $=E.from,R=m;;){if($==e)break e;if(R&&s[R-1].to==$)$=s[--R].from;else{if(ei[$-1]==o)break e;break}}if(w)w.push(E);else{E.to<d&&a.push(new ch(E.to,d,O));let $=E.direction==mm!=!(O%2);yE(t,$?n+1:n,i,E.inner,E.from,E.to,a),d=E.from}P=E.from}else{if(P==e||(y?ei[P-1]!=o:ei[P-1]==o))break;P--}w?gE(t,P,d,n+1,i,w,a):P<d&&a.push(new ch(P,d,O)),d=P}}function yE(t,e,r,n,i,s,a){let o=e%2?2:1;$_e(t,i,s,n,o),N_e(t,i,s,n,o),V_e(i,s,n,o),gE(t,i,s,e,r,n,a)}function W_e(t,e,r){if(!t)return[new ch(0,0,e==UM?1:0)];if(e==mm&&!r.length&&!B_e.test(t))return iq(t.length);if(r.length)for(;t.length>ei.length;)ei[ei.length]=256;let n=[],i=e==mm?0:1;return yE(t,i,i,r,0,t.length,n),n}function iq(t){return[new ch(0,t,0)]}let sq="";function U_e(t,e,r,n,i){var s;let a=n.head-t.from,o=ch.find(e,a,(s=n.bidiLevel)!==null&&s!==void 0?s:-1,n.assoc),d=e[o],m=d.side(i,r);if(a==m){let w=o+=i?1:-1;if(w<0||w>=e.length)return null;d=e[o=w],a=d.side(!i,r),m=d.side(i,r)}let y=bs(t.text,a,d.forward(i,r));(y<d.from||y>d.to)&&(y=m),sq=t.text.slice(Math.min(a,y),Math.max(a,y));let v=o==(i?e.length-1:0)?null:e[o+(i?1:-1)];return v&&y==m&&v.level+(i?0:1)<d.level?pt.cursor(v.side(!i,r)+t.from,v.forward(i,r)?1:-1,v.level):pt.cursor(y+t.from,d.forward(i,r)?-1:1,d.level)}function q_e(t,e,r){for(let n=e;n<r;n++){let i=rq(t.charCodeAt(n));if(i==1)return mm;if(i==2||i==4)return UM}return mm}const oq=hr.define(),aq=hr.define(),lq=hr.define(),cq=hr.define(),xE=hr.define(),uq=hr.define(),hq=hr.define(),qM=hr.define(),QM=hr.define(),dq=hr.define({combine:t=>t.some(e=>e)}),fq=hr.define({combine:t=>t.some(e=>e)}),pq=hr.define();class _y{constructor(e,r="nearest",n="nearest",i=5,s=5,a=!1){this.range=e,this.y=r,this.x=n,this.yMargin=i,this.xMargin=s,this.isSnapshot=a}map(e){return e.empty?this:new _y(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new _y(pt.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Tw=Qr.define({map:(t,e)=>t.map(e)}),mq=Qr.define();function wa(t,e,r){let n=t.facet(cq);n.length?n[0](e):window.onerror&&window.onerror(String(e),r,void 0,void 0,e)||(r?console.error(r+":",e):console.error(e))}const ih=hr.define({combine:t=>t.length?t[0]:!0});let Q_e=0;const Kg=hr.define({combine(t){return t.filter((e,r)=>{for(let n=0;n<r;n++)if(t[n].plugin==e.plugin)return!1;return!0})}});class Qi{constructor(e,r,n,i,s){this.id=e,this.create=r,this.domEventHandlers=n,this.domEventObservers=i,this.baseExtensions=s(this),this.extension=this.baseExtensions.concat(Kg.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(Kg.of({plugin:this,arg:e}))}static define(e,r){const{eventHandlers:n,eventObservers:i,provide:s,decorations:a}=r||{};return new Qi(Q_e++,e,n,i,o=>{let d=[];return a&&d.push(pC.of(m=>{let y=m.plugin(o);return y?a(y):jr.none})),s&&d.push(s(o)),d})}static fromClass(e,r){return Qi.define((n,i)=>new e(n,i),r)}}class lj{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let r=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(r)}catch(n){if(wa(r.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(r){wa(e.state,r,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var r;if(!((r=this.value)===null||r===void 0)&&r.destroy)try{this.value.destroy()}catch(n){wa(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const gq=hr.define(),HM=hr.define(),pC=hr.define(),yq=hr.define(),GM=hr.define(),B1=hr.define(),xq=hr.define();function MF(t,e){let r=t.state.facet(xq);if(!r.length)return r;let n=r.map(s=>s instanceof Function?s(t):s),i=[];return sn.spans(n,e.from,e.to,{point(){},span(s,a,o,d){let m=s-e.from,y=a-e.from,v=i;for(let w=o.length-1;w>=0;w--,d--){let O=o[w].spec.bidiIsolate,P;if(O==null&&(O=q_e(e.text,m,y)),d>0&&v.length&&(P=v[v.length-1]).to==m&&P.direction==O)P.to=y,v=P.inner;else{let E={from:m,to:y,direction:O,inner:[]};v.push(E),v=E.inner}}}}),i}const vq=hr.define();function XM(t){let e=0,r=0,n=0,i=0;for(let s of t.state.facet(vq)){let a=s(t);a&&(a.left!=null&&(e=Math.max(e,a.left)),a.right!=null&&(r=Math.max(r,a.right)),a.top!=null&&(n=Math.max(n,a.top)),a.bottom!=null&&(i=Math.max(i,a.bottom)))}return{left:e,right:r,top:n,bottom:i}}const mv=hr.define();class Il{constructor(e,r,n,i){this.fromA=e,this.toA=r,this.fromB=n,this.toB=i}join(e){return new Il(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let r=e.length,n=this;for(;r>0;r--){let i=e[r-1];if(!(i.fromA>n.toA)){if(i.toA<n.fromA)break;n=n.join(i),e.splice(r-1,1)}}return e.splice(r,0,n),e}static extendWithRanges(e,r){if(r.length==0)return e;let n=[];for(let i=0,s=0,a=0;;){let o=i<e.length?e[i].fromB:1e9,d=s<r.length?r[s]:1e9,m=Math.min(o,d);if(m==1e9)break;let y=m+a,v=m,w=y;for(;;)if(s<r.length&&r[s]<=v){let O=r[s+1];s+=2,v=Math.max(v,O);for(let P=i;P<e.length&&e[P].fromB<=v;P++)a=e[P].toA-e[P].toB;w=Math.max(w,O+a)}else if(i<e.length&&e[i].fromB<=v){let O=e[i++];v=Math.max(v,O.toB),w=Math.max(w,O.toA),a=O.toA-O.toB}else break;n.push(new Il(y,w,m,v))}return n}}class R2{constructor(e,r,n){this.view=e,this.state=r,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=ms.empty(this.startState.doc.length);for(let s of n)this.changes=this.changes.compose(s.changes);let i=[];this.changes.iterChangedRanges((s,a,o,d)=>i.push(new Il(s,a,o,d))),this.changedRanges=i}static create(e,r,n){return new R2(e,r,n)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}const H_e=[];class is{constructor(e,r,n=0){this.dom=e,this.length=r,this.flags=n,this.parent=null,e.cmTile=this}get breakAfter(){return this.flags&1}get children(){return H_e}isWidget(){return!1}get isHidden(){return!1}isComposite(){return!1}isLine(){return!1}isText(){return!1}isBlock(){return!1}get domAttrs(){return null}sync(e){if(this.flags|=2,this.flags&4){this.flags&=-5;let r=this.domAttrs;r&&j_e(this.dom,r)}}toString(){return this.constructor.name+(this.children.length?`(${this.children})`:"")+(this.breakAfter?"#":"")}destroy(){this.parent=null}setDOM(e){this.dom=e,e.cmTile=this}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e,r=this.posAtStart){let n=r;for(let i of this.children){if(i==e)return n;n+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}covers(e){return!0}coordsIn(e,r){return null}domPosFor(e,r){let n=mf(this.dom),i=this.length?e>0:r>0;return new fc(this.parent.dom,n+(i?1:0),e==0||e==this.length)}markDirty(e){this.flags&=-3,e&&(this.flags|=4),this.parent&&this.parent.flags&2&&this.parent.markDirty(!1)}get overrideDOMText(){return null}get root(){for(let e=this;e;e=e.parent)if(e instanceof gC)return e;return null}static get(e){return e.cmTile}}class mC extends is{constructor(e){super(e,0),this._children=[]}isComposite(){return!0}get children(){return this._children}get lastChild(){return this.children.length?this.children[this.children.length-1]:null}append(e){this.children.push(e),e.parent=this}sync(e){if(this.flags&2)return;super.sync(e);let r=this.dom,n=null,i,s=(e==null?void 0:e.node)==r?e:null,a=0;for(let o of this.children){if(o.sync(e),a+=o.length+o.breakAfter,i=n?n.nextSibling:r.firstChild,s&&i!=o.dom&&(s.written=!0),o.dom.parentNode==r)for(;i&&i!=o.dom;)i=IF(i);else r.insertBefore(o.dom,i);n=o.dom}for(i=n?n.nextSibling:r.firstChild,s&&i&&(s.written=!0);i;)i=IF(i);this.length=a}}function IF(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class gC extends mC{constructor(e,r){super(r),this.view=e}owns(e){for(;e;e=e.parent)if(e==this)return!0;return!1}isBlock(){return!0}nearest(e){for(;;){if(!e)return null;let r=is.get(e);if(r&&this.owns(r))return r;e=e.parentNode}}blockTiles(e){for(let r=[],n=this,i=0,s=0;;)if(i==n.children.length){if(!r.length)return;n=n.parent,n.breakAfter&&s++,i=r.pop()}else{let a=n.children[i++];if(a instanceof Kd)r.push(i),n=a,i=0;else{let o=s+a.length,d=e(a,s);if(d!==void 0)return d;s=o+a.breakAfter}}}resolveBlock(e,r){let n,i=-1,s,a=-1;if(this.blockTiles((o,d)=>{let m=d+o.length;if(e>=d&&e<=m){if(o.isWidget()&&r>=-1&&r<=1){if(o.flags&32)return!0;o.flags&16&&(n=void 0)}(d<e||e==m&&(r<-1?o.length:o.covers(1)))&&(!n||!o.isWidget()&&n.isWidget())&&(n=o,i=e-d),(m>e||e==d&&(r>1?o.length:o.covers(-1)))&&(!s||!o.isWidget()&&s.isWidget())&&(s=o,a=e-d)}}),!n&&!s)throw new Error("No tile at position "+e);return n&&r<0||!s?{tile:n,offset:i}:{tile:s,offset:a}}}class Kd extends mC{constructor(e,r){super(e),this.wrapper=r}isBlock(){return!0}covers(e){return this.children.length?e<0?this.children[0].covers(-1):this.lastChild.covers(1):!1}get domAttrs(){return this.wrapper.attributes}static of(e,r){let n=new Kd(r||document.createElement(e.tagName),e);return r||(n.flags|=4),n}}class l0 extends mC{constructor(e,r){super(e),this.attrs=r}isLine(){return!0}static start(e,r,n){let i=new l0(r||document.createElement("div"),e);return(!r||!n)&&(i.flags|=4),i}get domAttrs(){return this.attrs}resolveInline(e,r,n){let i=null,s=-1,a=null,o=-1;function d(y,v){for(let w=0,O=0;w<y.children.length&&O<=v;w++){let P=y.children[w],E=O+P.length;E>=v&&(P.isComposite()?d(P,v-O):(!a||a.isHidden&&(r>0||n&&X_e(a,P)))&&(E>v||P.flags&32)?(a=P,o=v-O):(O<v||P.flags&16&&!P.isHidden)&&(i=P,s=v-O)),O=E}}d(this,e);let m=(r<0?i:a)||i||a;return m?{tile:m,offset:m==i?s:o}:null}coordsIn(e,r){let n=this.resolveInline(e,r,!0);return n?n.tile.coordsIn(Math.max(0,n.offset),r):G_e(this)}domIn(e,r){let n=this.resolveInline(e,r);if(n){let{tile:i,offset:s}=n;if(this.dom.contains(i.dom))return i.isText()?new fc(i.dom,Math.min(i.dom.nodeValue.length,s)):i.domPosFor(s,i.flags&16?1:i.flags&32?-1:r);let a=n.tile.parent,o=!1;for(let d of a.children){if(o)return new fc(d.dom,0);d==n.tile&&(o=!0)}}return new fc(this.dom,0)}}function G_e(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let r=Qv(e);return r[r.length-1]||null}function X_e(t,e){let r=t.coordsIn(0,1),n=e.coordsIn(0,1);return r&&n&&n.top<r.bottom}class va extends mC{constructor(e,r){super(e),this.mark=r}get domAttrs(){return this.mark.attrs}static of(e,r){let n=new va(r||document.createElement(e.tagName),e);return r||(n.flags|=4),n}}class wp extends is{constructor(e,r){super(e,r.length),this.text=r}sync(e){this.flags&2||(super.sync(e),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text))}isText(){return!0}toString(){return JSON.stringify(this.text)}coordsIn(e,r){let n=this.dom.nodeValue.length;e>n&&(e=n);let i=e,s=e,a=0;e==0&&r<0||e==n&&r>=0?ur.chrome||ur.gecko||(e?(i--,a=1):s<n&&(s++,a=-1)):r<0?i--:s<n&&s++;let o=$b(this.dom,i,s).getClientRects();if(!o.length)return null;let d=o[(a?a<0:r>=0)?0:o.length-1];return ur.safari&&!a&&d.width==0&&(d=Array.prototype.find.call(o,m=>m.width)||d),a?Bb(d,a<0):d||null}static of(e,r){let n=new wp(r||document.createTextNode(e),e);return r||(n.flags|=2),n}}class gm extends is{constructor(e,r,n,i){super(e,r,i),this.widget=n}isWidget(){return!0}get isHidden(){return this.widget.isHidden}covers(e){return this.flags&48?!1:(this.flags&(e<0?64:128))>0}coordsIn(e,r){return this.coordsInWidget(e,r,!1)}coordsInWidget(e,r,n){let i=this.widget.coordsAt(this.dom,e,r);if(i)return i;if(n)return Bb(this.dom.getBoundingClientRect(),this.length?e==0:r<=0);{let s=this.dom.getClientRects(),a=null;if(!s.length)return null;let o=this.flags&16?!0:this.flags&32?!1:e>0;for(let d=o?s.length-1:0;a=s[d],!(e>0?d==0:d==s.length-1||a.top<a.bottom);d+=o?-1:1);return Bb(a,!o)}}get overrideDOMText(){if(!this.length)return Sn.empty;let{root:e}=this;if(!e)return Sn.empty;let r=this.posAtStart;return e.view.state.doc.slice(r,r+this.length)}destroy(){super.destroy(),this.widget.destroy(this.dom)}static of(e,r,n,i,s){return s||(s=e.toDOM(r),e.editable||(s.contentEditable="false")),new gm(s,n,e,i)}}class D2 extends is{constructor(e){let r=document.createElement("img");r.className="cm-widgetBuffer",r.setAttribute("aria-hidden","true"),super(r,0,e)}get isHidden(){return!0}get overrideDOMText(){return Sn.empty}coordsIn(e){return this.dom.getBoundingClientRect()}}class K_e{constructor(e){this.index=0,this.beforeBreak=!1,this.parents=[],this.tile=e}advance(e,r,n){let{tile:i,index:s,beforeBreak:a,parents:o}=this;for(;e||r>0;)if(i.isComposite())if(a){if(!e)break;n&&n.break(),e--,a=!1}else if(s==i.children.length){if(!e&&!o.length)break;n&&n.leave(i),a=!!i.breakAfter,{tile:i,index:s}=o.pop(),s++}else{let d=i.children[s],m=d.breakAfter;(r>0?d.length<=e:d.length<e)&&(!n||n.skip(d,0,d.length)!==!1||!d.isComposite)?(a=!!m,s++,e-=d.length):(o.push({tile:i,index:s}),i=d,s=0,n&&d.isComposite()&&n.enter(d))}else if(s==i.length)a=!!i.breakAfter,{tile:i,index:s}=o.pop(),s++;else if(e){let d=Math.min(e,i.length-s);n&&n.skip(i,s,s+d),e-=d,s+=d}else break;return this.tile=i,this.index=s,this.beforeBreak=a,this}get root(){return this.parents.length?this.parents[0].tile:this.tile}}class Z_e{constructor(e,r,n,i){this.from=e,this.to=r,this.wrapper=n,this.rank=i}}class Y_e{constructor(e,r,n){this.cache=e,this.root=r,this.blockWrappers=n,this.curLine=null,this.lastBlock=null,this.afterWidget=null,this.pos=0,this.wrappers=[],this.wrapperPos=0}addText(e,r,n,i){var s;this.flushBuffer();let a=this.ensureMarks(r,n),o=a.lastChild;if(o&&o.isText()&&!(o.flags&8)&&o.length+e.length<512){this.cache.reused.set(o,2);let d=a.children[a.children.length-1]=new wp(o.dom,o.text+e);d.parent=a}else a.append(i||wp.of(e,(s=this.cache.find(wp))===null||s===void 0?void 0:s.dom));this.pos+=e.length,this.afterWidget=null}addComposition(e,r){let n=this.curLine;n.dom!=r.line.dom&&(n.setDOM(this.cache.reused.has(r.line)?cj(r.line.dom):r.line.dom),this.cache.reused.set(r.line,2));let i=n;for(let o=r.marks.length-1;o>=0;o--){let d=r.marks[o],m=i.lastChild;if(m instanceof va&&m.mark.eq(d.mark))m.dom!=d.dom&&m.setDOM(cj(d.dom)),i=m;else{if(this.cache.reused.get(d)){let v=is.get(d.dom);v&&v.setDOM(cj(d.dom))}let y=va.of(d.mark,d.dom);i.append(y),i=y}this.cache.reused.set(d,2)}let s=is.get(e.text);s&&this.cache.reused.set(s,2);let a=new wp(e.text,e.text.nodeValue);a.flags|=8,i.append(a)}addInlineWidget(e,r,n){let i=this.afterWidget&&e.flags&48&&(this.afterWidget.flags&48)==(e.flags&48);i||this.flushBuffer();let s=this.ensureMarks(r,n);!i&&!(e.flags&16)&&s.append(this.getBuffer(1)),s.append(e),this.pos+=e.length,this.afterWidget=e}addMark(e,r,n){this.flushBuffer(),this.ensureMarks(r,n).append(e),this.pos+=e.length,this.afterWidget=null}addBlockWidget(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}continueWidget(e){let r=this.afterWidget||this.lastBlock;r.length+=e,this.pos+=e}addLineStart(e,r){var n;e||(e=bq);let i=l0.start(e,r||((n=this.cache.find(l0))===null||n===void 0?void 0:n.dom),!!r);this.getBlockPos().append(this.lastBlock=this.curLine=i)}addLine(e){this.getBlockPos().append(e),this.pos+=e.length,this.lastBlock=e,this.endLine()}addBreak(){this.lastBlock.flags|=1,this.endLine(),this.pos++}addLineStartIfNotCovered(e){this.blockPosCovered()||this.addLineStart(e)}ensureLine(e){this.curLine||this.addLineStart(e)}ensureMarks(e,r){var n;let i=this.curLine;for(let s=e.length-1;s>=0;s--){let a=e[s],o;if(r>0&&(o=i.lastChild)&&o instanceof va&&o.mark.eq(a))i=o,r--;else{let d=va.of(a,(n=this.cache.find(va,m=>m.mark.eq(a)))===null||n===void 0?void 0:n.dom);i.append(d),i=d,r=0}}return i}endLine(){if(this.curLine){this.flushBuffer();let e=this.curLine.lastChild;(!e||!RF(this.curLine,!1)||e.dom.nodeName!="BR"&&e.isWidget()&&!(ur.ios&&RF(this.curLine,!0)))&&this.curLine.append(this.cache.findWidget(uj,0,32)||new gm(uj.toDOM(),0,uj,32)),this.curLine=this.afterWidget=null}}updateBlockWrappers(){this.wrapperPos>this.pos+1e4&&(this.blockWrappers.goto(this.pos),this.wrappers.length=0);for(let e=this.wrappers.length-1;e>=0;e--)this.wrappers[e].to<this.pos&&this.wrappers.splice(e,1);for(let e=this.blockWrappers;e.value&&e.from<=this.pos;e.next())if(e.to>=this.pos){let r=new Z_e(e.from,e.to,e.value,e.rank),n=this.wrappers.length;for(;n>0&&(this.wrappers[n-1].rank-r.rank||this.wrappers[n-1].to-r.to)<0;)n--;this.wrappers.splice(n,0,r)}this.wrapperPos=this.pos}getBlockPos(){var e;this.updateBlockWrappers();let r=this.root;for(let n of this.wrappers){let i=r.lastChild;if(n.from<this.pos&&i instanceof Kd&&i.wrapper.eq(n.wrapper))r=i;else{let s=Kd.of(n.wrapper,(e=this.cache.find(Kd,a=>a.wrapper.eq(n.wrapper)))===null||e===void 0?void 0:e.dom);r.append(s),r=s}}return r}blockPosCovered(){let e=this.lastBlock;return e!=null&&!e.breakAfter&&(!e.isWidget()||(e.flags&160)>0)}getBuffer(e){let r=2|(e<0?16:32),n=this.cache.find(D2,void 0,1);return n&&(n.flags=r),n||new D2(r)}flushBuffer(){this.afterWidget&&!(this.afterWidget.flags&32)&&(this.afterWidget.parent.append(this.getBuffer(-1)),this.afterWidget=null)}}class J_e{constructor(e){this.skipCount=0,this.text="",this.textOff=0,this.cursor=e.iter()}skip(e){this.textOff+e<=this.text.length?this.textOff+=e:(this.skipCount+=e-(this.text.length-this.textOff),this.text="",this.textOff=0)}next(e){if(this.textOff==this.text.length){let{value:i,lineBreak:s,done:a}=this.cursor.next(this.skipCount);if(this.skipCount=0,a)throw new Error("Ran out of text content when drawing inline views");this.text=i;let o=this.textOff=Math.min(e,i.length);return s?null:i.slice(0,o)}let r=Math.min(this.text.length,this.textOff+e),n=this.text.slice(this.textOff,r);return this.textOff=r,n}}const L2=[gm,l0,wp,va,D2,Kd,gC];for(let t=0;t<L2.length;t++)L2[t].bucket=t;class ewe{constructor(e){this.view=e,this.buckets=L2.map(()=>[]),this.index=L2.map(()=>0),this.reused=new Map}add(e){let r=e.constructor.bucket,n=this.buckets[r];n.length<6?n.push(e):n[this.index[r]=(this.index[r]+1)%6]=e}find(e,r,n=2){let i=e.bucket,s=this.buckets[i],a=this.index[i];for(let o=s.length-1;o>=0;o--){let d=(o+a)%s.length,m=s[d];if((!r||r(m))&&!this.reused.has(m))return s.splice(d,1),d<a&&this.index[i]--,this.reused.set(m,n),m}return null}findWidget(e,r,n){let i=this.buckets[0];if(i.length)for(let s=0,a=0;;s++){if(s==i.length){if(a)return null;a=1,s=0}let o=i[s];if(!this.reused.has(o)&&(a==0?o.widget.compare(e):o.widget.constructor==e.constructor&&e.updateDOM(o.dom,this.view)))return i.splice(s,1),s<this.index[0]&&this.index[0]--,o.widget==e&&o.length==r&&(o.flags&497)==n?(this.reused.set(o,1),o):(this.reused.set(o,2),new gm(o.dom,r,e,o.flags&-498|n))}}reuse(e){return this.reused.set(e,1),e}maybeReuse(e,r=2){if(!this.reused.has(e))return this.reused.set(e,r),e.dom}clear(){for(let e=0;e<this.buckets.length;e++)this.buckets[e].length=this.index[e]=0}}class twe{constructor(e,r,n,i,s){this.view=e,this.decorations=i,this.disallowBlockEffectsFor=s,this.openWidget=!1,this.openMarks=0,this.cache=new ewe(e),this.text=new J_e(e.state.doc),this.builder=new Y_e(this.cache,new gC(e,e.contentDOM),sn.iter(n)),this.cache.reused.set(r,2),this.old=new K_e(r),this.reuseWalker={skip:(a,o,d)=>{if(this.cache.add(a),a.isComposite())return!1},enter:a=>this.cache.add(a),leave:()=>{},break:()=>{}}}run(e,r){let n=r&&this.getCompositionContext(r.text);for(let i=0,s=0,a=0;;){let o=a<e.length?e[a++]:null,d=o?o.fromA:this.old.root.length;if(d>i){let m=d-i;this.preserve(m,!a,!o),i=d,s+=m}if(!o)break;r&&o.fromA<=r.range.fromA&&o.toA>=r.range.toA?(this.forward(o.fromA,r.range.fromA,r.range.fromA<r.range.toA?1:-1),this.emit(s,r.range.fromB),this.cache.clear(),this.builder.addComposition(r,n),this.text.skip(r.range.toB-r.range.fromB),this.forward(r.range.fromA,o.toA),this.emit(r.range.toB,o.toB)):(this.forward(o.fromA,o.toA),this.emit(s,o.toB)),s=o.toB,i=o.toA}return this.builder.curLine&&this.builder.endLine(),this.builder.root}preserve(e,r,n){let i=iwe(this.old),s=this.openMarks;this.old.advance(e,n?1:-1,{skip:(a,o,d)=>{if(a.isWidget())if(this.openWidget)this.builder.continueWidget(d-o);else{let m=d>0||o<a.length?gm.of(a.widget,this.view,d-o,a.flags&496,this.cache.maybeReuse(a)):this.cache.reuse(a);m.flags&256?(m.flags&=-2,this.builder.addBlockWidget(m)):(this.builder.ensureLine(null),this.builder.addInlineWidget(m,i,s),s=i.length)}else if(a.isText())this.builder.ensureLine(null),!o&&d==a.length?this.builder.addText(a.text,i,s,this.cache.reuse(a)):(this.cache.add(a),this.builder.addText(a.text.slice(o,d),i,s)),s=i.length;else if(a.isLine())a.flags&=-2,this.cache.reused.set(a,1),this.builder.addLine(a);else if(a instanceof D2)this.cache.add(a);else if(a instanceof va)this.builder.ensureLine(null),this.builder.addMark(a,i,s),this.cache.reused.set(a,1),s=i.length;else return!1;this.openWidget=!1},enter:a=>{a.isLine()?this.builder.addLineStart(a.attrs,this.cache.maybeReuse(a)):(this.cache.add(a),a instanceof va&&i.unshift(a.mark)),this.openWidget=!1},leave:a=>{a.isLine()?i.length&&(i.length=s=0):a instanceof va&&(i.shift(),s=Math.min(s,i.length))},break:()=>{this.builder.addBreak(),this.openWidget=!1}}),this.text.skip(e)}emit(e,r){let n=null,i=this.builder,s=0,a=sn.spans(this.decorations,e,r,{point:(o,d,m,y,v,w)=>{if(m instanceof pm){if(this.disallowBlockEffectsFor[w]){if(m.block)throw new RangeError("Block decorations may not be specified via plugins");if(d>this.view.state.doc.lineAt(o).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}if(s=y.length,v>y.length)i.continueWidget(d-o);else{let O=m.widget||(m.block?c0.block:c0.inline),P=rwe(m),E=this.cache.findWidget(O,d-o,P)||gm.of(O,this.view,d-o,P);m.block?(m.startSide>0&&i.addLineStartIfNotCovered(n),i.addBlockWidget(E)):(i.ensureLine(n),i.addInlineWidget(E,y,v))}n=null}else n=nwe(n,m);d>o&&this.text.skip(d-o)},span:(o,d,m,y)=>{for(let v=o;v<d;){let w=this.text.next(Math.min(512,d-v));w==null?(i.addLineStartIfNotCovered(n),i.addBreak(),v++):(i.ensureLine(n),i.addText(w,m,v==o?y:m.length),v+=w.length),n=null}}});i.addLineStartIfNotCovered(n),this.openWidget=a>s,this.openMarks=a}forward(e,r,n=1){r-e<=10?this.old.advance(r-e,n,this.reuseWalker):(this.old.advance(5,-1,this.reuseWalker),this.old.advance(r-e-10,-1),this.old.advance(5,n,this.reuseWalker))}getCompositionContext(e){let r=[],n=null;for(let i=e.parentNode;;i=i.parentNode){let s=is.get(i);if(i==this.view.contentDOM)break;s instanceof va?r.push(s):s!=null&&s.isLine()?n=s:i.nodeName=="DIV"&&!n&&i!=this.view.contentDOM?n=new l0(i,bq):r.push(va.of(new L1({tagName:i.nodeName.toLowerCase(),attributes:P_e(i)}),i))}return{line:n,marks:r}}}function RF(t,e){let r=n=>{for(let i of n.children)if((e?i.isText():i.length)||r(i))return!0;return!1};return r(t)}function rwe(t){let e=t.isReplace?(t.startSide<0?64:0)|(t.endSide>0?128:0):t.startSide>0?32:16;return t.block&&(e|=256),e}const bq={class:"cm-line"};function nwe(t,e){let r=e.spec.attributes,n=e.spec.class;return!r&&!n||(t||(t={class:"cm-line"}),r&&VM(r,t),n&&(t.class+=" "+n)),t}function iwe(t){let e=[];for(let r=t.parents.length;r>1;r--){let n=r==t.parents.length?t.tile:t.parents[r].tile;n instanceof va&&e.push(n.mark)}return e}function cj(t){let e=is.get(t);return e&&e.setDOM(t.cloneNode()),t}class c0 extends Tu{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}c0.inline=new c0("span");c0.block=new c0("div");const uj=new class extends Tu{toDOM(){return document.createElement("br")}get isHidden(){return!0}get editable(){return!0}};class DF{constructor(e){this.view=e,this.decorations=[],this.blockWrappers=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.editContextFormatting=jr.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.updateDeco(),this.tile=new gC(e,e.contentDOM),this.updateInner([new Il(0,0,0,e.state.doc.length)],null)}update(e){var r;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:y,toA:v})=>v<this.minWidthFrom||y>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let i=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((r=this.domChanged)===null||r===void 0)&&r.newSel?i=this.domChanged.newSel.head:!fwe(e.changes,this.hasComposition)&&!e.selectionSet&&(i=e.state.selection.main.head));let s=i>-1?owe(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){let{from:y,to:v}=this.hasComposition;n=new Il(y,v,e.changes.mapPos(y,-1),e.changes.mapPos(v,1)).addToSet(n.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(ur.ie||ur.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let a=this.decorations,o=this.blockWrappers;this.updateDeco();let d=cwe(a,this.decorations,e.changes);d.length&&(n=Il.extendWithRanges(n,d));let m=hwe(o,this.blockWrappers,e.changes);return m.length&&(n=Il.extendWithRanges(n,m)),s&&!n.some(y=>y.fromA<=s.range.fromA&&y.toA>=s.range.toA)&&(n=s.range.addToSet(n.slice())),this.tile.flags&2&&n.length==0?!1:(this.updateInner(n,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,r){this.view.viewState.mustMeasureContent=!0;let{observer:n}=this.view;n.ignore(()=>{if(r||e.length){let a=this.tile,o=new twe(this.view,a,this.blockWrappers,this.decorations,this.dynamicDecorationMap);this.tile=o.run(e,r),vE(a,o.cache.reused)}this.tile.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.tile.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let s=ur.chrome||ur.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.tile.sync(s),s&&(s.written||n.selectionRange.focusNode!=s.node||!this.tile.dom.contains(s.node))&&(this.forceSelection=!0),this.tile.dom.style.height=""});let i=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.tile.children)s.isWidget()&&s.widget instanceof hj&&i.push(s.dom);n.updateGaps(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let r of e.transactions)for(let n of r.effects)n.is(mq)&&(this.editContextFormatting=n.value)}updateSelection(e=!1,r=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let{dom:n}=this.tile,i=this.view.root.activeElement,s=i==n,a=!s&&!(this.view.state.facet(ih)||n.tabIndex>-1)&&qv(n,this.view.observer.selectionRange)&&!(i&&n.contains(i));if(!(s||r||a))return;let o=this.forceSelection;this.forceSelection=!1;let d=this.view.state.selection.main,m,y;if(d.empty?y=m=this.inlineDOMNearPos(d.anchor,d.assoc||1):(y=this.inlineDOMNearPos(d.head,d.head==d.from?1:-1),m=this.inlineDOMNearPos(d.anchor,d.anchor==d.from?1:-1)),ur.gecko&&d.empty&&!this.hasComposition&&swe(m)){let w=document.createTextNode("");this.view.observer.ignore(()=>m.node.insertBefore(w,m.node.childNodes[m.offset]||null)),m=y=new fc(w,0),o=!0}let v=this.view.observer.selectionRange;(o||!v.focusNode||(!Hv(m.node,m.offset,v.anchorNode,v.anchorOffset)||!Hv(y.node,y.offset,v.focusNode,v.focusOffset))&&!this.suppressWidgetCursorChange(v,d))&&(this.view.observer.ignore(()=>{ur.android&&ur.chrome&&n.contains(v.focusNode)&&dwe(v.focusNode,n)&&(n.blur(),n.focus({preventScroll:!0}));let w=a0(this.view.root);if(w)if(d.empty){if(ur.gecko){let O=awe(m.node,m.offset);if(O&&O!=3){let P=(O==1?JU:eq)(m.node,m.offset);P&&(m=new fc(P.node,P.offset))}}w.collapse(m.node,m.offset),d.bidiLevel!=null&&w.caretBidiLevel!==void 0&&(w.caretBidiLevel=d.bidiLevel)}else if(w.extend){w.collapse(m.node,m.offset);try{w.extend(y.node,y.offset)}catch{}}else{let O=document.createRange();d.anchor>d.head&&([m,y]=[y,m]),O.setEnd(y.node,y.offset),O.setStart(m.node,m.offset),w.removeAllRanges(),w.addRange(O)}a&&this.view.root.activeElement==n&&(n.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(m,y)),this.impreciseAnchor=m.precise?null:new fc(v.anchorNode,v.anchorOffset),this.impreciseHead=y.precise?null:new fc(v.focusNode,v.focusOffset)}suppressWidgetCursorChange(e,r){return this.hasComposition&&r.empty&&Hv(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==r.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,r=e.state.selection.main,n=a0(e.root),{anchorNode:i,anchorOffset:s}=e.observer.selectionRange;if(!n||!r.empty||!r.assoc||!n.modify)return;let a=this.lineAt(r.head,r.assoc);if(!a)return;let o=a.posAtStart;if(r.head==o||r.head==o+a.length)return;let d=this.coordsAt(r.head,-1),m=this.coordsAt(r.head,1);if(!d||!m||d.bottom>m.top)return;let y=this.domAtPos(r.head+r.assoc,r.assoc);n.collapse(y.node,y.offset),n.modify("move",r.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let v=e.observer.selectionRange;e.docView.posFromDOM(v.anchorNode,v.anchorOffset)!=r.from&&n.collapse(i,s)}posFromDOM(e,r){let n=this.tile.nearest(e);if(!n)return this.tile.dom.compareDocumentPosition(e)&2?0:this.view.state.doc.length;let i=n.posAtStart;if(n.isComposite()){let s;if(e==n.dom)s=n.dom.childNodes[r];else{let a=Ch(e)==0?0:r==0?-1:1;for(;;){let o=e.parentNode;if(o==n.dom)break;a==0&&o.firstChild!=o.lastChild&&(e==o.firstChild?a=-1:a=1),e=o}a<0?s=e:s=e.nextSibling}if(s==n.dom.firstChild)return i;for(;s&&!is.get(s);)s=s.nextSibling;if(!s)return i+n.length;for(let a=0,o=i;;a++){let d=n.children[a];if(d.dom==s)return o;o+=d.length+d.breakAfter}}else return n.isText()?e==n.dom?i+r:i+(r?n.length:0):i}domAtPos(e,r){let{tile:n,offset:i}=this.tile.resolveBlock(e,r);return n.isWidget()?n.domPosFor(e,r):n.domIn(i,r)}inlineDOMNearPos(e,r){let n,i=-1,s=!1,a,o=-1,d=!1;return this.tile.blockTiles((m,y)=>{if(m.isWidget()){if(m.flags&32&&y>=e)return!0;m.flags&16&&(s=!0)}else{let v=y+m.length;if(y<=e&&(n=m,i=e-y,s=v<e),v>=e&&!a&&(a=m,o=e-y,d=y>e),y>e&&a)return!0}}),!n&&!a?this.domAtPos(e,r):(s&&a?n=null:d&&n&&(a=null),n&&r<0||!a?n.domIn(i,r):a.domIn(o,r))}coordsAt(e,r){let{tile:n,offset:i}=this.tile.resolveBlock(e,r);return n.isWidget()?n.widget instanceof hj?null:n.coordsInWidget(i,r,!0):n.coordsIn(i,r)}lineAt(e,r){let{tile:n}=this.tile.resolveBlock(e,r);return n.isLine()?n:null}coordsForChar(e){let{tile:r,offset:n}=this.tile.resolveBlock(e,1);if(!r.isLine())return null;function i(s,a){if(s.isComposite())for(let o of s.children){if(o.length>=a){let d=i(o,a);if(d)return d}if(a-=o.length,a<0)break}else if(s.isText()&&a<s.length){let o=bs(s.text,a);if(o==a)return null;let d=$b(s.dom,a,o).getClientRects();for(let m=0;m<d.length;m++){let y=d[m];if(m==d.length-1||y.top<y.bottom&&y.left<y.right)return y}}return null}return i(r,n)}measureVisibleLineHeights(e){let r=[],{from:n,to:i}=e,s=this.view.contentDOM.clientWidth,a=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,d=this.view.textDirection==ti.LTR,m=0,y=(v,w,O)=>{for(let P=0;P<v.children.length&&!(w>i);P++){let E=v.children[P],$=w+E.length,R=E.dom.getBoundingClientRect(),{height:F}=R;if(O&&!P&&(m+=R.top-O.top),E instanceof Kd)$>n&&y(E,w,R);else if(w>=n&&(m>0&&r.push(-m),r.push(F+m),m=0,a)){let D=E.dom.lastChild,U=D?Qv(D):[];if(U.length){let X=U[U.length-1],ee=d?X.right-R.left:R.right-X.left;ee>o&&(o=ee,this.minWidth=s,this.minWidthFrom=w,this.minWidthTo=$)}}O&&P==v.children.length-1&&(m+=O.bottom-R.bottom),w=$+E.breakAfter}};return y(this.tile,0,null),r}textDirectionAt(e){let{tile:r}=this.tile.resolveBlock(e,1);return getComputedStyle(r.dom).direction=="rtl"?ti.RTL:ti.LTR}measureTextSize(){let e=this.tile.blockTiles(a=>{if(a.isLine()&&a.children.length&&a.length<=20){let o=0,d;for(let m of a.children){if(!m.isText()||/[^ -~]/.test(m.text))return;let y=Qv(m.dom);if(y.length!=1)return;o+=y[0].width,d=y[0].height}if(o)return{lineHeight:a.dom.getBoundingClientRect().height,charWidth:o/a.length,textHeight:d}}});if(e)return e;let r=document.createElement("div"),n,i,s;return r.className="cm-line",r.style.width="99999px",r.style.position="absolute",r.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.tile.dom.appendChild(r);let a=Qv(r.firstChild)[0];n=r.getBoundingClientRect().height,i=a&&a.width?a.width/27:7,s=a&&a.height?a.height:n,r.remove()}),{lineHeight:n,charWidth:i,textHeight:s}}computeBlockGapDeco(){let e=[],r=this.view.viewState;for(let n=0,i=0;;i++){let s=i==r.viewports.length?null:r.viewports[i],a=s?s.from-1:this.view.state.doc.length;if(a>n){let o=(r.lineBlockAt(a).bottom-r.lineBlockAt(n).top)/this.view.scaleY;e.push(jr.replace({widget:new hj(o),block:!0,inclusive:!0,isBlockGap:!0}).range(n,a))}if(!s)break;n=s.to+1}return jr.set(e)}updateDeco(){let e=1,r=this.view.state.facet(pC).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),n=!1,i=this.view.state.facet(GM).map((s,a)=>{let o=typeof s=="function";return o&&(n=!0),o?s(this.view):s});for(i.length&&(this.dynamicDecorationMap[e++]=n,r.push(sn.join(i))),this.decorations=[this.editContextFormatting,...r,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;this.blockWrappers=this.view.state.facet(yq).map(s=>typeof s=="function"?s(this.view):s)}scrollIntoView(e){if(e.isSnapshot){let m=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=m.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let m of this.view.state.facet(pq))try{if(m(this.view,e.range,e))return!0}catch(y){wa(this.view.state,y,"scroll handler")}let{range:r}=e,n=this.coordsAt(r.head,r.empty?r.assoc:r.head>r.anchor?-1:1),i;if(!n)return;!r.empty&&(i=this.coordsAt(r.anchor,r.anchor>r.head?-1:1))&&(n={left:Math.min(n.left,i.left),top:Math.min(n.top,i.top),right:Math.max(n.right,i.right),bottom:Math.max(n.bottom,i.bottom)});let s=XM(this.view),a={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:o,offsetHeight:d}=this.view.scrollDOM;z_e(this.view.scrollDOM,a,r.head<r.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,d),-d),this.view.textDirection==ti.LTR)}lineHasWidget(e){let r=n=>n.isWidget()||n.children.some(r);return r(this.tile.resolveBlock(e,1).tile)}destroy(){vE(this.tile)}}function vE(t,e){let r=e==null?void 0:e.get(t);if(r!=1){r==null&&t.destroy();for(let n of t.children)vE(n,e)}}function swe(t){return t.node.nodeType==1&&t.node.firstChild&&(t.offset==0||t.node.childNodes[t.offset-1].contentEditable=="false")&&(t.offset==t.node.childNodes.length||t.node.childNodes[t.offset].contentEditable=="false")}function _q(t,e){let r=t.observer.selectionRange;if(!r.focusNode)return null;let n=JU(r.focusNode,r.focusOffset),i=eq(r.focusNode,r.focusOffset),s=n||i;if(i&&n&&i.node!=n.node){let o=is.get(i.node);if(!o||o.isText()&&o.text!=i.node.nodeValue)s=i;else if(t.docView.lastCompositionAfterCursor){let d=is.get(n.node);!d||d.isText()&&d.text!=n.node.nodeValue||(s=i)}}if(t.docView.lastCompositionAfterCursor=s!=n,!s)return null;let a=e-s.offset;return{from:a,to:a+s.node.nodeValue.length,node:s.node}}function owe(t,e,r){let n=_q(t,r);if(!n)return null;let{node:i,from:s,to:a}=n,o=i.nodeValue;if(/[\n\r]/.test(o)||t.state.doc.sliceString(n.from,n.to)!=o)return null;let d=e.invertedDesc;return{range:new Il(d.mapPos(s),d.mapPos(a),s,a),text:i}}function awe(t,e){return t.nodeType!=1?0:(e&&t.childNodes[e-1].contentEditable=="false"?1:0)|(e<t.childNodes.length&&t.childNodes[e].contentEditable=="false"?2:0)}let lwe=class{constructor(){this.changes=[]}compareRange(e,r){vy(e,r,this.changes)}comparePoint(e,r){vy(e,r,this.changes)}boundChange(e){vy(e,e,this.changes)}};function cwe(t,e,r){let n=new lwe;return sn.compare(t,e,r,n),n.changes}class uwe{constructor(){this.changes=[]}compareRange(e,r){vy(e,r,this.changes)}comparePoint(){}boundChange(e){vy(e,e,this.changes)}}function hwe(t,e,r){let n=new uwe;return sn.compare(t,e,r,n),n.changes}function dwe(t,e){for(let r=t;r&&r!=e;r=r.assignedSlot||r.parentNode)if(r.nodeType==1&&r.contentEditable=="false")return!0;return!1}function fwe(t,e){let r=!1;return e&&t.iterChangedRanges((n,i)=>{n<e.to&&i>e.from&&(r=!0)}),r}class hj extends Tu{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}function pwe(t,e,r=1){let n=t.charCategorizer(e),i=t.doc.lineAt(e),s=e-i.from;if(i.length==0)return pt.cursor(e);s==0?r=1:s==i.length&&(r=-1);let a=s,o=s;r<0?a=bs(i.text,s,!1):o=bs(i.text,s);let d=n(i.text.slice(a,o));for(;a>0;){let m=bs(i.text,a,!1);if(n(i.text.slice(m,a))!=d)break;a=m}for(;o<i.length;){let m=bs(i.text,o);if(n(i.text.slice(o,m))!=d)break;o=m}return pt.range(a+i.from,o+i.from)}function mwe(t,e,r,n,i){let s=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&r.height>t.defaultLineHeight*1.5){let o=t.viewState.heightOracle.textHeight,d=Math.floor((i-r.top-(t.defaultLineHeight-o)*.5)/o);s+=d*t.viewState.heightOracle.lineLength}let a=t.state.sliceDoc(r.from,r.to);return r.from+aE(a,s,t.state.tabSize)}function bE(t,e,r){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){let i;for(let s of n.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!i||s.type==oo.Text&&(i.type!=s.type||(r<0?s.from<e:s.to>e)))&&(i=s)}}return i||n}return n}function gwe(t,e,r,n){let i=bE(t,e.head,e.assoc||-1),s=!n||i.type!=oo.Text||!(t.lineWrapping||i.widgetLineBreaks)?null:t.coordsAtPos(e.assoc<0&&e.head>i.from?e.head-1:e.head);if(s){let a=t.dom.getBoundingClientRect(),o=t.textDirectionAt(i.from),d=t.posAtCoords({x:r==(o==ti.LTR)?a.right-1:a.left+1,y:(s.top+s.bottom)/2});if(d!=null)return pt.cursor(d,r?-1:1)}return pt.cursor(r?i.to:i.from,r?-1:1)}function LF(t,e,r,n){let i=t.state.doc.lineAt(e.head),s=t.bidiSpans(i),a=t.textDirectionAt(i.from);for(let o=e,d=null;;){let m=U_e(i,s,a,o,r),y=sq;if(!m){if(i.number==(r?t.state.doc.lines:1))return o;y=`
`,i=t.state.doc.line(i.number+(r?1:-1)),s=t.bidiSpans(i),m=t.visualLineSide(i,!r)}if(d){if(!d(y))return o}else{if(!n)return m;d=n(y)}o=m}}function ywe(t,e,r){let n=t.state.charCategorizer(e),i=n(r);return s=>{let a=n(s);return i==vi.Space&&(i=a),i==a}}function xwe(t,e,r,n){let i=e.head,s=r?1:-1;if(i==(r?t.state.doc.length:0))return pt.cursor(i,e.assoc);let a=e.goalColumn,o,d=t.contentDOM.getBoundingClientRect(),m=t.coordsAtPos(i,(e.empty?e.assoc:0)||(r?1:-1)),y=t.documentTop;if(m)a==null&&(a=m.left-d.left),o=s<0?m.top:m.bottom;else{let P=t.viewState.lineBlockAt(i);a==null&&(a=Math.min(d.right-d.left,t.defaultCharacterWidth*(i-P.from))),o=(s<0?P.top:P.bottom)+y}let v=d.left+a,w=n??t.viewState.heightOracle.textHeight>>1,O=_E(t,{x:v,y:o+w*s},!1,s);return pt.cursor(O.pos,O.assoc,void 0,a)}function Gv(t,e,r){for(;;){let n=0;for(let i of t)i.between(e-1,e+1,(s,a,o)=>{if(e>s&&e<a){let d=n||r||(e-s<a-e?-1:1);e=d<0?s:a,n=d}});if(!n)return e}}function wq(t,e){let r=null;for(let n=0;n<e.ranges.length;n++){let i=e.ranges[n],s=null;if(i.empty){let a=Gv(t,i.from,0);a!=i.from&&(s=pt.cursor(a,-1))}else{let a=Gv(t,i.from,-1),o=Gv(t,i.to,1);(a!=i.from||o!=i.to)&&(s=pt.range(i.from==i.anchor?a:o,i.from==i.head?a:o))}s&&(r||(r=e.ranges.slice()),r[n]=s)}return r?pt.create(r,e.mainIndex):e}function dj(t,e,r){let n=Gv(t.state.facet(B1).map(i=>i(t)),r.from,e.head>r.from?-1:1);return n==r.from?r:pt.cursor(n,n<r.from?1:-1)}class lu{constructor(e,r){this.pos=e,this.assoc=r}}function _E(t,e,r,n){let i=t.contentDOM.getBoundingClientRect(),s=i.top+t.viewState.paddingTop,{x:a,y:o}=e,d=o-s,m;for(;;){if(d<0)return new lu(0,1);if(d>t.viewState.docHeight)return new lu(t.state.doc.length,-1);if(m=t.elementAtHeight(d),n==null)break;if(m.type==oo.Text){if(n<0?m.to<t.viewport.from:m.from>t.viewport.to)break;let w=t.docView.coordsAt(n<0?m.from:m.to,n>0?-1:1);if(w&&(n<0?w.top<=d+s:w.bottom>=d+s))break}let v=t.viewState.heightOracle.textHeight/2;d=n>0?m.bottom+v:m.top-v}if(t.viewport.from>=m.to||t.viewport.to<=m.from){if(r)return null;if(m.type==oo.Text){let v=mwe(t,i,m,a,o);return new lu(v,v==m.from?1:-1)}}if(m.type!=oo.Text)return d<(m.top+m.bottom)/2?new lu(m.from,1):new lu(m.to,-1);let y=t.docView.lineAt(m.from,2);return(!y||y.length!=m.length)&&(y=t.docView.lineAt(m.from,-2)),Sq(t,y,m.from,a,o)}function Sq(t,e,r,n,i){let s=-1,a=null,o=1e9,d=1e9,m=i,y=i,v=(w,O)=>{for(let P=0;P<w.length;P++){let E=w[P];if(E.top==E.bottom)continue;let $=E.left>n?E.left-n:E.right<n?n-E.right:0,R=E.top>i?E.top-i:E.bottom<i?i-E.bottom:0;E.top<=y&&E.bottom>=m&&(m=Math.min(E.top,m),y=Math.max(E.bottom,y),R=0),(s<0||(R-d||$-o)<0)&&(s>=0&&d&&o<$&&a.top<=y-2&&a.bottom>=m+2?d=0:(s=O,o=$,d=R,a=E))}};if(e.isText()){for(let O=0;O<e.length;){let P=bs(e.text,O);if(v($b(e.dom,O,P).getClientRects(),O),!o&&!d)break;O=P}return n>(a.left+a.right)/2==(FF(t,s+r)==ti.LTR)?new lu(r+bs(e.text,s),-1):new lu(r+s,1)}else{if(!e.length)return new lu(r,1);for(let E=0;E<e.children.length;E++){let $=e.children[E];if($.flags&48)continue;let R=($.dom.nodeType==1?$.dom:$b($.dom,0,$.length)).getClientRects();if(v(R,E),!o&&!d)break}let w=e.children[s],O=e.posBefore(w,r);return w.isComposite()||w.isText()?Sq(t,w,O,Math.max(a.left,Math.min(a.right,n)),i):n>(a.left+a.right)/2==(FF(t,s+r)==ti.LTR)?new lu(O+w.length,-1):new lu(O,1)}}function FF(t,e){let r=t.state.doc.lineAt(e);return t.bidiSpans(r)[ch.find(t.bidiSpans(r),e-r.from,-1,1)].dir}const gv="";class vwe{constructor(e,r){this.points=e,this.view=r,this.text="",this.lineSeparator=r.state.facet(fn.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=gv}readRange(e,r){if(!e)return this;let n=e.parentNode;for(let i=e;;){this.findPointBefore(n,i);let s=this.text.length;this.readNode(i);let a=is.get(i),o=i.nextSibling;if(o==r){a!=null&&a.breakAfter&&!o&&n!=this.view.contentDOM&&this.lineBreak();break}let d=is.get(o);(a&&d?a.breakAfter:(a?a.breakAfter:I2(i))||I2(o)&&(i.nodeName!="BR"||a!=null&&a.isWidget())&&this.text.length>s)&&!_we(o,r)&&this.lineBreak(),i=o}return this.findPointBefore(n,r),this}readTextNode(e){let r=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,r.length));for(let n=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,a=1,o;if(this.lineSeparator?(s=r.indexOf(this.lineSeparator,n),a=this.lineSeparator.length):(o=i.exec(r))&&(s=o.index,a=o[0].length),this.append(r.slice(n,s<0?r.length:s)),s<0)break;if(this.lineBreak(),a>1)for(let d of this.points)d.node==e&&d.pos>this.text.length&&(d.pos-=a-1);n=s+a}}readNode(e){let r=is.get(e),n=r&&r.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let i=n.iter();!i.next().done;)i.lineBreak?this.lineBreak():this.append(i.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,r){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==r&&(n.pos=this.text.length)}findPointInside(e,r){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(bwe(e,n.node,n.offset)?r:0))}}function bwe(t,e,r){for(;;){if(!e||r<Ch(e))return!1;if(e==t)return!0;r=mf(e)+1,e=e.parentNode}}function _we(t,e){let r;for(;!(t==e||!t);t=t.nextSibling){let n=is.get(t);if(!(n!=null&&n.isWidget()))return!1;n&&(r||(r=[])).push(n)}if(r)for(let n of r){let i=n.overrideDOMText;if(i!=null&&i.length)return!1}return!0}class BF{constructor(e,r){this.node=e,this.offset=r,this.pos=-1}}class wwe{constructor(e,r,n,i){this.typeOver=i,this.bounds=null,this.text="",this.domChanged=r>-1;let{impreciseHead:s,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&r>-1)this.newSel=null;else if(r>-1&&(this.bounds=kq(e.docView.tile,r,n,0))){let o=s||a?[]:kwe(e),d=new vwe(o,e);d.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=d.text,this.newSel=Cwe(o,this.bounds.from)}else{let o=e.observer.selectionRange,d=s&&s.node==o.focusNode&&s.offset==o.focusOffset||!pE(e.contentDOM,o.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(o.focusNode,o.focusOffset),m=a&&a.node==o.anchorNode&&a.offset==o.anchorOffset||!pE(e.contentDOM,o.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(o.anchorNode,o.anchorOffset),y=e.viewport;if((ur.ios||ur.chrome)&&e.state.selection.main.empty&&d!=m&&(y.from>0||y.to<e.state.doc.length)){let v=Math.min(d,m),w=Math.max(d,m),O=y.from-v,P=y.to-w;(O==0||O==1||v==0)&&(P==0||P==-1||w==e.state.doc.length)&&(d=0,m=e.state.doc.length)}e.inputState.composing>-1&&e.state.selection.ranges.length>1?this.newSel=e.state.selection.replaceRange(pt.range(m,d)):this.newSel=pt.single(m,d)}}}function kq(t,e,r,n){if(t.isComposite()){let i=-1,s=-1,a=-1,o=-1;for(let d=0,m=n,y=n;d<t.children.length;d++){let v=t.children[d],w=m+v.length;if(m<e&&w>r)return kq(v,e,r,m);if(w>=e&&i==-1&&(i=d,s=m),m>r&&v.dom.parentNode==t.dom){a=d,o=y;break}y=w,m=w+v.breakAfter}return{from:s,to:o<0?n+t.length:o,startDOM:(i?t.children[i-1].dom.nextSibling:null)||t.dom.firstChild,endDOM:a<t.children.length&&a>=0?t.children[a].dom:null}}else return t.isText()?{from:n,to:n+t.length,startDOM:t.dom,endDOM:t.dom.nextSibling}:null}function Cq(t,e){let r,{newSel:n}=e,i=t.state.selection.main,s=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:a,to:o}=e.bounds,d=i.from,m=null;(s===8||ur.android&&e.text.length<o-a)&&(d=i.to,m="end");let y=Tq(t.state.doc.sliceString(a,o,gv),e.text,d-a,m);y&&(ur.chrome&&s==13&&y.toB==y.from+2&&e.text.slice(y.from,y.toB)==gv+gv&&y.toB--,r={from:a+y.from,to:a+y.toA,insert:Sn.of(e.text.slice(y.from,y.toB).split(gv))})}else n&&(!t.hasFocus&&t.state.facet(ih)||F2(n,i))&&(n=null);if(!r&&!n)return!1;if(!r&&e.typeOver&&!i.empty&&n&&n.main.empty?r={from:i.from,to:i.to,insert:t.state.doc.slice(i.from,i.to)}:(ur.mac||ur.android)&&r&&r.from==r.to&&r.from==i.head-1&&/^\. ?$/.test(r.insert.toString())&&t.contentDOM.getAttribute("autocorrect")=="off"?(n&&r.insert.length==2&&(n=pt.single(n.main.anchor-1,n.main.head-1)),r={from:r.from,to:r.to,insert:Sn.of([r.insert.toString().replace("."," ")])}):r&&r.from>=i.from&&r.to<=i.to&&(r.from!=i.from||r.to!=i.to)&&i.to-i.from-(r.to-r.from)<=4?r={from:i.from,to:i.to,insert:t.state.doc.slice(i.from,r.from).append(r.insert).append(t.state.doc.slice(r.to,i.to))}:t.state.doc.lineAt(i.from).to<i.to&&t.docView.lineHasWidget(i.to)&&t.inputState.insertingTextAt>Date.now()-50?r={from:i.from,to:i.to,insert:t.state.toText(t.inputState.insertingText)}:ur.chrome&&r&&r.from==r.to&&r.from==i.head&&r.insert.toString()==`
 `&&t.lineWrapping&&(n&&(n=pt.single(n.main.anchor-1,n.main.head-1)),r={from:i.from,to:i.to,insert:Sn.of([" "])}),r)return KM(t,r,n,s);if(n&&!F2(n,i)){let a=!1,o="select";return t.inputState.lastSelectionTime>Date.now()-50&&(t.inputState.lastSelectionOrigin=="select"&&(a=!0),o=t.inputState.lastSelectionOrigin,o=="select.pointer"&&(n=wq(t.state.facet(B1).map(d=>d(t)),n))),t.dispatch({selection:n,scrollIntoView:a,userEvent:o}),!0}else return!1}function KM(t,e,r,n=-1){if(ur.ios&&t.inputState.flushIOSKey(e))return!0;let i=t.state.selection.main;if(ur.android&&(e.to==i.to&&(e.from==i.from||e.from==i.from-1&&t.state.sliceDoc(e.from,i.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&by(t.contentDOM,"Enter",13)||(e.from==i.from-1&&e.to==i.to&&e.insert.length==0||n==8&&e.insert.length<e.to-e.from&&e.to>i.head)&&by(t.contentDOM,"Backspace",8)||e.from==i.from&&e.to==i.to+1&&e.insert.length==0&&by(t.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let a,o=()=>a||(a=Swe(t,e,r));return t.state.facet(uq).some(d=>d(t,e.from,e.to,s,o))||t.dispatch(o()),!0}function Swe(t,e,r){let n,i=t.state,s=i.selection.main,a=-1;if(e.from==e.to&&e.from<s.from||e.from>s.to){let d=e.from<s.from?-1:1,m=d<0?s.from:s.to,y=Gv(i.facet(B1).map(v=>v(t)),m,d);e.from==y&&(a=y)}if(a>-1)n={changes:e,selection:pt.cursor(e.from+e.insert.length,-1)};else if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!r||r.main.empty&&r.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let d=s.from<e.from?i.sliceDoc(s.from,e.from):"",m=s.to>e.to?i.sliceDoc(e.to,s.to):"";n=i.replaceSelection(t.state.toText(d+e.insert.sliceString(0,void 0,t.state.lineBreak)+m))}else{let d=i.changes(e),m=r&&r.main.to<=d.newLength?r.main:void 0;if(i.selection.ranges.length>1&&(t.inputState.composing>=0||t.inputState.compositionPendingChange)&&e.to<=s.to+10&&e.to>=s.to-10){let y=t.state.sliceDoc(e.from,e.to),v,w=r&&_q(t,r.main.head);if(w){let P=e.insert.length-(e.to-e.from);v={from:w.from,to:w.to-P}}else v=t.state.doc.lineAt(s.head);let O=s.to-e.to;n=i.changeByRange(P=>{if(P.from==s.from&&P.to==s.to)return{changes:d,range:m||P.map(d)};let E=P.to-O,$=E-y.length;if(t.state.sliceDoc($,E)!=y||E>=v.from&&$<=v.to)return{range:P};let R=i.changes({from:$,to:E,insert:e.insert}),F=P.to-s.to;return{changes:R,range:m?pt.range(Math.max(0,m.anchor+F),Math.max(0,m.head+F)):P.map(R)}})}else n={changes:d,selection:m&&i.selection.replaceRange(m)}}let o="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,o+=".compose",t.inputState.compositionFirstChange&&(o+=".start",t.inputState.compositionFirstChange=!1)),i.update(n,{userEvent:o,scrollIntoView:!0})}function Tq(t,e,r,n){let i=Math.min(t.length,e.length),s=0;for(;s<i&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==i&&t.length==e.length)return null;let a=t.length,o=e.length;for(;a>0&&o>0&&t.charCodeAt(a-1)==e.charCodeAt(o-1);)a--,o--;if(n=="end"){let d=Math.max(0,s-Math.min(a,o));r-=a+d-s}if(a<s&&t.length<e.length){let d=r<=s&&r>=a?s-r:0;s-=d,o=s+(o-a),a=s}else if(o<s){let d=r<=s&&r>=o?s-r:0;s-=d,a=s+(a-o),o=s}return{from:s,toA:a,toB:o}}function kwe(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:s}=t.observer.selectionRange;return r&&(e.push(new BF(r,n)),(i!=r||s!=n)&&e.push(new BF(i,s))),e}function Cwe(t,e){if(t.length==0)return null;let r=t[0].pos,n=t.length==2?t[1].pos:r;return r>-1&&n>-1?pt.single(r+e,n+e):null}function F2(t,e){return e.head==t.main.head&&e.anchor==t.main.anchor}class Twe{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.insertingText="",this.insertingTextAt=0,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,ur.safari&&e.contentDOM.addEventListener("input",()=>null),ur.gecko&&Nwe(e.contentDOM.ownerDocument)}handleEvent(e){!Iwe(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,r){let n=this.handlers[e];if(n){for(let i of n.observers)i(this.view,r);for(let i of n.handlers){if(r.defaultPrevented)break;if(i(this.view,r)){r.preventDefault();break}}}}ensureHandlers(e){let r=Owe(e),n=this.handlers,i=this.view.contentDOM;for(let s in r)if(s!="scroll"){let a=!r[s].handlers.length,o=n[s];o&&a!=!o.handlers.length&&(i.removeEventListener(s,this.handleEvent),o=null),o||i.addEventListener(s,this.handleEvent,{passive:a})}for(let s in n)s!="scroll"&&!r[s]&&i.removeEventListener(s,this.handleEvent);this.handlers=r}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&jq.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),ur.android&&ur.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let r;return ur.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((r=Oq.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||jwe.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=r||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let r=this.pendingIOSKey;return!r||r.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,by(this.view.contentDOM,r.key,r.keyCode,r instanceof KeyboardEvent?r:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:ur.safari&&!ur.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function $F(t,e){return(r,n)=>{try{return e.call(t,n,r)}catch(i){wa(r.state,i)}}}function Owe(t){let e=Object.create(null);function r(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of t){let i=n.spec,s=i&&i.plugin.domEventHandlers,a=i&&i.plugin.domEventObservers;if(s)for(let o in s){let d=s[o];d&&r(o).handlers.push($F(n.value,d))}if(a)for(let o in a){let d=a[o];d&&r(o).observers.push($F(n.value,d))}}for(let n in kc)r(n).handlers.push(kc[n]);for(let n in Ql)r(n).observers.push(Ql[n]);return e}const Oq=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],jwe="dthko",jq=[16,17,18,20,91,92,224,225],Ow=6;function jw(t){return Math.max(0,t)*.7+8}function Pwe(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}class Awe{constructor(e,r,n,i){this.view=e,this.startEvent=r,this.style=n,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=r,this.scrollParents=M_e(e.contentDOM),this.atoms=e.state.facet(B1).map(a=>a(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=r.shiftKey,this.multiple=e.state.facet(fn.allowMultipleSelections)&&Ewe(e,r),this.dragging=Mwe(e,r)&&Eq(r)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Pwe(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let r=0,n=0,i=0,s=0,a=this.view.win.innerWidth,o=this.view.win.innerHeight;this.scrollParents.x&&({left:i,right:a}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:o}=this.scrollParents.y.getBoundingClientRect());let d=XM(this.view);e.clientX-d.left<=i+Ow?r=-jw(i-e.clientX):e.clientX+d.right>=a-Ow&&(r=jw(e.clientX-a)),e.clientY-d.top<=s+Ow?n=-jw(s-e.clientY):e.clientY+d.bottom>=o-Ow&&(n=jw(e.clientY-o)),this.setScrollSpeed(r,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,r){this.scrollSpeed={x:e,y:r},e||r?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:r}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),r&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=r,r=0),(e||r)&&this.view.win.scrollBy(e,r),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:r}=this,n=wq(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(r.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(r=>r.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Ewe(t,e){let r=t.state.facet(oq);return r.length?r[0](e):ur.mac?e.metaKey:e.ctrlKey}function zwe(t,e){let r=t.state.facet(aq);return r.length?r[0](e):ur.mac?!e.altKey:!e.ctrlKey}function Mwe(t,e){let{main:r}=t.state.selection;if(r.empty)return!1;let n=a0(t.root);if(!n||n.rangeCount==0)return!0;let i=n.getRangeAt(0).getClientRects();for(let s=0;s<i.length;s++){let a=i[s];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function Iwe(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target,n;r!=t.contentDOM;r=r.parentNode)if(!r||r.nodeType==11||(n=is.get(r))&&n.isWidget()&&!n.isHidden&&n.widget.ignoreEvent(e))return!1;return!0}const kc=Object.create(null),Ql=Object.create(null),Pq=ur.ie&&ur.ie_version<15||ur.ios&&ur.webkit_version<604;function Rwe(t){let e=t.dom.parentNode;if(!e)return;let r=e.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{t.focus(),r.remove(),Aq(t,r.value)},50)}function yC(t,e,r){for(let n of t.facet(e))r=n(r,t);return r}function Aq(t,e){e=yC(t.state,qM,e);let{state:r}=t,n,i=1,s=r.toText(e),a=s.lines==r.selection.ranges.length;if(wE!=null&&r.selection.ranges.every(d=>d.empty)&&wE==s.toString()){let d=-1;n=r.changeByRange(m=>{let y=r.doc.lineAt(m.from);if(y.from==d)return{range:m};d=y.from;let v=r.toText((a?s.line(i++).text:e)+r.lineBreak);return{changes:{from:y.from,insert:v},range:pt.cursor(m.from+v.length)}})}else a?n=r.changeByRange(d=>{let m=s.line(i++);return{changes:{from:d.from,to:d.to,insert:m.text},range:pt.cursor(d.from+m.length)}}):n=r.replaceSelection(s);t.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}Ql.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft};kc.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),e.keyCode==27&&t.inputState.tabFocusMode!=0&&(t.inputState.tabFocusMode=Date.now()+2e3),!1);Ql.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")};Ql.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")};kc.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let r=null;for(let n of t.state.facet(lq))if(r=n(t,e),r)break;if(!r&&e.button==0&&(r=Lwe(t,e)),r){let n=!t.hasFocus;t.inputState.startMouseSelection(new Awe(t,e,r,n)),n&&t.observer.ignore(()=>{ZU(t.contentDOM);let s=t.root.activeElement;s&&!s.contains(t.contentDOM)&&s.blur()});let i=t.inputState.mouseSelection;if(i)return i.start(e),i.dragging===!1}else t.inputState.setSelectionOrigin("select.pointer");return!1};function NF(t,e,r,n){if(n==1)return pt.cursor(e,r);if(n==2)return pwe(t.state,e,r);{let i=t.docView.lineAt(e,r),s=t.state.doc.lineAt(i?i.posAtEnd:e),a=i?i.posAtStart:s.from,o=i?i.posAtEnd:s.to;return o<t.state.doc.length&&o==s.to&&o++,pt.range(a,o)}}const Dwe=ur.ie&&ur.ie_version<=11;let VF=null,WF=0,UF=0;function Eq(t){if(!Dwe)return t.detail;let e=VF,r=UF;return VF=t,UF=Date.now(),WF=!e||r>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(WF+1)%3:1}function Lwe(t,e){let r=t.posAndSideAtCoords({x:e.clientX,y:e.clientY},!1),n=Eq(e),i=t.state.selection;return{update(s){s.docChanged&&(r.pos=s.changes.mapPos(r.pos),i=i.map(s.changes))},get(s,a,o){let d=t.posAndSideAtCoords({x:s.clientX,y:s.clientY},!1),m,y=NF(t,d.pos,d.assoc,n);if(r.pos!=d.pos&&!a){let v=NF(t,r.pos,r.assoc,n),w=Math.min(v.from,y.from),O=Math.max(v.to,y.to);y=w<y.from?pt.range(w,O):pt.range(O,w)}return a?i.replaceRange(i.main.extend(y.from,y.to)):o&&n==1&&i.ranges.length>1&&(m=Fwe(i,d.pos))?m:o?i.addRange(y):pt.create([y])}}}function Fwe(t,e){for(let r=0;r<t.ranges.length;r++){let{from:n,to:i}=t.ranges[r];if(n<=e&&i>=e)return pt.create(t.ranges.slice(0,r).concat(t.ranges.slice(r+1)),t.mainIndex==r?0:t.mainIndex-(t.mainIndex>r?1:0))}return null}kc.dragstart=(t,e)=>{let{selection:{main:r}}=t.state;if(e.target.draggable){let i=t.docView.tile.nearest(e.target);if(i&&i.isWidget()){let s=i.posAtStart,a=s+i.length;(s>=r.to||a<=r.from)&&(r=pt.range(s,a))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=r,e.dataTransfer&&(e.dataTransfer.setData("Text",yC(t.state,QM,t.state.sliceDoc(r.from,r.to))),e.dataTransfer.effectAllowed="copyMove"),!1};kc.dragend=t=>(t.inputState.draggedContent=null,!1);function qF(t,e,r,n){if(r=yC(t.state,qM,r),!r)return;let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=t.inputState,a=n&&s&&zwe(t,e)?{from:s.from,to:s.to}:null,o={from:i,insert:r},d=t.state.changes(a?[a,o]:o);t.focus(),t.dispatch({changes:d,selection:{anchor:d.mapPos(i,-1),head:d.mapPos(i,1)},userEvent:a?"move.drop":"input.drop"}),t.inputState.draggedContent=null}kc.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let r=e.dataTransfer.files;if(r&&r.length){let n=Array(r.length),i=0,s=()=>{++i==r.length&&qF(t,e,n.filter(a=>a!=null).join(t.state.lineBreak),!1)};for(let a=0;a<r.length;a++){let o=new FileReader;o.onerror=s,o.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(o.result)||(n[a]=o.result),s()},o.readAsText(r[a])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return qF(t,e,n,!0),!0}return!1};kc.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let r=Pq?null:e.clipboardData;return r?(Aq(t,r.getData("text/plain")||r.getData("text/uri-list")),!0):(Rwe(t),!1)};function Bwe(t,e){let r=t.dom.parentNode;if(!r)return;let n=r.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),t.focus()},50)}function $we(t){let e=[],r=[],n=!1;for(let i of t.selection.ranges)i.empty||(e.push(t.sliceDoc(i.from,i.to)),r.push(i));if(!e.length){let i=-1;for(let{from:s}of t.selection.ranges){let a=t.doc.lineAt(s);a.number>i&&(e.push(a.text),r.push({from:a.from,to:Math.min(t.doc.length,a.to+1)})),i=a.number}n=!0}return{text:yC(t,QM,e.join(t.lineBreak)),ranges:r,linewise:n}}let wE=null;kc.copy=kc.cut=(t,e)=>{let r=a0(t.root);if(r&&!qv(t.contentDOM,r))return!1;let{text:n,ranges:i,linewise:s}=$we(t.state);if(!n&&!s)return!1;wE=s?n:null,e.type=="cut"&&!t.state.readOnly&&t.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let a=Pq?null:e.clipboardData;return a?(a.clearData(),a.setData("text/plain",n),!0):(Bwe(t,n),!1)};const zq=ku.define();function Mq(t,e){let r=[];for(let n of t.facet(hq)){let i=n(t,e);i&&r.push(i)}return r.length?t.update({effects:r,annotations:zq.of(!0)}):null}function Iq(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let r=Mq(t.state,e);r?t.dispatch(r):t.update([])}},10)}Ql.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),Iq(t)};Ql.blur=t=>{t.observer.clearSelectionRange(),Iq(t)};Ql.compositionstart=Ql.compositionupdate=t=>{t.observer.editContext||(t.inputState.compositionFirstChange==null&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))};Ql.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,ur.chrome&&ur.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50))};Ql.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()};kc.beforeinput=(t,e)=>{var r,n;if((e.inputType=="insertText"||e.inputType=="insertCompositionText")&&(t.inputState.insertingText=e.data,t.inputState.insertingTextAt=Date.now()),e.inputType=="insertReplacementText"&&t.observer.editContext){let s=(r=e.dataTransfer)===null||r===void 0?void 0:r.getData("text/plain"),a=e.getTargetRanges();if(s&&a.length){let o=a[0],d=t.posAtDOM(o.startContainer,o.startOffset),m=t.posAtDOM(o.endContainer,o.endOffset);return KM(t,{from:d,to:m,insert:t.state.toText(s)},null),!0}}let i;if(ur.chrome&&ur.android&&(i=Oq.find(s=>s.inputType==e.inputType))&&(t.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let s=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>s+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return ur.ios&&e.inputType=="deleteContentForward"&&t.observer.flushSoon(),ur.safari&&e.inputType=="insertText"&&t.inputState.composing>=0&&setTimeout(()=>Ql.compositionend(t,e),20),!1};const QF=new Set;function Nwe(t){QF.has(t)||(QF.add(t),t.addEventListener("copy",()=>{}),t.addEventListener("cut",()=>{}))}const HF=["pre-wrap","normal","pre-line","break-spaces"];let u0=!1;function GF(){u0=!1}class Vwe{constructor(e){this.lineWrapping=e,this.doc=Sn.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,r){let n=this.doc.lineAt(r).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((r-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return HF.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let r=!1;for(let n=0;n<e.length;n++){let i=e[n];i<0?n++:this.heightSamples[Math.floor(i*10)]||(r=!0,this.heightSamples[Math.floor(i*10)]=!0)}return r}refresh(e,r,n,i,s,a){let o=HF.indexOf(e)>-1,d=Math.abs(r-this.lineHeight)>.3||this.lineWrapping!=o||Math.abs(n-this.charWidth)>.1;if(this.lineWrapping=o,this.lineHeight=r,this.charWidth=n,this.textHeight=i,this.lineLength=s,d){this.heightSamples={};for(let m=0;m<a.length;m++){let y=a[m];y<0?m++:this.heightSamples[Math.floor(y*10)]=!0}}return d}}class Wwe{constructor(e,r){this.from=e,this.heights=r,this.index=0}get more(){return this.index<this.heights.length}}class dc{constructor(e,r,n,i,s){this.from=e,this.length=r,this.top=n,this.height=i,this._content=s}get type(){return typeof this._content=="number"?oo.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof pm?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let r=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new dc(this.from,this.length+e.length,this.top,this.height+e.height,r)}}var ri=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(ri||(ri={}));const ES=.001;class Go{constructor(e,r,n=2){this.length=e,this.height=r,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>ES&&(u0=!0),this.height=e)}replace(e,r,n){return Go.of(n)}decomposeLeft(e,r){r.push(this)}decomposeRight(e,r){r.push(this)}applyChanges(e,r,n,i){let s=this,a=n.doc;for(let o=i.length-1;o>=0;o--){let{fromA:d,toA:m,fromB:y,toB:v}=i[o],w=s.lineAt(d,ri.ByPosNoHeight,n.setDoc(r),0,0),O=w.to>=m?w:s.lineAt(m,ri.ByPosNoHeight,n,0,0);for(v+=O.to-m,m=O.to;o>0&&w.from<=i[o-1].toA;)d=i[o-1].fromA,y=i[o-1].fromB,o--,d<w.from&&(w=s.lineAt(d,ri.ByPosNoHeight,n,0,0));y+=w.from-d,d=w.from;let P=ZM.build(n.setDoc(a),e,y,v);s=B2(s,s.replace(d,m,P))}return s.updateHeight(n,0)}static empty(){return new Ha(0,0,0)}static of(e){if(e.length==1)return e[0];let r=0,n=e.length,i=0,s=0;for(;;)if(r==n)if(i>s*2){let o=e[r-1];o.break?e.splice(--r,1,o.left,null,o.right):e.splice(--r,1,o.left,o.right),n+=1+o.break,i-=o.size}else if(s>i*2){let o=e[n];o.break?e.splice(n,1,o.left,null,o.right):e.splice(n,1,o.left,o.right),n+=2+o.break,s-=o.size}else break;else if(i<s){let o=e[r++];o&&(i+=o.size)}else{let o=e[--n];o&&(s+=o.size)}let a=0;return e[r-1]==null?(a=1,r--):e[r]==null&&(a=1,n++),new qwe(Go.of(e.slice(0,r)),a,Go.of(e.slice(n)))}}function B2(t,e){return t==e?t:(t.constructor!=e.constructor&&(u0=!0),e)}Go.prototype.size=1;const Uwe=jr.replace({});class Rq extends Go{constructor(e,r,n){super(e,r),this.deco=n,this.spaceAbove=0}mainBlock(e,r){return new dc(r,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.deco||0)}blockAt(e,r,n,i){return this.spaceAbove&&e<n+this.spaceAbove?new dc(i,0,n,this.spaceAbove,Uwe):this.mainBlock(n,i)}lineAt(e,r,n,i,s){let a=this.mainBlock(i,s);return this.spaceAbove?this.blockAt(0,n,i,s).join(a):a}forEachLine(e,r,n,i,s,a){e<=s+this.length&&r>=s&&a(this.lineAt(0,ri.ByPos,n,i,s))}setMeasuredHeight(e){let r=e.heights[e.index++];r<0?(this.spaceAbove=-r,r=e.heights[e.index++]):this.spaceAbove=0,this.setHeight(r)}updateHeight(e,r=0,n=!1,i){return i&&i.from<=r&&i.more&&this.setMeasuredHeight(i),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Ha extends Rq{constructor(e,r,n){super(e,r,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0,this.spaceAbove=n}mainBlock(e,r){return new dc(r,this.length,e+this.spaceAbove,this.height-this.spaceAbove,this.breaks)}replace(e,r,n){let i=n[0];return n.length==1&&(i instanceof Ha||i instanceof Ks&&i.flags&4)&&Math.abs(this.length-i.length)<10?(i instanceof Ks?i=new Ha(i.length,this.height,this.spaceAbove):i.height=this.height,this.outdated||(i.outdated=!1),i):Go.of(n)}updateHeight(e,r=0,n=!1,i){return i&&i.from<=r&&i.more?this.setMeasuredHeight(i):(n||this.outdated)&&(this.spaceAbove=0,this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight)),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Ks extends Go{constructor(e){super(e,0)}heightMetrics(e,r){let n=e.doc.lineAt(r).number,i=e.doc.lineAt(r+this.length).number,s=i-n+1,a,o=0;if(e.lineWrapping){let d=Math.min(this.height,e.lineHeight*s);a=d/s,this.length>s+1&&(o=(this.height-d)/(this.length-s-1))}else a=this.height/s;return{firstLine:n,lastLine:i,perLine:a,perChar:o}}blockAt(e,r,n,i){let{firstLine:s,lastLine:a,perLine:o,perChar:d}=this.heightMetrics(r,i);if(r.lineWrapping){let m=i+(e<r.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),y=r.doc.lineAt(m),v=o+y.length*d,w=Math.max(n,e-v/2);return new dc(y.from,y.length,w,v,0)}else{let m=Math.max(0,Math.min(a-s,Math.floor((e-n)/o))),{from:y,length:v}=r.doc.line(s+m);return new dc(y,v,n+o*m,o,0)}}lineAt(e,r,n,i,s){if(r==ri.ByHeight)return this.blockAt(e,n,i,s);if(r==ri.ByPosNoHeight){let{from:O,to:P}=n.doc.lineAt(e);return new dc(O,P-O,0,0,0)}let{firstLine:a,perLine:o,perChar:d}=this.heightMetrics(n,s),m=n.doc.lineAt(e),y=o+m.length*d,v=m.number-a,w=i+o*v+d*(m.from-s-v);return new dc(m.from,m.length,Math.max(i,Math.min(w,i+this.height-y)),y,0)}forEachLine(e,r,n,i,s,a){e=Math.max(e,s),r=Math.min(r,s+this.length);let{firstLine:o,perLine:d,perChar:m}=this.heightMetrics(n,s);for(let y=e,v=i;y<=r;){let w=n.doc.lineAt(y);if(y==e){let P=w.number-o;v+=d*P+m*(e-s-P)}let O=d+m*w.length;a(new dc(w.from,w.length,v,O,0)),v+=O,y=w.to+1}}replace(e,r,n){let i=this.length-r;if(i>0){let s=n[n.length-1];s instanceof Ks?n[n.length-1]=new Ks(s.length+i):n.push(null,new Ks(i-1))}if(e>0){let s=n[0];s instanceof Ks?n[0]=new Ks(e+s.length):n.unshift(new Ks(e-1),null)}return Go.of(n)}decomposeLeft(e,r){r.push(new Ks(e-1),null)}decomposeRight(e,r){r.push(null,new Ks(this.length-e-1))}updateHeight(e,r=0,n=!1,i){let s=r+this.length;if(i&&i.from<=r+this.length&&i.more){let a=[],o=Math.max(r,i.from),d=-1;for(i.from>r&&a.push(new Ks(i.from-r-1).updateHeight(e,r));o<=s&&i.more;){let y=e.doc.lineAt(o).length;a.length&&a.push(null);let v=i.heights[i.index++],w=0;v<0&&(w=-v,v=i.heights[i.index++]),d==-1?d=v:Math.abs(v-d)>=ES&&(d=-2);let O=new Ha(y,v,w);O.outdated=!1,a.push(O),o+=y+1}o<=s&&a.push(null,new Ks(s-o).updateHeight(e,o));let m=Go.of(a);return(d<0||Math.abs(m.height-this.height)>=ES||Math.abs(d-this.heightMetrics(e,r).perLine)>=ES)&&(u0=!0),B2(this,m)}else(n||this.outdated)&&(this.setHeight(e.heightForGap(r,r+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class qwe extends Go{constructor(e,r,n){super(e.length+r+n.length,e.height+n.height,r|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,r,n,i){let s=n+this.left.height;return e<s?this.left.blockAt(e,r,n,i):this.right.blockAt(e,r,s,i+this.left.length+this.break)}lineAt(e,r,n,i,s){let a=i+this.left.height,o=s+this.left.length+this.break,d=r==ri.ByHeight?e<a:e<o,m=d?this.left.lineAt(e,r,n,i,s):this.right.lineAt(e,r,n,a,o);if(this.break||(d?m.to<o:m.from>o))return m;let y=r==ri.ByPosNoHeight?ri.ByPosNoHeight:ri.ByPos;return d?m.join(this.right.lineAt(o,y,n,a,o)):this.left.lineAt(o,y,n,i,s).join(m)}forEachLine(e,r,n,i,s,a){let o=i+this.left.height,d=s+this.left.length+this.break;if(this.break)e<d&&this.left.forEachLine(e,r,n,i,s,a),r>=d&&this.right.forEachLine(e,r,n,o,d,a);else{let m=this.lineAt(d,ri.ByPos,n,i,s);e<m.from&&this.left.forEachLine(e,m.from-1,n,i,s,a),m.to>=e&&m.from<=r&&a(m),r>m.to&&this.right.forEachLine(m.to+1,r,n,o,d,a)}}replace(e,r,n){let i=this.left.length+this.break;if(r<i)return this.balanced(this.left.replace(e,r,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,r-i,n));let s=[];e>0&&this.decomposeLeft(e,s);let a=s.length;for(let o of n)s.push(o);if(e>0&&XF(s,a-1),r<this.length){let o=s.length;this.decomposeRight(r,s),XF(s,o)}return Go.of(s)}decomposeLeft(e,r){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,r);r.push(this.left),this.break&&(n++,e>=n&&r.push(null)),e>n&&this.right.decomposeLeft(e-n,r)}decomposeRight(e,r){let n=this.left.length,i=n+this.break;if(e>=i)return this.right.decomposeRight(e-i,r);e<n&&this.left.decomposeRight(e,r),this.break&&e<i&&r.push(null),r.push(this.right)}balanced(e,r){return e.size>2*r.size||r.size>2*e.size?Go.of(this.break?[e,null,r]:[e,r]):(this.left=B2(this.left,e),this.right=B2(this.right,r),this.setHeight(e.height+r.height),this.outdated=e.outdated||r.outdated,this.size=e.size+r.size,this.length=e.length+this.break+r.length,this)}updateHeight(e,r=0,n=!1,i){let{left:s,right:a}=this,o=r+s.length+this.break,d=null;return i&&i.from<=r+s.length&&i.more?d=s=s.updateHeight(e,r,n,i):s.updateHeight(e,r,n),i&&i.from<=o+a.length&&i.more?d=a=a.updateHeight(e,o,n,i):a.updateHeight(e,o,n),d?this.balanced(s,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function XF(t,e){let r,n;t[e]==null&&(r=t[e-1])instanceof Ks&&(n=t[e+1])instanceof Ks&&t.splice(e-1,3,new Ks(r.length+1+n.length))}const Qwe=5;class ZM{constructor(e,r){this.pos=e,this.oracle=r,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,r){if(this.lineStart>-1){let n=Math.min(r,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof Ha?i.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Ha(n-this.pos,-1,0)),this.writtenTo=n,r>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=r}point(e,r,n){if(e<r||n.heightRelevant){let i=n.widget?n.widget.estimatedHeight:0,s=n.widget?n.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let a=r-e;n.block?this.addBlock(new Rq(a,i,n)):(a||s||i>=Qwe)&&this.addLineDeco(i,s,a)}else r>e&&this.span(e,r);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:r}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=r,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Ha(this.pos-e,-1,0)),this.writtenTo=this.pos}blankContent(e,r){let n=new Ks(r-e);return this.oracle.doc.lineAt(e).to==r&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Ha)return e;let r=new Ha(0,-1,0);return this.nodes.push(r),r}addBlock(e){this.enterLine();let r=e.deco;r&&r.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,r&&r.endSide>0&&(this.covering=e)}addLineDeco(e,r,n){let i=this.ensureLine();i.length+=n,i.collapsed+=n,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=r,this.writtenTo=this.pos=this.pos+n}finish(e){let r=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(r instanceof Ha)&&!this.isCovered?this.nodes.push(new Ha(0,-1,0)):(this.writtenTo<this.pos||r==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let i of this.nodes)i instanceof Ha&&i.updateHeight(this.oracle,n),n+=i?i.length:1;return this.nodes}static build(e,r,n,i){let s=new ZM(n,e);return sn.spans(r,n,i,s,0),s.finish(n)}}function Hwe(t,e,r){let n=new Gwe;return sn.compare(t,e,r,n,0),n.changes}class Gwe{constructor(){this.changes=[]}compareRange(){}comparePoint(e,r,n,i){(e<r||n&&n.heightRelevant||i&&i.heightRelevant)&&vy(e,r,this.changes,5)}}function Xwe(t,e){let r=t.getBoundingClientRect(),n=t.ownerDocument,i=n.defaultView||window,s=Math.max(0,r.left),a=Math.min(i.innerWidth,r.right),o=Math.max(0,r.top),d=Math.min(i.innerHeight,r.bottom);for(let m=t.parentNode;m&&m!=n.body;)if(m.nodeType==1){let y=m,v=window.getComputedStyle(y);if((y.scrollHeight>y.clientHeight||y.scrollWidth>y.clientWidth)&&v.overflow!="visible"){let w=y.getBoundingClientRect();s=Math.max(s,w.left),a=Math.min(a,w.right),o=Math.max(o,w.top),d=Math.min(m==t.parentNode?i.innerHeight:d,w.bottom)}m=v.position=="absolute"||v.position=="fixed"?y.offsetParent:y.parentNode}else if(m.nodeType==11)m=m.host;else break;return{left:s-r.left,right:Math.max(s,a)-r.left,top:o-(r.top+e),bottom:Math.max(o,d)-(r.top+e)}}function Kwe(t){let e=t.getBoundingClientRect(),r=t.ownerDocument.defaultView||window;return e.left<r.innerWidth&&e.right>0&&e.top<r.innerHeight&&e.bottom>0}function Zwe(t,e){let r=t.getBoundingClientRect();return{left:0,right:r.right-r.left,top:e,bottom:r.bottom-(r.top+e)}}class fj{constructor(e,r,n,i){this.from=e,this.to=r,this.size=n,this.displaySize=i}static same(e,r){if(e.length!=r.length)return!1;for(let n=0;n<e.length;n++){let i=e[n],s=r[n];if(i.from!=s.from||i.to!=s.to||i.size!=s.size)return!1}return!0}draw(e,r){return jr.replace({widget:new Ywe(this.displaySize*(r?e.scaleY:e.scaleX),r)}).range(this.from,this.to)}}class Ywe extends Tu{constructor(e,r){super(),this.size=e,this.vertical=r}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class KF{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=ZF,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ti.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let r=e.facet(HM).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new Vwe(r),this.stateDeco=YF(e),this.heightMap=Go.empty().applyChanges(this.stateDeco,Sn.empty,this.heightOracle.setDoc(e.doc),[new Il(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=jr.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:r}=this.state.selection;for(let n=0;n<=1;n++){let i=n?r.head:r.anchor;if(!e.some(({from:s,to:a})=>i>=s&&i<=a)){let{from:s,to:a}=this.lineBlockAt(i);e.push(new Pw(s,a))}}return this.viewports=e.sort((n,i)=>n.from-i.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?ZF:new YM(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(yv(e,this.scaler))})}update(e,r=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=YF(this.state);let i=e.changedRanges,s=Il.extendWithRanges(i,Hwe(n,this.stateDeco,e?e.changes:ms.empty(this.state.doc.length))),a=this.heightMap.height,o=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);GF(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=a||u0)&&(e.flags|=2),o?(this.scrollAnchorPos=e.changes.mapPos(o.from,-1),this.scrollAnchorHeight=o.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=a);let d=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(r&&(r.range.head<d.from||r.range.head>d.to)||!this.viewportIsAppropriate(d))&&(d=this.getViewport(0,r));let m=d.from!=this.viewport.from||d.to!=this.viewport.to;this.viewport=d,e.flags|=this.updateForViewport(),(m||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),r&&(this.scrollTarget=r),!this.mustEnforceCursorAssoc&&(e.selectionSet||e.focusChanged)&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(fq)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let r=e.contentDOM,n=window.getComputedStyle(r),i=this.heightOracle,s=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?ti.RTL:ti.LTR;let a=this.heightOracle.mustRefreshForWrapping(s)||this.mustMeasureContent,o=r.getBoundingClientRect(),d=a||this.mustMeasureContent||this.contentDOMHeight!=o.height;this.contentDOMHeight=o.height,this.mustMeasureContent=!1;let m=0,y=0;if(o.width&&o.height){let{scaleX:U,scaleY:X}=KU(r,o);(U>.005&&Math.abs(this.scaleX-U)>.005||X>.005&&Math.abs(this.scaleY-X)>.005)&&(this.scaleX=U,this.scaleY=X,m|=16,a=d=!0)}let v=(parseInt(n.paddingTop)||0)*this.scaleY,w=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=v||this.paddingBottom!=w)&&(this.paddingTop=v,this.paddingBottom=w,m|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(d=!0),this.editorWidth=e.scrollDOM.clientWidth,m|=16);let O=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=O&&(this.scrollAnchorHeight=-1,this.scrollTop=O),this.scrolledToBottom=YU(e.scrollDOM);let P=(this.printing?Zwe:Xwe)(r,this.paddingTop),E=P.top-this.pixelViewport.top,$=P.bottom-this.pixelViewport.bottom;this.pixelViewport=P;let R=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(R!=this.inView&&(this.inView=R,R&&(d=!0)),!this.inView&&!this.scrollTarget&&!Kwe(e.dom))return 0;let F=o.width;if((this.contentDOMWidth!=F||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,m|=16),d){let U=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(U)&&(a=!0),a||i.lineWrapping&&Math.abs(F-this.contentDOMWidth)>i.charWidth){let{lineHeight:X,charWidth:ee,textHeight:K}=e.docView.measureTextSize();a=X>0&&i.refresh(s,X,ee,K,Math.max(5,F/ee),U),a&&(e.docView.minWidth=0,m|=16)}E>0&&$>0?y=Math.max(E,$):E<0&&$<0&&(y=Math.min(E,$)),GF();for(let X of this.viewports){let ee=X.from==this.viewport.from?U:e.docView.measureVisibleLineHeights(X);this.heightMap=(a?Go.empty().applyChanges(this.stateDeco,Sn.empty,this.heightOracle,[new Il(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,a,new Wwe(X.from,ee))}u0&&(m|=2)}let D=!this.viewportIsAppropriate(this.viewport,y)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return D&&(m&2&&(m|=this.updateScaler()),this.viewport=this.getViewport(y,this.scrollTarget),m|=this.updateForViewport()),(m&2||D)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),m|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),m}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,r){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,s=this.heightOracle,{visibleTop:a,visibleBottom:o}=this,d=new Pw(i.lineAt(a-n*1e3,ri.ByHeight,s,0,0).from,i.lineAt(o+(1-n)*1e3,ri.ByHeight,s,0,0).to);if(r){let{head:m}=r.range;if(m<d.from||m>d.to){let y=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),v=i.lineAt(m,ri.ByPos,s,0,0),w;r.y=="center"?w=(v.top+v.bottom)/2-y/2:r.y=="start"||r.y=="nearest"&&m<d.from?w=v.top:w=v.bottom-y,d=new Pw(i.lineAt(w-1e3/2,ri.ByHeight,s,0,0).from,i.lineAt(w+y+1e3/2,ri.ByHeight,s,0,0).to)}}return d}mapViewport(e,r){let n=r.mapPos(e.from,-1),i=r.mapPos(e.to,1);return new Pw(this.heightMap.lineAt(n,ri.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,ri.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:r},n=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,ri.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(r,ri.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:o}=this;return(e==0||i<=a-Math.max(10,Math.min(-n,250)))&&(r==this.state.doc.length||s>=o+Math.max(10,Math.min(n,250)))&&i>a-2*1e3&&s<o+2*1e3}mapLineGaps(e,r){if(!e.length||r.empty)return e;let n=[];for(let i of e)r.touchesRange(i.from,i.to)||n.push(new fj(r.mapPos(i.from),r.mapPos(i.to),i.size,i.displaySize));return n}ensureLineGaps(e,r){let n=this.heightOracle.lineWrapping,i=n?1e4:2e3,s=i>>1,a=i<<1;if(this.defaultTextDirection!=ti.LTR&&!n)return[];let o=[],d=(y,v,w,O)=>{if(v-y<s)return;let P=this.state.selection.main,E=[P.from];P.empty||E.push(P.to);for(let R of E)if(R>y&&R<v){d(y,R-10,w,O),d(R+10,v,w,O);return}let $=eSe(e,R=>R.from>=w.from&&R.to<=w.to&&Math.abs(R.from-y)<s&&Math.abs(R.to-v)<s&&!E.some(F=>R.from<F&&R.to>F));if(!$){if(v<w.to&&r&&n&&r.visibleRanges.some(D=>D.from<=v&&D.to>=v)){let D=r.moveToLineBoundary(pt.cursor(v),!1,!0).head;D>y&&(v=D)}let R=this.gapSize(w,y,v,O),F=n||R<2e6?R:2e6;$=new fj(y,v,R,F)}o.push($)},m=y=>{if(y.length<a||y.type!=oo.Text)return;let v=Jwe(y.from,y.to,this.stateDeco);if(v.total<a)return;let w=this.scrollTarget?this.scrollTarget.range.head:null,O,P;if(n){let E=i/this.heightOracle.lineLength*this.heightOracle.lineHeight,$,R;if(w!=null){let F=Ew(v,w),D=((this.visibleBottom-this.visibleTop)/2+E)/y.height;$=F-D,R=F+D}else $=(this.visibleTop-y.top-E)/y.height,R=(this.visibleBottom-y.top+E)/y.height;O=Aw(v,$),P=Aw(v,R)}else{let E=v.total*this.heightOracle.charWidth,$=i*this.heightOracle.charWidth,R=0;if(E>2e6)for(let ee of e)ee.from>=y.from&&ee.from<y.to&&ee.size!=ee.displaySize&&ee.from*this.heightOracle.charWidth+R<this.pixelViewport.left&&(R=ee.size-ee.displaySize);let F=this.pixelViewport.left+R,D=this.pixelViewport.right+R,U,X;if(w!=null){let ee=Ew(v,w),K=((D-F)/2+$)/E;U=ee-K,X=ee+K}else U=(F-$)/E,X=(D+$)/E;O=Aw(v,U),P=Aw(v,X)}O>y.from&&d(y.from,O,y,v),P<y.to&&d(P,y.to,y,v)};for(let y of this.viewportLines)Array.isArray(y.type)?y.type.forEach(m):m(y);return o}gapSize(e,r,n,i){let s=Ew(i,n)-Ew(i,r);return this.heightOracle.lineWrapping?e.height*s:i.total*this.heightOracle.charWidth*s}updateLineGaps(e){fj.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=jr.set(e.map(r=>r.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let r=this.stateDeco;this.lineGaps.length&&(r=r.concat(this.lineGapDeco));let n=[];sn.spans(r,this.viewport.from,this.viewport.to,{span(s,a){n.push({from:s,to:a})},point(){}},20);let i=0;if(n.length!=this.visibleRanges.length)i=12;else for(let s=0;s<n.length&&!(i&8);s++){let a=this.visibleRanges[s],o=n[s];(a.from!=o.from||a.to!=o.to)&&(i|=4,e&&e.mapPos(a.from,-1)==o.from&&e.mapPos(a.to,1)==o.to||(i|=8))}return this.visibleRanges=n,i}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(r=>r.from<=e&&r.to>=e)||yv(this.heightMap.lineAt(e,ri.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(r=>r.top<=e&&r.bottom>=e)||yv(this.heightMap.lineAt(this.scaler.fromDOM(e),ri.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let r=this.lineBlockAtHeight(e+8);return r.from>=this.viewport.from||this.viewportLines[0].top-e>200?r:this.viewportLines[0]}elementAtHeight(e){return yv(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Pw{constructor(e,r){this.from=e,this.to=r}}function Jwe(t,e,r){let n=[],i=t,s=0;return sn.spans(r,t,e,{span(){},point(a,o){a>i&&(n.push({from:i,to:a}),s+=a-i),i=o}},20),i<e&&(n.push({from:i,to:e}),s+=e-i),{total:s,ranges:n}}function Aw({total:t,ranges:e},r){if(r<=0)return e[0].from;if(r>=1)return e[e.length-1].to;let n=Math.floor(t*r);for(let i=0;;i++){let{from:s,to:a}=e[i],o=a-s;if(n<=o)return s+n;n-=o}}function Ew(t,e){let r=0;for(let{from:n,to:i}of t.ranges){if(e<=i){r+=e-n;break}r+=i-n}return r/t.total}function eSe(t,e){for(let r of t)if(e(r))return r}const ZF={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};function YF(t){let e=t.facet(pC).filter(n=>typeof n!="function"),r=t.facet(GM).filter(n=>typeof n!="function");return r.length&&e.push(sn.join(r)),e}class YM{constructor(e,r,n){let i=0,s=0,a=0;this.viewports=n.map(({from:o,to:d})=>{let m=r.lineAt(o,ri.ByPos,e,0,0).top,y=r.lineAt(d,ri.ByPos,e,0,0).bottom;return i+=y-m,{from:o,to:d,top:m,bottom:y,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(r.height-i);for(let o of this.viewports)o.domTop=a+(o.top-s)*this.scale,a=o.domBottom=o.domTop+(o.bottom-o.top),s=o.bottom}toDOM(e){for(let r=0,n=0,i=0;;r++){let s=r<this.viewports.length?this.viewports[r]:null;if(!s||e<s.top)return i+(e-n)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);n=s.bottom,i=s.domBottom}}fromDOM(e){for(let r=0,n=0,i=0;;r++){let s=r<this.viewports.length?this.viewports[r]:null;if(!s||e<s.domTop)return n+(e-i)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);n=s.bottom,i=s.domBottom}}eq(e){return e instanceof YM?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((r,n)=>r.from==e.viewports[n].from&&r.to==e.viewports[n].to):!1}}function yv(t,e){if(e.scale==1)return t;let r=e.toDOM(t.top),n=e.toDOM(t.bottom);return new dc(t.from,t.length,r,n-r,Array.isArray(t._content)?t._content.map(i=>yv(i,e)):t._content)}const zw=hr.define({combine:t=>t.join(" ")}),SE=hr.define({combine:t=>t.indexOf(!0)>-1}),kE=ff.newName(),Dq=ff.newName(),Lq=ff.newName(),Fq={"&light":"."+Dq,"&dark":"."+Lq};function CE(t,e,r){return new ff(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,i=>{if(i=="&")return t;if(!r||!r[i])throw new RangeError(`Unsupported selector: ${i}`);return r[i]}):t+" "+n}})}const tSe=CE("."+kE,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Fq),rSe={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},pj=ur.ie&&ur.ie_version<=11;class nSe{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new I_e,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(r=>{for(let n of r)this.queue.push(n);(ur.ie&&ur.ie_version<=11||ur.ios&&e.composing)&&r.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&ur.android&&e.constructor.EDIT_CONTEXT!==!1&&!(ur.chrome&&ur.chrome_version<126)&&(this.editContext=new sSe(e),e.state.facet(ih)&&(e.contentDOM.editContext=this.editContext.editContext)),pj&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var r;((r=this.view.docView)===null||r===void 0?void 0:r.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(r=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),r.length>0&&r[r.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(r=>{r.length>0&&r[r.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((r,n)=>r!=e[n]))){this.gapIntersection.disconnect();for(let r of e)this.gapIntersection.observe(r);this.gaps=e}}onSelectionChange(e){let r=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,i=this.selectionRange;if(n.state.facet(ih)?n.root.activeElement!=this.dom:!qv(this.dom,i))return;let s=i.anchorNode&&n.docView.tile.nearest(i.anchorNode);if(s&&s.isWidget()&&s.widget.ignoreEvent(e)){r||(this.selectionChanged=!1);return}(ur.ie&&ur.ie_version<=11||ur.android&&ur.chrome)&&!n.state.selection.main.empty&&i.focusNode&&Hv(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,r=a0(e.root);if(!r)return!1;let n=ur.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&iSe(this.view,r)||r;if(!n||this.selectionRange.eq(n))return!1;let i=qv(this.dom,n);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&D_e(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,r){this.selectionRange.set(e.node,e.offset,r.node,r.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,r=null;for(let n=this.dom;n;)if(n.nodeType==1)!r&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:r||(r=this.scrollTargets.slice(0,e)),r&&r.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!r&&(r=this.scrollTargets.slice(0,e)),r){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=r)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,rSe),pj&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),pj&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,r){var n;if(!this.delayedAndroidKey){let i=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&by(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(i)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:r,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let r=-1,n=-1,i=!1;for(let s of e){let a=this.readMutation(s);a&&(a.typeOver&&(i=!0),r==-1?{from:r,to:n}=a:(r=Math.min(a.from,r),n=Math.max(a.to,n)))}return{from:r,to:n,typeOver:i}}readChange(){let{from:e,to:r,typeOver:n}=this.processRecords(),i=this.selectionChanged&&qv(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new wwe(this.view,e,r,n);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let r=this.readChange();if(!r)return this.view.requestMeasure(),!1;let n=this.view.state,i=Cq(this.view,r);return this.view.state==n&&(r.domChanged||r.newSel&&!F2(this.view.state.selection,r.newSel.main))&&this.view.update([]),i}readMutation(e){let r=this.view.docView.tile.nearest(e.target);if(!r||r.isWidget())return null;if(r.markDirty(e.type=="attributes"),e.type=="childList"){let n=JF(r,e.previousSibling||e.target.previousSibling,-1),i=JF(r,e.nextSibling||e.target.nextSibling,1);return{from:n?r.posAfter(n):r.posAtStart,to:i?r.posBefore(i):r.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(ih)!=e.state.facet(ih)&&(e.view.contentDOM.editContext=e.state.facet(ih)?this.editContext.editContext:null))}destroy(){var e,r,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(r=this.gapIntersection)===null||r===void 0||r.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function JF(t,e,r){for(;e;){let n=is.get(e);if(n&&n.parent==t)return n;let i=e.parentNode;e=i!=t.dom?i:r>0?e.nextSibling:e.previousSibling}return null}function eB(t,e){let r=e.startContainer,n=e.startOffset,i=e.endContainer,s=e.endOffset,a=t.docView.domAtPos(t.state.selection.main.anchor,1);return Hv(a.node,a.offset,i,s)&&([r,n,i,s]=[i,s,r,n]),{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:s}}function iSe(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return eB(t,i)}let r=null;function n(i){i.preventDefault(),i.stopImmediatePropagation(),r=i.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),r?eB(t,r):null}class sSe{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let r=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let i=e.state.selection.main,{anchor:s,head:a}=i,o=this.toEditorPos(n.updateRangeStart),d=this.toEditorPos(n.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:o,drifted:!1});let m=d-o>n.text.length;o==this.from&&s<this.from?o=s:d==this.to&&s>this.to&&(d=s);let y=Tq(e.state.sliceDoc(o,d),n.text,(m?i.from:i.to)-o,m?"end":null);if(!y){let w=pt.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd));F2(w,i)||e.dispatch({selection:w,userEvent:"select"});return}let v={from:y.from+o,to:y.toA+o,insert:Sn.of(n.text.slice(y.from,y.toB).split(`
`))};if((ur.mac||ur.android)&&v.from==a-1&&/^\. ?$/.test(n.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(v={from:o,to:d,insert:Sn.of([n.text.replace("."," ")])}),this.pendingContextChange=v,!e.state.readOnly){let w=this.to-this.from+(v.to-v.from+v.insert.length);KM(e,v,pt.single(this.toEditorPos(n.selectionStart,w),this.toEditorPos(n.selectionEnd,w)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),v.from<v.to&&!v.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(r.text.slice(Math.max(0,n.updateRangeStart-1),Math.min(r.text.length,n.updateRangeStart+1)))&&this.handlers.compositionend(n)},this.handlers.characterboundsupdate=n=>{let i=[],s=null;for(let a=this.toEditorPos(n.rangeStart),o=this.toEditorPos(n.rangeEnd);a<o;a++){let d=e.coordsForChar(a);s=d&&new DOMRect(d.left,d.top,d.right-d.left,d.bottom-d.top)||s||new DOMRect,i.push(s)}r.updateCharacterBounds(n.rangeStart,i)},this.handlers.textformatupdate=n=>{let i=[];for(let s of n.getTextFormats()){let a=s.underlineStyle,o=s.underlineThickness;if(!/none/i.test(a)&&!/none/i.test(o)){let d=this.toEditorPos(s.rangeStart),m=this.toEditorPos(s.rangeEnd);if(d<m){let y=`text-decoration: underline ${/^[a-z]/.test(a)?a+" ":a=="Dashed"?"dashed ":a=="Squiggle"?"wavy ":""}${/thin/i.test(o)?1:2}px`;i.push(jr.mark({attributes:{style:y}}).range(d,m))}}}e.dispatch({effects:mq.of(jr.set(i))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:n}=this.composing;this.composing=null,n&&this.reset(e.state)}};for(let n in this.handlers)r.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let i=a0(n.root);i&&i.rangeCount&&this.editContext.updateSelectionBounds(i.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let r=0,n=!1,i=this.pendingContextChange;return e.changes.iterChanges((s,a,o,d,m)=>{if(n)return;let y=m.length-(a-s);if(i&&a>=i.to)if(i.from==s&&i.to==a&&i.insert.eq(m)){i=this.pendingContextChange=null,r+=y,this.to+=y;return}else i=null,this.revertPending(e.state);if(s+=r,a+=r,a<=this.from)this.from+=y,this.to+=y;else if(s<this.to){if(s<this.from||a>this.to||this.to-this.from+m.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(a),m.toString()),this.to+=y}r+=y}),i&&!n&&this.revertPending(e.state),!n}update(e){let r=this.pendingContextChange,n=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(n.from,n.to)&&e.transactions.some(i=>!i.isUserEvent("input.type")&&i.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||r)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:r}=e.selection.main;this.from=Math.max(0,r-1e4),this.to=Math.min(e.doc.length,r+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let r=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(r.from),this.toContextPos(r.from+r.insert.length),e.doc.sliceString(r.from,r.to))}setSelection(e){let{main:r}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,r.anchor))),i=this.toContextPos(r.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=i)&&this.editContext.updateSelection(n,i)}rangeIsValid(e){let{head:r}=e.selection.main;return!(this.from>0&&r-this.from<500||this.to<e.doc.length&&this.to-r<500||this.to-this.from>1e4*3)}toEditorPos(e,r=this.to-this.from){e=Math.min(e,r);let n=this.composing;return n&&n.drifted?n.editorBase+(e-n.contextBase):e+this.from}toContextPos(e){let r=this.composing;return r&&r.drifted?r.contextBase+(e-r.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class Zt{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var r;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(i=>i.forEach(s=>n(s,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=e.root||R_e(e.parent)||document,this.viewState=new KF(e.state||fn.create(e)),e.scrollTo&&e.scrollTo.is(Tw)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Kg).map(i=>new lj(i));for(let i of this.plugins)i.update(this);this.observer=new nSe(this),this.inputState=new Twe(this),this.inputState.ensureHandlers(this.plugins),this.docView=new DF(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((r=document.fonts)===null||r===void 0)&&r.ready&&document.fonts.ready.then(()=>{this.viewState.mustMeasureContent=!0,this.requestMeasure()})}dispatch(...e){let r=e.length==1&&e[0]instanceof _s?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(r,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let r=!1,n=!1,i,s=this.state;for(let w of e){if(w.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=w.state}if(this.destroyed){this.viewState.state=s;return}let a=this.hasFocus,o=0,d=null;e.some(w=>w.annotation(zq))?(this.inputState.notifiedFocused=a,o=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,d=Mq(s,a),d||(o=1));let m=this.observer.delayedAndroidKey,y=null;if(m?(this.observer.clearDelayedAndroidKey(),y=this.observer.readChange(),(y&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(y=null)):this.observer.clear(),s.facet(fn.phrases)!=this.state.facet(fn.phrases))return this.setState(s);i=R2.create(this,s,e),i.flags|=o;let v=this.viewState.scrollTarget;try{this.updateState=2;for(let w of e){if(v&&(v=v.map(w.changes)),w.scrollIntoView){let{main:O}=w.state.selection;v=new _y(O.empty?O:pt.cursor(O.head,O.head>O.anchor?-1:1))}for(let O of w.effects)O.is(Tw)&&(v=O.value.clip(this.state))}this.viewState.update(i,v),this.bidiCache=$2.update(this.bidiCache,i.changes),i.empty||(this.updatePlugins(i),this.inputState.update(i)),r=this.docView.update(i),this.state.facet(mv)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(r,e.some(w=>w.isUserEvent("select.pointer")))}finally{this.updateState=0}if(i.startState.facet(zw)!=i.state.facet(zw)&&(this.viewState.mustMeasureContent=!0),(r||n||v||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),r&&this.docViewUpdate(),!i.empty)for(let w of this.state.facet(xE))try{w(i)}catch(O){wa(this.state,O,"update listener")}(d||y)&&Promise.resolve().then(()=>{d&&this.state==d.startState&&this.dispatch(d),y&&!Cq(this,y)&&m.force&&by(this.contentDOM,m.key,m.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let r=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new KF(e),this.plugins=e.facet(Kg).map(n=>new lj(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new DF(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}r&&this.focus(),this.requestMeasure()}updatePlugins(e){let r=e.startState.facet(Kg),n=e.state.facet(Kg);if(r!=n){let i=[];for(let s of n){let a=r.indexOf(s);if(a<0)i.push(new lj(s));else{let o=this.plugins[a];o.mustUpdate=e,i.push(o)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let i of this.plugins)i.mustUpdate=e;for(let i=0;i<this.plugins.length;i++)this.plugins[i].update(this);r!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let r=e.value;if(r&&r.docViewUpdate)try{r.docViewUpdate(this)}catch(n){wa(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let r=null,n=this.scrollDOM,i=n.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:a}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(a=-1),this.viewState.scrollAnchorHeight=-1;try{for(let o=0;;o++){if(a<0)if(YU(n))s=-1,a=this.viewState.heightMap.height;else{let O=this.viewState.scrollAnchorAt(i);s=O.from,a=O.top}this.updateState=1;let d=this.viewState.measure(this);if(!d&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(o>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let m=[];d&4||([this.measureRequests,m]=[m,this.measureRequests]);let y=m.map(O=>{try{return O.read(this)}catch(P){return wa(this.state,P),tB}}),v=R2.create(this,this.state,[]),w=!1;v.flags|=d,r?r.flags|=d:r=v,this.updateState=2,v.empty||(this.updatePlugins(v),this.inputState.update(v),this.updateAttrs(),w=this.docView.update(v),w&&this.docViewUpdate());for(let O=0;O<m.length;O++)if(y[O]!=tB)try{let P=m[O];P.write&&P.write(y[O],this)}catch(P){wa(this.state,P)}if(w&&this.docView.updateSelection(!0),!v.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=-1;continue}else{let P=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-a;if(P>1||P<-1){i=i+P,n.scrollTop=i/this.scaleY,a=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(r&&!r.empty)for(let o of this.state.facet(xE))o(r)}get themeClasses(){return kE+" "+(this.state.facet(SE)?Lq:Dq)+" "+this.state.facet(zw)}updateAttrs(){let e=rB(this,gq,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),r={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(ih)?"true":"false",class:"cm-content",style:`${ur.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(r["aria-readonly"]="true"),rB(this,HM,r);let n=this.observer.ignore(()=>{let i=AF(this.contentDOM,this.contentAttrs,r),s=AF(this.dom,this.editorAttrs,e);return i||s});return this.editorAttrs=e,this.contentAttrs=r,n}showAnnouncements(e){let r=!0;for(let n of e)for(let i of n.effects)if(i.is(Zt.announce)){r&&(this.announceDOM.textContent=""),r=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=i.value}}mountStyles(){this.styleModules=this.state.facet(mv);let e=this.state.facet(Zt.cspNonce);ff.mount(this.root,this.styleModules.concat(tSe).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let r=0;r<this.measureRequests.length;r++)if(this.measureRequests[r].key===e.key){this.measureRequests[r]=e;return}}this.measureRequests.push(e)}}plugin(e){let r=this.pluginMap.get(e);return(r===void 0||r&&r.plugin!=e)&&this.pluginMap.set(e,r=this.plugins.find(n=>n.plugin==e)||null),r&&r.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,r,n){return dj(this,e,LF(this,e,r,n))}moveByGroup(e,r){return dj(this,e,LF(this,e,r,n=>ywe(this,e.head,n)))}visualLineSide(e,r){let n=this.bidiSpans(e),i=this.textDirectionAt(e.from),s=n[r?n.length-1:0];return pt.cursor(s.side(r,i)+e.from,s.forward(!r,i)?1:-1)}moveToLineBoundary(e,r,n=!0){return gwe(this,e,r,n)}moveVertically(e,r,n){return dj(this,e,xwe(this,e,r,n))}domAtPos(e,r=1){return this.docView.domAtPos(e,r)}posAtDOM(e,r=0){return this.docView.posFromDOM(e,r)}posAtCoords(e,r=!0){this.readMeasured();let n=_E(this,e,r);return n&&n.pos}posAndSideAtCoords(e,r=!0){return this.readMeasured(),_E(this,e,r)}coordsAtPos(e,r=1){this.readMeasured();let n=this.docView.coordsAt(e,r);if(!n||n.left==n.right)return n;let i=this.state.doc.lineAt(e),s=this.bidiSpans(i),a=s[ch.find(s,e-i.from,-1,r)];return Bb(n,a.dir==ti.LTR==r>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(dq)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>oSe)return iq(e.length);let r=this.textDirectionAt(e.from),n;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==r&&(s.fresh||nq(s.isolates,n=MF(this,e))))return s.order;n||(n=MF(this,e));let i=W_e(e.text,r,n);return this.bidiCache.push(new $2(e.from,e.to,r,n,!0,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||ur.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{ZU(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,r={}){return Tw.of(new _y(typeof e=="number"?pt.cursor(e):e,r.y,r.x,r.yMargin,r.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:r}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return Tw.of(new _y(pt.cursor(n.from),"start","start",n.top-e,r,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Qi.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Qi.define(()=>({}),{eventObservers:e})}static theme(e,r){let n=ff.newName(),i=[zw.of(n),mv.of(CE(`.${n}`,e))];return r&&r.dark&&i.push(SE.of(!0)),i}static baseTheme(e){return wm.lowest(mv.of(CE("."+kE,e,Fq)))}static findFromDOM(e){var r;let n=e.querySelector(".cm-content"),i=n&&is.get(n)||is.get(e);return((r=i==null?void 0:i.root)===null||r===void 0?void 0:r.view)||null}}Zt.styleModule=mv;Zt.inputHandler=uq;Zt.clipboardInputFilter=qM;Zt.clipboardOutputFilter=QM;Zt.scrollHandler=pq;Zt.focusChangeEffect=hq;Zt.perLineTextDirection=dq;Zt.exceptionSink=cq;Zt.updateListener=xE;Zt.editable=ih;Zt.mouseSelectionStyle=lq;Zt.dragMovesSelection=aq;Zt.clickAddsSelectionRange=oq;Zt.decorations=pC;Zt.blockWrappers=yq;Zt.outerDecorations=GM;Zt.atomicRanges=B1;Zt.bidiIsolatedRanges=xq;Zt.scrollMargins=vq;Zt.darkTheme=SE;Zt.cspNonce=hr.define({combine:t=>t.length?t[0]:""});Zt.contentAttributes=HM;Zt.editorAttributes=gq;Zt.lineWrapping=Zt.contentAttributes.of({class:"cm-lineWrapping"});Zt.announce=Qr.define();const oSe=4096,tB={};class $2{constructor(e,r,n,i,s,a){this.from=e,this.to=r,this.dir=n,this.isolates=i,this.fresh=s,this.order=a}static update(e,r){if(r.empty&&!e.some(s=>s.fresh))return e;let n=[],i=e.length?e[e.length-1].dir:ti.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let a=e[s];a.dir==i&&!r.touchesRange(a.from,a.to)&&n.push(new $2(r.mapPos(a.from,1),r.mapPos(a.to,-1),a.dir,a.isolates,!1,a.order))}return n}}function rB(t,e,r){for(let n=t.state.facet(e),i=n.length-1;i>=0;i--){let s=n[i],a=typeof s=="function"?s(t):s;a&&VM(a,r)}return r}const aSe=ur.mac?"mac":ur.windows?"win":ur.linux?"linux":"key";function lSe(t,e){const r=t.split(/-(?!$)/);let n=r[r.length-1];n=="Space"&&(n=" ");let i,s,a,o;for(let d=0;d<r.length-1;++d){const m=r[d];if(/^(cmd|meta|m)$/i.test(m))o=!0;else if(/^a(lt)?$/i.test(m))i=!0;else if(/^(c|ctrl|control)$/i.test(m))s=!0;else if(/^s(hift)?$/i.test(m))a=!0;else if(/^mod$/i.test(m))e=="mac"?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+m)}return i&&(n="Alt-"+n),s&&(n="Ctrl-"+n),o&&(n="Meta-"+n),a&&(n="Shift-"+n),n}function Mw(t,e,r){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r!==!1&&e.shiftKey&&(t="Shift-"+t),t}const cSe=wm.default(Zt.domEventHandlers({keydown(t,e){return $q(Bq(e.state),t,e,"editor")}})),xC=hr.define({enables:cSe}),nB=new WeakMap;function Bq(t){let e=t.facet(xC),r=nB.get(e);return r||nB.set(e,r=dSe(e.reduce((n,i)=>n.concat(i),[]))),r}function uSe(t,e,r){return $q(Bq(t.state),e,t,r)}let Sd=null;const hSe=4e3;function dSe(t,e=aSe){let r=Object.create(null),n=Object.create(null),i=(a,o)=>{let d=n[a];if(d==null)n[a]=o;else if(d!=o)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},s=(a,o,d,m,y)=>{var v,w;let O=r[a]||(r[a]=Object.create(null)),P=o.split(/ (?!$)/).map(R=>lSe(R,e));for(let R=1;R<P.length;R++){let F=P.slice(0,R).join(" ");i(F,!0),O[F]||(O[F]={preventDefault:!0,stopPropagation:!1,run:[D=>{let U=Sd={view:D,prefix:F,scope:a};return setTimeout(()=>{Sd==U&&(Sd=null)},hSe),!0}]})}let E=P.join(" ");i(E,!1);let $=O[E]||(O[E]={preventDefault:!1,stopPropagation:!1,run:((w=(v=O._any)===null||v===void 0?void 0:v.run)===null||w===void 0?void 0:w.slice())||[]});d&&$.run.push(d),m&&($.preventDefault=!0),y&&($.stopPropagation=!0)};for(let a of t){let o=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let m of o){let y=r[m]||(r[m]=Object.create(null));y._any||(y._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:v}=a;for(let w in y)y[w].run.push(O=>v(O,TE))}let d=a[e]||a.key;if(d)for(let m of o)s(m,d,a.run,a.preventDefault,a.stopPropagation),a.shift&&s(m,"Shift-"+d,a.shift,a.preventDefault,a.stopPropagation)}return r}let TE=null;function $q(t,e,r,n){TE=e;let i=T_e(e),s=ma(i,0),a=au(s)==i.length&&i!=" ",o="",d=!1,m=!1,y=!1;Sd&&Sd.view==r&&Sd.scope==n&&(o=Sd.prefix+" ",jq.indexOf(e.keyCode)<0&&(m=!0,Sd=null));let v=new Set,w=$=>{if($){for(let R of $.run)if(!v.has(R)&&(v.add(R),R(r)))return $.stopPropagation&&(y=!0),!0;$.preventDefault&&($.stopPropagation&&(y=!0),m=!0)}return!1},O=t[n],P,E;return O&&(w(O[o+Mw(i,e,!a)])?d=!0:a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(ur.windows&&e.ctrlKey&&e.altKey)&&!(ur.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(P=pf[e.keyCode])&&P!=i?(w(O[o+Mw(P,e,!0)])||e.shiftKey&&(E=Lb[e.keyCode])!=i&&E!=P&&w(O[o+Mw(E,e,!1)]))&&(d=!0):a&&e.shiftKey&&w(O[o+Mw(i,e,!0)])&&(d=!0),!d&&w(O._any)&&(d=!0)),m&&(d=!0),d&&y&&e.stopPropagation(),TE=null,d}class $1{constructor(e,r,n,i,s){this.className=e,this.left=r,this.top=n,this.width=i,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,r){return r.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,r,n){if(n.empty){let i=e.coordsAtPos(n.head,n.assoc||1);if(!i)return[];let s=Nq(e);return[new $1(r,i.left-s.left,i.top-s.top,null,i.bottom-i.top)]}else return fSe(e,r,n)}}function Nq(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==ti.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function iB(t,e,r,n){let i=t.coordsAtPos(e,r*2);if(!i)return n;let s=t.dom.getBoundingClientRect(),a=(i.top+i.bottom)/2,o=t.posAtCoords({x:s.left+1,y:a}),d=t.posAtCoords({x:s.right-1,y:a});return o==null||d==null?n:{from:Math.max(n.from,Math.min(o,d)),to:Math.min(n.to,Math.max(o,d))}}function fSe(t,e,r){if(r.to<=t.viewport.from||r.from>=t.viewport.to)return[];let n=Math.max(r.from,t.viewport.from),i=Math.min(r.to,t.viewport.to),s=t.textDirection==ti.LTR,a=t.contentDOM,o=a.getBoundingClientRect(),d=Nq(t),m=a.querySelector(".cm-line"),y=m&&window.getComputedStyle(m),v=o.left+(y?parseInt(y.paddingLeft)+Math.min(0,parseInt(y.textIndent)):0),w=o.right-(y?parseInt(y.paddingRight):0),O=bE(t,n,1),P=bE(t,i,-1),E=O.type==oo.Text?O:null,$=P.type==oo.Text?P:null;if(E&&(t.lineWrapping||O.widgetLineBreaks)&&(E=iB(t,n,1,E)),$&&(t.lineWrapping||P.widgetLineBreaks)&&($=iB(t,i,-1,$)),E&&$&&E.from==$.from&&E.to==$.to)return F(D(r.from,r.to,E));{let X=E?D(r.from,null,E):U(O,!1),ee=$?D(null,r.to,$):U(P,!0),K=[];return(E||O).to<($||P).from-(E&&$?1:0)||O.widgetLineBreaks>1&&X.bottom+t.defaultLineHeight/2<ee.top?K.push(R(v,X.bottom,w,ee.top)):X.bottom<ee.top&&t.elementAtHeight((X.bottom+ee.top)/2).type==oo.Text&&(X.bottom=ee.top=(X.bottom+ee.top)/2),F(X).concat(K).concat(F(ee))}function R(X,ee,K,Y){return new $1(e,X-d.left,ee-d.top,Math.max(0,K-X),Y-ee)}function F({top:X,bottom:ee,horizontal:K}){let Y=[];for(let ne=0;ne<K.length;ne+=2)Y.push(R(K[ne],X,K[ne+1],ee));return Y}function D(X,ee,K){let Y=1e9,ne=-1e9,oe=[];function ce(We,Ye,tt,Be,Me){let Ge=t.coordsAtPos(We,We==K.to?-2:2),De=t.coordsAtPos(tt,tt==K.from?2:-2);!Ge||!De||(Y=Math.min(Ge.top,De.top,Y),ne=Math.max(Ge.bottom,De.bottom,ne),Me==ti.LTR?oe.push(s&&Ye?v:Ge.left,s&&Be?w:De.right):oe.push(!s&&Be?v:De.left,!s&&Ye?w:Ge.right))}let Xe=X??K.from,Ae=ee??K.to;for(let We of t.visibleRanges)if(We.to>Xe&&We.from<Ae)for(let Ye=Math.max(We.from,Xe),tt=Math.min(We.to,Ae);;){let Be=t.state.doc.lineAt(Ye);for(let Me of t.bidiSpans(Be)){let Ge=Me.from+Be.from,De=Me.to+Be.from;if(Ge>=tt)break;De>Ye&&ce(Math.max(Ge,Ye),X==null&&Ge<=Xe,Math.min(De,tt),ee==null&&De>=Ae,Me.dir)}if(Ye=Be.to+1,Ye>=tt)break}return oe.length==0&&ce(Xe,X==null,Ae,ee==null,t.textDirection),{top:Y,bottom:ne,horizontal:oe}}function U(X,ee){let K=o.top+(ee?X.top:X.bottom);return{top:K,bottom:K,horizontal:[]}}}function pSe(t,e){return t.constructor==e.constructor&&t.eq(e)}class mSe{constructor(e,r){this.view=e,this.layer=r,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),r.above&&this.dom.classList.add("cm-layer-above"),r.class&&this.dom.classList.add(r.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),r.mount&&r.mount(this.dom,e)}update(e){e.startState.facet(zS)!=e.state.facet(zS)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let r=0,n=e.facet(zS);for(;r<n.length&&n[r]!=this.layer;)r++;this.dom.style.zIndex=String((this.layer.above?150:-1)-r)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:r}=this.view;(e!=this.scaleX||r!=this.scaleY)&&(this.scaleX=e,this.scaleY=r,this.dom.style.transform=`scale(${1/e}, ${1/r})`)}draw(e){if(e.length!=this.drawn.length||e.some((r,n)=>!pSe(r,this.drawn[n]))){let r=this.dom.firstChild,n=0;for(let i of e)i.update&&r&&i.constructor&&this.drawn[n].constructor&&i.update(r,this.drawn[n])?(r=r.nextSibling,n++):this.dom.insertBefore(i.draw(),r);for(;r;){let i=r.nextSibling;r.remove(),r=i}this.drawn=e,ur.safari&&ur.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const zS=hr.define();function Vq(t){return[Qi.define(e=>new mSe(e,t)),zS.of(t)]}const Nb=hr.define({combine(t){return Cu(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,r)=>Math.min(e,r),drawRangeCursor:(e,r)=>e||r})}});function gSe(t={}){return[Nb.of(t),ySe,xSe,vSe,fq.of(!0)]}function Wq(t){return t.startState.facet(Nb)!=t.state.facet(Nb)}const ySe=Vq({above:!0,markers(t){let{state:e}=t,r=e.facet(Nb),n=[];for(let i of e.selection.ranges){let s=i==e.selection.main;if(i.empty||r.drawRangeCursor){let a=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",o=i.empty?i:pt.cursor(i.head,i.head>i.anchor?-1:1);for(let d of $1.forRange(t,a,o))n.push(d)}}return n},update(t,e){t.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let r=Wq(t);return r&&sB(t.state,e),t.docChanged||t.selectionSet||r},mount(t,e){sB(e.state,t)},class:"cm-cursorLayer"});function sB(t,e){e.style.animationDuration=t.facet(Nb).cursorBlinkRate+"ms"}const xSe=Vq({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:$1.forRange(t,"cm-selectionBackground",e)).reduce((e,r)=>e.concat(r))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||Wq(t)},class:"cm-selectionLayer"}),vSe=wm.highest(Zt.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),Uq=Qr.define({map(t,e){return t==null?null:e.mapPos(t)}}),xv=co.define({create(){return null},update(t,e){return t!=null&&(t=e.changes.mapPos(t)),e.effects.reduce((r,n)=>n.is(Uq)?n.value:r,t)}}),bSe=Qi.fromClass(class{constructor(t){this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(t){var e;let r=t.state.field(xv);r==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(t.startState.field(xv)!=r||t.docChanged||t.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:t}=this,e=t.state.field(xv),r=e!=null&&t.coordsAtPos(e);if(!r)return null;let n=t.scrollDOM.getBoundingClientRect();return{left:r.left-n.left+t.scrollDOM.scrollLeft*t.scaleX,top:r.top-n.top+t.scrollDOM.scrollTop*t.scaleY,height:r.bottom-r.top}}drawCursor(t){if(this.cursor){let{scaleX:e,scaleY:r}=this.view;t?(this.cursor.style.left=t.left/e+"px",this.cursor.style.top=t.top/r+"px",this.cursor.style.height=t.height/r+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(t){this.view.state.field(xv)!=t&&this.view.dispatch({effects:Uq.of(t)})}},{eventObservers:{dragover(t){this.setDropPos(this.view.posAtCoords({x:t.clientX,y:t.clientY}))},dragleave(t){(t.target==this.view.contentDOM||!this.view.contentDOM.contains(t.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function _Se(){return[xv,bSe]}function oB(t,e,r,n,i){e.lastIndex=0;for(let s=t.iterRange(r,n),a=r,o;!s.next().done;a+=s.value.length)if(!s.lineBreak)for(;o=e.exec(s.value);)i(a+o.index,o)}function wSe(t,e){let r=t.visibleRanges;if(r.length==1&&r[0].from==t.viewport.from&&r[0].to==t.viewport.to)return r;let n=[];for(let{from:i,to:s}of r)i=Math.max(t.state.doc.lineAt(i).from,i-e),s=Math.min(t.state.doc.lineAt(s).to,s+e),n.length&&n[n.length-1].to>=i?n[n.length-1].to=s:n.push({from:i,to:s});return n}class SSe{constructor(e){const{regexp:r,decoration:n,decorate:i,boundary:s,maxLength:a=1e3}=e;if(!r.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=r,i)this.addMatch=(o,d,m,y)=>i(y,m,m+o[0].length,o,d);else if(typeof n=="function")this.addMatch=(o,d,m,y)=>{let v=n(o,d,m);v&&y(m,m+o[0].length,v)};else if(n)this.addMatch=(o,d,m,y)=>y(m,m+o[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=a}createDeco(e){let r=new kh,n=r.add.bind(r);for(let{from:i,to:s}of wSe(e,this.maxLength))oB(e.state.doc,this.regexp,i,s,(a,o)=>this.addMatch(o,e,a,n));return r.finish()}updateDeco(e,r){let n=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((s,a,o,d)=>{d>=e.view.viewport.from&&o<=e.view.viewport.to&&(n=Math.min(o,n),i=Math.max(d,i))}),e.viewportMoved||i-n>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,r.map(e.changes),n,i):r}updateRange(e,r,n,i){for(let s of e.visibleRanges){let a=Math.max(s.from,n),o=Math.min(s.to,i);if(o>=a){let d=e.state.doc.lineAt(a),m=d.to<o?e.state.doc.lineAt(o):d,y=Math.max(s.from,d.from),v=Math.min(s.to,m.to);if(this.boundary){for(;a>d.from;a--)if(this.boundary.test(d.text[a-1-d.from])){y=a;break}for(;o<m.to;o++)if(this.boundary.test(m.text[o-m.from])){v=o;break}}let w=[],O,P=(E,$,R)=>w.push(R.range(E,$));if(d==m)for(this.regexp.lastIndex=y-d.from;(O=this.regexp.exec(d.text))&&O.index<v-d.from;)this.addMatch(O,e,O.index+d.from,P);else oB(e.state.doc,this.regexp,y,v,(E,$)=>this.addMatch($,e,E,P));r=r.update({filterFrom:y,filterTo:v,filter:(E,$)=>E<y||$>v,add:w})}}return r}}const OE=/x/.unicode!=null?"gu":"g",kSe=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,OE),CSe={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let mj=null;function TSe(){var t;if(mj==null&&typeof document<"u"&&document.body){let e=document.body.style;mj=((t=e.tabSize)!==null&&t!==void 0?t:e.MozTabSize)!=null}return mj||!1}const MS=hr.define({combine(t){let e=Cu(t,{render:null,specialChars:kSe,addSpecialChars:null});return(e.replaceTabs=!TSe())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,OE)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,OE)),e}});function OSe(t={}){return[MS.of(t),jSe()]}let aB=null;function jSe(){return aB||(aB=Qi.fromClass(class{constructor(t){this.view=t,this.decorations=jr.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(MS)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new SSe({regexp:t.specialChars,decoration:(e,r,n)=>{let{doc:i}=r.state,s=ma(e[0],0);if(s==9){let a=i.lineAt(n),o=r.state.tabSize,d=C0(a.text,o,n-a.from);return jr.replace({widget:new zSe((o-d%o)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=jr.replace({widget:new ESe(t,s)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(MS);t.startState.facet(MS)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))}const PSe="";function ASe(t){return t>=32?PSe:t==10?"":String.fromCharCode(9216+t)}class ESe extends Tu{constructor(e,r){super(),this.options=e,this.code=r}eq(e){return e.code==this.code}toDOM(e){let r=ASe(this.code),n=e.state.phrase("Control character")+" "+(CSe[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,n,r);if(i)return i;let s=document.createElement("span");return s.textContent=r,s.title=n,s.setAttribute("aria-label",n),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class zSe extends Tu{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function MSe(){return RSe}const ISe=jr.line({class:"cm-activeLine"}),RSe=Qi.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,r=[];for(let n of t.state.selection.ranges){let i=t.lineBlockAt(n.head);i.from>e&&(r.push(ISe.range(i.from)),e=i.from)}return jr.set(r)}},{decorations:t=>t.decorations});class DSe extends Tu{constructor(e){super(),this.content=e}toDOM(e){let r=document.createElement("span");return r.className="cm-placeholder",r.style.pointerEvents="none",r.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),r.setAttribute("aria-hidden","true"),r}coordsAt(e){let r=e.firstChild?Qv(e.firstChild):[];if(!r.length)return null;let n=window.getComputedStyle(e.parentNode),i=Bb(r[0],n.direction!="rtl"),s=parseInt(n.lineHeight);return i.bottom-i.top>s*1.5?{left:i.left,right:i.right,top:i.top,bottom:i.top+s}:i}ignoreEvent(){return!1}}function LSe(t){let e=Qi.fromClass(class{constructor(r){this.view=r,this.placeholder=t?jr.set([jr.widget({widget:new DSe(t),side:1}).range(0)]):jr.none}get decorations(){return this.view.state.doc.length?jr.none:this.placeholder}},{decorations:r=>r.decorations});return typeof t=="string"?[e,Zt.contentAttributes.of({"aria-placeholder":t})]:e}const jE=2e3;function FSe(t,e,r){let n=Math.min(e.line,r.line),i=Math.max(e.line,r.line),s=[];if(e.off>jE||r.off>jE||e.col<0||r.col<0){let a=Math.min(e.off,r.off),o=Math.max(e.off,r.off);for(let d=n;d<=i;d++){let m=t.doc.line(d);m.length<=o&&s.push(pt.range(m.from+a,m.to+o))}}else{let a=Math.min(e.col,r.col),o=Math.max(e.col,r.col);for(let d=n;d<=i;d++){let m=t.doc.line(d),y=aE(m.text,a,t.tabSize,!0);if(y<0)s.push(pt.cursor(m.to));else{let v=aE(m.text,o,t.tabSize);s.push(pt.range(m.from+y,m.from+v))}}}return s}function BSe(t,e){let r=t.coordsAtPos(t.viewport.from);return r?Math.round(Math.abs((r.left-e)/t.defaultCharacterWidth)):-1}function lB(t,e){let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1),n=t.state.doc.lineAt(r),i=r-n.from,s=i>jE?-1:i==n.length?BSe(t,e.clientX):C0(n.text,t.state.tabSize,r-n.from);return{line:n.number,col:s,off:i}}function $Se(t,e){let r=lB(t,e),n=t.state.selection;return r?{update(i){if(i.docChanged){let s=i.changes.mapPos(i.startState.doc.line(r.line).from),a=i.state.doc.lineAt(s);r={line:a.number,col:r.col,off:Math.min(r.off,a.length)},n=n.map(i.changes)}},get(i,s,a){let o=lB(t,i);if(!o)return n;let d=FSe(t.state,r,o);return d.length?a?pt.create(d.concat(n.ranges)):pt.create(d):n}}:null}function NSe(t){let e=r=>r.altKey&&r.button==0;return Zt.mouseSelectionStyle.of((r,n)=>e(n)?$Se(r,n):null)}const VSe={Alt:[18,t=>!!t.altKey],Control:[17,t=>!!t.ctrlKey],Shift:[16,t=>!!t.shiftKey],Meta:[91,t=>!!t.metaKey]},WSe={style:"cursor: crosshair"};function USe(t={}){let[e,r]=VSe[t.key||"Alt"],n=Qi.fromClass(class{constructor(i){this.view=i,this.isDown=!1}set(i){this.isDown!=i&&(this.isDown=i,this.view.update([]))}},{eventObservers:{keydown(i){this.set(i.keyCode==e||r(i))},keyup(i){(i.keyCode==e||!r(i))&&this.set(!1)},mousemove(i){this.set(r(i))}}});return[n,Zt.contentAttributes.of(i=>{var s;return!((s=i.plugin(n))===null||s===void 0)&&s.isDown?WSe:null})]}const Iw="-10000px";class qq{constructor(e,r,n,i){this.facet=r,this.createTooltipView=n,this.removeTooltipView=i,this.input=e.state.facet(r),this.tooltips=this.input.filter(a=>a);let s=null;this.tooltipViews=this.tooltips.map(a=>s=n(a,s))}update(e,r){var n;let i=e.state.facet(this.facet),s=i.filter(d=>d);if(i===this.input){for(let d of this.tooltipViews)d.update&&d.update(e);return!1}let a=[],o=r?[]:null;for(let d=0;d<s.length;d++){let m=s[d],y=-1;if(m){for(let v=0;v<this.tooltips.length;v++){let w=this.tooltips[v];w&&w.create==m.create&&(y=v)}if(y<0)a[d]=this.createTooltipView(m,d?a[d-1]:null),o&&(o[d]=!!m.above);else{let v=a[d]=this.tooltipViews[y];o&&(o[d]=r[y]),v.update&&v.update(e)}}}for(let d of this.tooltipViews)a.indexOf(d)<0&&(this.removeTooltipView(d),(n=d.destroy)===null||n===void 0||n.call(d));return r&&(o.forEach((d,m)=>r[m]=d),r.length=o.length),this.input=i,this.tooltips=s,this.tooltipViews=a,!0}}function qSe(t){let e=t.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const gj=hr.define({combine:t=>{var e,r,n;return{position:ur.ios?"absolute":((e=t.find(i=>i.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((r=t.find(i=>i.parent))===null||r===void 0?void 0:r.parent)||null,tooltipSpace:((n=t.find(i=>i.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||qSe}}}),cB=new WeakMap,JM=Qi.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(gj);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new qq(t,eI,(r,n)=>this.createTooltip(r,n),r=>{this.resizeObserver&&this.resizeObserver.unobserve(r.dom),r.dom.remove()}),this.above=this.manager.tooltips.map(r=>!!r.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(r=>{Date.now()>this.lastTransaction-50&&r.length>0&&r[r.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let r=e||t.geometryChanged,n=t.state.facet(gj);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let i of this.manager.tooltipViews)i.dom.style.position=this.position;r=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let i of this.manager.tooltipViews)this.container.appendChild(i.dom);r=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);r&&this.maybeMeasure()}createTooltip(t,e){let r=t.create(this.view),n=e?e.dom:null;if(r.dom.classList.add("cm-tooltip"),t.arrow&&!r.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let i=document.createElement("div");i.className="cm-tooltip-arrow",r.dom.appendChild(i)}return r.dom.style.position=this.position,r.dom.style.top=Iw,r.dom.style.left="0px",this.container.insertBefore(r.dom,n),r.mount&&r.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(r.dom),r}destroy(){var t,e,r;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(t=n.destroy)===null||t===void 0||t.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(r=this.intersectionObserver)===null||r===void 0||r.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=1,e=1,r=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(ur.safari){let a=s.getBoundingClientRect();r=Math.abs(a.top+1e4)>1||Math.abs(a.left)>1}else r=!!s.offsetParent&&s.offsetParent!=this.container.ownerDocument.body}if(r||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(t=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),i=XM(this.view);return{visible:{left:n.left+i.left,top:n.top+i.top,right:n.right-i.right,bottom:n.bottom-i.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,a)=>{let o=this.manager.tooltipViews[a];return o.getCoords?o.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(gj).tooltipSpace(this.view),scaleX:t,scaleY:e,makeAbsolute:r}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let o of this.manager.tooltipViews)o.dom.style.position="absolute"}let{visible:r,space:n,scaleX:i,scaleY:s}=t,a=[];for(let o=0;o<this.manager.tooltips.length;o++){let d=this.manager.tooltips[o],m=this.manager.tooltipViews[o],{dom:y}=m,v=t.pos[o],w=t.size[o];if(!v||d.clip!==!1&&(v.bottom<=Math.max(r.top,n.top)||v.top>=Math.min(r.bottom,n.bottom)||v.right<Math.max(r.left,n.left)-.1||v.left>Math.min(r.right,n.right)+.1)){y.style.top=Iw;continue}let O=d.arrow?m.dom.querySelector(".cm-tooltip-arrow"):null,P=O?7:0,E=w.right-w.left,$=(e=cB.get(m))!==null&&e!==void 0?e:w.bottom-w.top,R=m.offset||HSe,F=this.view.textDirection==ti.LTR,D=w.width>n.right-n.left?F?n.left:n.right-w.width:F?Math.max(n.left,Math.min(v.left-(O?14:0)+R.x,n.right-E)):Math.min(Math.max(n.left,v.left-E+(O?14:0)-R.x),n.right-E),U=this.above[o];!d.strictSide&&(U?v.top-$-P-R.y<n.top:v.bottom+$+P+R.y>n.bottom)&&U==n.bottom-v.bottom>v.top-n.top&&(U=this.above[o]=!U);let X=(U?v.top-n.top:n.bottom-v.bottom)-P;if(X<$&&m.resize!==!1){if(X<this.view.defaultLineHeight){y.style.top=Iw;continue}cB.set(m,$),y.style.height=($=X)/s+"px"}else y.style.height&&(y.style.height="");let ee=U?v.top-$-P-R.y:v.bottom+P+R.y,K=D+E;if(m.overlap!==!0)for(let Y of a)Y.left<K&&Y.right>D&&Y.top<ee+$&&Y.bottom>ee&&(ee=U?Y.top-$-2-P:Y.bottom+P+2);if(this.position=="absolute"?(y.style.top=(ee-t.parent.top)/s+"px",uB(y,(D-t.parent.left)/i)):(y.style.top=ee/s+"px",uB(y,D/i)),O){let Y=v.left+(F?R.x:-R.x)-(D+14-7);O.style.left=Y/i+"px"}m.overlap!==!0&&a.push({left:D,top:ee,right:K,bottom:ee+$}),y.classList.toggle("cm-tooltip-above",U),y.classList.toggle("cm-tooltip-below",!U),m.positioned&&m.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=Iw}},{eventObservers:{scroll(){this.maybeMeasure()}}});function uB(t,e){let r=parseInt(t.style.left,10);(isNaN(r)||Math.abs(e-r)>1)&&(t.style.left=e+"px")}const QSe=Zt.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),HSe={x:0,y:0},eI=hr.define({enables:[JM,QSe]}),N2=hr.define({combine:t=>t.reduce((e,r)=>e.concat(r),[])});class vC{static create(e){return new vC(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new qq(e,N2,(r,n)=>this.createHostedView(r,n),r=>r.dom.remove())}createHostedView(e,r){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,r?r.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let r of this.manager.tooltipViews)r.mount&&r.mount(e);this.mounted=!0}positioned(e){for(let r of this.manager.tooltipViews)r.positioned&&r.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let r of this.manager.tooltipViews)(e=r.destroy)===null||e===void 0||e.call(r)}passProp(e){let r;for(let n of this.manager.tooltipViews){let i=n[e];if(i!==void 0){if(r===void 0)r=i;else if(r!==i)return}}return r}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const GSe=eI.compute([N2],t=>{let e=t.facet(N2);return e.length===0?null:{pos:Math.min(...e.map(r=>r.pos)),end:Math.max(...e.map(r=>{var n;return(n=r.end)!==null&&n!==void 0?n:r.pos})),create:vC.create,above:e[0].above,arrow:e.some(r=>r.arrow)}});class XSe{constructor(e,r,n,i,s){this.view=e,this.source=r,this.field=n,this.setHover=i,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:r}=this,n=e.docView.tile.nearest(r.target);if(!n)return;let i,s=1;if(n.isWidget())i=n.posAtStart;else{if(i=e.posAtCoords(r),i==null)return;let o=e.coordsAtPos(i);if(!o||r.y<o.top||r.y>o.bottom||r.x<o.left-e.defaultCharacterWidth||r.x>o.right+e.defaultCharacterWidth)return;let d=e.bidiSpans(e.state.doc.lineAt(i)).find(y=>y.from<=i&&y.to>=i),m=d&&d.dir==ti.RTL?-1:1;s=r.x<o.left?-m:m}let a=this.source(e,i,s);if(a!=null&&a.then){let o=this.pending={pos:i};a.then(d=>{this.pending==o&&(this.pending=null,d&&!(Array.isArray(d)&&!d.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(d)?d:[d])}))},d=>wa(e.state,d,"hover tooltip"))}else a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])})}get tooltip(){let e=this.view.plugin(JM),r=e?e.manager.tooltips.findIndex(n=>n.create==vC.create):-1;return r>-1?e.manager.tooltipViews[r]:null}mousemove(e){var r,n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:i,tooltip:s}=this;if(i.length&&s&&!KSe(s.dom,e)||this.pending){let{pos:a}=i[0]||this.pending,o=(n=(r=i[0])===null||r===void 0?void 0:r.end)!==null&&n!==void 0?n:a;(a==o?this.view.posAtCoords(this.lastMove)!=a:!ZSe(this.view,a,o,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:r}=this;if(r.length){let{tooltip:n}=this;n&&n.dom.contains(e.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let r=n=>{e.removeEventListener("mouseleave",r),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",r)}destroy(){clearTimeout(this.hoverTimeout),clearTimeout(this.restartTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Rw=4;function KSe(t,e){let{left:r,right:n,top:i,bottom:s}=t.getBoundingClientRect(),a;if(a=t.querySelector(".cm-tooltip-arrow")){let o=a.getBoundingClientRect();i=Math.min(o.top,i),s=Math.max(o.bottom,s)}return e.clientX>=r-Rw&&e.clientX<=n+Rw&&e.clientY>=i-Rw&&e.clientY<=s+Rw}function ZSe(t,e,r,n,i,s){let a=t.scrollDOM.getBoundingClientRect(),o=t.documentTop+t.documentPadding.top+t.contentHeight;if(a.left>n||a.right<n||a.top>i||Math.min(a.bottom,o)<i)return!1;let d=t.posAtCoords({x:n,y:i},!1);return d>=e&&d<=r}function YSe(t,e={}){let r=Qr.define(),n=co.define({create(){return[]},update(i,s){if(i.length&&(e.hideOnChange&&(s.docChanged||s.selection)?i=[]:e.hideOn&&(i=i.filter(a=>!e.hideOn(s,a))),s.docChanged)){let a=[];for(let o of i){let d=s.changes.mapPos(o.pos,-1,Uo.TrackDel);if(d!=null){let m=Object.assign(Object.create(null),o);m.pos=d,m.end!=null&&(m.end=s.changes.mapPos(m.end)),a.push(m)}}i=a}for(let a of s.effects)a.is(r)&&(i=a.value),a.is(JSe)&&(i=[]);return i},provide:i=>N2.from(i)});return{active:n,extension:[n,Qi.define(i=>new XSe(i,t,n,r,e.hoverTime||300)),GSe]}}function Qq(t,e){let r=t.plugin(JM);if(!r)return null;let n=r.manager.tooltips.indexOf(e);return n<0?null:r.manager.tooltipViews[n]}const JSe=Qr.define(),hB=hr.define({combine(t){let e,r;for(let n of t)e=e||n.topContainer,r=r||n.bottomContainer;return{topContainer:e,bottomContainer:r}}});function tI(t,e){let r=t.plugin(Hq),n=r?r.specs.indexOf(e):-1;return n>-1?r.panels[n]:null}const Hq=Qi.fromClass(class{constructor(t){this.input=t.state.facet(Vb),this.specs=this.input.filter(r=>r),this.panels=this.specs.map(r=>r(t));let e=t.state.facet(hB);this.top=new Dw(t,!0,e.topContainer),this.bottom=new Dw(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(r=>r.top)),this.bottom.sync(this.panels.filter(r=>!r.top));for(let r of this.panels)r.dom.classList.add("cm-panel"),r.mount&&r.mount()}update(t){let e=t.state.facet(hB);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Dw(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Dw(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let r=t.state.facet(Vb);if(r!=this.input){let n=r.filter(d=>d),i=[],s=[],a=[],o=[];for(let d of n){let m=this.specs.indexOf(d),y;m<0?(y=d(t.view),o.push(y)):(y=this.panels[m],y.update&&y.update(t)),i.push(y),(y.top?s:a).push(y)}this.specs=n,this.panels=i,this.top.sync(s),this.bottom.sync(a);for(let d of o)d.dom.classList.add("cm-panel"),d.mount&&d.mount()}else for(let n of this.panels)n.update&&n.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>Zt.scrollMargins.of(e=>{let r=e.plugin(t);return r&&{top:r.top.scrollMargin(),bottom:r.bottom.scrollMargin()}})});class Dw{constructor(e,r,n){this.view=e,this.top=r,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let r of this.panels)r.destroy&&e.indexOf(r)<0&&r.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let r=this.container||this.view.dom;r.insertBefore(this.dom,this.top?r.firstChild:null)}let e=this.dom.firstChild;for(let r of this.panels)if(r.dom.parentNode==this.dom){for(;e!=r.dom;)e=dB(e);e=e.nextSibling}else this.dom.insertBefore(r.dom,e);for(;e;)e=dB(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function dB(t){let e=t.nextSibling;return t.remove(),e}const Vb=hr.define({enables:Hq});function e2e(t,e){let r,n=new Promise(a=>r=a),i=a=>t2e(a,e,r);t.state.field(yj,!1)?t.dispatch({effects:Gq.of(i)}):t.dispatch({effects:Qr.appendConfig.of(yj.init(()=>[i]))});let s=Xq.of(i);return{close:s,result:n.then(a=>((t.win.queueMicrotask||(d=>t.win.setTimeout(d,10)))(()=>{t.state.field(yj).indexOf(i)>-1&&t.dispatch({effects:s})}),a))}}const yj=co.define({create(){return[]},update(t,e){for(let r of e.effects)r.is(Gq)?t=[r.value].concat(t):r.is(Xq)&&(t=t.filter(n=>n!=r.value));return t},provide:t=>Vb.computeN([t],e=>e.field(t))}),Gq=Qr.define(),Xq=Qr.define();function t2e(t,e,r){let n=e.content?e.content(t,()=>a(null)):null;if(!n){if(n=Kn("form"),e.input){let o=Kn("input",e.input);/^(text|password|number|email|tel|url)$/.test(o.type)&&o.classList.add("cm-textfield"),o.name||(o.name="input"),n.appendChild(Kn("label",(e.label||"")+": ",o))}else n.appendChild(document.createTextNode(e.label||""));n.appendChild(document.createTextNode(" ")),n.appendChild(Kn("button",{class:"cm-button",type:"submit"},e.submitLabel||"OK"))}let i=n.nodeName=="FORM"?[n]:n.querySelectorAll("form");for(let o=0;o<i.length;o++){let d=i[o];d.addEventListener("keydown",m=>{m.keyCode==27?(m.preventDefault(),a(null)):m.keyCode==13&&(m.preventDefault(),a(d))}),d.addEventListener("submit",m=>{m.preventDefault(),a(d)})}let s=Kn("div",n,Kn("button",{onclick:()=>a(null),"aria-label":t.state.phrase("close"),class:"cm-dialog-close",type:"button"},[""]));e.class&&(s.className=e.class),s.classList.add("cm-dialog");function a(o){s.contains(s.ownerDocument.activeElement)&&t.focus(),r(o)}return{dom:s,top:e.top,mount:()=>{if(e.focus){let o;typeof e.focus=="string"?o=n.querySelector(e.focus):o=n.querySelector("input")||n.querySelector("button"),o&&"select"in o?o.select():o&&"focus"in o&&o.focus()}}}}class Th extends df{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Th.prototype.elementClass="";Th.prototype.toDOM=void 0;Th.prototype.mapMode=Uo.TrackBefore;Th.prototype.startSide=Th.prototype.endSide=-1;Th.prototype.point=!0;const IS=hr.define(),r2e=hr.define(),n2e={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>sn.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},Xv=hr.define();function i2e(t){return[Kq(),Xv.of({...n2e,...t})]}const fB=hr.define({combine:t=>t.some(e=>e)});function Kq(t){return[s2e]}const s2e=Qi.fromClass(class{constructor(t){this.view=t,this.domAfter=null,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(Xv).map(e=>new mB(t,e)),this.fixed=!t.state.facet(fB);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(t){if(this.updateGutters(t)){let e=this.prevViewport,r=t.view.viewport,n=Math.min(e.to,r.to)-Math.max(e.from,r.from);this.syncGutters(n<(r.to-r.from)*.8)}if(t.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(fB)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let r=sn.iter(this.view.state.facet(IS),this.view.viewport.from),n=[],i=this.gutters.map(s=>new o2e(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(s.type)){let a=!0;for(let o of s.type)if(o.type==oo.Text&&a){PE(r,n,o.from);for(let d of i)d.line(this.view,o,n);a=!1}else if(o.widget)for(let d of i)d.widget(this.view,o)}else if(s.type==oo.Text){PE(r,n,s.from);for(let a of i)a.line(this.view,s,n)}else if(s.widget)for(let a of i)a.widget(this.view,s);for(let s of i)s.finish();t&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(t){let e=t.startState.facet(Xv),r=t.state.facet(Xv),n=t.docChanged||t.heightChanged||t.viewportChanged||!sn.eq(t.startState.facet(IS),t.state.facet(IS),t.view.viewport.from,t.view.viewport.to);if(e==r)for(let i of this.gutters)i.update(t)&&(n=!0);else{n=!0;let i=[];for(let s of r){let a=e.indexOf(s);a<0?i.push(new mB(this.view,s)):(this.gutters[a].update(t),i.push(this.gutters[a]))}for(let s of this.gutters)s.dom.remove(),i.indexOf(s)<0&&s.destroy();for(let s of i)s.config.side=="after"?this.getDOMAfter().appendChild(s.dom):this.dom.appendChild(s.dom);this.gutters=i}return n}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:t=>Zt.scrollMargins.of(e=>{let r=e.plugin(t);if(!r||r.gutters.length==0||!r.fixed)return null;let n=r.dom.offsetWidth*e.scaleX,i=r.domAfter?r.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==ti.LTR?{left:n,right:i}:{right:n,left:i}})});function pB(t){return Array.isArray(t)?t:[t]}function PE(t,e,r){for(;t.value&&t.from<=r;)t.from==r&&e.push(t.value),t.next()}class o2e{constructor(e,r,n){this.gutter=e,this.height=n,this.i=0,this.cursor=sn.iter(e.markers,r.from)}addElement(e,r,n){let{gutter:i}=this,s=(r.top-this.height)/e.scaleY,a=r.height/e.scaleY;if(this.i==i.elements.length){let o=new Zq(e,a,s,n);i.elements.push(o),i.dom.appendChild(o.dom)}else i.elements[this.i].update(e,a,s,n);this.height=r.bottom,this.i++}line(e,r,n){let i=[];PE(this.cursor,i,r.from),n.length&&(i=i.concat(n));let s=this.gutter.config.lineMarker(e,r,i);s&&i.unshift(s);let a=this.gutter;i.length==0&&!a.config.renderEmptyElements||this.addElement(e,r,i)}widget(e,r){let n=this.gutter.config.widgetMarker(e,r.widget,r),i=n?[n]:null;for(let s of e.state.facet(r2e)){let a=s(e,r.widget,r);a&&(i||(i=[])).push(a)}i&&this.addElement(e,r,i)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let r=e.elements.pop();e.dom.removeChild(r.dom),r.destroy()}}}class mB{constructor(e,r){this.view=e,this.config=r,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in r.domEventHandlers)this.dom.addEventListener(n,i=>{let s=i.target,a;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let d=s.getBoundingClientRect();a=(d.top+d.bottom)/2}else a=i.clientY;let o=e.lineBlockAtHeight(a-e.documentTop);r.domEventHandlers[n](e,o,i)&&i.preventDefault()});this.markers=pB(r.markers(e)),r.initialSpacer&&(this.spacer=new Zq(e,0,0,[r.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let r=this.markers;if(this.markers=pB(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let i=this.config.updateSpacer(this.spacer.markers[0],e);i!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[i])}let n=e.view.viewport;return!sn.eq(this.markers,r,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class Zq{constructor(e,r,n,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,r,n,i)}update(e,r,n,i){this.height!=r&&(this.height=r,this.dom.style.height=r+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),a2e(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,r){let n="cm-gutterElement",i=this.dom.firstChild;for(let s=0,a=0;;){let o=a,d=s<r.length?r[s++]:null,m=!1;if(d){let y=d.elementClass;y&&(n+=" "+y);for(let v=a;v<this.markers.length;v++)if(this.markers[v].compare(d)){o=v,m=!0;break}}else o=this.markers.length;for(;a<o;){let y=this.markers[a++];if(y.toDOM){y.destroy(i);let v=i.nextSibling;i.remove(),i=v}}if(!d)break;d.toDOM&&(m?i=i.nextSibling:this.dom.insertBefore(d.toDOM(e),i)),m&&a++}this.dom.className=n,this.markers=r}destroy(){this.setMarkers(null,[])}}function a2e(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].compare(e[r]))return!1;return!0}const l2e=hr.define(),c2e=hr.define(),Zg=hr.define({combine(t){return Cu(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,r){let n=Object.assign({},e);for(let i in r){let s=n[i],a=r[i];n[i]=s?(o,d,m)=>s(o,d,m)||a(o,d,m):a}return n}})}});class xj extends Th{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function vj(t,e){return t.state.facet(Zg).formatNumber(e,t.state)}const u2e=Xv.compute([Zg],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(l2e)},lineMarker(e,r,n){return n.some(i=>i.toDOM)?null:new xj(vj(e,e.state.doc.lineAt(r.from).number))},widgetMarker:(e,r,n)=>{for(let i of e.state.facet(c2e)){let s=i(e,r,n);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(Zg)!=e.state.facet(Zg),initialSpacer(e){return new xj(vj(e,gB(e.state.doc.lines)))},updateSpacer(e,r){let n=vj(r.view,gB(r.view.state.doc.lines));return n==e.number?e:new xj(n)},domEventHandlers:t.facet(Zg).domEventHandlers,side:"before"}));function h2e(t={}){return[Zg.of(t),Kq(),u2e]}function gB(t){let e=9;for(;e<t;)e=e*10+9;return e}const d2e=new class extends Th{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},f2e=IS.compute(["selection"],t=>{let e=[],r=-1;for(let n of t.selection.ranges){let i=t.doc.lineAt(n.head).from;i>r&&(r=i,e.push(d2e.range(i)))}return sn.of(e)});function p2e(){return f2e}const Yq=1024;let m2e=0;class bj{constructor(e,r){this.from=e,this.to=r}}class nn{constructor(e={}){this.id=m2e++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=za.match(e)),r=>{let n=e(r);return n===void 0?null:[this,n]}}}nn.closedBy=new nn({deserialize:t=>t.split(" ")});nn.openedBy=new nn({deserialize:t=>t.split(" ")});nn.group=new nn({deserialize:t=>t.split(" ")});nn.isolate=new nn({deserialize:t=>{if(t&&t!="rtl"&&t!="ltr"&&t!="auto")throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}});nn.contextHash=new nn({perNode:!0});nn.lookAhead=new nn({perNode:!0});nn.mounted=new nn({perNode:!0});class Kv{constructor(e,r,n,i=!1){this.tree=e,this.overlay=r,this.parser=n,this.bracketed=i}static get(e){return e&&e.props&&e.props[nn.mounted.id]}}const g2e=Object.create(null);class za{constructor(e,r,n,i=0){this.name=e,this.props=r,this.id=n,this.flags=i}static define(e){let r=e.props&&e.props.length?Object.create(null):g2e,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new za(e.name||"",r,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");r[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let r=this.prop(nn.group);return r?r.indexOf(e)>-1:!1}return this.id==e}static match(e){let r=Object.create(null);for(let n in e)for(let i of n.split(" "))r[i]=e[n];return n=>{for(let i=n.prop(nn.group),s=-1;s<(i?i.length:0);s++){let a=r[s<0?n.name:i[s]];if(a)return a}}}}za.none=new za("",Object.create(null),0,8);class rI{constructor(e){this.types=e;for(let r=0;r<e.length;r++)if(e[r].id!=r)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let r=[];for(let n of this.types){let i=null;for(let s of e){let a=s(n);if(a){i||(i=Object.assign({},n.props));let o=a[1],d=a[0];d.combine&&d.id in i&&(o=d.combine(i[d.id],o)),i[d.id]=o}}r.push(i?new za(n.name,i,n.id,n.flags):n)}return new rI(r)}}const Lw=new WeakMap,yB=new WeakMap;var Ci;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays",t[t.EnterBracketed=16]="EnterBracketed"})(Ci||(Ci={}));class qi{constructor(e,r,n,i,s){if(this.type=e,this.children=r,this.positions=n,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[a,o]of s)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=Kv.get(this);if(e&&!e.overlay)return e.tree.toString();let r="";for(let n of this.children){let i=n.toString();i&&(r&&(r+=","),r+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(r.length?"("+r+")":""):r}cursor(e=0){return new EE(this.topNode,e)}cursorAt(e,r=0,n=0){let i=Lw.get(this)||this.topNode,s=new EE(i);return s.moveTo(e,r),Lw.set(this,s._tree),s}get topNode(){return new Pa(this,0,0,null)}resolve(e,r=0){let n=Wb(Lw.get(this)||this.topNode,e,r,!1);return Lw.set(this,n),n}resolveInner(e,r=0){let n=Wb(yB.get(this)||this.topNode,e,r,!0);return yB.set(this,n),n}resolveStack(e,r=0){return v2e(this,e,r)}iterate(e){let{enter:r,leave:n,from:i=0,to:s=this.length}=e,a=e.mode||0,o=(a&Ci.IncludeAnonymous)>0;for(let d=this.cursor(a|Ci.IncludeAnonymous);;){let m=!1;if(d.from<=s&&d.to>=i&&(!o&&d.type.isAnonymous||r(d)!==!1)){if(d.firstChild())continue;m=!0}for(;m&&n&&(o||!d.type.isAnonymous)&&n(d),!d.nextSibling();){if(!d.parent())return;m=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let r in this.props)e.push([+r,this.props[r]]);return e}balance(e={}){return this.children.length<=8?this:sI(za.none,this.children,this.positions,0,this.children.length,0,this.length,(r,n,i)=>new qi(this.type,r,n,i,this.propValues),e.makeTree||((r,n,i)=>new qi(za.none,r,n,i)))}static build(e){return b2e(e)}}qi.empty=new qi(za.none,[],[],0);class nI{constructor(e,r){this.buffer=e,this.index=r}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new nI(this.buffer,this.index)}}class gf{constructor(e,r,n){this.buffer=e,this.length=r,this.set=n}get type(){return za.none}toString(){let e=[];for(let r=0;r<this.buffer.length;)e.push(this.childString(r)),r=this.buffer[r+3];return e.join(",")}childString(e){let r=this.buffer[e],n=this.buffer[e+3],i=this.set.types[r],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let a=[];for(;e<n;)a.push(this.childString(e)),e=this.buffer[e+3];return s+"("+a.join(",")+")"}findChild(e,r,n,i,s){let{buffer:a}=this,o=-1;for(let d=e;d!=r&&!(Jq(s,i,a[d+1],a[d+2])&&(o=d,n>0));d=a[d+3]);return o}slice(e,r,n){let i=this.buffer,s=new Uint16Array(r-e),a=0;for(let o=e,d=0;o<r;){s[d++]=i[o++],s[d++]=i[o++]-n;let m=s[d++]=i[o++]-n;s[d++]=i[o++]-e,a=Math.max(a,m)}return new gf(s,a,this.set)}}function Jq(t,e,r,n){switch(t){case-2:return r<e;case-1:return n>=e&&r<e;case 0:return r<e&&n>e;case 1:return r<=e&&n>e;case 2:return n>e;case 4:return!0}}function Wb(t,e,r,n){for(var i;t.from==t.to||(r<1?t.from>=e:t.from>e)||(r>-1?t.to<=e:t.to<e);){let a=!n&&t instanceof Pa&&t.index<0?null:t.parent;if(!a)return t;t=a}let s=n?0:Ci.IgnoreOverlays;if(n)for(let a=t,o=a.parent;o;a=o,o=a.parent)a instanceof Pa&&a.index<0&&((i=o.enter(e,r,s))===null||i===void 0?void 0:i.from)!=a.from&&(t=o);for(;;){let a=t.enter(e,r,s);if(!a)return t;t=a}}class eQ{cursor(e=0){return new EE(this,e)}getChild(e,r=null,n=null){let i=xB(this,e,r,n);return i.length?i[0]:null}getChildren(e,r=null,n=null){return xB(this,e,r,n)}resolve(e,r=0){return Wb(this,e,r,!1)}resolveInner(e,r=0){return Wb(this,e,r,!0)}matchContext(e){return AE(this.parent,e)}enterUnfinishedNodesBefore(e){let r=this.childBefore(e),n=this;for(;r;){let i=r.lastChild;if(!i||i.to!=r.to)break;i.type.isError&&i.from==i.to?(n=r,r=i.prevSibling):r=i}return n}get node(){return this}get next(){return this.parent}}class Pa extends eQ{constructor(e,r,n,i){super(),this._tree=e,this.from=r,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,r,n,i,s=0){for(let a=this;;){for(let{children:o,positions:d}=a._tree,m=r>0?o.length:-1;e!=m;e+=r){let y=o[e],v=d[e]+a.from,w;if(!(!(s&Ci.EnterBracketed&&y instanceof qi&&(w=Kv.get(y))&&!w.overlay&&w.bracketed&&n>=v&&n<=v+y.length)&&!Jq(i,n,v,v+y.length))){if(y instanceof gf){if(s&Ci.ExcludeBuffers)continue;let O=y.findChild(0,y.buffer.length,r,n-v,i);if(O>-1)return new uu(new y2e(a,y,e,v),null,O)}else if(s&Ci.IncludeAnonymous||!y.type.isAnonymous||iI(y)){let O;if(!(s&Ci.IgnoreMounts)&&(O=Kv.get(y))&&!O.overlay)return new Pa(O.tree,v,e,a);let P=new Pa(y,v,e,a);return s&Ci.IncludeAnonymous||!P.type.isAnonymous?P:P.nextChild(r<0?y.children.length-1:0,r,n,i,s)}}}if(s&Ci.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+r:e=r<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}prop(e){return this._tree.prop(e)}enter(e,r,n=0){let i;if(!(n&Ci.IgnoreOverlays)&&(i=Kv.get(this._tree))&&i.overlay){let s=e-this.from,a=n&Ci.EnterBracketed&&i.bracketed;for(let{from:o,to:d}of i.overlay)if((r>0||a?o<=s:o<s)&&(r<0||a?d>=s:d>s))return new Pa(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,r,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function xB(t,e,r,n){let i=t.cursor(),s=[];if(!i.firstChild())return s;if(r!=null){for(let a=!1;!a;)if(a=i.type.is(r),!i.nextSibling())return s}for(;;){if(n!=null&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return n==null?s:[]}}function AE(t,e,r=e.length-1){for(let n=t;r>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[r]&&e[r]!=n.name)return!1;r--}}return!0}class y2e{constructor(e,r,n,i){this.parent=e,this.buffer=r,this.index=n,this.start=i}}class uu extends eQ{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,r,n){super(),this.context=e,this._parent=r,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,r,n){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,r-this.context.start,n);return s<0?null:new uu(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}prop(e){return this.type.prop(e)}enter(e,r,n=0){if(n&Ci.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],r>0?1:-1,e-this.context.start,r);return s<0?null:new uu(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,r=e.buffer[this.index+3];return r<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new uu(this.context,this._parent,r):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,r=this._parent?this._parent.index+4:0;return this.index==r?this.externalSibling(-1):new uu(this.context,this._parent,e.findChild(r,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],r=[],{buffer:n}=this.context,i=this.index+4,s=n.buffer[this.index+3];if(s>i){let a=n.buffer[this.index+1];e.push(n.slice(i,s,a)),r.push(0)}return new qi(this.type,e,r,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function tQ(t){if(!t.length)return null;let e=0,r=t[0];for(let s=1;s<t.length;s++){let a=t[s];(a.from>r.from||a.to<r.to)&&(r=a,e=s)}let n=r instanceof Pa&&r.index<0?null:r.parent,i=t.slice();return n?i[e]=n:i.splice(e,1),new x2e(i,r)}class x2e{constructor(e,r){this.heads=e,this.node=r}get next(){return tQ(this.heads)}}function v2e(t,e,r){let n=t.resolveInner(e,r),i=null;for(let s=n instanceof Pa?n:n.context.parent;s;s=s.parent)if(s.index<0){let a=s.parent;(i||(i=[n])).push(a.resolve(e,r)),s=a}else{let a=Kv.get(s.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new Pa(a.tree,a.overlay[0].from+s.from,-1,s);(i||(i=[n])).push(Wb(o,e,r,!1))}}return i?tQ(i):n}class EE{get name(){return this.type.name}constructor(e,r=0){if(this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,this.mode=r&~Ci.EnterBracketed,e instanceof Pa)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,r){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=r||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return e?e instanceof Pa?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,r,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,r,n,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,r-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,r,n=this.mode){return this.buffer?n&Ci.ExcludeBuffers?!1:this.enterChild(1,e,r):this.yield(this._tree.enter(e,r,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Ci.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Ci.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:r}=this.buffer,n=this.stack.length-1;if(e<0){let i=n<0?0:this.stack[n]+4;if(this.index!=i)return this.yieldBuf(r.findChild(i,this.index,-1,0,4))}else{let i=r.buffer[this.index+3];if(i<(n<0?r.buffer.length:r.buffer[this.stack[n]+3]))return this.yieldBuf(i)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let r,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:r,parent:n}=i)}else({index:r,_parent:n}=this._tree);for(;n;{index:r,_parent:n}=n)if(r>-1)for(let s=r+e,a=e<0?-1:n._tree.children.length;s!=a;s+=e){let o=n._tree.children[s];if(this.mode&Ci.IncludeAnonymous||o instanceof gf||!o.type.isAnonymous||iI(o))return!1}return!0}move(e,r){if(r&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,r=0){for(;(this.from==this.to||(r<1?this.from>=e:this.from>e)||(r>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,r););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,r=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let a=e;a;a=a._parent)if(a.index==i){if(i==this.index)return a;r=a,n=s+1;break e}i=this.stack[--s]}for(let i=n;i<this.stack.length;i++)r=new uu(this.buffer,r,this.stack[i]);return this.bufferNode=new uu(this.buffer,r,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,r){for(let n=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&r&&r(this),i=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return AE(this.node.parent,e);let{buffer:r}=this.buffer,{types:n}=r.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return AE(this._tree,e,i);let a=n[r.buffer[this.stack[s]]];if(!a.isAnonymous){if(e[i]&&e[i]!=a.name)return!1;i--}}return!0}}function iI(t){return t.children.some(e=>e instanceof gf||!e.type.isAnonymous||iI(e))}function b2e(t){var e;let{buffer:r,nodeSet:n,maxBufferLength:i=Yq,reused:s=[],minRepeatType:a=n.types.length}=t,o=Array.isArray(r)?new nI(r,r.length):r,d=n.types,m=0,y=0;function v(X,ee,K,Y,ne,oe){let{id:ce,start:Xe,end:Ae,size:We}=o,Ye=y,tt=m;if(We<0)if(o.next(),We==-1){let Le=s[ce];K.push(Le),Y.push(Xe-X);return}else if(We==-3){m=ce;return}else if(We==-4){y=ce;return}else throw new RangeError(`Unrecognized record size: ${We}`);let Be=d[ce],Me,Ge,De=Xe-X;if(Ae-Xe<=i&&(Ge=$(o.pos-ee,ne))){let Le=new Uint16Array(Ge.size-Ge.skip),Oe=o.pos-Ge.size,Ie=Le.length;for(;o.pos>Oe;)Ie=R(Ge.start,Le,Ie);Me=new gf(Le,Ae-Ge.start,n),De=Ge.start-X}else{let Le=o.pos-We;o.next();let Oe=[],Ie=[],st=ce>=a?ce:-1,Re=0,it=Ae;for(;o.pos>Le;)st>=0&&o.id==st&&o.size>=0?(o.end<=it-i&&(P(Oe,Ie,Xe,Re,o.end,it,st,Ye,tt),Re=Oe.length,it=o.end),o.next()):oe>2500?w(Xe,Le,Oe,Ie):v(Xe,Le,Oe,Ie,st,oe+1);if(st>=0&&Re>0&&Re<Oe.length&&P(Oe,Ie,Xe,Re,Xe,it,st,Ye,tt),Oe.reverse(),Ie.reverse(),st>-1&&Re>0){let Ke=O(Be,tt);Me=sI(Be,Oe,Ie,0,Oe.length,0,Ae-Xe,Ke,Ke)}else Me=E(Be,Oe,Ie,Ae-Xe,Ye-Ae,tt)}K.push(Me),Y.push(De)}function w(X,ee,K,Y){let ne=[],oe=0,ce=-1;for(;o.pos>ee;){let{id:Xe,start:Ae,end:We,size:Ye}=o;if(Ye>4)o.next();else{if(ce>-1&&Ae<ce)break;ce<0&&(ce=We-i),ne.push(Xe,Ae,We),oe++,o.next()}}if(oe){let Xe=new Uint16Array(oe*4),Ae=ne[ne.length-2];for(let We=ne.length-3,Ye=0;We>=0;We-=3)Xe[Ye++]=ne[We],Xe[Ye++]=ne[We+1]-Ae,Xe[Ye++]=ne[We+2]-Ae,Xe[Ye++]=Ye;K.push(new gf(Xe,ne[2]-Ae,n)),Y.push(Ae-X)}}function O(X,ee){return(K,Y,ne)=>{let oe=0,ce=K.length-1,Xe,Ae;if(ce>=0&&(Xe=K[ce])instanceof qi){if(!ce&&Xe.type==X&&Xe.length==ne)return Xe;(Ae=Xe.prop(nn.lookAhead))&&(oe=Y[ce]+Xe.length+Ae)}return E(X,K,Y,ne,oe,ee)}}function P(X,ee,K,Y,ne,oe,ce,Xe,Ae){let We=[],Ye=[];for(;X.length>Y;)We.push(X.pop()),Ye.push(ee.pop()+K-ne);X.push(E(n.types[ce],We,Ye,oe-ne,Xe-oe,Ae)),ee.push(ne-K)}function E(X,ee,K,Y,ne,oe,ce){if(oe){let Xe=[nn.contextHash,oe];ce=ce?[Xe].concat(ce):[Xe]}if(ne>25){let Xe=[nn.lookAhead,ne];ce=ce?[Xe].concat(ce):[Xe]}return new qi(X,ee,K,Y,ce)}function $(X,ee){let K=o.fork(),Y=0,ne=0,oe=0,ce=K.end-i,Xe={size:0,start:0,skip:0};e:for(let Ae=K.pos-X;K.pos>Ae;){let We=K.size;if(K.id==ee&&We>=0){Xe.size=Y,Xe.start=ne,Xe.skip=oe,oe+=4,Y+=4,K.next();continue}let Ye=K.pos-We;if(We<0||Ye<Ae||K.start<ce)break;let tt=K.id>=a?4:0,Be=K.start;for(K.next();K.pos>Ye;){if(K.size<0)if(K.size==-3||K.size==-4)tt+=4;else break e;else K.id>=a&&(tt+=4);K.next()}ne=Be,Y+=We,oe+=tt}return(ee<0||Y==X)&&(Xe.size=Y,Xe.start=ne,Xe.skip=oe),Xe.size>4?Xe:void 0}function R(X,ee,K){let{id:Y,start:ne,end:oe,size:ce}=o;if(o.next(),ce>=0&&Y<a){let Xe=K;if(ce>4){let Ae=o.pos-(ce-4);for(;o.pos>Ae;)K=R(X,ee,K)}ee[--K]=Xe,ee[--K]=oe-X,ee[--K]=ne-X,ee[--K]=Y}else ce==-3?m=Y:ce==-4&&(y=Y);return K}let F=[],D=[];for(;o.pos>0;)v(t.start||0,t.bufferStart||0,F,D,-1,0);let U=(e=t.length)!==null&&e!==void 0?e:F.length?D[0]+F[0].length:0;return new qi(d[t.topID],F.reverse(),D.reverse(),U)}const vB=new WeakMap;function RS(t,e){if(!t.isAnonymous||e instanceof gf||e.type!=t)return 1;let r=vB.get(e);if(r==null){r=1;for(let n of e.children){if(n.type!=t||!(n instanceof qi)){r=1;break}r+=RS(t,n)}vB.set(e,r)}return r}function sI(t,e,r,n,i,s,a,o,d){let m=0;for(let P=n;P<i;P++)m+=RS(t,e[P]);let y=Math.ceil(m*1.5/8),v=[],w=[];function O(P,E,$,R,F){for(let D=$;D<R;){let U=D,X=E[D],ee=RS(t,P[D]);for(D++;D<R;D++){let K=RS(t,P[D]);if(ee+K>=y)break;ee+=K}if(D==U+1){if(ee>y){let K=P[U];O(K.children,K.positions,0,K.children.length,E[U]+F);continue}v.push(P[U])}else{let K=E[D-1]+P[D-1].length-X;v.push(sI(t,P,E,U,D,X,K,null,d))}w.push(X+F-s)}}return O(e,r,n,i,0),(o||d)(v,w,a)}class _2e{constructor(){this.map=new WeakMap}setBuffer(e,r,n){let i=this.map.get(e);i||this.map.set(e,i=new Map),i.set(r,n)}getBuffer(e,r){let n=this.map.get(e);return n&&n.get(r)}set(e,r){e instanceof uu?this.setBuffer(e.context.buffer,e.index,r):e instanceof Pa&&this.map.set(e.tree,r)}get(e){return e instanceof uu?this.getBuffer(e.context.buffer,e.index):e instanceof Pa?this.map.get(e.tree):void 0}cursorSet(e,r){e.buffer?this.setBuffer(e.buffer.buffer,e.index,r):this.map.set(e.tree,r)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class Xp{constructor(e,r,n,i,s=!1,a=!1){this.from=e,this.to=r,this.tree=n,this.offset=i,this.open=(s?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,r=[],n=!1){let i=[new Xp(0,e.length,e,0,!1,n)];for(let s of r)s.to>e.length&&i.push(s);return i}static applyChanges(e,r,n=128){if(!r.length)return e;let i=[],s=1,a=e.length?e[0]:null;for(let o=0,d=0,m=0;;o++){let y=o<r.length?r[o]:null,v=y?y.fromA:1e9;if(v-d>=n)for(;a&&a.from<v;){let w=a;if(d>=w.from||v<=w.to||m){let O=Math.max(w.from,d)-m,P=Math.min(w.to,v)-m;w=O>=P?null:new Xp(O,P,w.tree,w.offset+m,o>0,!!y)}if(w&&i.push(w),a.to>v)break;a=s<e.length?e[s++]:null}if(!y)break;d=y.toA,m=y.toA-y.toB}return i}}class rQ{startParse(e,r,n){return typeof e=="string"&&(e=new w2e(e)),n=n?n.length?n.map(i=>new bj(i.from,i.to)):[new bj(0,0)]:[new bj(0,e.length)],this.createParse(e,r||[],n)}parse(e,r,n){let i=this.startParse(e,r,n);for(;;){let s=i.advance();if(s)return s}}}class w2e{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,r){return this.string.slice(e,r)}}new nn({perNode:!0});let S2e=0;class Al{constructor(e,r,n,i){this.name=e,this.set=r,this.base=n,this.modified=i,this.id=S2e++}toString(){let{name:e}=this;for(let r of this.modified)r.name&&(e=`${r.name}(${e})`);return e}static define(e,r){let n=typeof e=="string"?e:"?";if(e instanceof Al&&(r=e),r!=null&&r.base)throw new Error("Can not derive from a modified tag");let i=new Al(n,[],null,[]);if(i.set.push(i),r)for(let s of r.set)i.set.push(s);return i}static defineModifier(e){let r=new V2(e);return n=>n.modified.indexOf(r)>-1?n:V2.get(n.base||n,n.modified.concat(r).sort((i,s)=>i.id-s.id))}}let k2e=0;class V2{constructor(e){this.name=e,this.instances=[],this.id=k2e++}static get(e,r){if(!r.length)return e;let n=r[0].instances.find(o=>o.base==e&&C2e(r,o.modified));if(n)return n;let i=[],s=new Al(e.name,i,e,r);for(let o of r)o.instances.push(s);let a=T2e(r);for(let o of e.set)if(!o.modified.length)for(let d of a)i.push(V2.get(o,d));return s}}function C2e(t,e){return t.length==e.length&&t.every((r,n)=>r==e[n])}function T2e(t){let e=[[]];for(let r=0;r<t.length;r++)for(let n=0,i=e.length;n<i;n++)e.push(e[n].concat(t[r]));return e.sort((r,n)=>n.length-r.length)}function bC(t){let e=Object.create(null);for(let r in t){let n=t[r];Array.isArray(n)||(n=[n]);for(let i of r.split(" "))if(i){let s=[],a=2,o=i;for(let v=0;;){if(o=="..."&&v>0&&v+3==i.length){a=1;break}let w=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!w)throw new RangeError("Invalid path: "+i);if(s.push(w[0]=="*"?"":w[0][0]=='"'?JSON.parse(w[0]):w[0]),v+=w[0].length,v==i.length)break;let O=i[v++];if(v==i.length&&O=="!"){a=0;break}if(O!="/")throw new RangeError("Invalid path: "+i);o=i.slice(v)}let d=s.length-1,m=s[d];if(!m)throw new RangeError("Invalid path: "+i);let y=new Ub(n,a,d>0?s.slice(0,d):null);e[m]=y.sort(e[m])}}return nQ.add(e)}const nQ=new nn({combine(t,e){let r,n,i;for(;t||e;){if(!t||e&&t.depth>=e.depth?(i=e,e=e.next):(i=t,t=t.next),r&&r.mode==i.mode&&!i.context&&!r.context)continue;let s=new Ub(i.tags,i.mode,i.context);r?r.next=s:n=s,r=s}return n}});class Ub{constructor(e,r,n,i){this.tags=e,this.mode=r,this.context=n,this.next=i}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Ub.empty=new Ub([],2,null);function iQ(t,e){let r=Object.create(null);for(let s of t)if(!Array.isArray(s.tag))r[s.tag.id]=s.class;else for(let a of s.tag)r[a.id]=s.class;let{scope:n,all:i=null}=e||{};return{style:s=>{let a=i;for(let o of s)for(let d of o.set){let m=r[d.id];if(m){a=a?a+" "+m:m;break}}return a},scope:n}}function O2e(t,e){let r=null;for(let n of t){let i=n.style(e);i&&(r=r?r+" "+i:i)}return r}function j2e(t,e,r,n=0,i=t.length){let s=new P2e(n,Array.isArray(e)?e:[e],r);s.highlightRange(t.cursor(),n,i,"",s.highlighters),s.flush(i)}class P2e{constructor(e,r,n){this.at=e,this.highlighters=r,this.span=n,this.class=""}startSpan(e,r){r!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=r)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,r,n,i,s){let{type:a,from:o,to:d}=e;if(o>=n||d<=r)return;a.isTop&&(s=this.highlighters.filter(O=>!O.scope||O.scope(a)));let m=i,y=A2e(e)||Ub.empty,v=O2e(s,y.tags);if(v&&(m&&(m+=" "),m+=v,y.mode==1&&(i+=(i?" ":"")+v)),this.startSpan(Math.max(r,o),m),y.opaque)return;let w=e.tree&&e.tree.prop(nn.mounted);if(w&&w.overlay){let O=e.node.enter(w.overlay[0].from+o,1),P=this.highlighters.filter($=>!$.scope||$.scope(w.tree.type)),E=e.firstChild();for(let $=0,R=o;;$++){let F=$<w.overlay.length?w.overlay[$]:null,D=F?F.from+o:d,U=Math.max(r,R),X=Math.min(n,D);if(U<X&&E)for(;e.from<X&&(this.highlightRange(e,U,X,i,s),this.startSpan(Math.min(X,e.to),m),!(e.to>=D||!e.nextSibling())););if(!F||D>n)break;R=F.to+o,R>r&&(this.highlightRange(O.cursor(),Math.max(r,F.from+o),Math.min(n,R),"",P),this.startSpan(Math.min(n,R),m))}E&&e.parent()}else if(e.firstChild()){w&&(i="");do if(!(e.to<=r)){if(e.from>=n)break;this.highlightRange(e,r,n,i,s),this.startSpan(Math.min(n,e.to),m)}while(e.nextSibling());e.parent()}}}function A2e(t){let e=t.type.prop(nQ);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}const Gt=Al.define,Fw=Gt(),xd=Gt(),bB=Gt(xd),_B=Gt(xd),vd=Gt(),Bw=Gt(vd),_j=Gt(vd),Hc=Gt(),np=Gt(Hc),qc=Gt(),Qc=Gt(),zE=Gt(),Xx=Gt(zE),$w=Gt(),Ve={comment:Fw,lineComment:Gt(Fw),blockComment:Gt(Fw),docComment:Gt(Fw),name:xd,variableName:Gt(xd),typeName:bB,tagName:Gt(bB),propertyName:_B,attributeName:Gt(_B),className:Gt(xd),labelName:Gt(xd),namespace:Gt(xd),macroName:Gt(xd),literal:vd,string:Bw,docString:Gt(Bw),character:Gt(Bw),attributeValue:Gt(Bw),number:_j,integer:Gt(_j),float:Gt(_j),bool:Gt(vd),regexp:Gt(vd),escape:Gt(vd),color:Gt(vd),url:Gt(vd),keyword:qc,self:Gt(qc),null:Gt(qc),atom:Gt(qc),unit:Gt(qc),modifier:Gt(qc),operatorKeyword:Gt(qc),controlKeyword:Gt(qc),definitionKeyword:Gt(qc),moduleKeyword:Gt(qc),operator:Qc,derefOperator:Gt(Qc),arithmeticOperator:Gt(Qc),logicOperator:Gt(Qc),bitwiseOperator:Gt(Qc),compareOperator:Gt(Qc),updateOperator:Gt(Qc),definitionOperator:Gt(Qc),typeOperator:Gt(Qc),controlOperator:Gt(Qc),punctuation:zE,separator:Gt(zE),bracket:Xx,angleBracket:Gt(Xx),squareBracket:Gt(Xx),paren:Gt(Xx),brace:Gt(Xx),content:Hc,heading:np,heading1:Gt(np),heading2:Gt(np),heading3:Gt(np),heading4:Gt(np),heading5:Gt(np),heading6:Gt(np),contentSeparator:Gt(Hc),list:Gt(Hc),quote:Gt(Hc),emphasis:Gt(Hc),strong:Gt(Hc),link:Gt(Hc),monospace:Gt(Hc),strikethrough:Gt(Hc),inserted:Gt(),deleted:Gt(),changed:Gt(),invalid:Gt(),meta:$w,documentMeta:Gt($w),annotation:Gt($w),processingInstruction:Gt($w),definition:Al.defineModifier("definition"),constant:Al.defineModifier("constant"),function:Al.defineModifier("function"),standard:Al.defineModifier("standard"),local:Al.defineModifier("local"),special:Al.defineModifier("special")};for(let t in Ve){let e=Ve[t];e instanceof Al&&(e.name=t)}iQ([{tag:Ve.link,class:"tok-link"},{tag:Ve.heading,class:"tok-heading"},{tag:Ve.emphasis,class:"tok-emphasis"},{tag:Ve.strong,class:"tok-strong"},{tag:Ve.keyword,class:"tok-keyword"},{tag:Ve.atom,class:"tok-atom"},{tag:Ve.bool,class:"tok-bool"},{tag:Ve.url,class:"tok-url"},{tag:Ve.labelName,class:"tok-labelName"},{tag:Ve.inserted,class:"tok-inserted"},{tag:Ve.deleted,class:"tok-deleted"},{tag:Ve.literal,class:"tok-literal"},{tag:Ve.string,class:"tok-string"},{tag:Ve.number,class:"tok-number"},{tag:[Ve.regexp,Ve.escape,Ve.special(Ve.string)],class:"tok-string2"},{tag:Ve.variableName,class:"tok-variableName"},{tag:Ve.local(Ve.variableName),class:"tok-variableName tok-local"},{tag:Ve.definition(Ve.variableName),class:"tok-variableName tok-definition"},{tag:Ve.special(Ve.variableName),class:"tok-variableName2"},{tag:Ve.definition(Ve.propertyName),class:"tok-propertyName tok-definition"},{tag:Ve.typeName,class:"tok-typeName"},{tag:Ve.namespace,class:"tok-namespace"},{tag:Ve.className,class:"tok-className"},{tag:Ve.macroName,class:"tok-macroName"},{tag:Ve.propertyName,class:"tok-propertyName"},{tag:Ve.operator,class:"tok-operator"},{tag:Ve.comment,class:"tok-comment"},{tag:Ve.meta,class:"tok-meta"},{tag:Ve.invalid,class:"tok-invalid"},{tag:Ve.punctuation,class:"tok-punctuation"}]);var wj;const Yg=new nn;function E2e(t){return hr.define({combine:t?e=>e.concat(t):void 0})}const z2e=new nn;class pc{constructor(e,r,n=[],i=""){this.data=e,this.name=i,fn.prototype.hasOwnProperty("tree")||Object.defineProperty(fn.prototype,"tree",{get(){return Hi(this)}}),this.parser=r,this.extension=[yf.of(this),fn.languageData.of((s,a,o)=>{let d=wB(s,a,o),m=d.type.prop(Yg);if(!m)return[];let y=s.facet(m),v=d.type.prop(z2e);if(v){let w=d.resolve(a-d.from,o);for(let O of v)if(O.test(w,s)){let P=s.facet(O.facet);return O.type=="replace"?P:P.concat(y)}}return y})].concat(n)}isActiveAt(e,r,n=-1){return wB(e,r,n).type.prop(Yg)==this.data}findRegions(e){let r=e.facet(yf);if((r==null?void 0:r.data)==this.data)return[{from:0,to:e.doc.length}];if(!r||!r.allowsNesting)return[];let n=[],i=(s,a)=>{if(s.prop(Yg)==this.data){n.push({from:a,to:a+s.length});return}let o=s.prop(nn.mounted);if(o){if(o.tree.prop(Yg)==this.data){if(o.overlay)for(let d of o.overlay)n.push({from:d.from+a,to:d.to+a});else n.push({from:a,to:a+s.length});return}else if(o.overlay){let d=n.length;if(i(o.tree,o.overlay[0].from+a),n.length>d)return}}for(let d=0;d<s.children.length;d++){let m=s.children[d];m instanceof qi&&i(m,s.positions[d]+a)}};return i(Hi(e),0),n}get allowsNesting(){return!0}}pc.setState=Qr.define();function wB(t,e,r){let n=t.facet(yf),i=Hi(t).topNode;if(!n||n.allowsNesting)for(let s=i;s;s=s.enter(e,r,Ci.ExcludeBuffers|Ci.EnterBracketed))s.type.isTop&&(i=s);return i}class h0 extends pc{constructor(e,r,n){super(e,r,[],n),this.parser=r}static define(e){let r=E2e(e.languageData);return new h0(r,e.parser.configure({props:[Yg.add(n=>n.isTop?r:void 0)]}),e.name)}configure(e,r){return new h0(this.data,this.parser.configure(e),r||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Hi(t){let e=t.field(pc.state,!1);return e?e.tree:qi.empty}class M2e{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,r){let n=this.cursorPos-this.string.length;return e<n||r>=this.cursorPos?this.doc.sliceString(e,r):this.string.slice(e-n,r-n)}}let Kx=null;class W2{constructor(e,r,n=[],i,s,a,o,d){this.parser=e,this.state=r,this.fragments=n,this.tree=i,this.treeLen=s,this.viewport=a,this.skipped=o,this.scheduleOn=d,this.parse=null,this.tempSkipped=[]}static create(e,r,n){return new W2(e,r,[],qi.empty,0,n,[],null)}startParse(){return this.parser.startParse(new M2e(this.state.doc),this.fragments)}work(e,r){return r!=null&&r>=this.state.doc.length&&(r=void 0),this.tree!=qi.empty&&this.isDone(r??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),r!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>r)&&r<this.state.doc.length&&this.parse.stopAt(r);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(Xp.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(r??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,r;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(r=this.parse.advance()););}),this.treeLen=e,this.tree=r,this.fragments=this.withoutTempSkipped(Xp.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let r=Kx;Kx=this;try{return e()}finally{Kx=r}}withoutTempSkipped(e){for(let r;r=this.tempSkipped.pop();)e=SB(e,r.from,r.to);return e}changes(e,r){let{fragments:n,tree:i,treeLen:s,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let d=[];if(e.iterChangedRanges((m,y,v,w)=>d.push({fromA:m,toA:y,fromB:v,toB:w})),n=Xp.applyChanges(n,d),i=qi.empty,s=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let m of this.skipped){let y=e.mapPos(m.from,1),v=e.mapPos(m.to,-1);y<v&&o.push({from:y,to:v})}}}return new W2(this.parser,r,n,i,s,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let r=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:i,to:s}=this.skipped[n];i<e.to&&s>e.from&&(this.fragments=SB(this.fragments,i,s),this.skipped.splice(n--,1))}return this.skipped.length>=r?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,r){this.skipped.push({from:e,to:r})}static getSkippingParser(e){return new class extends rQ{createParse(r,n,i){let s=i[0].from,a=i[i.length-1].to;return{parsedPos:s,advance(){let d=Kx;if(d){for(let m of i)d.tempSkipped.push(m);e&&(d.scheduleOn=d.scheduleOn?Promise.all([d.scheduleOn,e]):e)}return this.parsedPos=a,new qi(za.none,[],[],a-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let r=this.fragments;return this.treeLen>=e&&r.length&&r[0].from==0&&r[0].to>=e}static get(){return Kx}}function SB(t,e,r){return Xp.applyChanges(t,[{fromA:e,toA:r,fromB:e,toB:r}])}class d0{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let r=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),r.viewport.to);return r.work(20,n)||r.takeTree(),new d0(r)}static init(e){let r=Math.min(3e3,e.doc.length),n=W2.create(e.facet(yf).parser,e,{from:0,to:r});return n.work(20,r)||n.takeTree(),new d0(n)}}pc.state=co.define({create:d0.init,update(t,e){for(let r of e.effects)if(r.is(pc.setState))return r.value;return e.startState.facet(yf)!=e.state.facet(yf)?d0.init(e.state):t.apply(e)}});let sQ=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(sQ=t=>{let e=-1,r=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(r):cancelIdleCallback(e)});const Sj=typeof navigator<"u"&&(!((wj=navigator.scheduling)===null||wj===void 0)&&wj.isInputPending)?()=>navigator.scheduling.isInputPending():null,I2e=Qi.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let r=this.view.state.field(pc.state).context;(r.updateViewport(e.view.viewport)||this.view.viewport.to>r.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(r)}scheduleWork(){if(this.working)return;let{state:e}=this.view,r=e.field(pc.state);(r.tree!=r.context.tree||!r.context.isDone(e.doc.length))&&(this.working=sQ(this.work))}work(e){this.working=null;let r=Date.now();if(this.chunkEnd<r&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=r+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,s=n.field(pc.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!Sj?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<i&&n.doc.length>i+1e3,d=s.context.work(()=>Sj&&Sj()||Date.now()>a,i+(o?0:1e5));this.chunkBudget-=Date.now()-r,(d||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:pc.setState.of(new d0(s.context))})),this.chunkBudget>0&&!(d&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(r=>wa(this.view.state,r)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),yf=hr.define({combine(t){return t.length?t[0]:null},enables:t=>[pc.state,I2e,Zt.contentAttributes.compute([t],e=>{let r=e.facet(t);return r&&r.name?{"data-language":r.name}:{}})]});class oI{constructor(e,r=[]){this.language=e,this.support=r,this.extension=[e,r]}}const R2e=hr.define(),_C=hr.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(r=>r!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function U2(t){let e=t.facet(_C);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}function qb(t,e){let r="",n=t.tabSize,i=t.facet(_C)[0];if(i=="	"){for(;e>=n;)r+="	",e-=n;i=" "}for(let s=0;s<e;s++)r+=i;return r}function aI(t,e){t instanceof fn&&(t=new wC(t));for(let n of t.state.facet(R2e)){let i=n(t,e);if(i!==void 0)return i}let r=Hi(t.state);return r.length>=e?D2e(t,r,e):null}class wC{constructor(e,r={}){this.state=e,this.options=r,this.unit=U2(e)}lineAt(e,r=1){let n=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:s}=this.options;return i!=null&&i>=n.from&&i<=n.to?s&&i==e?{text:"",from:e}:(r<0?i<e:i<=e)?{text:n.text.slice(i-n.from),from:i}:{text:n.text.slice(0,i-n.from),from:n.from}:n}textAfterPos(e,r=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:i}=this.lineAt(e,r);return n.slice(e-i,Math.min(n.length,e+100-i))}column(e,r=1){let{text:n,from:i}=this.lineAt(e,r),s=this.countColumn(n,e-i),a=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return a>-1&&(s+=a-this.countColumn(n,n.search(/\S|$/))),s}countColumn(e,r=e.length){return C0(e,this.state.tabSize,r)}lineIndent(e,r=1){let{text:n,from:i}=this.lineAt(e,r),s=this.options.overrideIndentation;if(s){let a=s(i);if(a>-1)return a}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const SC=new nn;function D2e(t,e,r){let n=e.resolveStack(r),i=e.resolveInner(r,-1).resolve(r,0).enterUnfinishedNodesBefore(r);if(i!=n.node){let s=[];for(let a=i;a&&!(a.from<n.node.from||a.to>n.node.to||a.from==n.node.from&&a.type==n.node.type);a=a.parent)s.push(a);for(let a=s.length-1;a>=0;a--)n={node:s[a],next:n}}return oQ(n,t,r)}function oQ(t,e,r){for(let n=t;n;n=n.next){let i=F2e(n.node);if(i)return i(lI.create(e,r,n))}return 0}function L2e(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function F2e(t){let e=t.type.prop(SC);if(e)return e;let r=t.firstChild,n;if(r&&(n=r.type.prop(nn.closedBy))){let i=t.lastChild,s=i&&n.indexOf(i.name)>-1;return a=>V2e(a,!0,1,void 0,s&&!L2e(a)?i.from:void 0)}return t.parent==null?B2e:null}function B2e(){return 0}class lI extends wC{constructor(e,r,n){super(e.state,e.options),this.base=e,this.pos=r,this.context=n}get node(){return this.context.node}static create(e,r,n){return new lI(e,r,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let r=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(r.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if($2e(n,e))break;r=this.state.doc.lineAt(n.from)}return this.lineIndent(r.from)}continue(){return oQ(this.context.next,this.base,this.pos)}}function $2e(t,e){for(let r=e;r;r=r.parent)if(t==r)return!0;return!1}function N2e(t){let e=t.node,r=e.childAfter(e.from),n=e.lastChild;if(!r)return null;let i=t.options.simulateBreak,s=t.state.doc.lineAt(r.from),a=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let o=r.to;;){let d=e.childAfter(o);if(!d||d==n)return null;if(!d.type.isSkipped){if(d.from>=a)return null;let m=/^ */.exec(s.text.slice(r.to-s.from))[0].length;return{from:r.from,to:r.to+m}}o=d.to}}function V2e(t,e,r,n,i){let s=t.textAfter,a=s.match(/^\s*/)[0].length,o=n&&s.slice(a,a+n.length)==n||i==t.pos+a,d=N2e(t);return d?o?t.column(d.from):t.column(d.to):t.baseIndent+(o?0:t.unit*r)}function aQ({except:t,units:e=1}={}){return r=>{let n=t&&t.test(r.textAfter);return r.baseIndent+(n?0:e*r.unit)}}const W2e=200;function U2e(){return fn.transactionFilter.of(t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let r=t.newDoc,{head:n}=t.newSelection.main,i=r.lineAt(n);if(n>i.from+W2e)return t;let s=r.sliceString(i.from,n);if(!e.some(m=>m.test(s)))return t;let{state:a}=t,o=-1,d=[];for(let{head:m}of a.selection.ranges){let y=a.doc.lineAt(m);if(y.from==o)continue;o=y.from;let v=aI(a,y.from);if(v==null)continue;let w=/^\s*/.exec(y.text)[0],O=qb(a,v);w!=O&&d.push({from:y.from,to:y.from+w.length,insert:O})}return d.length?[t,{changes:d,sequential:!0}]:t})}const q2e=hr.define(),kC=new nn;function Q2e(t){let e=t.firstChild,r=t.lastChild;return e&&e.to<r.from?{from:e.to,to:r.type.isError?t.to:r.from}:null}function H2e(t,e,r){let n=Hi(t);if(n.length<r)return null;let i=n.resolveStack(r,1),s=null;for(let a=i;a;a=a.next){let o=a.node;if(o.to<=r||o.from>r)continue;if(s&&o.from<e)break;let d=o.type.prop(kC);if(d&&(o.to<n.length-50||n.length==t.doc.length||!G2e(o))){let m=d(o,t);m&&m.from<=r&&m.from>=e&&m.to>r&&(s=m)}}return s}function G2e(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function q2(t,e,r){for(let n of t.facet(q2e)){let i=n(t,e,r);if(i)return i}return H2e(t,e,r)}function lQ(t,e){let r=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);return r>=n?void 0:{from:r,to:n}}const CC=Qr.define({map:lQ}),N1=Qr.define({map:lQ});function cQ(t){let e=[];for(let{head:r}of t.state.selection.ranges)e.some(n=>n.from<=r&&n.to>=r)||e.push(t.lineBlockAt(r));return e}const ym=co.define({create(){return jr.none},update(t,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((r,n)=>t=kB(t,r,n)),t=t.map(e.changes);for(let r of e.effects)if(r.is(CC)&&!X2e(t,r.value.from,r.value.to)){let{preparePlaceholder:n}=e.state.facet(dQ),i=n?jr.replace({widget:new rke(n(e.state,r.value))}):CB;t=t.update({add:[i.range(r.value.from,r.value.to)]})}else r.is(N1)&&(t=t.update({filter:(n,i)=>r.value.from!=n||r.value.to!=i,filterFrom:r.value.from,filterTo:r.value.to}));return e.selection&&(t=kB(t,e.selection.main.head)),t},provide:t=>Zt.decorations.from(t),toJSON(t,e){let r=[];return t.between(0,e.doc.length,(n,i)=>{r.push(n,i)}),r},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let r=0;r<t.length;){let n=t[r++],i=t[r++];if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid JSON for fold state");e.push(CB.range(n,i))}return jr.set(e,!0)}});function kB(t,e,r=e){let n=!1;return t.between(e,r,(i,s)=>{i<r&&s>e&&(n=!0)}),n?t.update({filterFrom:e,filterTo:r,filter:(i,s)=>i>=r||s<=e}):t}function Q2(t,e,r){var n;let i=null;return(n=t.field(ym,!1))===null||n===void 0||n.between(e,r,(s,a)=>{(!i||i.from>s)&&(i={from:s,to:a})}),i}function X2e(t,e,r){let n=!1;return t.between(e,e,(i,s)=>{i==e&&s==r&&(n=!0)}),n}function uQ(t,e){return t.field(ym,!1)?e:e.concat(Qr.appendConfig.of(fQ()))}const K2e=t=>{for(let e of cQ(t)){let r=q2(t.state,e.from,e.to);if(r)return t.dispatch({effects:uQ(t.state,[CC.of(r),hQ(t,r)])}),!0}return!1},Z2e=t=>{if(!t.state.field(ym,!1))return!1;let e=[];for(let r of cQ(t)){let n=Q2(t.state,r.from,r.to);n&&e.push(N1.of(n),hQ(t,n,!1))}return e.length&&t.dispatch({effects:e}),e.length>0};function hQ(t,e,r=!0){let n=t.state.doc.lineAt(e.from).number,i=t.state.doc.lineAt(e.to).number;return Zt.announce.of(`${t.state.phrase(r?"Folded lines":"Unfolded lines")} ${n} ${t.state.phrase("to")} ${i}.`)}const Y2e=t=>{let{state:e}=t,r=[];for(let n=0;n<e.doc.length;){let i=t.lineBlockAt(n),s=q2(e,i.from,i.to);s&&r.push(CC.of(s)),n=(s?t.lineBlockAt(s.to):i).to+1}return r.length&&t.dispatch({effects:uQ(t.state,r)}),!!r.length},J2e=t=>{let e=t.state.field(ym,!1);if(!e||!e.size)return!1;let r=[];return e.between(0,t.state.doc.length,(n,i)=>{r.push(N1.of({from:n,to:i}))}),t.dispatch({effects:r}),!0},eke=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:K2e},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Z2e},{key:"Ctrl-Alt-[",run:Y2e},{key:"Ctrl-Alt-]",run:J2e}],tke={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},dQ=hr.define({combine(t){return Cu(t,tke)}});function fQ(t){return[ym,ske]}function pQ(t,e){let{state:r}=t,n=r.facet(dQ),i=a=>{let o=t.lineBlockAt(t.posAtDOM(a.target)),d=Q2(t.state,o.from,o.to);d&&t.dispatch({effects:N1.of(d)}),a.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(t,i,e);let s=document.createElement("span");return s.textContent=n.placeholderText,s.setAttribute("aria-label",r.phrase("folded code")),s.title=r.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=i,s}const CB=jr.replace({widget:new class extends Tu{toDOM(t){return pQ(t,null)}}});class rke extends Tu{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return pQ(e,this.value)}}const nke={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class kj extends Th{constructor(e,r){super(),this.config=e,this.open=r}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let r=document.createElement("span");return r.textContent=this.open?this.config.openText:this.config.closedText,r.title=e.state.phrase(this.open?"Fold line":"Unfold line"),r}}function ike(t={}){let e={...nke,...t},r=new kj(e,!0),n=new kj(e,!1),i=Qi.fromClass(class{constructor(a){this.from=a.viewport.from,this.markers=this.buildMarkers(a)}update(a){(a.docChanged||a.viewportChanged||a.startState.facet(yf)!=a.state.facet(yf)||a.startState.field(ym,!1)!=a.state.field(ym,!1)||Hi(a.startState)!=Hi(a.state)||e.foldingChanged(a))&&(this.markers=this.buildMarkers(a.view))}buildMarkers(a){let o=new kh;for(let d of a.viewportLineBlocks){let m=Q2(a.state,d.from,d.to)?n:q2(a.state,d.from,d.to)?r:null;m&&o.add(d.from,d.from,m)}return o.finish()}}),{domEventHandlers:s}=e;return[i,i2e({class:"cm-foldGutter",markers(a){var o;return((o=a.plugin(i))===null||o===void 0?void 0:o.markers)||sn.empty},initialSpacer(){return new kj(e,!1)},domEventHandlers:{...s,click:(a,o,d)=>{if(s.click&&s.click(a,o,d))return!0;let m=Q2(a.state,o.from,o.to);if(m)return a.dispatch({effects:N1.of(m)}),!0;let y=q2(a.state,o.from,o.to);return y?(a.dispatch({effects:CC.of(y)}),!0):!1}}}),fQ()]}const ske=Zt.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class V1{constructor(e,r){this.specs=e;let n;function i(o){let d=ff.newName();return(n||(n=Object.create(null)))["."+d]=o,d}const s=typeof r.all=="string"?r.all:r.all?i(r.all):void 0,a=r.scope;this.scope=a instanceof pc?o=>o.prop(Yg)==a.data:a?o=>o==a:void 0,this.style=iQ(e.map(o=>({tag:o.tag,class:o.class||i(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new ff(n):null,this.themeType=r.themeType}static define(e,r){return new V1(e,r||{})}}const ME=hr.define(),mQ=hr.define({combine(t){return t.length?[t[0]]:null}});function Cj(t){let e=t.facet(ME);return e.length?e:t.facet(mQ)}function gQ(t,e){let r=[ake],n;return t instanceof V1&&(t.module&&r.push(Zt.styleModule.of(t.module)),n=t.themeType),e!=null&&e.fallback?r.push(mQ.of(t)):n?r.push(ME.computeN([Zt.darkTheme],i=>i.facet(Zt.darkTheme)==(n=="dark")?[t]:[])):r.push(ME.of(t)),r}class oke{constructor(e){this.markCache=Object.create(null),this.tree=Hi(e.state),this.decorations=this.buildDeco(e,Cj(e.state)),this.decoratedTo=e.viewport.to}update(e){let r=Hi(e.state),n=Cj(e.state),i=n!=Cj(e.startState),{viewport:s}=e.view,a=e.changes.mapPos(this.decoratedTo,1);r.length<s.to&&!i&&r.type==this.tree.type&&a>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=a):(r!=this.tree||e.viewportChanged||i)&&(this.tree=r,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=s.to)}buildDeco(e,r){if(!r||!this.tree.length)return jr.none;let n=new kh;for(let{from:i,to:s}of e.visibleRanges)j2e(this.tree,r,(a,o,d)=>{n.add(a,o,this.markCache[d]||(this.markCache[d]=jr.mark({class:d})))},i,s);return n.finish()}}const ake=wm.high(Qi.fromClass(oke,{decorations:t=>t.decorations})),lke=V1.define([{tag:Ve.meta,color:"#404740"},{tag:Ve.link,textDecoration:"underline"},{tag:Ve.heading,textDecoration:"underline",fontWeight:"bold"},{tag:Ve.emphasis,fontStyle:"italic"},{tag:Ve.strong,fontWeight:"bold"},{tag:Ve.strikethrough,textDecoration:"line-through"},{tag:Ve.keyword,color:"#708"},{tag:[Ve.atom,Ve.bool,Ve.url,Ve.contentSeparator,Ve.labelName],color:"#219"},{tag:[Ve.literal,Ve.inserted],color:"#164"},{tag:[Ve.string,Ve.deleted],color:"#a11"},{tag:[Ve.regexp,Ve.escape,Ve.special(Ve.string)],color:"#e40"},{tag:Ve.definition(Ve.variableName),color:"#00f"},{tag:Ve.local(Ve.variableName),color:"#30a"},{tag:[Ve.typeName,Ve.namespace],color:"#085"},{tag:Ve.className,color:"#167"},{tag:[Ve.special(Ve.variableName),Ve.macroName],color:"#256"},{tag:Ve.definition(Ve.propertyName),color:"#00c"},{tag:Ve.comment,color:"#940"},{tag:Ve.invalid,color:"#f00"}]),cke=Zt.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),yQ=1e4,xQ="()[]{}",vQ=hr.define({combine(t){return Cu(t,{afterCursor:!0,brackets:xQ,maxScanDistance:yQ,renderMatch:dke})}}),uke=jr.mark({class:"cm-matchingBracket"}),hke=jr.mark({class:"cm-nonmatchingBracket"});function dke(t){let e=[],r=t.matched?uke:hke;return e.push(r.range(t.start.from,t.start.to)),t.end&&e.push(r.range(t.end.from,t.end.to)),e}const fke=co.define({create(){return jr.none},update(t,e){if(!e.docChanged&&!e.selection)return t;let r=[],n=e.state.facet(vQ);for(let i of e.state.selection.ranges){if(!i.empty)continue;let s=hu(e.state,i.head,-1,n)||i.head>0&&hu(e.state,i.head-1,1,n)||n.afterCursor&&(hu(e.state,i.head,1,n)||i.head<e.state.doc.length&&hu(e.state,i.head+1,-1,n));s&&(r=r.concat(n.renderMatch(s,e.state)))}return jr.set(r,!0)},provide:t=>Zt.decorations.from(t)}),pke=[fke,cke];function mke(t={}){return[vQ.of(t),pke]}const bQ=new nn;function IE(t,e,r){let n=t.prop(e<0?nn.openedBy:nn.closedBy);if(n)return n;if(t.name.length==1){let i=r.indexOf(t.name);if(i>-1&&i%2==(e<0?1:0))return[r[i+e]]}return null}function RE(t){let e=t.type.prop(bQ);return e?e(t.node):t}function hu(t,e,r,n={}){let i=n.maxScanDistance||yQ,s=n.brackets||xQ,a=Hi(t),o=a.resolveInner(e,r);for(let d=o;d;d=d.parent){let m=IE(d.type,r,s);if(m&&d.from<d.to){let y=RE(d);if(y&&(r>0?e>=y.from&&e<y.to:e>y.from&&e<=y.to))return gke(t,e,r,d,y,m,s)}}return yke(t,e,r,a,o.type,i,s)}function gke(t,e,r,n,i,s,a){let o=n.parent,d={from:i.from,to:i.to},m=0,y=o==null?void 0:o.cursor();if(y&&(r<0?y.childBefore(n.from):y.childAfter(n.to)))do if(r<0?y.to<=n.from:y.from>=n.to){if(m==0&&s.indexOf(y.type.name)>-1&&y.from<y.to){let v=RE(y);return{start:d,end:v?{from:v.from,to:v.to}:void 0,matched:!0}}else if(IE(y.type,r,a))m++;else if(IE(y.type,-r,a)){if(m==0){let v=RE(y);return{start:d,end:v&&v.from<v.to?{from:v.from,to:v.to}:void 0,matched:!1}}m--}}while(r<0?y.prevSibling():y.nextSibling());return{start:d,matched:!1}}function yke(t,e,r,n,i,s,a){let o=r<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),d=a.indexOf(o);if(d<0||d%2==0!=r>0)return null;let m={from:r<0?e-1:e,to:r>0?e+1:e},y=t.doc.iterRange(e,r>0?t.doc.length:0),v=0;for(let w=0;!y.next().done&&w<=s;){let O=y.value;r<0&&(w+=O.length);let P=e+w*r;for(let E=r>0?0:O.length-1,$=r>0?O.length:-1;E!=$;E+=r){let R=a.indexOf(O[E]);if(!(R<0||n.resolveInner(P+E,1).type!=i))if(R%2==0==r>0)v++;else{if(v==1)return{start:m,end:{from:P+E,to:P+E+1},matched:R>>1==d>>1};v--}}r>0&&(w+=O.length)}return y.done?{start:m,matched:!1}:null}const xke=Object.create(null),TB=[za.none],OB=[],jB=Object.create(null),vke=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])vke[t]=bke(xke,e);function Tj(t,e){OB.indexOf(t)>-1||(OB.push(t),console.warn(e))}function bke(t,e){let r=[];for(let o of e.split(" ")){let d=[];for(let m of o.split(".")){let y=t[m]||Ve[m];y?typeof y=="function"?d.length?d=d.map(y):Tj(m,`Modifier ${m} used at start of tag`):d.length?Tj(m,`Tag ${m} used as modifier`):d=Array.isArray(y)?y:[y]:Tj(m,`Unknown highlighting tag ${m}`)}for(let m of d)r.push(m)}if(!r.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+r.map(o=>o.id),s=jB[i];if(s)return s.id;let a=jB[i]=za.define({id:TB.length,name:n,props:[bC({[n]:r})]});return TB.push(a),a.id}ti.RTL,ti.LTR;const _ke=t=>{let{state:e}=t,r=e.doc.lineAt(e.selection.main.from),n=uI(t.state,r.from);return n.line?wke(t):n.block?kke(t):!1};function cI(t,e){return({state:r,dispatch:n})=>{if(r.readOnly)return!1;let i=t(e,r);return i?(n(r.update(i)),!0):!1}}const wke=cI(Oke,0),Ske=cI(_Q,0),kke=cI((t,e)=>_Q(t,e,Tke(e)),0);function uI(t,e){let r=t.languageDataAt("commentTokens",e,1);return r.length?r[0]:{}}const Zx=50;function Cke(t,{open:e,close:r},n,i){let s=t.sliceDoc(n-Zx,n),a=t.sliceDoc(i,i+Zx),o=/\s*$/.exec(s)[0].length,d=/^\s*/.exec(a)[0].length,m=s.length-o;if(s.slice(m-e.length,m)==e&&a.slice(d,d+r.length)==r)return{open:{pos:n-o,margin:o&&1},close:{pos:i+d,margin:d&&1}};let y,v;i-n<=2*Zx?y=v=t.sliceDoc(n,i):(y=t.sliceDoc(n,n+Zx),v=t.sliceDoc(i-Zx,i));let w=/^\s*/.exec(y)[0].length,O=/\s*$/.exec(v)[0].length,P=v.length-O-r.length;return y.slice(w,w+e.length)==e&&v.slice(P,P+r.length)==r?{open:{pos:n+w+e.length,margin:/\s/.test(y.charAt(w+e.length))?1:0},close:{pos:i-O-r.length,margin:/\s/.test(v.charAt(P-1))?1:0}}:null}function Tke(t){let e=[];for(let r of t.selection.ranges){let n=t.doc.lineAt(r.from),i=r.to<=n.to?n:t.doc.lineAt(r.to);i.from>n.from&&i.from==r.to&&(i=r.to==n.to+1?n:t.doc.lineAt(r.to-1));let s=e.length-1;s>=0&&e[s].to>n.from?e[s].to=i.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:i.to})}return e}function _Q(t,e,r=e.selection.ranges){let n=r.map(s=>uI(e,s.from).block);if(!n.every(s=>s))return null;let i=r.map((s,a)=>Cke(e,n[a],s.from,s.to));if(t!=2&&!i.every(s=>s))return{changes:e.changes(r.map((s,a)=>i[a]?[]:[{from:s.from,insert:n[a].open+" "},{from:s.to,insert:" "+n[a].close}]))};if(t!=1&&i.some(s=>s)){let s=[];for(let a=0,o;a<i.length;a++)if(o=i[a]){let d=n[a],{open:m,close:y}=o;s.push({from:m.pos-d.open.length,to:m.pos+m.margin},{from:y.pos-y.margin,to:y.pos+d.close.length})}return{changes:s}}return null}function Oke(t,e,r=e.selection.ranges){let n=[],i=-1;e:for(let{from:s,to:a}of r){let o=n.length,d=1e9,m;for(let y=s;y<=a;){let v=e.doc.lineAt(y);if(m==null&&(m=uI(e,v.from).line,!m))continue e;if(v.from>i&&(s==a||a>v.from)){i=v.from;let w=/^\s*/.exec(v.text)[0].length,O=w==v.length,P=v.text.slice(w,w+m.length)==m?w:-1;w<v.text.length&&w<d&&(d=w),n.push({line:v,comment:P,token:m,indent:w,empty:O,single:!1})}y=v.to+1}if(d<1e9)for(let y=o;y<n.length;y++)n[y].indent<n[y].line.text.length&&(n[y].indent=d);n.length==o+1&&(n[o].single=!0)}if(t!=2&&n.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:o,token:d,indent:m,empty:y,single:v}of n)(v||!y)&&s.push({from:o.from+m,insert:d+" "});let a=e.changes(s);return{changes:a,selection:e.selection.map(a,1)}}else if(t!=1&&n.some(s=>s.comment>=0)){let s=[];for(let{line:a,comment:o,token:d}of n)if(o>=0){let m=a.from+o,y=m+d.length;a.text[y-a.from]==" "&&y++,s.push({from:m,to:y})}return{changes:s}}return null}const DE=ku.define(),jke=ku.define(),Pke=hr.define(),wQ=hr.define({combine(t){return Cu(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,r)=>r},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,r)=>(n,i)=>e(n,i)||r(n,i)})}}),SQ=co.define({create(){return du.empty},update(t,e){let r=e.state.facet(wQ),n=e.annotation(DE);if(n){let d=Sa.fromTransaction(e,n.selection),m=n.side,y=m==0?t.undone:t.done;return d?y=H2(y,y.length,r.minDepth,d):y=TQ(y,e.startState.selection),new du(m==0?n.rest:y,m==0?y:n.rest)}let i=e.annotation(jke);if((i=="full"||i=="before")&&(t=t.isolate()),e.annotation(_s.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let s=Sa.fromTransaction(e),a=e.annotation(_s.time),o=e.annotation(_s.userEvent);return s?t=t.addChanges(s,a,o,r,e):e.selection&&(t=t.addSelection(e.startState.selection,a,o,r.newGroupDelay)),(i=="full"||i=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new du(t.done.map(Sa.fromJSON),t.undone.map(Sa.fromJSON))}});function Ake(t={}){return[SQ,wQ.of(t),Zt.domEventHandlers({beforeinput(e,r){let n=e.inputType=="historyUndo"?kQ:e.inputType=="historyRedo"?LE:null;return n?(e.preventDefault(),n(r)):!1}})]}function TC(t,e){return function({state:r,dispatch:n}){if(!e&&r.readOnly)return!1;let i=r.field(SQ,!1);if(!i)return!1;let s=i.pop(t,r,e);return s?(n(s),!0):!1}}const kQ=TC(0,!1),LE=TC(1,!1),Eke=TC(0,!0),zke=TC(1,!0);class Sa{constructor(e,r,n,i,s){this.changes=e,this.effects=r,this.mapped=n,this.startSelection=i,this.selectionsAfter=s}setSelAfter(e){return new Sa(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,r,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(r=this.mapped)===null||r===void 0?void 0:r.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(i=>i.toJSON())}}static fromJSON(e){return new Sa(e.changes&&ms.fromJSON(e.changes),[],e.mapped&&bu.fromJSON(e.mapped),e.startSelection&&pt.fromJSON(e.startSelection),e.selectionsAfter.map(pt.fromJSON))}static fromTransaction(e,r){let n=Rl;for(let i of e.startState.facet(Pke)){let s=i(e);s.length&&(n=n.concat(s))}return!n.length&&e.changes.empty?null:new Sa(e.changes.invert(e.startState.doc),n,void 0,r||e.startState.selection,Rl)}static selection(e){return new Sa(void 0,Rl,void 0,void 0,e)}}function H2(t,e,r,n){let i=e+1>r+20?e-r-1:0,s=t.slice(i,e);return s.push(n),s}function Mke(t,e){let r=[],n=!1;return t.iterChangedRanges((i,s)=>r.push(i,s)),e.iterChangedRanges((i,s,a,o)=>{for(let d=0;d<r.length;){let m=r[d++],y=r[d++];o>=m&&a<=y&&(n=!0)}}),n}function Ike(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((r,n)=>r.empty!=e.ranges[n].empty).length===0}function CQ(t,e){return t.length?e.length?t.concat(e):t:e}const Rl=[],Rke=200;function TQ(t,e){if(t.length){let r=t[t.length-1],n=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-Rke));return n.length&&n[n.length-1].eq(e)?t:(n.push(e),H2(t,t.length-1,1e9,r.setSelAfter(n)))}else return[Sa.selection([e])]}function Dke(t){let e=t[t.length-1],r=t.slice();return r[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),r}function Oj(t,e){if(!t.length)return t;let r=t.length,n=Rl;for(;r;){let i=Lke(t[r-1],e,n);if(i.changes&&!i.changes.empty||i.effects.length){let s=t.slice(0,r);return s[r-1]=i,s}else e=i.mapped,r--,n=i.selectionsAfter}return n.length?[Sa.selection(n)]:Rl}function Lke(t,e,r){let n=CQ(t.selectionsAfter.length?t.selectionsAfter.map(o=>o.map(e)):Rl,r);if(!t.changes)return Sa.selection(n);let i=t.changes.map(e),s=e.mapDesc(t.changes,!0),a=t.mapped?t.mapped.composeDesc(s):s;return new Sa(i,Qr.mapEffects(t.effects,e),a,t.startSelection.map(s),n)}const Fke=/^(input\.type|delete)($|\.)/;class du{constructor(e,r,n=0,i=void 0){this.done=e,this.undone=r,this.prevTime=n,this.prevUserEvent=i}isolate(){return this.prevTime?new du(this.done,this.undone):this}addChanges(e,r,n,i,s){let a=this.done,o=a[a.length-1];return o&&o.changes&&!o.changes.empty&&e.changes&&(!n||Fke.test(n))&&(!o.selectionsAfter.length&&r-this.prevTime<i.newGroupDelay&&i.joinToEvent(s,Mke(o.changes,e.changes))||n=="input.type.compose")?a=H2(a,a.length-1,i.minDepth,new Sa(e.changes.compose(o.changes),CQ(Qr.mapEffects(e.effects,o.changes),o.effects),o.mapped,o.startSelection,Rl)):a=H2(a,a.length,i.minDepth,e),new du(a,Rl,r,n)}addSelection(e,r,n,i){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Rl;return s.length>0&&r-this.prevTime<i&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&Ike(s[s.length-1],e)?this:new du(TQ(this.done,e),this.undone,r,n)}addMapping(e){return new du(Oj(this.done,e),Oj(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,r,n){let i=e==0?this.done:this.undone;if(i.length==0)return null;let s=i[i.length-1],a=s.selectionsAfter[0]||(s.startSelection?s.startSelection.map(s.changes.invertedDesc,1):r.selection);if(n&&s.selectionsAfter.length)return r.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:DE.of({side:e,rest:Dke(i),selection:a}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let o=i.length==1?Rl:i.slice(0,i.length-1);return s.mapped&&(o=Oj(o,s.mapped)),r.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:DE.of({side:e,rest:o,selection:a}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}du.empty=new du(Rl,Rl);const Bke=[{key:"Mod-z",run:kQ,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:LE,preventDefault:!0},{linux:"Ctrl-Shift-z",run:LE,preventDefault:!0},{key:"Mod-u",run:Eke,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:zke,preventDefault:!0}];function T0(t,e){return pt.create(t.ranges.map(e),t.mainIndex)}function Tc(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Oc({state:t,dispatch:e},r){let n=T0(t.selection,r);return n.eq(t.selection,!0)?!1:(e(Tc(t,n)),!0)}function OC(t,e){return pt.cursor(e?t.to:t.from)}function OQ(t,e){return Oc(t,r=>r.empty?t.moveByChar(r,e):OC(r,e))}function Oo(t){return t.textDirectionAt(t.state.selection.main.head)==ti.LTR}const jQ=t=>OQ(t,!Oo(t)),PQ=t=>OQ(t,Oo(t));function AQ(t,e){return Oc(t,r=>r.empty?t.moveByGroup(r,e):OC(r,e))}const $ke=t=>AQ(t,!Oo(t)),Nke=t=>AQ(t,Oo(t));function Vke(t,e,r){if(e.type.prop(r))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function jC(t,e,r){let n=Hi(t).resolveInner(e.head),i=r?nn.closedBy:nn.openedBy;for(let d=e.head;;){let m=r?n.childAfter(d):n.childBefore(d);if(!m)break;Vke(t,m,i)?n=m:d=r?m.to:m.from}let s=n.type.prop(i),a,o;return s&&(a=r?hu(t,n.from,1):hu(t,n.to,-1))&&a.matched?o=r?a.end.to:a.end.from:o=r?n.to:n.from,pt.cursor(o,r?-1:1)}const Wke=t=>Oc(t,e=>jC(t.state,e,!Oo(t))),Uke=t=>Oc(t,e=>jC(t.state,e,Oo(t)));function EQ(t,e){return Oc(t,r=>{if(!r.empty)return OC(r,e);let n=t.moveVertically(r,e);return n.head!=r.head?n:t.moveToLineBoundary(r,e)})}const zQ=t=>EQ(t,!1),MQ=t=>EQ(t,!0);function IQ(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,r=0,n=0,i;if(e){for(let s of t.state.facet(Zt.scrollMargins)){let a=s(t);a!=null&&a.top&&(r=Math.max(a==null?void 0:a.top,r)),a!=null&&a.bottom&&(n=Math.max(a==null?void 0:a.bottom,n))}i=t.scrollDOM.clientHeight-r-n}else i=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:n,selfScroll:e,height:Math.max(t.defaultLineHeight,i-5)}}function RQ(t,e){let r=IQ(t),{state:n}=t,i=T0(n.selection,a=>a.empty?t.moveVertically(a,e,r.height):OC(a,e));if(i.eq(n.selection))return!1;let s;if(r.selfScroll){let a=t.coordsAtPos(n.selection.main.head),o=t.scrollDOM.getBoundingClientRect(),d=o.top+r.marginTop,m=o.bottom-r.marginBottom;a&&a.top>d&&a.bottom<m&&(s=Zt.scrollIntoView(i.main.head,{y:"start",yMargin:a.top-d}))}return t.dispatch(Tc(n,i),{effects:s}),!0}const PB=t=>RQ(t,!1),FE=t=>RQ(t,!0);function Cf(t,e,r){let n=t.lineBlockAt(e.head),i=t.moveToLineBoundary(e,r);if(i.head==e.head&&i.head!=(r?n.to:n.from)&&(i=t.moveToLineBoundary(e,r,!1)),!r&&i.head==n.from&&n.length){let s=/^\s*/.exec(t.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;s&&e.head!=n.from+s&&(i=pt.cursor(n.from+s))}return i}const qke=t=>Oc(t,e=>Cf(t,e,!0)),Qke=t=>Oc(t,e=>Cf(t,e,!1)),Hke=t=>Oc(t,e=>Cf(t,e,!Oo(t))),Gke=t=>Oc(t,e=>Cf(t,e,Oo(t))),Xke=t=>Oc(t,e=>pt.cursor(t.lineBlockAt(e.head).from,1)),Kke=t=>Oc(t,e=>pt.cursor(t.lineBlockAt(e.head).to,-1));function Zke(t,e,r){let n=!1,i=T0(t.selection,s=>{let a=hu(t,s.head,-1)||hu(t,s.head,1)||s.head>0&&hu(t,s.head-1,1)||s.head<t.doc.length&&hu(t,s.head+1,-1);if(!a||!a.end)return s;n=!0;let o=a.start.from==s.head?a.end.to:a.end.from;return pt.cursor(o)});return n?(e(Tc(t,i)),!0):!1}const Yke=({state:t,dispatch:e})=>Zke(t,e);function Gl(t,e){let r=T0(t.state.selection,n=>{let i=e(n);return pt.range(n.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)});return r.eq(t.state.selection)?!1:(t.dispatch(Tc(t.state,r)),!0)}function DQ(t,e){return Gl(t,r=>t.moveByChar(r,e))}const LQ=t=>DQ(t,!Oo(t)),FQ=t=>DQ(t,Oo(t));function BQ(t,e){return Gl(t,r=>t.moveByGroup(r,e))}const Jke=t=>BQ(t,!Oo(t)),eCe=t=>BQ(t,Oo(t)),tCe=t=>Gl(t,e=>jC(t.state,e,!Oo(t))),rCe=t=>Gl(t,e=>jC(t.state,e,Oo(t)));function $Q(t,e){return Gl(t,r=>t.moveVertically(r,e))}const NQ=t=>$Q(t,!1),VQ=t=>$Q(t,!0);function WQ(t,e){return Gl(t,r=>t.moveVertically(r,e,IQ(t).height))}const AB=t=>WQ(t,!1),EB=t=>WQ(t,!0),nCe=t=>Gl(t,e=>Cf(t,e,!0)),iCe=t=>Gl(t,e=>Cf(t,e,!1)),sCe=t=>Gl(t,e=>Cf(t,e,!Oo(t))),oCe=t=>Gl(t,e=>Cf(t,e,Oo(t))),aCe=t=>Gl(t,e=>pt.cursor(t.lineBlockAt(e.head).from)),lCe=t=>Gl(t,e=>pt.cursor(t.lineBlockAt(e.head).to)),zB=({state:t,dispatch:e})=>(e(Tc(t,{anchor:0})),!0),MB=({state:t,dispatch:e})=>(e(Tc(t,{anchor:t.doc.length})),!0),IB=({state:t,dispatch:e})=>(e(Tc(t,{anchor:t.selection.main.anchor,head:0})),!0),RB=({state:t,dispatch:e})=>(e(Tc(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),cCe=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),uCe=({state:t,dispatch:e})=>{let r=PC(t).map(({from:n,to:i})=>pt.range(n,Math.min(i+1,t.doc.length)));return e(t.update({selection:pt.create(r),userEvent:"select"})),!0},hCe=({state:t,dispatch:e})=>{let r=T0(t.selection,n=>{let i=Hi(t),s=i.resolveStack(n.from,1);if(n.empty){let a=i.resolveStack(n.from,-1);a.node.from>=s.node.from&&a.node.to<=s.node.to&&(s=a)}for(let a=s;a;a=a.next){let{node:o}=a;if((o.from<n.from&&o.to>=n.to||o.to>n.to&&o.from<=n.from)&&a.next)return pt.range(o.to,o.from)}return n});return r.eq(t.selection)?!1:(e(Tc(t,r)),!0)};function UQ(t,e){let{state:r}=t,n=r.selection,i=r.selection.ranges.slice();for(let s of r.selection.ranges){let a=r.doc.lineAt(s.head);if(e?a.to<t.state.doc.length:a.from>0)for(let o=s;;){let d=t.moveVertically(o,e);if(d.head<a.from||d.head>a.to){i.some(m=>m.head==d.head)||i.push(d);break}else{if(d.head==o.head)break;o=d}}}return i.length==n.ranges.length?!1:(t.dispatch(Tc(r,pt.create(i,i.length-1))),!0)}const dCe=t=>UQ(t,!1),fCe=t=>UQ(t,!0),pCe=({state:t,dispatch:e})=>{let r=t.selection,n=null;return r.ranges.length>1?n=pt.create([r.main]):r.main.empty||(n=pt.create([pt.cursor(r.main.head)])),n?(e(Tc(t,n)),!0):!1};function W1(t,e){if(t.state.readOnly)return!1;let r="delete.selection",{state:n}=t,i=n.changeByRange(s=>{let{from:a,to:o}=s;if(a==o){let d=e(s);d<a?(r="delete.backward",d=Nw(t,d,!1)):d>a&&(r="delete.forward",d=Nw(t,d,!0)),a=Math.min(a,d),o=Math.max(o,d)}else a=Nw(t,a,!1),o=Nw(t,o,!0);return a==o?{range:s}:{changes:{from:a,to:o},range:pt.cursor(a,a<s.head?-1:1)}});return i.changes.empty?!1:(t.dispatch(n.update(i,{scrollIntoView:!0,userEvent:r,effects:r=="delete.selection"?Zt.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function Nw(t,e,r){if(t instanceof Zt)for(let n of t.state.facet(Zt.atomicRanges).map(i=>i(t)))n.between(e,e,(i,s)=>{i<e&&s>e&&(e=r?s:i)});return e}const qQ=(t,e,r)=>W1(t,n=>{let i=n.from,{state:s}=t,a=s.doc.lineAt(i),o,d;if(r&&!e&&i>a.from&&i<a.from+200&&!/[^ \t]/.test(o=a.text.slice(0,i-a.from))){if(o[o.length-1]=="	")return i-1;let m=C0(o,s.tabSize),y=m%U2(s)||U2(s);for(let v=0;v<y&&o[o.length-1-v]==" ";v++)i--;d=i}else d=bs(a.text,i-a.from,e,e)+a.from,d==i&&a.number!=(e?s.doc.lines:1)?d+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(d-a.from,i-a.from))&&(d=bs(a.text,d-a.from,!1,!1)+a.from);return d}),BE=t=>qQ(t,!1,!0),QQ=t=>qQ(t,!0,!1),HQ=(t,e)=>W1(t,r=>{let n=r.head,{state:i}=t,s=i.doc.lineAt(n),a=i.charCategorizer(n);for(let o=null;;){if(n==(e?s.to:s.from)){n==r.head&&s.number!=(e?i.doc.lines:1)&&(n+=e?1:-1);break}let d=bs(s.text,n-s.from,e)+s.from,m=s.text.slice(Math.min(n,d)-s.from,Math.max(n,d)-s.from),y=a(m);if(o!=null&&y!=o)break;(m!=" "||n!=r.head)&&(o=y),n=d}return n}),GQ=t=>HQ(t,!1),mCe=t=>HQ(t,!0),gCe=t=>W1(t,e=>{let r=t.lineBlockAt(e.head).to;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)}),yCe=t=>W1(t,e=>{let r=t.moveToLineBoundary(e,!1).head;return e.head>r?r:Math.max(0,e.head-1)}),xCe=t=>W1(t,e=>{let r=t.moveToLineBoundary(e,!0).head;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)}),vCe=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:Sn.of(["",""])},range:pt.cursor(n.from)}));return e(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0},bCe=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>{if(!n.empty||n.from==0||n.from==t.doc.length)return{range:n};let i=n.from,s=t.doc.lineAt(i),a=i==s.from?i-1:bs(s.text,i-s.from,!1)+s.from,o=i==s.to?i+1:bs(s.text,i-s.from,!0)+s.from;return{changes:{from:a,to:o,insert:t.doc.slice(i,o).append(t.doc.slice(a,i))},range:pt.cursor(o)}});return r.changes.empty?!1:(e(t.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function PC(t){let e=[],r=-1;for(let n of t.selection.ranges){let i=t.doc.lineAt(n.from),s=t.doc.lineAt(n.to);if(!n.empty&&n.to==s.from&&(s=t.doc.lineAt(n.to-1)),r>=i.number){let a=e[e.length-1];a.to=s.to,a.ranges.push(n)}else e.push({from:i.from,to:s.to,ranges:[n]});r=s.number+1}return e}function XQ(t,e,r){if(t.readOnly)return!1;let n=[],i=[];for(let s of PC(t)){if(r?s.to==t.doc.length:s.from==0)continue;let a=t.doc.lineAt(r?s.to+1:s.from-1),o=a.length+1;if(r){n.push({from:s.to,to:a.to},{from:s.from,insert:a.text+t.lineBreak});for(let d of s.ranges)i.push(pt.range(Math.min(t.doc.length,d.anchor+o),Math.min(t.doc.length,d.head+o)))}else{n.push({from:a.from,to:s.from},{from:s.to,insert:t.lineBreak+a.text});for(let d of s.ranges)i.push(pt.range(d.anchor-o,d.head-o))}}return n.length?(e(t.update({changes:n,scrollIntoView:!0,selection:pt.create(i,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const _Ce=({state:t,dispatch:e})=>XQ(t,e,!1),wCe=({state:t,dispatch:e})=>XQ(t,e,!0);function KQ(t,e,r){if(t.readOnly)return!1;let n=[];for(let s of PC(t))r?n.push({from:s.from,insert:t.doc.slice(s.from,s.to)+t.lineBreak}):n.push({from:s.to,insert:t.lineBreak+t.doc.slice(s.from,s.to)});let i=t.changes(n);return e(t.update({changes:i,selection:t.selection.map(i,r?1:-1),scrollIntoView:!0,userEvent:"input.copyline"})),!0}const SCe=({state:t,dispatch:e})=>KQ(t,e,!1),kCe=({state:t,dispatch:e})=>KQ(t,e,!0),CCe=t=>{if(t.state.readOnly)return!1;let{state:e}=t,r=e.changes(PC(e).map(({from:i,to:s})=>(i>0?i--:s<e.doc.length&&s++,{from:i,to:s}))),n=T0(e.selection,i=>{let s;if(t.lineWrapping){let a=t.lineBlockAt(i.head),o=t.coordsAtPos(i.head,i.assoc||1);o&&(s=a.bottom+t.documentTop-o.bottom+t.defaultLineHeight/2)}return t.moveVertically(i,!0,s)}).map(r);return t.dispatch({changes:r,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function TCe(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let r=Hi(t).resolveInner(e),n=r.childBefore(e),i=r.childAfter(e),s;return n&&i&&n.to<=e&&i.from>=e&&(s=n.type.prop(nn.closedBy))&&s.indexOf(i.name)>-1&&t.doc.lineAt(n.to).from==t.doc.lineAt(i.from).from&&!/\S/.test(t.sliceDoc(n.to,i.from))?{from:n.to,to:i.from}:null}const DB=ZQ(!1),OCe=ZQ(!0);function ZQ(t){return({state:e,dispatch:r})=>{if(e.readOnly)return!1;let n=e.changeByRange(i=>{let{from:s,to:a}=i,o=e.doc.lineAt(s),d=!t&&s==a&&TCe(e,s);t&&(s=a=(a<=o.to?o:e.doc.lineAt(a)).to);let m=new wC(e,{simulateBreak:s,simulateDoubleBreak:!!d}),y=aI(m,s);for(y==null&&(y=C0(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));a<o.to&&/\s/.test(o.text[a-o.from]);)a++;d?{from:s,to:a}=d:s>o.from&&s<o.from+100&&!/\S/.test(o.text.slice(0,s))&&(s=o.from);let v=["",qb(e,y)];return d&&v.push(qb(e,m.lineIndent(o.from,-1))),{changes:{from:s,to:a,insert:Sn.of(v)},range:pt.cursor(s+1+v[1].length)}});return r(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function hI(t,e){let r=-1;return t.changeByRange(n=>{let i=[];for(let a=n.from;a<=n.to;){let o=t.doc.lineAt(a);o.number>r&&(n.empty||n.to>o.from)&&(e(o,i,n),r=o.number),a=o.to+1}let s=t.changes(i);return{changes:i,range:pt.range(s.mapPos(n.anchor,1),s.mapPos(n.head,1))}})}const jCe=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=Object.create(null),n=new wC(t,{overrideIndentation:s=>{let a=r[s];return a??-1}}),i=hI(t,(s,a,o)=>{let d=aI(n,s.from);if(d==null)return;/\S/.test(s.text)||(d=0);let m=/^\s*/.exec(s.text)[0],y=qb(t,d);(m!=y||o.from<s.from+m.length)&&(r[s.from]=d,a.push({from:s.from,to:s.from+m.length,insert:y}))});return i.changes.empty||e(t.update(i,{userEvent:"indent"})),!0},YQ=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(hI(t,(r,n)=>{n.push({from:r.from,insert:t.facet(_C)})}),{userEvent:"input.indent"})),!0),JQ=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(hI(t,(r,n)=>{let i=/^\s*/.exec(r.text)[0];if(!i)return;let s=C0(i,t.tabSize),a=0,o=qb(t,Math.max(0,s-U2(t)));for(;a<i.length&&a<o.length&&i.charCodeAt(a)==o.charCodeAt(a);)a++;n.push({from:r.from+a,to:r.from+i.length,insert:o.slice(a)})}),{userEvent:"delete.dedent"})),!0),PCe=t=>(t.setTabFocusMode(),!0),ACe=[{key:"Ctrl-b",run:jQ,shift:LQ,preventDefault:!0},{key:"Ctrl-f",run:PQ,shift:FQ},{key:"Ctrl-p",run:zQ,shift:NQ},{key:"Ctrl-n",run:MQ,shift:VQ},{key:"Ctrl-a",run:Xke,shift:aCe},{key:"Ctrl-e",run:Kke,shift:lCe},{key:"Ctrl-d",run:QQ},{key:"Ctrl-h",run:BE},{key:"Ctrl-k",run:gCe},{key:"Ctrl-Alt-h",run:GQ},{key:"Ctrl-o",run:vCe},{key:"Ctrl-t",run:bCe},{key:"Ctrl-v",run:FE}],ECe=[{key:"ArrowLeft",run:jQ,shift:LQ,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:$ke,shift:Jke,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Hke,shift:sCe,preventDefault:!0},{key:"ArrowRight",run:PQ,shift:FQ,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Nke,shift:eCe,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Gke,shift:oCe,preventDefault:!0},{key:"ArrowUp",run:zQ,shift:NQ,preventDefault:!0},{mac:"Cmd-ArrowUp",run:zB,shift:IB},{mac:"Ctrl-ArrowUp",run:PB,shift:AB},{key:"ArrowDown",run:MQ,shift:VQ,preventDefault:!0},{mac:"Cmd-ArrowDown",run:MB,shift:RB},{mac:"Ctrl-ArrowDown",run:FE,shift:EB},{key:"PageUp",run:PB,shift:AB},{key:"PageDown",run:FE,shift:EB},{key:"Home",run:Qke,shift:iCe,preventDefault:!0},{key:"Mod-Home",run:zB,shift:IB},{key:"End",run:qke,shift:nCe,preventDefault:!0},{key:"Mod-End",run:MB,shift:RB},{key:"Enter",run:DB,shift:DB},{key:"Mod-a",run:cCe},{key:"Backspace",run:BE,shift:BE,preventDefault:!0},{key:"Delete",run:QQ,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:GQ,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:mCe,preventDefault:!0},{mac:"Mod-Backspace",run:yCe,preventDefault:!0},{mac:"Mod-Delete",run:xCe,preventDefault:!0}].concat(ACe.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),zCe=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Wke,shift:tCe},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Uke,shift:rCe},{key:"Alt-ArrowUp",run:_Ce},{key:"Shift-Alt-ArrowUp",run:SCe},{key:"Alt-ArrowDown",run:wCe},{key:"Shift-Alt-ArrowDown",run:kCe},{key:"Mod-Alt-ArrowUp",run:dCe},{key:"Mod-Alt-ArrowDown",run:fCe},{key:"Escape",run:pCe},{key:"Mod-Enter",run:OCe},{key:"Alt-l",mac:"Ctrl-l",run:uCe},{key:"Mod-i",run:hCe,preventDefault:!0},{key:"Mod-[",run:JQ},{key:"Mod-]",run:YQ},{key:"Mod-Alt-\\",run:jCe},{key:"Shift-Mod-k",run:CCe},{key:"Shift-Mod-\\",run:Yke},{key:"Mod-/",run:_ke},{key:"Alt-A",run:Ske},{key:"Ctrl-m",mac:"Shift-Alt-m",run:PCe}].concat(ECe),MCe={key:"Tab",run:YQ,shift:JQ},LB=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class f0{constructor(e,r,n=0,i=e.length,s,a){this.test=a,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,i),this.bufferStart=n,this.normalize=s?o=>s(LB(o)):LB,this.query=this.normalize(r)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ma(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let r=LM(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=au(e);let i=this.normalize(r);if(i.length)for(let s=0,a=n;;s++){let o=i.charCodeAt(s),d=this.match(o,a,this.bufferPos+this.bufferStart);if(s==i.length-1){if(d)return this.value=d,this;break}a==n&&s<r.length&&r.charCodeAt(s)==o&&a++}}}match(e,r,n){let i=null;for(let s=0;s<this.matches.length;s+=2){let a=this.matches[s],o=!1;this.query.charCodeAt(a)==e&&(a==this.query.length-1?i={from:this.matches[s+1],to:n}:(this.matches[s]++,o=!0)),o||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:r,to:n}:this.matches.push(1,r)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}}typeof Symbol<"u"&&(f0.prototype[Symbol.iterator]=function(){return this});const eH={from:-1,to:-1,match:/.*/.exec("")},dI="gm"+(/x/.unicode==null?"":"u");class tH{constructor(e,r,n,i=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=eH,/\\[sWDnr]|\n|\r|\[\^/.test(r))return new rH(e,r,n,i,s);this.re=new RegExp(r,dI+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.iter=e.iter();let a=e.lineAt(i);this.curLineStart=a.from,this.matchPos=G2(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let r=this.matchPos<=this.to&&this.re.exec(this.curLine);if(r){let n=this.curLineStart+r.index,i=n+r[0].length;if(this.matchPos=G2(this.text,i+(n==i?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<i||n>this.value.to)&&(!this.test||this.test(n,i,r)))return this.value={from:n,to:i,match:r},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const jj=new WeakMap;class wy{constructor(e,r){this.from=e,this.text=r}get to(){return this.from+this.text.length}static get(e,r,n){let i=jj.get(e);if(!i||i.from>=n||i.to<=r){let o=new wy(r,e.sliceString(r,n));return jj.set(e,o),o}if(i.from==r&&i.to==n)return i;let{text:s,from:a}=i;return a>r&&(s=e.sliceString(r,a)+s,a=r),i.to<n&&(s+=e.sliceString(i.to,n)),jj.set(e,new wy(a,s)),new wy(r,s.slice(r-a,n-a))}}class rH{constructor(e,r,n,i,s){this.text=e,this.to=s,this.done=!1,this.value=eH,this.matchPos=G2(e,i),this.re=new RegExp(r,dI+(n!=null&&n.ignoreCase?"i":"")),this.test=n==null?void 0:n.test,this.flat=wy.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,r=this.re.exec(this.flat.text);if(r&&!r[0]&&r.index==e&&(this.re.lastIndex=e+1,r=this.re.exec(this.flat.text)),r){let n=this.flat.from+r.index,i=n+r[0].length;if((this.flat.to>=this.to||r.index+r[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,i,r)))return this.value={from:n,to:i,match:r},this.matchPos=G2(this.text,i+(n==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=wy.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(tH.prototype[Symbol.iterator]=rH.prototype[Symbol.iterator]=function(){return this});function ICe(t){try{return new RegExp(t,dI),!0}catch{return!1}}function G2(t,e){if(e>=t.length)return e;let r=t.lineAt(e),n;for(;e<r.to&&(n=r.text.charCodeAt(e-r.from))>=56320&&n<57344;)e++;return e}const RCe=t=>{let{state:e}=t,r=String(e.doc.lineAt(t.state.selection.main.head).number),{close:n,result:i}=e2e(t,{label:e.phrase("Go to line"),input:{type:"text",name:"line",value:r},focus:!0,submitLabel:e.phrase("go")});return i.then(s=>{let a=s&&/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(s.elements.line.value);if(!a){t.dispatch({effects:n});return}let o=e.doc.lineAt(e.selection.main.head),[,d,m,y,v]=a,w=y?+y.slice(1):0,O=m?+m:o.number;if(m&&v){let $=O/100;d&&($=$*(d=="-"?-1:1)+o.number/e.doc.lines),O=Math.round(e.doc.lines*$)}else m&&d&&(O=O*(d=="-"?-1:1)+o.number);let P=e.doc.line(Math.max(1,Math.min(e.doc.lines,O))),E=pt.cursor(P.from+Math.max(0,Math.min(w,P.length)));t.dispatch({effects:[n,Zt.scrollIntoView(E.from,{y:"center"})],selection:E})}),!0},DCe={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},LCe=hr.define({combine(t){return Cu(t,DCe,{highlightWordAroundCursor:(e,r)=>e||r,minSelectionLength:Math.min,maxMatches:Math.min})}});function FCe(t){return[WCe,VCe]}const BCe=jr.mark({class:"cm-selectionMatch"}),$Ce=jr.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function FB(t,e,r,n){return(r==0||t(e.sliceDoc(r-1,r))!=vi.Word)&&(n==e.doc.length||t(e.sliceDoc(n,n+1))!=vi.Word)}function NCe(t,e,r,n){return t(e.sliceDoc(r,r+1))==vi.Word&&t(e.sliceDoc(n-1,n))==vi.Word}const VCe=Qi.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(LCe),{state:r}=t,n=r.selection;if(n.ranges.length>1)return jr.none;let i=n.main,s,a=null;if(i.empty){if(!e.highlightWordAroundCursor)return jr.none;let d=r.wordAt(i.head);if(!d)return jr.none;a=r.charCategorizer(i.head),s=r.sliceDoc(d.from,d.to)}else{let d=i.to-i.from;if(d<e.minSelectionLength||d>200)return jr.none;if(e.wholeWords){if(s=r.sliceDoc(i.from,i.to),a=r.charCategorizer(i.head),!(FB(a,r,i.from,i.to)&&NCe(a,r,i.from,i.to)))return jr.none}else if(s=r.sliceDoc(i.from,i.to),!s)return jr.none}let o=[];for(let d of t.visibleRanges){let m=new f0(r.doc,s,d.from,d.to);for(;!m.next().done;){let{from:y,to:v}=m.value;if((!a||FB(a,r,y,v))&&(i.empty&&y<=i.from&&v>=i.to?o.push($Ce.range(y,v)):(y>=i.to||v<=i.from)&&o.push(BCe.range(y,v)),o.length>e.maxMatches))return jr.none}}return jr.set(o)}},{decorations:t=>t.decorations}),WCe=Zt.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),UCe=({state:t,dispatch:e})=>{let{selection:r}=t,n=pt.create(r.ranges.map(i=>t.wordAt(i.head)||pt.cursor(i.head)),r.mainIndex);return n.eq(r)?!1:(e(t.update({selection:n})),!0)};function qCe(t,e){let{main:r,ranges:n}=t.selection,i=t.wordAt(r.head),s=i&&i.from==r.from&&i.to==r.to;for(let a=!1,o=new f0(t.doc,e,n[n.length-1].to);;)if(o.next(),o.done){if(a)return null;o=new f0(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),a=!0}else{if(a&&n.some(d=>d.from==o.value.from))continue;if(s){let d=t.wordAt(o.value.from);if(!d||d.from!=o.value.from||d.to!=o.value.to)continue}return o.value}}const QCe=({state:t,dispatch:e})=>{let{ranges:r}=t.selection;if(r.some(s=>s.from===s.to))return UCe({state:t,dispatch:e});let n=t.sliceDoc(r[0].from,r[0].to);if(t.selection.ranges.some(s=>t.sliceDoc(s.from,s.to)!=n))return!1;let i=qCe(t,n);return i?(e(t.update({selection:t.selection.addRange(pt.range(i.from,i.to),!1),effects:Zt.scrollIntoView(i.to)})),!0):!1},O0=hr.define({combine(t){return Cu(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new oTe(e),scrollToMatch:e=>Zt.scrollIntoView(e)})}});class nH{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||ICe(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord,this.test=e.test}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(r,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord&&this.test==e.test}create(){return this.regexp?new YCe(this):new XCe(this)}getCursor(e,r=0,n){let i=e.doc?e:fn.create({doc:e});return n==null&&(n=i.doc.length),this.regexp?Tg(this,i,r,n):Cg(this,i,r,n)}}class iH{constructor(e){this.spec=e}}function HCe(t,e,r){return(n,i,s,a)=>{if(r&&!r(n,i,s,a))return!1;let o=n>=a&&i<=a+s.length?s.slice(n-a,i-a):e.doc.sliceString(n,i);return t(o,e,n,i)}}function Cg(t,e,r,n){let i;return t.wholeWord&&(i=GCe(e.doc,e.charCategorizer(e.selection.main.head))),t.test&&(i=HCe(t.test,e,i)),new f0(e.doc,t.unquoted,r,n,t.caseSensitive?void 0:s=>s.toLowerCase(),i)}function GCe(t,e){return(r,n,i,s)=>((s>r||s+i.length<n)&&(s=Math.max(0,r-2),i=t.sliceString(s,Math.min(t.length,n+2))),(e(X2(i,r-s))!=vi.Word||e(K2(i,r-s))!=vi.Word)&&(e(K2(i,n-s))!=vi.Word||e(X2(i,n-s))!=vi.Word))}class XCe extends iH{constructor(e){super(e)}nextMatch(e,r,n){let i=Cg(this.spec,e,n,e.doc.length).nextOverlapping();if(i.done){let s=Math.min(e.doc.length,r+this.spec.unquoted.length);i=Cg(this.spec,e,0,s).nextOverlapping()}return i.done||i.value.from==r&&i.value.to==n?null:i.value}prevMatchInRange(e,r,n){for(let i=n;;){let s=Math.max(r,i-1e4-this.spec.unquoted.length),a=Cg(this.spec,e,s,i),o=null;for(;!a.nextOverlapping().done;)o=a.value;if(o)return o;if(s==r)return null;i-=1e4}}prevMatch(e,r,n){let i=this.prevMatchInRange(e,0,r);return i||(i=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),i&&(i.from!=r||i.to!=n)?i:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,r){let n=Cg(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=r)return null;i.push(n.value)}return i}highlight(e,r,n,i){let s=Cg(this.spec,e,Math.max(0,r-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}function KCe(t,e,r){return(n,i,s)=>(!r||r(n,i,s))&&t(s[0],e,n,i)}function Tg(t,e,r,n){let i;return t.wholeWord&&(i=ZCe(e.charCategorizer(e.selection.main.head))),t.test&&(i=KCe(t.test,e,i)),new tH(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:i},r,n)}function X2(t,e){return t.slice(bs(t,e,!1),e)}function K2(t,e){return t.slice(e,bs(t,e))}function ZCe(t){return(e,r,n)=>!n[0].length||(t(X2(n.input,n.index))!=vi.Word||t(K2(n.input,n.index))!=vi.Word)&&(t(K2(n.input,n.index+n[0].length))!=vi.Word||t(X2(n.input,n.index+n[0].length))!=vi.Word)}class YCe extends iH{nextMatch(e,r,n){let i=Tg(this.spec,e,n,e.doc.length).next();return i.done&&(i=Tg(this.spec,e,0,r).next()),i.done?null:i.value}prevMatchInRange(e,r,n){for(let i=1;;i++){let s=Math.max(r,n-i*1e4),a=Tg(this.spec,e,s,n),o=null;for(;!a.next().done;)o=a.value;if(o&&(s==r||o.from>s+10))return o;if(s==r)return null}}prevMatch(e,r,n){return this.prevMatchInRange(e,0,r)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(r,n)=>{if(n=="&")return e.match[0];if(n=="$")return"$";for(let i=n.length;i>0;i--){let s=+n.slice(0,i);if(s>0&&s<e.match.length)return e.match[s]+n.slice(i)}return r})}matchAll(e,r){let n=Tg(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=r)return null;i.push(n.value)}return i}highlight(e,r,n,i){let s=Tg(this.spec,e,Math.max(0,r-250),Math.min(n+250,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}const Qb=Qr.define(),fI=Qr.define(),Zd=co.define({create(t){return new Pj($E(t).create(),null)},update(t,e){for(let r of e.effects)r.is(Qb)?t=new Pj(r.value.create(),t.panel):r.is(fI)&&(t=new Pj(t.query,r.value?pI:null));return t},provide:t=>Vb.from(t,e=>e.panel)});class Pj{constructor(e,r){this.query=e,this.panel=r}}const JCe=jr.mark({class:"cm-searchMatch"}),eTe=jr.mark({class:"cm-searchMatch cm-searchMatch-selected"}),tTe=Qi.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(Zd))}update(t){let e=t.state.field(Zd);(e!=t.startState.field(Zd)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return jr.none;let{view:r}=this,n=new kh;for(let i=0,s=r.visibleRanges,a=s.length;i<a;i++){let{from:o,to:d}=s[i];for(;i<a-1&&d>s[i+1].from-2*250;)d=s[++i].to;t.highlight(r.state,o,d,(m,y)=>{let v=r.state.selection.ranges.some(w=>w.from==m&&w.to==y);n.add(m,y,v?eTe:JCe)})}return n.finish()}},{decorations:t=>t.decorations});function U1(t){return e=>{let r=e.state.field(Zd,!1);return r&&r.query.spec.valid?t(e,r):aH(e)}}const Z2=U1((t,{query:e})=>{let{to:r}=t.state.selection.main,n=e.nextMatch(t.state,r,r);if(!n)return!1;let i=pt.single(n.from,n.to),s=t.state.facet(O0);return t.dispatch({selection:i,effects:[mI(t,n),s.scrollToMatch(i.main,t)],userEvent:"select.search"}),oH(t),!0}),Y2=U1((t,{query:e})=>{let{state:r}=t,{from:n}=r.selection.main,i=e.prevMatch(r,n,n);if(!i)return!1;let s=pt.single(i.from,i.to),a=t.state.facet(O0);return t.dispatch({selection:s,effects:[mI(t,i),a.scrollToMatch(s.main,t)],userEvent:"select.search"}),oH(t),!0}),rTe=U1((t,{query:e})=>{let r=e.matchAll(t.state,1e3);return!r||!r.length?!1:(t.dispatch({selection:pt.create(r.map(n=>pt.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),nTe=({state:t,dispatch:e})=>{let r=t.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:n,to:i}=r.main,s=[],a=0;for(let o=new f0(t.doc,t.sliceDoc(n,i));!o.next().done;){if(s.length>1e3)return!1;o.value.from==n&&(a=s.length),s.push(pt.range(o.value.from,o.value.to))}return e(t.update({selection:pt.create(s,a),userEvent:"select.search.matches"})),!0},BB=U1((t,{query:e})=>{let{state:r}=t,{from:n,to:i}=r.selection.main;if(r.readOnly)return!1;let s=e.nextMatch(r,n,n);if(!s)return!1;let a=s,o=[],d,m,y=[];a.from==n&&a.to==i&&(m=r.toText(e.getReplacement(a)),o.push({from:a.from,to:a.to,insert:m}),a=e.nextMatch(r,a.from,a.to),y.push(Zt.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(n).number)+".")));let v=t.state.changes(o);return a&&(d=pt.single(a.from,a.to).map(v),y.push(mI(t,a)),y.push(r.facet(O0).scrollToMatch(d.main,t))),t.dispatch({changes:v,selection:d,effects:y,userEvent:"input.replace"}),!0}),iTe=U1((t,{query:e})=>{if(t.state.readOnly)return!1;let r=e.matchAll(t.state,1e9).map(i=>{let{from:s,to:a}=i;return{from:s,to:a,insert:e.getReplacement(i)}});if(!r.length)return!1;let n=t.state.phrase("replaced $ matches",r.length)+".";return t.dispatch({changes:r,effects:Zt.announce.of(n),userEvent:"input.replace.all"}),!0});function pI(t){return t.state.facet(O0).createPanel(t)}function $E(t,e){var r,n,i,s,a;let o=t.selection.main,d=o.empty||o.to>o.from+100?"":t.sliceDoc(o.from,o.to);if(e&&!d)return e;let m=t.facet(O0);return new nH({search:((r=e==null?void 0:e.literal)!==null&&r!==void 0?r:m.literal)?d:d.replace(/\n/g,"\\n"),caseSensitive:(n=e==null?void 0:e.caseSensitive)!==null&&n!==void 0?n:m.caseSensitive,literal:(i=e==null?void 0:e.literal)!==null&&i!==void 0?i:m.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:m.regexp,wholeWord:(a=e==null?void 0:e.wholeWord)!==null&&a!==void 0?a:m.wholeWord})}function sH(t){let e=tI(t,pI);return e&&e.dom.querySelector("[main-field]")}function oH(t){let e=sH(t);e&&e==t.root.activeElement&&e.select()}const aH=t=>{let e=t.state.field(Zd,!1);if(e&&e.panel){let r=sH(t);if(r&&r!=t.root.activeElement){let n=$E(t.state,e.query.spec);n.valid&&t.dispatch({effects:Qb.of(n)}),r.focus(),r.select()}}else t.dispatch({effects:[fI.of(!0),e?Qb.of($E(t.state,e.query.spec)):Qr.appendConfig.of(lTe)]});return!0},lH=t=>{let e=t.state.field(Zd,!1);if(!e||!e.panel)return!1;let r=tI(t,pI);return r&&r.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:fI.of(!1)}),!0},sTe=[{key:"Mod-f",run:aH,scope:"editor search-panel"},{key:"F3",run:Z2,shift:Y2,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Z2,shift:Y2,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:lH,scope:"editor search-panel"},{key:"Mod-Shift-l",run:nTe},{key:"Mod-Alt-g",run:RCe},{key:"Mod-d",run:QCe,preventDefault:!0}];class oTe{constructor(e){this.view=e;let r=this.query=e.state.field(Zd).query.spec;this.commit=this.commit.bind(this),this.searchField=Kn("input",{value:r.search,placeholder:Ua(e,"Find"),"aria-label":Ua(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Kn("input",{value:r.replace,placeholder:Ua(e,"Replace"),"aria-label":Ua(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Kn("input",{type:"checkbox",name:"case",form:"",checked:r.caseSensitive,onchange:this.commit}),this.reField=Kn("input",{type:"checkbox",name:"re",form:"",checked:r.regexp,onchange:this.commit}),this.wordField=Kn("input",{type:"checkbox",name:"word",form:"",checked:r.wholeWord,onchange:this.commit});function n(i,s,a){return Kn("button",{class:"cm-button",name:i,onclick:s,type:"button"},a)}this.dom=Kn("div",{onkeydown:i=>this.keydown(i),class:"cm-search"},[this.searchField,n("next",()=>Z2(e),[Ua(e,"next")]),n("prev",()=>Y2(e),[Ua(e,"previous")]),n("select",()=>rTe(e),[Ua(e,"all")]),Kn("label",null,[this.caseField,Ua(e,"match case")]),Kn("label",null,[this.reField,Ua(e,"regexp")]),Kn("label",null,[this.wordField,Ua(e,"by word")]),...e.state.readOnly?[]:[Kn("br"),this.replaceField,n("replace",()=>BB(e),[Ua(e,"replace")]),n("replaceAll",()=>iTe(e),[Ua(e,"replace all")])],Kn("button",{name:"close",onclick:()=>lH(e),"aria-label":Ua(e,"close"),type:"button"},[""])])}commit(){let e=new nH({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Qb.of(e)}))}keydown(e){uSe(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Y2:Z2)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),BB(this.view))}update(e){for(let r of e.transactions)for(let n of r.effects)n.is(Qb)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(O0).top}}function Ua(t,e){return t.state.phrase(e)}const Vw=30,Ww=/[\s\.,:;?!]/;function mI(t,{from:e,to:r}){let n=t.state.doc.lineAt(e),i=t.state.doc.lineAt(r).to,s=Math.max(n.from,e-Vw),a=Math.min(i,r+Vw),o=t.state.sliceDoc(s,a);if(s!=n.from){for(let d=0;d<Vw;d++)if(!Ww.test(o[d+1])&&Ww.test(o[d])){o=o.slice(d);break}}if(a!=i){for(let d=o.length-1;d>o.length-Vw;d--)if(!Ww.test(o[d-1])&&Ww.test(o[d])){o=o.slice(0,d);break}}return Zt.announce.of(`${t.state.phrase("current match")}. ${o} ${t.state.phrase("on line")} ${n.number}.`)}const aTe=Zt.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),lTe=[Zd,wm.low(tTe),aTe];class cH{constructor(e,r,n,i){this.state=e,this.pos=r,this.explicit=n,this.view=i,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let r=Hi(this.state).resolveInner(this.pos,-1);for(;r&&e.indexOf(r.name)<0;)r=r.parent;return r?{from:r.from,to:this.pos,text:this.state.sliceDoc(r.from,this.pos),type:r.type}:null}matchBefore(e){let r=this.state.doc.lineAt(this.pos),n=Math.max(r.from,this.pos-250),i=r.text.slice(n-r.from,this.pos-r.from),s=i.search(hH(e,!1));return s<0?null:{from:n+s,to:this.pos,text:i.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,r,n){e=="abort"&&this.abortListeners&&(this.abortListeners.push(r),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function $B(t){let e=Object.keys(t).join(""),r=/\w/.test(e);return r&&(e=e.replace(/\w/g,"")),`[${r?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function cTe(t){let e=Object.create(null),r=Object.create(null);for(let{label:i}of t){e[i[0]]=!0;for(let s=1;s<i.length;s++)r[i[s]]=!0}let n=$B(e)+$B(r)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function uH(t){let e=t.map(i=>typeof i=="string"?{label:i}:i),[r,n]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:cTe(e);return i=>{let s=i.matchBefore(n);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:r}:null}}function uTe(t,e){return r=>{for(let n=Hi(r.state).resolveInner(r.pos,-1);n;n=n.parent){if(t.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(r)}}class NB{constructor(e,r,n,i){this.completion=e,this.source=r,this.match=n,this.score=i}}function Kp(t){return t.selection.main.from}function hH(t,e){var r;let{source:n}=t,i=e&&n[0]!="^",s=n[n.length-1]!="$";return!i&&!s?t:new RegExp(`${i?"^":""}(?:${n})${s?"$":""}`,(r=t.flags)!==null&&r!==void 0?r:t.ignoreCase?"i":"")}const dH=ku.define();function hTe(t,e,r,n){let{main:i}=t.selection,s=r-i.from,a=n-i.from;return{...t.changeByRange(o=>{if(o!=i&&r!=n&&t.sliceDoc(o.from+s,o.from+a)!=t.sliceDoc(r,n))return{range:o};let d=t.toText(e);return{changes:{from:o.from+s,to:n==i.from?o.to:o.from+a,insert:d},range:pt.cursor(o.from+s+d.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const VB=new WeakMap;function dTe(t){if(!Array.isArray(t))return t;let e=VB.get(t);return e||VB.set(t,e=uH(t)),e}const J2=Qr.define(),Hb=Qr.define();class fTe{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let r=0;r<e.length;){let n=ma(e,r),i=au(n);this.chars.push(n);let s=e.slice(r,r+i),a=s.toUpperCase();this.folded.push(ma(a==s?s.toLowerCase():a,0)),r+=i}this.astral=e.length!=this.chars.length}ret(e,r){return this.score=e,this.matched=r,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:r,folded:n,any:i,precise:s,byWord:a}=this;if(r.length==1){let F=ma(e,0),D=au(F),U=D==e.length?0:-100;if(F!=r[0])if(F==n[0])U+=-200;else return null;return this.ret(U,[0,D])}let o=e.indexOf(this.pattern);if(o==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let d=r.length,m=0;if(o<0){for(let F=0,D=Math.min(e.length,200);F<D&&m<d;){let U=ma(e,F);(U==r[m]||U==n[m])&&(i[m++]=F),F+=au(U)}if(m<d)return null}let y=0,v=0,w=!1,O=0,P=-1,E=-1,$=/[a-z]/.test(e),R=!0;for(let F=0,D=Math.min(e.length,200),U=0;F<D&&v<d;){let X=ma(e,F);o<0&&(y<d&&X==r[y]&&(s[y++]=F),O<d&&(X==r[O]||X==n[O]?(O==0&&(P=F),E=F+1,O++):O=0));let ee,K=X<255?X>=48&&X<=57||X>=97&&X<=122?2:X>=65&&X<=90?1:0:(ee=LM(X))!=ee.toLowerCase()?1:ee!=ee.toUpperCase()?2:0;(!F||K==1&&$||U==0&&K!=0)&&(r[v]==X||n[v]==X&&(w=!0)?a[v++]=F:a.length&&(R=!1)),U=K,F+=au(X)}return v==d&&a[0]==0&&R?this.result(-100+(w?-200:0),a,e):O==d&&P==0?this.ret(-200-e.length+(E==e.length?0:-100),[0,E]):o>-1?this.ret(-700-e.length,[o,o+this.pattern.length]):O==d?this.ret(-900-e.length,[P,E]):v==d?this.result(-100+(w?-200:0)+-700+(R?0:-1100),a,e):r.length==2?null:this.result((i[0]?-700:0)+-200+-1100,i,e)}result(e,r,n){let i=[],s=0;for(let a of r){let o=a+(this.astral?au(ma(n,a)):1);s&&i[s-1]==a?i[s-1]=o:(i[s++]=a,i[s++]=o)}return this.ret(e-n.length,i)}}class pTe{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let r=e.slice(0,this.pattern.length),n=r==this.pattern?0:r.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,r.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}const Bs=hr.define({combine(t){return Cu(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:mTe,filterStrict:!1,compareCompletions:(e,r)=>(e.sortText||e.label).localeCompare(r.sortText||r.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,r)=>e&&r,closeOnBlur:(e,r)=>e&&r,icons:(e,r)=>e&&r,tooltipClass:(e,r)=>n=>WB(e(n),r(n)),optionClass:(e,r)=>n=>WB(e(n),r(n)),addToOptions:(e,r)=>e.concat(r),filterStrict:(e,r)=>e||r})}});function WB(t,e){return t?e?t+" "+e:t:e}function mTe(t,e,r,n,i,s){let a=t.textDirection==ti.RTL,o=a,d=!1,m="top",y,v,w=e.left-i.left,O=i.right-e.right,P=n.right-n.left,E=n.bottom-n.top;if(o&&w<Math.min(P,O)?o=!1:!o&&O<Math.min(P,w)&&(o=!0),P<=(o?w:O))y=Math.max(i.top,Math.min(r.top,i.bottom-E))-e.top,v=Math.min(400,o?w:O);else{d=!0,v=Math.min(400,(a?e.right:i.right-e.left)-30);let F=i.bottom-e.bottom;F>=E||F>e.top?y=r.bottom-e.top:(m="bottom",y=e.bottom-r.top)}let $=(e.bottom-e.top)/s.offsetHeight,R=(e.right-e.left)/s.offsetWidth;return{style:`${m}: ${y/$}px; max-width: ${v/R}px`,class:"cm-completionInfo-"+(d?a?"left-narrow":"right-narrow":o?"left":"right")}}function gTe(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(r){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),r.type&&n.classList.add(...r.type.split(/\s+/g).map(i=>"cm-completionIcon-"+i)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(r,n,i,s){let a=document.createElement("span");a.className="cm-completionLabel";let o=r.displayLabel||r.label,d=0;for(let m=0;m<s.length;){let y=s[m++],v=s[m++];y>d&&a.appendChild(document.createTextNode(o.slice(d,y)));let w=a.appendChild(document.createElement("span"));w.appendChild(document.createTextNode(o.slice(y,v))),w.className="cm-completionMatchedText",d=v}return d<o.length&&a.appendChild(document.createTextNode(o.slice(d))),a},position:50},{render(r){if(!r.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=r.detail,n},position:80}),e.sort((r,n)=>r.position-n.position).map(r=>r.render)}function Aj(t,e,r){if(t<=r)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let i=Math.floor(e/r);return{from:i*r,to:(i+1)*r}}let n=Math.floor((t-e)/r);return{from:t-(n+1)*r,to:t-n*r}}class yTe{constructor(e,r,n){this.view=e,this.stateField=r,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:d=>this.placeInfo(d),key:this},this.space=null,this.currentClass="";let i=e.state.field(r),{options:s,selected:a}=i.open,o=e.state.facet(Bs);this.optionContent=gTe(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=Aj(s.length,a,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",d=>{let{options:m}=e.state.field(r).open;for(let y=d.target,v;y&&y!=this.dom;y=y.parentNode)if(y.nodeName=="LI"&&(v=/-(\d+)$/.exec(y.id))&&+v[1]<m.length){this.applyCompletion(e,m[+v[1]]),d.preventDefault();return}}),this.dom.addEventListener("focusout",d=>{let m=e.state.field(this.stateField,!1);m&&m.tooltip&&e.state.facet(Bs).closeOnBlur&&d.relatedTarget!=e.contentDOM&&e.dispatch({effects:Hb.of(null)})}),this.showOptions(s,i.id)}mount(){this.updateSel()}showOptions(e,r){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,r,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var r;let n=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=i){let{options:s,selected:a,disabled:o}=n.open;(!i.open||i.open.options!=s)&&(this.range=Aj(s.length,a,e.state.facet(Bs).maxRenderedOptions),this.showOptions(s,n.id)),this.updateSel(),o!=((r=i.open)===null||r===void 0?void 0:r.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!o)}}updateTooltipClass(e){let r=this.tooltipClass(e);if(r!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of r.split(" "))n&&this.dom.classList.add(n);this.currentClass=r}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),r=e.open;(r.selected>-1&&r.selected<this.range.from||r.selected>=this.range.to)&&(this.range=Aj(r.options.length,r.selected,this.view.state.facet(Bs).maxRenderedOptions),this.showOptions(r.options,e.id));let n=this.updateSelectedOption(r.selected);if(n){this.destroyInfo();let{completion:i}=r.options[r.selected],{info:s}=i;if(!s)return;let a=typeof s=="string"?document.createTextNode(s):s(i);if(!a)return;"then"in a?a.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,i)}).catch(o=>wa(this.view.state,o,"completion info")):(this.addInfoPane(a,i),n.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,r){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",n.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:i,destroy:s}=e;n.appendChild(i),this.infoDestroy=s||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let r=null;for(let n=this.list.firstChild,i=this.range.from;n;n=n.nextSibling,i++)n.nodeName!="LI"||!n.id?i--:i==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),r=n):n.hasAttribute("aria-selected")&&(n.removeAttribute("aria-selected"),n.removeAttribute("aria-describedby"));return r&&vTe(this.list,r),r}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let r=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),s=this.space;if(!s){let a=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:a.clientWidth,bottom:a.clientHeight}}return i.top>Math.min(s.bottom,r.bottom)-10||i.bottom<Math.max(s.top,r.top)+10?null:this.view.state.facet(Bs).positionInfo(this.view,r,i,n,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,r,n){const i=document.createElement("ul");i.id=r,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions")),i.addEventListener("mousedown",a=>{a.target==i&&a.preventDefault()});let s=null;for(let a=n.from;a<n.to;a++){let{completion:o,match:d}=e[a],{section:m}=o;if(m){let w=typeof m=="string"?m:m.name;if(w!=s&&(a>n.from||n.from==0))if(s=w,typeof m!="string"&&m.header)i.appendChild(m.header(m));else{let O=i.appendChild(document.createElement("completion-section"));O.textContent=w}}const y=i.appendChild(document.createElement("li"));y.id=r+"-"+a,y.setAttribute("role","option");let v=this.optionClass(o);v&&(y.className=v);for(let w of this.optionContent){let O=w(o,this.view.state,this.view,d);O&&y.appendChild(O)}}return n.from&&i.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function xTe(t,e){return r=>new yTe(r,t,e)}function vTe(t,e){let r=t.getBoundingClientRect(),n=e.getBoundingClientRect(),i=r.height/t.offsetHeight;n.top<r.top?t.scrollTop-=(r.top-n.top)/i:n.bottom>r.bottom&&(t.scrollTop+=(n.bottom-r.bottom)/i)}function UB(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function bTe(t,e){let r=[],n=null,i=null,s=y=>{r.push(y);let{section:v}=y.completion;if(v){n||(n=[]);let w=typeof v=="string"?v:v.name;n.some(O=>O.name==w)||n.push(typeof v=="string"?{name:w}:v)}},a=e.facet(Bs);for(let y of t)if(y.hasResult()){let v=y.result.getMatch;if(y.result.filter===!1)for(let w of y.result.options)s(new NB(w,y.source,v?v(w):[],1e9-r.length));else{let w=e.sliceDoc(y.from,y.to),O,P=a.filterStrict?new pTe(w):new fTe(w);for(let E of y.result.options)if(O=P.match(E.label)){let $=E.displayLabel?v?v(E,O.matched):[]:O.matched,R=O.score+(E.boost||0);if(s(new NB(E,y.source,$,R)),typeof E.section=="object"&&E.section.rank==="dynamic"){let{name:F}=E.section;i||(i=Object.create(null)),i[F]=Math.max(R,i[F]||-1e9)}}}}if(n){let y=Object.create(null),v=0,w=(O,P)=>(O.rank==="dynamic"&&P.rank==="dynamic"?i[P.name]-i[O.name]:0)||(typeof O.rank=="number"?O.rank:1e9)-(typeof P.rank=="number"?P.rank:1e9)||(O.name<P.name?-1:1);for(let O of n.sort(w))v-=1e5,y[O.name]=v;for(let O of r){let{section:P}=O.completion;P&&(O.score+=y[typeof P=="string"?P:P.name])}}let o=[],d=null,m=a.compareCompletions;for(let y of r.sort((v,w)=>w.score-v.score||m(v.completion,w.completion))){let v=y.completion;!d||d.label!=v.label||d.detail!=v.detail||d.type!=null&&v.type!=null&&d.type!=v.type||d.apply!=v.apply||d.boost!=v.boost?o.push(y):UB(y.completion)>UB(d)&&(o[o.length-1]=y),d=y.completion}return o}class Jg{constructor(e,r,n,i,s,a){this.options=e,this.attrs=r,this.tooltip=n,this.timestamp=i,this.selected=s,this.disabled=a}setSelected(e,r){return e==this.selected||e>=this.options.length?this:new Jg(this.options,qB(r,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,r,n,i,s,a){if(i&&!a&&e.some(m=>m.isPending))return i.setDisabled();let o=bTe(e,r);if(!o.length)return i&&e.some(m=>m.isPending)?i.setDisabled():null;let d=r.facet(Bs).selectOnOpen?0:-1;if(i&&i.selected!=d&&i.selected!=-1){let m=i.options[i.selected].completion;for(let y=0;y<o.length;y++)if(o[y].completion==m){d=y;break}}return new Jg(o,qB(n,d),{pos:e.reduce((m,y)=>y.hasResult()?Math.min(m,y.from):m,1e8),create:TTe,above:s.aboveCursor},i?i.timestamp:Date.now(),d,!1)}map(e){return new Jg(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new Jg(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class ek{constructor(e,r,n){this.active=e,this.id=r,this.open=n}static start(){return new ek(kTe,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:r}=e,n=r.facet(Bs),s=(n.override||r.languageDataAt("autocomplete",Kp(r)).map(dTe)).map(d=>(this.active.find(y=>y.source==d)||new Dl(d,this.active.some(y=>y.state!=0)?1:0)).update(e,n));s.length==this.active.length&&s.every((d,m)=>d==this.active[m])&&(s=this.active);let a=this.open,o=e.effects.some(d=>d.is(gI));a&&e.docChanged&&(a=a.map(e.changes)),e.selection||s.some(d=>d.hasResult()&&e.changes.touchesRange(d.from,d.to))||!_Te(s,this.active)||o?a=Jg.build(s,r,this.id,a,n,o):a&&a.disabled&&!s.some(d=>d.isPending)&&(a=null),!a&&s.every(d=>!d.isPending)&&s.some(d=>d.hasResult())&&(s=s.map(d=>d.hasResult()?new Dl(d.source,0):d));for(let d of e.effects)d.is(pH)&&(a=a&&a.setSelected(d.value,this.id));return s==this.active&&a==this.open?this:new ek(s,this.id,a)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?wTe:STe}}function _Te(t,e){if(t==e)return!0;for(let r=0,n=0;;){for(;r<t.length&&!t[r].hasResult();)r++;for(;n<e.length&&!e[n].hasResult();)n++;let i=r==t.length,s=n==e.length;if(i||s)return i==s;if(t[r++].result!=e[n++].result)return!1}}const wTe={"aria-autocomplete":"list"},STe={};function qB(t,e){let r={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(r["aria-activedescendant"]=t+"-"+e),r}const kTe=[];function fH(t,e){if(t.isUserEvent("input.complete")){let n=t.annotation(dH);if(n&&e.activateOnCompletion(n))return 12}let r=t.isUserEvent("input.type");return r&&e.activateOnTyping?5:r?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class Dl{constructor(e,r,n=!1){this.source=e,this.state=r,this.explicit=n}hasResult(){return!1}get isPending(){return this.state==1}update(e,r){let n=fH(e,r),i=this;(n&8||n&16&&this.touches(e))&&(i=new Dl(i.source,0)),n&4&&i.state==0&&(i=new Dl(this.source,1)),i=i.updateFor(e,n);for(let s of e.effects)if(s.is(J2))i=new Dl(i.source,1,s.value);else if(s.is(Hb))i=new Dl(i.source,0);else if(s.is(gI))for(let a of s.value)a.source==i.source&&(i=a);return i}updateFor(e,r){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Kp(e.state))}}class Sy extends Dl{constructor(e,r,n,i,s,a){super(e,3,r),this.limit=n,this.result=i,this.from=s,this.to=a}hasResult(){return!0}updateFor(e,r){var n;if(!(r&3))return this.map(e.changes);let i=this.result;i.map&&!e.changes.empty&&(i=i.map(i,e.changes));let s=e.changes.mapPos(this.from),a=e.changes.mapPos(this.to,1),o=Kp(e.state);if(o>a||!i||r&2&&(Kp(e.startState)==this.from||o<this.limit))return new Dl(this.source,r&4?1:0);let d=e.changes.mapPos(this.limit);return CTe(i.validFor,e.state,s,a)?new Sy(this.source,this.explicit,d,i,s,a):i.update&&(i=i.update(i,s,a,new cH(e.state,o,!1)))?new Sy(this.source,this.explicit,d,i,i.from,(n=i.to)!==null&&n!==void 0?n:Kp(e.state)):new Dl(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Sy(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new Dl(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function CTe(t,e,r,n){if(!t)return!1;let i=e.sliceDoc(r,n);return typeof t=="function"?t(i,r,n,e):hH(t,!0).test(i)}const gI=Qr.define({map(t,e){return t.map(r=>r.map(e))}}),pH=Qr.define(),ga=co.define({create(){return ek.start()},update(t,e){return t.update(e)},provide:t=>[eI.from(t,e=>e.tooltip),Zt.contentAttributes.from(t,e=>e.attrs)]});function yI(t,e){const r=e.completion.apply||e.completion.label;let n=t.state.field(ga).active.find(i=>i.source==e.source);return n instanceof Sy?(typeof r=="string"?t.dispatch({...hTe(t.state,r,n.from,n.to),annotations:dH.of(e.completion)}):r(t,e.completion,n.from,n.to),!0):!1}const TTe=xTe(ga,yI);function Uw(t,e="option"){return r=>{let n=r.state.field(ga,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<r.state.facet(Bs).interactionDelay)return!1;let i=1,s;e=="page"&&(s=Qq(r,n.open.tooltip))&&(i=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:a}=n.open.options,o=n.open.selected>-1?n.open.selected+i*(t?1:-1):t?0:a-1;return o<0?o=e=="page"?0:a-1:o>=a&&(o=e=="page"?a-1:0),r.dispatch({effects:pH.of(o)}),!0}}const OTe=t=>{let e=t.state.field(ga,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(Bs).interactionDelay?!1:yI(t,e.open.options[e.open.selected])},Ej=t=>t.state.field(ga,!1)?(t.dispatch({effects:J2.of(!0)}),!0):!1,jTe=t=>{let e=t.state.field(ga,!1);return!e||!e.active.some(r=>r.state!=0)?!1:(t.dispatch({effects:Hb.of(null)}),!0)};class PTe{constructor(e,r){this.active=e,this.context=r,this.time=Date.now(),this.updates=[],this.done=void 0}}const ATe=50,ETe=1e3,zTe=Qi.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of t.state.field(ga).active)e.isPending&&this.startQuery(e)}update(t){let e=t.state.field(ga),r=t.state.facet(Bs);if(!t.selectionSet&&!t.docChanged&&t.startState.field(ga)==e)return;let n=t.transactions.some(s=>{let a=fH(s,r);return a&8||(s.selection||s.docChanged)&&!(a&3)});for(let s=0;s<this.running.length;s++){let a=this.running[s];if(n||a.context.abortOnDocChange&&t.docChanged||a.updates.length+t.transactions.length>ATe&&Date.now()-a.time>ETe){for(let o of a.context.abortListeners)try{o()}catch(d){wa(this.view.state,d)}a.context.abortListeners=null,this.running.splice(s--,1)}else a.updates.push(...t.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),t.transactions.some(s=>s.effects.some(a=>a.is(J2)))&&(this.pendingStart=!0);let i=this.pendingStart?50:r.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.isPending&&!this.running.some(a=>a.active.source==s.source))?setTimeout(()=>this.startUpdate(),i):-1,this.composing!=0)for(let s of t.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:t}=this.view,e=t.field(ga);for(let r of e.active)r.isPending&&!this.running.some(n=>n.active.source==r.source)&&this.startQuery(r);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Bs).updateSyncTime))}startQuery(t){let{state:e}=this.view,r=Kp(e),n=new cH(e,r,t.explicit,this.view),i=new PTe(t,n);this.running.push(i),Promise.resolve(t.source(n)).then(s=>{i.context.aborted||(i.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:Hb.of(null)}),wa(this.view.state,s)})}scheduleAccept(){this.running.every(t=>t.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Bs).updateSyncTime))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],r=this.view.state.facet(Bs),n=this.view.state.field(ga);for(let i=0;i<this.running.length;i++){let s=this.running[i];if(s.done===void 0)continue;if(this.running.splice(i--,1),s.done){let o=Kp(s.updates.length?s.updates[0].startState:this.view.state),d=Math.min(o,s.done.from+(s.active.explicit?0:1)),m=new Sy(s.active.source,s.active.explicit,d,s.done,s.done.from,(t=s.done.to)!==null&&t!==void 0?t:o);for(let y of s.updates)m=m.update(y,r);if(m.hasResult()){e.push(m);continue}}let a=n.active.find(o=>o.source==s.active.source);if(a&&a.isPending)if(s.done==null){let o=new Dl(s.active.source,0);for(let d of s.updates)o=o.update(d,r);o.isPending||e.push(o)}else this.startQuery(a)}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:gI.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field(ga,!1);if(e&&e.tooltip&&this.view.state.facet(Bs).closeOnBlur){let r=e.open&&Qq(this.view,e.open.tooltip);(!r||!r.dom.contains(t.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Hb.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:J2.of(!1)}),20),this.composing=0}}}),MTe=typeof navigator=="object"&&/Win/.test(navigator.platform),ITe=wm.highest(Zt.domEventHandlers({keydown(t,e){let r=e.state.field(ga,!1);if(!r||!r.open||r.open.disabled||r.open.selected<0||t.key.length>1||t.ctrlKey&&!(MTe&&t.altKey)||t.metaKey)return!1;let n=r.open.options[r.open.selected],i=r.active.find(a=>a.source==n.source),s=n.completion.commitCharacters||i.result.commitCharacters;return s&&s.indexOf(t.key)>-1&&yI(e,n),!1}})),RTe=Zt.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Gb={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Sp=Qr.define({map(t,e){let r=e.mapPos(t,-1,Uo.TrackAfter);return r??void 0}}),xI=new class extends df{};xI.startSide=1;xI.endSide=-1;const mH=co.define({create(){return sn.empty},update(t,e){if(t=t.map(e.changes),e.selection){let r=e.state.doc.lineAt(e.selection.main.head);t=t.update({filter:n=>n>=r.from&&n<=r.to})}for(let r of e.effects)r.is(Sp)&&(t=t.update({add:[xI.range(r.value,r.value+1)]}));return t}});function DTe(){return[FTe,mH]}const zj="()[]{}<>";function gH(t){for(let e=0;e<zj.length;e+=2)if(zj.charCodeAt(e)==t)return zj.charAt(e+1);return LM(t<128?t:t+1)}function yH(t,e){return t.languageDataAt("closeBrackets",e)[0]||Gb}const LTe=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),FTe=Zt.inputHandler.of((t,e,r,n)=>{if((LTe?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let i=t.state.selection.main;if(n.length>2||n.length==2&&au(ma(n,0))==1||e!=i.from||r!=i.to)return!1;let s=NTe(t.state,n);return s?(t.dispatch(s),!0):!1}),BTe=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=yH(t,t.selection.main.head).brackets||Gb.brackets,i=null,s=t.changeByRange(a=>{if(a.empty){let o=VTe(t.doc,a.head);for(let d of n)if(d==o&&AC(t.doc,a.head)==gH(ma(d,0)))return{changes:{from:a.head-d.length,to:a.head+d.length},range:pt.cursor(a.head-d.length)}}return{range:i=a}});return i||e(t.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!i},$Te=[{key:"Backspace",run:BTe}];function NTe(t,e){let r=yH(t,t.selection.main.head),n=r.brackets||Gb.brackets;for(let i of n){let s=gH(ma(i,0));if(e==i)return s==i?qTe(t,i,n.indexOf(i+i+i)>-1,r):WTe(t,i,s,r.before||Gb.before);if(e==s&&xH(t,t.selection.main.from))return UTe(t,i,s)}return null}function xH(t,e){let r=!1;return t.field(mH).between(0,t.doc.length,n=>{n==e&&(r=!0)}),r}function AC(t,e){let r=t.sliceString(e,e+2);return r.slice(0,au(ma(r,0)))}function VTe(t,e){let r=t.sliceString(e-2,e);return au(ma(r,0))==r.length?r:r.slice(1)}function WTe(t,e,r,n){let i=null,s=t.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:r,from:a.to}],effects:Sp.of(a.to+e.length),range:pt.range(a.anchor+e.length,a.head+e.length)};let o=AC(t.doc,a.head);return!o||/\s/.test(o)||n.indexOf(o)>-1?{changes:{insert:e+r,from:a.head},effects:Sp.of(a.head+e.length),range:pt.cursor(a.head+e.length)}:{range:i=a}});return i?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function UTe(t,e,r){let n=null,i=t.changeByRange(s=>s.empty&&AC(t.doc,s.head)==r?{changes:{from:s.head,to:s.head+r.length,insert:r},range:pt.cursor(s.head+r.length)}:n={range:s});return n?null:t.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function qTe(t,e,r,n){let i=n.stringPrefixes||Gb.stringPrefixes,s=null,a=t.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:e,from:o.to}],effects:Sp.of(o.to+e.length),range:pt.range(o.anchor+e.length,o.head+e.length)};let d=o.head,m=AC(t.doc,d),y;if(m==e){if(QB(t,d))return{changes:{insert:e+e,from:d},effects:Sp.of(d+e.length),range:pt.cursor(d+e.length)};if(xH(t,d)){let w=r&&t.sliceDoc(d,d+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:d,to:d+w.length,insert:w},range:pt.cursor(d+w.length)}}}else{if(r&&t.sliceDoc(d-2*e.length,d)==e+e&&(y=HB(t,d-2*e.length,i))>-1&&QB(t,y))return{changes:{insert:e+e+e+e,from:d},effects:Sp.of(d+e.length),range:pt.cursor(d+e.length)};if(t.charCategorizer(d)(m)!=vi.Word&&HB(t,d,i)>-1&&!QTe(t,d,e,i))return{changes:{insert:e+e,from:d},effects:Sp.of(d+e.length),range:pt.cursor(d+e.length)}}return{range:s=o}});return s?null:t.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function QB(t,e){let r=Hi(t).resolveInner(e+1);return r.parent&&r.from==e}function QTe(t,e,r,n){let i=Hi(t).resolveInner(e,-1),s=n.reduce((a,o)=>Math.max(a,o.length),0);for(let a=0;a<5;a++){let o=t.sliceDoc(i.from,Math.min(i.to,i.from+r.length+s)),d=o.indexOf(r);if(!d||d>-1&&n.indexOf(o.slice(0,d))>-1){let y=i.firstChild;for(;y&&y.from==i.from&&y.to-y.from>r.length+d;){if(t.sliceDoc(y.to-r.length,y.to)==r)return!1;y=y.firstChild}return!0}let m=i.to==e&&i.parent;if(!m)break;i=m}return!1}function HB(t,e,r){let n=t.charCategorizer(e);if(n(t.sliceDoc(e-1,e))!=vi.Word)return e;for(let i of r){let s=e-i.length;if(t.sliceDoc(s,e)==i&&n(t.sliceDoc(s-1,s))!=vi.Word)return s}return-1}function vH(t={}){return[ITe,ga,Bs.of(t),zTe,HTe,RTe]}const bH=[{key:"Ctrl-Space",run:Ej},{mac:"Alt-`",run:Ej},{mac:"Alt-i",run:Ej},{key:"Escape",run:jTe},{key:"ArrowDown",run:Uw(!0)},{key:"ArrowUp",run:Uw(!1)},{key:"PageDown",run:Uw(!0,"page")},{key:"PageUp",run:Uw(!1,"page")},{key:"Enter",run:OTe}],HTe=wm.highest(xC.computeN([Bs],t=>t.facet(Bs).defaultKeymap?[bH]:[]));class GB{constructor(e,r,n){this.from=e,this.to=r,this.diagnostic=n}}class pp{constructor(e,r,n){this.diagnostics=e,this.panel=r,this.selected=n}static init(e,r,n){let i=n.facet(Xb).markerFilter;i&&(e=i(e,n));let s=e.slice().sort((O,P)=>O.from-P.from||O.to-P.to),a=new kh,o=[],d=0,m=n.doc.iter(),y=0,v=n.doc.length;for(let O=0;;){let P=O==s.length?null:s[O];if(!P&&!o.length)break;let E,$;if(o.length)E=d,$=o.reduce((D,U)=>Math.min(D,U.to),P&&P.from>E?P.from:1e8);else{if(E=P.from,E>v)break;$=P.to,o.push(P),O++}for(;O<s.length;){let D=s[O];if(D.from==E&&(D.to>D.from||D.to==E))o.push(D),O++,$=Math.min(D.to,$);else{$=Math.min(D.from,$);break}}$=Math.min($,v);let R=!1;if(o.some(D=>D.from==E&&(D.to==$||$==v))&&(R=E==$,!R&&$-E<10)){let D=E-(y+m.value.length);D>0&&(m.next(D),y=E);for(let U=E;;){if(U>=$){R=!0;break}if(!m.lineBreak&&y+m.value.length>U)break;U=y+m.value.length,y+=m.value.length,m.next()}}let F=oOe(o);if(R)a.add(E,E,jr.widget({widget:new rOe(F),diagnostics:o.slice()}));else{let D=o.reduce((U,X)=>X.markClass?U+" "+X.markClass:U,"");a.add(E,$,jr.mark({class:"cm-lintRange cm-lintRange-"+F+D,diagnostics:o.slice(),inclusiveEnd:o.some(U=>U.to>$)}))}if(d=$,d==v)break;for(let D=0;D<o.length;D++)o[D].to<=d&&o.splice(D--,1)}let w=a.finish();return new pp(w,r,p0(w))}}function p0(t,e=null,r=0){let n=null;return t.between(r,1e9,(i,s,{spec:a})=>{if(!(e&&a.diagnostics.indexOf(e)<0))if(!n)n=new GB(i,s,e||a.diagnostics[0]);else{if(a.diagnostics.indexOf(n.diagnostic)<0)return!1;n=new GB(n.from,s,n.diagnostic)}}),n}function GTe(t,e){let r=e.pos,n=e.end||r,i=t.state.facet(Xb).hideOn(t,r,n);if(i!=null)return i;let s=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(a=>a.is(_H))||t.changes.touchesRange(s.from,Math.max(s.to,n)))}function XTe(t,e){return t.field(Za,!1)?e:e.concat(Qr.appendConfig.of(aOe))}const _H=Qr.define(),vI=Qr.define(),wH=Qr.define(),Za=co.define({create(){return new pp(jr.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let r=t.diagnostics.map(e.changes),n=null,i=t.panel;if(t.selected){let s=e.changes.mapPos(t.selected.from,1);n=p0(r,t.selected.diagnostic,s)||p0(r,null,s)}!r.size&&i&&e.state.facet(Xb).autoPanel&&(i=null),t=new pp(r,i,n)}for(let r of e.effects)if(r.is(_H)){let n=e.state.facet(Xb).autoPanel?r.value.length?Kb.open:null:t.panel;t=pp.init(r.value,n,e.state)}else r.is(vI)?t=new pp(t.diagnostics,r.value?Kb.open:null,t.selected):r.is(wH)&&(t=new pp(t.diagnostics,t.panel,r.value));return t},provide:t=>[Vb.from(t,e=>e.panel),Zt.decorations.from(t,e=>e.diagnostics)]}),KTe=jr.mark({class:"cm-lintRange cm-lintRange-active"});function ZTe(t,e,r){let{diagnostics:n}=t.state.field(Za),i,s=-1,a=-1;n.between(e-(r<0?1:0),e+(r>0?1:0),(d,m,{spec:y})=>{if(e>=d&&e<=m&&(d==m||(e>d||r>0)&&(e<m||r<0)))return i=y.diagnostics,s=d,a=m,!1});let o=t.state.facet(Xb).tooltipFilter;return i&&o&&(i=o(i,t.state)),i?{pos:s,end:a,above:t.state.doc.lineAt(s).to<a,create(){return{dom:YTe(t,i)}}}:null}function YTe(t,e){return Kn("ul",{class:"cm-tooltip-lint"},e.map(r=>kH(t,r,!1)))}const JTe=t=>{let e=t.state.field(Za,!1);(!e||!e.panel)&&t.dispatch({effects:XTe(t.state,[vI.of(!0)])});let r=tI(t,Kb.open);return r&&r.dom.querySelector(".cm-panel-lint ul").focus(),!0},XB=t=>{let e=t.state.field(Za,!1);return!e||!e.panel?!1:(t.dispatch({effects:vI.of(!1)}),!0)},eOe=t=>{let e=t.state.field(Za,!1);if(!e)return!1;let r=t.state.selection.main,n=e.diagnostics.iter(r.to+1);return!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==r.from&&n.to==r.to)?!1:(t.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},tOe=[{key:"Mod-Shift-m",run:JTe,preventDefault:!0},{key:"F8",run:eOe}],Xb=hr.define({combine(t){return{sources:t.map(e=>e.source).filter(e=>e!=null),...Cu(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:KB,tooltipFilter:KB,needsRefresh:(e,r)=>e?r?n=>e(n)||r(n):e:r,hideOn:(e,r)=>e?r?(n,i,s)=>e(n,i,s)||r(n,i,s):e:r,autoPanel:(e,r)=>e||r})}}});function KB(t,e){return t?e?(r,n)=>e(t(r,n),n):t:e}function SH(t){let e=[];if(t)e:for(let{name:r}of t){for(let n=0;n<r.length;n++){let i=r[n];if(/[a-zA-Z]/.test(i)&&!e.some(s=>s.toLowerCase()==i.toLowerCase())){e.push(i);continue e}}e.push("")}return e}function kH(t,e,r){var n;let i=r?SH(e.actions):[];return Kn("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Kn("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(n=e.actions)===null||n===void 0?void 0:n.map((s,a)=>{let o=!1,d=O=>{if(O.preventDefault(),o)return;o=!0;let P=p0(t.state.field(Za).diagnostics,e);P&&s.apply(t,P.from,P.to)},{name:m}=s,y=i[a]?m.indexOf(i[a]):-1,v=y<0?m:[m.slice(0,y),Kn("u",m.slice(y,y+1)),m.slice(y+1)],w=s.markClass?" "+s.markClass:"";return Kn("button",{type:"button",class:"cm-diagnosticAction"+w,onclick:d,onmousedown:d,"aria-label":` Action: ${m}${y<0?"":` (access key "${i[a]})"`}.`},v)}),e.source&&Kn("div",{class:"cm-diagnosticSource"},e.source))}class rOe extends Tu{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Kn("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class ZB{constructor(e,r){this.diagnostic=r,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=kH(e,r,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Kb{constructor(e){this.view=e,this.items=[];let r=i=>{if(!(i.ctrlKey||i.altKey||i.metaKey)){if(i.keyCode==27)XB(this.view),this.view.focus();else if(i.keyCode==38||i.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(i.keyCode==40||i.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(i.keyCode==36)this.moveSelection(0);else if(i.keyCode==35)this.moveSelection(this.items.length-1);else if(i.keyCode==13)this.view.focus();else if(i.keyCode>=65&&i.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],a=SH(s.actions);for(let o=0;o<a.length;o++)if(a[o].toUpperCase().charCodeAt(0)==i.keyCode){let d=p0(this.view.state.field(Za).diagnostics,s);d&&s.actions[o].apply(e,d.from,d.to)}}else return;i.preventDefault()}},n=i=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(i.target)&&this.moveSelection(s)};this.list=Kn("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:r,onclick:n}),this.dom=Kn("div",{class:"cm-panel-lint"},this.list,Kn("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>XB(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(Za).selected;if(!e)return-1;for(let r=0;r<this.items.length;r++)if(this.items[r].diagnostic==e.diagnostic)return r;return-1}update(){let{diagnostics:e,selected:r}=this.view.state.field(Za),n=0,i=!1,s=null,a=new Set;for(e.between(0,this.view.state.doc.length,(o,d,{spec:m})=>{for(let y of m.diagnostics){if(a.has(y))continue;a.add(y);let v=-1,w;for(let O=n;O<this.items.length;O++)if(this.items[O].diagnostic==y){v=O;break}v<0?(w=new ZB(this.view,y),this.items.splice(n,0,w),i=!0):(w=this.items[v],v>n&&(this.items.splice(n,v-n),i=!0)),r&&w.diagnostic==r.diagnostic?w.dom.hasAttribute("aria-selected")||(w.dom.setAttribute("aria-selected","true"),s=w):w.dom.hasAttribute("aria-selected")&&w.dom.removeAttribute("aria-selected"),n++}});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();this.items.length==0&&(this.items.push(new ZB(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:d})=>{let m=d.height/this.list.offsetHeight;o.top<d.top?this.list.scrollTop-=(d.top-o.top)/m:o.bottom>d.bottom&&(this.list.scrollTop+=(o.bottom-d.bottom)/m)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function r(){let n=e;e=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)r();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)r()}moveSelection(e){if(this.selectedIndex<0)return;let r=this.view.state.field(Za),n=p0(r.diagnostics,this.items[e].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:wH.of(n)})}static open(e){return new Kb(e)}}function nOe(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function qw(t){return nOe(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const iOe=Zt.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:qw("#d11")},".cm-lintRange-warning":{backgroundImage:qw("orange")},".cm-lintRange-info":{backgroundImage:qw("#999")},".cm-lintRange-hint":{backgroundImage:qw("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function sOe(t){return t=="error"?4:t=="warning"?3:t=="info"?2:1}function oOe(t){let e="hint",r=1;for(let n of t){let i=sOe(n.severity);i>r&&(r=i,e=n.severity)}return e}const aOe=[Za,Zt.decorations.compute([Za],t=>{let{selected:e,panel:r}=t.field(Za);return!e||!r||e.from==e.to?jr.none:jr.set([KTe.range(e.from,e.to)])}),YSe(ZTe,{hideOn:GTe}),iOe];var YB=function(e){e===void 0&&(e={});var{crosshairCursor:r=!1}=e,n=[];e.closeBracketsKeymap!==!1&&(n=n.concat($Te)),e.defaultKeymap!==!1&&(n=n.concat(zCe)),e.searchKeymap!==!1&&(n=n.concat(sTe)),e.historyKeymap!==!1&&(n=n.concat(Bke)),e.foldKeymap!==!1&&(n=n.concat(eke)),e.completionKeymap!==!1&&(n=n.concat(bH)),e.lintKeymap!==!1&&(n=n.concat(tOe));var i=[];return e.lineNumbers!==!1&&i.push(h2e()),e.highlightActiveLineGutter!==!1&&i.push(p2e()),e.highlightSpecialChars!==!1&&i.push(OSe()),e.history!==!1&&i.push(Ake()),e.foldGutter!==!1&&i.push(ike()),e.drawSelection!==!1&&i.push(gSe()),e.dropCursor!==!1&&i.push(_Se()),e.allowMultipleSelections!==!1&&i.push(fn.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&i.push(U2e()),e.syntaxHighlighting!==!1&&i.push(gQ(lke,{fallback:!0})),e.bracketMatching!==!1&&i.push(mke()),e.closeBrackets!==!1&&i.push(DTe()),e.autocompletion!==!1&&i.push(vH()),e.rectangularSelection!==!1&&i.push(NSe()),r!==!1&&i.push(USe()),e.highlightActiveLine!==!1&&i.push(MSe()),e.highlightSelectionMatches!==!1&&i.push(FCe()),e.tabSize&&typeof e.tabSize=="number"&&i.push(_C.of(" ".repeat(e.tabSize))),i.concat([xC.of(n.flat())]).filter(Boolean)};const lOe="#e5c07b",JB="#e06c75",cOe="#56b6c2",uOe="#ffffff",DS="#abb2bf",NE="#7d8799",hOe="#61afef",dOe="#98c379",e6="#d19a66",fOe="#c678dd",pOe="#21252b",t6="#2c313a",r6="#282c34",Mj="#353a42",mOe="#3E4451",n6="#528bff",gOe=Zt.theme({"&":{color:DS,backgroundColor:r6},".cm-content":{caretColor:n6},".cm-cursor, .cm-dropCursor":{borderLeftColor:n6},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:mOe},".cm-panels":{backgroundColor:pOe,color:DS},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:r6,color:NE,border:"none"},".cm-activeLineGutter":{backgroundColor:t6},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Mj},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Mj,borderBottomColor:Mj},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:t6,color:DS}}},{dark:!0}),yOe=V1.define([{tag:Ve.keyword,color:fOe},{tag:[Ve.name,Ve.deleted,Ve.character,Ve.propertyName,Ve.macroName],color:JB},{tag:[Ve.function(Ve.variableName),Ve.labelName],color:hOe},{tag:[Ve.color,Ve.constant(Ve.name),Ve.standard(Ve.name)],color:e6},{tag:[Ve.definition(Ve.name),Ve.separator],color:DS},{tag:[Ve.typeName,Ve.className,Ve.number,Ve.changed,Ve.annotation,Ve.modifier,Ve.self,Ve.namespace],color:lOe},{tag:[Ve.operator,Ve.operatorKeyword,Ve.url,Ve.escape,Ve.regexp,Ve.link,Ve.special(Ve.string)],color:cOe},{tag:[Ve.meta,Ve.comment],color:NE},{tag:Ve.strong,fontWeight:"bold"},{tag:Ve.emphasis,fontStyle:"italic"},{tag:Ve.strikethrough,textDecoration:"line-through"},{tag:Ve.link,color:NE,textDecoration:"underline"},{tag:Ve.heading,fontWeight:"bold",color:JB},{tag:[Ve.atom,Ve.bool,Ve.special(Ve.variableName)],color:e6},{tag:[Ve.processingInstruction,Ve.string,Ve.inserted],color:dOe},{tag:Ve.invalid,color:uOe}]),xOe=[gOe,gQ(yOe)];var vOe=Zt.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),bOe=function(e){e===void 0&&(e={});var{indentWithTab:r=!0,editable:n=!0,readOnly:i=!1,theme:s="light",placeholder:a="",basicSetup:o=!0}=e,d=[];switch(r&&d.unshift(xC.of([MCe])),o&&(typeof o=="boolean"?d.unshift(YB()):d.unshift(YB(o))),a&&d.unshift(LSe(a)),s){case"light":d.push(vOe);break;case"dark":d.push(xOe);break;case"none":break;default:d.push(s);break}return n===!1&&d.push(Zt.editable.of(!1)),i&&d.push(fn.readOnly.of(!0)),[...d]},_Oe=t=>({line:t.state.doc.lineAt(t.state.selection.main.from),lineCount:t.state.doc.lines,lineBreak:t.state.lineBreak,length:t.state.doc.length,readOnly:t.state.readOnly,tabSize:t.state.tabSize,selection:t.state.selection,selectionAsSingle:t.state.selection.asSingle().main,ranges:t.state.selection.ranges,selectionCode:t.state.sliceDoc(t.state.selection.main.from,t.state.selection.main.to),selections:t.state.selection.ranges.map(e=>t.state.sliceDoc(e.from,e.to)),selectedText:t.state.selection.ranges.some(e=>!e.empty)});class wOe{constructor(e,r){this.timeLeftMS=void 0,this.timeoutMS=void 0,this.isCancelled=!1,this.isTimeExhausted=!1,this.callbacks=[],this.timeLeftMS=r,this.timeoutMS=r,this.callbacks.push(e)}tick(){if(!this.isCancelled&&!this.isTimeExhausted&&(this.timeLeftMS--,this.timeLeftMS<=0)){this.isTimeExhausted=!0;var e=this.callbacks.slice();this.callbacks.length=0,e.forEach(r=>{try{r()}catch(n){console.error("TimeoutLatch callback error:",n)}})}}cancel(){this.isCancelled=!0,this.callbacks.length=0}reset(){this.timeLeftMS=this.timeoutMS,this.isCancelled=!1,this.isTimeExhausted=!1}get isDone(){return this.isCancelled||this.isTimeExhausted}}class i6{constructor(){this.interval=null,this.latches=new Set}add(e){this.latches.add(e),this.start()}remove(e){this.latches.delete(e),this.latches.size===0&&this.stop()}start(){this.interval===null&&(this.interval=setInterval(()=>{this.latches.forEach(e=>{e.tick(),e.isDone&&this.remove(e)})},1))}stop(){this.interval!==null&&(clearInterval(this.interval),this.interval=null)}}var Ij=null,SOe=()=>typeof window>"u"?new i6:(Ij||(Ij=new i6),Ij),s6=ku.define(),kOe=200,COe=[];function TOe(t){var{value:e,selection:r,onChange:n,onStatistics:i,onCreateEditor:s,onUpdate:a,extensions:o=COe,autoFocus:d,theme:m="light",height:y=null,minHeight:v=null,maxHeight:w=null,width:O=null,minWidth:P=null,maxWidth:E=null,placeholder:$="",editable:R=!0,readOnly:F=!1,indentWithTab:D=!0,basicSetup:U=!0,root:X,initialState:ee}=t,[K,Y]=I.useState(),[ne,oe]=I.useState(),[ce,Xe]=I.useState(),Ae=I.useState(()=>({current:null}))[0],We=I.useState(()=>({current:null}))[0],Ye=Zt.theme({"&":{height:y,minHeight:v,maxHeight:w,width:O,minWidth:P,maxWidth:E},"& .cm-scroller":{height:"100% !important"}}),tt=Zt.updateListener.of(Ge=>{if(Ge.docChanged&&typeof n=="function"&&!Ge.transactions.some(Oe=>Oe.annotation(s6))){Ae.current?Ae.current.reset():(Ae.current=new wOe(()=>{if(We.current){var Oe=We.current;We.current=null,Oe()}Ae.current=null},kOe),SOe().add(Ae.current));var De=Ge.state.doc,Le=De.toString();n(Le,Ge)}i&&i(_Oe(Ge))}),Be=bOe({theme:m,editable:R,readOnly:F,placeholder:$,indentWithTab:D,basicSetup:U}),Me=[tt,Ye,...Be];return a&&typeof a=="function"&&Me.push(Zt.updateListener.of(a)),Me=Me.concat(o),I.useLayoutEffect(()=>{if(K&&!ce){var Ge={doc:e,selection:r,extensions:Me},De=ee?fn.fromJSON(ee.json,Ge,ee.fields):fn.create(Ge);if(Xe(De),!ne){var Le=new Zt({state:De,parent:K,root:X});oe(Le),s&&s(Le,De)}}return()=>{ne&&(Xe(void 0),oe(void 0))}},[K,ce]),I.useEffect(()=>{t.container&&Y(t.container)},[t.container]),I.useEffect(()=>()=>{ne&&(ne.destroy(),oe(void 0)),Ae.current&&(Ae.current.cancel(),Ae.current=null)},[ne]),I.useEffect(()=>{d&&ne&&ne.focus()},[d,ne]),I.useEffect(()=>{ne&&ne.dispatch({effects:Qr.reconfigure.of(Me)})},[m,o,y,v,w,O,P,E,$,R,F,D,U,n,a]),I.useEffect(()=>{if(e!==void 0){var Ge=ne?ne.state.doc.toString():"";if(ne&&e!==Ge){var De=Ae.current&&!Ae.current.isDone,Le=()=>{ne&&e!==ne.state.doc.toString()&&ne.dispatch({changes:{from:0,to:ne.state.doc.toString().length,insert:e||""},annotations:[s6.of(!0)]})};De?We.current=Le:Le()}}},[e,ne]),{state:ce,setState:Xe,view:ne,setView:oe,container:K,setContainer:Y}}var OOe=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],bI=I.forwardRef((t,e)=>{var{className:r,value:n="",selection:i,extensions:s=[],onChange:a,onStatistics:o,onCreateEditor:d,onUpdate:m,autoFocus:y,theme:v="light",height:w,minHeight:O,maxHeight:P,width:E,minWidth:$,maxWidth:R,basicSetup:F,placeholder:D,indentWithTab:U,editable:X,readOnly:ee,root:K,initialState:Y}=t,ne=mW(t,OOe),oe=I.useRef(null),{state:ce,view:Xe,container:Ae,setContainer:We}=TOe({root:K,value:n,autoFocus:y,theme:v,height:w,minHeight:O,maxHeight:P,width:E,minWidth:$,maxWidth:R,basicSetup:F,placeholder:D,indentWithTab:U,editable:X,readOnly:ee,selection:i,onChange:a,onStatistics:o,onCreateEditor:d,onUpdate:m,extensions:s,initialState:Y});I.useImperativeHandle(e,()=>({editor:oe.current,state:ce,view:Xe}),[oe,Ae,ce,Xe]);var Ye=I.useCallback(Be=>{oe.current=Be,We(Be)},[We]);if(typeof n!="string")throw new Error("value must be typeof string but got "+typeof n);var tt=typeof v=="string"?"cm-theme-"+v:"cm-theme";return u.jsx("div",tf({ref:Ye,className:""+tt+(r?" "+r:"")},ne))});bI.displayName="CodeMirror";var o6={};class tk{constructor(e,r,n,i,s,a,o,d,m,y=0,v){this.p=e,this.stack=r,this.state=n,this.reducePos=i,this.pos=s,this.score=a,this.buffer=o,this.bufferBase=d,this.curContext=m,this.lookAhead=y,this.parent=v}toString(){return`[${this.stack.filter((e,r)=>r%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,r,n=0){let i=e.parser.context;return new tk(e,[],r,n,n,0,[],0,i?new a6(i,i.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,r){this.stack.push(this.state,r,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var r;let n=e>>19,i=e&65535,{parser:s}=this.p,a=this.reducePos<this.pos-25&&this.setLookAhead(this.pos),o=s.dynamicPrecedence(i);if(o&&(this.score+=o),n==0){this.pushState(s.getGoto(this.state,i,!0),this.reducePos),i<s.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,a?8:4,!0),this.reduceContext(i,this.reducePos);return}let d=this.stack.length-(n-1)*3-(e&262144?6:0),m=d?this.stack[d-2]:this.p.ranges[0].from,y=this.reducePos-m;y>=2e3&&!(!((r=this.p.parser.nodeSet.types[i])===null||r===void 0)&&r.isAnonymous)&&(m==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=y):this.p.lastBigReductionSize<y&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=m,this.p.lastBigReductionSize=y));let v=d?this.stack[d-1]:0,w=this.bufferBase+this.buffer.length-v;if(i<s.minRepeatTerm||e&131072){let O=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,m,O,w+4,!0)}if(e&262144)this.state=this.stack[d];else{let O=this.stack[d-3];this.state=s.getGoto(O,i,!0)}for(;this.stack.length>d;)this.stack.pop();this.reduceContext(i,m)}storeNode(e,r,n,i=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let a=this,o=this.buffer.length;if(o==0&&a.parent&&(o=a.bufferBase-a.parent.bufferBase,a=a.parent),o>0&&a.buffer[o-4]==0&&a.buffer[o-1]>-1){if(r==n)return;if(a.buffer[o-2]>=r){a.buffer[o-2]=n;return}}}if(!s||this.pos==n)this.buffer.push(e,r,n,i);else{let a=this.buffer.length;if(a>0&&(this.buffer[a-4]!=0||this.buffer[a-1]<0)){let o=!1;for(let d=a;d>0&&this.buffer[d-2]>n;d-=4)if(this.buffer[d-1]>=0){o=!0;break}if(o)for(;a>0&&this.buffer[a-2]>n;)this.buffer[a]=this.buffer[a-4],this.buffer[a+1]=this.buffer[a-3],this.buffer[a+2]=this.buffer[a-2],this.buffer[a+3]=this.buffer[a-1],a-=4,i>4&&(i-=4)}this.buffer[a]=e,this.buffer[a+1]=r,this.buffer[a+2]=n,this.buffer[a+3]=i}}shift(e,r,n,i){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=i,this.shiftContext(r,n),r<=this.p.parser.maxNode&&this.buffer.push(r,n,i,4);else{let s=e,{parser:a}=this.p;this.pos=i;let o=a.stateFlag(s,1);!o&&(i>n||r<=a.maxNode)&&(this.reducePos=i),this.pushState(s,o?n:Math.min(n,this.reducePos)),this.shiftContext(r,n),r<=a.maxNode&&this.buffer.push(r,n,i,4)}}apply(e,r,n,i){e&65536?this.reduce(e):this.shift(e,r,n,i)}useNode(e,r){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let i=this.pos;this.reducePos=this.pos=i+e.length,this.pushState(r,i),this.buffer.push(n,i,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,r=e.buffer.length;for(;r>0&&e.buffer[r-2]>e.reducePos;)r-=4;let n=e.buffer.slice(r),i=e.bufferBase+r;for(;e&&i==e.bufferBase;)e=e.parent;return new tk(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,i,this.curContext,this.lookAhead,e)}recoverByDelete(e,r){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,r,4),this.storeNode(0,this.pos,r,n?8:4),this.pos=this.reducePos=r,this.score-=190}canShift(e){for(let r=new jOe(this);;){let n=this.p.parser.stateSlot(r.state,4)||this.p.parser.hasAction(r.state,e);if(n==0)return!1;if(!(n&65536))return!0;r.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let r=this.p.parser.nextStates(this.state);if(r.length>8||this.stack.length>=120){let i=[];for(let s=0,a;s<r.length;s+=2)(a=r[s+1])!=this.state&&this.p.parser.hasAction(a,e)&&i.push(r[s],a);if(this.stack.length<120)for(let s=0;i.length<8&&s<r.length;s+=2){let a=r[s+1];i.some((o,d)=>d&1&&o==a)||i.push(r[s],a)}r=i}let n=[];for(let i=0;i<r.length&&n.length<4;i+=2){let s=r[i+1];if(s==this.state)continue;let a=this.split();a.pushState(s,this.pos),a.storeNode(0,a.pos,a.pos,4,!0),a.shiftContext(r[i],this.pos),a.reducePos=this.pos,a.score-=200,n.push(a)}return n}forceReduce(){let{parser:e}=this.p,r=e.stateSlot(this.state,5);if(!(r&65536))return!1;if(!e.validAction(this.state,r)){let n=r>>19,i=r&65535,s=this.stack.length-n*3;if(s<0||e.getGoto(this.stack[s],i,!1)<0){let a=this.findForcedReduction();if(a==null)return!1;r=a}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(r),!0}findForcedReduction(){let{parser:e}=this.p,r=[],n=(i,s)=>{if(!r.includes(i))return r.push(i),e.allActions(i,a=>{if(!(a&393216))if(a&65536){let o=(a>>19)-s;if(o>1){let d=a&65535,m=this.stack.length-o*3;if(m>=0&&e.getGoto(this.stack[m],d,!1)>=0)return o<<19|65536|d}}else{let o=n(a,s+1);if(o!=null)return o}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let r=0;r<this.stack.length;r+=3)if(this.stack[r]!=e.stack[r])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,r){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(r)))}reduceContext(e,r){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(r)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let r=new a6(this.curContext.tracker,e);r.hash!=this.curContext.hash&&this.emitContext(),this.curContext=r}}setLookAhead(e){return e<=this.lookAhead?!1:(this.emitLookAhead(),this.lookAhead=e,!0)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class a6{constructor(e,r){this.tracker=e,this.context=r,this.hash=e.strict?e.hash(r):0}}class jOe{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let r=e&65535,n=e>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let i=this.start.p.parser.getGoto(this.stack[this.base-3],r,!0);this.state=i}}class rk{constructor(e,r,n){this.stack=e,this.pos=r,this.index=n,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,r=e.bufferBase+e.buffer.length){return new rk(e,r,r-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new rk(this.stack,this.pos,this.index)}}function vv(t,e=Uint16Array){if(typeof t!="string")return t;let r=null;for(let n=0,i=0;n<t.length;){let s=0;for(;;){let a=t.charCodeAt(n++),o=!1;if(a==126){s=65535;break}a>=92&&a--,a>=34&&a--;let d=a-32;if(d>=46&&(d-=46,o=!0),s+=d,o)break;s*=46}r?r[i++]=s:r=new e(s)}return r}class LS{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const l6=new LS;class POe{constructor(e,r){this.input=e,this.ranges=r,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=l6,this.rangeIndex=0,this.pos=this.chunkPos=r[0].from,this.range=r[0],this.end=r[r.length-1].to,this.readNext()}resolveOffset(e,r){let n=this.range,i=this.rangeIndex,s=this.pos+e;for(;s<n.from;){if(!i)return null;let a=this.ranges[--i];s-=n.from-a.to,n=a}for(;r<0?s>n.to:s>=n.to;){if(i==this.ranges.length-1)return null;let a=this.ranges[++i];s+=a.from-n.to,n=a}return s}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let r of this.ranges)if(r.to>e)return Math.max(e,r.from);return this.end}peek(e){let r=this.chunkOff+e,n,i;if(r>=0&&r<this.chunk.length)n=this.pos+e,i=this.chunk.charCodeAt(r);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(n=s,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let a=this.rangeIndex,o=this.range;for(;o.to<=n;)o=this.ranges[++a];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>o.to&&(this.chunk2=this.chunk2.slice(0,o.to-n)),i=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),i}acceptToken(e,r=0){let n=r?this.resolveOffset(r,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}acceptTokenTo(e,r){this.token.value=e,this.token.end=r}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:r}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=r,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),r=this.pos+e.length;this.chunk=r>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,r){if(r?(this.token=r,r.start=e,r.lookAhead=e+1,r.value=r.extended=-1):this.token=l6,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,r){if(e>=this.chunkPos&&r<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,r-this.chunkPos);if(e>=this.chunk2Pos&&r<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,r-this.chunk2Pos);if(e>=this.range.from&&r<=this.range.to)return this.input.read(e,r);let n="";for(let i of this.ranges){if(i.from>=r)break;i.to>e&&(n+=this.input.read(Math.max(i.from,e),Math.min(i.to,r)))}return n}}class ky{constructor(e,r){this.data=e,this.id=r}token(e,r){let{parser:n}=r.p;TH(this.data,e,r,this.id,n.data,n.tokenPrecTable)}}ky.prototype.contextual=ky.prototype.fallback=ky.prototype.extend=!1;class CH{constructor(e,r,n){this.precTable=r,this.elseToken=n,this.data=typeof e=="string"?vv(e):e}token(e,r){let n=e.pos,i=0;for(;;){let s=e.next<0,a=e.resolveOffset(1,1);if(TH(this.data,e,r,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(s||i++,a==null)break;e.reset(a,e.token)}i&&(e.reset(n,e.token),e.acceptToken(this.elseToken,i))}}CH.prototype.contextual=ky.prototype.fallback=ky.prototype.extend=!1;class Sm{constructor(e,r={}){this.token=e,this.contextual=!!r.contextual,this.fallback=!!r.fallback,this.extend=!!r.extend}}function TH(t,e,r,n,i,s){let a=0,o=1<<n,{dialect:d}=r.p.parser;e:for(;o&t[a];){let m=t[a+1];for(let O=a+3;O<m;O+=2)if((t[O+1]&o)>0){let P=t[O];if(d.allows(P)&&(e.token.value==-1||e.token.value==P||AOe(P,e.token.value,i,s))){e.acceptToken(P);break}}let y=e.next,v=0,w=t[a+2];if(e.next<0&&w>v&&t[m+w*3-3]==65535){a=t[m+w*3-1];continue e}for(;v<w;){let O=v+w>>1,P=m+O+(O<<1),E=t[P],$=t[P+1]||65536;if(y<E)w=O;else if(y>=$)v=O+1;else{a=t[P+2],e.advance();continue e}}break}}function c6(t,e,r){for(let n=e,i;(i=t[n])!=65535;n++)if(i==r)return n-e;return-1}function AOe(t,e,r,n){let i=c6(r,n,e);return i<0||c6(r,n,t)<i}const qa=typeof process<"u"&&o6&&/\bparse\b/.test(o6.LOG);let Rj=null;function u6(t,e,r){let n=t.cursor(Ci.IncludeAnonymous);for(n.moveTo(e);;)if(!(r<0?n.childBefore(e):n.childAfter(e)))for(;;){if((r<0?n.to<e:n.from>e)&&!n.type.isError)return r<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(t.length,Math.max(n.from+1,e+25));if(r<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return r<0?0:t.length}}class EOe{constructor(e,r){this.fragments=e,this.nodeSet=r,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?u6(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?u6(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let r=this.trees.length-1;if(r<0)return this.nextFragment(),null;let n=this.trees[r],i=this.index[r];if(i==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=n.children[i],a=this.start[r]+n.positions[i];if(a>e)return this.nextStart=a,null;if(s instanceof qi){if(a==e){if(a<this.safeFrom)return null;let o=a+s.length;if(o<=this.safeTo){let d=s.prop(nn.lookAhead);if(!d||o+d<this.fragment.to)return s}}this.index[r]++,a+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(a),this.index.push(0))}else this.index[r]++,this.nextStart=a+s.length}}}class zOe{constructor(e,r){this.stream=r,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(n=>new LS)}getActions(e){let r=0,n=null,{parser:i}=e.p,{tokenizers:s}=i,a=i.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,d=0;for(let m=0;m<s.length;m++){if(!(1<<m&a))continue;let y=s[m],v=this.tokens[m];if(!(n&&!y.fallback)&&((y.contextual||v.start!=e.pos||v.mask!=a||v.context!=o)&&(this.updateCachedToken(v,y,e),v.mask=a,v.context=o),v.lookAhead>v.end+25&&(d=Math.max(v.lookAhead,d)),v.value!=0)){let w=r;if(v.extended>-1&&(r=this.addActions(e,v.extended,v.end,r)),r=this.addActions(e,v.value,v.end,r),!y.extend&&(n=v,r>w))break}}for(;this.actions.length>r;)this.actions.pop();return d&&e.setLookAhead(d),!n&&e.pos==this.stream.end&&(n=new LS,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,r=this.addActions(e,n.value,n.end,r)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let r=new LS,{pos:n,p:i}=e;return r.start=n,r.end=Math.min(n+1,i.stream.end),r.value=n==i.stream.end?i.parser.eofTerm:0,r}updateCachedToken(e,r,n){let i=this.stream.clipPos(n.pos);if(r.token(this.stream.reset(i,e),n),e.value>-1){let{parser:s}=n.p;for(let a=0;a<s.specialized.length;a++)if(s.specialized[a]==e.value){let o=s.specializers[a](this.stream.read(e.start,e.end),n);if(o>=0&&n.p.parser.dialect.allows(o>>1)){o&1?e.extended=o>>1:e.value=o>>1;break}}}else e.value=0,e.end=this.stream.clipPos(i+1)}putAction(e,r,n,i){for(let s=0;s<i;s+=3)if(this.actions[s]==e)return i;return this.actions[i++]=e,this.actions[i++]=r,this.actions[i++]=n,i}addActions(e,r,n,i){let{state:s}=e,{parser:a}=e.p,{data:o}=a;for(let d=0;d<2;d++)for(let m=a.stateSlot(s,d?2:1);;m+=3){if(o[m]==65535)if(o[m+1]==1)m=Xu(o,m+2);else{i==0&&o[m+1]==2&&(i=this.putAction(Xu(o,m+2),r,n,i));break}o[m]==r&&(i=this.putAction(Xu(o,m+1),r,n,i))}return i}}class MOe{constructor(e,r,n,i){this.parser=e,this.input=r,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new POe(r,i),this.tokens=new zOe(e,this.stream),this.topTerm=e.top[1];let{from:s}=i[0];this.stacks=[tk.start(this,e.top[0],s)],this.fragments=n.length&&this.stream.end-s>e.bufferLength*4?new EOe(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,r=this.minStackPos,n=this.stacks=[],i,s;if(this.bigReductionCount>300&&e.length==1){let[a]=e;for(;a.forceReduce()&&a.stack.length&&a.stack[a.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<e.length;a++){let o=e[a];for(;;){if(this.tokens.mainToken=null,o.pos>r)n.push(o);else{if(this.advanceStack(o,n,e))continue;{i||(i=[],s=[]),i.push(o);let d=this.tokens.getMainToken(o);s.push(d.value,d.end)}}break}}if(!n.length){let a=i&&DOe(i);if(a)return qa&&console.log("Finish with "+this.stackID(a)),this.stackToTree(a);if(this.parser.strict)throw qa&&i&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+r);this.recovering||(this.recovering=5)}if(this.recovering&&i){let a=this.stoppedAt!=null&&i[0].pos>this.stoppedAt?i[0]:this.runRecovery(i,s,n);if(a)return qa&&console.log("Force-finish "+this.stackID(a)),this.stackToTree(a.forceAll())}if(this.recovering){let a=this.recovering==1?1:this.recovering*3;if(n.length>a)for(n.sort((o,d)=>d.score-o.score);n.length>a;)n.pop();n.some(o=>o.reducePos>r)&&this.recovering--}else if(n.length>1){e:for(let a=0;a<n.length-1;a++){let o=n[a];for(let d=a+1;d<n.length;d++){let m=n[d];if(o.sameState(m)||o.buffer.length>500&&m.buffer.length>500)if((o.score-m.score||o.buffer.length-m.buffer.length)>0)n.splice(d--,1);else{n.splice(a--,1);continue e}}}n.length>12&&(n.sort((a,o)=>o.score-a.score),n.splice(12,n.length-12))}this.minStackPos=n[0].pos;for(let a=1;a<n.length;a++)n[a].pos<this.minStackPos&&(this.minStackPos=n[a].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,r,n){let i=e.pos,{parser:s}=this,a=qa?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&i>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let m=e.curContext&&e.curContext.tracker.strict,y=m?e.curContext.hash:0;for(let v=this.fragments.nodeAt(i);v;){let w=this.parser.nodeSet.types[v.type.id]==v.type?s.getGoto(e.state,v.type.id):-1;if(w>-1&&v.length&&(!m||(v.prop(nn.contextHash)||0)==y))return e.useNode(v,w),qa&&console.log(a+this.stackID(e)+` (via reuse of ${s.getName(v.type.id)})`),!0;if(!(v instanceof qi)||v.children.length==0||v.positions[0]>0)break;let O=v.children[0];if(O instanceof qi&&v.positions[0]==0)v=O;else break}}let o=s.stateSlot(e.state,4);if(o>0)return e.reduce(o),qa&&console.log(a+this.stackID(e)+` (via always-reduce ${s.getName(o&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let d=this.tokens.getActions(e);for(let m=0;m<d.length;){let y=d[m++],v=d[m++],w=d[m++],O=m==d.length||!n,P=O?e:e.split(),E=this.tokens.mainToken;if(P.apply(y,v,E?E.start:P.pos,w),qa&&console.log(a+this.stackID(P)+` (via ${y&65536?`reduce of ${s.getName(y&65535)}`:"shift"} for ${s.getName(v)} @ ${i}${P==e?"":", split"})`),O)return!0;P.pos>i?r.push(P):n.push(P)}return!1}advanceFully(e,r){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return h6(e,r),!0}}runRecovery(e,r,n){let i=null,s=!1;for(let a=0;a<e.length;a++){let o=e[a],d=r[a<<1],m=r[(a<<1)+1],y=qa?this.stackID(o)+" -> ":"";if(o.deadEnd&&(s||(s=!0,o.restart(),qa&&console.log(y+this.stackID(o)+" (restarted)"),this.advanceFully(o,n))))continue;let v=o.split(),w=y;for(let O=0;O<10&&v.forceReduce()&&(qa&&console.log(w+this.stackID(v)+" (via force-reduce)"),!this.advanceFully(v,n));O++)qa&&(w=this.stackID(v)+" -> ");for(let O of o.recoverByInsert(d))qa&&console.log(y+this.stackID(O)+" (via recover-insert)"),this.advanceFully(O,n);this.stream.end>o.pos?(m==o.pos&&(m++,d=0),o.recoverByDelete(d,m),qa&&console.log(y+this.stackID(o)+` (via recover-delete ${this.parser.getName(d)})`),h6(o,n)):(!i||i.score<v.score)&&(i=v)}return i}stackToTree(e){return e.close(),qi.build({buffer:rk.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let r=(Rj||(Rj=new WeakMap)).get(e);return r||Rj.set(e,r=String.fromCodePoint(this.nextStackID++)),r+e}}function h6(t,e){for(let r=0;r<e.length;r++){let n=e[r];if(n.pos==t.pos&&n.sameState(t)){e[r].score<t.score&&(e[r]=t);return}}e.push(t)}class IOe{constructor(e,r,n){this.source=e,this.flags=r,this.disabled=n}allows(e){return!this.disabled||this.disabled[e]==0}}const Dj=t=>t;class ROe{constructor(e){this.start=e.start,this.shift=e.shift||Dj,this.reduce=e.reduce||Dj,this.reuse=e.reuse||Dj,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class m0 extends rQ{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let r=e.nodeNames.split(" ");this.minRepeatTerm=r.length;for(let o=0;o<e.repeatNodeCount;o++)r.push("");let n=Object.keys(e.topRules).map(o=>e.topRules[o][1]),i=[];for(let o=0;o<r.length;o++)i.push([]);function s(o,d,m){i[o].push([d,d.deserialize(String(m))])}if(e.nodeProps)for(let o of e.nodeProps){let d=o[0];typeof d=="string"&&(d=nn[d]);for(let m=1;m<o.length;){let y=o[m++];if(y>=0)s(y,d,o[m++]);else{let v=o[m+-y];for(let w=-y;w>0;w--)s(o[m++],d,v);m++}}}this.nodeSet=new rI(r.map((o,d)=>za.define({name:d>=this.minRepeatTerm?void 0:o,id:d,props:i[d],top:n.indexOf(d)>-1,error:d==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(d)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=Yq;let a=vv(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let o=0;o<this.specializerSpecs.length;o++)this.specialized[o]=this.specializerSpecs[o].term;this.specializers=this.specializerSpecs.map(d6),this.states=vv(e.states,Uint32Array),this.data=vv(e.stateData),this.goto=vv(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(o=>typeof o=="number"?new ky(a,o):o),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,r,n){let i=new MOe(this,e,r,n);for(let s of this.wrappers)i=s(i,e,r,n);return i}getGoto(e,r,n=!1){let i=this.goto;if(r>=i[0])return-1;for(let s=i[r+1];;){let a=i[s++],o=a&1,d=i[s++];if(o&&n)return d;for(let m=s+(a>>1);s<m;s++)if(i[s]==e)return d;if(o)return-1}}hasAction(e,r){let n=this.data;for(let i=0;i<2;i++)for(let s=this.stateSlot(e,i?2:1),a;;s+=3){if((a=n[s])==65535)if(n[s+1]==1)a=n[s=Xu(n,s+2)];else{if(n[s+1]==2)return Xu(n,s+2);break}if(a==r||a==0)return Xu(n,s+1)}return 0}stateSlot(e,r){return this.states[e*6+r]}stateFlag(e,r){return(this.stateSlot(e,0)&r)>0}validAction(e,r){return!!this.allActions(e,n=>n==r?!0:null)}allActions(e,r){let n=this.stateSlot(e,4),i=n?r(n):void 0;for(let s=this.stateSlot(e,1);i==null;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=Xu(this.data,s+2);else break;i=r(Xu(this.data,s+1))}return i}nextStates(e){let r=[];for(let n=this.stateSlot(e,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=Xu(this.data,n+2);else break;if(!(this.data[n+2]&1)){let i=this.data[n+1];r.some((s,a)=>a&1&&s==i)||r.push(this.data[n],i)}}return r}configure(e){let r=Object.assign(Object.create(m0.prototype),this);if(e.props&&(r.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);r.top=n}return e.tokenizers&&(r.tokenizers=this.tokenizers.map(n=>{let i=e.tokenizers.find(s=>s.from==n);return i?i.to:n})),e.specializers&&(r.specializers=this.specializers.slice(),r.specializerSpecs=this.specializerSpecs.map((n,i)=>{let s=e.specializers.find(o=>o.from==n.external);if(!s)return n;let a=Object.assign(Object.assign({},n),{external:s.to});return r.specializers[i]=d6(a),a})),e.contextTracker&&(r.context=e.contextTracker),e.dialect&&(r.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(r.strict=e.strict),e.wrap&&(r.wrappers=r.wrappers.concat(e.wrap)),e.bufferLength!=null&&(r.bufferLength=e.bufferLength),r}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let r=this.dynamicPrecedences;return r==null?0:r[e]||0}parseDialect(e){let r=Object.keys(this.dialects),n=r.map(()=>!1);if(e)for(let s of e.split(" ")){let a=r.indexOf(s);a>=0&&(n[a]=!0)}let i=null;for(let s=0;s<r.length;s++)if(!n[s])for(let a=this.dialects[r[s]],o;(o=this.data[a++])!=65535;)(i||(i=new Uint8Array(this.maxTerm+1)))[o]=1;return new IOe(e,n,i)}static deserialize(e){return new m0(e)}}function Xu(t,e){return t[e]|t[e+1]<<16}function DOe(t){let e=null;for(let r of t){let n=r.p.stoppedAt;(r.pos==r.p.stream.end||n!=null&&r.pos>n)&&r.p.parser.stateFlag(r.state,2)&&(!e||e.score<r.score)&&(e=r)}return e}function d6(t){if(t.external){let e=t.extend?1:0;return(r,n)=>t.external(r,n)<<1|e}return t.get}const LOe=36,f6=1,FOe=2,wg=3,Lj=4,BOe=5,$Oe=6,NOe=7,VOe=8,WOe=9,UOe=10,qOe=11,QOe=12,HOe=13,GOe=14,XOe=15,KOe=16,ZOe=17,p6=18,YOe=19,OH=20,jH=21,m6=22,JOe=23,eje=24;function VE(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57}function tje(t){return t>=48&&t<=57||t>=97&&t<=102||t>=65&&t<=70}function hp(t,e,r){for(let n=!1;;){if(t.next<0)return;if(t.next==e&&!n){t.advance();return}n=r&&!n&&t.next==92,t.advance()}}function rje(t,e){e:for(;;){if(t.next<0)return;if(t.next==36){t.advance();for(let r=0;r<e.length;r++){if(t.next!=e.charCodeAt(r))continue e;t.advance()}if(t.next==36){t.advance();return}}else t.advance()}}function nje(t,e){let r="[{<(".indexOf(String.fromCharCode(e)),n=r<0?e:"]}>)".charCodeAt(r);for(;;){if(t.next<0)return;if(t.next==n&&t.peek(1)==39){t.advance(2);return}t.advance()}}function WE(t,e){for(;!(t.next!=95&&!VE(t.next));)e!=null&&(e+=String.fromCharCode(t.next)),t.advance();return e}function ije(t){if(t.next==39||t.next==34||t.next==96){let e=t.next;t.advance(),hp(t,e,!1)}else WE(t)}function g6(t,e){for(;t.next==48||t.next==49;)t.advance();e&&t.next==e&&t.advance()}function y6(t,e){for(;;){if(t.next==46){if(e)break;e=!0}else if(t.next<48||t.next>57)break;t.advance()}if(t.next==69||t.next==101)for(t.advance(),(t.next==43||t.next==45)&&t.advance();t.next>=48&&t.next<=57;)t.advance()}function x6(t){for(;!(t.next<0||t.next==10);)t.advance()}function ip(t,e){for(let r=0;r<e.length;r++)if(e.charCodeAt(r)==t)return!0;return!1}const Fj=` 	\r
`;function PH(t,e,r){let n=Object.create(null);n.true=n.false=BOe,n.null=n.unknown=$Oe;for(let i of t.split(" "))i&&(n[i]=OH);for(let i of e.split(" "))i&&(n[i]=jH);for(let i of(r||"").split(" "))i&&(n[i]=eje);return n}const AH="array binary bit boolean char character clob date decimal double float int integer interval large national nchar nclob numeric object precision real smallint time timestamp varchar varying ",EH="absolute action add after all allocate alter and any are as asc assertion at authorization before begin between both breadth by call cascade cascaded case cast catalog check close collate collation column commit condition connect connection constraint constraints constructor continue corresponding count create cross cube current current_date current_default_transform_group current_transform_group_for_type current_path current_role current_time current_timestamp current_user cursor cycle data day deallocate declare default deferrable deferred delete depth deref desc describe descriptor deterministic diagnostics disconnect distinct do domain drop dynamic each else elseif end end-exec equals escape except exception exec execute exists exit external fetch first for foreign found from free full function general get global go goto grant group grouping handle having hold hour identity if immediate in indicator initially inner inout input insert intersect into is isolation join key language last lateral leading leave left level like limit local localtime localtimestamp locator loop map match method minute modifies module month names natural nesting new next no none not of old on only open option or order ordinality out outer output overlaps pad parameter partial path prepare preserve primary prior privileges procedure public read reads recursive redo ref references referencing relative release repeat resignal restrict result return returns revoke right role rollback rollup routine row rows savepoint schema scroll search second section select session session_user set sets signal similar size some space specific specifictype sql sqlexception sqlstate sqlwarning start state static system_user table temporary then timezone_hour timezone_minute to trailing transaction translation treat trigger under undo union unique unnest until update usage user using value values view when whenever where while with without work write year zone ",UE={backslashEscapes:!1,hashComments:!1,spaceAfterDashes:!1,slashComments:!1,doubleQuotedStrings:!1,doubleDollarQuotedStrings:!1,unquotedBitLiterals:!1,treatBitsAsBytes:!1,charSetCasts:!1,plsqlQuotingMechanism:!1,operatorChars:"*+-%<>!=&|~^/",specialVar:"?",identifierQuotes:'"',caseInsensitiveIdentifiers:!1,words:PH(EH,AH)};function sje(t,e,r,n){let i={};for(let s in UE)i[s]=(t.hasOwnProperty(s)?t:UE)[s];return e&&(i.words=PH(e,r||"",n)),i}function zH(t){return new Sm(e=>{var r;let{next:n}=e;if(e.advance(),ip(n,Fj)){for(;ip(e.next,Fj);)e.advance();e.acceptToken(LOe)}else if(n==36&&t.doubleDollarQuotedStrings){let i=WE(e,"");e.next==36&&(e.advance(),rje(e,i),e.acceptToken(wg))}else if(n==39||n==34&&t.doubleQuotedStrings)hp(e,n,t.backslashEscapes),e.acceptToken(wg);else if(n==35&&t.hashComments||n==47&&e.next==47&&t.slashComments)x6(e),e.acceptToken(f6);else if(n==45&&e.next==45&&(!t.spaceAfterDashes||e.peek(1)==32))x6(e),e.acceptToken(f6);else if(n==47&&e.next==42){e.advance();for(let i=1;;){let s=e.next;if(e.next<0)break;if(e.advance(),s==42&&e.next==47){if(i--,e.advance(),!i)break}else s==47&&e.next==42&&(i++,e.advance())}e.acceptToken(FOe)}else if((n==101||n==69)&&e.next==39)e.advance(),hp(e,39,!0),e.acceptToken(wg);else if((n==110||n==78)&&e.next==39&&t.charSetCasts)e.advance(),hp(e,39,t.backslashEscapes),e.acceptToken(wg);else if(n==95&&t.charSetCasts)for(let i=0;;i++){if(e.next==39&&i>1){e.advance(),hp(e,39,t.backslashEscapes),e.acceptToken(wg);break}if(!VE(e.next))break;e.advance()}else if(t.plsqlQuotingMechanism&&(n==113||n==81)&&e.next==39&&e.peek(1)>0&&!ip(e.peek(1),Fj)){let i=e.peek(1);e.advance(2),nje(e,i),e.acceptToken(wg)}else if(ip(n,t.identifierQuotes)){const i=n==91?93:n;hp(e,i,!1),e.acceptToken(YOe)}else if(n==40)e.acceptToken(NOe);else if(n==41)e.acceptToken(VOe);else if(n==123)e.acceptToken(WOe);else if(n==125)e.acceptToken(UOe);else if(n==91)e.acceptToken(qOe);else if(n==93)e.acceptToken(QOe);else if(n==59)e.acceptToken(HOe);else if(t.unquotedBitLiterals&&n==48&&e.next==98)e.advance(),g6(e),e.acceptToken(m6);else if((n==98||n==66)&&(e.next==39||e.next==34)){const i=e.next;e.advance(),t.treatBitsAsBytes?(hp(e,i,t.backslashEscapes),e.acceptToken(JOe)):(g6(e,i),e.acceptToken(m6))}else if(n==48&&(e.next==120||e.next==88)||(n==120||n==88)&&e.next==39){let i=e.next==39;for(e.advance();tje(e.next);)e.advance();i&&e.next==39&&e.advance(),e.acceptToken(Lj)}else if(n==46&&e.next>=48&&e.next<=57)y6(e,!0),e.acceptToken(Lj);else if(n==46)e.acceptToken(GOe);else if(n>=48&&n<=57)y6(e,!1),e.acceptToken(Lj);else if(ip(n,t.operatorChars)){for(;ip(e.next,t.operatorChars);)e.advance();e.acceptToken(XOe)}else if(ip(n,t.specialVar))e.next==n&&e.advance(),ije(e),e.acceptToken(ZOe);else if(n==58||n==44)e.acceptToken(KOe);else if(VE(n)){let i=WE(e,String.fromCharCode(n));e.acceptToken(e.next==46||e.peek(-i.length-1)==46?p6:(r=t.words[i.toLowerCase()])!==null&&r!==void 0?r:p6)}})}const MH=zH(UE),oje=m0.deserialize({version:14,states:"%vQ]QQOOO#wQRO'#DSO$OQQO'#CwO%eQQO'#CxO%lQQO'#CyO%sQQO'#CzOOQQ'#DS'#DSOOQQ'#C}'#C}O'UQRO'#C{OOQQ'#Cv'#CvOOQQ'#C|'#C|Q]QQOOQOQQOOO'`QQO'#DOO(xQRO,59cO)PQQO,59cO)UQQO'#DSOOQQ,59d,59dO)cQQO,59dOOQQ,59e,59eO)jQQO,59eOOQQ,59f,59fO)qQQO,59fOOQQ-E6{-E6{OOQQ,59b,59bOOQQ-E6z-E6zOOQQ,59j,59jOOQQ-E6|-E6|O+VQRO1G.}O+^QQO,59cOOQQ1G/O1G/OOOQQ1G/P1G/POOQQ1G/Q1G/QP+kQQO'#C}O+rQQO1G.}O)PQQO,59cO,PQQO'#Cw",stateData:",[~OtOSPOSQOS~ORUOSUOTUOUUOVROXSOZTO]XO^QO_UO`UOaPObPOcPOdUOeUOfUOgUOhUO~O^]ORvXSvXTvXUvXVvXXvXZvX]vX_vX`vXavXbvXcvXdvXevXfvXgvXhvX~OsvX~P!jOa_Ob_Oc_O~ORUOSUOTUOUUOVROXSOZTO^tO_UO`UOa`Ob`Oc`OdUOeUOfUOgUOhUO~OWaO~P$ZOYcO~P$ZO[eO~P$ZORUOSUOTUOUUOVROXSOZTO^QO_UO`UOaPObPOcPOdUOeUOfUOgUOhUO~O]hOsoX~P%zOajObjOcjO~O^]ORkaSkaTkaUkaVkaXkaZka]ka_ka`kaakabkackadkaekafkagkahka~Oska~P'kO^]O~OWvXYvX[vX~P!jOWnO~P$ZOYoO~P$ZO[pO~P$ZO^]ORkiSkiTkiUkiVkiXkiZki]ki_ki`kiakibkickidkiekifkigkihki~Oski~P)xOWkaYka[ka~P'kO]hO~P$ZOWkiYki[ki~P)xOasObsOcsO~O",goto:"#hwPPPPPPPPPPPPPPPPPPPPPPPPPPx||||!Y!^!d!xPPP#[TYOZeUORSTWZbdfqT[OZQZORiZSWOZQbRQdSQfTZgWbdfqQ^PWk^lmrQl_Qm`RrseVORSTWZbdfq",nodeNames:" LineComment BlockComment String Number Bool Null ( ) { } [ ] ; . Operator Punctuation SpecialVar Identifier QuotedIdentifier Keyword Type Bits Bytes Builtin Script Statement CompositeIdentifier Parens Braces Brackets Statement",maxTerm:38,nodeProps:[["isolate",-4,1,2,3,19,""]],skippedNodes:[0,1,2],repeatNodeCount:3,tokenData:"RORO",tokenizers:[0,MH],topRules:{Script:[0,25]},tokenPrec:0});function qE(t){let e=t.cursor().moveTo(t.from,-1);for(;/Comment/.test(e.name);)e.moveTo(e.from,-1);return e.node}function Zb(t,e){let r=t.sliceString(e.from,e.to),n=/^([`'"\[])(.*)([`'"\]])$/.exec(r);return n?n[2]:r}function nk(t){return t&&(t.name=="Identifier"||t.name=="QuotedIdentifier")}function aje(t,e){if(e.name=="CompositeIdentifier"){let r=[];for(let n=e.firstChild;n;n=n.nextSibling)nk(n)&&r.push(Zb(t,n));return r}return[Zb(t,e)]}function v6(t,e){for(let r=[];;){if(!e||e.name!=".")return r;let n=qE(e);if(!nk(n))return r;r.unshift(Zb(t,n)),e=qE(n)}}function lje(t,e){let r=Hi(t).resolveInner(e,-1),n=uje(t.doc,r);return r.name=="Identifier"||r.name=="QuotedIdentifier"||r.name=="Keyword"?{from:r.from,quoted:r.name=="QuotedIdentifier"?t.doc.sliceString(r.from,r.from+1):null,parents:v6(t.doc,qE(r)),aliases:n}:r.name=="."?{from:e,quoted:null,parents:v6(t.doc,r),aliases:n}:{from:e,quoted:null,parents:[],empty:!0,aliases:n}}const cje=new Set("where group having order union intersect except all distinct limit offset fetch for".split(" "));function uje(t,e){let r;for(let i=e;!r;i=i.parent){if(!i)return null;i.name=="Statement"&&(r=i)}let n=null;for(let i=r.firstChild,s=!1,a=null;i;i=i.nextSibling){let o=i.name=="Keyword"?t.sliceString(i.from,i.to).toLowerCase():null,d=null;if(!s)s=o=="from";else if(o=="as"&&a&&nk(i.nextSibling))d=Zb(t,i.nextSibling);else{if(o&&cje.has(o))break;a&&nk(i)&&(d=Zb(t,i))}d&&(n||(n=Object.create(null)),n[d]=aje(t,a)),a=/Identifier$/.test(i.name)?i:null}return n}function hje(t,e,r){return r.map(n=>({...n,label:n.label[0]==t?n.label:t+n.label+e,apply:void 0}))}const dje=/^\w*$/,fje=/^[`'"\[]?\w*[`'"\]]?$/;function b6(t){return t.self&&typeof t.self.label=="string"}class _I{constructor(e,r){this.idQuote=e,this.idCaseInsensitive=r,this.list=[],this.children=void 0}child(e){let r=this.children||(this.children=Object.create(null)),n=r[e];return n||(e&&!this.list.some(i=>i.label==e)&&this.list.push(_6(e,"type",this.idQuote,this.idCaseInsensitive)),r[e]=new _I(this.idQuote,this.idCaseInsensitive))}maybeChild(e){return this.children?this.children[e]:null}addCompletion(e){let r=this.list.findIndex(n=>n.label==e.label);r>-1?this.list[r]=e:this.list.push(e)}addCompletions(e){for(let r of e)this.addCompletion(typeof r=="string"?_6(r,"property",this.idQuote,this.idCaseInsensitive):r)}addNamespace(e){Array.isArray(e)?this.addCompletions(e):b6(e)?this.addNamespace(e.children):this.addNamespaceObject(e)}addNamespaceObject(e){for(let r of Object.keys(e)){let n=e[r],i=null,s=r.replace(/\\?\./g,o=>o=="."?"\0":o).split("\0"),a=this;b6(n)&&(i=n.self,n=n.children);for(let o=0;o<s.length;o++)i&&o==s.length-1&&a.addCompletion(i),a=a.child(s[o].replace(/\\\./g,"."));a.addNamespace(n)}}}function _6(t,e,r,n){return new RegExp("^[a-z_][a-z_\\d]*$",n?"i":"").test(t)?{label:t,type:e}:{label:t,type:e,apply:r+t+IH(r)}}function IH(t){return t==="["?"]":t}function pje(t,e,r,n,i,s){var a;let o=((a=s==null?void 0:s.spec.identifierQuotes)===null||a===void 0?void 0:a[0])||'"',d=new _I(o,!!(s!=null&&s.spec.caseInsensitiveIdentifiers)),m=i?d.child(i):null;return d.addNamespace(t),e&&(m||d).addCompletions(e),r&&d.addCompletions(r),m&&d.addCompletions(m.list),n&&d.addCompletions((m||d).child(n).list),y=>{let{parents:v,from:w,quoted:O,empty:P,aliases:E}=lje(y.state,y.pos);if(P&&!y.explicit)return null;E&&v.length==1&&(v=E[v[0]]||v);let $=d;for(let F of v){for(;!$.children||!$.children[F];)if($==d&&m)$=m;else if($==m&&n)$=$.child(n);else return null;let D=$.maybeChild(F);if(!D)return null;$=D}let R=$.list;if($==d&&E&&(R=R.concat(Object.keys(E).map(F=>({label:F,type:"constant"})))),O){let F=O[0],D=IH(F),U=y.state.sliceDoc(y.pos,y.pos+1)==D;return{from:w,to:U?y.pos+1:void 0,options:hje(F,D,R),validFor:fje}}else return{from:w,options:R,validFor:dje}}}function mje(t){return t==jH?"type":t==OH?"keyword":"variable"}function gje(t,e,r){let n=Object.keys(t).map(i=>r(e?i.toUpperCase():i,mje(t[i])));return uTe(["QuotedIdentifier","String","LineComment","BlockComment","."],uH(n))}let yje=oje.configure({props:[SC.add({Statement:aQ()}),kC.add({Statement(t,e){return{from:Math.min(t.from+100,e.doc.lineAt(t.from).to),to:t.to}},BlockComment(t){return{from:t.from+2,to:t.to-2}}}),bC({Keyword:Ve.keyword,Type:Ve.typeName,Builtin:Ve.standard(Ve.name),Bits:Ve.number,Bytes:Ve.string,Bool:Ve.bool,Null:Ve.null,Number:Ve.number,String:Ve.string,Identifier:Ve.name,QuotedIdentifier:Ve.special(Ve.string),SpecialVar:Ve.special(Ve.name),LineComment:Ve.lineComment,BlockComment:Ve.blockComment,Operator:Ve.operator,"Semi Punctuation":Ve.punctuation,"( )":Ve.paren,"{ }":Ve.brace,"[ ]":Ve.squareBracket})]});class Yb{constructor(e,r,n){this.dialect=e,this.language=r,this.spec=n}get extension(){return this.language.extension}configureLanguage(e,r){return new Yb(this.dialect,this.language.configure(e,r),this.spec)}static define(e){let r=sje(e,e.keywords,e.types,e.builtin),n=h0.define({name:"sql",parser:yje.configure({tokenizers:[{from:MH,to:zH(r)}]}),languageData:{commentTokens:{line:"--",block:{open:"/*",close:"*/"}},closeBrackets:{brackets:["(","[","{","'",'"',"`"]}}});return new Yb(r,n,e)}}function xje(t,e){return{label:t,type:e,boost:-1}}function vje(t,e=!1,r){return gje(t.dialect.words,e,r||xje)}function bje(t){return t.schema?pje(t.schema,t.tables,t.schemas,t.defaultTable,t.defaultSchema,t.dialect||wI):()=>null}function _je(t){return t.schema?(t.dialect||wI).language.data.of({autocomplete:bje(t)}):[]}function wje(t={}){let e=t.dialect||wI;return new oI(e.language,[_je(t),e.language.data.of({autocomplete:vje(e,t.upperCaseKeywords,t.keywordCompletion)})])}const wI=Yb.define({}),Sje=Yb.define({charSetCasts:!0,doubleDollarQuotedStrings:!0,operatorChars:"+-*/<>=~!@#%^&|`?",specialVar:"",keywords:EH+"abort abs absent access according ada admin aggregate alias also always analyse analyze array_agg array_max_cardinality asensitive assert assignment asymmetric atomic attach attribute attributes avg backward base64 begin_frame begin_partition bernoulli bit_length blocked bom cache called cardinality catalog_name ceil ceiling chain char_length character_length character_set_catalog character_set_name character_set_schema characteristics characters checkpoint class class_origin cluster coalesce cobol collation_catalog collation_name collation_schema collect column_name columns command_function command_function_code comment comments committed concurrently condition_number configuration conflict connection_name constant constraint_catalog constraint_name constraint_schema contains content control conversion convert copy corr cost covar_pop covar_samp csv cume_dist current_catalog current_row current_schema cursor_name database datalink datatype datetime_interval_code datetime_interval_precision db debug defaults defined definer degree delimiter delimiters dense_rank depends derived detach detail dictionary disable discard dispatch dlnewcopy dlpreviouscopy dlurlcomplete dlurlcompleteonly dlurlcompletewrite dlurlpath dlurlpathonly dlurlpathwrite dlurlscheme dlurlserver dlvalue document dump dynamic_function dynamic_function_code element elsif empty enable encoding encrypted end_frame end_partition endexec enforced enum errcode error event every exclude excluding exclusive exp explain expression extension extract family file filter final first_value flag floor following force foreach fortran forward frame_row freeze fs functions fusion generated granted greatest groups handler header hex hierarchy hint id ignore ilike immediately immutable implementation implicit import include including increment indent index indexes info inherit inherits inline insensitive instance instantiable instead integrity intersection invoker isnull key_member key_type label lag last_value lead leakproof least length library like_regex link listen ln load location lock locked log logged lower mapping matched materialized max max_cardinality maxvalue member merge message message_length message_octet_length message_text min minvalue mod mode more move multiset mumps name namespace nfc nfd nfkc nfkd nil normalize normalized nothing notice notify notnull nowait nth_value ntile nullable nullif nulls number occurrences_regex octet_length octets off offset oids operator options ordering others over overlay overriding owned owner parallel parameter_mode parameter_name parameter_ordinal_position parameter_specific_catalog parameter_specific_name parameter_specific_schema parser partition pascal passing passthrough password percent percent_rank percentile_cont percentile_disc perform period permission pg_context pg_datatype_name pg_exception_context pg_exception_detail pg_exception_hint placing plans pli policy portion position position_regex power precedes preceding prepared print_strict_params procedural procedures program publication query quote raise range rank reassign recheck recovery refresh regr_avgx regr_avgy regr_count regr_intercept regr_r2 regr_slope regr_sxx regr_sxy regr_syy reindex rename repeatable replace replica requiring reset respect restart restore result_oid returned_cardinality returned_length returned_octet_length returned_sqlstate returning reverse routine_catalog routine_name routine_schema routines row_count row_number rowtype rule scale schema_name schemas scope scope_catalog scope_name scope_schema security selective self sensitive sequence sequences serializable server server_name setof share show simple skip slice snapshot source specific_name sqlcode sqlerror sqrt stable stacked standalone statement statistics stddev_pop stddev_samp stdin stdout storage strict strip structure style subclass_origin submultiset subscription substring substring_regex succeeds sum symmetric sysid system system_time table_name tables tablesample tablespace temp template ties token top_level_count transaction_active transactions_committed transactions_rolled_back transform transforms translate translate_regex trigger_catalog trigger_name trigger_schema trim trim_array truncate trusted type types uescape unbounded uncommitted unencrypted unlink unlisten unlogged unnamed untyped upper uri use_column use_variable user_defined_type_catalog user_defined_type_code user_defined_type_name user_defined_type_schema vacuum valid validate validator value_of var_pop var_samp varbinary variable_conflict variadic verbose version versioning views volatile warning whitespace width_bucket window within wrapper xmlagg xmlattributes xmlbinary xmlcast xmlcomment xmlconcat xmldeclaration xmldocument xmlelement xmlexists xmlforest xmliterate xmlnamespaces xmlparse xmlpi xmlquery xmlroot xmlschema xmlserialize xmltable xmltext xmlvalidate yes",types:AH+"bigint int8 bigserial serial8 varbit bool box bytea cidr circle precision float8 inet int4 json jsonb line lseg macaddr macaddr8 money numeric pg_lsn point polygon float4 int2 smallserial serial2 serial serial4 text timetz timestamptz tsquery tsvector txid_snapshot uuid xml"}),kje=["SELECT","FROM","WHERE","AND","OR","NOT","IN","BETWEEN","LIKE","ILIKE","IS","NULL","TRUE","FALSE","AS","ON","JOIN","LEFT","RIGHT","INNER","OUTER","FULL","CROSS","NATURAL","USING","GROUP","BY","HAVING","ORDER","ASC","DESC","NULLS","FIRST","LAST","LIMIT","OFFSET","DISTINCT","ALL","UNION","INTERSECT","EXCEPT","CASE","WHEN","THEN","ELSE","END","CAST","COALESCE","NULLIF","EXISTS","ANY","SOME","WITH","RECURSIVE","OVER","PARTITION","WINDOW","ROWS","RANGE","UNBOUNDED","PRECEDING","FOLLOWING","CURRENT","ROW","FILTER","WITHIN","LATERAL","FETCH","NEXT","ONLY"],Cje=["COUNT","SUM","AVG","MIN","MAX","ARRAY_AGG","STRING_AGG","BOOL_AND","BOOL_OR","BIT_AND","BIT_OR","EVERY","PERCENTILE_CONT","PERCENTILE_DISC","LENGTH","LOWER","UPPER","TRIM","LTRIM","RTRIM","SUBSTRING","POSITION","REPLACE","CONCAT","CONCAT_WS","SPLIT_PART","REGEXP_REPLACE","REGEXP_MATCHES","LEFT","RIGHT","REVERSE","REPEAT","LPAD","RPAD","INITCAP","FORMAT","ABS","CEIL","CEILING","FLOOR","ROUND","TRUNC","MOD","POWER","SQRT","EXP","LN","LOG","RANDOM","SIGN","GREATEST","LEAST","NOW","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATE_PART","DATE_TRUNC","EXTRACT","AGE","INTERVAL","TO_CHAR","TO_DATE","TO_TIMESTAMP","JSON_AGG","JSONB_AGG","JSON_BUILD_OBJECT","JSONB_BUILD_OBJECT","JSON_OBJECT_AGG","JSONB_OBJECT_AGG","ROW_TO_JSON","JSON_ARRAY_LENGTH","ARRAY_LENGTH","ARRAY_TO_STRING","STRING_TO_ARRAY","UNNEST","ARRAY_CAT","CAST","TO_NUMBER","TO_TEXT"],Tje=["ST_Point","ST_MakePoint","ST_MakeLine","ST_MakePolygon","ST_MakeEnvelope","ST_GeomFromText","ST_GeomFromWKB","ST_GeomFromGeoJSON","ST_GeogFromText","ST_SetSRID","ST_Transform","ST_Collect","ST_Union","ST_Buffer","ST_X","ST_Y","ST_Z","ST_M","ST_SRID","ST_GeometryType","ST_Dimension","ST_CoordDim","ST_NPoints","ST_NRings","ST_NumGeometries","ST_NumPoints","ST_ExteriorRing","ST_InteriorRingN","ST_GeometryN","ST_PointN","ST_StartPoint","ST_EndPoint","ST_Centroid","ST_PointOnSurface","ST_Envelope","ST_Boundary","ST_AsText","ST_AsBinary","ST_AsGeoJSON","ST_AsKML","ST_AsSVG","ST_AsGML","ST_AsEWKT","ST_AsEWKB","ST_AsMVT","ST_AsMVTGeom","ST_Intersects","ST_Contains","ST_Within","ST_Overlaps","ST_Touches","ST_Crosses","ST_Disjoint","ST_Equals","ST_Covers","ST_CoveredBy","ST_ContainsProperly","ST_DWithin","ST_Distance","ST_3DDistance","ST_Area","ST_Perimeter","ST_Length","ST_Length2D","ST_3DLength","ST_Distance","ST_MaxDistance","ST_HausdorffDistance","ST_FrechetDistance","ST_Simplify","ST_SimplifyPreserveTopology","ST_SimplifyVW","ST_ChaikinSmoothing","ST_ConvexHull","ST_ConcaveHull","ST_Buffer","ST_OffsetCurve","ST_Difference","ST_Intersection","ST_SymDifference","ST_Split","ST_Subdivide","ST_MakeValid","ST_Snap","ST_SnapToGrid","ST_Segmentize","ST_LineMerge","ST_UnaryUnion","ST_ClusterDBSCAN","ST_ClusterKMeans","ST_ClusterWithin","ST_ClusterIntersecting","ST_Extent","ST_3DExtent","ST_MemUnion","ST_Collect","ST_MakeLine","ST_MakeBox2D","ST_XMin","ST_XMax","ST_YMin","ST_YMax","ST_ZMin","ST_ZMax","ST_Expand","ST_EstimatedExtent","Box2D","Box3D","ST_LineInterpolatePoint","ST_LineInterpolatePoints","ST_LineLocatePoint","ST_LineSubstring","ST_LocateAlong","ST_LocateBetween","ST_AddMeasure","ST_IsValid","ST_IsSimple","ST_IsEmpty","ST_IsClosed","ST_IsRing","ST_IsCollection","ST_HasArc","ST_NumPatches","ST_Force2D","ST_Force3D","ST_ForceRHR","ST_Reverse","ST_FlipCoordinates","ST_OrientedEnvelope"],Oje=["integer","int","int4","bigint","int8","smallint","int2","numeric","decimal","real","float4","double precision","float8","text","varchar","char","character varying","character","boolean","bool","date","time","timestamp","timestamptz","interval","json","jsonb","uuid","bytea","array","point","line","polygon","geometry","geography","box","circle","inet","cidr","macaddr"],w6=({value:t,onChange:e,placeholder:r="Enter SQL query...",height:n="150px",minHeight:i,maxHeight:s,schemas:a=[],serviceName:o,readOnly:d=!1,className:m=""})=>{const[y,v]=I.useState(a);I.useEffect(()=>{a.length>0&&v(a)},[a]),I.useEffect(()=>{o&&a.length===0&&y.length===0&&w(o)},[o,a.length,y.length]);const w=async R=>{try{const F=await fetch(`/api/pg/services/${R}/schemas`);if(F.ok){const D=await F.json();D.schemas&&v(D.schemas)}}catch(F){console.error("Failed to load schema info:",F)}},O=I.useMemo(()=>R=>{const F=R.matchBefore(/[\w.]+/);if(!F||F.from===F.to&&!R.explicit)return null;const D=F.text.toLowerCase(),U=[],X=D.lastIndexOf(".");if(X>=0){const K=D.substring(0,X),Y=D.substring(X+1);for(const ne of y){if(ne.name.toLowerCase()===K)for(const oe of ne.tables)oe.name.toLowerCase().startsWith(Y)&&U.push({label:oe.name,type:"class",detail:`table in ${ne.name}`,boost:10});for(const oe of ne.tables){const ce=`${ne.name}.${oe.name}`.toLowerCase(),Xe=oe.name.toLowerCase();if(K===ce||K===Xe)for(const Ae of oe.columns)Ae.name.toLowerCase().startsWith(Y)&&U.push({label:Ae.name,type:"property",detail:Ae.type,boost:15})}}}else{for(const K of kje)K.toLowerCase().startsWith(D)&&U.push({label:K,type:"keyword",boost:5});for(const K of Cje)K.toLowerCase().startsWith(D)&&U.push({label:K+"()",type:"function",detail:"PostgreSQL",boost:3});for(const K of Tje)K.toLowerCase().startsWith(D)&&U.push({label:K+"()",type:"function",detail:"PostGIS",boost:4});for(const K of Oje)K.toLowerCase().startsWith(D)&&U.push({label:K,type:"type",boost:1});for(const K of y){K.name.toLowerCase().startsWith(D)&&U.push({label:K.name,type:"namespace",detail:"schema",boost:6});for(const Y of K.tables){Y.name.toLowerCase().startsWith(D)&&U.push({label:Y.name,type:"class",detail:`table in ${K.name}`,boost:8});const ne=`${K.name}.${Y.name}`;ne.toLowerCase().startsWith(D)&&U.push({label:ne,type:"class",detail:"table",boost:7})}}}U.sort((K,Y)=>(Y.boost||0)-(K.boost||0));const ee=U.slice(0,50);return ee.length===0?null:{from:F.from,options:ee,validFor:/^[\w.]*$/}},[y]),P=I.useMemo(()=>{const R={};for(const F of y)for(const D of F.tables){const U=`${F.name}.${D.name}`;R[U]=D.columns.map(X=>X.name),R[D.name]=D.columns.map(X=>X.name)}return wje({dialect:Sje,schema:R,upperCaseKeywords:!0})},[y]),E=I.useMemo(()=>Zt.theme({"&":{fontSize:"14px",fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'},".cm-content":{padding:"8px 0"},".cm-line":{padding:"0 8px"},".cm-gutters":{backgroundColor:"#f7f7f7",borderRight:"1px solid #e0e0e0"},"&.cm-focused .cm-cursor":{borderLeftColor:"#3b82f6"},".cm-placeholder":{color:"#9ca3af"},".cm-tooltip.cm-tooltip-autocomplete":{backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"6px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},".cm-tooltip.cm-tooltip-autocomplete > ul":{fontFamily:"inherit"},".cm-tooltip.cm-tooltip-autocomplete > ul > li":{padding:"4px 8px"},".cm-tooltip.cm-tooltip-autocomplete > ul > li[aria-selected]":{backgroundColor:"#3b82f6",color:"#fff"},".cm-completionIcon":{width:"1em",marginRight:"0.5em"},".cm-completionIcon-keyword":{"&::after":{content:'"K"',color:"#9333ea"}},".cm-completionIcon-function":{"&::after":{content:'""',color:"#2563eb"}},".cm-completionIcon-class":{"&::after":{content:'"T"',color:"#059669"}},".cm-completionIcon-property":{"&::after":{content:'"c"',color:"#d97706"}},".cm-completionIcon-namespace":{"&::after":{content:'"S"',color:"#dc2626"}},".cm-completionIcon-type":{"&::after":{content:'"t"',color:"#6366f1"}}}),[]),$=I.useMemo(()=>[P,vH({override:[O],activateOnTyping:!0,maxRenderedOptions:50}),Zt.lineWrapping,E],[P,O,E]);return u.jsx("div",{className:`sql-editor-wrapper border rounded ${m}`,children:u.jsx(bI,{value:t,onChange:e,placeholder:r,height:n,minHeight:i,maxHeight:s,extensions:$,readOnly:d,basicSetup:{lineNumbers:!0,highlightActiveLineGutter:!0,highlightSpecialChars:!0,history:!0,foldGutter:!1,drawSelection:!0,dropCursor:!0,allowMultipleSelections:!0,indentOnInput:!0,syntaxHighlighting:!0,bracketMatching:!0,closeBrackets:!0,autocompletion:!1,rectangularSelection:!0,crosshairCursor:!1,highlightActiveLine:!0,highlightSelectionMatches:!0,closeBracketsKeymap:!0,defaultKeymap:!0,searchKeymap:!0,historyKeymap:!0,foldKeymap:!1,completionKeymap:!0,lintKeymap:!0}})})},Sg=Ln(ue),jje=[{value:"=",label:"equals"},{value:"!=",label:"not equals"},{value:"<",label:"less than"},{value:"<=",label:"less or equal"},{value:">",label:"greater than"},{value:">=",label:"greater or equal"},{value:"LIKE",label:"contains"},{value:"ILIKE",label:"contains (case insensitive)"},{value:"IS NULL",label:"is null"},{value:"IS NOT NULL",label:"is not null"},{value:"IN",label:"in list"}],Pje=[{value:"",label:"None"},{value:"COUNT",label:"Count"},{value:"SUM",label:"Sum"},{value:"AVG",label:"Average"},{value:"MIN",label:"Min"},{value:"MAX",label:"Max"},{value:"ST_Extent",label:"Extent (geo)"},{value:"ST_Union",label:"Union (geo)"}],Aje=["Show me all records from the last 30 days","Find the top 10 largest by area","Count records grouped by type",'Show records where name contains "park"',"Find all polygons that intersect with each other"],Eje=({serviceName:t,initialSchema:e="public",initialTable:r="",initialSQL:n="",onClose:i,onPublishToGeoServer:s})=>{const a=Yo(),o=Bt("white","gray.800"),d=Bt("gray.200","gray.600"),m=Bt("gray.50","gray.700"),y=Bt("gray.50","gray.900"),v=Bt("blue.50","blue.900"),[w,O]=I.useState("visual"),[P,E]=I.useState([]),[,$]=I.useState(!0),[R,F]=I.useState(e),[D,U]=I.useState(r),[X,ee]=I.useState([]),[K,Y]=I.useState([]),[ne,oe]=I.useState([]),[ce,Xe]=I.useState(100),[Ae,We]=I.useState(0),[Ye,tt]=I.useState(!1),[Be,Me]=I.useState(n),[Ge,De]=I.useState(""),[Le,Oe]=I.useState(""),[Ie,st]=I.useState(!1),[Re,it]=I.useState(null),[Ke,St]=I.useState(!0),[Mt,Et]=I.useState(!1),[xt,et]=I.useState(null),[Yt,_t]=I.useState(""),[rt,Te]=I.useState(!1),ct=I.useRef(null),[Vt,wt]=I.useState(()=>{const W=localStorage.getItem("query-panel-split");return W?parseInt(W,10):50}),[Ft,Kr]=I.useState(!1),yn=I.useRef(null),an=I.useRef(Vt),Cn=I.useMemo(()=>P.find(W=>W.name===R),[P,R]),xn=I.useMemo(()=>Cn==null?void 0:Cn.tables.find(W=>W.name===D),[Cn,D]),di=I.useMemo(()=>(xn==null?void 0:xn.columns)||[],[xn]);I.useEffect(()=>{$(!0),fetch(`/api/pg/services/${encodeURIComponent(t)}/schemas`).then(W=>W.json()).then(W=>{W.schemas&&(E(W.schemas),W.schemas.length>0&&!R&&F(W.schemas[0].name))}).catch(W=>{console.error("Failed to load schemas:",W),_t("Failed to load database schemas")}).finally(()=>$(!1))},[t]),I.useEffect(()=>{fetch("/api/ai/providers").then(W=>W.json()).then(W=>{var te;const Q=(te=W.providers)==null?void 0:te.find(de=>de.active);St((Q==null?void 0:Q.available)??!1)}).catch(()=>St(!1))},[]),I.useEffect(()=>{if(w==="visual")if(D){const W=Pi();De(W)}else De("")},[w,R,D,X,K,ne,ce,Ye]);const Pi=I.useCallback(()=>{if(!D)return"";const W=X.length>0?X.map(be=>be.aggregate?`${be.aggregate}(${be.name})${be.alias?` AS ${be.alias}`:""}`:be.alias?`${be.name} AS ${be.alias}`:be.name).join(", "):"*";let Q=`SELECT ${Ye?"DISTINCT ":""}${W}
FROM ${R}.${D}`;if(K.length>0){const be=K.map((ke,$e)=>{let _e="";return $e>0&&(_e+=` ${ke.logic} `),["IS NULL","IS NOT NULL"].includes(ke.operator)?_e+=`${ke.column} ${ke.operator}`:ke.operator==="IN"?_e+=`${ke.column} IN (${ke.value})`:["LIKE","ILIKE"].includes(ke.operator)?_e+=`${ke.column} ${ke.operator} '%${ke.value}%'`:_e+=`${ke.column} ${ke.operator} '${ke.value}'`,_e}).join("");Q+=`
WHERE ${be}`}const te=X.some(be=>be.aggregate),de=X.filter(be=>!be.aggregate);return te&&de.length>0&&(Q+=`
GROUP BY ${de.map(be=>be.name).join(", ")}`),ne.length>0&&(Q+=`
ORDER BY ${ne.map(be=>`${be.column} ${be.direction}`).join(", ")}`),Q+=`
LIMIT ${ce}`,Ae>0&&(Q+=` OFFSET ${Ae}`),Q},[R,D,X,K,ne,ce,Ae,Ye]),He=I.useCallback(async(W,Q=!1)=>{var te,de;if(!W.trim()){_t("Please enter a query");return}Q?Te(!0):(Et(!0),_t(""),et(null),We(0));try{const ke=await(await fetch("/api/query/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sql:W,service_name:t,max_rows:ce,offset:Q&&(xt==null?void 0:xt.rows.length)||0})})).json();if(ke.success){const $e=((te=ke.result)==null?void 0:te.rows)||[],_e=((de=ke.result)==null?void 0:de.columns)||[];et(Q&&xt?{...ke.result,columns:_e,rows:[...xt.rows||[],...$e],has_more:$e.length===ce}:{...ke.result,columns:_e,rows:$e,has_more:$e.length===ce}),De(ke.sql||W)}else _t(ke.error||"Query execution failed")}catch(be){_t("Failed to execute query: "+be.message)}finally{Et(!1),Te(!1)}},[t,ce,xt]),Vr=I.useCallback(async()=>{if(!(!Le.trim()||Ie)){st(!0),it(null),_t("");try{const Q=await(await fetch("/api/ai/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:Le.trim(),service_name:t,schema_name:R,max_rows:ce,execute:!1})})).json();Q.success&&Q.sql?(it({sql:Q.sql,explanation:Q.explanation,confidence:Q.confidence,warnings:Q.warnings}),Me(Q.sql)):_t(Q.error||"AI query generation failed")}catch(W){_t("AI query failed: "+W.message)}finally{st(!1)}}},[Le,Ie,t,R,ce]),Ct=I.useCallback(()=>{let W="";switch(w){case"ai":W=(Re==null?void 0:Re.sql)||Be;break;case"visual":W=Ge;break;case"sql":W=Be;break}He(W)},[w,Re,Ge,Be,He]),Ut=I.useCallback(()=>{if(!(xt!=null&&xt.has_more)||rt)return;let W="";switch(w){case"ai":W=(Re==null?void 0:Re.sql)||Be;break;case"visual":W=Ge;break;case"sql":W=Be;break}const Q=xt.rows.length,te=W.replace(/LIMIT \d+(\s+OFFSET \d+)?/i,`LIMIT ${ce} OFFSET ${Q}`);He(te.includes("OFFSET")?te:`${W} OFFSET ${Q}`,!0)},[xt,rt,w,Re,Ge,Be,ce,He]);I.useEffect(()=>{const W=ct.current;if(!W)return;const Q=()=>{const{scrollTop:te,scrollHeight:de,clientHeight:be}=W;de-te-be<100&&(xt!=null&&xt.has_more)&&!rt&&Ut()};return W.addEventListener("scroll",Q),()=>W.removeEventListener("scroll",Q)},[xt,rt,Ut]);const wn=I.useCallback(W=>{W.preventDefault(),Kr(!0)},[]);I.useEffect(()=>{an.current=Vt},[Vt]),I.useEffect(()=>{if(!Ft)return;const W=te=>{if(!yn.current)return;const de=yn.current.getBoundingClientRect(),be=(te.clientX-de.left)/de.width*100,ke=Math.max(25,Math.min(75,be));wt(ke)},Q=()=>{Kr(!1),localStorage.setItem("query-panel-split",an.current.toString())};return document.addEventListener("mousemove",W),document.addEventListener("mouseup",Q),()=>{document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",Q)}},[Ft]);const vt=()=>ee([...X,{name:""}]),vr=W=>ee(X.filter((Q,te)=>te!==W)),tr=(W,Q)=>{const te=[...X];te[W]={...te[W],...Q},ee(te)},Zn=()=>Y([...K,{column:"",operator:"=",value:"",logic:"AND"}]),_i=W=>Y(K.filter((Q,te)=>te!==W)),pr=(W,Q)=>{const te=[...K];te[W]={...te[W],...Q},Y(te)},Di=()=>oe([...ne,{column:"",direction:"ASC"}]),ks=W=>oe(ne.filter((Q,te)=>te!==W)),Li=(W,Q)=>{const te=[...ne];te[W]={...te[W],...Q},oe(te)},cs=()=>{const W=w==="visual"?Ge:Be;navigator.clipboard.writeText(W),a({title:"Copied",description:"SQL copied to clipboard",status:"success",duration:2e3})},ge=W=>{if(!xt)return;let Q="",te="",de="";if(W==="csv"){const _e=xt.columns.map(dt=>dt.name).join(","),nt=xt.rows.map(dt=>xt.columns.map(ve=>{const ut=dt[ve.name];return ut===null?"":typeof ut=="string"&&ut.includes(",")?`"${ut}"`:String(ut)}).join(",")).join(`
`);Q=`${_e}
${nt}`,te="query-results.csv",de="text/csv"}else Q=JSON.stringify(xt.rows,null,2),te="query-results.json",de="application/json";const be=new Blob([Q],{type:de}),ke=URL.createObjectURL(be),$e=document.createElement("a");$e.href=ke,$e.download=te,$e.click(),URL.revokeObjectURL(ke)};return u.jsxs(Sg,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:cu.default,bg:o,borderRadius:"2xl",boxShadow:"2xl",overflow:"hidden",h:"100%",display:"flex",flexDirection:"column",children:[u.jsxs(yr,{bg:"linear-gradient(135deg, #3182CE 0%, #2B6CB0 100%)",px:6,py:4,align:"center",justify:"space-between",children:[u.jsxs(fe,{spacing:3,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:2,borderRadius:"lg",children:u.jsx(ze,{as:Wn,boxSize:5,color:"white"})}),u.jsxs(ue,{children:[u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:"Query Designer"}),u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:t})]})]}),u.jsxs(fe,{spacing:2,children:[u.jsxs(Qt,{colorScheme:"whiteAlpha",variant:"subtle",px:3,py:1,borderRadius:"full",children:[P.length," schemas"]}),i&&u.jsx(gr,{"aria-label":"Close",icon:u.jsx(hf,{}),variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:i})]})]}),u.jsx(w0,{index:w==="ai"?0:w==="visual"?1:2,onChange:W=>O(W===0?"ai":W===1?"visual":"sql"),variant:"soft-rounded",colorScheme:"blue",px:4,py:3,bg:m,children:u.jsxs(S0,{children:[u.jsxs(to,{gap:2,children:[u.jsx(ze,{as:uve}),"AI Natural Language"]}),u.jsxs(to,{gap:2,children:[u.jsx(ze,{as:uf}),"Visual Builder"]}),u.jsxs(to,{gap:2,children:[u.jsx(ze,{as:Ml}),"SQL Editor"]})]})}),u.jsxs(yr,{ref:yn,flex:1,overflow:"hidden",position:"relative",children:[u.jsxs(yr,{w:`${Vt}%`,flexDirection:"column",overflow:"hidden",children:[u.jsx(ue,{flex:1,overflow:"auto",p:4,children:u.jsxs(vc,{mode:"wait",children:[w==="ai"&&u.jsx(Sg,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:cu.snappy,children:u.jsxs(lt,{spacing:4,align:"stretch",children:[!Ke&&u.jsxs(io,{status:"warning",borderRadius:"lg",children:[u.jsx(so,{}),u.jsxs(ue,{children:[u.jsx(_1,{children:"Ollama not available"}),u.jsxs(Ky,{fontSize:"sm",children:["Start Ollama with: ",u.jsx("code",{children:"ollama serve"})]})]})]}),u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"600",mb:2,fontSize:"sm",color:"gray.600",children:"Ask a question about your data"}),u.jsx(lC,{value:Le,onChange:W=>Oe(W.target.value),placeholder:"e.g., Show me all records where status is active...",rows:4,borderRadius:"xl",_focus:{borderColor:"purple.400",boxShadow:"0 0 0 3px rgba(159, 122, 234, 0.2)"},onKeyDown:W=>{W.key==="Enter"&&!W.shiftKey&&(W.preventDefault(),Vr())}})]}),u.jsxs(fe,{children:[u.jsx(zn,{value:R,onChange:W=>F(W.target.value),size:"sm",borderRadius:"lg",flex:1,children:P.map(W=>u.jsx("option",{value:W.name,children:W.name},W.name))}),u.jsx(gt,{colorScheme:"purple",leftIcon:Ie?u.jsx(kn,{size:"sm"}):u.jsx(vu,{}),onClick:Vr,isDisabled:!Le.trim()||Ie||!Ke,borderRadius:"xl",children:"Generate SQL"})]}),u.jsxs(ue,{children:[u.jsxs(fe,{mb:2,children:[u.jsx(ze,{as:J7,color:"gray.400"}),u.jsx(J,{fontSize:"xs",color:"gray.500",children:"Examples"})]}),u.jsx(n0,{spacing:2,children:Aje.map((W,Q)=>u.jsx(um,{children:u.jsx(cm,{size:"sm",variant:"subtle",colorScheme:"purple",cursor:"pointer",onClick:()=>Oe(W),_hover:{bg:"purple.100"},borderRadius:"full",children:u.jsx(zb,{children:W})})},Q))})]}),Re&&u.jsxs(Sg,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},bg:"purple.50",p:4,borderRadius:"xl",borderLeft:"4px solid",borderLeftColor:"purple.400",children:[Re.confidence!==void 0&&u.jsx(fe,{mb:2,children:u.jsxs(Qt,{colorScheme:Re.confidence>=.8?"green":Re.confidence>=.5?"yellow":"red",children:[Math.round(Re.confidence*100),"% confidence"]})}),Re.explanation&&u.jsx(J,{fontSize:"sm",color:"purple.700",mb:2,children:Re.explanation}),Re.warnings&&Re.warnings.length>0&&u.jsxs(io,{status:"warning",size:"sm",borderRadius:"md",mb:2,children:[u.jsx(so,{}),u.jsx(lt,{align:"start",spacing:0,children:Re.warnings.map((W,Q)=>u.jsx(J,{fontSize:"xs",children:W},Q))})]})]}),((Re==null?void 0:Re.sql)||Be)&&w==="ai"&&u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"600",mb:2,fontSize:"sm",color:"gray.600",children:"Generated SQL"}),u.jsx(w6,{value:(Re==null?void 0:Re.sql)||Be,onChange:Me,height:"150px",serviceName:t,schemas:P})]})]})},"ai"),w==="visual"&&u.jsx(Sg,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:cu.snappy,children:u.jsxs(lt,{spacing:4,align:"stretch",children:[u.jsxs(fe,{children:[u.jsxs(ue,{flex:1,children:[u.jsx(J,{fontSize:"xs",fontWeight:"600",color:"gray.500",mb:1,children:"Schema"}),u.jsx(zn,{value:R,onChange:W=>{F(W.target.value),U(""),ee([])},size:"sm",borderRadius:"lg",children:P.map(W=>u.jsx("option",{value:W.name,children:W.name},W.name))})]}),u.jsxs(ue,{flex:2,children:[u.jsx(J,{fontSize:"xs",fontWeight:"600",color:"gray.500",mb:1,children:"Table"}),u.jsx(zn,{value:D,onChange:W=>{U(W.target.value),ee([])},size:"sm",borderRadius:"lg",placeholder:"Select table...",children:Cn==null?void 0:Cn.tables.map(W=>u.jsxs("option",{value:W.name,children:[W.name," ",W.has_geometry&&"(geo)"]},W.name))})]})]}),xn&&u.jsxs(ue,{bg:y,p:3,borderRadius:"lg",maxH:"120px",overflowY:"auto",children:[u.jsxs(fe,{mb:2,children:[u.jsx(ze,{as:K7,color:"gray.500",size:"sm"}),u.jsxs(J,{fontSize:"xs",fontWeight:"600",color:"gray.500",children:["Available Columns (",di.length,")"]})]}),u.jsx(n0,{spacing:1,children:di.map(W=>u.jsx(um,{children:u.jsxs(cm,{size:"sm",variant:"subtle",colorScheme:"gray",cursor:"pointer",onClick:()=>{X.find(Q=>Q.name===W.name)||ee([...X,{name:W.name}])},children:[u.jsx(zb,{children:W.name}),u.jsx(J,{fontSize:"2xs",color:"gray.400",ml:1,children:W.type})]})},W.name))})]}),u.jsxs(ue,{children:[u.jsxs(yr,{justify:"space-between",align:"center",mb:2,children:[u.jsxs(fe,{children:[u.jsx(ze,{as:Vo,color:"blue.500"}),u.jsx(J,{fontSize:"sm",fontWeight:"600",children:"SELECT Columns"})]}),u.jsx(gt,{size:"xs",leftIcon:u.jsx(vs,{}),onClick:vt,variant:"ghost",colorScheme:"blue",children:"Add"})]}),X.length===0?u.jsx(J,{fontSize:"sm",color:"gray.500",fontStyle:"italic",children:"All columns (*)"}):u.jsx(lt,{spacing:2,align:"stretch",children:X.map((W,Q)=>u.jsxs(fe,{children:[u.jsxs(zn,{value:W.name,onChange:te=>tr(Q,{name:te.target.value}),size:"sm",flex:2,borderRadius:"lg",children:[u.jsx("option",{value:"",children:"Select..."}),di.map(te=>u.jsx("option",{value:te.name,children:te.name},te.name))]}),u.jsx(zn,{value:W.aggregate||"",onChange:te=>tr(Q,{aggregate:te.target.value}),size:"sm",flex:1,borderRadius:"lg",children:Pje.map(te=>u.jsx("option",{value:te.value,children:te.label},te.value))}),u.jsx(Ar,{value:W.alias||"",onChange:te=>tr(Q,{alias:te.target.value}),placeholder:"alias",size:"sm",flex:1,borderRadius:"lg"}),u.jsx(gr,{"aria-label":"Remove",icon:u.jsx(Xd,{}),size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>vr(Q)})]},Q))})]}),u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsxs(yr,{justify:"space-between",align:"center",mb:2,children:[u.jsxs(fe,{children:[u.jsx(ze,{as:fve,color:"orange.500"}),u.jsx(J,{fontSize:"sm",fontWeight:"600",children:"WHERE Conditions"})]}),u.jsx(gt,{size:"xs",leftIcon:u.jsx(vs,{}),onClick:Zn,variant:"ghost",colorScheme:"orange",children:"Add"})]}),K.length===0?u.jsx(J,{fontSize:"sm",color:"gray.500",fontStyle:"italic",children:"No conditions"}):u.jsx(lt,{spacing:2,align:"stretch",children:K.map((W,Q)=>u.jsxs(fe,{flexWrap:"wrap",children:[Q>0&&u.jsxs(zn,{value:W.logic,onChange:te=>pr(Q,{logic:te.target.value}),size:"sm",w:"80px",borderRadius:"lg",children:[u.jsx("option",{value:"AND",children:"AND"}),u.jsx("option",{value:"OR",children:"OR"})]}),u.jsxs(zn,{value:W.column,onChange:te=>pr(Q,{column:te.target.value}),size:"sm",flex:1,minW:"100px",borderRadius:"lg",children:[u.jsx("option",{value:"",children:"Column..."}),di.map(te=>u.jsx("option",{value:te.name,children:te.name},te.name))]}),u.jsx(zn,{value:W.operator,onChange:te=>pr(Q,{operator:te.target.value}),size:"sm",w:"150px",borderRadius:"lg",children:jje.map(te=>u.jsx("option",{value:te.value,children:te.label},te.value))}),!["IS NULL","IS NOT NULL"].includes(W.operator)&&u.jsx(Ar,{value:W.value,onChange:te=>pr(Q,{value:te.target.value}),placeholder:"value",size:"sm",flex:1,minW:"80px",borderRadius:"lg"}),u.jsx(gr,{"aria-label":"Remove",icon:u.jsx(Xd,{}),size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>_i(Q)})]},Q))})]}),u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsxs(yr,{justify:"space-between",align:"center",mb:2,children:[u.jsxs(fe,{children:[u.jsx(ze,{as:ive,color:"green.500"}),u.jsx(J,{fontSize:"sm",fontWeight:"600",children:"ORDER BY"})]}),u.jsx(gt,{size:"xs",leftIcon:u.jsx(vs,{}),onClick:Di,variant:"ghost",colorScheme:"green",children:"Add"})]}),ne.length===0?u.jsx(J,{fontSize:"sm",color:"gray.500",fontStyle:"italic",children:"No sorting"}):u.jsx(lt,{spacing:2,align:"stretch",children:ne.map((W,Q)=>u.jsxs(fe,{children:[u.jsxs(zn,{value:W.column,onChange:te=>Li(Q,{column:te.target.value}),size:"sm",flex:2,borderRadius:"lg",children:[u.jsx("option",{value:"",children:"Column..."}),di.map(te=>u.jsx("option",{value:te.name,children:te.name},te.name))]}),u.jsxs(zn,{value:W.direction,onChange:te=>Li(Q,{direction:te.target.value}),size:"sm",w:"100px",borderRadius:"lg",children:[u.jsx("option",{value:"ASC",children:"ASC"}),u.jsx("option",{value:"DESC",children:"DESC"})]}),u.jsx(gr,{"aria-label":"Remove",icon:u.jsx(Xd,{}),size:"sm",variant:"ghost",colorScheme:"red",onClick:()=>ks(Q)})]},Q))})]}),u.jsx(Nr,{}),u.jsxs(fe,{spacing:4,children:[u.jsx(Ga,{isChecked:Ye,onChange:W=>tt(W.target.checked),size:"sm",children:"DISTINCT"}),u.jsxs(fe,{children:[u.jsx(J,{fontSize:"sm",children:"LIMIT:"}),u.jsx(Ar,{type:"number",value:ce,onChange:W=>Xe(parseInt(W.target.value)||100),size:"sm",w:"80px",borderRadius:"lg",min:1,max:1e4})]})]}),Ge&&u.jsxs(ue,{children:[u.jsxs(fe,{justify:"space-between",mb:2,children:[u.jsx(J,{fontSize:"sm",fontWeight:"600",color:"gray.600",children:"Generated SQL"}),u.jsx(gr,{"aria-label":"Copy",icon:u.jsx(iF,{}),size:"xs",variant:"ghost",onClick:cs})]}),u.jsx(ue,{bg:"gray.900",color:"gray.100",p:3,borderRadius:"lg",fontSize:"xs",fontFamily:"mono",whiteSpace:"pre-wrap",maxH:"150px",overflow:"auto",children:Ge})]})]})},"visual"),w==="sql"&&u.jsx(Sg,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:cu.snappy,h:"100%",children:u.jsxs(lt,{spacing:4,align:"stretch",h:"100%",children:[u.jsxs(fe,{justify:"space-between",children:[u.jsx(J,{fontWeight:"600",fontSize:"sm",color:"gray.600",children:"Write your SQL query"}),u.jsx(fe,{children:u.jsx(gr,{"aria-label":"Copy",icon:u.jsx(iF,{}),size:"sm",variant:"ghost",onClick:cs})})]}),u.jsx(ue,{flex:1,minH:"300px",children:u.jsx(w6,{value:Be,onChange:Me,height:"100%",serviceName:t,schemas:P,placeholder:"SELECT * FROM schema.table WHERE ..."})})]})},"sql")]})}),u.jsxs(yr,{p:4,gap:2,borderTop:"1px solid",borderColor:d,bg:o,flexShrink:0,children:[u.jsx(gt,{colorScheme:"blue",leftIcon:Mt?u.jsx(kn,{size:"sm"}):u.jsx(EM,{}),onClick:Ct,isDisabled:Mt,flex:1,borderRadius:"xl",size:"lg",children:Mt?"Executing...":"Execute Query"}),s&&xt&&u.jsx(wr,{label:"Publish as SQL View Layer to GeoServer",children:u.jsx(gt,{colorScheme:"green",leftIcon:u.jsx(Hl,{}),onClick:()=>{s(w==="visual"?Ge:Be,"sql_view_"+Date.now())},borderRadius:"xl",size:"lg",children:"Publish"})})]})]}),u.jsx(ue,{w:"4px",cursor:"col-resize",bg:Ft?"blue.400":d,_hover:{bg:"blue.400"},transition:"background 0.2s",onMouseDown:wn,flexShrink:0}),u.jsxs(ue,{w:`calc(${100-Vt}% - 4px)`,display:"flex",flexDirection:"column",overflow:"hidden",children:[u.jsxs(yr,{px:4,py:3,bg:m,borderBottom:"1px solid",borderColor:d,align:"center",justify:"space-between",children:[u.jsxs(fe,{children:[u.jsx(ze,{as:Vo,color:"blue.500"}),u.jsx(J,{fontWeight:"600",children:"Results"}),xt&&u.jsxs(Qt,{colorScheme:"blue",borderRadius:"full",children:[xt.rows.length,xt.total_count?` / ${xt.total_count}`:""," rows"]}),xt&&u.jsxs(Qt,{colorScheme:"gray",borderRadius:"full",children:[xt.duration_ms.toFixed(2),"ms"]})]}),xt&&u.jsxs(sf,{children:[u.jsx(of,{as:gt,size:"sm",variant:"ghost",rightIcon:u.jsx(Ul,{}),children:u.jsx(ze,{as:gy})}),u.jsxs(af,{children:[u.jsx(xa,{icon:u.jsx(gy,{}),onClick:()=>ge("csv"),children:"Export as CSV"}),u.jsx(xa,{icon:u.jsx(gy,{}),onClick:()=>ge("json"),children:"Export as JSON"})]})]})]}),Yt&&u.jsxs(io,{status:"error",borderRadius:"none",children:[u.jsx(so,{}),u.jsx(Ky,{fontSize:"sm",children:Yt})]}),u.jsx(ue,{ref:ct,flex:1,overflow:"auto",position:"relative",children:Mt&&!xt?u.jsx(yr,{h:"100%",align:"center",justify:"center",children:u.jsxs(lt,{spacing:4,children:[u.jsx(kn,{size:"xl",color:"blue.500",thickness:"4px"}),u.jsx(J,{color:"gray.500",children:"Executing query..."})]})}):xt?u.jsxs(u.Fragment,{children:[u.jsxs(sC,{size:"sm",variant:"simple",children:[u.jsx(SM,{position:"sticky",top:0,bg:m,zIndex:1,children:u.jsxs(r0,{children:[u.jsx(Dd,{w:"50px",textAlign:"center",borderBottomWidth:"2px",borderBottomColor:d,children:"#"}),xt.columns.map((W,Q)=>u.jsx(Dd,{borderBottomWidth:"2px",borderBottomColor:d,whiteSpace:"nowrap",children:u.jsxs(lt,{align:"start",spacing:0,children:[u.jsx(J,{children:W.name}),u.jsx(J,{fontSize:"2xs",color:"gray.400",fontWeight:"normal",children:W.type})]})},Q))]})}),u.jsx(wM,{children:u.jsx(vc,{children:xt.rows.map((W,Q)=>u.jsxs(Sg,{as:r0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:Q*.01},_hover:{bg:v},children:[u.jsx(Rd,{textAlign:"center",color:"gray.400",fontSize:"xs",fontFamily:"mono",children:Q+1}),xt.columns.map((te,de)=>{const be=W[te.name],ke=be===null,$e=ke?"NULL":typeof be=="object"?JSON.stringify(be):String(be);return u.jsx(Rd,{maxW:"300px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:ke?"gray.400":void 0,fontStyle:ke?"italic":void 0,fontSize:"sm",title:$e,children:$e.length>100?$e.substring(0,100)+"...":$e},de)})]},Q))})})]}),rt&&u.jsx(yr,{py:4,justify:"center",children:u.jsxs(fe,{children:[u.jsx(kn,{size:"sm"}),u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Loading more..."})]})}),!xt.has_more&&xt.rows.length>0&&u.jsx(yr,{py:4,justify:"center",children:u.jsxs(J,{fontSize:"sm",color:"gray.400",children:["End of results (",xt.rows.length," rows)"]})})]}):u.jsx(yr,{h:"100%",align:"center",justify:"center",children:u.jsxs(lt,{spacing:4,color:"gray.400",children:[u.jsx(ze,{as:Ib,boxSize:12}),u.jsx(J,{children:"Execute a query to see results"})]})})})]})]})]})};function zje(){const t=bt(s=>s.activeDialog),e=bt(s=>s.dialogData),r=bt(s=>s.closeDialog),n=t==="query",i=e==null?void 0:e.data;return i!=null&&i.serviceName?u.jsxs(ss,{isOpen:n,onClose:r,size:"full",motionPreset:"slideInBottom",children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsx(os,{m:4,borderRadius:"2xl",overflow:"hidden",h:"calc(100vh - 32px)",maxH:"calc(100vh - 32px)",children:u.jsx(Eje,{serviceName:i.serviceName,initialSchema:i.schemaName,initialTable:i.tableName,initialSQL:i.initialSQL,onClose:r})})]}):null}function Mje(){const t=bt(i=>i.activeDialog),e=bt(i=>i.dialogData),r=bt(i=>i.closeDialog),n=t==="dataviewer";return n?u.jsxs(ss,{isOpen:n,onClose:r,size:"6xl",scrollBehavior:"inside",children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsx(os,{maxH:"85vh",borderRadius:"xl",overflow:"hidden",children:u.jsx(Ije,{dialogData:e,onClose:r})})]}):null}function Ije({dialogData:t,onClose:e}){var ce,Xe,Ae,We;const[r,n]=I.useState(null),[i,s]=I.useState(!0),[a,o]=I.useState(null),[d,m]=I.useState(0),[y,v]=I.useState(100),[w,O]=I.useState(null),P=Bt("white","gray.800"),E=Bt("gray.50","gray.700"),$=Bt("gray.200","gray.600"),R=Bt("gray.50","gray.700"),F=((ce=t==null?void 0:t.data)==null?void 0:ce.serviceName)??"",D=((Xe=t==null?void 0:t.data)==null?void 0:Xe.schemaName)??"",U=((Ae=t==null?void 0:t.data)==null?void 0:Ae.tableName)??"",X=((We=t==null?void 0:t.data)==null?void 0:We.isView)??!1,ee=async()=>{if(!F||!D||!U){o("Missing table information"),s(!1);return}s(!0),o(null);try{const Ye=await Ybe(F,D,U,y,d*y);if(n(Ye),w===null)try{const tt=await wU(F,`SELECT COUNT(*) as count FROM "${D}"."${U}"`,1);tt.result.rows.length>0&&O(Number(tt.result.rows[0][0]))}catch{}}catch(Ye){o(Ye.message)}finally{s(!1)}};I.useEffect(()=>{ee()},[F,D,U,d,y]);const K=()=>{O(null),ee()},Y=()=>{if(!(r!=null&&r.result))return;const Ye=r.result.columns.join(","),tt=r.result.rows.map(Le=>Le.map(Oe=>{if(Oe===null)return"";const Ie=String(Oe);return Ie.includes(",")||Ie.includes('"')||Ie.includes(`
`)?`"${Ie.replace(/"/g,'""')}"`:Ie}).join(",")),Be=[Ye,...tt].join(`
`),Me=new Blob([Be],{type:"text/csv"}),Ge=URL.createObjectURL(Me),De=document.createElement("a");De.href=Ge,De.download=`${D}.${U}.csv`,De.click(),URL.revokeObjectURL(Ge)},ne=w!==null?Math.ceil(w/y):null,oe={start:d*y+1,end:Math.min((d+1)*y,w??(d+1)*y)};return u.jsxs(u.Fragment,{children:[u.jsx(ue,{bg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",px:6,py:4,children:u.jsxs(yr,{justify:"space-between",align:"center",children:[u.jsxs(ue,{children:[u.jsxs(fe,{spacing:2,mb:1,children:[u.jsx(Qt,{bg:"whiteAlpha.200",color:"white",fontSize:"xs",children:X?"VIEW":"TABLE"}),u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:U})]}),u.jsxs(fe,{spacing:2,children:[u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:F}),u.jsx(J,{color:"whiteAlpha.600",fontSize:"sm",children:"/"}),u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:D})]})]}),u.jsxs(fe,{spacing:2,children:[u.jsx(wr,{label:"Refresh",children:u.jsx(gr,{"aria-label":"Refresh",icon:u.jsx(Su,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:K,isLoading:i})}),u.jsx(wr,{label:"Export CSV",children:u.jsx(gr,{"aria-label":"Export CSV",icon:u.jsx(gy,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:Y,isDisabled:!(r!=null&&r.result)})})]})]})}),u.jsx(Ns,{color:"white"}),u.jsxs(ws,{p:0,children:[i&&!r&&u.jsx(yr,{justify:"center",align:"center",py:12,children:u.jsx(kn,{size:"xl",color:"purple.500",thickness:"3px"})}),a&&u.jsxs(io,{status:"error",m:4,borderRadius:"md",children:[u.jsx(so,{}),u.jsxs(ue,{children:[u.jsx(_1,{children:"Query Error"}),u.jsx(Ky,{children:a})]})]}),(r==null?void 0:r.result)&&u.jsx(ue,{overflowX:"auto",maxH:"60vh",children:u.jsxs(sC,{size:"sm",variant:"simple",bg:P,children:[u.jsx(SM,{position:"sticky",top:0,bg:E,zIndex:1,children:u.jsxs(r0,{children:[u.jsx(Dd,{borderColor:$,fontSize:"xs",color:"gray.500",w:"50px",textAlign:"center",children:"#"}),r.result.columns.map((Ye,tt)=>u.jsx(Dd,{borderColor:$,fontSize:"xs",textTransform:"none",letterSpacing:"normal",fontWeight:"600",color:"gray.700",_dark:{color:"gray.200"},children:Ye},tt))]})}),u.jsx(wM,{children:r.result.rows.map((Ye,tt)=>u.jsxs(r0,{_hover:{bg:R},transition:"background 0.1s",children:[u.jsx(Rd,{borderColor:$,fontSize:"xs",color:"gray.400",textAlign:"center",fontFamily:"mono",children:d*y+tt+1}),Ye.map((Be,Me)=>u.jsx(Rd,{borderColor:$,fontSize:"sm",maxW:"300px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",title:Be!==null?String(Be):"",children:Be===null?u.jsx(J,{color:"gray.400",fontStyle:"italic",fontSize:"xs",children:"NULL"}):typeof Be=="object"?u.jsx(J,{color:"blue.500",fontSize:"xs",fontFamily:"mono",children:JSON.stringify(Be)}):String(Be)},Me))]},tt))})]})}),(r==null?void 0:r.result)&&r.result.rows.length===0&&u.jsx(yr,{justify:"center",align:"center",py:12,children:u.jsx(J,{color:"gray.500",children:"No data found in this table"})})]}),u.jsxs(To,{borderTop:"1px solid",borderTopColor:$,bg:E,justifyContent:"space-between",children:[u.jsxs(fe,{spacing:4,children:[u.jsxs(fe,{spacing:2,children:[u.jsx(J,{fontSize:"sm",color:"gray.600",children:"Rows per page:"}),u.jsxs(zn,{size:"sm",w:"80px",value:y,onChange:Ye=>{v(Number(Ye.target.value)),m(0)},children:[u.jsx("option",{value:25,children:"25"}),u.jsx("option",{value:50,children:"50"}),u.jsx("option",{value:100,children:"100"}),u.jsx("option",{value:250,children:"250"}),u.jsx("option",{value:500,children:"500"})]})]}),w!==null&&u.jsxs(J,{fontSize:"sm",color:"gray.600",children:[oe.start,"-",oe.end," of ",w.toLocaleString()," rows"]}),(r==null?void 0:r.result)&&u.jsxs(Qt,{colorScheme:"green",fontSize:"xs",children:[r.result.execution_time_ms,"ms"]})]}),u.jsxs(fe,{spacing:2,children:[u.jsx(gr,{"aria-label":"Previous page",icon:u.jsx(ave,{}),size:"sm",variant:"outline",onClick:()=>m(Ye=>Math.max(0,Ye-1)),isDisabled:d===0||i}),u.jsx(Ar,{size:"sm",w:"60px",textAlign:"center",value:d+1,onChange:Ye=>{const tt=parseInt(Ye.target.value,10)-1;!isNaN(tt)&&tt>=0&&(ne===null||tt<ne)&&m(tt)}}),ne!==null&&u.jsxs(J,{fontSize:"sm",color:"gray.500",children:["of ",ne]}),u.jsx(gr,{"aria-label":"Next page",icon:u.jsx(X7,{}),size:"sm",variant:"outline",onClick:()=>m(Ye=>Ye+1),isDisabled:i||ne!==null&&d>=ne-1||(r==null?void 0:r.result)&&r.result.rows.length<y}),u.jsx(gt,{variant:"ghost",onClick:e,ml:4,children:"Close"})]})]})]})}const S6=lo`
  0% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(2);
    opacity: 0.5;
  }
  100% {
    transform: scale(3);
    opacity: 0;
  }
`;function Do({label:t,value:e,helpText:r,icon:n,colorScheme:i="blue"}){const s=Bt("white","gray.700"),a=Bt("gray.200","gray.600");return u.jsxs(ue,{bg:s,p:4,borderRadius:"xl",borderWidth:1,borderColor:a,shadow:"sm",transition:"all 0.2s",_hover:{shadow:"md",borderColor:`${i}.300`},children:[u.jsxs(fe,{spacing:3,mb:2,children:[u.jsx(ue,{p:2,borderRadius:"lg",bg:`${i}.50`,color:`${i}.500`,children:u.jsx(ze,{as:n,boxSize:5})}),u.jsx(J,{fontSize:"sm",fontWeight:"medium",color:"gray.500",children:t})]}),u.jsx(J,{fontSize:"2xl",fontWeight:"bold",children:e}),r&&u.jsx(J,{fontSize:"xs",color:"gray.400",mt:1,children:r})]})}const Rje=`
  M 115 95 Q 120 80 140 75 Q 160 70 180 78 Q 200 85 210 95 Q 220 105 215 120
  Q 210 135 195 145 Q 180 155 160 160 Q 140 165 125 155 Q 110 145 105 130
  Q 100 115 115 95 Z
  M 125 170 Q 135 165 145 170 Q 155 175 160 190 Q 165 205 158 225
  Q 150 245 140 255 Q 130 265 120 260 Q 110 255 108 240 Q 105 225 110 205
  Q 115 185 125 170 Z
  M 440 70 Q 460 65 480 72 Q 500 80 510 95 Q 520 110 515 125
  Q 510 140 495 145 Q 480 150 460 145 Q 440 140 430 125 Q 420 110 425 90 Q 430 75 440 70 Z
  M 455 155 Q 475 150 495 158 Q 515 165 525 185 Q 535 205 530 230
  Q 525 255 510 270 Q 495 285 475 282 Q 455 280 445 265 Q 435 250 438 225
  Q 440 200 445 180 Q 450 160 455 155 Z
  M 550 60 Q 590 50 640 55 Q 690 60 730 80 Q 770 100 790 130
  Q 810 160 800 195 Q 790 230 760 250 Q 730 270 690 275 Q 650 280 610 270
  Q 570 260 545 235 Q 520 210 520 175 Q 520 140 530 110 Q 540 80 550 60 Z
  M 770 280 Q 790 275 810 285 Q 830 295 835 315 Q 840 335 830 350
  Q 820 365 800 368 Q 780 370 765 360 Q 750 350 752 330 Q 755 310 760 295 Q 765 285 770 280 Z
`;function Dje(t){return!t||t==="localhost"||t==="127.0.0.1"?"Local development server on this machine":t.startsWith("192.168.")||t.startsWith("10.")||t.startsWith("172.")?"Server on local network (private IP address)":t.includes("kartoza.com")?"Kartoza cloud infrastructure, Cape Town, South Africa":t.includes("digitalocean.com")||t.includes(".do.")?"DigitalOcean cloud infrastructure":t.includes("aws.")||t.includes("amazonaws.com")?"Amazon Web Services (AWS) cloud":t.includes("azure.")||t.includes("microsoft.com")?"Microsoft Azure cloud":t.includes("gcp.")||t.includes("google")?"Google Cloud Platform":t.split(".").length>=2?`Remote server at ${t}`:`Server: ${t}`}function Lje(t){return!t||t==="localhost"||t==="127.0.0.1"||t.startsWith("192.168.")||t.startsWith("10.")||t.startsWith("172.")?{x:"48%",y:"35%"}:t.includes("kartoza.com")?{x:"53%",y:"72%"}:{x:"50%",y:"45%"}}function Fje({host:t}){const e=Bt("blue.50","blue.900"),r=Bt("#94a3b8","#475569"),n=Bt("red.500","red.400"),i=Bt("red.300","red.600"),s=Bt("gray.100","gray.700"),a=Bt("gray.700","gray.200"),o=Lje(t),d=Dje(t);return u.jsxs(lt,{spacing:3,align:"stretch",children:[u.jsxs(ue,{position:"relative",bg:e,borderRadius:"xl",overflow:"hidden",h:"180px",w:"100%",children:[u.jsxs("svg",{viewBox:"0 0 900 400",style:{width:"100%",height:"100%"},preserveAspectRatio:"xMidYMid meet",children:[u.jsx("defs",{children:u.jsx("pattern",{id:"grid",width:"40",height:"40",patternUnits:"userSpaceOnUse",children:u.jsx("path",{d:"M 40 0 L 0 0 0 40",fill:"none",stroke:"currentColor",strokeWidth:"0.5",opacity:"0.1"})})}),u.jsx("rect",{width:"100%",height:"100%",fill:"url(#grid)"}),u.jsx("path",{d:Rje,fill:r,stroke:r,strokeWidth:"2",opacity:"0.6"})]}),u.jsxs(ue,{position:"absolute",left:o.x,top:o.y,transform:"translate(-50%, -50%)",children:[u.jsx(ue,{position:"absolute",w:"24px",h:"24px",borderRadius:"full",bg:i,animation:`${S6} 2s ease-out infinite`,transform:"translate(-50%, -50%)",left:"50%",top:"50%"}),u.jsx(ue,{position:"absolute",w:"24px",h:"24px",borderRadius:"full",bg:i,animation:`${S6} 2s ease-out infinite 0.6s`,transform:"translate(-50%, -50%)",left:"50%",top:"50%"}),u.jsx(ue,{w:"14px",h:"14px",borderRadius:"full",bg:n,shadow:"lg",position:"relative",zIndex:1,border:"2px solid white"})]}),u.jsx(ue,{position:"absolute",bottom:3,left:3,bg:"blackAlpha.700",px:3,py:1.5,borderRadius:"lg",children:u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:P2,color:"red.300",boxSize:4}),u.jsx(J,{fontSize:"sm",color:"white",fontWeight:"semibold",children:t||"localhost"})]})})]}),u.jsx(ue,{bg:s,px:4,py:2,borderRadius:"lg",children:u.jsxs(fe,{spacing:2,children:[u.jsx(ze,{as:ql,color:"blue.500",boxSize:4}),u.jsx(J,{fontSize:"sm",color:a,children:d})]})})]})}function Bje(){var P;const t=bt(E=>E.activeDialog),e=bt(E=>E.dialogData),r=bt(E=>E.closeDialog),n=t==="pgdashboard",i=e==null?void 0:e.data,[s,a]=I.useState(null),[o,d]=I.useState(!1),[m,y]=I.useState(null),v=Bt("linear-gradient(135deg, #336791 0%, #1a4e6d 100%)","linear-gradient(135deg, #1a4e6d 0%, #0d2b3d 100%)"),w=Bt("gray.50","gray.900");I.useEffect(()=>{n&&(i!=null&&i.serviceName)&&(d(!0),y(null),_U(i.serviceName).then(a).catch(E=>y(E.message)).finally(()=>d(!1)))},[n,i==null?void 0:i.serviceName]);const O=I.useMemo(()=>{if(!(s!=null&&s.version))return"Unknown";const E=s.version.match(/PostgreSQL (\d+\.\d+)/);return E?`PostgreSQL ${E[1]}`:"PostgreSQL"},[s==null?void 0:s.version]);return i!=null&&i.serviceName?u.jsxs(ss,{isOpen:n,onClose:r,size:"5xl",motionPreset:"slideInBottom",children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{m:4,borderRadius:"2xl",overflow:"hidden",maxH:"90vh",bg:w,children:[u.jsx(P1,{bgGradient:v,color:"white",py:6,px:6,children:u.jsxs(fe,{spacing:4,children:[u.jsx(ue,{p:3,bg:"whiteAlpha.200",borderRadius:"xl",children:u.jsx(ze,{as:fm,boxSize:8})}),u.jsxs(lt,{align:"start",spacing:0,children:[u.jsxs(fe,{spacing:3,children:[u.jsx(J,{fontSize:"xl",fontWeight:"bold",children:i.serviceName}),s&&u.jsx(Qt,{colorScheme:"green",variant:"solid",fontSize:"xs",px:2,py:1,borderRadius:"full",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:lf,boxSize:3}),u.jsx(J,{children:"Connected"})]})})]}),s&&u.jsxs(fe,{spacing:3,opacity:.9,mt:1,children:[u.jsx(J,{fontSize:"sm",children:s.database_name}),u.jsx(J,{fontSize:"sm",children:"|"}),u.jsx(J,{fontSize:"sm",children:O}),s.has_postgis&&u.jsxs(u.Fragment,{children:[u.jsx(J,{fontSize:"sm",children:"|"}),u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:xs,boxSize:4}),u.jsx(J,{fontSize:"sm",children:"PostGIS"})]})]})]})]})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{p:6,overflowY:"auto",maxH:"calc(90vh - 100px)",children:o?u.jsx(im,{h:"300px",children:u.jsxs(lt,{spacing:4,children:[u.jsx(kn,{size:"xl",color:"blue.500",thickness:"4px"}),u.jsx(J,{color:"gray.500",children:"Loading server statistics..."})]})}):m?u.jsx(im,{h:"300px",children:u.jsxs(lt,{spacing:4,children:[u.jsx(ze,{as:Gp,boxSize:12,color:"red.500"}),u.jsx(J,{color:"red.500",fontWeight:"medium",children:m})]})}):s&&u.jsxs(lt,{spacing:6,align:"stretch",children:[u.jsx(Fje,{host:s.host}),u.jsxs(ue,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:A2,color:"purple.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"Connections"})]}),u.jsxs(Wr,{columns:{base:2,md:4},spacing:4,children:[u.jsx(Do,{label:"Current",value:s.current_connections,helpText:`of ${s.max_connections} max`,icon:A2,colorScheme:"purple"}),u.jsx(Do,{label:"Active",value:s.active_connections,helpText:"executing queries",icon:M1,colorScheme:"green"}),u.jsx(Do,{label:"Idle",value:s.idle_connections,helpText:"waiting for work",icon:cC,colorScheme:"blue"}),u.jsx(Do,{label:"Waiting",value:s.waiting_connections,helpText:"blocked on locks",icon:vu,colorScheme:"orange"})]}),u.jsxs(ue,{mt:4,children:[u.jsxs(fe,{justify:"space-between",mb:2,children:[u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Connection Pool Usage"}),u.jsxs(J,{fontSize:"sm",fontWeight:"bold",children:[s.connection_percent,"%"]})]}),u.jsx(Sf,{value:s.connection_percent,colorScheme:s.connection_percent>80?"red":s.connection_percent>60?"orange":"green",borderRadius:"full",size:"lg"})]})]}),u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:Wn,color:"blue.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"Database"})]}),u.jsxs(Wr,{columns:{base:2,md:4},spacing:4,children:[u.jsx(Do,{label:"Size",value:s.database_size,icon:yy,colorScheme:"blue"}),u.jsx(Do,{label:"Cache Hit Ratio",value:s.cache_hit_ratio,helpText:"higher is better",icon:vu,colorScheme:"green"}),u.jsx(Do,{label:"Live Tuples",value:s.live_tuples.toLocaleString(),icon:Vo,colorScheme:"purple"}),u.jsx(Do,{label:"Dead Tuples",value:s.dead_tuples.toLocaleString(),helpText:"needs vacuum",icon:Gp,colorScheme:s.dead_tuples>1e4?"red":"gray"})]})]}),u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:hi,color:"teal.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"Objects"})]}),u.jsxs(Wr,{columns:{base:3,md:5},spacing:4,children:[u.jsx(Do,{label:"Schemas",value:s.schema_count,icon:hi,colorScheme:"teal"}),u.jsx(Do,{label:"Tables",value:s.table_count,icon:Vo,colorScheme:"blue"}),u.jsx(Do,{label:"Views",value:s.view_count,icon:Ri,colorScheme:"purple"}),u.jsx(Do,{label:"Indexes",value:s.index_count,icon:vu,colorScheme:"orange"}),u.jsx(Do,{label:"Functions",value:s.function_count,icon:Ml,colorScheme:"pink"})]})]}),s.has_postgis&&u.jsxs(u.Fragment,{children:[u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:xs,color:"green.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"PostGIS"})]}),u.jsxs(Wr,{columns:{base:2,md:3},spacing:4,children:[u.jsx(Do,{label:"Geometry Columns",value:s.geometry_columns||0,icon:xs,colorScheme:"green"}),u.jsx(Do,{label:"Raster Columns",value:s.raster_columns||0,icon:hi,colorScheme:"blue"})]}),s.postgis_version&&u.jsx(ue,{mt:4,p:3,bg:"green.50",borderRadius:"lg",children:u.jsx(J,{fontSize:"xs",color:"green.700",fontFamily:"mono",noOfLines:2,children:s.postgis_version})})]})]}),u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:ql,color:"gray.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"Server Info"})]}),u.jsxs(Wr,{columns:{base:1,md:2},spacing:4,children:[u.jsxs(ts,{children:[u.jsx(rs,{children:"Uptime"}),u.jsx(ns,{fontSize:"lg",children:s.uptime||"N/A"}),u.jsxs(Hd,{children:["Since ",(P=s.server_start_time)==null?void 0:P.split(" ")[0]]})]}),u.jsxs(ts,{children:[u.jsx(rs,{children:"Transactions"}),u.jsx(ns,{fontSize:"lg",children:s.xact_commit.toLocaleString()}),u.jsxs(Hd,{children:[s.xact_rollback.toLocaleString()," rollbacks"]})]})]}),u.jsx(ue,{mt:4,p:3,bg:"gray.100",borderRadius:"lg",_dark:{bg:"gray.700"},children:u.jsx(J,{fontSize:"xs",color:"gray.600",fontFamily:"mono",noOfLines:2,_dark:{color:"gray.300"},children:s.version})})]}),s.installed_extensions&&s.installed_extensions.length>0&&u.jsxs(u.Fragment,{children:[u.jsx(Nr,{}),u.jsxs(ue,{children:[u.jsxs(fe,{mb:4,children:[u.jsx(ze,{as:Ml,color:"indigo.500"}),u.jsx(J,{fontWeight:"semibold",fontSize:"lg",children:"Extensions"})]}),u.jsx(n0,{spacing:2,children:s.installed_extensions.map(E=>u.jsx(um,{children:u.jsx(wr,{label:E,fontSize:"xs",children:u.jsx(cm,{size:"md",colorScheme:E==="postgis"?"green":E==="plpgsql"?"blue":"gray",borderRadius:"full",children:E})})},E))})]})]})]})})]})]}):null}function $je(){var Yt,_t;const t=bt(rt=>rt.activeDialog),e=bt(rt=>rt.dialogData),r=bt(rt=>rt.closeDialog),n=Jo(),i=Yo(),[s,a]=I.useState([]),[o,d]=I.useState(!1),[m,y]=I.useState(!1),[v,w]=I.useState([]),[O,P]=I.useState(!1),[E,$]=I.useState(!1),[R,F]=I.useState(!1),[D,U]=I.useState("public"),[X,ee]=I.useState(!1),[K,Y]=I.useState(void 0),[ne,oe]=I.useState(null),ce=I.useRef(null),Xe=Bt("gray.50","gray.700"),Ae=Bt("gray.300","gray.600"),We=t==="pgupload",Ye=(Yt=e==null?void 0:e.data)==null?void 0:Yt.serviceName,tt=(_t=e==null?void 0:e.data)==null?void 0:_t.schemaName;I.useEffect(()=>{We&&(Qbe().then(oe).catch(console.error),a([]),y(!1),w([]),F(!1),U(tt||"public"),ee(!1),Y(void 0))},[We,tt]);const Be=rt=>{const Te=rt.toLowerCase().split(".").pop()||"";return[".tif",".tiff",".img",".jp2",".ecw",".sid",".asc",".dem",".hgt",".nc",".vrt"].some(ct=>ct.slice(1)===Te)},Me=I.useCallback(rt=>{rt.preventDefault();const Te=Array.from(rt.dataTransfer.files);De(Te)},[]),Ge=rt=>{if(rt.target.files){const Te=Array.from(rt.target.files);De(Te)}},De=rt=>{if(!ne){i({title:"Import tools not available",description:"Please ensure ogr2ogr and raster2pgsql are installed",status:"warning",duration:3e3});return}const Te=Object.keys(ne.supported_extensions),ct=rt.filter(Vt=>{const wt="."+Vt.name.toLowerCase().split(".").pop();return Te.includes(wt)});ct.length<rt.length&&i({title:"Some files skipped",description:"Only supported geospatial formats are accepted",status:"warning",duration:3e3}),a(Vt=>[...Vt,...ct.map(wt=>({file:wt,progress:0,status:"pending",isRaster:Be(wt.name)}))]),y(!1),w([])},Le=rt=>{a(Te=>Te.filter((ct,Vt)=>Vt!==rt))},Oe=async()=>{if(!Ye){i({title:"No service selected",description:"Please select a PostgreSQL service first",status:"warning",duration:3e3});return}if(s.length===0){i({title:"No files selected",description:"Please select files to upload",status:"warning",duration:3e3});return}d(!0);for(let Te=0;Te<s.length;Te++)if(s[Te].status==="pending"){a(ct=>ct.map((Vt,wt)=>wt===Te?{...Vt,status:"uploading"}:Vt));try{const ct=await Hbe(s[Te].file,Vt=>{a(wt=>wt.map((Ft,Kr)=>Kr===Te?{...Ft,progress:Vt}:Ft))});if(a(Vt=>Vt.map((wt,Ft)=>Ft===Te?{...wt,status:"uploaded",progress:100,filePath:ct.file_path}:wt)),!s[Te].isRaster){P(!0);try{const Vt=await Gbe(ct.file_path);if(a(wt=>wt.map((Ft,Kr)=>Kr===Te?{...Ft,layers:Vt}:Ft)),Vt.length>0){const wt=Vt.map(Ft=>({name:Ft.name,selected:!0,tableName:Ft.name.toLowerCase().replace(/[^a-z0-9_]/g,"_")}));w(Ft=>[...Ft,...wt])}else{const wt=s[Te].file.name.replace(/\.[^/.]+$/,""),Ft=wt.toLowerCase().replace(/[^a-z0-9_]/g,"_");w(Kr=>[...Kr,{name:wt,selected:!0,tableName:Ft}])}}catch(Vt){console.error("Failed to detect layers:",Vt);const wt=s[Te].file.name.replace(/\.[^/.]+$/,""),Ft=wt.toLowerCase().replace(/[^a-z0-9_]/g,"_");w(Kr=>[...Kr,{name:wt,selected:!0,tableName:Ft}])}finally{P(!1)}}}catch(ct){a(Vt=>Vt.map((wt,Ft)=>Ft===Te?{...wt,status:"error",error:ct.message}:wt))}}d(!1),y(!0);const rt=s.filter(Te=>Te.status==="uploaded").length;rt>0&&i({title:"Files uploaded",description:`${rt} file(s) ready for import`,status:"success",duration:3e3})},Ie=async()=>{if(!Ye)return;$(!0);const rt=[];for(const ct of s)if(!(ct.status!=="uploaded"||!ct.filePath)){a(Vt=>Vt.map(wt=>wt.filePath===ct.filePath?{...wt,status:"importing"}:wt));try{if(ct.isRaster){const Vt=await Kbe({source_file:ct.filePath,target_service:Ye,target_schema:D,overwrite:X,create_index:!0});rt.push(Vt.job_id),a(wt=>wt.map(Ft=>Ft.filePath===ct.filePath?{...Ft,jobId:Vt.job_id}:Ft))}else{const Vt=v.filter(wt=>{var Ft;return wt.selected&&((Ft=ct.layers)==null?void 0:Ft.some(Kr=>Kr.name===wt.name))});for(const wt of Vt){const Ft=await Xbe({source_file:ct.filePath,target_service:Ye,target_schema:D,table_name:wt.tableName,source_layer:wt.name,overwrite:X,target_srid:K});rt.push(Ft.job_id)}}a(Vt=>Vt.map(wt=>wt.filePath===ct.filePath?{...wt,status:"success"}:wt))}catch(Vt){a(wt=>wt.map(Ft=>Ft.filePath===ct.filePath?{...Ft,status:"error",error:Vt.message}:Ft))}}$(!1),rt.length>0&&st(rt),n.invalidateQueries({queryKey:["pgschemas",Ye]});const Te=s.filter(ct=>ct.status==="success").length;Te>0&&i({title:"Import started",description:`${Te} file(s) queued for import`,status:"success",duration:3e3})},st=async rt=>{const Te=new Set(rt);for(;Te.size>0;){await new Promise(ct=>setTimeout(ct,2e3));for(const ct of Array.from(Te))try{const Vt=await Zbe(ct);(Vt.status==="completed"||Vt.status==="failed")&&(Te.delete(ct),Vt.status==="completed"?i({title:"Import completed",description:`Table ${Vt.target_table} created successfully`,status:"success",duration:3e3}):i({title:"Import failed",description:Vt.error||"Unknown error",status:"error",duration:5e3}))}catch{Te.delete(ct)}}n.invalidateQueries({queryKey:["pgschemas",Ye]})},Re=rt=>{w(Te=>Te.map(ct=>ct.name===rt?{...ct,selected:!ct.selected}:ct))},it=(rt,Te)=>{w(ct=>ct.map(Vt=>Vt.name===rt?{...Vt,tableName:Te}:Vt))},Ke=()=>{a([]),y(!1),w([]),r()},St=rt=>{if(rt.isRaster)return wc;switch(rt.status){case"success":return AM;case"error":return hf;default:return Y7}},Mt=rt=>{switch(rt){case"success":return"green.500";case"error":return"red.500";case"importing":return"blue.500";default:return"gray.500"}},Et=s.some(rt=>rt.status==="pending"),xt=s.some(rt=>rt.status==="uploaded"),et=v.filter(rt=>rt.selected).length;return ne!=null&&ne.available?u.jsxs(ss,{isOpen:We,onClose:Ke,size:"xl",isCentered:!0,children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{borderRadius:"xl",overflow:"hidden",maxH:"85vh",children:[u.jsx(ue,{bg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",px:6,py:4,children:u.jsxs(fe,{spacing:3,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:2,borderRadius:"lg",children:u.jsx(ze,{as:Wn,boxSize:5,color:"white"})}),u.jsxs(ue,{flex:"1",children:[u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:"Import Data to PostgreSQL"}),u.jsxs(fe,{spacing:2,children:[u.jsx(J,{color:"whiteAlpha.800",fontSize:"sm",children:"Target:"}),Ye?u.jsx(Qt,{bg:"whiteAlpha.200",color:"white",fontSize:"xs",children:Ye}):u.jsx(J,{color:"whiteAlpha.600",fontSize:"sm",fontStyle:"italic",children:"No service selected"})]})]})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:6,overflowY:"auto",children:u.jsxs(lt,{spacing:4,children:[!m&&u.jsxs(ue,{w:"100%",p:8,bg:Xe,border:"2px dashed",borderColor:Ae,borderRadius:"xl",textAlign:"center",cursor:"pointer",onClick:()=>{var rt;return(rt=ce.current)==null?void 0:rt.click()},onDrop:Me,onDragOver:rt=>rt.preventDefault(),_hover:{borderColor:"purple.500",bg:"purple.50"},transition:"all 0.2s",children:[u.jsxs(lt,{spacing:3,children:[u.jsx(ue,{bg:"purple.50",p:4,borderRadius:"full",children:u.jsx(ze,{as:Vv,boxSize:10,color:"purple.500"})}),u.jsxs(lt,{spacing:1,children:[u.jsx(J,{fontWeight:"600",color:"gray.700",children:"Drop files here or click to browse"}),u.jsx(J,{fontSize:"sm",color:"gray.500",children:"GeoPackage, Shapefile, GeoJSON, GeoTIFF, and more"})]})]}),u.jsx("input",{ref:ce,type:"file",multiple:!0,accept:".gpkg,.shp,.zip,.geojson,.json,.kml,.tif,.tiff,.gml",style:{display:"none"},onChange:Ge})]}),s.length>0&&u.jsx(k1,{spacing:2,w:"100%",children:s.map((rt,Te)=>u.jsx(hM,{p:3,bg:Xe,borderRadius:"lg",border:"1px solid",borderColor:rt.status==="success"?"green.200":rt.status==="error"?"red.200":"gray.200",children:u.jsxs(lt,{align:"stretch",spacing:2,children:[u.jsxs(ue,{display:"flex",alignItems:"center",gap:2,children:[u.jsx(dM,{as:St(rt),color:Mt(rt.status),boxSize:5}),u.jsx(J,{flex:"1",fontSize:"sm",noOfLines:1,fontWeight:"500",children:rt.file.name}),rt.isRaster&&u.jsx(Qt,{colorScheme:"purple",size:"sm",children:"Raster"}),rt.status==="pending"&&u.jsx(gt,{size:"xs",variant:"ghost",colorScheme:"red",onClick:()=>Le(Te),borderRadius:"md",children:"Remove"}),rt.status==="success"&&u.jsx(Qt,{colorScheme:"green",borderRadius:"md",children:"Imported"}),rt.status==="importing"&&u.jsxs(fe,{children:[u.jsx(kn,{size:"xs"}),u.jsx(Qt,{colorScheme:"blue",borderRadius:"md",children:"Importing"})]})]}),(rt.status==="uploading"||rt.status==="importing")&&u.jsx(Sf,{value:rt.status==="importing"?void 0:rt.progress,isIndeterminate:rt.status==="importing",size:"sm",colorScheme:"purple",borderRadius:"full"}),rt.status==="error"&&u.jsx(J,{fontSize:"xs",color:"red.500",children:rt.error})]})},Te))}),m&&v.length>0&&u.jsxs(u.Fragment,{children:[u.jsx(Nr,{}),u.jsxs(ue,{w:"100%",children:[u.jsxs(fe,{justify:"space-between",mb:3,children:[u.jsxs(fe,{children:[u.jsx(ze,{as:hi,color:"purple.500"}),u.jsx(J,{fontWeight:"600",children:"Layers to Import"})]}),u.jsxs(fe,{spacing:2,children:[u.jsx(gt,{size:"xs",variant:"outline",colorScheme:"purple",onClick:()=>{w(rt=>rt.map(Te=>({...Te,selected:!0})))},isDisabled:v.every(rt=>rt.selected),children:"Select All"}),u.jsx(gt,{size:"xs",variant:"outline",onClick:()=>{w(rt=>rt.map(Te=>({...Te,selected:!1})))},isDisabled:v.every(rt=>!rt.selected),children:"Deselect All"}),u.jsxs(Qt,{colorScheme:"purple",children:[et," selected"]})]})]}),u.jsxs(J,{fontSize:"sm",color:"gray.500",mb:3,children:["All ",v.length," layer(s) detected in the file. Adjust table names if needed:"]}),u.jsx(lt,{align:"stretch",spacing:2,maxH:"200px",overflowY:"auto",children:v.map(rt=>u.jsx(ue,{p:2,bg:Xe,borderRadius:"md",border:"1px solid",borderColor:rt.selected?"purple.200":"gray.200",children:u.jsxs(fe,{spacing:3,children:[u.jsx(Ga,{isChecked:rt.selected,onChange:()=>Re(rt.name),colorScheme:"purple"}),u.jsxs(lt,{align:"stretch",flex:"1",spacing:1,children:[u.jsx(J,{fontSize:"sm",fontWeight:"500",children:rt.name}),u.jsx(Ar,{size:"xs",value:rt.tableName,onChange:Te=>it(rt.name,Te.target.value),placeholder:"Table name",isDisabled:!rt.selected})]})]})},rt.name))})]})]}),m&&xt&&u.jsxs(u.Fragment,{children:[u.jsx(Nr,{}),u.jsxs(ue,{w:"100%",children:[u.jsx(gt,{variant:"ghost",size:"sm",leftIcon:R?u.jsx(i0,{}):u.jsx(Ul,{}),rightIcon:u.jsx(R1,{}),onClick:()=>F(!R),w:"100%",justifyContent:"space-between",children:"Advanced Options"}),u.jsx(bc,{in:R,children:u.jsxs(lt,{spacing:4,mt:3,align:"stretch",p:3,bg:Xe,borderRadius:"md",children:[u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Target Schema"}),u.jsx(Ar,{size:"sm",value:D,onChange:rt=>U(rt.target.value),placeholder:"public"})]}),u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:"Target SRID (leave empty to keep source)"}),u.jsx(Ar,{size:"sm",type:"number",value:K||"",onChange:rt=>Y(rt.target.value?parseInt(rt.target.value):void 0),placeholder:"e.g. 4326"})]}),u.jsxs(Ot,{display:"flex",alignItems:"center",children:[u.jsx(jt,{fontSize:"sm",mb:"0",children:"Overwrite existing tables"}),u.jsx(fa,{colorScheme:"purple",isChecked:X,onChange:rt=>ee(rt.target.checked)})]})]})})]})]}),O&&u.jsxs(fe,{spacing:2,color:"gray.500",children:[u.jsx(kn,{size:"sm"}),u.jsx(J,{fontSize:"sm",children:"Detecting layers..."})]})]})}),u.jsxs(To,{gap:3,borderTop:"1px solid",borderTopColor:"gray.100",bg:"gray.50",children:[u.jsx(gt,{variant:"ghost",onClick:Ke,borderRadius:"lg",children:m?"Close":"Cancel"}),m&&xt&&u.jsx(gt,{colorScheme:"green",onClick:Ie,isLoading:E,loadingText:"Importing...",isDisabled:et===0&&!s.some(rt=>rt.isRaster&&rt.status==="uploaded"),leftIcon:u.jsx(Wn,{}),borderRadius:"lg",px:6,children:"Import to PostgreSQL"}),(!m||Et)&&u.jsxs(gt,{colorScheme:"purple",onClick:Oe,isLoading:o,loadingText:"Uploading...",isDisabled:s.length===0||!Ye||!Et,leftIcon:u.jsx(Vv,{}),borderRadius:"lg",px:6,children:["Upload ",s.filter(rt=>rt.status==="pending").length>0&&`(${s.filter(rt=>rt.status==="pending").length})`]})]})]})]}):u.jsxs(ss,{isOpen:We,onClose:Ke,size:"lg",isCentered:!0,children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{borderRadius:"xl",overflow:"hidden",children:[u.jsx(ue,{bg:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",px:6,py:4,children:u.jsxs(fe,{spacing:3,children:[u.jsx(ue,{bg:"whiteAlpha.200",p:2,borderRadius:"lg",children:u.jsx(ze,{as:Wn,boxSize:5,color:"white"})}),u.jsx(J,{color:"white",fontWeight:"600",fontSize:"lg",children:"Import Data to PostgreSQL"})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:6,children:u.jsxs(lt,{spacing:4,align:"center",children:[u.jsx(ze,{as:hf,boxSize:12,color:"red.500"}),u.jsx(J,{fontWeight:"600",fontSize:"lg",children:"Import Tools Not Available"}),u.jsx(J,{color:"gray.500",textAlign:"center",children:"ogr2ogr and raster2pgsql are required for data import. Please install GDAL and PostGIS on the server."})]})}),u.jsx(To,{children:u.jsx(gt,{onClick:Ke,children:"Close"})})]})]})}const k6=lo`
  0% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.3); opacity: 0.6; }
  100% { transform: scale(1.6); opacity: 0; }
`,Nje=lo`
  0% { transform: scale(1.6); opacity: 0; }
  50% { transform: scale(1.3); opacity: 0.6; }
  100% { transform: scale(1); opacity: 1; }
`,Bj=lo`
  0% { transform: translateX(-10px); opacity: 0; }
  50% { opacity: 1; }
  100% { transform: translateX(10px); opacity: 0; }
`,Vje=lo`
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
`,Wje=lo`
  0%, 100% { box-shadow: 0 0 5px rgba(56, 178, 172, 0.3); }
  50% { box-shadow: 0 0 20px rgba(56, 178, 172, 0.6); }
`;function Uje({connection:t,isSelected:e,onSelect:r,isHovered:n,onHover:i}){return u.jsxs(ue,{position:"relative",p:4,bg:e?"green.50":"gray.50",borderRadius:"lg",border:"2px solid",borderColor:e?"green.400":n?"green.300":"gray.200",cursor:"pointer",transition:"all 0.3s ease",onClick:r,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),_hover:{borderColor:"green.300",bg:"green.50"},children:[(n||e)&&u.jsxs(u.Fragment,{children:[u.jsx(ue,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",w:"60px",h:"60px",borderRadius:"full",border:"2px solid",borderColor:"green.300",css:yc`animation: ${k6} 1.5s ease-out infinite;`}),u.jsx(ue,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",w:"60px",h:"60px",borderRadius:"full",border:"2px solid",borderColor:"green.300",css:yc`animation: ${k6} 1.5s ease-out infinite 0.5s;`})]}),u.jsxs(lt,{spacing:2,position:"relative",zIndex:1,children:[u.jsxs(ue,{position:"relative",children:[u.jsx(ze,{as:ql,w:10,h:10,color:e?"green.500":"gray.400"}),e&&u.jsx(ze,{as:lf,position:"absolute",bottom:-1,right:-1,w:4,h:4,color:"green.500",bg:"white",borderRadius:"full"})]}),u.jsx(J,{fontWeight:"bold",fontSize:"sm",textAlign:"center",noOfLines:1,children:(t==null?void 0:t.name)||"No server"}),u.jsx(Qt,{colorScheme:"green",fontSize:"xs",children:"SOURCE"})]})]})}function qje({connection:t,isRunning:e,task:r,onRemove:n,onStop:i}){const s=(r==null?void 0:r.progress)||0;return u.jsxs(ue,{position:"relative",p:4,bg:e?"blue.50":(r==null?void 0:r.status)==="completed"?"green.50":(r==null?void 0:r.status)==="failed"?"red.50":"gray.50",borderRadius:"lg",border:"2px solid",borderColor:e?"blue.400":(r==null?void 0:r.status)==="completed"?"green.400":(r==null?void 0:r.status)==="failed"?"red.400":"gray.200",transition:"all 0.3s ease",css:e?yc`animation: ${Wje} 2s ease-in-out infinite;`:void 0,children:[e&&u.jsx(ue,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",w:"60px",h:"60px",borderRadius:"full",border:"2px solid",borderColor:"blue.300",css:yc`animation: ${Nje} 1.5s ease-in infinite;`}),u.jsxs(lt,{spacing:2,position:"relative",zIndex:1,children:[u.jsxs(ue,{position:"relative",children:[u.jsx(ze,{as:Wn,w:10,h:10,color:e?"blue.500":(r==null?void 0:r.status)==="completed"?"green.500":(r==null?void 0:r.status)==="failed"?"red.500":"gray.400",css:e?yc`animation: ${Vje} 2s linear infinite;`:void 0}),(r==null?void 0:r.status)==="completed"&&u.jsx(ze,{as:lf,position:"absolute",bottom:-1,right:-1,w:4,h:4,color:"green.500",bg:"white",borderRadius:"full"}),(r==null?void 0:r.status)==="failed"&&u.jsx(ze,{as:uC,position:"absolute",bottom:-1,right:-1,w:4,h:4,color:"red.500",bg:"white",borderRadius:"full"})]}),u.jsx(J,{fontWeight:"bold",fontSize:"sm",textAlign:"center",noOfLines:1,children:t.name}),u.jsx(Qt,{colorScheme:"blue",fontSize:"xs",children:"DESTINATION"}),(e||r)&&u.jsxs(ue,{w:"100%",mt:2,children:[u.jsx(Sf,{value:s,size:"sm",colorScheme:(r==null?void 0:r.status)==="failed"?"red":(r==null?void 0:r.status)==="completed"?"green":"blue",borderRadius:"full",hasStripe:e,isAnimated:e}),u.jsx(J,{fontSize:"xs",color:"gray.500",textAlign:"center",mt:1,children:(r==null?void 0:r.currentItem)||`${s}%`})]}),u.jsx(fe,{spacing:1,mt:2,children:e?u.jsx(wr,{label:"Stop sync",children:u.jsx(gr,{"aria-label":"Stop sync",icon:u.jsx(tU,{}),size:"xs",colorScheme:"red",variant:"ghost",onClick:a=>{a.stopPropagation(),i()}})}):u.jsx(wr,{label:"Remove",children:u.jsx(gr,{"aria-label":"Remove destination",icon:u.jsx(Xd,{}),size:"xs",colorScheme:"red",variant:"ghost",onClick:a=>{a.stopPropagation(),n()}})})})]})]})}function Qje({isActive:t}){return u.jsxs(ue,{position:"relative",minW:"80px",display:"flex",alignItems:"center",justifyContent:"center",children:[u.jsx(ue,{h:"2px",flex:1,bg:t?"blue.400":"gray.300",transition:"background 0.3s ease"}),t&&u.jsxs(u.Fragment,{children:[u.jsx(ze,{as:pv,position:"absolute",color:"blue.500",css:yc`animation: ${Bj} 1s ease-in-out infinite;`}),u.jsx(ze,{as:pv,position:"absolute",color:"blue.500",css:yc`animation: ${Bj} 1s ease-in-out infinite 0.33s;`}),u.jsx(ze,{as:pv,position:"absolute",color:"blue.500",css:yc`animation: ${Bj} 1s ease-in-out infinite 0.66s;`})]}),!t&&u.jsx(ze,{as:pv,position:"absolute",color:"gray.400"})]})}function Hje({options:t,onChange:e}){const{isOpen:r,onToggle:n}=rm({defaultIsOpen:!0}),i=s=>{e({...t,[s]:!t[s]})};return u.jsxs(ue,{bg:"gray.50",borderRadius:"md",p:3,children:[u.jsxs(yr,{justify:"space-between",align:"center",cursor:"pointer",onClick:n,children:[u.jsxs(fe,{children:[u.jsx(ze,{as:xve,color:"kartoza.500"}),u.jsx(J,{fontWeight:"bold",fontSize:"sm",children:"Sync Options"})]}),u.jsx(ze,{as:r?i0:Ul})]}),u.jsx(bc,{in:r,children:u.jsxs(Wr,{columns:3,gap:3,mt:3,children:[u.jsx(Ga,{isChecked:t.workspaces,onChange:()=>i("workspaces"),colorScheme:"kartoza",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:mh,color:"yellow.500",boxSize:3}),u.jsx(J,{fontSize:"sm",children:"Workspaces"})]})}),u.jsx(Ga,{isChecked:t.datastores,onChange:()=>i("datastores"),colorScheme:"kartoza",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:Wn,color:"blue.500",boxSize:3}),u.jsx(J,{fontSize:"sm",children:"Data Stores"})]})}),u.jsx(Ga,{isChecked:t.coveragestores,onChange:()=>i("coveragestores"),colorScheme:"kartoza",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:wc,color:"green.500",boxSize:3}),u.jsx(J,{fontSize:"sm",children:"Coverage Stores"})]})}),u.jsx(Ga,{isChecked:t.layers,onChange:()=>i("layers"),colorScheme:"kartoza",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:hi,color:"purple.500",boxSize:3}),u.jsx(J,{fontSize:"sm",children:"Layers"})]})}),u.jsx(Ga,{isChecked:t.styles,onChange:()=>i("styles"),colorScheme:"kartoza",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:_c,color:"pink.500",boxSize:3}),u.jsx(J,{fontSize:"sm",children:"Styles"})]})}),u.jsx(Ga,{isChecked:t.layergroups,onChange:()=>i("layergroups"),colorScheme:"kartoza",children:u.jsxs(fe,{spacing:1,children:[u.jsx(ze,{as:uf,color:"orange.500",boxSize:3}),u.jsx(J,{fontSize:"sm",children:"Layer Groups"})]})})]})})]})}function Gje({tasks:t}){const e=I.useRef(null),{isOpen:r,onToggle:n}=rm({defaultIsOpen:!1}),i=t.flatMap(a=>a.log||[]);I.useEffect(()=>{e.current&&(e.current.scrollTop=e.current.scrollHeight)},[i.length]);const s=a=>{a.stopPropagation(),t.forEach(o=>{o.id&&$be(o.id)})};return t.length===0?null:u.jsxs(ue,{bg:"gray.900",borderRadius:"md",overflow:"hidden",children:[u.jsxs(yr,{justify:"space-between",align:"center",p:2,bg:"gray.800",cursor:"pointer",onClick:n,children:[u.jsxs(fe,{children:[u.jsx(ze,{as:M1,color:"green.400"}),u.jsx(J,{fontWeight:"bold",fontSize:"sm",color:"white",children:"Activity Log"}),u.jsxs(Qt,{colorScheme:"green",fontSize:"xs",children:[i.length," entries"]})]}),u.jsxs(fe,{children:[i.length>0&&u.jsx(wr,{label:"Download Logs",fontSize:"xs",children:u.jsx(gr,{"aria-label":"Download logs",icon:u.jsx(gy,{size:14}),size:"xs",variant:"ghost",colorScheme:"green",onClick:s})}),u.jsx(ze,{as:r?i0:Ul,color:"white"})]})]}),u.jsx(bc,{in:r,children:u.jsxs(ue,{ref:e,maxH:"150px",overflowY:"auto",p:2,fontFamily:"mono",fontSize:"xs",css:{"&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-thumb":{background:"gray.600",borderRadius:"3px"}},children:[i.map((a,o)=>u.jsx(J,{color:"green.300",mb:.5,children:a},o)),i.length===0&&u.jsx(J,{color:"gray.500",children:"Waiting for activity..."})]})})]})}function Xje(){const t=Yo(),e=bt(De=>De.activeDialog),r=bt(De=>De.closeDialog),n=Js(De=>De.connections),i=e==="sync",[s,a]=I.useState(null),[o,d]=I.useState([]),[m,y]=I.useState({workspaces:!0,datastores:!0,coveragestores:!0,layers:!0,styles:!0,layergroups:!0}),[v,w]=I.useState(!1),[O,P]=I.useState(""),[E,$]=I.useState(null),{data:R=[],refetch:F}=Xr({queryKey:["syncConfigs"],queryFn:Abe,enabled:i}),{data:D=[],refetch:U}=Xr({queryKey:["syncStatus"],queryFn:Ibe,enabled:i,refetchInterval:1e3}),X=D.some(De=>De.status==="running"),ee=su({mutationFn:De=>Mbe(De),onSuccess:()=>{t({title:"Sync started",description:"Synchronization has been initiated.",status:"success",duration:3e3}),U()},onError:De=>{t({title:"Failed to start sync",description:De.message,status:"error",duration:5e3})}}),K=su({mutationFn:De=>Rbe(De),onSuccess:()=>{t({title:"Sync stopped",status:"info",duration:2e3}),U()}}),Y=su({mutationFn:Dbe,onSuccess:()=>{t({title:"All syncs stopped",status:"info",duration:2e3}),U()}}),ne=su({mutationFn:De=>Ebe(De),onSuccess:()=>{t({title:"Configuration saved",status:"success",duration:2e3}),F(),P("")},onError:De=>{t({title:"Failed to save configuration",description:De.message,status:"error",duration:5e3})}}),oe=su({mutationFn:De=>zbe(De),onSuccess:()=>{t({title:"Configuration deleted",status:"info",duration:2e3}),F(),$(null)}}),ce=()=>{if(!s||o.length===0){t({title:"Configuration incomplete",description:"Please select a source and at least one destination.",status:"warning",duration:3e3});return}ee.mutate({sourceId:s,destinationIds:o,options:m})},Xe=()=>{if(!O||!s||o.length===0){t({title:"Cannot save",description:"Please provide a name and complete the sync configuration.",status:"warning",duration:3e3});return}ne.mutate({name:O,source_id:s,destination_ids:o,options:m})},Ae=De=>{console.log("Loading sync config:",De),console.log("Available connections:",n.map(it=>({id:it.id,name:it.name})));const Le=De.source_id&&De.source_id.trim()!==""?De.source_id:null;a(Le);const Oe=(De.destination_ids||[]).filter(it=>it&&it.trim()!=="");d(Oe),y({...{workspaces:!0,datastores:!0,coveragestores:!0,layers:!0,styles:!0,layergroups:!0},...De.options||{}}),$(De.id),P(De.name);const st=Le?n.find(it=>it.id===Le):null,Re=Oe.filter(it=>!n.find(Ke=>Ke.id===it));Le&&!st&&t({title:"Source connection not found",description:`The saved source connection (${Le}) may have been deleted.`,status:"warning",duration:5e3}),Re.length>0&&t({title:"Some destination connections not found",description:`${Re.length} destination(s) may have been deleted.`,status:"warning",duration:5e3})},We=De=>{if(De===s){t({title:"Invalid selection",description:"Cannot sync to the same server.",status:"warning",duration:2e3});return}o.includes(De)||d([...o,De])},Ye=De=>{d(o.filter(Le=>Le!==De))},tt=De=>n.find(Le=>Le.id===De),Be=s?tt(s):null,Me=n.filter(De=>De.id!==s&&!o.includes(De.id)),Ge=De=>D.find(Le=>Le.destId===De&&Le.sourceId===s);return u.jsxs(ss,{isOpen:i,onClose:r,size:"6xl",scrollBehavior:"inside",children:[u.jsx(as,{backdropFilter:"blur(4px)"}),u.jsxs(os,{maxH:"90vh",children:[u.jsxs(P1,{bg:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",color:"white",borderTopRadius:"md",children:[u.jsxs(fe,{children:[u.jsx(ze,{as:Su}),u.jsx(J,{children:"Sync Servers"})]}),u.jsx(J,{fontSize:"sm",fontWeight:"normal",opacity:.9,children:"Replicate resources between GeoServer instances"})]}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{py:6,children:u.jsxs(lt,{spacing:6,align:"stretch",children:[R.length>0&&u.jsx(ue,{children:u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",fontWeight:"bold",children:u.jsxs(fe,{children:[u.jsx(ze,{as:OS}),u.jsx(J,{children:"Saved Configurations"})]})}),u.jsxs(fe,{children:[u.jsx(zn,{placeholder:"Select a saved configuration...",value:E||"",onChange:De=>{const Le=R.find(Oe=>Oe.id===De.target.value);Le&&Ae(Le)},size:"sm",children:R.map(De=>u.jsxs("option",{value:De.id,children:[De.name," (Last sync: ",De.last_synced_at||"Never",")"]},De.id))}),E&&u.jsx(wr,{label:"Delete configuration",children:u.jsx(gr,{"aria-label":"Delete configuration",icon:u.jsx(Xd,{}),size:"sm",colorScheme:"red",variant:"ghost",onClick:()=>oe.mutate(E)})})]})]})}),u.jsxs(yr,{gap:4,align:"stretch",wrap:"wrap",justify:"center",children:[u.jsxs(ue,{flex:"1",minW:"250px",children:[u.jsx(J,{fontWeight:"bold",fontSize:"sm",mb:2,color:"green.600",children:u.jsxs(fe,{children:[u.jsx(ze,{as:pv}),u.jsx(J,{children:"Source (Read Only)"})]})}),u.jsxs(lt,{spacing:3,children:[u.jsx(zn,{placeholder:"Select source server...",value:s||"",onChange:De=>a(De.target.value||null),size:"sm",children:n.map(De=>u.jsx("option",{value:De.id,children:De.name},De.id))}),Be&&u.jsx(Uje,{connection:Be,isSelected:!0,onSelect:()=>{},isHovered:v,onHover:w})]})]}),u.jsx(yr,{align:"center",minW:"100px",justify:"center",children:u.jsx(Qje,{isActive:X})}),u.jsxs(ue,{flex:"2",minW:"350px",children:[u.jsx(J,{fontWeight:"bold",fontSize:"sm",mb:2,color:"blue.600",children:u.jsxs(fe,{children:[u.jsx(ze,{as:sve}),u.jsx(J,{children:"Destinations (Receivers)"})]})}),u.jsx(fe,{mb:3,children:u.jsx(zn,{placeholder:"Add destination server...",onChange:De=>{De.target.value&&(We(De.target.value),De.target.value="")},size:"sm",isDisabled:!s||Me.length===0,children:Me.map(De=>u.jsx("option",{value:De.id,children:De.name},De.id))})}),o.length>0?u.jsx(Wr,{columns:{base:1,md:2,lg:3},spacing:3,children:o.map(De=>{const Le=tt(De);if(!Le)return null;const Oe=Ge(De),Ie=(Oe==null?void 0:Oe.status)==="running";return u.jsx(qje,{connection:Le,isRunning:Ie,task:Oe,onRemove:()=>Ye(De),onStop:()=>Oe&&K.mutate(Oe.id)},De)})}):u.jsxs(ue,{p:8,border:"2px dashed",borderColor:"gray.300",borderRadius:"lg",textAlign:"center",children:[u.jsx(ze,{as:vve,w:10,h:10,color:"gray.300",mb:2}),u.jsx(J,{color:"gray.500",fontSize:"sm",children:"Select destination servers from the dropdown above"})]})]})]}),u.jsx(Nr,{}),u.jsx(Hje,{options:m,onChange:y}),u.jsx(Gje,{tasks:D}),u.jsx(ue,{bg:"gray.50",borderRadius:"md",p:3,children:u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",fontWeight:"bold",children:u.jsxs(fe,{children:[u.jsx(ze,{as:OS,color:"kartoza.500"}),u.jsx(J,{children:"Save Configuration"})]})}),u.jsxs(fe,{children:[u.jsx(Ar,{placeholder:"Configuration name...",value:O,onChange:De=>P(De.target.value),size:"sm"}),u.jsx(gt,{leftIcon:u.jsx(OS,{}),colorScheme:"kartoza",size:"sm",onClick:Xe,isDisabled:!O||!s||o.length===0,isLoading:ne.isPending,children:"Save"})]})]})})]})}),u.jsx(To,{borderTop:"1px",borderColor:"gray.200",bg:"gray.50",children:u.jsxs(fe,{spacing:3,w:"100%",justify:"space-between",children:[X&&u.jsx(gt,{leftIcon:u.jsx(hf,{}),colorScheme:"red",variant:"outline",onClick:()=>Y.mutate(),isLoading:Y.isPending,children:"Stop All"}),u.jsxs(fe,{spacing:3,ml:"auto",children:[u.jsx(gt,{variant:"ghost",onClick:r,children:"Close"}),u.jsx(gt,{leftIcon:X?u.jsx(kn,{size:"sm"}):u.jsx(EM,{}),colorScheme:"kartoza",size:"lg",onClick:ce,isDisabled:!s||o.length===0||X,isLoading:ee.isPending,px:8,_hover:{transform:"scale(1.02)",boxShadow:"lg"},transition:"all 0.2s ease",children:X?"Syncing...":"Start Sync"})]})]})})]})]})}const QE=1,Kje=2,Zje=3,Yje=4,Jje=5,ePe=36,tPe=37,rPe=38,nPe=11,iPe=13;function sPe(t){return t==45||t==46||t==58||t>=65&&t<=90||t==95||t>=97&&t<=122||t>=161}function oPe(t){return t==9||t==10||t==13||t==32}let C6=null,T6=null,O6=0;function HE(t,e){let r=t.pos+e;if(T6==t&&O6==r)return C6;for(;oPe(t.peek(e));)e++;let n="";for(;;){let i=t.peek(e);if(!sPe(i))break;n+=String.fromCharCode(i),e++}return T6=t,O6=r,C6=n||null}function j6(t,e){this.name=t,this.parent=e}const aPe=new ROe({start:null,shift(t,e,r,n){return e==QE?new j6(HE(n,1)||"",t):t},reduce(t,e){return e==nPe&&t?t.parent:t},reuse(t,e,r,n){let i=e.type.id;return i==QE||i==iPe?new j6(HE(n,1)||"",t):t},strict:!1}),lPe=new Sm((t,e)=>{if(t.next==60){if(t.advance(),t.next==47){t.advance();let r=HE(t,0);if(!r)return t.acceptToken(Jje);if(e.context&&r==e.context.name)return t.acceptToken(Kje);for(let n=e.context;n;n=n.parent)if(n.name==r)return t.acceptToken(Zje,-2);t.acceptToken(Yje)}else if(t.next!=33&&t.next!=63)return t.acceptToken(QE)}},{contextual:!0});function SI(t,e){return new Sm(r=>{let n=0,i=e.charCodeAt(0);e:for(;!(r.next<0);r.advance(),n++)if(r.next==i){for(let s=1;s<e.length;s++)if(r.peek(s)!=e.charCodeAt(s))continue e;break}n&&r.acceptToken(t)})}const cPe=SI(ePe,"-->"),uPe=SI(tPe,"?>"),hPe=SI(rPe,"]]>"),dPe=bC({Text:Ve.content,"StartTag StartCloseTag EndTag SelfCloseEndTag":Ve.angleBracket,TagName:Ve.tagName,"MismatchedCloseTag/TagName":[Ve.tagName,Ve.invalid],AttributeName:Ve.attributeName,AttributeValue:Ve.attributeValue,Is:Ve.definitionOperator,"EntityReference CharacterReference":Ve.character,Comment:Ve.blockComment,ProcessingInst:Ve.processingInstruction,DoctypeDecl:Ve.documentMeta,Cdata:Ve.special(Ve.string)}),fPe=m0.deserialize({version:14,states:",lOQOaOOOrOxO'#CfOzOpO'#CiO!tOaO'#CgOOOP'#Cg'#CgO!{OrO'#CrO#TOtO'#CsO#]OpO'#CtOOOP'#DT'#DTOOOP'#Cv'#CvQQOaOOOOOW'#Cw'#CwO#eOxO,59QOOOP,59Q,59QOOOO'#Cx'#CxO#mOpO,59TO#uO!bO,59TOOOP'#C|'#C|O$TOaO,59RO$[OpO'#CoOOOP,59R,59ROOOQ'#C}'#C}O$dOrO,59^OOOP,59^,59^OOOS'#DO'#DOO$lOtO,59_OOOP,59_,59_O$tOpO,59`O$|OpO,59`OOOP-E6t-E6tOOOW-E6u-E6uOOOP1G.l1G.lOOOO-E6v-E6vO%UO!bO1G.oO%UO!bO1G.oO%dOpO'#CkO%lO!bO'#CyO%zO!bO1G.oOOOP1G.o1G.oOOOP1G.w1G.wOOOP-E6z-E6zOOOP1G.m1G.mO&VOpO,59ZO&_OpO,59ZOOOQ-E6{-E6{OOOP1G.x1G.xOOOS-E6|-E6|OOOP1G.y1G.yO&gOpO1G.zO&gOpO1G.zOOOP1G.z1G.zO&oO!bO7+$ZO&}O!bO7+$ZOOOP7+$Z7+$ZOOOP7+$c7+$cO'YOpO,59VO'bOpO,59VO'mO!bO,59eOOOO-E6w-E6wO'{OpO1G.uO'{OpO1G.uOOOP1G.u1G.uO(TOpO7+$fOOOP7+$f7+$fO(]O!bO<<GuOOOP<<Gu<<GuOOOP<<G}<<G}O'bOpO1G.qO'bOpO1G.qO(hO#tO'#CnO(vO&jO'#CnOOOO1G.q1G.qO)UOpO7+$aOOOP7+$a7+$aOOOP<<HQ<<HQOOOPAN=aAN=aOOOPAN=iAN=iO'bOpO7+$]OOOO7+$]7+$]OOOO'#Cz'#CzO)^O#tO,59YOOOO,59Y,59YOOOO'#C{'#C{O)lO&jO,59YOOOP<<G{<<G{OOOO<<Gw<<GwOOOO-E6x-E6xOOOO1G.t1G.tOOOO-E6y-E6y",stateData:")z~OPQOSVOTWOVWOWWOXWOiXOyPO!QTO!SUO~OvZOx]O~O^`Oz^O~OPQOQcOSVOTWOVWOWWOXWOyPO!QTO!SUO~ORdO~P!SOteO!PgO~OuhO!RjO~O^lOz^O~OvZOxoO~O^qOz^O~O[vO`sOdwOz^O~ORyO~P!SO^{Oz^O~OteO!P}O~OuhO!R!PO~O^!QOz^O~O[!SOz^O~O[!VO`sOd!WOz^O~Oa!YOz^O~Oz^O[mX`mXdmX~O[!VO`sOd!WO~O^!]Oz^O~O[!_Oz^O~O[!aOz^O~O[!cO`sOd!dOz^O~O[!cO`sOd!dO~Oa!eOz^O~Oz^O{!gO}!hO~Oz^O[ma`madma~O[!kOz^O~O[!lOz^O~O[!mO`sOd!nO~OW!qOX!qO{!sO|!qO~OW!tOX!tO}!sO!O!tO~O[!vOz^O~OW!qOX!qO{!yO|!qO~OW!tOX!tO}!yO!O!tO~O",goto:"%cxPPPPPPPPPPyyP!PP!VPP!`!jP!pyyyP!v!|#S$[$k$q$w$}%TPPPP%ZXWORYbXRORYb_t`qru!T!U!bQ!i!YS!p!e!fR!w!oQdRRybXSORYbQYORmYQ[PRn[Q_QQkVjp_krz!R!T!X!Z!^!`!f!j!oQr`QzcQ!RlQ!TqQ!XsQ!ZtQ!^{Q!`!QQ!f!YQ!j!]R!o!eQu`S!UqrU![u!U!bR!b!TQ!r!gR!x!rQ!u!hR!z!uQbRRxbQfTR|fQiUR!OiSXOYTaRb",nodeNames:" StartTag StartCloseTag MissingCloseTag StartCloseTag StartCloseTag Document Text EntityReference CharacterReference Cdata Element EndTag OpenTag TagName Attribute AttributeName Is AttributeValue CloseTag SelfCloseEndTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag DoctypeDecl",maxTerm:50,context:aPe,nodeProps:[["closedBy",1,"SelfCloseEndTag EndTag",13,"CloseTag MissingCloseTag"],["openedBy",12,"StartTag StartCloseTag",19,"OpenTag",20,"StartTag"],["isolate",-6,13,18,19,21,22,24,""]],propSources:[dPe],skippedNodes:[0],repeatNodeCount:9,tokenData:"!)v~R!YOX$qXY)iYZ)iZ]$q]^)i^p$qpq)iqr$qrs*vsv$qvw+fwx/ix}$q}!O0[!O!P$q!P!Q2z!Q![$q![!]4n!]!^$q!^!_8U!_!`!#t!`!a!$l!a!b!%d!b!c$q!c!}4n!}#P$q#P#Q!'W#Q#R$q#R#S4n#S#T$q#T#o4n#o%W$q%W%o4n%o%p$q%p&a4n&a&b$q&b1p4n1p4U$q4U4d4n4d4e$q4e$IS4n$IS$I`$q$I`$Ib4n$Ib$Kh$q$Kh%#t4n%#t&/x$q&/x&Et4n&Et&FV$q&FV;'S4n;'S;:j8O;:j;=`)c<%l?&r$q?&r?Ah4n?Ah?BY$q?BY?Mn4n?MnO$qi$zXVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qa%nVVP!O`Ov%gwx&Tx!^%g!^!_&o!_;'S%g;'S;=`'W<%lO%gP&YTVPOv&Tw!^&T!_;'S&T;'S;=`&i<%lO&TP&lP;=`<%l&T`&tS!O`Ov&ox;'S&o;'S;=`'Q<%lO&o`'TP;=`<%l&oa'ZP;=`<%l%gX'eWVP|WOr'^rs&Tsv'^w!^'^!^!_'}!_;'S'^;'S;=`(i<%lO'^W(ST|WOr'}sv'}w;'S'};'S;=`(c<%lO'}W(fP;=`<%l'}X(lP;=`<%l'^h(vV|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oh)`P;=`<%l(oi)fP;=`<%l$qo)t`VP|W!O`zUOX$qXY)iYZ)iZ]$q]^)i^p$qpq)iqr$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk+PV{YVP!O`Ov%gwx&Tx!^%g!^!_&o!_;'S%g;'S;=`'W<%lO%g~+iast,n![!]-r!c!}-r#R#S-r#T#o-r%W%o-r%p&a-r&b1p-r4U4d-r4e$IS-r$I`$Ib-r$Kh%#t-r&/x&Et-r&FV;'S-r;'S;:j/c?&r?Ah-r?BY?Mn-r~,qQ!Q![,w#l#m-V~,zQ!Q![,w!]!^-Q~-VOX~~-YR!Q![-c!c!i-c#T#Z-c~-fS!Q![-c!]!^-Q!c!i-c#T#Z-c~-ug}!O-r!O!P-r!Q![-r![!]-r!]!^/^!c!}-r#R#S-r#T#o-r$}%O-r%W%o-r%p&a-r&b1p-r1p4U-r4U4d-r4e$IS-r$I`$Ib-r$Je$Jg-r$Kh%#t-r&/x&Et-r&FV;'S-r;'S;:j/c?&r?Ah-r?BY?Mn-r~/cOW~~/fP;=`<%l-rk/rW}bVP|WOr'^rs&Tsv'^w!^'^!^!_'}!_;'S'^;'S;=`(i<%lO'^k0eZVP|W!O`Or$qrs%gsv$qwx'^x}$q}!O1W!O!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk1aZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a2S!a;'S$q;'S;=`)c<%lO$qk2_X!PQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qm3TZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a3v!a;'S$q;'S;=`)c<%lO$qm4RXdSVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qo4{!P`S^QVP|W!O`Or$qrs%gsv$qwx'^x}$q}!O4n!O!P4n!P!Q$q!Q![4n![!]4n!]!^$q!^!_(o!_!c$q!c!}4n!}#R$q#R#S4n#S#T$q#T#o4n#o$}$q$}%O4n%O%W$q%W%o4n%o%p$q%p&a4n&a&b$q&b1p4n1p4U4n4U4d4n4d4e$q4e$IS4n$IS$I`$q$I`$Ib4n$Ib$Je$q$Je$Jg4n$Jg$Kh$q$Kh%#t4n%#t&/x$q&/x&Et4n&Et&FV$q&FV;'S4n;'S;:j8O;:j;=`)c<%l?&r$q?&r?Ah4n?Ah?BY$q?BY?Mn4n?MnO$qo8RP;=`<%l4ni8]Y|W!O`Oq(oqr8{rs&osv(owx'}x!a(o!a!b!#U!b;'S(o;'S;=`)]<%lO(oi9S_|W!O`Or(ors&osv(owx'}x}(o}!O:R!O!f(o!f!g;e!g!}(o!}#ODh#O#W(o#W#XLp#X;'S(o;'S;=`)]<%lO(oi:YX|W!O`Or(ors&osv(owx'}x}(o}!O:u!O;'S(o;'S;=`)]<%lO(oi;OV!QP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oi;lX|W!O`Or(ors&osv(owx'}x!q(o!q!r<X!r;'S(o;'S;=`)]<%lO(oi<`X|W!O`Or(ors&osv(owx'}x!e(o!e!f<{!f;'S(o;'S;=`)]<%lO(oi=SX|W!O`Or(ors&osv(owx'}x!v(o!v!w=o!w;'S(o;'S;=`)]<%lO(oi=vX|W!O`Or(ors&osv(owx'}x!{(o!{!|>c!|;'S(o;'S;=`)]<%lO(oi>jX|W!O`Or(ors&osv(owx'}x!r(o!r!s?V!s;'S(o;'S;=`)]<%lO(oi?^X|W!O`Or(ors&osv(owx'}x!g(o!g!h?y!h;'S(o;'S;=`)]<%lO(oi@QY|W!O`Or?yrs@psv?yvwA[wxBdx!`?y!`!aCr!a;'S?y;'S;=`Db<%lO?ya@uV!O`Ov@pvxA[x!`@p!`!aAy!a;'S@p;'S;=`B^<%lO@pPA_TO!`A[!`!aAn!a;'SA[;'S;=`As<%lOA[PAsOiPPAvP;=`<%lA[aBQSiP!O`Ov&ox;'S&o;'S;=`'Q<%lO&oaBaP;=`<%l@pXBiX|WOrBdrsA[svBdvwA[w!`Bd!`!aCU!a;'SBd;'S;=`Cl<%lOBdXC]TiP|WOr'}sv'}w;'S'};'S;=`(c<%lO'}XCoP;=`<%lBdiC{ViP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oiDeP;=`<%l?yiDoZ|W!O`Or(ors&osv(owx'}x!e(o!e!fEb!f#V(o#V#WIr#W;'S(o;'S;=`)]<%lO(oiEiX|W!O`Or(ors&osv(owx'}x!f(o!f!gFU!g;'S(o;'S;=`)]<%lO(oiF]X|W!O`Or(ors&osv(owx'}x!c(o!c!dFx!d;'S(o;'S;=`)]<%lO(oiGPX|W!O`Or(ors&osv(owx'}x!v(o!v!wGl!w;'S(o;'S;=`)]<%lO(oiGsX|W!O`Or(ors&osv(owx'}x!c(o!c!dH`!d;'S(o;'S;=`)]<%lO(oiHgX|W!O`Or(ors&osv(owx'}x!}(o!}#OIS#O;'S(o;'S;=`)]<%lO(oiI]V|W!O`yPOr(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oiIyX|W!O`Or(ors&osv(owx'}x#W(o#W#XJf#X;'S(o;'S;=`)]<%lO(oiJmX|W!O`Or(ors&osv(owx'}x#T(o#T#UKY#U;'S(o;'S;=`)]<%lO(oiKaX|W!O`Or(ors&osv(owx'}x#h(o#h#iK|#i;'S(o;'S;=`)]<%lO(oiLTX|W!O`Or(ors&osv(owx'}x#T(o#T#UH`#U;'S(o;'S;=`)]<%lO(oiLwX|W!O`Or(ors&osv(owx'}x#c(o#c#dMd#d;'S(o;'S;=`)]<%lO(oiMkX|W!O`Or(ors&osv(owx'}x#V(o#V#WNW#W;'S(o;'S;=`)]<%lO(oiN_X|W!O`Or(ors&osv(owx'}x#h(o#h#iNz#i;'S(o;'S;=`)]<%lO(oi! RX|W!O`Or(ors&osv(owx'}x#m(o#m#n! n#n;'S(o;'S;=`)]<%lO(oi! uX|W!O`Or(ors&osv(owx'}x#d(o#d#e!!b#e;'S(o;'S;=`)]<%lO(oi!!iX|W!O`Or(ors&osv(owx'}x#X(o#X#Y?y#Y;'S(o;'S;=`)]<%lO(oi!#_V!SP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(ok!$PXaQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qo!$wX[UVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk!%mZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a!&`!a;'S$q;'S;=`)c<%lO$qk!&kX!RQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk!'aZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_#P$q#P#Q!(S#Q;'S$q;'S;=`)c<%lO$qk!(]ZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a!)O!a;'S$q;'S;=`)c<%lO$qk!)ZXxQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$q",tokenizers:[lPe,cPe,uPe,hPe,0,1,2,3,4],topRules:{Document:[0,6]},tokenPrec:0});function FS(t,e){let r=e&&e.getChild("TagName");return r?t.sliceString(r.from,r.to):""}function $j(t,e){let r=e&&e.firstChild;return!r||r.name!="OpenTag"?"":FS(t,r)}function pPe(t,e,r){let n=e&&e.getChildren("Attribute").find(s=>s.from<=r&&s.to>=r),i=n&&n.getChild("AttributeName");return i?t.sliceString(i.from,i.to):""}function Nj(t){for(let e=t&&t.parent;e;e=e.parent)if(e.name=="Element")return e;return null}function mPe(t,e){var r;let n=Hi(t).resolveInner(e,-1),i=null;for(let s=n;!i&&s.parent;s=s.parent)(s.name=="OpenTag"||s.name=="CloseTag"||s.name=="SelfClosingTag"||s.name=="MismatchedCloseTag")&&(i=s);if(i&&(i.to>e||i.lastChild.type.isError)){let s=i.parent;if(n.name=="TagName")return i.name=="CloseTag"||i.name=="MismatchedCloseTag"?{type:"closeTag",from:n.from,context:s}:{type:"openTag",from:n.from,context:Nj(s)};if(n.name=="AttributeName")return{type:"attrName",from:n.from,context:i};if(n.name=="AttributeValue")return{type:"attrValue",from:n.from,context:i};let a=n==i||n.name=="Attribute"?n.childBefore(e):n;return(a==null?void 0:a.name)=="StartTag"?{type:"openTag",from:e,context:Nj(s)}:(a==null?void 0:a.name)=="StartCloseTag"&&a.to<=e?{type:"closeTag",from:e,context:s}:(a==null?void 0:a.name)=="Is"?{type:"attrValue",from:e,context:i}:a?{type:"attrName",from:e,context:i}:null}else if(n.name=="StartCloseTag")return{type:"closeTag",from:e,context:n.parent};for(;n.parent&&n.to==e&&!(!((r=n.lastChild)===null||r===void 0)&&r.type.isError);)n=n.parent;return n.name=="Element"||n.name=="Text"||n.name=="Document"?{type:"tag",from:e,context:n.name=="Element"?n:Nj(n)}:null}let gPe=class{constructor(e,r,n){this.attrs=r,this.attrValues=n,this.children=[],this.name=e.name,this.completion=Object.assign(Object.assign({type:"type"},e.completion||{}),{label:this.name}),this.openCompletion=Object.assign(Object.assign({},this.completion),{label:"<"+this.name}),this.closeCompletion=Object.assign(Object.assign({},this.completion),{label:"</"+this.name+">",boost:2}),this.closeNameCompletion=Object.assign(Object.assign({},this.completion),{label:this.name+">"}),this.text=e.textContent?e.textContent.map(i=>({label:i,type:"text"})):[]}};const Vj=/^[:\-\.\w\u00b7-\uffff]*$/;function P6(t){return Object.assign(Object.assign({type:"property"},t.completion||{}),{label:t.name})}function A6(t){return typeof t=="string"?{label:`"${t}"`,type:"constant"}:/^"/.test(t.label)?t:Object.assign(Object.assign({},t),{label:`"${t.label}"`})}function yPe(t,e){let r=[],n=[],i=Object.create(null);for(let d of e){let m=P6(d);r.push(m),d.global&&n.push(m),d.values&&(i[d.name]=d.values.map(A6))}let s=[],a=[],o=Object.create(null);for(let d of t){let m=n,y=i;d.attributes&&(m=m.concat(d.attributes.map(w=>typeof w=="string"?r.find(O=>O.label==w)||{label:w,type:"property"}:(w.values&&(y==i&&(y=Object.create(y)),y[w.name]=w.values.map(A6)),P6(w)))));let v=new gPe(d,m,y);o[v.name]=v,s.push(v),d.top&&a.push(v)}a.length||(a=s);for(let d=0;d<s.length;d++){let m=t[d],y=s[d];if(m.children)for(let v of m.children)o[v]&&y.children.push(o[v]);else y.children=s}return d=>{var m;let{doc:y}=d.state,v=mPe(d.state,d.pos);if(!v||v.type=="tag"&&!d.explicit)return null;let{type:w,from:O,context:P}=v;if(w=="openTag"){let E=a,$=$j(y,P);if($){let R=o[$];E=(R==null?void 0:R.children)||s}return{from:O,options:E.map(R=>R.completion),validFor:Vj}}else if(w=="closeTag"){let E=$j(y,P);return E?{from:O,to:d.pos+(y.sliceString(d.pos,d.pos+1)==">"?1:0),options:[((m=o[E])===null||m===void 0?void 0:m.closeNameCompletion)||{label:E+">",type:"type"}],validFor:Vj}:null}else if(w=="attrName"){let E=o[FS(y,P)];return{from:O,options:(E==null?void 0:E.attrs)||n,validFor:Vj}}else if(w=="attrValue"){let E=pPe(y,P,O);if(!E)return null;let $=o[FS(y,P)],R=(($==null?void 0:$.attrValues)||i)[E];return!R||!R.length?null:{from:O,to:d.pos+(y.sliceString(d.pos,d.pos+1)=='"'?1:0),options:R,validFor:/^"[^"]*"?$/}}else if(w=="tag"){let E=$j(y,P),$=o[E],R=[],F=P&&P.lastChild;E&&(!F||F.name!="CloseTag"||FS(y,F)!=E)&&R.push($?$.closeCompletion:{label:"</"+E+">",type:"type",boost:2});let D=R.concat((($==null?void 0:$.children)||(P?s:a)).map(U=>U.openCompletion));if(P&&($!=null&&$.text.length)){let U=P.firstChild;U.to>d.pos-20&&!/\S/.test(d.state.sliceDoc(U.to,d.pos))&&(D=D.concat($.text))}return{from:O,options:D,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}else return null}}const GE=h0.define({name:"xml",parser:fPe.configure({props:[SC.add({Element(t){let e=/^\s*<\//.test(t.textAfter);return t.lineIndent(t.node.from)+(e?0:t.unit)},"OpenTag CloseTag SelfClosingTag"(t){return t.column(t.node.from)+t.unit}}),kC.add({Element(t){let e=t.firstChild,r=t.lastChild;return!e||e.name!="OpenTag"?null:{from:e.to,to:r.name=="CloseTag"?r.from:t.to}}}),bQ.add({"OpenTag CloseTag":t=>t.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"<!--",close:"-->"}},indentOnInput:/^\s*<\/$/}});function xPe(t={}){let e=[GE.data.of({autocomplete:yPe(t.elements||[],t.attributes||[])})];return t.autoCloseTags!==!1&&e.push(vPe),new oI(GE,e)}function E6(t,e,r=t.length){if(!e)return"";let n=e.firstChild,i=n&&n.getChild("TagName");return i?t.sliceString(i.from,Math.min(i.to,r)):""}const vPe=Zt.inputHandler.of((t,e,r,n,i)=>{if(t.composing||t.state.readOnly||e!=r||n!=">"&&n!="/"||!GE.isActiveAt(t.state,e,-1))return!1;let s=i(),{state:a}=s,o=a.changeByRange(d=>{var m,y,v;let{head:w}=d,O=a.doc.sliceString(w-1,w)==n,P=Hi(a).resolveInner(w,-1),E;if(O&&n==">"&&P.name=="EndTag"){let $=P.parent;if(((y=(m=$.parent)===null||m===void 0?void 0:m.lastChild)===null||y===void 0?void 0:y.name)!="CloseTag"&&(E=E6(a.doc,$.parent,w))){let R=w+(a.doc.sliceString(w,w+1)===">"?1:0),F=`</${E}>`;return{range:d,changes:{from:w,to:R,insert:F}}}}else if(O&&n=="/"&&P.name=="StartCloseTag"){let $=P.parent;if(P.from==w-2&&((v=$.lastChild)===null||v===void 0?void 0:v.name)!="CloseTag"&&(E=E6(a.doc,$,w))){let R=w+(a.doc.sliceString(w,w+1)===">"?1:0),F=`${E}>`;return{range:pt.cursor(w+F.length,-1),changes:{from:w,to:R,insert:F}}}}return{range:d}});return o.changes.empty?!1:(t.dispatch([s,a.update(o,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),bPe=122,z6=1,_Pe=123,wPe=124,RH=2,SPe=125,kPe=3,CPe=4,DH=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],TPe=58,OPe=40,LH=95,jPe=91,BS=45,PPe=46,APe=35,EPe=37,zPe=38,MPe=92,IPe=10,RPe=42;function Jb(t){return t>=65&&t<=90||t>=97&&t<=122||t>=161}function kI(t){return t>=48&&t<=57}function M6(t){return kI(t)||t>=97&&t<=102||t>=65&&t<=70}const FH=(t,e,r)=>(n,i)=>{for(let s=!1,a=0,o=0;;o++){let{next:d}=n;if(Jb(d)||d==BS||d==LH||s&&kI(d))!s&&(d!=BS||o>0)&&(s=!0),a===o&&d==BS&&a++,n.advance();else if(d==MPe&&n.peek(1)!=IPe){if(n.advance(),M6(n.next)){do n.advance();while(M6(n.next));n.next==32&&n.advance()}else n.next>-1&&n.advance();s=!0}else{s&&n.acceptToken(a==2&&i.canShift(RH)?e:d==OPe?r:t);break}}},DPe=new Sm(FH(_Pe,RH,wPe)),LPe=new Sm(FH(SPe,kPe,CPe)),FPe=new Sm(t=>{if(DH.includes(t.peek(-1))){let{next:e}=t;(Jb(e)||e==LH||e==APe||e==PPe||e==RPe||e==jPe||e==TPe&&Jb(t.peek(1))||e==BS||e==zPe)&&t.acceptToken(bPe)}}),BPe=new Sm(t=>{if(!DH.includes(t.peek(-1))){let{next:e}=t;if(e==EPe&&(t.advance(),t.acceptToken(z6)),Jb(e)){do t.advance();while(Jb(t.next)||kI(t.next));t.acceptToken(z6)}}}),$Pe=bC({"AtKeyword import charset namespace keyframes media supports":Ve.definitionKeyword,"from to selector":Ve.keyword,NamespaceName:Ve.namespace,KeyframeName:Ve.labelName,KeyframeRangeName:Ve.operatorKeyword,TagName:Ve.tagName,ClassName:Ve.className,PseudoClassName:Ve.constant(Ve.className),IdName:Ve.labelName,"FeatureName PropertyName":Ve.propertyName,AttributeName:Ve.attributeName,NumberLiteral:Ve.number,KeywordQuery:Ve.keyword,UnaryQueryOp:Ve.operatorKeyword,"CallTag ValueName":Ve.atom,VariableName:Ve.variableName,Callee:Ve.operatorKeyword,Unit:Ve.unit,"UniversalSelector NestingSelector":Ve.definitionOperator,"MatchOp CompareOp":Ve.compareOperator,"ChildOp SiblingOp, LogicOp":Ve.logicOperator,BinOp:Ve.arithmeticOperator,Important:Ve.modifier,Comment:Ve.blockComment,ColorLiteral:Ve.color,"ParenthesizedContent StringLiteral":Ve.string,":":Ve.punctuation,"PseudoOp #":Ve.derefOperator,"; ,":Ve.separator,"( )":Ve.paren,"[ ]":Ve.squareBracket,"{ }":Ve.brace}),NPe={__proto__:null,lang:38,"nth-child":38,"nth-last-child":38,"nth-of-type":38,"nth-last-of-type":38,dir:38,"host-context":38,if:84,url:124,"url-prefix":124,domain:124,regexp:124},VPe={__proto__:null,or:98,and:98,not:106,only:106,layer:170},WPe={__proto__:null,selector:112,layer:166},UPe={__proto__:null,"@import":162,"@media":174,"@charset":178,"@namespace":182,"@keyframes":188,"@supports":200,"@scope":204},qPe={__proto__:null,to:207},QPe=m0.deserialize({version:14,states:"EbQYQdOOO#qQdOOP#xO`OOOOQP'#Cf'#CfOOQP'#Ce'#CeO#}QdO'#ChO$nQaO'#CcO$xQdO'#CkO%TQdO'#DpO%YQdO'#DrO%_QdO'#DuO%_QdO'#DxOOQP'#FV'#FVO&eQhO'#EhOOQS'#FU'#FUOOQS'#Ek'#EkQYQdOOO&lQdO'#EOO&PQhO'#EUO&lQdO'#EWO'aQdO'#EYO'lQdO'#E]O'tQhO'#EcO(VQdO'#EeO(bQaO'#CfO)VQ`O'#D{O)[Q`O'#F`O)gQdO'#F`QOQ`OOP)qO&jO'#CaPOOO)C@t)C@tOOQP'#Cj'#CjOOQP,59S,59SO#}QdO,59SO)|QdO,59VO%TQdO,5:[O%YQdO,5:^O%_QdO,5:aO%_QdO,5:cO%_QdO,5:dO%_QdO'#ErO*XQ`O,58}O*aQdO'#DzOOQS,58},58}OOQP'#Cn'#CnOOQO'#Dn'#DnOOQP,59V,59VO*hQ`O,59VO*mQ`O,59VOOQP'#Dq'#DqOOQP,5:[,5:[OOQO'#Ds'#DsO*rQpO,5:^O+]QaO,5:aO+sQaO,5:dOOQW'#DZ'#DZO,ZQhO'#DdO,xQhO'#FaO'tQhO'#DbO-WQ`O'#DhOOQW'#F['#F[O-]Q`O,5;SO-eQ`O'#DeOOQS-E8i-E8iOOQ['#Cs'#CsO-jQdO'#CtO.QQdO'#CzO.hQdO'#C}O/OQ!pO'#DPO1RQ!jO,5:jOOQO'#DU'#DUO*mQ`O'#DTO1cQ!nO'#FXO3`Q`O'#DVO3eQ`O'#DkOOQ['#FX'#FXO-`Q`O,5:pO3jQ!bO,5:rOOQS'#E['#E[O3rQ`O,5:tO3wQdO,5:tOOQO'#E_'#E_O4PQ`O,5:wO4UQhO,5:}O%_QdO'#DgOOQS,5;P,5;PO-eQ`O,5;PO4^QdO,5;PO4fQdO,5:gO4vQdO'#EtO5TQ`O,5;zO5TQ`O,5;zPOOO'#Ej'#EjP5`O&jO,58{POOO,58{,58{OOQP1G.n1G.nOOQP1G.q1G.qO*hQ`O1G.qO*mQ`O1G.qOOQP1G/v1G/vO5kQpO1G/xO5sQaO1G/{O6ZQaO1G/}O6qQaO1G0OO7XQaO,5;^OOQO-E8p-E8pOOQS1G.i1G.iO7cQ`O,5:fO7hQdO'#DoO7oQdO'#CrOOQP1G/x1G/xO&lQdO1G/xO7vQ!jO'#DZO8UQ!bO,59vO8^QhO,5:OOOQO'#F]'#F]O8XQ!bO,59zO'tQhO,59xO8fQhO'#EvO8sQ`O,5;{O9OQhO,59|O9uQhO'#DiOOQW,5:S,5:SOOQS1G0n1G0nOOQW,5:P,5:PO9|Q!fO'#FYOOQS'#FY'#FYOOQS'#Em'#EmO;^QdO,59`OOQ[,59`,59`O;tQdO,59fOOQ[,59f,59fO<[QdO,59iOOQ[,59i,59iOOQ[,59k,59kO&lQdO,59mO<rQhO'#EQOOQW'#EQ'#EQO=WQ`O1G0UO1[QhO1G0UOOQ[,59o,59oO'tQhO'#DXOOQ[,59q,59qO=]Q#tO,5:VOOQS1G0[1G0[OOQS1G0^1G0^OOQS1G0`1G0`O=hQ`O1G0`O=mQdO'#E`OOQS1G0c1G0cOOQS1G0i1G0iO=xQaO,5:RO-`Q`O1G0kOOQS1G0k1G0kO-eQ`O1G0kO>PQ!fO1G0ROOQO1G0R1G0ROOQO,5;`,5;`O>gQdO,5;`OOQO-E8r-E8rO>tQ`O1G1fPOOO-E8h-E8hPOOO1G.g1G.gOOQP7+$]7+$]OOQP7+%d7+%dO&lQdO7+%dOOQS1G0Q1G0QO?PQaO'#F_O?ZQ`O,5:ZO?`Q!fO'#ElO@^QdO'#FWO@hQ`O,59^O@mQ!bO7+%dO&lQdO1G/bO@uQhO1G/fOOQW1G/j1G/jOOQW1G/d1G/dOAWQhO,5;bOOQO-E8t-E8tOAfQhO'#DZOAtQhO'#F^OBPQ`O'#F^OBUQ`O,5:TOOQS-E8k-E8kOOQ[1G.z1G.zOOQ[1G/Q1G/QOOQ[1G/T1G/TOOQ[1G/X1G/XOBZQdO,5:lOOQS7+%p7+%pOB`Q`O7+%pOBeQhO'#DYOBmQ`O,59sO'tQhO,59sOOQ[1G/q1G/qOBuQ`O1G/qOOQS7+%z7+%zOBzQbO'#DPOOQO'#Eb'#EbOCYQ`O'#EaOOQO'#Ea'#EaOCeQ`O'#EwOCmQdO,5:zOOQS,5:z,5:zOOQ[1G/m1G/mOOQS7+&V7+&VO-`Q`O7+&VOCxQ!fO'#EsO&lQdO'#EsOEPQdO7+%mOOQO7+%m7+%mOOQO1G0z1G0zOEdQ!bO<<IOOElQdO'#EqOEvQ`O,5;yOOQP1G/u1G/uOOQS-E8j-E8jOFOQdO'#EpOFYQ`O,5;rOOQ]1G.x1G.xOOQP<<IO<<IOOFbQdO7+$|OOQO'#D]'#D]OFiQ!bO7+%QOFqQhO'#EoOF{Q`O,5;xO&lQdO,5;xOOQW1G/o1G/oOOQO'#ES'#ESOGTQ`O1G0WOOQS<<I[<<I[O&lQdO,59tOGnQhO1G/_OOQ[1G/_1G/_OGuQ`O1G/_OOQW-E8l-E8lOOQ[7+%]7+%]OOQO,5:{,5:{O=pQdO'#ExOCeQ`O,5;cOOQS,5;c,5;cOOQS-E8u-E8uOOQS1G0f1G0fOOQS<<Iq<<IqOG}Q!fO,5;_OOQS-E8q-E8qOOQO<<IX<<IXOOQPAN>jAN>jOIUQaO,5;]OOQO-E8o-E8oOI`QdO,5;[OOQO-E8n-E8nOOQW<<Hh<<HhOOQW<<Hl<<HlOIjQhO<<HlOI{QhO,5;ZOJWQ`O,5;ZOOQO-E8m-E8mOJ]QdO1G1dOBZQdO'#EuOJgQ`O7+%rOOQW7+%r7+%rOJoQ!bO1G/`OOQ[7+$y7+$yOJzQhO7+$yPKRQ`O'#EnOOQO,5;d,5;dOOQO-E8v-E8vOOQS1G0}1G0}OKWQ`OAN>WO&lQdO1G0uOK]Q`O7+'OOOQO,5;a,5;aOOQO-E8s-E8sOOQW<<I^<<I^OOQ[<<He<<HePOQW,5;Y,5;YOOQWG23rG23rOKeQdO7+&a",stateData:"Kx~O#sOS#tQQ~OW[OZ[O]TO`VOaVOi]OjWOmXO!jYO!mZO!saO!ybO!{cO!}dO#QeO#WfO#YgO#oRO~OQiOW[OZ[O]TO`VOaVOi]OjWOmXO!jYO!mZO!saO!ybO!{cO!}dO#QeO#WfO#YgO#ohO~O#m$SP~P!dO#tmO~O#ooO~O]qO`rOarOjsOmtO!juO!mwO#nvO~OpzO!^xO~P$SOc!QO#o|O#p}O~O#o!RO~O#o!TO~OW[OZ[O]TO`VOaVOjWOmXO!jYO!mZO#oRO~OS!]Oe!YO!V![O!Y!`O#q!XOp$TP~Ok$TP~P&POQ!jOe!cOm!dOp!eOr!mOt!mOz!kO!`!lO#o!bO#p!hO#}!fO~Ot!qO!`!lO#o!pO~Ot!sO#o!sO~OS!]Oe!YO!V![O!Y!`O#q!XO~Oe!vOpzO#Z!xO~O]YX`YX`!pXaYXjYXmYXpYX!^YX!jYX!mYX#nYX~O`!zO~Ok!{O#m$SXo$SX~O#m$SXo$SX~P!dO#u#OO#v#OO#w#QO~Oc#UO#o|O#p}O~OpzO!^xO~Oo$SP~P!dOe#`O~Oe#aO~Ol#bO!h#cO~O]qO`rOarOjsOmtO~Op!ia!^!ia!j!ia!m!ia#n!iad!ia~P*zOp!la!^!la!j!la!m!la#n!lad!la~P*zOR#gOS!]Oe!YOr#gOt#gO!V![O!Y!`O#q#dO#}!fO~O!R#iO!^#jOk$TXp$TX~Oe#mO~Ok#oOpzO~Oe!vO~O]#rO`#rOd#uOi#rOj#rOk#rO~P&lO]#rO`#rOi#rOj#rOk#rOl#wO~P&lO]#rO`#rOi#rOj#rOk#rOo#yO~P&lOP#zOSsXesXksXvsX!VsX!YsX!usX!wsX#qsX!TsXQsX]sX`sXdsXisXjsXmsXpsXrsXtsXzsX!`sX#osX#psX#}sXlsXosX!^sX!qsX#msX~Ov#{O!u#|O!w#}Ok$TP~P'tOe#aOS#{Xk#{Xv#{X!V#{X!Y#{X!u#{X!w#{X#q#{XQ#{X]#{X`#{Xd#{Xi#{Xj#{Xm#{Xp#{Xr#{Xt#{Xz#{X!`#{X#o#{X#p#{X#}#{Xl#{Xo#{X!^#{X!q#{X#m#{X~Oe$RO~Oe$TO~Ok$VOv#{O~Ok$WO~Ot$XO!`!lO~Op$YO~OpzO!R#iO~OpzO#Z$`O~O!q$bOk!oa#m!oao!oa~P&lOk#hX#m#hXo#hX~P!dOk!{O#m$Sao$Sa~O#u#OO#v#OO#w$hO~Ol$jO!h$kO~Op!ii!^!ii!j!ii!m!ii#n!iid!ii~P*zOp!ki!^!ki!j!ki!m!ki#n!kid!ki~P*zOp!li!^!li!j!li!m!li#n!lid!li~P*zOp#fa!^#fa~P$SOo$lO~Od$RP~P%_Od#zP~P&lO`!PXd}X!R}X!T!PX~O`$sO!T$tO~Od$uO!R#iO~Ok#jXp#jX!^#jX~P'tO!^#jOk$Tap$Ta~O!R#iOk!Uap!Ua!^!Uad!Ua`!Ua~OS!]Oe!YO!V![O!Y!`O#q$yO~Od$QP~P9dOv#{OQ#|X]#|X`#|Xd#|Xe#|Xi#|Xj#|Xk#|Xm#|Xp#|Xr#|Xt#|Xz#|X!`#|X#o#|X#p#|X#}#|Xl#|Xo#|X~O]#rO`#rOd%OOi#rOj#rOk#rO~P&lO]#rO`#rOi#rOj#rOk#rOl%PO~P&lO]#rO`#rOi#rOj#rOk#rOo%QO~P&lOe%SOS!tXk!tX!V!tX!Y!tX#q!tX~Ok%TO~Od%YOt%ZO!a%ZO~Ok%[O~Oo%cO#o%^O#}%]O~Od%dO~P$SOv#{O!^%hO!q%jOk!oi#m!oio!oi~P&lOk#ha#m#hao#ha~P!dOk!{O#m$Sio$Si~O!^%mOd$RX~P$SOd%oO~Ov#{OQ#`Xd#`Xe#`Xm#`Xp#`Xr#`Xt#`Xz#`X!^#`X!`#`X#o#`X#p#`X#}#`X~O!^%qOd#zX~P&lOd%sO~Ol%tOv#{O~OR#gOr#gOt#gO#q%vO#}!fO~O!R#iOk#jap#ja!^#ja~O`!PXd}X!R}X!^}X~O!R#iO!^%xOd$QX~O`%zO~Od%{O~O#o%|O~Ok&OO~O`&PO!R#iO~Od&ROk&QO~Od&UO~OP#zOpsX!^sXdsX~O#}%]Op#TX!^#TX~OpzO!^&WO~Oo&[O#o%^O#}%]O~Ov#{OQ#gXe#gXk#gXm#gXp#gXr#gXt#gXz#gX!^#gX!`#gX!q#gX#m#gX#o#gX#p#gX#}#gXo#gX~O!^%hO!q&`Ok!oq#m!oqo!oq~P&lOl&aOv#{O~Od#eX!^#eX~P%_O!^%mOd$Ra~Od#dX!^#dX~P&lO!^%qOd#za~Od&fO~P&lOd&gO!T&hO~Od#cX!^#cX~P9dO!^%xOd$Qa~O]&mOd&oO~OS#bae#ba!V#ba!Y#ba#q#ba~Od&qO~PG]Od&qOk&rO~Ov#{OQ#gae#gak#gam#gap#gar#gat#gaz#ga!^#ga!`#ga!q#ga#m#ga#o#ga#p#ga#}#gao#ga~Od#ea!^#ea~P$SOd#da!^#da~P&lOR#gOr#gOt#gO#q%vO#}%]O~O!R#iOd#ca!^#ca~O`&xO~O!^%xOd$Qi~P&lO]&mOd&|O~Ov#{Od|ik|i~Od&}O~PG]Ok'OO~Od'PO~O!^%xOd$Qq~Od#cq!^#cq~P&lO#s!a#t#}]#}v!m~",goto:"2h$UPPPPP$VP$YP$c$uP$cP%X$cPP%_PPP%e%o%oPPPPP%oPP%oP&]P%oP%o'W%oP't'w'}'}(^'}P'}P'}P'}'}P(m'}(yP(|PP)p)v$c)|$c*SP$cP$c$cP*Y*{+YP$YP+aP+dP$YP$YP$YP+j$YP+m+p+s+z$YP$YPP$YP,P,V,f,|-[-b-l-r-x.O.U.`.f.l.rPPPPPPPPPPP.x/R/w/z0|P1U1u2O2R2U2[RnQ_^OP`kz!{$dq[OPYZ`kuvwxz!v!{#`$d%mqSOPYZ`kuvwxz!v!{#`$d%mQpTR#RqQ!OVR#SrQ#S!QS$Q!i!jR$i#U!V!mac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'Q!U!mac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'QU#g!Y$t&hU%`$Y%b&WR&V%_!V!iac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'QR$S!kQ%W$RR&S%Xk!^]bf!Y![!g#i#j#m$P$R%X%xQ#e!YQ${#mQ%w$tQ&j%xR&w&hQ!ygQ#p!`Q$^!xR%f$`R#n!]!U!mac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'QQ!qdR$X!rQ!PVR#TrQ#S!PR$i#TQ!SWR#VsQ!UXR#WtQ{UQ!wgQ#^yQ#o!_Q$U!nQ$[!uQ$_!yQ%e$^Q&Y%aQ&]%fR&v&XSjPzQ!}kQ$c!{R%k$dZiPkz!{$dR$P!gQ%}%SR&z&mR!rdR!teR$Z!tS%a$Y%bR&t&WV%_$Y%b&WQ#PmR$g#PQ`OSkPzU!a`k$dR$d!{Q$p#aY%p$p%u&d&l'QQ%u$sQ&d%qQ&l%zR'Q&xQ#t!cQ#v!dQ#x!eV$}#t#v#xQ%X$RR&T%XQ%y$zS&k%y&yR&y&lQ%r$pR&e%rQ%n$mR&c%nQyUR#]yQ%i$aR&_%iQ!|jS$e!|$fR$f!}Q&n%}R&{&nQ#k!ZR$x#kQ%b$YR&Z%bQ&X%aR&u&X__OP`kz!{$d^UOP`kz!{$dQ!VYQ!WZQ#XuQ#YvQ#ZwQ#[xQ$]!vQ$m#`R&b%mR$q#aQ!gaQ!oc[#q!c!d!e#t#v#xQ$a!zd$o#a$p$s%q%u%z&d&l&x'QQ$r#cQ%R#{S%g$a%iQ%l$kQ&^%hR&p&P]#s!c!d!e#t#v#xW!Z]b!g$PQ!ufQ#f!YQ#l![Q$v#iQ$w#jQ$z#mS%V$R%XR&i%xQ#h!YQ%w$tR&w&hR$|#mR$n#`QlPR#_zQ!_]Q!nbQ$O!gR%U$P",nodeNames:" Unit VariableName VariableName QueryCallee Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector . ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue AtKeyword # ; ] [ BracketedValue } { BracedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee IfExpression if ArgList IfBranch KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp ComparisonQuery CompareOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector ParenthesizedSelector CallQuery ArgList , CallLiteral CallTag ParenthesizedContent PseudoClassName ArgList IdSelector IdName AttributeSelector AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp Block Declaration PropertyName Important ImportStatement import Layer layer LayerName layer MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList KeyframeSelector KeyframeRangeName SupportsStatement supports ScopeStatement scope to AtRule Styles",maxTerm:143,nodeProps:[["isolate",-2,5,36,""],["openedBy",20,"(",28,"[",31,"{"],["closedBy",21,")",29,"]",32,"}"]],propSources:[$Pe],skippedNodes:[0,5,106],repeatNodeCount:15,tokenData:"JQ~R!YOX$qX^%i^p$qpq%iqr({rs-ust/itu6Wuv$qvw7Qwx7cxy9Qyz9cz{9h{|:R|}>t}!O?V!O!P?t!P!Q@]!Q![AU![!]BP!]!^B{!^!_C^!_!`DY!`!aDm!a!b$q!b!cEn!c!}$q!}#OG{#O#P$q#P#QH^#Q#R6W#R#o$q#o#pHo#p#q6W#q#rIQ#r#sIc#s#y$q#y#z%i#z$f$q$f$g%i$g#BY$q#BY#BZ%i#BZ$IS$q$IS$I_%i$I_$I|$q$I|$JO%i$JO$JT$q$JT$JU%i$JU$KV$q$KV$KW%i$KW&FU$q&FU&FV%i&FV;'S$q;'S;=`Iz<%lO$q`$tSOy%Qz;'S%Q;'S;=`%c<%lO%Q`%VS!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Q`%fP;=`<%l%Q~%nh#s~OX%QX^'Y^p%Qpq'Yqy%Qz#y%Q#y#z'Y#z$f%Q$f$g'Y$g#BY%Q#BY#BZ'Y#BZ$IS%Q$IS$I_'Y$I_$I|%Q$I|$JO'Y$JO$JT%Q$JT$JU'Y$JU$KV%Q$KV$KW'Y$KW&FU%Q&FU&FV'Y&FV;'S%Q;'S;=`%c<%lO%Q~'ah#s~!a`OX%QX^'Y^p%Qpq'Yqy%Qz#y%Q#y#z'Y#z$f%Q$f$g'Y$g#BY%Q#BY#BZ'Y#BZ$IS%Q$IS$I_'Y$I_$I|%Q$I|$JO'Y$JO$JT%Q$JT$JU'Y$JU$KV%Q$KV$KW'Y$KW&FU%Q&FU&FV'Y&FV;'S%Q;'S;=`%c<%lO%Qj)OUOy%Qz#]%Q#]#^)b#^;'S%Q;'S;=`%c<%lO%Qj)gU!a`Oy%Qz#a%Q#a#b)y#b;'S%Q;'S;=`%c<%lO%Qj*OU!a`Oy%Qz#d%Q#d#e*b#e;'S%Q;'S;=`%c<%lO%Qj*gU!a`Oy%Qz#c%Q#c#d*y#d;'S%Q;'S;=`%c<%lO%Qj+OU!a`Oy%Qz#f%Q#f#g+b#g;'S%Q;'S;=`%c<%lO%Qj+gU!a`Oy%Qz#h%Q#h#i+y#i;'S%Q;'S;=`%c<%lO%Qj,OU!a`Oy%Qz#T%Q#T#U,b#U;'S%Q;'S;=`%c<%lO%Qj,gU!a`Oy%Qz#b%Q#b#c,y#c;'S%Q;'S;=`%c<%lO%Qj-OU!a`Oy%Qz#h%Q#h#i-b#i;'S%Q;'S;=`%c<%lO%Qj-iS!qY!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Q~-xWOY-uZr-urs.bs#O-u#O#P.g#P;'S-u;'S;=`/c<%lO-u~.gOt~~.jRO;'S-u;'S;=`.s;=`O-u~.vXOY-uZr-urs.bs#O-u#O#P.g#P;'S-u;'S;=`/c;=`<%l-u<%lO-u~/fP;=`<%l-uj/nYjYOy%Qz!Q%Q!Q![0^![!c%Q!c!i0^!i#T%Q#T#Z0^#Z;'S%Q;'S;=`%c<%lO%Qj0cY!a`Oy%Qz!Q%Q!Q![1R![!c%Q!c!i1R!i#T%Q#T#Z1R#Z;'S%Q;'S;=`%c<%lO%Qj1WY!a`Oy%Qz!Q%Q!Q![1v![!c%Q!c!i1v!i#T%Q#T#Z1v#Z;'S%Q;'S;=`%c<%lO%Qj1}YrY!a`Oy%Qz!Q%Q!Q![2m![!c%Q!c!i2m!i#T%Q#T#Z2m#Z;'S%Q;'S;=`%c<%lO%Qj2tYrY!a`Oy%Qz!Q%Q!Q![3d![!c%Q!c!i3d!i#T%Q#T#Z3d#Z;'S%Q;'S;=`%c<%lO%Qj3iY!a`Oy%Qz!Q%Q!Q![4X![!c%Q!c!i4X!i#T%Q#T#Z4X#Z;'S%Q;'S;=`%c<%lO%Qj4`YrY!a`Oy%Qz!Q%Q!Q![5O![!c%Q!c!i5O!i#T%Q#T#Z5O#Z;'S%Q;'S;=`%c<%lO%Qj5TY!a`Oy%Qz!Q%Q!Q![5s![!c%Q!c!i5s!i#T%Q#T#Z5s#Z;'S%Q;'S;=`%c<%lO%Qj5zSrY!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Qd6ZUOy%Qz!_%Q!_!`6m!`;'S%Q;'S;=`%c<%lO%Qd6tS!hS!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Qb7VSZQOy%Qz;'S%Q;'S;=`%c<%lO%Q~7fWOY7cZw7cwx.bx#O7c#O#P8O#P;'S7c;'S;=`8z<%lO7c~8RRO;'S7c;'S;=`8[;=`O7c~8_XOY7cZw7cwx.bx#O7c#O#P8O#P;'S7c;'S;=`8z;=`<%l7c<%lO7c~8}P;=`<%l7cj9VSeYOy%Qz;'S%Q;'S;=`%c<%lO%Q~9hOd~n9oUWQvWOy%Qz!_%Q!_!`6m!`;'S%Q;'S;=`%c<%lO%Qj:YWvW!mQOy%Qz!O%Q!O!P:r!P!Q%Q!Q![=w![;'S%Q;'S;=`%c<%lO%Qj:wU!a`Oy%Qz!Q%Q!Q![;Z![;'S%Q;'S;=`%c<%lO%Qj;bY!a`#}YOy%Qz!Q%Q!Q![;Z![!g%Q!g!h<Q!h#X%Q#X#Y<Q#Y;'S%Q;'S;=`%c<%lO%Qj<VY!a`Oy%Qz{%Q{|<u|}%Q}!O<u!O!Q%Q!Q![=^![;'S%Q;'S;=`%c<%lO%Qj<zU!a`Oy%Qz!Q%Q!Q![=^![;'S%Q;'S;=`%c<%lO%Qj=eU!a`#}YOy%Qz!Q%Q!Q![=^![;'S%Q;'S;=`%c<%lO%Qj>O[!a`#}YOy%Qz!O%Q!O!P;Z!P!Q%Q!Q![=w![!g%Q!g!h<Q!h#X%Q#X#Y<Q#Y;'S%Q;'S;=`%c<%lO%Qj>yS!^YOy%Qz;'S%Q;'S;=`%c<%lO%Qj?[WvWOy%Qz!O%Q!O!P:r!P!Q%Q!Q![=w![;'S%Q;'S;=`%c<%lO%Qj?yU]YOy%Qz!Q%Q!Q![;Z![;'S%Q;'S;=`%c<%lO%Q~@bTvWOy%Qz{@q{;'S%Q;'S;=`%c<%lO%Q~@xS!a`#t~Oy%Qz;'S%Q;'S;=`%c<%lO%QjAZ[#}YOy%Qz!O%Q!O!P;Z!P!Q%Q!Q![=w![!g%Q!g!h<Q!h#X%Q#X#Y<Q#Y;'S%Q;'S;=`%c<%lO%QjBUU`YOy%Qz![%Q![!]Bh!];'S%Q;'S;=`%c<%lO%QbBoSaQ!a`Oy%Qz;'S%Q;'S;=`%c<%lO%QjCQSkYOy%Qz;'S%Q;'S;=`%c<%lO%QhCcU!TWOy%Qz!_%Q!_!`Cu!`;'S%Q;'S;=`%c<%lO%QhC|S!TW!a`Oy%Qz;'S%Q;'S;=`%c<%lO%QlDaS!TW!hSOy%Qz;'S%Q;'S;=`%c<%lO%QjDtV!jQ!TWOy%Qz!_%Q!_!`Cu!`!aEZ!a;'S%Q;'S;=`%c<%lO%QbEbS!jQ!a`Oy%Qz;'S%Q;'S;=`%c<%lO%QjEqYOy%Qz}%Q}!OFa!O!c%Q!c!}GO!}#T%Q#T#oGO#o;'S%Q;'S;=`%c<%lO%QjFfW!a`Oy%Qz!c%Q!c!}GO!}#T%Q#T#oGO#o;'S%Q;'S;=`%c<%lO%QjGV[iY!a`Oy%Qz}%Q}!OGO!O!Q%Q!Q![GO![!c%Q!c!}GO!}#T%Q#T#oGO#o;'S%Q;'S;=`%c<%lO%QjHQSmYOy%Qz;'S%Q;'S;=`%c<%lO%QnHcSl^Oy%Qz;'S%Q;'S;=`%c<%lO%QjHtSpYOy%Qz;'S%Q;'S;=`%c<%lO%QjIVSoYOy%Qz;'S%Q;'S;=`%c<%lO%QfIhU!mQOy%Qz!_%Q!_!`6m!`;'S%Q;'S;=`%c<%lO%Q`I}P;=`<%l$q",tokenizers:[FPe,BPe,DPe,LPe,1,2,3,4,new CH("m~RRYZ[z{a~~g~aO#v~~dP!P!Qg~lO#w~~",28,129)],topRules:{StyleSheet:[0,6],Styles:[1,105]},specialized:[{term:124,get:t=>NPe[t]||-1},{term:125,get:t=>VPe[t]||-1},{term:4,get:t=>WPe[t]||-1},{term:25,get:t=>UPe[t]||-1},{term:123,get:t=>qPe[t]||-1}],tokenPrec:1963});let Wj=null;function Uj(){if(!Wj&&typeof document=="object"&&document.body){let{style:t}=document.body,e=[],r=new Set;for(let n in t)n!="cssText"&&n!="cssFloat"&&typeof t[n]=="string"&&(/[A-Z]/.test(n)&&(n=n.replace(/[A-Z]/g,i=>"-"+i.toLowerCase())),r.has(n)||(e.push(n),r.add(n)));Wj=e.sort().map(n=>({type:"property",label:n,apply:n+": "}))}return Wj||[]}const I6=["active","after","any-link","autofill","backdrop","before","checked","cue","default","defined","disabled","empty","enabled","file-selector-button","first","first-child","first-letter","first-line","first-of-type","focus","focus-visible","focus-within","fullscreen","has","host","host-context","hover","in-range","indeterminate","invalid","is","lang","last-child","last-of-type","left","link","marker","modal","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","part","placeholder","placeholder-shown","read-only","read-write","required","right","root","scope","selection","slotted","target","target-text","valid","visited","where"].map(t=>({type:"class",label:t})),R6=["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map(t=>({type:"keyword",label:t})).concat(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map(t=>({type:"constant",label:t}))),HPe=["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map(t=>({type:"type",label:t})),GPe=["@charset","@color-profile","@container","@counter-style","@font-face","@font-feature-values","@font-palette-values","@import","@keyframes","@layer","@media","@namespace","@page","@position-try","@property","@scope","@starting-style","@supports","@view-transition"].map(t=>({type:"keyword",label:t})),qu=/^(\w[\w-]*|-\w[\w-]*|)$/,XPe=/^-(-[\w-]*)?$/;function KPe(t,e){var r;if((t.name=="("||t.type.isError)&&(t=t.parent||t),t.name!="ArgList")return!1;let n=(r=t.parent)===null||r===void 0?void 0:r.firstChild;return(n==null?void 0:n.name)!="Callee"?!1:e.sliceString(n.from,n.to)=="var"}const D6=new _2e,ZPe=["Declaration"];function YPe(t){for(let e=t;;){if(e.type.isTop)return e;if(!(e=e.parent))return t}}function BH(t,e,r){if(e.to-e.from>4096){let n=D6.get(e);if(n)return n;let i=[],s=new Set,a=e.cursor(Ci.IncludeAnonymous);if(a.firstChild())do for(let o of BH(t,a.node,r))s.has(o.label)||(s.add(o.label),i.push(o));while(a.nextSibling());return D6.set(e,i),i}else{let n=[],i=new Set;return e.cursor().iterate(s=>{var a;if(r(s)&&s.matchContext(ZPe)&&((a=s.node.nextSibling)===null||a===void 0?void 0:a.name)==":"){let o=t.sliceString(s.from,s.to);i.has(o)||(i.add(o),n.push({label:o,type:"variable"}))}}),n}}const JPe=t=>e=>{let{state:r,pos:n}=e,i=Hi(r).resolveInner(n,-1),s=i.type.isError&&i.from==i.to-1&&r.doc.sliceString(i.from,i.to)=="-";if(i.name=="PropertyName"||(s||i.name=="TagName")&&/^(Block|Styles)$/.test(i.resolve(i.to).name))return{from:i.from,options:Uj(),validFor:qu};if(i.name=="ValueName")return{from:i.from,options:R6,validFor:qu};if(i.name=="PseudoClassName")return{from:i.from,options:I6,validFor:qu};if(t(i)||(e.explicit||s)&&KPe(i,r.doc))return{from:t(i)||s?i.from:n,options:BH(r.doc,YPe(i),t),validFor:XPe};if(i.name=="TagName"){for(let{parent:d}=i;d;d=d.parent)if(d.name=="Block")return{from:i.from,options:Uj(),validFor:qu};return{from:i.from,options:HPe,validFor:qu}}if(i.name=="AtKeyword")return{from:i.from,options:GPe,validFor:qu};if(!e.explicit)return null;let a=i.resolve(n),o=a.childBefore(n);return o&&o.name==":"&&a.name=="PseudoClassSelector"?{from:n,options:I6,validFor:qu}:o&&o.name==":"&&a.name=="Declaration"||a.name=="ArgList"?{from:n,options:R6,validFor:qu}:a.name=="Block"||a.name=="Styles"?{from:n,options:Uj(),validFor:qu}:null},eAe=JPe(t=>t.name=="VariableName"),L6=h0.define({name:"css",parser:QPe.configure({props:[SC.add({Declaration:aQ()}),kC.add({"Block KeyframeList":Q2e})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});function tAe(){return new oI(L6,L6.data.of({autocomplete:eAe}))}const Qw=`<?xml version="1.0" encoding="UTF-8"?>
<StyledLayerDescriptor version="1.0.0"
  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"
  xmlns="http://www.opengis.net/sld"
  xmlns:ogc="http://www.opengis.net/ogc"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <NamedLayer>
    <Name>NewStyle</Name>
    <UserStyle>
      <Title>New Style</Title>
      <FeatureTypeStyle>
        <Rule>
          <Name>Default</Name>
          <PolygonSymbolizer>
            <Fill>
              <CssParameter name="fill">#3388ff</CssParameter>
              <CssParameter name="fill-opacity">0.6</CssParameter>
            </Fill>
            <Stroke>
              <CssParameter name="stroke">#2266cc</CssParameter>
              <CssParameter name="stroke-width">1</CssParameter>
            </Stroke>
          </PolygonSymbolizer>
        </Rule>
      </FeatureTypeStyle>
    </UserStyle>
  </NamedLayer>
</StyledLayerDescriptor>`,rAe=`/* GeoServer CSS Style */
* {
  fill: #3388ff;
  fill-opacity: 0.6;
  stroke: #2266cc;
  stroke-width: 1;
}`,qj={"blue-to-red":["#2166ac","#67a9cf","#d1e5f0","#fddbc7","#ef8a62","#b2182b"],"green-to-red":["#1a9850","#91cf60","#d9ef8b","#fee08b","#fc8d59","#d73027"],viridis:["#440154","#443983","#31688e","#21918c","#35b779","#fde725"],spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"]},kg={rainbow:{name:"Rainbow",description:"Classic rainbow spectrum",colors:["#9400D3","#4B0082","#0000FF","#00FF00","#FFFF00","#FF7F00","#FF0000"]},terrain:{name:"Terrain",description:"Natural terrain colors (blue-green-brown)",colors:["#0000FF","#00FFFF","#00FF00","#FFFF00","#FF8C00","#8B4513","#FFFFFF"]},elevation:{name:"Elevation",description:"DEM/elevation visualization",colors:["#006400","#228B22","#90EE90","#FFFF00","#FFA500","#8B4513","#FFFFFF"]},temperature:{name:"Temperature",description:"Cold to hot temperature scale",colors:["#0000FF","#00BFFF","#00FFFF","#FFFF00","#FFA500","#FF0000","#8B0000"]},ndvi:{name:"NDVI",description:"Vegetation index (brown-yellow-green)",colors:["#8B4513","#D2691E","#FFD700","#ADFF2F","#32CD32","#006400"]},bathymetry:{name:"Bathymetry",description:"Ocean depth visualization",colors:["#000033","#000066","#0000CC","#0066FF","#00CCFF","#99FFFF"]},grayscale:{name:"Grayscale",description:"Black to white gradient",colors:["#000000","#333333","#666666","#999999","#CCCCCC","#FFFFFF"]},magma:{name:"Magma",description:"Dark purple to bright yellow",colors:["#000004","#3B0F70","#8C2981","#DE4968","#FE9F6D","#FCFDBF"]},plasma:{name:"Plasma",description:"Blue-purple to yellow",colors:["#0D0887","#6A00A8","#B12A90","#E16462","#FCA636","#F0F921"]},inferno:{name:"Inferno",description:"Black through red to bright yellow",colors:["#000004","#420A68","#932667","#DD513A","#FCA50A","#FCFFA4"]}},F6=[{name:"Default",azimuth:315,altitude:45,zFactor:1},{name:"Morning Light",azimuth:90,altitude:30,zFactor:1},{name:"Evening Light",azimuth:270,altitude:30,zFactor:1},{name:"High Contrast",azimuth:315,altitude:60,zFactor:2},{name:"Subtle",azimuth:315,altitude:45,zFactor:.5}];function B6(t,e,r,n,i="ramp",s=1){const a=n-r,o=e.map((d,m)=>{const y=r+a*m/(e.length-1);return`          <ColorMapEntry color="${d}" quantity="${y.toFixed(2)}" opacity="${s}" />`}).join(`
`);return`<?xml version="1.0" encoding="UTF-8"?>
<StyledLayerDescriptor version="1.0.0"
  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"
  xmlns="http://www.opengis.net/sld"
  xmlns:ogc="http://www.opengis.net/ogc"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <NamedLayer>
    <Name>${t}</Name>
    <UserStyle>
      <Title>${t} - Raster Color Map</Title>
      <FeatureTypeStyle>
        <Rule>
          <RasterSymbolizer>
            <Opacity>${s}</Opacity>
            <ColorMap type="${i}">
${o}
            </ColorMap>
          </RasterSymbolizer>
        </Rule>
      </FeatureTypeStyle>
    </UserStyle>
  </NamedLayer>
</StyledLayerDescriptor>`}function nAe(t,e=315,r=45,n=1,i=1){return`<?xml version="1.0" encoding="UTF-8"?>
<StyledLayerDescriptor version="1.0.0"
  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"
  xmlns="http://www.opengis.net/sld"
  xmlns:ogc="http://www.opengis.net/ogc"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <NamedLayer>
    <Name>${t}</Name>
    <UserStyle>
      <Title>${t} - Hillshade</Title>
      <FeatureTypeStyle>
        <Rule>
          <RasterSymbolizer>
            <Opacity>${i}</Opacity>
            <ShadedRelief>
              <BrightnessOnly>false</BrightnessOnly>
              <ReliefFactor>${n}</ReliefFactor>
            </ShadedRelief>
            <VendorOption name="algorithm">zevenbergenThorne</VendorOption>
            <VendorOption name="azimuth">${e}</VendorOption>
            <VendorOption name="altitude">${r}</VendorOption>
          </RasterSymbolizer>
        </Rule>
      </FeatureTypeStyle>
    </UserStyle>
  </NamedLayer>
</StyledLayerDescriptor>`}function iAe(t,e,r,n,i=315,s=45,a=1,o=1){const d=n-r,m=e.map((y,v)=>{const w=r+d*v/(e.length-1);return`          <ColorMapEntry color="${y}" quantity="${w.toFixed(2)}" />`}).join(`
`);return`<?xml version="1.0" encoding="UTF-8"?>
<StyledLayerDescriptor version="1.0.0"
  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"
  xmlns="http://www.opengis.net/sld"
  xmlns:ogc="http://www.opengis.net/ogc"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <NamedLayer>
    <Name>${t}</Name>
    <UserStyle>
      <Title>${t} - Hillshade with Color</Title>
      <FeatureTypeStyle>
        <Rule>
          <RasterSymbolizer>
            <Opacity>${o}</Opacity>
            <ColorMap type="ramp">
${m}
            </ColorMap>
            <ShadedRelief>
              <BrightnessOnly>false</BrightnessOnly>
              <ReliefFactor>${a}</ReliefFactor>
            </ShadedRelief>
            <VendorOption name="algorithm">zevenbergenThorne</VendorOption>
            <VendorOption name="azimuth">${i}</VendorOption>
            <VendorOption name="altitude">${s}</VendorOption>
          </RasterSymbolizer>
        </Rule>
      </FeatureTypeStyle>
    </UserStyle>
  </NamedLayer>
</StyledLayerDescriptor>`}function sAe(t,e="normalize",r=1,n=1){const i=e==="none"?"":`
            <ContrastEnhancement>
              <${e==="normalize"?"Normalize":"Histogram"} />
              <GammaValue>${r}</GammaValue>
            </ContrastEnhancement>`;return`<?xml version="1.0" encoding="UTF-8"?>
<StyledLayerDescriptor version="1.0.0"
  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"
  xmlns="http://www.opengis.net/sld"
  xmlns:ogc="http://www.opengis.net/ogc"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <NamedLayer>
    <Name>${t}</Name>
    <UserStyle>
      <Title>${t} - Enhanced</Title>
      <FeatureTypeStyle>
        <Rule>
          <RasterSymbolizer>
            <Opacity>${n}</Opacity>${i}
          </RasterSymbolizer>
        </Rule>
      </FeatureTypeStyle>
    </UserStyle>
  </NamedLayer>
</StyledLayerDescriptor>`}function XE(t,e){const r=Math.min(...t),i=(Math.max(...t)-r)/e,s=[];for(let a=0;a<=e;a++)s.push(r+a*i);return s}function oAe(t,e){const r=[...t].sort((i,s)=>i-s),n=[];for(let i=0;i<=e;i++){const s=Math.floor(i/e*(r.length-1));n.push(r[s])}return n}function aAe(t,e){const r=[...t].sort((s,a)=>s-a);if(r.length<=e)return r;const i=XE(t,e);for(let s=0;s<10;s++){const a=[];for(let o=0;o<e;o++){const d=i[o],m=i[o+1],y=r.filter(v=>v>=d&&(o===e-1?v<=m:v<m));y.length>0?a.push(y.reduce((v,w)=>v+w,0)/y.length):a.push((d+m)/2)}for(let o=1;o<e;o++)i[o]=(a[o-1]+a[o])/2}return i}function lAe(t,e){const r=Math.min(...t),s=(Math.max(...t)-r)/e,a=Math.pow(10,Math.floor(Math.log10(s))),o=s/a;let d;o<=1?d=1*a:o<=2?d=2*a:o<=5?d=5*a:d=10*a;const m=Math.floor(r/d)*d,y=[];for(let v=0;v<=e;v++)y.push(m+v*d);return y}function cAe(t,e,r){switch(r){case"equal-interval":return XE(t,e);case"quantile":return oAe(t,e);case"jenks":return aAe(t,e);case"pretty":return lAe(t,e);default:return XE(t,e)}}function $6(t,e){if(e<=t.length){const r=[];for(let n=0;n<e;n++){const i=Math.floor(n/(e-1)*(t.length-1));r.push(t[i])}return r}return t.slice(0,e)}function uAe(t,e,r,n,i){const s=r.slice(0,-1).map((a,o)=>{const d=r[o+1],m=n[o]||n[n.length-1],y=`${a.toFixed(2)} - ${d.toFixed(2)}`;let v="";return i==="polygon"?v=`
            <PolygonSymbolizer>
              <Fill>
                <CssParameter name="fill">${m}</CssParameter>
                <CssParameter name="fill-opacity">0.8</CssParameter>
              </Fill>
              <Stroke>
                <CssParameter name="stroke">#333333</CssParameter>
                <CssParameter name="stroke-width">0.5</CssParameter>
              </Stroke>
            </PolygonSymbolizer>`:i==="line"?v=`
            <LineSymbolizer>
              <Stroke>
                <CssParameter name="stroke">${m}</CssParameter>
                <CssParameter name="stroke-width">2</CssParameter>
              </Stroke>
            </LineSymbolizer>`:v=`
            <PointSymbolizer>
              <Graphic>
                <Mark>
                  <WellKnownName>circle</WellKnownName>
                  <Fill>
                    <CssParameter name="fill">${m}</CssParameter>
                  </Fill>
                  <Stroke>
                    <CssParameter name="stroke">#333333</CssParameter>
                    <CssParameter name="stroke-width">1</CssParameter>
                  </Stroke>
                </Mark>
                <Size>8</Size>
              </Graphic>
            </PointSymbolizer>`,`
          <Rule>
            <Name>${y}</Name>
            <Title>${y}</Title>
            <ogc:Filter>
              <ogc:And>
                <ogc:PropertyIsGreaterThanOrEqualTo>
                  <ogc:PropertyName>${e}</ogc:PropertyName>
                  <ogc:Literal>${a}</ogc:Literal>
                </ogc:PropertyIsGreaterThanOrEqualTo>
                <ogc:PropertyIsLessThan>
                  <ogc:PropertyName>${e}</ogc:PropertyName>
                  <ogc:Literal>${d}</ogc:Literal>
                </ogc:PropertyIsLessThan>
              </ogc:And>
            </ogc:Filter>${v}
          </Rule>`}).join("");return`<?xml version="1.0" encoding="UTF-8"?>
<StyledLayerDescriptor version="1.0.0"
  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"
  xmlns="http://www.opengis.net/sld"
  xmlns:ogc="http://www.opengis.net/ogc"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <NamedLayer>
    <Name>${t}</Name>
    <UserStyle>
      <Title>${t} - Classified</Title>
      <FeatureTypeStyle>${s}
      </FeatureTypeStyle>
    </UserStyle>
  </NamedLayer>
</StyledLayerDescriptor>`}const Qj=[{name:"Ocean Drop",description:"Deep blue with soft glow",icon:"",shape:"circle",fill:"#0077be",fillOpacity:.9,stroke:"#004d80",strokeWidth:2,size:12,haloColor:"#87ceeb",haloRadius:3},{name:"Sunset Glow",description:"Warm orange with golden halo",icon:"",shape:"circle",fill:"#ff6b35",fillOpacity:.95,stroke:"#cc4400",strokeWidth:2,size:14,haloColor:"#ffd700",haloRadius:4},{name:"Forest Emerald",description:"Rich green nature marker",icon:"",shape:"circle",fill:"#228b22",fillOpacity:.9,stroke:"#145214",strokeWidth:2,size:12,haloColor:"#90ee90",haloRadius:3},{name:"Royal Purple",description:"Elegant purple with silver edge",icon:"",shape:"circle",fill:"#8b008b",fillOpacity:.9,stroke:"#c0c0c0",strokeWidth:2,size:12,haloColor:"#dda0dd",haloRadius:3},{name:"Cherry Blossom",description:"Soft pink with delicate outline",icon:"",shape:"circle",fill:"#ffb7c5",fillOpacity:.95,stroke:"#ff69b4",strokeWidth:1.5,size:11,haloColor:"#fff0f5",haloRadius:2},{name:"Diamond Marker",description:"Classic diamond shape",icon:"",shape:"square",fill:"#00bfff",fillOpacity:.85,stroke:"#0080ff",strokeWidth:2,size:14,rotation:45},{name:"Golden Star",description:"Bright star for highlights",icon:"",shape:"star",fill:"#ffd700",fillOpacity:1,stroke:"#b8860b",strokeWidth:1.5,size:16},{name:"Ruby Triangle",description:"Bold triangular marker",icon:"",shape:"triangle",fill:"#dc143c",fillOpacity:.9,stroke:"#8b0000",strokeWidth:2,size:14},{name:"Navy Square",description:"Professional square marker",icon:"",shape:"square",fill:"#1e3a5f",fillOpacity:.95,stroke:"#0d1b2a",strokeWidth:2,size:12},{name:"Neon Pulse",description:"Bright neon with glow effect",icon:"",shape:"circle",fill:"#00ff88",fillOpacity:1,stroke:"#00cc6a",strokeWidth:1,size:10,haloColor:"#00ff88",haloRadius:6},{name:"Fire Ember",description:"Hot red with orange glow",icon:"",shape:"circle",fill:"#ff4500",fillOpacity:.95,stroke:"#8b0000",strokeWidth:2,size:12,haloColor:"#ff8c00",haloRadius:4},{name:"Ice Crystal",description:"Cool blue with frost effect",icon:"",shape:"star",fill:"#e0ffff",fillOpacity:.9,stroke:"#00ced1",strokeWidth:1.5,size:14,haloColor:"#b0e0e6",haloRadius:3},{name:"Midnight Shadow",description:"Dark with subtle shadow",icon:"",shape:"circle",fill:"#2c3e50",fillOpacity:.95,stroke:"#1a252f",strokeWidth:2,size:12,haloColor:"#34495e",haloRadius:4},{name:"Coral Reef",description:"Vibrant coral with aqua edge",icon:"",shape:"circle",fill:"#ff7f50",fillOpacity:.9,stroke:"#20b2aa",strokeWidth:2,size:12,haloColor:"#40e0d0",haloRadius:3},{name:"Map Pin Red",description:"Classic red location pin",icon:"",shape:"circle",fill:"#e74c3c",fillOpacity:1,stroke:"#c0392b",strokeWidth:2,size:14,haloColor:"#ffffff",haloRadius:2},{name:"Corporate Blue",description:"Clean professional blue",icon:"",shape:"circle",fill:"#3498db",fillOpacity:.95,stroke:"#2980b9",strokeWidth:2,size:12},{name:"Success Green",description:"Positive indicator marker",icon:"",shape:"circle",fill:"#27ae60",fillOpacity:.95,stroke:"#1e8449",strokeWidth:2,size:12},{name:"Warning Amber",description:"Attention-grabbing yellow",icon:"",shape:"triangle",fill:"#f39c12",fillOpacity:1,stroke:"#d68910",strokeWidth:2,size:14},{name:"Cross Mark",description:"X marker for exclusions",icon:"",shape:"cross",fill:"#e74c3c",fillOpacity:1,stroke:"#c0392b",strokeWidth:2,size:14},{name:"Target Bullseye",description:"Precision crosshair marker",icon:"",shape:"cross",fill:"#2c3e50",fillOpacity:1,stroke:"#e74c3c",strokeWidth:3,size:16}];function Yx(t){const e=[];try{new DOMParser().parseFromString(t,"text/xml").querySelectorAll("Rule").forEach((s,a)=>{const o=s.querySelector("Name"),d={name:(o==null?void 0:o.textContent)||`Rule ${a+1}`,symbolizer:{type:"polygon"}},m=s.querySelector("PolygonSymbolizer");m&&(d.symbolizer.type="polygon",m.querySelectorAll("Fill CssParameter").forEach(P=>{const E=P.getAttribute("name");E==="fill"&&(d.symbolizer.fill=P.textContent||"#3388ff"),E==="fill-opacity"&&(d.symbolizer.fillOpacity=parseFloat(P.textContent||"1"))}),m.querySelectorAll("Stroke CssParameter").forEach(P=>{const E=P.getAttribute("name");E==="stroke"&&(d.symbolizer.stroke=P.textContent||"#2266cc"),E==="stroke-width"&&(d.symbolizer.strokeWidth=parseFloat(P.textContent||"1")),E==="stroke-opacity"&&(d.symbolizer.strokeOpacity=parseFloat(P.textContent||"1"))}));const y=s.querySelector("LineSymbolizer");y&&(d.symbolizer.type="line",y.querySelectorAll("Stroke CssParameter").forEach(O=>{const P=O.getAttribute("name");P==="stroke"&&(d.symbolizer.stroke=O.textContent||"#3388ff"),P==="stroke-width"&&(d.symbolizer.strokeWidth=parseFloat(O.textContent||"2")),P==="stroke-opacity"&&(d.symbolizer.strokeOpacity=parseFloat(O.textContent||"1"))}));const v=s.querySelector("PointSymbolizer");if(v){d.symbolizer.type="point",d.symbolizer.pointShape="circle",d.symbolizer.pointSize=8,v.querySelectorAll("Fill CssParameter").forEach(E=>{const $=E.getAttribute("name");$==="fill"&&(d.symbolizer.fill=E.textContent||"#3388ff"),$==="fill-opacity"&&(d.symbolizer.fillOpacity=parseFloat(E.textContent||"1"))}),v.querySelectorAll("Stroke CssParameter").forEach(E=>{const $=E.getAttribute("name");$==="stroke"&&(d.symbolizer.stroke=E.textContent||"#2266cc"),$==="stroke-width"&&(d.symbolizer.strokeWidth=parseFloat(E.textContent||"1"))});const P=v.querySelector("Size");P&&(d.symbolizer.pointSize=parseFloat(P.textContent||"8"))}e.push(d)})}catch(r){console.error("Failed to parse SLD:",r)}return e.length>0?e:[{name:"Default",symbolizer:{type:"polygon",fill:"#3388ff",fillOpacity:.6,stroke:"#2266cc",strokeWidth:1}}]}function hAe(t,e){let r="";return e.forEach(n=>{let i="";if(n.symbolizer.type==="polygon")i=`
          <PolygonSymbolizer>
            <Fill>
              <CssParameter name="fill">${n.symbolizer.fill||"#3388ff"}</CssParameter>
              <CssParameter name="fill-opacity">${n.symbolizer.fillOpacity??.6}</CssParameter>
            </Fill>
            <Stroke>
              <CssParameter name="stroke">${n.symbolizer.stroke||"#2266cc"}</CssParameter>
              <CssParameter name="stroke-width">${n.symbolizer.strokeWidth||1}</CssParameter>
            </Stroke>
          </PolygonSymbolizer>`;else if(n.symbolizer.type==="line")i=`
          <LineSymbolizer>
            <Stroke>
              <CssParameter name="stroke">${n.symbolizer.stroke||"#3388ff"}</CssParameter>
              <CssParameter name="stroke-width">${n.symbolizer.strokeWidth||2}</CssParameter>
              <CssParameter name="stroke-opacity">${n.symbolizer.strokeOpacity??1}</CssParameter>
            </Stroke>
          </LineSymbolizer>`;else if(n.symbolizer.type==="point"){const s=n.symbolizer.rotation?`
              <Rotation>${n.symbolizer.rotation}</Rotation>`:"";let a=`
          <PointSymbolizer>
            <Graphic>
              <Mark>
                <WellKnownName>${n.symbolizer.pointShape||"circle"}</WellKnownName>
                <Fill>
                  <CssParameter name="fill">${n.symbolizer.fill||"#3388ff"}</CssParameter>
                  <CssParameter name="fill-opacity">${n.symbolizer.fillOpacity??1}</CssParameter>
                </Fill>
                <Stroke>
                  <CssParameter name="stroke">${n.symbolizer.stroke||"#2266cc"}</CssParameter>
                  <CssParameter name="stroke-width">${n.symbolizer.strokeWidth||1}</CssParameter>
                </Stroke>
              </Mark>
              <Size>${n.symbolizer.pointSize||8}</Size>${s}
            </Graphic>
          </PointSymbolizer>`;if(n.symbolizer.haloColor&&n.symbolizer.haloRadius){const o=(n.symbolizer.pointSize||8)+n.symbolizer.haloRadius*2;i=`
          <PointSymbolizer>
            <Graphic>
              <Mark>
                <WellKnownName>${n.symbolizer.pointShape||"circle"}</WellKnownName>
                <Fill>
                  <CssParameter name="fill">${n.symbolizer.haloColor}</CssParameter>
                  <CssParameter name="fill-opacity">0.4</CssParameter>
                </Fill>
              </Mark>
              <Size>${o}</Size>${s}
            </Graphic>
          </PointSymbolizer>`+a}else i=a}r+=`
        <Rule>
          <Name>${n.name}</Name>${i}
        </Rule>`}),`<?xml version="1.0" encoding="UTF-8"?>
<StyledLayerDescriptor version="1.0.0"
  xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"
  xmlns="http://www.opengis.net/sld"
  xmlns:ogc="http://www.opengis.net/ogc"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <NamedLayer>
    <Name>${t}</Name>
    <UserStyle>
      <Title>${t}</Title>
      <FeatureTypeStyle>${r}
      </FeatureTypeStyle>
    </UserStyle>
  </NamedLayer>
</StyledLayerDescriptor>`}function Hj({value:t,onChange:e,label:r}){const n=Bt("gray.200","gray.600");return u.jsxs(Ot,{children:[u.jsx(jt,{fontSize:"sm",children:r}),u.jsxs(fe,{children:[u.jsxs(ue,{position:"relative",children:[u.jsx(ue,{w:"40px",h:"40px",borderRadius:"full",bg:t,border:"2px solid",borderColor:n,cursor:"pointer",_hover:{borderColor:"kartoza.400"},transition:"border-color 0.2s"}),u.jsx(Ar,{type:"color",value:t,onChange:i=>e(i.target.value),position:"absolute",top:0,left:0,w:"40px",h:"40px",opacity:0,cursor:"pointer"})]}),u.jsx(Ar,{value:t,onChange:i=>e(i.target.value),size:"sm",w:"100px",fontFamily:"mono",borderColor:n})]})]})}function dAe({rule:t,onChange:e,onDelete:r}){const n=Bt("white","gray.800"),i=Bt("gray.200","gray.600"),[s,a]=I.useState(!1),o=d=>{e({...t,symbolizer:{...t.symbolizer,...d}})};return u.jsx(ue,{p:4,bg:n,borderRadius:"lg",border:"1px solid",borderColor:i,children:u.jsxs(lt,{spacing:4,align:"stretch",children:[u.jsxs(fe,{justify:"space-between",children:[u.jsxs(Ot,{maxW:"200px",children:[u.jsx(jt,{fontSize:"sm",children:"Rule Name"}),u.jsx(Ar,{size:"sm",value:t.name,onChange:d=>e({...t,name:d.target.value})})]}),u.jsxs(Ot,{maxW:"150px",children:[u.jsx(jt,{fontSize:"sm",children:"Geometry Type"}),u.jsxs(zn,{size:"sm",value:t.symbolizer.type,onChange:d=>o({type:d.target.value}),children:[u.jsx("option",{value:"polygon",children:"Polygon"}),u.jsx("option",{value:"line",children:"Line"}),u.jsx("option",{value:"point",children:"Point"})]})]}),u.jsx(gr,{"aria-label":"Delete rule",icon:u.jsx(eU,{}),size:"sm",colorScheme:"red",variant:"ghost",onClick:r})]}),u.jsx(Nr,{}),(t.symbolizer.type==="polygon"||t.symbolizer.type==="point")&&u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"600",fontSize:"sm",mb:2,children:"Fill"}),u.jsxs(fe,{spacing:4,wrap:"wrap",children:[u.jsx(Hj,{label:"Color",value:t.symbolizer.fill||"#3388ff",onChange:d=>o({fill:d})}),u.jsxs(Ot,{maxW:"150px",children:[u.jsx(jt,{fontSize:"sm",children:"Opacity"}),u.jsxs(fe,{children:[u.jsxs(Tl,{value:t.symbolizer.fillOpacity??1,min:0,max:1,step:.1,onChange:d=>o({fillOpacity:d}),children:[u.jsx(jl,{children:u.jsx(Pl,{bg:"kartoza.500"})}),u.jsx(Ol,{})]}),u.jsxs(J,{fontSize:"sm",w:"40px",children:[((t.symbolizer.fillOpacity??1)*100).toFixed(0),"%"]})]})]})]})]}),u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"600",fontSize:"sm",mb:2,children:"Stroke"}),u.jsxs(fe,{spacing:4,wrap:"wrap",children:[u.jsx(Hj,{label:"Color",value:t.symbolizer.stroke||"#2266cc",onChange:d=>o({stroke:d})}),u.jsxs(Ot,{maxW:"100px",children:[u.jsx(jt,{fontSize:"sm",children:"Width"}),u.jsxs(Wp,{size:"sm",value:t.symbolizer.strokeWidth||1,min:0,max:20,step:.5,onChange:(d,m)=>o({strokeWidth:m}),children:[u.jsx(qp,{}),u.jsxs(Up,{children:[u.jsx(Hp,{}),u.jsx(Qp,{})]})]})]}),t.symbolizer.type==="line"&&u.jsxs(Ot,{maxW:"150px",children:[u.jsx(jt,{fontSize:"sm",children:"Opacity"}),u.jsxs(fe,{children:[u.jsxs(Tl,{value:t.symbolizer.strokeOpacity??1,min:0,max:1,step:.1,onChange:d=>o({strokeOpacity:d}),children:[u.jsx(jl,{children:u.jsx(Pl,{bg:"kartoza.500"})}),u.jsx(Ol,{})]}),u.jsxs(J,{fontSize:"sm",w:"40px",children:[((t.symbolizer.strokeOpacity??1)*100).toFixed(0),"%"]})]})]})]})]}),t.symbolizer.type==="point"&&u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"600",fontSize:"sm",mb:2,children:"Point Symbol"}),u.jsxs(ue,{mb:4,children:[u.jsx(J,{fontSize:"xs",color:"gray.500",mb:2,children:"Quick Presets"}),u.jsx(yr,{flexWrap:"wrap",gap:2,children:Qj.slice(0,10).map(d=>u.jsx(ue,{title:`${d.name}: ${d.description}`,cursor:"pointer",p:1,borderRadius:"md",border:"2px solid",borderColor:t.symbolizer.fill===d.fill&&t.symbolizer.pointShape===d.shape?"kartoza.500":"transparent",_hover:{borderColor:"kartoza.300",bg:"gray.50"},onClick:()=>{o({pointShape:d.shape,fill:d.fill,fillOpacity:d.fillOpacity,stroke:d.stroke,strokeWidth:d.strokeWidth,pointSize:d.size,haloColor:d.haloColor,haloRadius:d.haloRadius,rotation:d.rotation})},children:u.jsxs(ue,{w:"28px",h:"28px",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",children:[d.haloColor&&u.jsx(ue,{position:"absolute",w:`${d.size+(d.haloRadius||0)*2}px`,h:`${d.size+(d.haloRadius||0)*2}px`,borderRadius:d.shape==="circle"?"50%":d.shape==="triangle"?"0":"sm",bg:d.haloColor,opacity:.4,transform:d.rotation?`rotate(${d.rotation}deg)`:void 0,style:{clipPath:d.shape==="triangle"?"polygon(50% 0%, 0% 100%, 100% 100%)":void 0}}),u.jsx(ue,{position:"relative",w:`${d.size}px`,h:`${d.size}px`,borderRadius:d.shape==="circle"?"50%":d.shape==="triangle"?"0":"sm",bg:d.fill,opacity:d.fillOpacity,border:`${d.strokeWidth}px solid ${d.stroke}`,transform:d.rotation?`rotate(${d.rotation}deg)`:void 0,style:{clipPath:d.shape==="triangle"?"polygon(50% 0%, 0% 100%, 100% 100%)":d.shape==="star"?"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)":d.shape==="cross"?"polygon(35% 0%, 65% 0%, 65% 35%, 100% 35%, 100% 65%, 65% 65%, 65% 100%, 35% 100%, 35% 65%, 0% 65%, 0% 35%, 35% 35%)":void 0}})]})},d.name))}),u.jsx(bc,{in:s,animateOpacity:!0,children:u.jsx(yr,{flexWrap:"wrap",gap:2,mt:2,children:Qj.slice(10).map(d=>u.jsx(ue,{title:`${d.name}: ${d.description}`,cursor:"pointer",p:1,borderRadius:"md",border:"2px solid",borderColor:t.symbolizer.fill===d.fill&&t.symbolizer.pointShape===d.shape?"kartoza.500":"transparent",_hover:{borderColor:"kartoza.300",bg:"gray.50"},onClick:()=>{o({pointShape:d.shape,fill:d.fill,fillOpacity:d.fillOpacity,stroke:d.stroke,strokeWidth:d.strokeWidth,pointSize:d.size,haloColor:d.haloColor,haloRadius:d.haloRadius,rotation:d.rotation})},children:u.jsxs(ue,{w:"28px",h:"28px",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",children:[d.haloColor&&u.jsx(ue,{position:"absolute",w:`${d.size+(d.haloRadius||0)*2}px`,h:`${d.size+(d.haloRadius||0)*2}px`,borderRadius:d.shape==="circle"?"50%":d.shape==="triangle"?"0":"sm",bg:d.haloColor,opacity:.4,transform:d.rotation?`rotate(${d.rotation}deg)`:void 0,style:{clipPath:d.shape==="triangle"?"polygon(50% 0%, 0% 100%, 100% 100%)":void 0}}),u.jsx(ue,{position:"relative",w:`${d.size}px`,h:`${d.size}px`,borderRadius:d.shape==="circle"?"50%":d.shape==="triangle"?"0":"sm",bg:d.fill,opacity:d.fillOpacity,border:`${d.strokeWidth}px solid ${d.stroke}`,transform:d.rotation?`rotate(${d.rotation}deg)`:void 0,style:{clipPath:d.shape==="triangle"?"polygon(50% 0%, 0% 100%, 100% 100%)":d.shape==="star"?"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)":d.shape==="cross"?"polygon(35% 0%, 65% 0%, 65% 35%, 100% 35%, 100% 65%, 65% 65%, 65% 100%, 35% 100%, 35% 65%, 0% 65%, 0% 35%, 35% 35%)":void 0}})]})},d.name))})}),u.jsx(gt,{size:"xs",variant:"ghost",mt:2,onClick:()=>a(!s),rightIcon:u.jsx(ze,{as:s?i0:Ul}),children:s?"Show Less":`Show ${Qj.length-10} More`})]}),u.jsx(Nr,{my:3}),u.jsxs(fe,{spacing:4,wrap:"wrap",children:[u.jsxs(Ot,{maxW:"150px",children:[u.jsx(jt,{fontSize:"sm",children:"Shape"}),u.jsxs(zn,{size:"sm",value:t.symbolizer.pointShape||"circle",onChange:d=>o({pointShape:d.target.value}),children:[u.jsx("option",{value:"circle",children:"Circle"}),u.jsx("option",{value:"square",children:"Square"}),u.jsx("option",{value:"triangle",children:"Triangle"}),u.jsx("option",{value:"star",children:"Star"}),u.jsx("option",{value:"cross",children:"Cross"}),u.jsx("option",{value:"x",children:"X"})]})]}),u.jsxs(Ot,{maxW:"100px",children:[u.jsx(jt,{fontSize:"sm",children:"Size"}),u.jsxs(Wp,{size:"sm",value:t.symbolizer.pointSize||8,min:1,max:50,onChange:(d,m)=>o({pointSize:m}),children:[u.jsx(qp,{}),u.jsxs(Up,{children:[u.jsx(Hp,{}),u.jsx(Qp,{})]})]})]}),u.jsxs(Ot,{maxW:"100px",children:[u.jsx(jt,{fontSize:"sm",children:"Rotation"}),u.jsxs(Wp,{size:"sm",value:t.symbolizer.rotation||0,min:0,max:360,step:15,onChange:(d,m)=>o({rotation:m}),children:[u.jsx(qp,{}),u.jsxs(Up,{children:[u.jsx(Hp,{}),u.jsx(Qp,{})]})]})]})]}),u.jsxs(ue,{mt:4,children:[u.jsx(J,{fontWeight:"600",fontSize:"sm",mb:2,children:"Halo / Glow Effect"}),u.jsxs(fe,{spacing:4,wrap:"wrap",children:[u.jsx(Hj,{label:"Halo Color",value:t.symbolizer.haloColor||"#ffffff",onChange:d=>o({haloColor:d})}),u.jsxs(Ot,{maxW:"120px",children:[u.jsx(jt,{fontSize:"sm",children:"Halo Radius"}),u.jsxs(fe,{children:[u.jsxs(Tl,{value:t.symbolizer.haloRadius||0,min:0,max:10,step:1,onChange:d=>o({haloRadius:d}),children:[u.jsx(jl,{children:u.jsx(Pl,{bg:"kartoza.500"})}),u.jsx(Ol,{})]}),u.jsxs(J,{fontSize:"sm",w:"30px",children:[t.symbolizer.haloRadius||0,"px"]})]})]}),t.symbolizer.haloRadius&&t.symbolizer.haloRadius>0&&u.jsx(gt,{size:"xs",variant:"ghost",colorScheme:"red",onClick:()=>o({haloRadius:0,haloColor:void 0}),children:"Remove Halo"})]})]})]}),u.jsxs(ue,{children:[u.jsx(J,{fontWeight:"600",fontSize:"sm",mb:2,children:"Preview"}),u.jsxs(ue,{w:"100px",h:"60px",borderRadius:"md",border:"1px solid",borderColor:i,display:"flex",alignItems:"center",justifyContent:"center",bg:"gray.100",children:[t.symbolizer.type==="polygon"&&u.jsx(ue,{w:"60px",h:"40px",borderRadius:"sm",bg:t.symbolizer.fill,opacity:t.symbolizer.fillOpacity,border:`${t.symbolizer.strokeWidth}px solid ${t.symbolizer.stroke}`}),t.symbolizer.type==="line"&&u.jsx(ue,{w:"60px",h:`${Math.max(2,t.symbolizer.strokeWidth||2)}px`,bg:t.symbolizer.stroke,opacity:t.symbolizer.strokeOpacity}),t.symbolizer.type==="point"&&u.jsxs(ue,{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",children:[t.symbolizer.haloColor&&t.symbolizer.haloRadius&&t.symbolizer.haloRadius>0&&u.jsx(ue,{position:"absolute",w:`${(t.symbolizer.pointSize||8)+t.symbolizer.haloRadius*2}px`,h:`${(t.symbolizer.pointSize||8)+t.symbolizer.haloRadius*2}px`,borderRadius:t.symbolizer.pointShape==="circle"?"50%":t.symbolizer.pointShape==="triangle"?"0":"sm",bg:t.symbolizer.haloColor,opacity:.4,transform:t.symbolizer.rotation?`rotate(${t.symbolizer.rotation}deg)`:void 0,style:{clipPath:t.symbolizer.pointShape==="triangle"?"polygon(50% 0%, 0% 100%, 100% 100%)":t.symbolizer.pointShape==="star"?"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)":t.symbolizer.pointShape==="cross"?"polygon(35% 0%, 65% 0%, 65% 35%, 100% 35%, 100% 65%, 65% 65%, 65% 100%, 35% 100%, 35% 65%, 0% 65%, 0% 35%, 35% 35%)":t.symbolizer.pointShape==="x"?"polygon(10% 0%, 50% 40%, 90% 0%, 100% 10%, 60% 50%, 100% 90%, 90% 100%, 50% 60%, 10% 100%, 0% 90%, 40% 50%, 0% 10%)":void 0}}),u.jsx(ue,{position:"relative",w:`${t.symbolizer.pointSize||8}px`,h:`${t.symbolizer.pointSize||8}px`,borderRadius:t.symbolizer.pointShape==="circle"?"50%":t.symbolizer.pointShape==="triangle"?"0":"sm",bg:t.symbolizer.fill,opacity:t.symbolizer.fillOpacity,border:`${t.symbolizer.strokeWidth}px solid ${t.symbolizer.stroke}`,transform:t.symbolizer.rotation?`rotate(${t.symbolizer.rotation}deg)`:void 0,style:{clipPath:t.symbolizer.pointShape==="triangle"?"polygon(50% 0%, 0% 100%, 100% 100%)":t.symbolizer.pointShape==="star"?"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)":t.symbolizer.pointShape==="cross"?"polygon(35% 0%, 65% 0%, 65% 35%, 100% 35%, 100% 65%, 65% 65%, 65% 100%, 35% 100%, 35% 65%, 0% 65%, 0% 35%, 35% 35%)":t.symbolizer.pointShape==="x"?"polygon(10% 0%, 50% 40%, 90% 0%, 100% 10%, 60% 50%, 100% 90%, 90% 100%, 50% 60%, 10% 100%, 0% 90%, 40% 50%, 0% 10%)":void 0}})]})]})]})]})})}function fAe(){var be,ke,$e,_e,nt,dt;const t=bt(ve=>ve.activeDialog),e=bt(ve=>ve.dialogData),r=bt(ve=>ve.closeDialog),n=Yo(),i=Jo(),s=t==="style",a=(e==null?void 0:e.mode)==="edit",o=(be=e==null?void 0:e.data)==null?void 0:be.connectionId,d=(ke=e==null?void 0:e.data)==null?void 0:ke.workspace,m=($e=e==null?void 0:e.data)==null?void 0:$e.name,y=(_e=e==null?void 0:e.data)==null?void 0:_e.previewLayer,[v,w]=I.useState(""),[O,P]=I.useState("sld"),[E,$]=I.useState(""),[R,F]=I.useState([]),[D,U]=I.useState(0),[X,ee]=I.useState(!1),[K,Y]=I.useState(null),[ne,oe]=I.useState(null),{isOpen:ce,onToggle:Xe}=rm(),[Ae,We]=I.useState(""),[Ye,tt]=I.useState("equal-interval"),[Be,Me]=I.useState(5),[Ge,De]=I.useState("blue-to-red"),[Le,Oe]=I.useState("polygon"),[Ie,st]=I.useState(""),{isOpen:Re,onToggle:it}=rm(),[Ke,St]=I.useState("colormap"),[Mt,Et]=I.useState("rainbow"),[xt,et]=I.useState(0),[Yt,_t]=I.useState(1e3),[rt,Te]=I.useState(1),[ct,Vt]=I.useState("ramp"),[wt,Ft]=I.useState(315),[Kr,yn]=I.useState(45),[an,Cn]=I.useState(1),[xn,di]=I.useState("normalize"),[Pi,He]=I.useState(1),Vr=Bt("gray.50","gray.900"),Ct=Bt("linear-gradient(135deg, #3d9970 0%, #2d7a5a 100%)","linear-gradient(135deg, #2d7a5a 0%, #1d5a40 100%)"),{data:Ut,isLoading:wn}=Xr({queryKey:["style",o,d,m],queryFn:()=>mU(o,d,m),enabled:s&&a&&!!m});I.useEffect(()=>{s&&(a&&Ut?(w(Ut.name),P(Ut.format),$(Ut.content),Ut.format==="sld"&&F(Yx(Ut.content))):a||(w(""),P("sld"),$(Qw),F(Yx(Qw))),ee(!1),Y(null))},[s,a,Ut]),I.useEffect(()=>{if(O==="sld"&&D===0&&R.length>0){const ve=hAe(v||"NewStyle",R);ve!==E&&($(ve),ee(!0))}},[R,v]);const vt=I.useCallback(()=>{var ve;if(O==="sld")try{const nr=new DOMParser().parseFromString(E,"text/xml").querySelector("parsererror");return nr?(Y("Invalid XML: "+((ve=nr.textContent)==null?void 0:ve.slice(0,100))),!1):(Y(null),!0)}catch{return Y("Failed to parse SLD"),!1}return Y(null),!0},[E,O]),vr=su({mutationFn:()=>pbe(o,d,m,E,O),onSuccess:()=>{i.invalidateQueries({queryKey:["styles",o,d]}),i.invalidateQueries({queryKey:["style",o,d,m]}),n({title:"Style updated",status:"success",duration:3e3}),ee(!1)},onError:ve=>{n({title:"Failed to update style",description:ve.message,status:"error",duration:5e3})}}),tr=su({mutationFn:()=>mbe(o,d,v,E,O),onSuccess:()=>{i.invalidateQueries({queryKey:["styles",o,d]}),n({title:"Style created",status:"success",duration:3e3}),r()},onError:ve=>{n({title:"Failed to create style",description:ve.message,status:"error",duration:5e3})}}),Zn=()=>{if(!vt()){n({title:"Please fix validation errors",status:"warning",duration:3e3});return}if(!a&&!v.trim()){n({title:"Style name is required",status:"warning",duration:3e3});return}a?vr.mutate():tr.mutate()},_i=ve=>{$(ve),ee(!0),O==="sld"&&F(Yx(ve))},pr=ve=>{ve!==O&&(ve==="sld"?($(Qw),F(Yx(Qw))):($(rAe),F([])),P(ve),ee(!0))},Di=()=>{F([...R,{name:`Rule ${R.length+1}`,symbolizer:{type:"polygon",fill:"#3388ff",fillOpacity:.6,stroke:"#2266cc",strokeWidth:1}}])},ks=(ve,ut)=>{const Dt=[...R];Dt[ve]=ut,F(Dt),ee(!0)},Li=ve=>{if(R.length<=1){n({title:"Cannot delete the last rule",status:"warning",duration:3e3});return}F(R.filter((ut,Dt)=>Dt!==ve)),ee(!0)},cs=async()=>{if(!y){n({title:"No preview layer specified",status:"info",duration:3e3});return}try{const{url:ve}=await il({connId:o,workspace:d,layerName:y,storeName:"",storeType:"datastore",layerType:"vector"});oe(ve)}catch{n({title:"Failed to start preview",status:"error",duration:3e3})}},ge=()=>{const ve=Ie.split(",").map(Ur=>parseFloat(Ur.trim())).filter(Ur=>!isNaN(Ur));if(ve.length<2){n({title:"Need more sample values",description:"Please enter at least 2 numeric values separated by commas",status:"warning",duration:3e3});return}const ut=cAe(ve,Be,Ye),Dt=$6(qj[Ge],Be),nr=uAe(v||"ClassifiedStyle",Ae,ut,Dt,Le);$(nr),P("sld"),F(Yx(nr)),ee(!0),U(1),n({title:"Classified style generated",description:`Created ${Be} classes using ${Ye.replace("-"," ")}`,status:"success",duration:3e3})},W=()=>{var nr;const ve=v||"RasterStyle",ut=((nr=kg[Mt])==null?void 0:nr.colors)||kg.rainbow.colors;let Dt;switch(Ke){case"colormap":Dt=B6(ve,ut,xt,Yt,ct,rt);break;case"hillshade":Dt=nAe(ve,wt,Kr,an,rt);break;case"hillshade-color":Dt=iAe(ve,ut,xt,Yt,wt,Kr,an,rt);break;case"contrast":Dt=sAe(ve,xn,Pi,rt);break;default:Dt=B6(ve,ut,xt,Yt,"ramp",rt)}$(Dt),P("sld"),F([]),ee(!0),U(1),n({title:"Raster style generated",description:`Created ${Ke==="hillshade"?"hillshade":Ke==="hillshade-color"?"hillshade with colors":Ke==="contrast"?"contrast enhanced":"color map"} style`,status:"success",duration:3e3})},Q=ve=>{Ft(ve.azimuth),yn(ve.altitude),Cn(ve.zFactor)},te=I.useMemo(()=>O==="sld"?[xPe()]:[tAe()],[O]),de=wn||vr.isPending||tr.isPending;return u.jsxs(ss,{isOpen:s,onClose:r,size:"6xl",scrollBehavior:"inside",children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsxs(os,{maxH:"90vh",borderRadius:"xl",overflow:"hidden",children:[u.jsx(ue,{bg:Ct,color:"white",px:6,py:4,children:u.jsxs(yr,{align:"center",justify:"space-between",children:[u.jsxs(fe,{spacing:3,children:[u.jsx(ze,{as:Wo,boxSize:6}),u.jsxs(ue,{children:[u.jsx(J,{fontSize:"lg",fontWeight:"600",children:a?"Edit Style":"Create Style"}),u.jsx(J,{fontSize:"sm",opacity:.9,children:a?`Editing ${m}`:"Create a new map style"})]})]}),u.jsxs(fe,{children:[X&&u.jsx(Qt,{colorScheme:"yellow",variant:"solid",children:"Unsaved Changes"}),u.jsx(Qt,{colorScheme:O==="sld"?"blue":"purple",variant:"solid",children:O.toUpperCase()})]})]})}),u.jsx(Ns,{color:"white"}),u.jsx(ws,{p:0,bg:Vr,children:wn?u.jsx(yr,{h:"400px",align:"center",justify:"center",children:u.jsx(kn,{size:"xl",color:"kartoza.500"})}):u.jsxs(yr,{h:"70vh",children:[u.jsx(ue,{w:"250px",borderRight:"1px solid",borderColor:"gray.200",p:4,overflowY:"auto",children:u.jsxs(lt,{spacing:4,align:"stretch",children:[!a&&u.jsxs(Ot,{isRequired:!0,children:[u.jsx(jt,{children:"Style Name"}),u.jsx(Ar,{value:v,onChange:ve=>{w(ve.target.value),ee(!0)},placeholder:"my-style"})]}),u.jsxs(Ot,{children:[u.jsx(jt,{children:"Format"}),u.jsxs(zn,{value:O,onChange:ve=>pr(ve.target.value),children:[u.jsx("option",{value:"sld",children:"SLD (Styled Layer Descriptor)"}),u.jsx("option",{value:"css",children:"CSS (GeoServer CSS)"})]})]}),u.jsx(Nr,{}),O==="sld"&&u.jsxs(u.Fragment,{children:[u.jsx(J,{fontWeight:"600",children:"Quick Actions"}),u.jsx(gt,{size:"sm",leftIcon:u.jsx(ze,{as:tU}),variant:"outline",onClick:()=>F([{name:"Polygon",symbolizer:{type:"polygon",fill:"#3388ff",fillOpacity:.6,stroke:"#2266cc",strokeWidth:1}}]),children:"Polygon Style"}),u.jsx(gt,{size:"sm",leftIcon:u.jsx(ze,{as:eU}),variant:"outline",onClick:()=>F([{name:"Line",symbolizer:{type:"line",stroke:"#3388ff",strokeWidth:2,strokeOpacity:1}}]),children:"Line Style"}),u.jsx(gt,{size:"sm",leftIcon:u.jsx(ze,{as:lve}),variant:"outline",onClick:()=>F([{name:"Point",symbolizer:{type:"point",fill:"#3388ff",fillOpacity:1,stroke:"#2266cc",strokeWidth:1,pointShape:"circle",pointSize:8}}]),children:"Point Style"}),u.jsx(Nr,{}),u.jsx(J,{fontWeight:"600",children:"Classified Style"}),u.jsx(gt,{size:"sm",leftIcon:u.jsx(ze,{as:uf}),rightIcon:u.jsx(ze,{as:ce?i0:Ul}),variant:"outline",colorScheme:"kartoza",onClick:Xe,children:"Choropleth Wizard"}),u.jsx(bc,{in:ce,animateOpacity:!0,children:u.jsxs(lt,{spacing:3,p:3,bg:"gray.50",borderRadius:"md",align:"stretch",children:[u.jsxs(Ot,{size:"sm",children:[u.jsx(jt,{fontSize:"xs",children:"Attribute"}),u.jsx(Ar,{size:"sm",value:Ae,onChange:ve=>We(ve.target.value),placeholder:"population"})]}),u.jsxs(Ot,{size:"sm",children:[u.jsx(jt,{fontSize:"xs",children:"Method"}),u.jsxs(zn,{size:"sm",value:Ye,onChange:ve=>tt(ve.target.value),children:[u.jsx("option",{value:"equal-interval",children:"Equal Interval"}),u.jsx("option",{value:"quantile",children:"Quantile"}),u.jsx("option",{value:"jenks",children:"Jenks Natural Breaks"}),u.jsx("option",{value:"pretty",children:"Pretty Breaks"})]})]}),u.jsxs(Ot,{size:"sm",children:[u.jsxs(jt,{fontSize:"xs",children:["Classes: ",Be]}),u.jsxs(Tl,{value:Be,onChange:ve=>Me(ve),min:3,max:10,step:1,children:[u.jsx(jl,{children:u.jsx(Pl,{bg:"kartoza.500"})}),u.jsx(Ol,{})]})]}),u.jsxs(Ot,{size:"sm",children:[u.jsx(jt,{fontSize:"xs",children:"Color Ramp"}),u.jsx(zn,{size:"sm",value:Ge,onChange:ve=>De(ve.target.value),children:Object.keys(qj).map(ve=>u.jsx("option",{value:ve,children:ve.replace(/-/g," ")},ve))}),u.jsx(fe,{mt:1,spacing:1,children:$6(qj[Ge],Be).map((ve,ut)=>u.jsx(ue,{w:"16px",h:"12px",bg:ve,borderRadius:"sm"},ut))})]}),u.jsxs(Ot,{size:"sm",children:[u.jsx(jt,{fontSize:"xs",children:"Geometry Type"}),u.jsxs(zn,{size:"sm",value:Le,onChange:ve=>Oe(ve.target.value),children:[u.jsx("option",{value:"polygon",children:"Polygon"}),u.jsx("option",{value:"line",children:"Line"}),u.jsx("option",{value:"point",children:"Point"})]})]}),u.jsxs(Ot,{size:"sm",children:[u.jsx(jt,{fontSize:"xs",children:"Sample Values (comma separated)"}),u.jsx(Ar,{size:"sm",value:Ie,onChange:ve=>st(ve.target.value),placeholder:"10, 25, 50, 100, 200"})]}),u.jsx(gt,{size:"sm",colorScheme:"kartoza",onClick:ge,isDisabled:!Ae||!Ie,children:"Generate Style"})]})}),u.jsx(Nr,{}),u.jsx(J,{fontWeight:"600",children:"Raster Style"}),u.jsx(gt,{size:"sm",leftIcon:u.jsx(ze,{as:wc}),rightIcon:u.jsx(ze,{as:Re?i0:Ul}),variant:"outline",colorScheme:"purple",onClick:it,children:"Raster Wizard"}),u.jsx(bc,{in:Re,animateOpacity:!0,children:u.jsxs(lt,{spacing:3,p:3,bg:"purple.50",borderRadius:"md",align:"stretch",children:[u.jsxs(Ot,{size:"sm",children:[u.jsx(jt,{fontSize:"xs",children:"Style Type"}),u.jsxs(zn,{size:"sm",value:Ke,onChange:ve=>St(ve.target.value),children:[u.jsx("option",{value:"colormap",children:"Color Map (Graduated)"}),u.jsx("option",{value:"hillshade",children:"Hillshade Only"}),u.jsx("option",{value:"hillshade-color",children:"Hillshade + Colors"}),u.jsx("option",{value:"contrast",children:"Contrast Enhancement"})]})]}),(Ke==="colormap"||Ke==="hillshade-color")&&u.jsxs(u.Fragment,{children:[u.jsxs(Ot,{size:"sm",children:[u.jsx(jt,{fontSize:"xs",children:"Color Ramp"}),u.jsx(zn,{size:"sm",value:Mt,onChange:ve=>Et(ve.target.value),children:Object.entries(kg).map(([ve,ut])=>u.jsx("option",{value:ve,children:ut.name},ve))}),u.jsx(fe,{mt:1,spacing:0,children:(nt=kg[Mt])==null?void 0:nt.colors.map((ve,ut)=>u.jsx(ue,{flex:"1",h:"8px",bg:ve,borderRadius:ut===0?"sm 0 0 sm":ut===kg[Mt].colors.length-1?"0 sm sm 0":"0"},ut))}),u.jsx(J,{fontSize:"xs",color:"gray.500",mt:1,children:(dt=kg[Mt])==null?void 0:dt.description})]}),u.jsxs(Ot,{size:"sm",children:[u.jsx(jt,{fontSize:"xs",children:"Min Value"}),u.jsx(Ar,{size:"sm",type:"number",value:xt,onChange:ve=>et(parseFloat(ve.target.value)||0)})]}),u.jsxs(Ot,{size:"sm",children:[u.jsx(jt,{fontSize:"xs",children:"Max Value"}),u.jsx(Ar,{size:"sm",type:"number",value:Yt,onChange:ve=>_t(parseFloat(ve.target.value)||1e3)})]}),Ke==="colormap"&&u.jsxs(Ot,{size:"sm",children:[u.jsx(jt,{fontSize:"xs",children:"Color Map Type"}),u.jsxs(zn,{size:"sm",value:ct,onChange:ve=>Vt(ve.target.value),children:[u.jsx("option",{value:"ramp",children:"Ramp (Smooth gradient)"}),u.jsx("option",{value:"intervals",children:"Intervals (Discrete)"}),u.jsx("option",{value:"values",children:"Values (Exact match)"})]})]})]}),(Ke==="hillshade"||Ke==="hillshade-color")&&u.jsxs(u.Fragment,{children:[u.jsxs(Ot,{size:"sm",children:[u.jsx(jt,{fontSize:"xs",children:"Hillshade Preset"}),u.jsx(zn,{size:"sm",placeholder:"Select preset...",onChange:ve=>{const ut=F6.find(Dt=>Dt.name===ve.target.value);ut&&Q(ut)},children:F6.map(ve=>u.jsx("option",{value:ve.name,children:ve.name},ve.name))})]}),u.jsxs(Ot,{size:"sm",children:[u.jsxs(jt,{fontSize:"xs",children:["Sun Azimuth: ",wt,""]}),u.jsxs(Tl,{value:wt,onChange:ve=>Ft(ve),min:0,max:360,step:15,children:[u.jsx(jl,{children:u.jsx(Pl,{bg:"purple.500"})}),u.jsx(Ol,{})]})]}),u.jsxs(Ot,{size:"sm",children:[u.jsxs(jt,{fontSize:"xs",children:["Sun Altitude: ",Kr,""]}),u.jsxs(Tl,{value:Kr,onChange:ve=>yn(ve),min:0,max:90,step:5,children:[u.jsx(jl,{children:u.jsx(Pl,{bg:"purple.500"})}),u.jsx(Ol,{})]})]}),u.jsxs(Ot,{size:"sm",children:[u.jsxs(jt,{fontSize:"xs",children:["Z Factor: ",an]}),u.jsxs(Tl,{value:an,onChange:ve=>Cn(ve),min:.1,max:5,step:.1,children:[u.jsx(jl,{children:u.jsx(Pl,{bg:"purple.500"})}),u.jsx(Ol,{})]})]})]}),Ke==="contrast"&&u.jsxs(u.Fragment,{children:[u.jsxs(Ot,{size:"sm",children:[u.jsx(jt,{fontSize:"xs",children:"Enhancement Method"}),u.jsxs(zn,{size:"sm",value:xn,onChange:ve=>di(ve.target.value),children:[u.jsx("option",{value:"normalize",children:"Normalize (Stretch to min/max)"}),u.jsx("option",{value:"histogram",children:"Histogram Equalization"}),u.jsx("option",{value:"none",children:"None"})]})]}),u.jsxs(Ot,{size:"sm",children:[u.jsxs(jt,{fontSize:"xs",children:["Gamma: ",Pi.toFixed(1)]}),u.jsxs(Tl,{value:Pi,onChange:ve=>He(ve),min:.1,max:3,step:.1,children:[u.jsx(jl,{children:u.jsx(Pl,{bg:"purple.500"})}),u.jsx(Ol,{})]})]})]}),u.jsxs(Ot,{size:"sm",children:[u.jsxs(jt,{fontSize:"xs",children:["Opacity: ",(rt*100).toFixed(0),"%"]}),u.jsxs(Tl,{value:rt,onChange:ve=>Te(ve),min:0,max:1,step:.05,children:[u.jsx(jl,{children:u.jsx(Pl,{bg:"purple.500"})}),u.jsx(Ol,{})]})]}),u.jsx(gt,{size:"sm",colorScheme:"purple",onClick:W,children:"Generate Raster Style"})]})})]}),y&&u.jsxs(u.Fragment,{children:[u.jsx(Nr,{}),u.jsx(J,{fontWeight:"600",children:"Preview"}),u.jsxs(J,{fontSize:"sm",color:"gray.600",children:["Layer: ",y]}),u.jsx(gt,{size:"sm",leftIcon:u.jsx(ze,{as:Ri}),colorScheme:"kartoza",onClick:cs,children:"Preview on Map"})]})]})}),u.jsx(ue,{flex:"1",display:"flex",flexDirection:"column",children:u.jsxs(w0,{index:D,onChange:U,flex:"1",display:"flex",flexDirection:"column",children:[u.jsxs(S0,{px:4,pt:2,children:[O==="sld"&&u.jsxs(to,{children:[u.jsx(ze,{as:Wo,mr:2}),"Visual Editor"]}),u.jsxs(to,{children:[u.jsx(ze,{as:Ml,mr:2}),"Code Editor"]}),ne&&u.jsxs(to,{children:[u.jsx(ze,{as:Ri,mr:2}),"Map Preview"]})]}),u.jsxs(z1,{flex:"1",overflow:"hidden",children:[O==="sld"&&u.jsx(_a,{h:"100%",overflowY:"auto",p:4,children:u.jsxs(lt,{spacing:4,align:"stretch",children:[K&&u.jsxs(io,{status:"warning",borderRadius:"md",children:[u.jsx(so,{}),K]}),R.map((ve,ut)=>u.jsx(dAe,{rule:ve,onChange:Dt=>ks(ut,Dt),onDelete:()=>Li(ut)},ut)),u.jsx(gt,{leftIcon:u.jsx(ze,{as:Wo}),onClick:Di,variant:"outline",colorScheme:"kartoza",children:"Add Rule"})]})}),u.jsx(_a,{h:"100%",p:0,children:u.jsxs(ue,{h:"100%",position:"relative",children:[K&&u.jsxs(io,{status:"warning",position:"absolute",top:0,left:0,right:0,zIndex:1,children:[u.jsx(so,{}),K]}),u.jsx(bI,{value:E,height:"100%",extensions:te,onChange:_i,onBlur:vt,theme:"light",style:{height:"100%"}})]})}),ne&&u.jsx(_a,{h:"100%",p:0,children:u.jsx("iframe",{src:ne,style:{width:"100%",height:"100%",border:"none"},title:"Style Preview"})})]})]})})]})}),u.jsxs(To,{gap:3,borderTop:"1px solid",borderTopColor:"gray.200",bg:"gray.50",children:[u.jsx(gt,{variant:"ghost",onClick:r,children:"Cancel"}),u.jsx(gt,{colorScheme:"kartoza",leftIcon:u.jsx(ze,{as:OS}),onClick:Zn,isLoading:de,isDisabled:!X&&a,children:a?"Save Changes":"Create Style"})]})]})]})}Cesium.Ion.defaultAccessToken="";function pAe(){var Be,Me,Ge,De;const{activeDialog:t,dialogData:e,closeDialog:r}=bt(),n=I.useRef(null),i=I.useRef(null),[s,a]=I.useState(!0),[o,d]=I.useState("3d"),[m,y]=I.useState([]),[v,w]=I.useState(null),[O,P]=I.useState(!1),[E,$]=I.useState(0),[R,F]=I.useState(!1),D=t==="globe3d";I.useEffect(()=>{D&&$(Le=>Le+1)},[D]);const U="linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 100%)",X=Bt("white","gray.800"),ee=Bt("gray.50","gray.700"),K=Bt("gray.200","gray.600"),Y=(Be=e==null?void 0:e.data)==null?void 0:Be.connectionId,ne=(Me=e==null?void 0:e.data)==null?void 0:Me.workspace,oe=(Ge=e==null?void 0:e.data)==null?void 0:Ge.name,ce=(De=e==null?void 0:e.data)==null?void 0:De.type,Xe=I.useCallback(()=>!Y||!ne?null:ce==="layergroup"?`/api/terria/story/${Y}/${ne}/${oe}`:`/api/terria/layer/${Y}/${ne}/${oe}`,[Y,ne,oe,ce]);I.useEffect(()=>{if(!D||!n.current)return;if(i.current){try{i.current.destroy()}catch(Ie){console.warn("[Globe3D] Error destroying previous viewer:",Ie)}i.current=null}a(!0),w(null);let Le=!0;const Oe=setTimeout(async()=>{if(!(!Le||!n.current))try{console.log("[Globe3D] Initializing Cesium viewer...");const Ie=new Cesium.Viewer(n.current,{baseLayerPicker:!1,geocoder:!1,homeButton:!1,sceneModePicker:!1,selectionIndicator:!1,timeline:!1,animation:!1,navigationHelpButton:!1,fullscreenButton:!1,vrButton:!1,infoBox:!1,creditContainer:document.createElement("div")});Ie.imageryLayers.removeAll(),Ie.terrainProvider=new Cesium.EllipsoidTerrainProvider,console.log("[Globe3D] Viewer created, adding base layer..."),Ie.imageryLayers.addImageryProvider(new Cesium.UrlTemplateImageryProvider({url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"],credit:new Cesium.Credit("Map tiles by CartoDB, under CC BY 3.0. Data by OpenStreetMap, under ODbL.")})),console.log("[Globe3D] CartoDB base layer added"),i.current=Ie;const st=Xe();if(st){const Re=await fetch(st);if(!Re.ok)throw new Error(`Failed to fetch catalog: ${Re.status}`);const it=await Re.json(),Ke=[],St=Mt=>{if(Mt.type==="wms")try{const Et=new Cesium.WebMapServiceImageryProvider({url:Mt.url,layers:Mt.layers||Mt.name,parameters:{transparent:!0,format:"image/png"}}),xt=Ie.imageryLayers.addImageryProvider(Et);if(xt.alpha=Mt.opacity||1,Ke.push({name:Mt.name,layer:xt,visible:!0,opacity:xt.alpha}),Mt.rectangle){const et=Mt.rectangle;Ie.camera.flyTo({destination:Cesium.Rectangle.fromDegrees(et.west,et.south,et.east,et.north),duration:1.5})}}catch(Et){console.error("Failed to add WMS layer:",Mt.name,Et)}else Mt.type==="group"&&Array.isArray(Mt.members)&&Mt.members.forEach(Et=>St(Et))};it.catalog?it.catalog.forEach(Mt=>St(Mt)):(it.type==="wms"||it.type==="group")&&St(it),Le&&y(Ke)}Le&&a(!1)}catch(Ie){console.error("Failed to initialize Cesium viewer:",Ie),Le&&(w(Ie instanceof Error?Ie.message:"Failed to initialize viewer"),a(!1))}},200);return()=>{if(Le=!1,clearTimeout(Oe),i.current){try{i.current.destroy()}catch(Ie){console.warn("[Globe3D] Error destroying viewer:",Ie)}i.current=null}y([])}},[D,Xe,E]),I.useEffect(()=>{if(i.current)switch(o){case"3d":i.current.scene.mode=Cesium.SceneMode.SCENE3D;break;case"2d":i.current.scene.mode=Cesium.SceneMode.SCENE2D;break;case"columbus":i.current.scene.mode=Cesium.SceneMode.COLUMBUS_VIEW;break}},[o]);const Ae=(Le,Oe)=>{m[Le]&&(m[Le].layer.show=Oe,y(Ie=>Ie.map((st,Re)=>Re===Le?{...st,visible:Oe}:st)))},We=(Le,Oe)=>{m[Le]&&(m[Le].layer.alpha=Oe,y(Ie=>Ie.map((st,Re)=>Re===Le?{...st,opacity:Oe}:st)))},Ye=()=>{if(!i.current)return;const Oe=i.current.imageryLayers;for(let Ie=0;Ie<Oe.length;Ie++){const st=Oe.get(Ie),Re=st.show;st.show=!1,setTimeout(()=>{st.show=Re},100)}},tt=()=>{P(Le=>!Le)};return D?u.jsxs(ss,{isOpen:D,onClose:r,size:O?"full":"6xl",isCentered:!O,children:[u.jsx(as,{bg:"blackAlpha.700"}),u.jsxs(os,{bg:X,maxH:O?"100vh":"90vh",h:O?"100vh":"85vh",overflow:"hidden",children:[u.jsx(P1,{bg:U,color:"white",py:3,borderTopRadius:O?0:"md",children:u.jsxs(fe,{justify:"space-between",children:[u.jsxs(lt,{align:"start",spacing:0,children:[u.jsxs(fe,{children:[u.jsx(ze,{as:xs}),u.jsx(J,{fontWeight:"bold",children:"3D Globe Viewer"}),u.jsx(Qt,{colorScheme:"whiteAlpha",variant:"solid",fontSize:"xs",children:ce==="layergroup"?"Layer Group":"Layer"})]}),u.jsxs(J,{fontSize:"xs",color:"whiteAlpha.800",children:[ne,":",oe]})]}),u.jsxs(fe,{spacing:2,children:[m.length>0&&u.jsxs(sf,{children:[u.jsx(of,{as:gt,size:"sm",variant:"solid",bg:"whiteAlpha.200",color:"white",_hover:{bg:"whiteAlpha.300"},_active:{bg:"whiteAlpha.400"},rightIcon:u.jsx(Ul,{}),leftIcon:u.jsx(hi,{}),maxW:"180px",children:u.jsxs(J,{isTruncated:!0,fontSize:"xs",children:[m.length," Layer",m.length!==1?"s":""]})}),u.jsx(af,{color:"gray.800",zIndex:1e3,maxH:"300px",overflowY:"auto",children:m.map((Le,Oe)=>u.jsx(xa,{onClick:()=>Ae(Oe,!Le.visible),closeOnSelect:!1,children:u.jsxs(fe,{justify:"space-between",w:"100%",children:[u.jsxs(fe,{children:[u.jsx(ze,{as:Le.visible?Ri:cf,color:Le.visible?"green.500":"gray.400"}),u.jsx(J,{fontSize:"sm",children:Le.name})]}),u.jsxs(Qt,{colorScheme:Le.visible?"green":"gray",size:"sm",children:[Math.round(Le.opacity*100),"%"]})]})},Oe))})]}),u.jsxs(Yk,{size:"sm",isAttached:!0,variant:"ghost",children:[u.jsx(wr,{label:"3D Globe",children:u.jsx(gr,{"aria-label":"3D Globe",icon:u.jsx(xs,{}),color:"white",bg:o==="3d"?"whiteAlpha.300":void 0,_hover:{bg:"whiteAlpha.200"},onClick:()=>d("3d")})}),u.jsx(wr,{label:"2D Map",children:u.jsx(gr,{"aria-label":"2D Map",icon:u.jsx(Sc,{}),color:"white",bg:o==="2d"?"whiteAlpha.300":void 0,_hover:{bg:"whiteAlpha.200"},onClick:()=>d("2d")})}),u.jsx(wr,{label:"Columbus View",children:u.jsx(gr,{"aria-label":"Columbus View",icon:u.jsx(PM,{}),color:"white",bg:o==="columbus"?"whiteAlpha.300":void 0,_hover:{bg:"whiteAlpha.200"},onClick:()=>d("columbus")})})]}),u.jsx(Nr,{orientation:"vertical",h:"24px",borderColor:"whiteAlpha.400"}),u.jsx(wr,{label:"Refresh",children:u.jsx(gr,{"aria-label":"Refresh",icon:u.jsx(Su,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:Ye})}),u.jsx(wr,{label:"Layer Controls",children:u.jsx(gr,{"aria-label":"Layer Controls",icon:u.jsx(I1,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:()=>F(!R),bg:R?"whiteAlpha.200":void 0})}),u.jsx(wr,{label:O?"Exit Fullscreen":"Fullscreen",children:u.jsx(gr,{"aria-label":"Fullscreen",icon:u.jsx(yve,{}),size:"sm",variant:"ghost",color:"white",_hover:{bg:"whiteAlpha.200"},onClick:tt})})]})]})}),u.jsx(Ns,{color:"white"}),u.jsxs(ws,{p:0,display:"flex",flexDirection:"column",h:"calc(100% - 60px)",children:[u.jsx(bc,{in:R,animateOpacity:!0,children:u.jsx(ue,{bg:ee,p:4,borderBottom:"1px solid",borderColor:K,children:s?u.jsxs(fe,{justify:"center",py:4,children:[u.jsx(kn,{size:"sm",color:"kartoza.500"}),u.jsx(J,{fontSize:"sm",color:"gray.500",children:"Loading layers..."})]}):m.length>0?u.jsx(Wr,{columns:{base:1,md:2,lg:3},spacing:4,children:m.map((Le,Oe)=>u.jsxs(ue,{bg:X,p:3,borderRadius:"md",border:"1px solid",borderColor:K,children:[u.jsx(fe,{justify:"space-between",mb:2,children:u.jsxs(fe,{children:[u.jsx(gr,{"aria-label":"Toggle visibility",icon:Le.visible?u.jsx(Ri,{}):u.jsx(cf,{}),size:"xs",variant:"ghost",colorScheme:Le.visible?"green":"gray",onClick:()=>Ae(Oe,!Le.visible)}),u.jsx(J,{fontSize:"sm",fontWeight:"500",noOfLines:1,children:Le.name})]})}),u.jsxs(fe,{spacing:2,children:[u.jsx(J,{fontSize:"xs",color:"gray.500",minW:"50px",children:"Opacity"}),u.jsxs(Tl,{value:Le.opacity*100,onChange:Ie=>We(Oe,Ie/100),min:0,max:100,size:"sm",children:[u.jsx(jl,{bg:"gray.200",children:u.jsx(Pl,{bg:"kartoza.500"})}),u.jsx(Ol,{boxSize:3})]}),u.jsxs(J,{fontSize:"xs",color:"gray.500",minW:"30px",children:[Math.round(Le.opacity*100),"%"]})]})]},Oe))}):u.jsx(J,{fontSize:"sm",color:"gray.500",children:"No layers loaded"})})}),u.jsxs(ue,{flex:"1",position:"relative",bg:"gray.900",children:[u.jsx(ue,{ref:n,position:"absolute",top:0,left:0,right:0,bottom:0},`cesium-container-${E}`),s&&u.jsxs(ue,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",bg:"blackAlpha.700",p:6,borderRadius:"lg",children:[u.jsx(kn,{size:"xl",color:"kartoza.400",thickness:"4px"}),u.jsx(J,{mt:3,color:"white",children:"Loading 3D viewer..."})]}),v&&u.jsxs(ue,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",bg:"red.600",color:"white",p:6,borderRadius:"lg",maxW:"400px",children:[u.jsx(J,{fontWeight:"bold",mb:2,children:"Error"}),u.jsx(J,{fontSize:"sm",children:v})]})]})]}),u.jsx(ue,{px:4,py:2,bg:ee,borderTop:"1px solid",borderColor:K,children:u.jsxs(fe,{justify:"space-between",fontSize:"xs",color:"gray.500",children:[u.jsxs(J,{children:["Connection: ",Y==null?void 0:Y.slice(0,8),"..."]}),u.jsxs(fe,{spacing:4,children:[u.jsx(Qt,{colorScheme:o==="3d"?"green":o==="2d"?"blue":"purple",children:o==="3d"?"3D Globe":o==="2d"?"2D Map":"Columbus View"}),u.jsx(J,{children:"Scroll to zoom, drag to pan, right-drag to rotate"})]})]})})]})]}):null}function mAe(){return u.jsxs(u.Fragment,{children:[u.jsx(X1e,{}),u.jsx(K1e,{}),u.jsx(Z1e,{}),u.jsx(Y1e,{}),u.jsx(J1e,{}),u.jsx(e_e,{}),u.jsx(t_e,{}),u.jsx(r_e,{}),u.jsx(Xje,{}),u.jsx(fAe,{}),u.jsx(pAe,{}),u.jsx(n_e,{}),u.jsx(zje,{}),u.jsx(Mje,{}),u.jsx(Bje,{}),u.jsx($je,{})]})}const gAe={workspace:mh,datastore:Wn,coveragestore:wc,layer:hi,style:_c,layergroup:ove},yAe={workspace:"blue",datastore:"green",coveragestore:"orange",layer:"teal",style:"purple",layergroup:"cyan"};function xAe({isOpen:t,onClose:e,onSelect:r}){const[n,i]=I.useState(""),[s,a]=I.useState(0),o=I.useRef(null),d=I.useRef(null),m=Er(Y=>Y.selectNode),y=Er(Y=>Y.expandNode),v=Bt("white","gray.800"),w=Bt("gray.200","gray.600"),O=Bt("gray.50","gray.700"),P=Bt("kartoza.50","kartoza.900"),E=Bt("gray.500","gray.400"),{data:$}=Xr({queryKey:["searchSuggestions"],queryFn:Vbe,staleTime:5*60*1e3}),{data:R,isLoading:F}=Xr({queryKey:["search",n],queryFn:()=>Nbe(n),enabled:n.length>=2,staleTime:30*1e3}),D=(R==null?void 0:R.results)||[],U=($==null?void 0:$.suggestions)||[];I.useEffect(()=>{a(0)},[D]),I.useEffect(()=>{t&&o.current&&setTimeout(()=>{var Y;return(Y=o.current)==null?void 0:Y.focus()},100),t||(i(""),a(0))},[t]),I.useEffect(()=>{if(d.current&&D.length>0){const Y=d.current.querySelector(`[data-index="${s}"]`);Y&&Y.scrollIntoView({block:"nearest"})}},[s,D.length]);const X=I.useCallback(Y=>{y(`connection:${Y.connectionId}`),Y.workspace&&(y(`workspace:${Y.connectionId}:${Y.workspace}`),Y.type==="layer"?y(`layers:${Y.connectionId}:${Y.workspace}`):Y.type==="style"?y(`styles:${Y.connectionId}:${Y.workspace}`):Y.type==="datastore"?y(`datastores:${Y.connectionId}:${Y.workspace}`):Y.type==="coveragestore"?y(`coveragestores:${Y.connectionId}:${Y.workspace}`):Y.type==="layergroup"&&y(`layergroups:${Y.connectionId}:${Y.workspace}`)),m({id:`${Y.type}:${Y.connectionId}:${Y.workspace||""}:${Y.name}`,name:Y.name,type:Y.type,connectionId:Y.connectionId,workspace:Y.workspace}),r&&r(Y),e()},[r,e,m,y]),ee=I.useCallback(Y=>{Y.key==="ArrowDown"?(Y.preventDefault(),a(ne=>Math.min(ne+1,D.length-1))):Y.key==="ArrowUp"?(Y.preventDefault(),a(ne=>Math.max(ne-1,0))):Y.key==="Enter"&&D.length>0?(Y.preventDefault(),X(D[s])):Y.key==="Escape"&&e()},[D,s,X,e]),K=Y=>{var ne;i(Y),(ne=o.current)==null||ne.focus()};return u.jsxs(ss,{isOpen:t,onClose:e,size:"xl",motionPreset:"slideInBottom",children:[u.jsx(as,{bg:"blackAlpha.600",backdropFilter:"blur(4px)"}),u.jsx(os,{bg:v,borderRadius:"xl",overflow:"hidden",mx:4,my:20,maxH:"70vh",children:u.jsxs(ws,{p:0,children:[u.jsxs(ue,{p:4,borderBottomWidth:"1px",borderColor:w,children:[u.jsxs(da,{size:"lg",children:[u.jsx(wl,{pointerEvents:"none",children:F?u.jsx(kn,{size:"sm",color:"kartoza.500"}):u.jsx(ze,{as:Ib,color:E})}),u.jsx(Ar,{ref:o,placeholder:"Search workspaces, layers, styles...",value:n,onChange:Y=>i(Y.target.value),onKeyDown:ee,border:"none",_focus:{boxShadow:"none"},fontSize:"md"}),n&&u.jsx(Pb,{children:u.jsx(ze,{as:hf,color:E,cursor:"pointer",onClick:()=>i(""),_hover:{color:"kartoza.500"}})})]}),!n&&U.length>0&&u.jsxs(fe,{mt:3,spacing:2,flexWrap:"wrap",children:[u.jsx(J,{fontSize:"sm",color:E,children:"Try searching for:"}),U.slice(0,6).map(Y=>u.jsx(cm,{size:"sm",variant:"subtle",colorScheme:"gray",cursor:"pointer",onClick:()=>K(Y),_hover:{bg:"gray.200"},borderRadius:"full",children:u.jsx(zb,{children:Y})},Y))]})]}),u.jsxs(ue,{ref:d,maxH:"50vh",overflowY:"auto",py:2,children:[n.length>=2&&D.length===0&&!F&&u.jsx(ue,{p:8,textAlign:"center",children:u.jsxs(J,{color:E,children:['No results found for "',n,'"']})}),n.length>=2&&n.length<2&&u.jsx(ue,{p:8,textAlign:"center",children:u.jsx(J,{color:E,children:"Type at least 2 characters to search"})}),D.map((Y,ne)=>u.jsx(vAe,{result:Y,isSelected:ne===s,onClick:()=>X(Y),onMouseEnter:()=>a(ne),dataIndex:ne,hoverBg:O,selectedBg:P},`${Y.connectionId}-${Y.type}-${Y.name}-${ne}`)),!n&&u.jsx(ue,{p:8,textAlign:"center",children:u.jsxs(lt,{spacing:3,children:[u.jsx(ze,{as:Ib,boxSize:8,color:E}),u.jsx(J,{color:E,children:"Search across all your GeoServer resources"}),u.jsxs(fe,{spacing:1,fontSize:"sm",color:E,children:[u.jsx(J,{children:"Press"}),u.jsx(tu,{children:""}),u.jsx(tu,{children:""}),u.jsx(J,{children:"to navigate,"}),u.jsx(tu,{children:"Enter"}),u.jsx(J,{children:"to select"})]})]})})]}),u.jsx(ue,{px:4,py:2,borderTopWidth:"1px",borderColor:w,bg:Bt("gray.50","gray.900"),children:u.jsxs(fe,{justify:"space-between",fontSize:"xs",color:E,children:[u.jsxs(fe,{spacing:4,children:[u.jsxs(fe,{spacing:1,children:[u.jsx(tu,{size:"xs",children:""}),u.jsx(J,{children:"Navigate"})]}),u.jsxs(fe,{spacing:1,children:[u.jsx(tu,{size:"xs",children:"Enter"}),u.jsx(J,{children:"Select"})]}),u.jsxs(fe,{spacing:1,children:[u.jsx(tu,{size:"xs",children:"Esc"}),u.jsx(J,{children:"Close"})]})]}),R&&u.jsxs(J,{children:[R.total," results"]})]})})]})})]})}function vAe({result:t,isSelected:e,onClick:r,onMouseEnter:n,dataIndex:i,hoverBg:s,selectedBg:a}){const o=gAe[t.type]||mh,d=yAe[t.type]||"gray",m=Bt("gray.500","gray.400");return u.jsx(ue,{"data-index":i,px:4,py:3,cursor:"pointer",bg:e?a:"transparent",_hover:{bg:e?a:s},onClick:r,onMouseEnter:n,transition:"background 0.1s",children:u.jsxs(yr,{align:"start",gap:3,children:[u.jsx(ue,{p:2,bg:`${d}.100`,borderRadius:"lg",color:`${d}.600`,children:u.jsx(ze,{as:o,boxSize:5})}),u.jsxs(ue,{flex:1,minW:0,children:[u.jsxs(fe,{spacing:2,mb:1,children:[u.jsx(J,{fontWeight:"semibold",fontSize:"sm",noOfLines:1,children:t.name}),t.tags.map(y=>u.jsx(Qt,{colorScheme:d,fontSize:"xs",borderRadius:"full",px:2,children:y},y))]}),u.jsxs(fe,{spacing:2,fontSize:"xs",color:m,children:[u.jsx(J,{children:t.serverName}),t.workspace&&u.jsxs(u.Fragment,{children:[u.jsx(J,{children:""}),u.jsx(J,{children:t.workspace})]})]})]}),e&&u.jsx(tu,{size:"xs",alignSelf:"center",children:"Enter"})]})})}function bAe(t){I.useEffect(()=>{const e=r=>{(r.ctrlKey||r.metaKey)&&r.key==="k"&&(r.preventDefault(),t())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t])}function _Ae(){const[t,e]=I.useState(!1);return bAe(()=>e(!0)),u.jsxs(u.Fragment,{children:[u.jsx(m1e,{onSearchClick:()=>e(!0),children:u.jsx(P1e,{})}),u.jsx(mAe,{}),u.jsx(xAe,{isOpen:t,onClose:()=>e(!1)})]})}const wAe={kartoza:{50:"#e6f3fa",100:"#b3daf0",200:"#80c1e6",300:"#5BB5E8",400:"#4da8de",500:"#3B9DD9",600:"#2d8ac6",700:"#1B6B9B",800:"#155a84",900:"#0f4a6d"},accent:{50:"#fef5e7",100:"#fce5c3",200:"#f9d59f",300:"#F0B84D",400:"#E8A331",500:"#D4922A",600:"#c08526",700:"#a67121",800:"#8c5d1c",900:"#724917"},gray:{50:"#f7f9fb",100:"#e8ecf0",200:"#d4dbe2",300:"#C8C8C8",400:"#9E9E9E",500:"#6B7B8D",600:"#4D6370",700:"#3d4f5f",800:"#2a3a4a",900:"#1a2a3a"}},SAe={sm:"0 2px 8px rgba(27, 107, 155, 0.08)",md:"0 4px 16px rgba(27, 107, 155, 0.12)",lg:"0 8px 32px rgba(27, 107, 155, 0.16)",xl:"0 16px 48px rgba(27, 107, 155, 0.20)",kartoza:"0 4px 16px rgba(27, 107, 155, 0.10), 0 1px 4px rgba(0, 0, 0, 0.06)",kartozaHover:"0 8px 28px rgba(27, 107, 155, 0.16), 0 2px 8px rgba(0, 0, 0, 0.08)",accent:"0 4px 20px rgba(232, 163, 49, 0.4)",accentHover:"0 6px 28px rgba(232, 163, 49, 0.5)"},kAe={sm:"8px",md:"12px",lg:"20px",xl:"32px"},CAe={initialColorMode:"light",useSystemColorMode:!1},TAe=Zfe({config:CAe,colors:wAe,shadows:SAe,radii:kAe,fonts:{heading:"'Roboto', -apple-system, BlinkMacSystemFont, sans-serif",body:"'Roboto', -apple-system, BlinkMacSystemFont, sans-serif"},styles:{global:{body:{bg:"gray.50",color:"gray.900"},".kartoza-gradient":{background:"linear-gradient(135deg, #1B6B9B 0%, #3B9DD9 50%, #5BB5E8 100%)"},".kartoza-card":{borderRadius:"12px",boxShadow:"0 4px 16px rgba(27, 107, 155, 0.10), 0 1px 4px rgba(0, 0, 0, 0.06)",transition:"box-shadow 0.3s ease, transform 0.3s ease",_hover:{boxShadow:"0 8px 28px rgba(27, 107, 155, 0.16), 0 2px 8px rgba(0, 0, 0, 0.08)",transform:"translateY(-3px)"}}}},components:{Button:{baseStyle:{borderRadius:"10px",fontWeight:"600",transition:"all 0.25s ease"},defaultProps:{colorScheme:"kartoza"},variants:{solid:{bg:"kartoza.500",color:"white",boxShadow:"0 2px 8px rgba(27, 107, 155, 0.12)",_hover:{bg:"kartoza.600",boxShadow:"0 4px 14px rgba(27, 107, 155, 0.20)",transform:"translateY(-1px)"}},outline:{borderColor:"kartoza.500",borderWidth:"2px",color:"kartoza.500",_hover:{bg:"kartoza.50",transform:"translateY(-1px)"}},ghost:{color:"kartoza.500",_hover:{bg:"kartoza.50"}},accent:{bg:"accent.400",color:"white",boxShadow:"0 4px 20px rgba(232, 163, 49, 0.4)",_hover:{bg:"accent.500",boxShadow:"0 6px 28px rgba(232, 163, 49, 0.5)",transform:"translateY(-2px)"}},"accent-outline":{borderColor:"accent.400",borderWidth:"2px",color:"accent.400",_hover:{bg:"accent.50"}}},sizes:{lg:{fontSize:"md",px:8,py:6},xl:{fontSize:"lg",px:10,py:7,minW:"200px"}}},Link:{baseStyle:{color:"kartoza.500",_hover:{textDecoration:"underline",color:"kartoza.600"}}},Heading:{baseStyle:{color:"gray.900",fontWeight:"600"},variants:{brand:{color:"kartoza.700"},accent:{color:"accent.400"}}},Card:{baseStyle:{container:{borderRadius:"12px",boxShadow:"0 4px 16px rgba(27, 107, 155, 0.10), 0 1px 4px rgba(0, 0, 0, 0.06)",transition:"box-shadow 0.3s ease, transform 0.3s ease",overflow:"hidden",_hover:{boxShadow:"0 8px 28px rgba(27, 107, 155, 0.16), 0 2px 8px rgba(0, 0, 0, 0.08)"}}},variants:{elevated:{container:{_hover:{transform:"translateY(-3px)"}}},feature:{container:{borderLeft:"4px solid",borderLeftColor:"kartoza.500"}},accent:{container:{borderTop:"4px solid",borderTopColor:"accent.400"}}}},Modal:{baseStyle:{dialog:{borderRadius:"12px",boxShadow:"0 16px 48px rgba(27, 107, 155, 0.20)"},header:{borderBottom:"1px solid",borderBottomColor:"gray.100"},footer:{borderTop:"1px solid",borderTopColor:"gray.100"}}},Input:{defaultProps:{focusBorderColor:"kartoza.500"},baseStyle:{field:{borderRadius:"8px"}}},Select:{defaultProps:{focusBorderColor:"kartoza.500"}},Checkbox:{defaultProps:{colorScheme:"kartoza"}},Switch:{defaultProps:{colorScheme:"kartoza"}},Progress:{defaultProps:{colorScheme:"kartoza"}},Tabs:{defaultProps:{colorScheme:"kartoza"}},Badge:{baseStyle:{borderRadius:"6px",fontWeight:"600"},variants:{subtle:{bg:"kartoza.50",color:"kartoza.700"},solid:{bg:"kartoza.500",color:"white"},accent:{bg:"accent.400",color:"white"}}},Stat:{baseStyle:{container:{p:4},label:{color:"gray.600",fontSize:"sm",fontWeight:"500"},number:{color:"kartoza.700",fontWeight:"700"},helpText:{color:"gray.500"}}},Divider:{baseStyle:{borderColor:"gray.200"}}},semanticTokens:{colors:{primary:"kartoza.500","primary.dark":"kartoza.700","primary.light":"kartoza.300",secondary:"accent.400",success:"#4CAF50",error:"#E55B3C",warning:"accent.400",info:"kartoza.300"}}}),OAe=new Fxe({defaultOptions:{queries:{staleTime:1e3*60,refetchOnWindowFocus:!1}}});Gj.createRoot(document.getElementById("root")).render(u.jsx($i.StrictMode,{children:u.jsx(Bxe,{client:OAe,children:u.jsx(Jde,{theme:TAe,children:u.jsx(_Ae,{})})})}));
